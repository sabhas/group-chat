function _mergeNamespaces(i,e){for(var o=0;o<e.length;o++){const c=e[o];if(typeof c!="string"&&!Array.isArray(c)){for(const _ in c)if(_!=="default"&&!(_ in i)){const $=Object.getOwnPropertyDescriptor(c,_);$&&Object.defineProperty(i,_,$.get?$:{enumerable:!0,get:()=>c[_]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))c(_);new MutationObserver(_=>{for(const $ of _)if($.type==="childList")for(const _t of $.addedNodes)_t.tagName==="LINK"&&_t.rel==="modulepreload"&&c(_t)}).observe(document,{childList:!0,subtree:!0});function o(_){const $={};return _.integrity&&($.integrity=_.integrity),_.referrerpolicy&&($.referrerPolicy=_.referrerpolicy),_.crossorigin==="use-credentials"?$.credentials="include":_.crossorigin==="anonymous"?$.credentials="omit":$.credentials="same-origin",$}function c(_){if(_.ep)return;_.ep=!0;const $=o(_);fetch(_.href,$)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var jsxRuntimeExports={},jsxRuntime={get exports(){return jsxRuntimeExports},set exports(i){jsxRuntimeExports=i}},reactJsxRuntime_production_min={},reactExports={},react={get exports(){return reactExports},set exports(i){reactExports=i}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(i){return i===null||typeof i!="object"?null:(i=z$1&&i[z$1]||i["@@iterator"],typeof i=="function"?i:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(i,e,o){this.props=i,this.context=e,this.refs=D$1,this.updater=o||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};E$1.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(i,e,o){this.props=i,this.context=e,this.refs=D$1,this.updater=o||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(i,e,o){var c,_={},$=null,_t=null;if(e!=null)for(c in e.ref!==void 0&&(_t=e.ref),e.key!==void 0&&($=""+e.key),e)J.call(e,c)&&!L$1.hasOwnProperty(c)&&(_[c]=e[c]);var ga=arguments.length-2;if(ga===1)_.children=o;else if(1<ga){for(var _s=Array(ga),_c=0;_c<ga;_c++)_s[_c]=arguments[_c+2];_.children=_s}if(i&&i.defaultProps)for(c in ga=i.defaultProps,ga)_[c]===void 0&&(_[c]=ga[c]);return{$$typeof:l$1,type:i,key:$,ref:_t,props:_,_owner:K$1.current}}function N$1(i,e){return{$$typeof:l$1,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function O$1(i){return typeof i=="object"&&i!==null&&i.$$typeof===l$1}function escape$1(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(o){return e[o]})}var P$1=/\/+/g;function Q$1(i,e){return typeof i=="object"&&i!==null&&i.key!=null?escape$1(""+i.key):e.toString(36)}function R$1(i,e,o,c,_){var $=typeof i;($==="undefined"||$==="boolean")&&(i=null);var _t=!1;if(i===null)_t=!0;else switch($){case"string":case"number":_t=!0;break;case"object":switch(i.$$typeof){case l$1:case n$1:_t=!0}}if(_t)return _t=i,_=_(_t),i=c===""?"."+Q$1(_t,0):c,I$1(_)?(o="",i!=null&&(o=i.replace(P$1,"$&/")+"/"),R$1(_,e,o,"",function(_c){return _c})):_!=null&&(O$1(_)&&(_=N$1(_,o+(!_.key||_t&&_t.key===_.key?"":(""+_.key).replace(P$1,"$&/")+"/")+i)),e.push(_)),1;if(_t=0,c=c===""?".":c+":",I$1(i))for(var ga=0;ga<i.length;ga++){$=i[ga];var _s=c+Q$1($,ga);_t+=R$1($,e,o,_s,_)}else if(_s=A$1(i),typeof _s=="function")for(i=_s.call(i),ga=0;!($=i.next()).done;)$=$.value,_s=c+Q$1($,ga++),_t+=R$1($,e,o,_s,_);else if($==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return _t}function S$1(i,e,o){if(i==null)return i;var c=[],_=0;return R$1(i,c,"","",function($){return e.call(o,$,_++)}),c}function T$1(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(o){(i._status===0||i._status===-1)&&(i._status=1,i._result=o)},function(o){(i._status===0||i._status===-1)&&(i._status=2,i._result=o)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};react_production_min.Children={map:S$1,forEach:function(i,e,o){S$1(i,function(){e.apply(this,arguments)},o)},count:function(i){var e=0;return S$1(i,function(){e++}),e},toArray:function(i){return S$1(i,function(e){return e})||[]},only:function(i){if(!O$1(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.cloneElement=function(i,e,o){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var c=C$1({},i.props),_=i.key,$=i.ref,_t=i._owner;if(e!=null){if(e.ref!==void 0&&($=e.ref,_t=K$1.current),e.key!==void 0&&(_=""+e.key),i.type&&i.type.defaultProps)var ga=i.type.defaultProps;for(_s in e)J.call(e,_s)&&!L$1.hasOwnProperty(_s)&&(c[_s]=e[_s]===void 0&&ga!==void 0?ga[_s]:e[_s])}var _s=arguments.length-2;if(_s===1)c.children=o;else if(1<_s){ga=Array(_s);for(var _c=0;_c<_s;_c++)ga[_c]=arguments[_c+2];c.children=ga}return{$$typeof:l$1,type:i.type,key:_,ref:$,props:c,_owner:_t}};react_production_min.createContext=function(i){return i={$$typeof:u,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:t,_context:i},i.Consumer=i};react_production_min.createElement=M$1;react_production_min.createFactory=function(i){var e=M$1.bind(null,i);return e.type=i,e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(i){return{$$typeof:v$1,render:i}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(i){return{$$typeof:y,_payload:{_status:-1,_result:i},_init:T$1}};react_production_min.memo=function(i,e){return{$$typeof:x,type:i,compare:e===void 0?null:e}};react_production_min.startTransition=function(i){var e=V$1.transition;V$1.transition={};try{i()}finally{V$1.transition=e}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(i,e){return U$1.current.useCallback(i,e)};react_production_min.useContext=function(i){return U$1.current.useContext(i)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(i){return U$1.current.useDeferredValue(i)};react_production_min.useEffect=function(i,e){return U$1.current.useEffect(i,e)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(i,e,o){return U$1.current.useImperativeHandle(i,e,o)};react_production_min.useInsertionEffect=function(i,e){return U$1.current.useInsertionEffect(i,e)};react_production_min.useLayoutEffect=function(i,e){return U$1.current.useLayoutEffect(i,e)};react_production_min.useMemo=function(i,e){return U$1.current.useMemo(i,e)};react_production_min.useReducer=function(i,e,o){return U$1.current.useReducer(i,e,o)};react_production_min.useRef=function(i){return U$1.current.useRef(i)};react_production_min.useState=function(i){return U$1.current.useState(i)};react_production_min.useSyncExternalStore=function(i,e,o){return U$1.current.useSyncExternalStore(i,e,o)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.2.0";(function(i){i.exports=react_production_min})(react);const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(i,e,o){var c,_={},$=null,_t=null;o!==void 0&&($=""+o),e.key!==void 0&&($=""+e.key),e.ref!==void 0&&(_t=e.ref);for(c in e)m$1.call(e,c)&&!p$1.hasOwnProperty(c)&&(_[c]=e[c]);if(i&&i.defaultProps)for(c in e=i.defaultProps,e)_[c]===void 0&&(_[c]=e[c]);return{$$typeof:k,type:i,key:$,ref:_t,props:_,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;(function(i){i.exports=reactJsxRuntime_production_min})(jsxRuntime);const jsx=jsxRuntimeExports.jsx,jsxs=jsxRuntimeExports.jsxs;var client$1={},reactDomExports={},reactDom={get exports(){return reactDomExports},set exports(i){reactDomExports=i}},reactDom_production_min={},schedulerExports={},scheduler={get exports(){return schedulerExports},set exports(i){schedulerExports=i}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(Bp,c0){var _f=Bp.length;Bp.push(c0);t:for(;0<_f;){var O0=_f-1>>>1,_0=Bp[O0];if(0<_(_0,c0))Bp[O0]=c0,Bp[_f]=_0,_f=O0;else break t}}function o(Bp){return Bp.length===0?null:Bp[0]}function c(Bp){if(Bp.length===0)return null;var c0=Bp[0],_f=Bp.pop();if(_f!==c0){Bp[0]=_f;t:for(var O0=0,_0=Bp.length,__=_0>>>1;O0<__;){var yp=2*(O0+1)-1,dy=Bp[yp],L1=yp+1,o0=Bp[L1];if(0>_(dy,_f))L1<_0&&0>_(o0,dy)?(Bp[O0]=o0,Bp[L1]=_f,O0=L1):(Bp[O0]=dy,Bp[yp]=_f,O0=yp);else if(L1<_0&&0>_(o0,_f))Bp[O0]=o0,Bp[L1]=_f,O0=L1;else break t}}return c0}function _(Bp,c0){var _f=Bp.sortIndex-c0.sortIndex;return _f!==0?_f:Bp.id-c0.id}if(typeof performance=="object"&&typeof performance.now=="function"){var $=performance;i.unstable_now=function(){return $.now()}}else{var _t=Date,ga=_t.now();i.unstable_now=function(){return _t.now()-ga}}var _s=[],_c=[],_l=1,Tl=null,Cl=3,Pl=!1,Dl=!1,Jl=!1,zl=typeof setTimeout=="function"?setTimeout:null,Bl=typeof clearTimeout=="function"?clearTimeout:null,Vl=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _d(Bp){for(var c0=o(_c);c0!==null;){if(c0.callback===null)c(_c);else if(c0.startTime<=Bp)c(_c),c0.sortIndex=c0.expirationTime,e(_s,c0);else break;c0=o(_c)}}function Sp(Bp){if(Jl=!1,_d(Bp),!Dl)if(o(_s)!==null)Dl=!0,Qp(Up);else{var c0=o(_c);c0!==null&&n0(Sp,c0.startTime-Bp)}}function Up(Bp,c0){Dl=!1,Jl&&(Jl=!1,Bl(_m),_m=-1),Pl=!0;var _f=Cl;try{for(_d(c0),Tl=o(_s);Tl!==null&&(!(Tl.expirationTime>c0)||Bp&&!Jp());){var O0=Tl.callback;if(typeof O0=="function"){Tl.callback=null,Cl=Tl.priorityLevel;var _0=O0(Tl.expirationTime<=c0);c0=i.unstable_now(),typeof _0=="function"?Tl.callback=_0:Tl===o(_s)&&c(_s),_d(c0)}else c(_s);Tl=o(_s)}if(Tl!==null)var __=!0;else{var yp=o(_c);yp!==null&&n0(Sp,yp.startTime-c0),__=!1}return __}finally{Tl=null,Cl=_f,Pl=!1}}var Kp=!1,Hp=null,_m=-1,I0=5,Cp=-1;function Jp(){return!(i.unstable_now()-Cp<I0)}function Zp(){if(Hp!==null){var Bp=i.unstable_now();Cp=Bp;var c0=!0;try{c0=Hp(!0,Bp)}finally{c0?i0():(Kp=!1,Hp=null)}}else Kp=!1}var i0;if(typeof Vl=="function")i0=function(){Vl(Zp)};else if(typeof MessageChannel<"u"){var Np=new MessageChannel,Dp=Np.port2;Np.port1.onmessage=Zp,i0=function(){Dp.postMessage(null)}}else i0=function(){zl(Zp,0)};function Qp(Bp){Hp=Bp,Kp||(Kp=!0,i0())}function n0(Bp,c0){_m=zl(function(){Bp(i.unstable_now())},c0)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Bp){Bp.callback=null},i.unstable_continueExecution=function(){Dl||Pl||(Dl=!0,Qp(Up))},i.unstable_forceFrameRate=function(Bp){0>Bp||125<Bp?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I0=0<Bp?Math.floor(1e3/Bp):5},i.unstable_getCurrentPriorityLevel=function(){return Cl},i.unstable_getFirstCallbackNode=function(){return o(_s)},i.unstable_next=function(Bp){switch(Cl){case 1:case 2:case 3:var c0=3;break;default:c0=Cl}var _f=Cl;Cl=c0;try{return Bp()}finally{Cl=_f}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(Bp,c0){switch(Bp){case 1:case 2:case 3:case 4:case 5:break;default:Bp=3}var _f=Cl;Cl=Bp;try{return c0()}finally{Cl=_f}},i.unstable_scheduleCallback=function(Bp,c0,_f){var O0=i.unstable_now();switch(typeof _f=="object"&&_f!==null?(_f=_f.delay,_f=typeof _f=="number"&&0<_f?O0+_f:O0):_f=O0,Bp){case 1:var _0=-1;break;case 2:_0=250;break;case 5:_0=1073741823;break;case 4:_0=1e4;break;default:_0=5e3}return _0=_f+_0,Bp={id:_l++,callback:c0,priorityLevel:Bp,startTime:_f,expirationTime:_0,sortIndex:-1},_f>O0?(Bp.sortIndex=_f,e(_c,Bp),o(_s)===null&&Bp===o(_c)&&(Jl?(Bl(_m),_m=-1):Jl=!0,n0(Sp,_f-O0))):(Bp.sortIndex=_0,e(_s,Bp),Dl||Pl||(Dl=!0,Qp(Up))),Bp},i.unstable_shouldYield=Jp,i.unstable_wrapCallback=function(Bp){var c0=Cl;return function(){var _f=Cl;Cl=c0;try{return Bp.apply(this,arguments)}finally{Cl=_f}}}})(scheduler_production_min);(function(i){i.exports=scheduler_production_min})(scheduler);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,o=1;o<arguments.length;o++)e+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(i,e){ha(i,e),ha(i+"Capture",e)}function ha(i,e){for(ea[i]=e,i=0;i<e.length;i++)da.add(e[i])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(i){return ja.call(ma,i)?!0:ja.call(la,i)?!1:ka.test(i)?ma[i]=!0:(la[i]=!0,!1)}function pa(i,e,o,c){if(o!==null&&o.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return c?!1:o!==null?!o.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function qa(i,e,o,c){if(e===null||typeof e>"u"||pa(i,e,o,c))return!0;if(c)return!1;if(o!==null)switch(o.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function v(i,e,o,c,_,$,_t){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=c,this.attributeNamespace=_,this.mustUseProperty=o,this.propertyName=i,this.type=e,this.sanitizeURL=$,this.removeEmptyString=_t}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){z[i]=new v(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];z[e]=new v(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){z[i]=new v(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){z[i]=new v(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){z[i]=new v(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){z[i]=new v(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){z[i]=new v(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){z[i]=new v(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){z[i]=new v(i,5,!1,i.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(ra,sa);z[e]=new v(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(ra,sa);z[e]=new v(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(ra,sa);z[e]=new v(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){z[i]=new v(i,1,!1,i.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){z[i]=new v(i,1,!1,i.toLowerCase(),null,!0,!0)});function ta(i,e,o,c){var _=z.hasOwnProperty(e)?z[e]:null;(_!==null?_.type!==0:c||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qa(e,o,_,c)&&(o=null),c||_===null?oa(e)&&(o===null?i.removeAttribute(e):i.setAttribute(e,""+o)):_.mustUseProperty?i[_.propertyName]=o===null?_.type===3?!1:"":o:(e=_.attributeName,c=_.attributeNamespace,o===null?i.removeAttribute(e):(_=_.type,o=_===3||_===4&&o===!0?"":""+o,c?i.setAttributeNS(c,e,o):i.setAttribute(e,o))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(i){return i===null||typeof i!="object"?null:(i=Ja&&i[Ja]||i["@@iterator"],typeof i=="function"?i:null)}var A=Object.assign,La;function Ma(i){if(La===void 0)try{throw Error()}catch(o){var e=o.stack.trim().match(/\n( *(at )?)/);La=e&&e[1]||""}return`
`+La+i}var Na=!1;function Oa(i,e){if(!i||Na)return"";Na=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(_c){var c=_c}Reflect.construct(i,[],e)}else{try{e.call()}catch(_c){c=_c}i.call(e.prototype)}else{try{throw Error()}catch(_c){c=_c}i()}}catch(_c){if(_c&&c&&typeof _c.stack=="string"){for(var _=_c.stack.split(`
`),$=c.stack.split(`
`),_t=_.length-1,ga=$.length-1;1<=_t&&0<=ga&&_[_t]!==$[ga];)ga--;for(;1<=_t&&0<=ga;_t--,ga--)if(_[_t]!==$[ga]){if(_t!==1||ga!==1)do if(_t--,ga--,0>ga||_[_t]!==$[ga]){var _s=`
`+_[_t].replace(" at new "," at ");return i.displayName&&_s.includes("<anonymous>")&&(_s=_s.replace("<anonymous>",i.displayName)),_s}while(1<=_t&&0<=ga);break}}}finally{Na=!1,Error.prepareStackTrace=o}return(i=i?i.displayName||i.name:"")?Ma(i):""}function Pa(i){switch(i.tag){case 5:return Ma(i.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return i=Oa(i.type,!1),i;case 11:return i=Oa(i.type.render,!1),i;case 1:return i=Oa(i.type,!0),i;default:return""}}function Qa(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case Ca:return(i.displayName||"Context")+".Consumer";case Ba:return(i._context.displayName||"Context")+".Provider";case Da:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ga:return e=i.displayName||null,e!==null?e:Qa(i.type)||"Memo";case Ha:e=i._payload,i=i._init;try{return Qa(i(e))}catch{}}return null}function Ra(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(e);case 8:return e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sa(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ta(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ua(i){var e=Ta(i)?"checked":"value",o=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),c=""+i[e];if(!i.hasOwnProperty(e)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var _=o.get,$=o.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return _.call(this)},set:function(_t){c=""+_t,$.call(this,_t)}}),Object.defineProperty(i,e,{enumerable:o.enumerable}),{getValue:function(){return c},setValue:function(_t){c=""+_t},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function Va(i){i._valueTracker||(i._valueTracker=Ua(i))}function Wa(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var o=e.getValue(),c="";return i&&(c=Ta(i)?i.checked?"true":"false":i.value),i=c,i!==o?(e.setValue(i),!0):!1}function Xa(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Ya(i,e){var o=e.checked;return A({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??i._wrapperState.initialChecked})}function Za(i,e){var o=e.defaultValue==null?"":e.defaultValue,c=e.checked!=null?e.checked:e.defaultChecked;o=Sa(e.value!=null?e.value:o),i._wrapperState={initialChecked:c,initialValue:o,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ab(i,e){e=e.checked,e!=null&&ta(i,"checked",e,!1)}function bb(i,e){ab(i,e);var o=Sa(e.value),c=e.type;if(o!=null)c==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+o):i.value!==""+o&&(i.value=""+o);else if(c==="submit"||c==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?cb(i,e.type,o):e.hasOwnProperty("defaultValue")&&cb(i,e.type,Sa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function db(i,e,o){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var c=e.type;if(!(c!=="submit"&&c!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,o||e===i.value||(i.value=e),i.defaultValue=e}o=i.name,o!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,o!==""&&(i.name=o)}function cb(i,e,o){(e!=="number"||Xa(i.ownerDocument)!==i)&&(o==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+o&&(i.defaultValue=""+o))}var eb=Array.isArray;function fb(i,e,o,c){if(i=i.options,e){e={};for(var _=0;_<o.length;_++)e["$"+o[_]]=!0;for(o=0;o<i.length;o++)_=e.hasOwnProperty("$"+i[o].value),i[o].selected!==_&&(i[o].selected=_),_&&c&&(i[o].defaultSelected=!0)}else{for(o=""+Sa(o),e=null,_=0;_<i.length;_++){if(i[_].value===o){i[_].selected=!0,c&&(i[_].defaultSelected=!0);return}e!==null||i[_].disabled||(e=i[_])}e!==null&&(e.selected=!0)}}function gb(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function hb(i,e){var o=e.value;if(o==null){if(o=e.children,e=e.defaultValue,o!=null){if(e!=null)throw Error(p(92));if(eb(o)){if(1<o.length)throw Error(p(93));o=o[0]}e=o}e==null&&(e=""),o=e}i._wrapperState={initialValue:Sa(o)}}function ib(i,e){var o=Sa(e.value),c=Sa(e.defaultValue);o!=null&&(o=""+o,o!==i.value&&(i.value=o),e.defaultValue==null&&i.defaultValue!==o&&(i.defaultValue=o)),c!=null&&(i.defaultValue=""+c)}function jb(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function kb(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?kb(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var mb,nb=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,o,c,_){MSApp.execUnsafeLocalFunction(function(){return i(e,o,c,_)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mb.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function ob(i,e){if(e){var o=i.firstChild;if(o&&o===i.lastChild&&o.nodeType===3){o.nodeValue=e;return}}i.textContent=e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(i){qb.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),pb[e]=pb[i]})});function rb(i,e,o){return e==null||typeof e=="boolean"||e===""?"":o||typeof e!="number"||e===0||pb.hasOwnProperty(i)&&pb[i]?(""+e).trim():e+"px"}function sb(i,e){i=i.style;for(var o in e)if(e.hasOwnProperty(o)){var c=o.indexOf("--")===0,_=rb(o,e[o],c);o==="float"&&(o="cssFloat"),c?i.setProperty(o,_):i[o]=_}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(i,e){if(e){if(tb[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(p(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(p(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(p(61))}if(e.style!=null&&typeof e.style!="object")throw Error(p(62))}}function vb(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var yb=null,zb=null,Ab=null;function Bb(i){if(i=Cb(i)){if(typeof yb!="function")throw Error(p(280));var e=i.stateNode;e&&(e=Db(e),yb(i.stateNode,i.type,e))}}function Eb(i){zb?Ab?Ab.push(i):Ab=[i]:zb=i}function Fb(){if(zb){var i=zb,e=Ab;if(Ab=zb=null,Bb(i),e)for(i=0;i<e.length;i++)Bb(e[i])}}function Gb(i,e){return i(e)}function Hb(){}var Ib=!1;function Jb(i,e,o){if(Ib)return i(e,o);Ib=!0;try{return Gb(i,e,o)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(i,e){var o=i.stateNode;if(o===null)return null;var c=Db(o);if(c===null)return null;o=c[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(i=i.type,c=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!c;break t;default:i=!1}if(i)return null;if(o&&typeof o!="function")throw Error(p(231,e,typeof o));return o}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(i,e,o,c,_,$,_t,ga,_s){var _c=Array.prototype.slice.call(arguments,3);try{e.apply(o,_c)}catch(_l){this.onError(_l)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(i){Ob=!0,Pb=i}};function Tb(i,e,o,c,_,$,_t,ga,_s){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(i,e,o,c,_,$,_t,ga,_s){if(Tb.apply(this,arguments),Ob){if(Ob){var _c=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=_c)}}function Vb(i){var e=i,o=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(o=e.return),i=e.return;while(i)}return e.tag===3?o:null}function Wb(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function Xb(i){if(Vb(i)!==i)throw Error(p(188))}function Yb(i){var e=i.alternate;if(!e){if(e=Vb(i),e===null)throw Error(p(188));return e!==i?null:i}for(var o=i,c=e;;){var _=o.return;if(_===null)break;var $=_.alternate;if($===null){if(c=_.return,c!==null){o=c;continue}break}if(_.child===$.child){for($=_.child;$;){if($===o)return Xb(_),i;if($===c)return Xb(_),e;$=$.sibling}throw Error(p(188))}if(o.return!==c.return)o=_,c=$;else{for(var _t=!1,ga=_.child;ga;){if(ga===o){_t=!0,o=_,c=$;break}if(ga===c){_t=!0,c=_,o=$;break}ga=ga.sibling}if(!_t){for(ga=$.child;ga;){if(ga===o){_t=!0,o=$,c=_;break}if(ga===c){_t=!0,c=$,o=_;break}ga=ga.sibling}if(!_t)throw Error(p(189))}}if(o.alternate!==c)throw Error(p(190))}if(o.tag!==3)throw Error(p(188));return o.stateNode.current===o?i:e}function Zb(i){return i=Yb(i),i!==null?$b(i):null}function $b(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=$b(i);if(e!==null)return e;i=i.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(i){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,i,void 0,(i.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(i){return i>>>=0,i===0?32:31-(pc(i)/qc|0)|0}var rc=64,sc=4194304;function tc(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function uc(i,e){var o=i.pendingLanes;if(o===0)return 0;var c=0,_=i.suspendedLanes,$=i.pingedLanes,_t=o&268435455;if(_t!==0){var ga=_t&~_;ga!==0?c=tc(ga):($&=_t,$!==0&&(c=tc($)))}else _t=o&~_,_t!==0?c=tc(_t):$!==0&&(c=tc($));if(c===0)return 0;if(e!==0&&e!==c&&!(e&_)&&(_=c&-c,$=e&-e,_>=$||_===16&&($&4194240)!==0))return e;if(c&4&&(c|=o&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=c;0<e;)o=31-oc(e),_=1<<o,c|=i[o],e&=~_;return c}function vc(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(i,e){for(var o=i.suspendedLanes,c=i.pingedLanes,_=i.expirationTimes,$=i.pendingLanes;0<$;){var _t=31-oc($),ga=1<<_t,_s=_[_t];_s===-1?(!(ga&o)||ga&c)&&(_[_t]=vc(ga,e)):_s<=e&&(i.expiredLanes|=ga),$&=~ga}}function xc(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function yc(){var i=rc;return rc<<=1,!(rc&4194240)&&(rc=64),i}function zc(i){for(var e=[],o=0;31>o;o++)e.push(i);return e}function Ac(i,e,o){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-oc(e),i[e]=o}function Bc(i,e){var o=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var c=i.eventTimes;for(i=i.expirationTimes;0<o;){var _=31-oc(o),$=1<<_;e[_]=0,c[_]=-1,i[_]=-1,o&=~$}}function Cc(i,e){var o=i.entangledLanes|=e;for(i=i.entanglements;o;){var c=31-oc(o),_=1<<c;_&e|i[c]&e&&(i[c]|=e),o&=~_}}var C=0;function Dc(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(i,e){switch(i){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(e.pointerId)}}function Tc(i,e,o,c,_,$){return i===null||i.nativeEvent!==$?(i={blockedOn:e,domEventName:o,eventSystemFlags:c,nativeEvent:$,targetContainers:[_]},e!==null&&(e=Cb(e),e!==null&&Fc(e)),i):(i.eventSystemFlags|=c,e=i.targetContainers,_!==null&&e.indexOf(_)===-1&&e.push(_),i)}function Uc(i,e,o,c,_){switch(e){case"focusin":return Lc=Tc(Lc,i,e,o,c,_),!0;case"dragenter":return Mc=Tc(Mc,i,e,o,c,_),!0;case"mouseover":return Nc=Tc(Nc,i,e,o,c,_),!0;case"pointerover":var $=_.pointerId;return Oc.set($,Tc(Oc.get($)||null,i,e,o,c,_)),!0;case"gotpointercapture":return $=_.pointerId,Pc.set($,Tc(Pc.get($)||null,i,e,o,c,_)),!0}return!1}function Vc(i){var e=Wc(i.target);if(e!==null){var o=Vb(e);if(o!==null){if(e=o.tag,e===13){if(e=Wb(o),e!==null){i.blockedOn=e,Ic(i.priority,function(){Gc(o)});return}}else if(e===3&&o.stateNode.current.memoizedState.isDehydrated){i.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Xc(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var o=Yc(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(o===null){o=i.nativeEvent;var c=new o.constructor(o.type,o);wb=c,o.target.dispatchEvent(c),wb=null}else return e=Cb(o),e!==null&&Fc(e),i.blockedOn=o,!1;e.shift()}return!0}function Zc(i,e,o){Xc(i)&&o.delete(e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(i,e){i.blockedOn===e&&(i.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(i){function e(_){return ad(_,i)}if(0<Kc.length){ad(Kc[0],i);for(var o=1;o<Kc.length;o++){var c=Kc[o];c.blockedOn===i&&(c.blockedOn=null)}}for(Lc!==null&&ad(Lc,i),Mc!==null&&ad(Mc,i),Nc!==null&&ad(Nc,i),Oc.forEach(e),Pc.forEach(e),o=0;o<Qc.length;o++)c=Qc[o],c.blockedOn===i&&(c.blockedOn=null);for(;0<Qc.length&&(o=Qc[0],o.blockedOn===null);)Vc(o),o.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(i,e,o,c){var _=C,$=cd.transition;cd.transition=null;try{C=1,fd(i,e,o,c)}finally{C=_,cd.transition=$}}function gd(i,e,o,c){var _=C,$=cd.transition;cd.transition=null;try{C=4,fd(i,e,o,c)}finally{C=_,cd.transition=$}}function fd(i,e,o,c){if(dd){var _=Yc(i,e,o,c);if(_===null)hd(i,e,c,id,o),Sc(i,c);else if(Uc(_,i,e,o,c))c.stopPropagation();else if(Sc(i,c),e&4&&-1<Rc.indexOf(i)){for(;_!==null;){var $=Cb(_);if($!==null&&Ec($),$=Yc(i,e,o,c),$===null&&hd(i,e,c,id,o),$===_)break;_=$}_!==null&&c.stopPropagation()}else hd(i,e,c,null,o)}}var id=null;function Yc(i,e,o,c){if(id=null,i=xb(c),i=Wc(i),i!==null)if(e=Vb(i),e===null)i=null;else if(o=e.tag,o===13){if(i=Wb(e),i!==null)return i;i=null}else if(o===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return id=i,null}function jd(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var i,e=ld,o=e.length,c,_="value"in kd?kd.value:kd.textContent,$=_.length;for(i=0;i<o&&e[i]===_[i];i++);var _t=o-i;for(c=1;c<=_t&&e[o-c]===_[$-c];c++);return md=_.slice(i,1<c?1-c:void 0)}function od(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function pd(){return!0}function qd(){return!1}function rd(i){function e(o,c,_,$,_t){this._reactName=o,this._targetInst=_,this.type=c,this.nativeEvent=$,this.target=_t,this.currentTarget=null;for(var ga in i)i.hasOwnProperty(ga)&&(o=i[ga],this[ga]=o?o($):$[ga]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==yd&&(yd&&i.type==="mousemove"?(wd=i.screenX-yd.screenX,xd=i.screenY-yd.screenY):xd=wd=0,yd=i),wd)},movementY:function(i){return"movementY"in i?i.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=Od[i])?!!e[i]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(i){if(i.key){var e=Md[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=od(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Nd[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(i){return i.type==="keypress"?od(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?od(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;function ge(i,e){switch(i){case"keyup":return $d.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ie=!1;function je(i,e){switch(i){case"compositionend":return he(e);case"keypress":return e.which!==32?null:(fe=!0,ee);case"textInput":return i=e.data,i===ee&&fe?null:i;default:return null}}function ke(i,e){if(ie)return i==="compositionend"||!ae&&ge(i,e)?(i=nd(),md=ld=kd=null,ie=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return de&&e.locale!=="ko"?null:e.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!le[i.type]:e==="textarea"}function ne(i,e,o,c){Eb(c),e=oe(e,"onChange"),0<e.length&&(o=new td("onChange","change",null,o,c),i.push({event:o,listeners:e}))}var pe=null,qe=null;function re(i){se(i,0)}function te(i){var e=ue(i);if(Wa(e))return i}function ve(i,e){if(i==="change")return e}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(i){if(i.propertyName==="value"&&te(qe)){var e=[];ne(e,qe,i,xb(i)),Jb(re,e)}}function Ce(i,e,o){i==="focusin"?(Ae(),pe=e,qe=o,pe.attachEvent("onpropertychange",Be)):i==="focusout"&&Ae()}function De(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return te(qe)}function Ee(i,e){if(i==="click")return te(e)}function Fe(i,e){if(i==="input"||i==="change")return te(e)}function Ge(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(i,e){if(He(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var o=Object.keys(i),c=Object.keys(e);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var _=o[c];if(!ja.call(e,_)||!He(i[_],e[_]))return!1}return!0}function Je(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Ke(i,e){var o=Je(i);i=0;for(var c;o;){if(o.nodeType===3){if(c=i+o.textContent.length,i<=e&&c>=e)return{node:o,offset:e-i};i=c}t:{for(;o;){if(o.nextSibling){o=o.nextSibling;break t}o=o.parentNode}o=void 0}o=Je(o)}}function Le(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?Le(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function Me(){for(var i=window,e=Xa();e instanceof i.HTMLIFrameElement;){try{var o=typeof e.contentWindow.location.href=="string"}catch{o=!1}if(o)i=e.contentWindow;else break;e=Xa(i.document)}return e}function Ne(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function Oe(i){var e=Me(),o=i.focusedElem,c=i.selectionRange;if(e!==o&&o&&o.ownerDocument&&Le(o.ownerDocument.documentElement,o)){if(c!==null&&Ne(o)){if(e=c.start,i=c.end,i===void 0&&(i=e),"selectionStart"in o)o.selectionStart=e,o.selectionEnd=Math.min(i,o.value.length);else if(i=(e=o.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var _=o.textContent.length,$=Math.min(c.start,_);c=c.end===void 0?$:Math.min(c.end,_),!i.extend&&$>c&&(_=c,c=$,$=_),_=Ke(o,$);var _t=Ke(o,c);_&&_t&&(i.rangeCount!==1||i.anchorNode!==_.node||i.anchorOffset!==_.offset||i.focusNode!==_t.node||i.focusOffset!==_t.offset)&&(e=e.createRange(),e.setStart(_.node,_.offset),i.removeAllRanges(),$>c?(i.addRange(e),i.extend(_t.node,_t.offset)):(e.setEnd(_t.node,_t.offset),i.addRange(e)))}}for(e=[],i=o;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<e.length;o++)i=e[o],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(i,e,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Te||Qe==null||Qe!==Xa(c)||(c=Qe,"selectionStart"in c&&Ne(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Se&&Ie(Se,c)||(Se=c,c=oe(Re,"onSelect"),0<c.length&&(e=new td("onSelect","select",null,e,o),i.push({event:e,listeners:c}),e.target=Qe)))}function Ve(i,e){var o={};return o[i.toLowerCase()]=e.toLowerCase(),o["Webkit"+i]="webkit"+e,o["Moz"+i]="moz"+e,o}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(i){if(Xe[i])return Xe[i];if(!We[i])return i;var e=We[i],o;for(o in e)if(e.hasOwnProperty(o)&&o in Ye)return Xe[i]=e[o];return i}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(i,e){df.set(i,e),fa(e,[i])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(i,e,o){var c=i.type||"unknown-event";i.currentTarget=o,Ub(c,e,void 0,i),i.currentTarget=null}function se(i,e){e=(e&4)!==0;for(var o=0;o<i.length;o++){var c=i[o],_=c.event;c=c.listeners;t:{var $=void 0;if(e)for(var _t=c.length-1;0<=_t;_t--){var ga=c[_t],_s=ga.instance,_c=ga.currentTarget;if(ga=ga.listener,_s!==$&&_.isPropagationStopped())break t;nf(_,ga,_c),$=_s}else for(_t=0;_t<c.length;_t++){if(ga=c[_t],_s=ga.instance,_c=ga.currentTarget,ga=ga.listener,_s!==$&&_.isPropagationStopped())break t;nf(_,ga,_c),$=_s}}}if(Qb)throw i=Rb,Qb=!1,Rb=null,i}function D(i,e){var o=e[of];o===void 0&&(o=e[of]=new Set);var c=i+"__bubble";o.has(c)||(pf(e,i,2,!1),o.add(c))}function qf(i,e,o){var c=0;e&&(c|=4),pf(o,i,c,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(i){if(!i[rf]){i[rf]=!0,da.forEach(function(o){o!=="selectionchange"&&(mf.has(o)||qf(o,!1,i),qf(o,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[rf]||(e[rf]=!0,qf("selectionchange",!1,e))}}function pf(i,e,o,c){switch(jd(e)){case 1:var _=ed;break;case 4:_=gd;break;default:_=fd}o=_.bind(null,e,o,i),_=void 0,!Lb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(_=!0),c?_!==void 0?i.addEventListener(e,o,{capture:!0,passive:_}):i.addEventListener(e,o,!0):_!==void 0?i.addEventListener(e,o,{passive:_}):i.addEventListener(e,o,!1)}function hd(i,e,o,c,_){var $=c;if(!(e&1)&&!(e&2)&&c!==null)t:for(;;){if(c===null)return;var _t=c.tag;if(_t===3||_t===4){var ga=c.stateNode.containerInfo;if(ga===_||ga.nodeType===8&&ga.parentNode===_)break;if(_t===4)for(_t=c.return;_t!==null;){var _s=_t.tag;if((_s===3||_s===4)&&(_s=_t.stateNode.containerInfo,_s===_||_s.nodeType===8&&_s.parentNode===_))return;_t=_t.return}for(;ga!==null;){if(_t=Wc(ga),_t===null)return;if(_s=_t.tag,_s===5||_s===6){c=$=_t;continue t}ga=ga.parentNode}}c=c.return}Jb(function(){var _c=$,_l=xb(o),Tl=[];t:{var Cl=df.get(i);if(Cl!==void 0){var Pl=td,Dl=i;switch(i){case"keypress":if(od(o)===0)break t;case"keydown":case"keyup":Pl=Rd;break;case"focusin":Dl="focus",Pl=Fd;break;case"focusout":Dl="blur",Pl=Fd;break;case"beforeblur":case"afterblur":Pl=Fd;break;case"click":if(o.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Pl=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Pl=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Pl=Vd;break;case $e:case af:case bf:Pl=Hd;break;case cf:Pl=Xd;break;case"scroll":Pl=vd;break;case"wheel":Pl=Zd;break;case"copy":case"cut":case"paste":Pl=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Pl=Td}var Jl=(e&4)!==0,zl=!Jl&&i==="scroll",Bl=Jl?Cl!==null?Cl+"Capture":null:Cl;Jl=[];for(var Vl=_c,_d;Vl!==null;){_d=Vl;var Sp=_d.stateNode;if(_d.tag===5&&Sp!==null&&(_d=Sp,Bl!==null&&(Sp=Kb(Vl,Bl),Sp!=null&&Jl.push(tf(Vl,Sp,_d)))),zl)break;Vl=Vl.return}0<Jl.length&&(Cl=new Pl(Cl,Dl,null,o,_l),Tl.push({event:Cl,listeners:Jl}))}}if(!(e&7)){t:{if(Cl=i==="mouseover"||i==="pointerover",Pl=i==="mouseout"||i==="pointerout",Cl&&o!==wb&&(Dl=o.relatedTarget||o.fromElement)&&(Wc(Dl)||Dl[uf]))break t;if((Pl||Cl)&&(Cl=_l.window===_l?_l:(Cl=_l.ownerDocument)?Cl.defaultView||Cl.parentWindow:window,Pl?(Dl=o.relatedTarget||o.toElement,Pl=_c,Dl=Dl?Wc(Dl):null,Dl!==null&&(zl=Vb(Dl),Dl!==zl||Dl.tag!==5&&Dl.tag!==6)&&(Dl=null)):(Pl=null,Dl=_c),Pl!==Dl)){if(Jl=Bd,Sp="onMouseLeave",Bl="onMouseEnter",Vl="mouse",(i==="pointerout"||i==="pointerover")&&(Jl=Td,Sp="onPointerLeave",Bl="onPointerEnter",Vl="pointer"),zl=Pl==null?Cl:ue(Pl),_d=Dl==null?Cl:ue(Dl),Cl=new Jl(Sp,Vl+"leave",Pl,o,_l),Cl.target=zl,Cl.relatedTarget=_d,Sp=null,Wc(_l)===_c&&(Jl=new Jl(Bl,Vl+"enter",Dl,o,_l),Jl.target=_d,Jl.relatedTarget=zl,Sp=Jl),zl=Sp,Pl&&Dl)e:{for(Jl=Pl,Bl=Dl,Vl=0,_d=Jl;_d;_d=vf(_d))Vl++;for(_d=0,Sp=Bl;Sp;Sp=vf(Sp))_d++;for(;0<Vl-_d;)Jl=vf(Jl),Vl--;for(;0<_d-Vl;)Bl=vf(Bl),_d--;for(;Vl--;){if(Jl===Bl||Bl!==null&&Jl===Bl.alternate)break e;Jl=vf(Jl),Bl=vf(Bl)}Jl=null}else Jl=null;Pl!==null&&wf(Tl,Cl,Pl,Jl,!1),Dl!==null&&zl!==null&&wf(Tl,zl,Dl,Jl,!0)}}t:{if(Cl=_c?ue(_c):window,Pl=Cl.nodeName&&Cl.nodeName.toLowerCase(),Pl==="select"||Pl==="input"&&Cl.type==="file")var Up=ve;else if(me(Cl))if(we)Up=Fe;else{Up=De;var Kp=Ce}else(Pl=Cl.nodeName)&&Pl.toLowerCase()==="input"&&(Cl.type==="checkbox"||Cl.type==="radio")&&(Up=Ee);if(Up&&(Up=Up(i,_c))){ne(Tl,Up,o,_l);break t}Kp&&Kp(i,Cl,_c),i==="focusout"&&(Kp=Cl._wrapperState)&&Kp.controlled&&Cl.type==="number"&&cb(Cl,"number",Cl.value)}switch(Kp=_c?ue(_c):window,i){case"focusin":(me(Kp)||Kp.contentEditable==="true")&&(Qe=Kp,Re=_c,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(Tl,o,_l);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(Tl,o,_l)}var Hp;if(ae)t:{switch(i){case"compositionstart":var _m="onCompositionStart";break t;case"compositionend":_m="onCompositionEnd";break t;case"compositionupdate":_m="onCompositionUpdate";break t}_m=void 0}else ie?ge(i,o)&&(_m="onCompositionEnd"):i==="keydown"&&o.keyCode===229&&(_m="onCompositionStart");_m&&(de&&o.locale!=="ko"&&(ie||_m!=="onCompositionStart"?_m==="onCompositionEnd"&&ie&&(Hp=nd()):(kd=_l,ld="value"in kd?kd.value:kd.textContent,ie=!0)),Kp=oe(_c,_m),0<Kp.length&&(_m=new Ld(_m,i,null,o,_l),Tl.push({event:_m,listeners:Kp}),Hp?_m.data=Hp:(Hp=he(o),Hp!==null&&(_m.data=Hp)))),(Hp=ce?je(i,o):ke(i,o))&&(_c=oe(_c,"onBeforeInput"),0<_c.length&&(_l=new Ld("onBeforeInput","beforeinput",null,o,_l),Tl.push({event:_l,listeners:_c}),_l.data=Hp))}se(Tl,e)})}function tf(i,e,o){return{instance:i,listener:e,currentTarget:o}}function oe(i,e){for(var o=e+"Capture",c=[];i!==null;){var _=i,$=_.stateNode;_.tag===5&&$!==null&&(_=$,$=Kb(i,o),$!=null&&c.unshift(tf(i,$,_)),$=Kb(i,e),$!=null&&c.push(tf(i,$,_))),i=i.return}return c}function vf(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function wf(i,e,o,c,_){for(var $=e._reactName,_t=[];o!==null&&o!==c;){var ga=o,_s=ga.alternate,_c=ga.stateNode;if(_s!==null&&_s===c)break;ga.tag===5&&_c!==null&&(ga=_c,_?(_s=Kb(o,$),_s!=null&&_t.unshift(tf(o,_s,ga))):_||(_s=Kb(o,$),_s!=null&&_t.push(tf(o,_s,ga)))),o=o.return}_t.length!==0&&i.push({event:e,listeners:_t})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(i){return(typeof i=="string"?i:""+i).replace(xf,`
`).replace(yf,"")}function Af(i,e,o){if(e=zf(e),zf(i)!==e&&o)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(i){return Hf.resolve(null).then(i).catch(If)}:Ff;function If(i){setTimeout(function(){throw i})}function Kf(i,e){var o=e,c=0;do{var _=o.nextSibling;if(i.removeChild(o),_&&_.nodeType===8)if(o=_.data,o==="/$"){if(c===0){i.removeChild(_),bd(e);return}c--}else o!=="$"&&o!=="$?"&&o!=="$!"||c++;o=_}while(o);bd(e)}function Lf(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function Mf(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var o=i.data;if(o==="$"||o==="$!"||o==="$?"){if(e===0)return i;e--}else o==="/$"&&e++}i=i.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(i){var e=i[Of];if(e)return e;for(var o=i.parentNode;o;){if(e=o[uf]||o[Of]){if(o=e.alternate,e.child!==null||o!==null&&o.child!==null)for(i=Mf(i);i!==null;){if(o=i[Of])return o;i=Mf(i)}return e}i=o,o=i.parentNode}return null}function Cb(i){return i=i[Of]||i[uf],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function ue(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(p(33))}function Db(i){return i[Pf]||null}var Sf=[],Tf=-1;function Uf(i){return{current:i}}function E(i){0>Tf||(i.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(i,e){Tf++,Sf[Tf]=i.current,i.current=e}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(i,e){var o=i.type.contextTypes;if(!o)return Vf;var c=i.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===e)return c.__reactInternalMemoizedMaskedChildContext;var _={},$;for($ in o)_[$]=e[$];return c&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=_),_}function Zf(i){return i=i.childContextTypes,i!=null}function $f(){E(Wf),E(H)}function ag(i,e,o){if(H.current!==Vf)throw Error(p(168));G(H,e),G(Wf,o)}function bg(i,e,o){var c=i.stateNode;if(e=e.childContextTypes,typeof c.getChildContext!="function")return o;c=c.getChildContext();for(var _ in c)if(!(_ in e))throw Error(p(108,Ra(i)||"Unknown",_));return A({},o,c)}function cg(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,i),G(Wf,Wf.current),!0}function dg(i,e,o){var c=i.stateNode;if(!c)throw Error(p(169));o?(i=bg(i,e,Xf),c.__reactInternalMemoizedMergedChildContext=i,E(Wf),E(H),G(H,i)):E(Wf),G(Wf,o)}var eg=null,fg=!1,gg=!1;function hg(i){eg===null?eg=[i]:eg.push(i)}function ig(i){fg=!0,hg(i)}function jg(){if(!gg&&eg!==null){gg=!0;var i=0,e=C;try{var o=eg;for(C=1;i<o.length;i++){var c=o[i];do c=c(!0);while(c!==null)}eg=null,fg=!1}catch(_){throw eg!==null&&(eg=eg.slice(i+1)),ac(fc,jg),_}finally{C=e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(i,e){kg[lg++]=ng,kg[lg++]=mg,mg=i,ng=e}function ug(i,e,o){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=i;var c=rg;i=sg;var _=32-oc(c)-1;c&=~(1<<_),o+=1;var $=32-oc(e)+_;if(30<$){var _t=_-_%5;$=(c&(1<<_t)-1).toString(32),c>>=_t,_-=_t,rg=1<<32-oc(e)+_|o<<_|c,sg=$+i}else rg=1<<$|o<<_|c,sg=i}function vg(i){i.return!==null&&(tg(i,1),ug(i,1,0))}function wg(i){for(;i===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;i===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(i,e){var o=Bg(5,null,null,0);o.elementType="DELETED",o.stateNode=e,o.return=i,e=i.deletions,e===null?(i.deletions=[o],i.flags|=16):e.push(o)}function Cg(i,e){switch(i.tag){case 5:var o=i.type;return e=e.nodeType!==1||o.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,xg=i,yg=Lf(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,xg=i,yg=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(o=qg!==null?{id:rg,overflow:sg}:null,i.memoizedState={dehydrated:e,treeContext:o,retryLane:1073741824},o=Bg(18,null,null,0),o.stateNode=e,o.return=i,i.child=o,xg=i,yg=null,!0):!1;default:return!1}}function Dg(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Eg(i){if(I){var e=yg;if(e){var o=e;if(!Cg(i,e)){if(Dg(i))throw Error(p(418));e=Lf(o.nextSibling);var c=xg;e&&Cg(i,e)?Ag(c,o):(i.flags=i.flags&-4097|2,I=!1,xg=i)}}else{if(Dg(i))throw Error(p(418));i.flags=i.flags&-4097|2,I=!1,xg=i}}}function Fg(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;xg=i}function Gg(i){if(i!==xg)return!1;if(!I)return Fg(i),I=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!Ef(i.type,i.memoizedProps)),e&&(e=yg)){if(Dg(i))throw Hg(),Error(p(418));for(;e;)Ag(i,e),e=Lf(e.nextSibling)}if(Fg(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(p(317));t:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var o=i.data;if(o==="/$"){if(e===0){yg=Lf(i.nextSibling);break t}e--}else o!=="$"&&o!=="$!"&&o!=="$?"||e++}i=i.nextSibling}yg=null}}else yg=xg?Lf(i.stateNode.nextSibling):null;return!0}function Hg(){for(var i=yg;i;)i=Lf(i.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(i){zg===null?zg=[i]:zg.push(i)}var Kg=ua.ReactCurrentBatchConfig;function Lg(i,e){if(i&&i.defaultProps){e=A({},e),i=i.defaultProps;for(var o in i)e[o]===void 0&&(e[o]=i[o]);return e}return e}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(i){var e=Mg.current;E(Mg),i._currentValue=e}function Sg(i,e,o){for(;i!==null;){var c=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,c!==null&&(c.childLanes|=e)):c!==null&&(c.childLanes&e)!==e&&(c.childLanes|=e),i===o)break;i=i.return}}function Tg(i,e){Ng=i,Pg=Og=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(Ug=!0),i.firstContext=null)}function Vg(i){var e=i._currentValue;if(Pg!==i)if(i={context:i,memoizedValue:e,next:null},Og===null){if(Ng===null)throw Error(p(308));Og=i,Ng.dependencies={lanes:0,firstContext:i}}else Og=Og.next=i;return e}var Wg=null;function Xg(i){Wg===null?Wg=[i]:Wg.push(i)}function Yg(i,e,o,c){var _=e.interleaved;return _===null?(o.next=o,Xg(e)):(o.next=_.next,_.next=o),e.interleaved=o,Zg(i,c)}function Zg(i,e){i.lanes|=e;var o=i.alternate;for(o!==null&&(o.lanes|=e),o=i,i=i.return;i!==null;)i.childLanes|=e,o=i.alternate,o!==null&&(o.childLanes|=e),o=i,i=i.return;return o.tag===3?o.stateNode:null}var $g=!1;function ah(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ch(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function dh(i,e,o){var c=i.updateQueue;if(c===null)return null;if(c=c.shared,K&2){var _=c.pending;return _===null?e.next=e:(e.next=_.next,_.next=e),c.pending=e,Zg(i,o)}return _=c.interleaved,_===null?(e.next=e,Xg(c)):(e.next=_.next,_.next=e),c.interleaved=e,Zg(i,o)}function eh(i,e,o){if(e=e.updateQueue,e!==null&&(e=e.shared,(o&4194240)!==0)){var c=e.lanes;c&=i.pendingLanes,o|=c,e.lanes=o,Cc(i,o)}}function fh(i,e){var o=i.updateQueue,c=i.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var _=null,$=null;if(o=o.firstBaseUpdate,o!==null){do{var _t={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};$===null?_=$=_t:$=$.next=_t,o=o.next}while(o!==null);$===null?_=$=e:$=$.next=e}else _=$=e;o={baseState:c.baseState,firstBaseUpdate:_,lastBaseUpdate:$,shared:c.shared,effects:c.effects},i.updateQueue=o;return}i=o.lastBaseUpdate,i===null?o.firstBaseUpdate=e:i.next=e,o.lastBaseUpdate=e}function gh(i,e,o,c){var _=i.updateQueue;$g=!1;var $=_.firstBaseUpdate,_t=_.lastBaseUpdate,ga=_.shared.pending;if(ga!==null){_.shared.pending=null;var _s=ga,_c=_s.next;_s.next=null,_t===null?$=_c:_t.next=_c,_t=_s;var _l=i.alternate;_l!==null&&(_l=_l.updateQueue,ga=_l.lastBaseUpdate,ga!==_t&&(ga===null?_l.firstBaseUpdate=_c:ga.next=_c,_l.lastBaseUpdate=_s))}if($!==null){var Tl=_.baseState;_t=0,_l=_c=_s=null,ga=$;do{var Cl=ga.lane,Pl=ga.eventTime;if((c&Cl)===Cl){_l!==null&&(_l=_l.next={eventTime:Pl,lane:0,tag:ga.tag,payload:ga.payload,callback:ga.callback,next:null});t:{var Dl=i,Jl=ga;switch(Cl=e,Pl=o,Jl.tag){case 1:if(Dl=Jl.payload,typeof Dl=="function"){Tl=Dl.call(Pl,Tl,Cl);break t}Tl=Dl;break t;case 3:Dl.flags=Dl.flags&-65537|128;case 0:if(Dl=Jl.payload,Cl=typeof Dl=="function"?Dl.call(Pl,Tl,Cl):Dl,Cl==null)break t;Tl=A({},Tl,Cl);break t;case 2:$g=!0}}ga.callback!==null&&ga.lane!==0&&(i.flags|=64,Cl=_.effects,Cl===null?_.effects=[ga]:Cl.push(ga))}else Pl={eventTime:Pl,lane:Cl,tag:ga.tag,payload:ga.payload,callback:ga.callback,next:null},_l===null?(_c=_l=Pl,_s=Tl):_l=_l.next=Pl,_t|=Cl;if(ga=ga.next,ga===null){if(ga=_.shared.pending,ga===null)break;Cl=ga,ga=Cl.next,Cl.next=null,_.lastBaseUpdate=Cl,_.shared.pending=null}}while(1);if(_l===null&&(_s=Tl),_.baseState=_s,_.firstBaseUpdate=_c,_.lastBaseUpdate=_l,e=_.shared.interleaved,e!==null){_=e;do _t|=_.lane,_=_.next;while(_!==e)}else $===null&&(_.shared.lanes=0);hh|=_t,i.lanes=_t,i.memoizedState=Tl}}function ih(i,e,o){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var c=i[e],_=c.callback;if(_!==null){if(c.callback=null,c=o,typeof _!="function")throw Error(p(191,_));_.call(c)}}}var jh=new aa.Component().refs;function kh(i,e,o,c){e=i.memoizedState,o=o(c,e),o=o==null?e:A({},e,o),i.memoizedState=o,i.lanes===0&&(i.updateQueue.baseState=o)}var nh={isMounted:function(i){return(i=i._reactInternals)?Vb(i)===i:!1},enqueueSetState:function(i,e,o){i=i._reactInternals;var c=L(),_=lh(i),$=ch(c,_);$.payload=e,o!=null&&($.callback=o),e=dh(i,$,_),e!==null&&(mh(e,i,_,c),eh(e,i,_))},enqueueReplaceState:function(i,e,o){i=i._reactInternals;var c=L(),_=lh(i),$=ch(c,_);$.tag=1,$.payload=e,o!=null&&($.callback=o),e=dh(i,$,_),e!==null&&(mh(e,i,_,c),eh(e,i,_))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var o=L(),c=lh(i),_=ch(o,c);_.tag=2,e!=null&&(_.callback=e),e=dh(i,_,c),e!==null&&(mh(e,i,c,o),eh(e,i,c))}};function oh(i,e,o,c,_,$,_t){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(c,$,_t):e.prototype&&e.prototype.isPureReactComponent?!Ie(o,c)||!Ie(_,$):!0}function ph(i,e,o){var c=!1,_=Vf,$=e.contextType;return typeof $=="object"&&$!==null?$=Vg($):(_=Zf(e)?Xf:H.current,c=e.contextTypes,$=(c=c!=null)?Yf(i,_):Vf),e=new e(o,$),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=nh,i.stateNode=e,e._reactInternals=i,c&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=_,i.__reactInternalMemoizedMaskedChildContext=$),e}function qh(i,e,o,c){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(o,c),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(o,c),e.state!==i&&nh.enqueueReplaceState(e,e.state,null)}function rh(i,e,o,c){var _=i.stateNode;_.props=o,_.state=i.memoizedState,_.refs=jh,ah(i);var $=e.contextType;typeof $=="object"&&$!==null?_.context=Vg($):($=Zf(e)?Xf:H.current,_.context=Yf(i,$)),_.state=i.memoizedState,$=e.getDerivedStateFromProps,typeof $=="function"&&(kh(i,e,$,o),_.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(e=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),e!==_.state&&nh.enqueueReplaceState(_,_.state,null),gh(i,o,_,c),_.state=i.memoizedState),typeof _.componentDidMount=="function"&&(i.flags|=4194308)}function sh(i,e,o){if(i=o.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(p(309));var c=o.stateNode}if(!c)throw Error(p(147,i));var _=c,$=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===$?e.ref:(e=function(_t){var ga=_.refs;ga===jh&&(ga=_.refs={}),_t===null?delete ga[$]:ga[$]=_t},e._stringRef=$,e)}if(typeof i!="string")throw Error(p(284));if(!o._owner)throw Error(p(290,i))}return i}function th(i,e){throw i=Object.prototype.toString.call(e),Error(p(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function uh(i){var e=i._init;return e(i._payload)}function vh(i){function e(Bl,Vl){if(i){var _d=Bl.deletions;_d===null?(Bl.deletions=[Vl],Bl.flags|=16):_d.push(Vl)}}function o(Bl,Vl){if(!i)return null;for(;Vl!==null;)e(Bl,Vl),Vl=Vl.sibling;return null}function c(Bl,Vl){for(Bl=new Map;Vl!==null;)Vl.key!==null?Bl.set(Vl.key,Vl):Bl.set(Vl.index,Vl),Vl=Vl.sibling;return Bl}function _(Bl,Vl){return Bl=wh(Bl,Vl),Bl.index=0,Bl.sibling=null,Bl}function $(Bl,Vl,_d){return Bl.index=_d,i?(_d=Bl.alternate,_d!==null?(_d=_d.index,_d<Vl?(Bl.flags|=2,Vl):_d):(Bl.flags|=2,Vl)):(Bl.flags|=1048576,Vl)}function _t(Bl){return i&&Bl.alternate===null&&(Bl.flags|=2),Bl}function ga(Bl,Vl,_d,Sp){return Vl===null||Vl.tag!==6?(Vl=xh(_d,Bl.mode,Sp),Vl.return=Bl,Vl):(Vl=_(Vl,_d),Vl.return=Bl,Vl)}function _s(Bl,Vl,_d,Sp){var Up=_d.type;return Up===ya?_l(Bl,Vl,_d.props.children,Sp,_d.key):Vl!==null&&(Vl.elementType===Up||typeof Up=="object"&&Up!==null&&Up.$$typeof===Ha&&uh(Up)===Vl.type)?(Sp=_(Vl,_d.props),Sp.ref=sh(Bl,Vl,_d),Sp.return=Bl,Sp):(Sp=yh(_d.type,_d.key,_d.props,null,Bl.mode,Sp),Sp.ref=sh(Bl,Vl,_d),Sp.return=Bl,Sp)}function _c(Bl,Vl,_d,Sp){return Vl===null||Vl.tag!==4||Vl.stateNode.containerInfo!==_d.containerInfo||Vl.stateNode.implementation!==_d.implementation?(Vl=zh(_d,Bl.mode,Sp),Vl.return=Bl,Vl):(Vl=_(Vl,_d.children||[]),Vl.return=Bl,Vl)}function _l(Bl,Vl,_d,Sp,Up){return Vl===null||Vl.tag!==7?(Vl=Ah(_d,Bl.mode,Sp,Up),Vl.return=Bl,Vl):(Vl=_(Vl,_d),Vl.return=Bl,Vl)}function Tl(Bl,Vl,_d){if(typeof Vl=="string"&&Vl!==""||typeof Vl=="number")return Vl=xh(""+Vl,Bl.mode,_d),Vl.return=Bl,Vl;if(typeof Vl=="object"&&Vl!==null){switch(Vl.$$typeof){case va:return _d=yh(Vl.type,Vl.key,Vl.props,null,Bl.mode,_d),_d.ref=sh(Bl,null,Vl),_d.return=Bl,_d;case wa:return Vl=zh(Vl,Bl.mode,_d),Vl.return=Bl,Vl;case Ha:var Sp=Vl._init;return Tl(Bl,Sp(Vl._payload),_d)}if(eb(Vl)||Ka(Vl))return Vl=Ah(Vl,Bl.mode,_d,null),Vl.return=Bl,Vl;th(Bl,Vl)}return null}function Cl(Bl,Vl,_d,Sp){var Up=Vl!==null?Vl.key:null;if(typeof _d=="string"&&_d!==""||typeof _d=="number")return Up!==null?null:ga(Bl,Vl,""+_d,Sp);if(typeof _d=="object"&&_d!==null){switch(_d.$$typeof){case va:return _d.key===Up?_s(Bl,Vl,_d,Sp):null;case wa:return _d.key===Up?_c(Bl,Vl,_d,Sp):null;case Ha:return Up=_d._init,Cl(Bl,Vl,Up(_d._payload),Sp)}if(eb(_d)||Ka(_d))return Up!==null?null:_l(Bl,Vl,_d,Sp,null);th(Bl,_d)}return null}function Pl(Bl,Vl,_d,Sp,Up){if(typeof Sp=="string"&&Sp!==""||typeof Sp=="number")return Bl=Bl.get(_d)||null,ga(Vl,Bl,""+Sp,Up);if(typeof Sp=="object"&&Sp!==null){switch(Sp.$$typeof){case va:return Bl=Bl.get(Sp.key===null?_d:Sp.key)||null,_s(Vl,Bl,Sp,Up);case wa:return Bl=Bl.get(Sp.key===null?_d:Sp.key)||null,_c(Vl,Bl,Sp,Up);case Ha:var Kp=Sp._init;return Pl(Bl,Vl,_d,Kp(Sp._payload),Up)}if(eb(Sp)||Ka(Sp))return Bl=Bl.get(_d)||null,_l(Vl,Bl,Sp,Up,null);th(Vl,Sp)}return null}function Dl(Bl,Vl,_d,Sp){for(var Up=null,Kp=null,Hp=Vl,_m=Vl=0,I0=null;Hp!==null&&_m<_d.length;_m++){Hp.index>_m?(I0=Hp,Hp=null):I0=Hp.sibling;var Cp=Cl(Bl,Hp,_d[_m],Sp);if(Cp===null){Hp===null&&(Hp=I0);break}i&&Hp&&Cp.alternate===null&&e(Bl,Hp),Vl=$(Cp,Vl,_m),Kp===null?Up=Cp:Kp.sibling=Cp,Kp=Cp,Hp=I0}if(_m===_d.length)return o(Bl,Hp),I&&tg(Bl,_m),Up;if(Hp===null){for(;_m<_d.length;_m++)Hp=Tl(Bl,_d[_m],Sp),Hp!==null&&(Vl=$(Hp,Vl,_m),Kp===null?Up=Hp:Kp.sibling=Hp,Kp=Hp);return I&&tg(Bl,_m),Up}for(Hp=c(Bl,Hp);_m<_d.length;_m++)I0=Pl(Hp,Bl,_m,_d[_m],Sp),I0!==null&&(i&&I0.alternate!==null&&Hp.delete(I0.key===null?_m:I0.key),Vl=$(I0,Vl,_m),Kp===null?Up=I0:Kp.sibling=I0,Kp=I0);return i&&Hp.forEach(function(Jp){return e(Bl,Jp)}),I&&tg(Bl,_m),Up}function Jl(Bl,Vl,_d,Sp){var Up=Ka(_d);if(typeof Up!="function")throw Error(p(150));if(_d=Up.call(_d),_d==null)throw Error(p(151));for(var Kp=Up=null,Hp=Vl,_m=Vl=0,I0=null,Cp=_d.next();Hp!==null&&!Cp.done;_m++,Cp=_d.next()){Hp.index>_m?(I0=Hp,Hp=null):I0=Hp.sibling;var Jp=Cl(Bl,Hp,Cp.value,Sp);if(Jp===null){Hp===null&&(Hp=I0);break}i&&Hp&&Jp.alternate===null&&e(Bl,Hp),Vl=$(Jp,Vl,_m),Kp===null?Up=Jp:Kp.sibling=Jp,Kp=Jp,Hp=I0}if(Cp.done)return o(Bl,Hp),I&&tg(Bl,_m),Up;if(Hp===null){for(;!Cp.done;_m++,Cp=_d.next())Cp=Tl(Bl,Cp.value,Sp),Cp!==null&&(Vl=$(Cp,Vl,_m),Kp===null?Up=Cp:Kp.sibling=Cp,Kp=Cp);return I&&tg(Bl,_m),Up}for(Hp=c(Bl,Hp);!Cp.done;_m++,Cp=_d.next())Cp=Pl(Hp,Bl,_m,Cp.value,Sp),Cp!==null&&(i&&Cp.alternate!==null&&Hp.delete(Cp.key===null?_m:Cp.key),Vl=$(Cp,Vl,_m),Kp===null?Up=Cp:Kp.sibling=Cp,Kp=Cp);return i&&Hp.forEach(function(Zp){return e(Bl,Zp)}),I&&tg(Bl,_m),Up}function zl(Bl,Vl,_d,Sp){if(typeof _d=="object"&&_d!==null&&_d.type===ya&&_d.key===null&&(_d=_d.props.children),typeof _d=="object"&&_d!==null){switch(_d.$$typeof){case va:t:{for(var Up=_d.key,Kp=Vl;Kp!==null;){if(Kp.key===Up){if(Up=_d.type,Up===ya){if(Kp.tag===7){o(Bl,Kp.sibling),Vl=_(Kp,_d.props.children),Vl.return=Bl,Bl=Vl;break t}}else if(Kp.elementType===Up||typeof Up=="object"&&Up!==null&&Up.$$typeof===Ha&&uh(Up)===Kp.type){o(Bl,Kp.sibling),Vl=_(Kp,_d.props),Vl.ref=sh(Bl,Kp,_d),Vl.return=Bl,Bl=Vl;break t}o(Bl,Kp);break}else e(Bl,Kp);Kp=Kp.sibling}_d.type===ya?(Vl=Ah(_d.props.children,Bl.mode,Sp,_d.key),Vl.return=Bl,Bl=Vl):(Sp=yh(_d.type,_d.key,_d.props,null,Bl.mode,Sp),Sp.ref=sh(Bl,Vl,_d),Sp.return=Bl,Bl=Sp)}return _t(Bl);case wa:t:{for(Kp=_d.key;Vl!==null;){if(Vl.key===Kp)if(Vl.tag===4&&Vl.stateNode.containerInfo===_d.containerInfo&&Vl.stateNode.implementation===_d.implementation){o(Bl,Vl.sibling),Vl=_(Vl,_d.children||[]),Vl.return=Bl,Bl=Vl;break t}else{o(Bl,Vl);break}else e(Bl,Vl);Vl=Vl.sibling}Vl=zh(_d,Bl.mode,Sp),Vl.return=Bl,Bl=Vl}return _t(Bl);case Ha:return Kp=_d._init,zl(Bl,Vl,Kp(_d._payload),Sp)}if(eb(_d))return Dl(Bl,Vl,_d,Sp);if(Ka(_d))return Jl(Bl,Vl,_d,Sp);th(Bl,_d)}return typeof _d=="string"&&_d!==""||typeof _d=="number"?(_d=""+_d,Vl!==null&&Vl.tag===6?(o(Bl,Vl.sibling),Vl=_(Vl,_d),Vl.return=Bl,Bl=Vl):(o(Bl,Vl),Vl=xh(_d,Bl.mode,Sp),Vl.return=Bl,Bl=Vl),_t(Bl)):o(Bl,Vl)}return zl}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(i){if(i===Dh)throw Error(p(174));return i}function Ih(i,e){switch(G(Gh,e),G(Fh,i),G(Eh,Dh),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lb(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=lb(e,i)}E(Eh),G(Eh,e)}function Jh(){E(Eh),E(Fh),E(Gh)}function Kh(i){Hh(Gh.current);var e=Hh(Eh.current),o=lb(e,i.type);e!==o&&(G(Fh,i),G(Eh,o))}function Lh(i){Fh.current===i&&(E(Eh),E(Fh))}var M=Uf(0);function Mh(i){for(var e=i;e!==null;){if(e.tag===13){var o=e.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Nh=[];function Oh(){for(var i=0;i<Nh.length;i++)Nh[i]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N=null,O=null,P=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q(){throw Error(p(321))}function Wh(i,e){if(e===null)return!1;for(var o=0;o<e.length&&o<i.length;o++)if(!He(i[o],e[o]))return!1;return!0}function Xh(i,e,o,c,_,$){if(Rh=$,N=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ph.current=i===null||i.memoizedState===null?Yh:Zh,i=o(c,_),Th){$=0;do{if(Th=!1,Uh=0,25<=$)throw Error(p(301));$+=1,P=O=null,e.updateQueue=null,Ph.current=$h,i=o(c,_)}while(Th)}if(Ph.current=ai,e=O!==null&&O.next!==null,Rh=0,P=O=N=null,Sh=!1,e)throw Error(p(300));return i}function bi(){var i=Uh!==0;return Uh=0,i}function ci(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N.memoizedState=P=i:P=P.next=i,P}function di(){if(O===null){var i=N.alternate;i=i!==null?i.memoizedState:null}else i=O.next;var e=P===null?N.memoizedState:P.next;if(e!==null)P=e,O=i;else{if(i===null)throw Error(p(310));O=i,i={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null},P===null?N.memoizedState=P=i:P=P.next=i}return P}function ei(i,e){return typeof e=="function"?e(i):e}function fi(i){var e=di(),o=e.queue;if(o===null)throw Error(p(311));o.lastRenderedReducer=i;var c=O,_=c.baseQueue,$=o.pending;if($!==null){if(_!==null){var _t=_.next;_.next=$.next,$.next=_t}c.baseQueue=_=$,o.pending=null}if(_!==null){$=_.next,c=c.baseState;var ga=_t=null,_s=null,_c=$;do{var _l=_c.lane;if((Rh&_l)===_l)_s!==null&&(_s=_s.next={lane:0,action:_c.action,hasEagerState:_c.hasEagerState,eagerState:_c.eagerState,next:null}),c=_c.hasEagerState?_c.eagerState:i(c,_c.action);else{var Tl={lane:_l,action:_c.action,hasEagerState:_c.hasEagerState,eagerState:_c.eagerState,next:null};_s===null?(ga=_s=Tl,_t=c):_s=_s.next=Tl,N.lanes|=_l,hh|=_l}_c=_c.next}while(_c!==null&&_c!==$);_s===null?_t=c:_s.next=ga,He(c,e.memoizedState)||(Ug=!0),e.memoizedState=c,e.baseState=_t,e.baseQueue=_s,o.lastRenderedState=c}if(i=o.interleaved,i!==null){_=i;do $=_.lane,N.lanes|=$,hh|=$,_=_.next;while(_!==i)}else _===null&&(o.lanes=0);return[e.memoizedState,o.dispatch]}function gi(i){var e=di(),o=e.queue;if(o===null)throw Error(p(311));o.lastRenderedReducer=i;var c=o.dispatch,_=o.pending,$=e.memoizedState;if(_!==null){o.pending=null;var _t=_=_.next;do $=i($,_t.action),_t=_t.next;while(_t!==_);He($,e.memoizedState)||(Ug=!0),e.memoizedState=$,e.baseQueue===null&&(e.baseState=$),o.lastRenderedState=$}return[$,c]}function hi(){}function ii(i,e){var o=N,c=di(),_=e(),$=!He(c.memoizedState,_);if($&&(c.memoizedState=_,Ug=!0),c=c.queue,ji(ki.bind(null,o,c,i),[i]),c.getSnapshot!==e||$||P!==null&&P.memoizedState.tag&1){if(o.flags|=2048,li(9,mi.bind(null,o,c,_,e),void 0,null),R===null)throw Error(p(349));Rh&30||ni(o,e,_)}return _}function ni(i,e,o){i.flags|=16384,i={getSnapshot:e,value:o},e=N.updateQueue,e===null?(e={lastEffect:null,stores:null},N.updateQueue=e,e.stores=[i]):(o=e.stores,o===null?e.stores=[i]:o.push(i))}function mi(i,e,o,c){e.value=o,e.getSnapshot=c,oi(e)&&pi(i)}function ki(i,e,o){return o(function(){oi(e)&&pi(i)})}function oi(i){var e=i.getSnapshot;i=i.value;try{var o=e();return!He(i,o)}catch{return!0}}function pi(i){var e=Zg(i,1);e!==null&&mh(e,i,1,-1)}function qi(i){var e=ci();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:i},e.queue=i,i=i.dispatch=ri.bind(null,N,i),[e.memoizedState,i]}function li(i,e,o,c){return i={tag:i,create:e,destroy:o,deps:c,next:null},e=N.updateQueue,e===null?(e={lastEffect:null,stores:null},N.updateQueue=e,e.lastEffect=i.next=i):(o=e.lastEffect,o===null?e.lastEffect=i.next=i:(c=o.next,o.next=i,i.next=c,e.lastEffect=i)),i}function si(){return di().memoizedState}function ti(i,e,o,c){var _=ci();N.flags|=i,_.memoizedState=li(1|e,o,void 0,c===void 0?null:c)}function ui(i,e,o,c){var _=di();c=c===void 0?null:c;var $=void 0;if(O!==null){var _t=O.memoizedState;if($=_t.destroy,c!==null&&Wh(c,_t.deps)){_.memoizedState=li(e,o,$,c);return}}N.flags|=i,_.memoizedState=li(1|e,o,$,c)}function vi(i,e){return ti(8390656,8,i,e)}function ji(i,e){return ui(2048,8,i,e)}function wi(i,e){return ui(4,2,i,e)}function xi(i,e){return ui(4,4,i,e)}function yi(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function zi(i,e,o){return o=o!=null?o.concat([i]):null,ui(4,4,yi.bind(null,e,i),o)}function Ai(){}function Bi(i,e){var o=di();e=e===void 0?null:e;var c=o.memoizedState;return c!==null&&e!==null&&Wh(e,c[1])?c[0]:(o.memoizedState=[i,e],i)}function Ci(i,e){var o=di();e=e===void 0?null:e;var c=o.memoizedState;return c!==null&&e!==null&&Wh(e,c[1])?c[0]:(i=i(),o.memoizedState=[i,e],i)}function Di(i,e,o){return Rh&21?(He(o,e)||(o=yc(),N.lanes|=o,hh|=o,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,Ug=!0),i.memoizedState=o)}function Ei(i,e){var o=C;C=o!==0&&4>o?o:4,i(!0);var c=Qh.transition;Qh.transition={};try{i(!1),e()}finally{C=o,Qh.transition=c}}function Fi(){return di().memoizedState}function Gi(i,e,o){var c=lh(i);if(o={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null},Hi(i))Ii(e,o);else if(o=Yg(i,e,o,c),o!==null){var _=L();mh(o,i,c,_),Ji(o,e,c)}}function ri(i,e,o){var c=lh(i),_={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null};if(Hi(i))Ii(e,_);else{var $=i.alternate;if(i.lanes===0&&($===null||$.lanes===0)&&($=e.lastRenderedReducer,$!==null))try{var _t=e.lastRenderedState,ga=$(_t,o);if(_.hasEagerState=!0,_.eagerState=ga,He(ga,_t)){var _s=e.interleaved;_s===null?(_.next=_,Xg(e)):(_.next=_s.next,_s.next=_),e.interleaved=_;return}}catch{}finally{}o=Yg(i,e,_,c),o!==null&&(_=L(),mh(o,i,c,_),Ji(o,e,c))}}function Hi(i){var e=i.alternate;return i===N||e!==null&&e===N}function Ii(i,e){Th=Sh=!0;var o=i.pending;o===null?e.next=e:(e.next=o.next,o.next=e),i.pending=e}function Ji(i,e,o){if(o&4194240){var c=e.lanes;c&=i.pendingLanes,o|=c,e.lanes=o,Cc(i,o)}}var ai={readContext:Vg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useInsertionEffect:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useDeferredValue:Q,useTransition:Q,useMutableSource:Q,useSyncExternalStore:Q,useId:Q,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(i,e){return ci().memoizedState=[i,e===void 0?null:e],i},useContext:Vg,useEffect:vi,useImperativeHandle:function(i,e,o){return o=o!=null?o.concat([i]):null,ti(4194308,4,yi.bind(null,e,i),o)},useLayoutEffect:function(i,e){return ti(4194308,4,i,e)},useInsertionEffect:function(i,e){return ti(4,2,i,e)},useMemo:function(i,e){var o=ci();return e=e===void 0?null:e,i=i(),o.memoizedState=[i,e],i},useReducer:function(i,e,o){var c=ci();return e=o!==void 0?o(e):e,c.memoizedState=c.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},c.queue=i,i=i.dispatch=Gi.bind(null,N,i),[c.memoizedState,i]},useRef:function(i){var e=ci();return i={current:i},e.memoizedState=i},useState:qi,useDebugValue:Ai,useDeferredValue:function(i){return ci().memoizedState=i},useTransition:function(){var i=qi(!1),e=i[0];return i=Ei.bind(null,i[1]),ci().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,o){var c=N,_=ci();if(I){if(o===void 0)throw Error(p(407));o=o()}else{if(o=e(),R===null)throw Error(p(349));Rh&30||ni(c,e,o)}_.memoizedState=o;var $={value:o,getSnapshot:e};return _.queue=$,vi(ki.bind(null,c,$,i),[i]),c.flags|=2048,li(9,mi.bind(null,c,$,o,e),void 0,null),o},useId:function(){var i=ci(),e=R.identifierPrefix;if(I){var o=sg,c=rg;o=(c&~(1<<32-oc(c)-1)).toString(32)+o,e=":"+e+"R"+o,o=Uh++,0<o&&(e+="H"+o.toString(32)),e+=":"}else o=Vh++,e=":"+e+"r"+o.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(i){var e=di();return Di(e,O.memoizedState,i)},useTransition:function(){var i=fi(ei)[0],e=di().memoizedState;return[i,e]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(i){var e=di();return O===null?e.memoizedState=i:Di(e,O.memoizedState,i)},useTransition:function(){var i=gi(ei)[0],e=di().memoizedState;return[i,e]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(i,e){try{var o="",c=e;do o+=Pa(c),c=c.return;while(c);var _=o}catch($){_=`
Error generating stack: `+$.message+`
`+$.stack}return{value:i,source:e,stack:_,digest:null}}function Li(i,e,o){return{value:i,source:null,stack:o??null,digest:e??null}}function Mi(i,e){try{console.error(e.value)}catch(o){setTimeout(function(){throw o})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(i,e,o){o=ch(-1,o),o.tag=3,o.payload={element:null};var c=e.value;return o.callback=function(){Pi||(Pi=!0,Qi=c),Mi(i,e)},o}function Ri(i,e,o){o=ch(-1,o),o.tag=3;var c=i.type.getDerivedStateFromError;if(typeof c=="function"){var _=e.value;o.payload=function(){return c(_)},o.callback=function(){Mi(i,e)}}var $=i.stateNode;return $!==null&&typeof $.componentDidCatch=="function"&&(o.callback=function(){Mi(i,e),typeof c!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var _t=e.stack;this.componentDidCatch(e.value,{componentStack:_t!==null?_t:""})}),o}function Ti(i,e,o){var c=i.pingCache;if(c===null){c=i.pingCache=new Ni;var _=new Set;c.set(e,_)}else _=c.get(e),_===void 0&&(_=new Set,c.set(e,_));_.has(o)||(_.add(o),i=Ui.bind(null,i,e,o),e.then(i,i))}function Vi(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function Wi(i,e,o,c,_){return i.mode&1?(i.flags|=65536,i.lanes=_,i):(i===e?i.flags|=65536:(i.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(e=ch(-1,1),e.tag=2,dh(o,e,1))),o.lanes|=1),i)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(i,e,o,c){e.child=i===null?Ch(e,null,o,c):Bh(e,i.child,o,c)}function Zi(i,e,o,c,_){o=o.render;var $=e.ref;return Tg(e,_),c=Xh(i,e,o,c,$,_),o=bi(),i!==null&&!Ug?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~_,$i(i,e,_)):(I&&o&&vg(e),e.flags|=1,Yi(i,e,c,_),e.child)}function aj(i,e,o,c,_){if(i===null){var $=o.type;return typeof $=="function"&&!bj($)&&$.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(e.tag=15,e.type=$,cj(i,e,$,c,_)):(i=yh(o.type,null,c,e,e.mode,_),i.ref=e.ref,i.return=e,e.child=i)}if($=i.child,!(i.lanes&_)){var _t=$.memoizedProps;if(o=o.compare,o=o!==null?o:Ie,o(_t,c)&&i.ref===e.ref)return $i(i,e,_)}return e.flags|=1,i=wh($,c),i.ref=e.ref,i.return=e,e.child=i}function cj(i,e,o,c,_){if(i!==null){var $=i.memoizedProps;if(Ie($,c)&&i.ref===e.ref)if(Ug=!1,e.pendingProps=c=$,(i.lanes&_)!==0)i.flags&131072&&(Ug=!0);else return e.lanes=i.lanes,$i(i,e,_)}return dj(i,e,o,c,_)}function ej(i,e,o){var c=e.pendingProps,_=c.children,$=i!==null?i.memoizedState:null;if(c.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(fj,gj),gj|=o;else{if(!(o&1073741824))return i=$!==null?$.baseLanes|o:o,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,G(fj,gj),gj|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=$!==null?$.baseLanes:o,G(fj,gj),gj|=c}else $!==null?(c=$.baseLanes|o,e.memoizedState=null):c=o,G(fj,gj),gj|=c;return Yi(i,e,_,o),e.child}function hj(i,e){var o=e.ref;(i===null&&o!==null||i!==null&&i.ref!==o)&&(e.flags|=512,e.flags|=2097152)}function dj(i,e,o,c,_){var $=Zf(o)?Xf:H.current;return $=Yf(e,$),Tg(e,_),o=Xh(i,e,o,c,$,_),c=bi(),i!==null&&!Ug?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~_,$i(i,e,_)):(I&&c&&vg(e),e.flags|=1,Yi(i,e,o,_),e.child)}function ij(i,e,o,c,_){if(Zf(o)){var $=!0;cg(e)}else $=!1;if(Tg(e,_),e.stateNode===null)jj(i,e),ph(e,o,c),rh(e,o,c,_),c=!0;else if(i===null){var _t=e.stateNode,ga=e.memoizedProps;_t.props=ga;var _s=_t.context,_c=o.contextType;typeof _c=="object"&&_c!==null?_c=Vg(_c):(_c=Zf(o)?Xf:H.current,_c=Yf(e,_c));var _l=o.getDerivedStateFromProps,Tl=typeof _l=="function"||typeof _t.getSnapshotBeforeUpdate=="function";Tl||typeof _t.UNSAFE_componentWillReceiveProps!="function"&&typeof _t.componentWillReceiveProps!="function"||(ga!==c||_s!==_c)&&qh(e,_t,c,_c),$g=!1;var Cl=e.memoizedState;_t.state=Cl,gh(e,c,_t,_),_s=e.memoizedState,ga!==c||Cl!==_s||Wf.current||$g?(typeof _l=="function"&&(kh(e,o,_l,c),_s=e.memoizedState),(ga=$g||oh(e,o,ga,c,Cl,_s,_c))?(Tl||typeof _t.UNSAFE_componentWillMount!="function"&&typeof _t.componentWillMount!="function"||(typeof _t.componentWillMount=="function"&&_t.componentWillMount(),typeof _t.UNSAFE_componentWillMount=="function"&&_t.UNSAFE_componentWillMount()),typeof _t.componentDidMount=="function"&&(e.flags|=4194308)):(typeof _t.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=c,e.memoizedState=_s),_t.props=c,_t.state=_s,_t.context=_c,c=ga):(typeof _t.componentDidMount=="function"&&(e.flags|=4194308),c=!1)}else{_t=e.stateNode,bh(i,e),ga=e.memoizedProps,_c=e.type===e.elementType?ga:Lg(e.type,ga),_t.props=_c,Tl=e.pendingProps,Cl=_t.context,_s=o.contextType,typeof _s=="object"&&_s!==null?_s=Vg(_s):(_s=Zf(o)?Xf:H.current,_s=Yf(e,_s));var Pl=o.getDerivedStateFromProps;(_l=typeof Pl=="function"||typeof _t.getSnapshotBeforeUpdate=="function")||typeof _t.UNSAFE_componentWillReceiveProps!="function"&&typeof _t.componentWillReceiveProps!="function"||(ga!==Tl||Cl!==_s)&&qh(e,_t,c,_s),$g=!1,Cl=e.memoizedState,_t.state=Cl,gh(e,c,_t,_);var Dl=e.memoizedState;ga!==Tl||Cl!==Dl||Wf.current||$g?(typeof Pl=="function"&&(kh(e,o,Pl,c),Dl=e.memoizedState),(_c=$g||oh(e,o,_c,c,Cl,Dl,_s)||!1)?(_l||typeof _t.UNSAFE_componentWillUpdate!="function"&&typeof _t.componentWillUpdate!="function"||(typeof _t.componentWillUpdate=="function"&&_t.componentWillUpdate(c,Dl,_s),typeof _t.UNSAFE_componentWillUpdate=="function"&&_t.UNSAFE_componentWillUpdate(c,Dl,_s)),typeof _t.componentDidUpdate=="function"&&(e.flags|=4),typeof _t.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof _t.componentDidUpdate!="function"||ga===i.memoizedProps&&Cl===i.memoizedState||(e.flags|=4),typeof _t.getSnapshotBeforeUpdate!="function"||ga===i.memoizedProps&&Cl===i.memoizedState||(e.flags|=1024),e.memoizedProps=c,e.memoizedState=Dl),_t.props=c,_t.state=Dl,_t.context=_s,c=_c):(typeof _t.componentDidUpdate!="function"||ga===i.memoizedProps&&Cl===i.memoizedState||(e.flags|=4),typeof _t.getSnapshotBeforeUpdate!="function"||ga===i.memoizedProps&&Cl===i.memoizedState||(e.flags|=1024),c=!1)}return kj(i,e,o,c,$,_)}function kj(i,e,o,c,_,$){hj(i,e);var _t=(e.flags&128)!==0;if(!c&&!_t)return _&&dg(e,o,!1),$i(i,e,$);c=e.stateNode,Xi.current=e;var ga=_t&&typeof o.getDerivedStateFromError!="function"?null:c.render();return e.flags|=1,i!==null&&_t?(e.child=Bh(e,i.child,null,$),e.child=Bh(e,null,ga,$)):Yi(i,e,ga,$),e.memoizedState=c.state,_&&dg(e,o,!0),e.child}function lj(i){var e=i.stateNode;e.pendingContext?ag(i,e.pendingContext,e.pendingContext!==e.context):e.context&&ag(i,e.context,!1),Ih(i,e.containerInfo)}function mj(i,e,o,c,_){return Ig(),Jg(_),e.flags|=256,Yi(i,e,o,c),e.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(i){return{baseLanes:i,cachePool:null,transitions:null}}function pj(i,e,o){var c=e.pendingProps,_=M.current,$=!1,_t=(e.flags&128)!==0,ga;if((ga=_t)||(ga=i!==null&&i.memoizedState===null?!1:(_&2)!==0),ga?($=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(_|=1),G(M,_&1),i===null)return Eg(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(_t=c.children,i=c.fallback,$?(c=e.mode,$=e.child,_t={mode:"hidden",children:_t},!(c&1)&&$!==null?($.childLanes=0,$.pendingProps=_t):$=qj(_t,c,0,null),i=Ah(i,c,o,null),$.return=e,i.return=e,$.sibling=i,e.child=$,e.child.memoizedState=oj(o),e.memoizedState=nj,i):rj(e,_t));if(_=i.memoizedState,_!==null&&(ga=_.dehydrated,ga!==null))return sj(i,e,_t,c,ga,_,o);if($){$=c.fallback,_t=e.mode,_=i.child,ga=_.sibling;var _s={mode:"hidden",children:c.children};return!(_t&1)&&e.child!==_?(c=e.child,c.childLanes=0,c.pendingProps=_s,e.deletions=null):(c=wh(_,_s),c.subtreeFlags=_.subtreeFlags&14680064),ga!==null?$=wh(ga,$):($=Ah($,_t,o,null),$.flags|=2),$.return=e,c.return=e,c.sibling=$,e.child=c,c=$,$=e.child,_t=i.child.memoizedState,_t=_t===null?oj(o):{baseLanes:_t.baseLanes|o,cachePool:null,transitions:_t.transitions},$.memoizedState=_t,$.childLanes=i.childLanes&~o,e.memoizedState=nj,c}return $=i.child,i=$.sibling,c=wh($,{mode:"visible",children:c.children}),!(e.mode&1)&&(c.lanes=o),c.return=e,c.sibling=null,i!==null&&(o=e.deletions,o===null?(e.deletions=[i],e.flags|=16):o.push(i)),e.child=c,e.memoizedState=null,c}function rj(i,e){return e=qj({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function tj(i,e,o,c){return c!==null&&Jg(c),Bh(e,i.child,null,o),i=rj(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function sj(i,e,o,c,_,$,_t){if(o)return e.flags&256?(e.flags&=-257,c=Li(Error(p(422))),tj(i,e,_t,c)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):($=c.fallback,_=e.mode,c=qj({mode:"visible",children:c.children},_,0,null),$=Ah($,_,_t,null),$.flags|=2,c.return=e,$.return=e,c.sibling=$,e.child=c,e.mode&1&&Bh(e,i.child,null,_t),e.child.memoizedState=oj(_t),e.memoizedState=nj,$);if(!(e.mode&1))return tj(i,e,_t,null);if(_.data==="$!"){if(c=_.nextSibling&&_.nextSibling.dataset,c)var ga=c.dgst;return c=ga,$=Error(p(419)),c=Li($,c,void 0),tj(i,e,_t,c)}if(ga=(_t&i.childLanes)!==0,Ug||ga){if(c=R,c!==null){switch(_t&-_t){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(c.suspendedLanes|_t)?0:_,_!==0&&_!==$.retryLane&&($.retryLane=_,Zg(i,_),mh(c,i,_,-1))}return uj(),c=Li(Error(p(421))),tj(i,e,_t,c)}return _.data==="$?"?(e.flags|=128,e.child=i.child,e=vj.bind(null,i),_._reactRetry=e,null):(i=$.treeContext,yg=Lf(_.nextSibling),xg=e,I=!0,zg=null,i!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=i.id,sg=i.overflow,qg=e),e=rj(e,c.children),e.flags|=4096,e)}function wj(i,e,o){i.lanes|=e;var c=i.alternate;c!==null&&(c.lanes|=e),Sg(i.return,e,o)}function xj(i,e,o,c,_){var $=i.memoizedState;$===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:_}:($.isBackwards=e,$.rendering=null,$.renderingStartTime=0,$.last=c,$.tail=o,$.tailMode=_)}function yj(i,e,o){var c=e.pendingProps,_=c.revealOrder,$=c.tail;if(Yi(i,e,c.children,o),c=M.current,c&2)c=c&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)t:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&wj(i,o,e);else if(i.tag===19)wj(i,o,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break t;for(;i.sibling===null;){if(i.return===null||i.return===e)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}c&=1}if(G(M,c),!(e.mode&1))e.memoizedState=null;else switch(_){case"forwards":for(o=e.child,_=null;o!==null;)i=o.alternate,i!==null&&Mh(i)===null&&(_=o),o=o.sibling;o=_,o===null?(_=e.child,e.child=null):(_=o.sibling,o.sibling=null),xj(e,!1,_,o,$);break;case"backwards":for(o=null,_=e.child,e.child=null;_!==null;){if(i=_.alternate,i!==null&&Mh(i)===null){e.child=_;break}i=_.sibling,_.sibling=o,o=_,_=i}xj(e,!0,o,null,$);break;case"together":xj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function jj(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function $i(i,e,o){if(i!==null&&(e.dependencies=i.dependencies),hh|=e.lanes,!(o&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(p(153));if(e.child!==null){for(i=e.child,o=wh(i,i.pendingProps),e.child=o,o.return=e;i.sibling!==null;)i=i.sibling,o=o.sibling=wh(i,i.pendingProps),o.return=e;o.sibling=null}return e.child}function zj(i,e,o){switch(e.tag){case 3:lj(e),Ig();break;case 5:Kh(e);break;case 1:Zf(e.type)&&cg(e);break;case 4:Ih(e,e.stateNode.containerInfo);break;case 10:var c=e.type._context,_=e.memoizedProps.value;G(Mg,c._currentValue),c._currentValue=_;break;case 13:if(c=e.memoizedState,c!==null)return c.dehydrated!==null?(G(M,M.current&1),e.flags|=128,null):o&e.child.childLanes?pj(i,e,o):(G(M,M.current&1),i=$i(i,e,o),i!==null?i.sibling:null);G(M,M.current&1);break;case 19:if(c=(o&e.childLanes)!==0,i.flags&128){if(c)return yj(i,e,o);e.flags|=128}if(_=e.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),G(M,M.current),c)break;return null;case 22:case 23:return e.lanes=0,ej(i,e,o)}return $i(i,e,o)}var Aj,Bj,Cj,Dj;Aj=function(i,e){for(var o=e.child;o!==null;){if(o.tag===5||o.tag===6)i.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};Bj=function(){};Cj=function(i,e,o,c){var _=i.memoizedProps;if(_!==c){i=e.stateNode,Hh(Eh.current);var $=null;switch(o){case"input":_=Ya(i,_),c=Ya(i,c),$=[];break;case"select":_=A({},_,{value:void 0}),c=A({},c,{value:void 0}),$=[];break;case"textarea":_=gb(i,_),c=gb(i,c),$=[];break;default:typeof _.onClick!="function"&&typeof c.onClick=="function"&&(i.onclick=Bf)}ub(o,c);var _t;o=null;for(_c in _)if(!c.hasOwnProperty(_c)&&_.hasOwnProperty(_c)&&_[_c]!=null)if(_c==="style"){var ga=_[_c];for(_t in ga)ga.hasOwnProperty(_t)&&(o||(o={}),o[_t]="")}else _c!=="dangerouslySetInnerHTML"&&_c!=="children"&&_c!=="suppressContentEditableWarning"&&_c!=="suppressHydrationWarning"&&_c!=="autoFocus"&&(ea.hasOwnProperty(_c)?$||($=[]):($=$||[]).push(_c,null));for(_c in c){var _s=c[_c];if(ga=_!=null?_[_c]:void 0,c.hasOwnProperty(_c)&&_s!==ga&&(_s!=null||ga!=null))if(_c==="style")if(ga){for(_t in ga)!ga.hasOwnProperty(_t)||_s&&_s.hasOwnProperty(_t)||(o||(o={}),o[_t]="");for(_t in _s)_s.hasOwnProperty(_t)&&ga[_t]!==_s[_t]&&(o||(o={}),o[_t]=_s[_t])}else o||($||($=[]),$.push(_c,o)),o=_s;else _c==="dangerouslySetInnerHTML"?(_s=_s?_s.__html:void 0,ga=ga?ga.__html:void 0,_s!=null&&ga!==_s&&($=$||[]).push(_c,_s)):_c==="children"?typeof _s!="string"&&typeof _s!="number"||($=$||[]).push(_c,""+_s):_c!=="suppressContentEditableWarning"&&_c!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_c)?(_s!=null&&_c==="onScroll"&&D("scroll",i),$||ga===_s||($=[])):($=$||[]).push(_c,_s))}o&&($=$||[]).push("style",o);var _c=$;(e.updateQueue=_c)&&(e.flags|=4)}};Dj=function(i,e,o,c){o!==c&&(e.flags|=4)};function Ej(i,e){if(!I)switch(i.tailMode){case"hidden":e=i.tail;for(var o=null;e!==null;)e.alternate!==null&&(o=e),e=e.sibling;o===null?i.tail=null:o.sibling=null;break;case"collapsed":o=i.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:c.sibling=null}}function S(i){var e=i.alternate!==null&&i.alternate.child===i.child,o=0,c=0;if(e)for(var _=i.child;_!==null;)o|=_.lanes|_.childLanes,c|=_.subtreeFlags&14680064,c|=_.flags&14680064,_.return=i,_=_.sibling;else for(_=i.child;_!==null;)o|=_.lanes|_.childLanes,c|=_.subtreeFlags,c|=_.flags,_.return=i,_=_.sibling;return i.subtreeFlags|=c,i.childLanes=o,e}function Fj(i,e,o){var c=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(e),null;case 1:return Zf(e.type)&&$f(),S(e),null;case 3:return c=e.stateNode,Jh(),E(Wf),E(H),Oh(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(Gg(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(i,e),S(e),null;case 5:Lh(e);var _=Hh(Gh.current);if(o=e.type,i!==null&&e.stateNode!=null)Cj(i,e,o,c,_),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!c){if(e.stateNode===null)throw Error(p(166));return S(e),null}if(i=Hh(Eh.current),Gg(e)){c=e.stateNode,o=e.type;var $=e.memoizedProps;switch(c[Of]=e,c[Pf]=$,i=(e.mode&1)!==0,o){case"dialog":D("cancel",c),D("close",c);break;case"iframe":case"object":case"embed":D("load",c);break;case"video":case"audio":for(_=0;_<lf.length;_++)D(lf[_],c);break;case"source":D("error",c);break;case"img":case"image":case"link":D("error",c),D("load",c);break;case"details":D("toggle",c);break;case"input":Za(c,$),D("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!$.multiple},D("invalid",c);break;case"textarea":hb(c,$),D("invalid",c)}ub(o,$),_=null;for(var _t in $)if($.hasOwnProperty(_t)){var ga=$[_t];_t==="children"?typeof ga=="string"?c.textContent!==ga&&($.suppressHydrationWarning!==!0&&Af(c.textContent,ga,i),_=["children",ga]):typeof ga=="number"&&c.textContent!==""+ga&&($.suppressHydrationWarning!==!0&&Af(c.textContent,ga,i),_=["children",""+ga]):ea.hasOwnProperty(_t)&&ga!=null&&_t==="onScroll"&&D("scroll",c)}switch(o){case"input":Va(c),db(c,$,!0);break;case"textarea":Va(c),jb(c);break;case"select":case"option":break;default:typeof $.onClick=="function"&&(c.onclick=Bf)}c=_,e.updateQueue=c,c!==null&&(e.flags|=4)}else{_t=_.nodeType===9?_:_.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=kb(o)),i==="http://www.w3.org/1999/xhtml"?o==="script"?(i=_t.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof c.is=="string"?i=_t.createElement(o,{is:c.is}):(i=_t.createElement(o),o==="select"&&(_t=i,c.multiple?_t.multiple=!0:c.size&&(_t.size=c.size))):i=_t.createElementNS(i,o),i[Of]=e,i[Pf]=c,Aj(i,e,!1,!1),e.stateNode=i;t:{switch(_t=vb(o,c),o){case"dialog":D("cancel",i),D("close",i),_=c;break;case"iframe":case"object":case"embed":D("load",i),_=c;break;case"video":case"audio":for(_=0;_<lf.length;_++)D(lf[_],i);_=c;break;case"source":D("error",i),_=c;break;case"img":case"image":case"link":D("error",i),D("load",i),_=c;break;case"details":D("toggle",i),_=c;break;case"input":Za(i,c),_=Ya(i,c),D("invalid",i);break;case"option":_=c;break;case"select":i._wrapperState={wasMultiple:!!c.multiple},_=A({},c,{value:void 0}),D("invalid",i);break;case"textarea":hb(i,c),_=gb(i,c),D("invalid",i);break;default:_=c}ub(o,_),ga=_;for($ in ga)if(ga.hasOwnProperty($)){var _s=ga[$];$==="style"?sb(i,_s):$==="dangerouslySetInnerHTML"?(_s=_s?_s.__html:void 0,_s!=null&&nb(i,_s)):$==="children"?typeof _s=="string"?(o!=="textarea"||_s!=="")&&ob(i,_s):typeof _s=="number"&&ob(i,""+_s):$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&$!=="autoFocus"&&(ea.hasOwnProperty($)?_s!=null&&$==="onScroll"&&D("scroll",i):_s!=null&&ta(i,$,_s,_t))}switch(o){case"input":Va(i),db(i,c,!1);break;case"textarea":Va(i),jb(i);break;case"option":c.value!=null&&i.setAttribute("value",""+Sa(c.value));break;case"select":i.multiple=!!c.multiple,$=c.value,$!=null?fb(i,!!c.multiple,$,!1):c.defaultValue!=null&&fb(i,!!c.multiple,c.defaultValue,!0);break;default:typeof _.onClick=="function"&&(i.onclick=Bf)}switch(o){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break t;case"img":c=!0;break t;default:c=!1}}c&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return S(e),null;case 6:if(i&&e.stateNode!=null)Dj(i,e,i.memoizedProps,c);else{if(typeof c!="string"&&e.stateNode===null)throw Error(p(166));if(o=Hh(Gh.current),Hh(Eh.current),Gg(e)){if(c=e.stateNode,o=e.memoizedProps,c[Of]=e,($=c.nodeValue!==o)&&(i=xg,i!==null))switch(i.tag){case 3:Af(c.nodeValue,o,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Af(c.nodeValue,o,(i.mode&1)!==0)}$&&(e.flags|=4)}else c=(o.nodeType===9?o:o.ownerDocument).createTextNode(c),c[Of]=e,e.stateNode=c}return S(e),null;case 13:if(E(M),c=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(I&&yg!==null&&e.mode&1&&!(e.flags&128))Hg(),Ig(),e.flags|=98560,$=!1;else if($=Gg(e),c!==null&&c.dehydrated!==null){if(i===null){if(!$)throw Error(p(318));if($=e.memoizedState,$=$!==null?$.dehydrated:null,!$)throw Error(p(317));$[Of]=e}else Ig(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;S(e),$=!1}else zg!==null&&(Gj(zg),zg=null),$=!0;if(!$)return e.flags&65536?e:null}return e.flags&128?(e.lanes=o,e):(c=c!==null,c!==(i!==null&&i.memoizedState!==null)&&c&&(e.child.flags|=8192,e.mode&1&&(i===null||M.current&1?T===0&&(T=3):uj())),e.updateQueue!==null&&(e.flags|=4),S(e),null);case 4:return Jh(),Bj(i,e),i===null&&sf(e.stateNode.containerInfo),S(e),null;case 10:return Rg(e.type._context),S(e),null;case 17:return Zf(e.type)&&$f(),S(e),null;case 19:if(E(M),$=e.memoizedState,$===null)return S(e),null;if(c=(e.flags&128)!==0,_t=$.rendering,_t===null)if(c)Ej($,!1);else{if(T!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(_t=Mh(i),_t!==null){for(e.flags|=128,Ej($,!1),c=_t.updateQueue,c!==null&&(e.updateQueue=c,e.flags|=4),e.subtreeFlags=0,c=o,o=e.child;o!==null;)$=o,i=c,$.flags&=14680066,_t=$.alternate,_t===null?($.childLanes=0,$.lanes=i,$.child=null,$.subtreeFlags=0,$.memoizedProps=null,$.memoizedState=null,$.updateQueue=null,$.dependencies=null,$.stateNode=null):($.childLanes=_t.childLanes,$.lanes=_t.lanes,$.child=_t.child,$.subtreeFlags=0,$.deletions=null,$.memoizedProps=_t.memoizedProps,$.memoizedState=_t.memoizedState,$.updateQueue=_t.updateQueue,$.type=_t.type,i=_t.dependencies,$.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),o=o.sibling;return G(M,M.current&1|2),e.child}i=i.sibling}$.tail!==null&&B()>Hj&&(e.flags|=128,c=!0,Ej($,!1),e.lanes=4194304)}else{if(!c)if(i=Mh(_t),i!==null){if(e.flags|=128,c=!0,o=i.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),Ej($,!0),$.tail===null&&$.tailMode==="hidden"&&!_t.alternate&&!I)return S(e),null}else 2*B()-$.renderingStartTime>Hj&&o!==1073741824&&(e.flags|=128,c=!0,Ej($,!1),e.lanes=4194304);$.isBackwards?(_t.sibling=e.child,e.child=_t):(o=$.last,o!==null?o.sibling=_t:e.child=_t,$.last=_t)}return $.tail!==null?(e=$.tail,$.rendering=e,$.tail=e.sibling,$.renderingStartTime=B(),e.sibling=null,o=M.current,G(M,c?o&1|2:o&1),e):(S(e),null);case 22:case 23:return Ij(),c=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==c&&(e.flags|=8192),c&&e.mode&1?gj&1073741824&&(S(e),e.subtreeFlags&6&&(e.flags|=8192)):S(e),null;case 24:return null;case 25:return null}throw Error(p(156,e.tag))}function Jj(i,e){switch(wg(e),e.tag){case 1:return Zf(e.type)&&$f(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return Jh(),E(Wf),E(H),Oh(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return Lh(e),null;case 13:if(E(M),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(p(340));Ig()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return E(M),null;case 4:return Jh(),null;case 10:return Rg(e.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Mj(i,e){var o=i.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(c){W(i,e,c)}else o.current=null}function Nj(i,e,o){try{o()}catch(c){W(i,e,c)}}var Oj=!1;function Pj(i,e){if(Cf=dd,i=Me(),Ne(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else t:{o=(o=i.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var _=c.anchorOffset,$=c.focusNode;c=c.focusOffset;try{o.nodeType,$.nodeType}catch{o=null;break t}var _t=0,ga=-1,_s=-1,_c=0,_l=0,Tl=i,Cl=null;e:for(;;){for(var Pl;Tl!==o||_!==0&&Tl.nodeType!==3||(ga=_t+_),Tl!==$||c!==0&&Tl.nodeType!==3||(_s=_t+c),Tl.nodeType===3&&(_t+=Tl.nodeValue.length),(Pl=Tl.firstChild)!==null;)Cl=Tl,Tl=Pl;for(;;){if(Tl===i)break e;if(Cl===o&&++_c===_&&(ga=_t),Cl===$&&++_l===c&&(_s=_t),(Pl=Tl.nextSibling)!==null)break;Tl=Cl,Cl=Tl.parentNode}Tl=Pl}o=ga===-1||_s===-1?null:{start:ga,end:_s}}else o=null}o=o||{start:0,end:0}}else o=null;for(Df={focusedElem:i,selectionRange:o},dd=!1,V=e;V!==null;)if(e=V,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,V=i;else for(;V!==null;){e=V;try{var Dl=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(Dl!==null){var Jl=Dl.memoizedProps,zl=Dl.memoizedState,Bl=e.stateNode,Vl=Bl.getSnapshotBeforeUpdate(e.elementType===e.type?Jl:Lg(e.type,Jl),zl);Bl.__reactInternalSnapshotBeforeUpdate=Vl}break;case 3:var _d=e.stateNode.containerInfo;_d.nodeType===1?_d.textContent="":_d.nodeType===9&&_d.documentElement&&_d.removeChild(_d.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(Sp){W(e,e.return,Sp)}if(i=e.sibling,i!==null){i.return=e.return,V=i;break}V=e.return}return Dl=Oj,Oj=!1,Dl}function Qj(i,e,o){var c=e.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var _=c=c.next;do{if((_.tag&i)===i){var $=_.destroy;_.destroy=void 0,$!==void 0&&Nj(e,o,$)}_=_.next}while(_!==c)}}function Rj(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var o=e=e.next;do{if((o.tag&i)===i){var c=o.create;o.destroy=c()}o=o.next}while(o!==e)}}function Sj(i){var e=i.ref;if(e!==null){var o=i.stateNode;switch(i.tag){case 5:i=o;break;default:i=o}typeof e=="function"?e(i):e.current=i}}function Tj(i){var e=i.alternate;e!==null&&(i.alternate=null,Tj(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[Of],delete e[Pf],delete e[of],delete e[Qf],delete e[Rf])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Uj(i){return i.tag===5||i.tag===3||i.tag===4}function Vj(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||Uj(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Wj(i,e,o){var c=i.tag;if(c===5||c===6)i=i.stateNode,e?o.nodeType===8?o.parentNode.insertBefore(i,e):o.insertBefore(i,e):(o.nodeType===8?(e=o.parentNode,e.insertBefore(i,o)):(e=o,e.appendChild(i)),o=o._reactRootContainer,o!=null||e.onclick!==null||(e.onclick=Bf));else if(c!==4&&(i=i.child,i!==null))for(Wj(i,e,o),i=i.sibling;i!==null;)Wj(i,e,o),i=i.sibling}function Xj(i,e,o){var c=i.tag;if(c===5||c===6)i=i.stateNode,e?o.insertBefore(i,e):o.appendChild(i);else if(c!==4&&(i=i.child,i!==null))for(Xj(i,e,o),i=i.sibling;i!==null;)Xj(i,e,o),i=i.sibling}var X=null,Yj=!1;function Zj(i,e,o){for(o=o.child;o!==null;)ak(i,e,o),o=o.sibling}function ak(i,e,o){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,o)}catch{}switch(o.tag){case 5:U||Mj(o,e);case 6:var c=X,_=Yj;X=null,Zj(i,e,o),X=c,Yj=_,X!==null&&(Yj?(i=X,o=o.stateNode,i.nodeType===8?i.parentNode.removeChild(o):i.removeChild(o)):X.removeChild(o.stateNode));break;case 18:X!==null&&(Yj?(i=X,o=o.stateNode,i.nodeType===8?Kf(i.parentNode,o):i.nodeType===1&&Kf(i,o),bd(i)):Kf(X,o.stateNode));break;case 4:c=X,_=Yj,X=o.stateNode.containerInfo,Yj=!0,Zj(i,e,o),X=c,Yj=_;break;case 0:case 11:case 14:case 15:if(!U&&(c=o.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){_=c=c.next;do{var $=_,_t=$.destroy;$=$.tag,_t!==void 0&&($&2||$&4)&&Nj(o,e,_t),_=_.next}while(_!==c)}Zj(i,e,o);break;case 1:if(!U&&(Mj(o,e),c=o.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=o.memoizedProps,c.state=o.memoizedState,c.componentWillUnmount()}catch(ga){W(o,e,ga)}Zj(i,e,o);break;case 21:Zj(i,e,o);break;case 22:o.mode&1?(U=(c=U)||o.memoizedState!==null,Zj(i,e,o),U=c):Zj(i,e,o);break;default:Zj(i,e,o)}}function bk(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var o=i.stateNode;o===null&&(o=i.stateNode=new Lj),e.forEach(function(c){var _=ck.bind(null,i,c);o.has(c)||(o.add(c),c.then(_,_))})}}function dk(i,e){var o=e.deletions;if(o!==null)for(var c=0;c<o.length;c++){var _=o[c];try{var $=i,_t=e,ga=_t;t:for(;ga!==null;){switch(ga.tag){case 5:X=ga.stateNode,Yj=!1;break t;case 3:X=ga.stateNode.containerInfo,Yj=!0;break t;case 4:X=ga.stateNode.containerInfo,Yj=!0;break t}ga=ga.return}if(X===null)throw Error(p(160));ak($,_t,_),X=null,Yj=!1;var _s=_.alternate;_s!==null&&(_s.return=null),_.return=null}catch(_c){W(_,e,_c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ek(e,i),e=e.sibling}function ek(i,e){var o=i.alternate,c=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(dk(e,i),fk(i),c&4){try{Qj(3,i,i.return),Rj(3,i)}catch(Jl){W(i,i.return,Jl)}try{Qj(5,i,i.return)}catch(Jl){W(i,i.return,Jl)}}break;case 1:dk(e,i),fk(i),c&512&&o!==null&&Mj(o,o.return);break;case 5:if(dk(e,i),fk(i),c&512&&o!==null&&Mj(o,o.return),i.flags&32){var _=i.stateNode;try{ob(_,"")}catch(Jl){W(i,i.return,Jl)}}if(c&4&&(_=i.stateNode,_!=null)){var $=i.memoizedProps,_t=o!==null?o.memoizedProps:$,ga=i.type,_s=i.updateQueue;if(i.updateQueue=null,_s!==null)try{ga==="input"&&$.type==="radio"&&$.name!=null&&ab(_,$),vb(ga,_t);var _c=vb(ga,$);for(_t=0;_t<_s.length;_t+=2){var _l=_s[_t],Tl=_s[_t+1];_l==="style"?sb(_,Tl):_l==="dangerouslySetInnerHTML"?nb(_,Tl):_l==="children"?ob(_,Tl):ta(_,_l,Tl,_c)}switch(ga){case"input":bb(_,$);break;case"textarea":ib(_,$);break;case"select":var Cl=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!$.multiple;var Pl=$.value;Pl!=null?fb(_,!!$.multiple,Pl,!1):Cl!==!!$.multiple&&($.defaultValue!=null?fb(_,!!$.multiple,$.defaultValue,!0):fb(_,!!$.multiple,$.multiple?[]:"",!1))}_[Pf]=$}catch(Jl){W(i,i.return,Jl)}}break;case 6:if(dk(e,i),fk(i),c&4){if(i.stateNode===null)throw Error(p(162));_=i.stateNode,$=i.memoizedProps;try{_.nodeValue=$}catch(Jl){W(i,i.return,Jl)}}break;case 3:if(dk(e,i),fk(i),c&4&&o!==null&&o.memoizedState.isDehydrated)try{bd(e.containerInfo)}catch(Jl){W(i,i.return,Jl)}break;case 4:dk(e,i),fk(i);break;case 13:dk(e,i),fk(i),_=i.child,_.flags&8192&&($=_.memoizedState!==null,_.stateNode.isHidden=$,!$||_.alternate!==null&&_.alternate.memoizedState!==null||(gk=B())),c&4&&bk(i);break;case 22:if(_l=o!==null&&o.memoizedState!==null,i.mode&1?(U=(_c=U)||_l,dk(e,i),U=_c):dk(e,i),fk(i),c&8192){if(_c=i.memoizedState!==null,(i.stateNode.isHidden=_c)&&!_l&&i.mode&1)for(V=i,_l=i.child;_l!==null;){for(Tl=V=_l;V!==null;){switch(Cl=V,Pl=Cl.child,Cl.tag){case 0:case 11:case 14:case 15:Qj(4,Cl,Cl.return);break;case 1:Mj(Cl,Cl.return);var Dl=Cl.stateNode;if(typeof Dl.componentWillUnmount=="function"){c=Cl,o=Cl.return;try{e=c,Dl.props=e.memoizedProps,Dl.state=e.memoizedState,Dl.componentWillUnmount()}catch(Jl){W(c,o,Jl)}}break;case 5:Mj(Cl,Cl.return);break;case 22:if(Cl.memoizedState!==null){hk(Tl);continue}}Pl!==null?(Pl.return=Cl,V=Pl):hk(Tl)}_l=_l.sibling}t:for(_l=null,Tl=i;;){if(Tl.tag===5){if(_l===null){_l=Tl;try{_=Tl.stateNode,_c?($=_.style,typeof $.setProperty=="function"?$.setProperty("display","none","important"):$.display="none"):(ga=Tl.stateNode,_s=Tl.memoizedProps.style,_t=_s!=null&&_s.hasOwnProperty("display")?_s.display:null,ga.style.display=rb("display",_t))}catch(Jl){W(i,i.return,Jl)}}}else if(Tl.tag===6){if(_l===null)try{Tl.stateNode.nodeValue=_c?"":Tl.memoizedProps}catch(Jl){W(i,i.return,Jl)}}else if((Tl.tag!==22&&Tl.tag!==23||Tl.memoizedState===null||Tl===i)&&Tl.child!==null){Tl.child.return=Tl,Tl=Tl.child;continue}if(Tl===i)break t;for(;Tl.sibling===null;){if(Tl.return===null||Tl.return===i)break t;_l===Tl&&(_l=null),Tl=Tl.return}_l===Tl&&(_l=null),Tl.sibling.return=Tl.return,Tl=Tl.sibling}}break;case 19:dk(e,i),fk(i),c&4&&bk(i);break;case 21:break;default:dk(e,i),fk(i)}}function fk(i){var e=i.flags;if(e&2){try{t:{for(var o=i.return;o!==null;){if(Uj(o)){var c=o;break t}o=o.return}throw Error(p(160))}switch(c.tag){case 5:var _=c.stateNode;c.flags&32&&(ob(_,""),c.flags&=-33);var $=Vj(i);Xj(i,$,_);break;case 3:case 4:var _t=c.stateNode.containerInfo,ga=Vj(i);Wj(i,ga,_t);break;default:throw Error(p(161))}}catch(_s){W(i,i.return,_s)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function ik(i,e,o){V=i,jk(i)}function jk(i,e,o){for(var c=(i.mode&1)!==0;V!==null;){var _=V,$=_.child;if(_.tag===22&&c){var _t=_.memoizedState!==null||Kj;if(!_t){var ga=_.alternate,_s=ga!==null&&ga.memoizedState!==null||U;ga=Kj;var _c=U;if(Kj=_t,(U=_s)&&!_c)for(V=_;V!==null;)_t=V,_s=_t.child,_t.tag===22&&_t.memoizedState!==null?kk(_):_s!==null?(_s.return=_t,V=_s):kk(_);for(;$!==null;)V=$,jk($),$=$.sibling;V=_,Kj=ga,U=_c}lk(i)}else _.subtreeFlags&8772&&$!==null?($.return=_,V=$):lk(i)}}function lk(i){for(;V!==null;){var e=V;if(e.flags&8772){var o=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:U||Rj(5,e);break;case 1:var c=e.stateNode;if(e.flags&4&&!U)if(o===null)c.componentDidMount();else{var _=e.elementType===e.type?o.memoizedProps:Lg(e.type,o.memoizedProps);c.componentDidUpdate(_,o.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var $=e.updateQueue;$!==null&&ih(e,$,c);break;case 3:var _t=e.updateQueue;if(_t!==null){if(o=null,e.child!==null)switch(e.child.tag){case 5:o=e.child.stateNode;break;case 1:o=e.child.stateNode}ih(e,_t,o)}break;case 5:var ga=e.stateNode;if(o===null&&e.flags&4){o=ga;var _s=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":_s.autoFocus&&o.focus();break;case"img":_s.src&&(o.src=_s.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var _c=e.alternate;if(_c!==null){var _l=_c.memoizedState;if(_l!==null){var Tl=_l.dehydrated;Tl!==null&&bd(Tl)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||e.flags&512&&Sj(e)}catch(Cl){W(e,e.return,Cl)}}if(e===i){V=null;break}if(o=e.sibling,o!==null){o.return=e.return,V=o;break}V=e.return}}function hk(i){for(;V!==null;){var e=V;if(e===i){V=null;break}var o=e.sibling;if(o!==null){o.return=e.return,V=o;break}V=e.return}}function kk(i){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var o=e.return;try{Rj(4,e)}catch(_s){W(e,o,_s)}break;case 1:var c=e.stateNode;if(typeof c.componentDidMount=="function"){var _=e.return;try{c.componentDidMount()}catch(_s){W(e,_,_s)}}var $=e.return;try{Sj(e)}catch(_s){W(e,$,_s)}break;case 5:var _t=e.return;try{Sj(e)}catch(_s){W(e,_t,_s)}}}catch(_s){W(e,e.return,_s)}if(e===i){V=null;break}var ga=e.sibling;if(ga!==null){ga.return=e.return,V=ga;break}V=e.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K=0,R=null,Y=null,Z=0,gj=0,fj=Uf(0),T=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return K&6?B():Bk!==-1?Bk:Bk=B()}function lh(i){return i.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(i=C,i!==0||(i=window.event,i=i===void 0?16:jd(i.type)),i):1}function mh(i,e,o,c){if(50<zk)throw zk=0,Ak=null,Error(p(185));Ac(i,o,c),(!(K&2)||i!==R)&&(i===R&&(!(K&2)&&(rk|=o),T===4&&Dk(i,Z)),Ek(i,c),o===1&&K===0&&!(e.mode&1)&&(Hj=B()+500,fg&&jg()))}function Ek(i,e){var o=i.callbackNode;wc(i,e);var c=uc(i,i===R?Z:0);if(c===0)o!==null&&bc(o),i.callbackNode=null,i.callbackPriority=0;else if(e=c&-c,i.callbackPriority!==e){if(o!=null&&bc(o),e===1)i.tag===0?ig(Fk.bind(null,i)):hg(Fk.bind(null,i)),Jf(function(){!(K&6)&&jg()}),o=null;else{switch(Dc(c)){case 1:o=fc;break;case 4:o=gc;break;case 16:o=hc;break;case 536870912:o=jc;break;default:o=hc}o=Gk(o,Hk.bind(null,i))}i.callbackPriority=e,i.callbackNode=o}}function Hk(i,e){if(Bk=-1,Ck=0,K&6)throw Error(p(327));var o=i.callbackNode;if(Ik()&&i.callbackNode!==o)return null;var c=uc(i,i===R?Z:0);if(c===0)return null;if(c&30||c&i.expiredLanes||e)e=Jk(i,c);else{e=c;var _=K;K|=2;var $=Kk();(R!==i||Z!==e)&&(vk=null,Hj=B()+500,Lk(i,e));do try{Mk();break}catch(ga){Nk(i,ga)}while(1);Qg(),nk.current=$,K=_,Y!==null?e=0:(R=null,Z=0,e=T)}if(e!==0){if(e===2&&(_=xc(i),_!==0&&(c=_,e=Ok(i,_))),e===1)throw o=qk,Lk(i,0),Dk(i,c),Ek(i,B()),o;if(e===6)Dk(i,c);else{if(_=i.current.alternate,!(c&30)&&!Pk(_)&&(e=Jk(i,c),e===2&&($=xc(i),$!==0&&(c=$,e=Ok(i,$))),e===1))throw o=qk,Lk(i,0),Dk(i,c),Ek(i,B()),o;switch(i.finishedWork=_,i.finishedLanes=c,e){case 0:case 1:throw Error(p(345));case 2:Qk(i,uk,vk);break;case 3:if(Dk(i,c),(c&130023424)===c&&(e=gk+500-B(),10<e)){if(uc(i,0)!==0)break;if(_=i.suspendedLanes,(_&c)!==c){L(),i.pingedLanes|=i.suspendedLanes&_;break}i.timeoutHandle=Ff(Qk.bind(null,i,uk,vk),e);break}Qk(i,uk,vk);break;case 4:if(Dk(i,c),(c&4194240)===c)break;for(e=i.eventTimes,_=-1;0<c;){var _t=31-oc(c);$=1<<_t,_t=e[_t],_t>_&&(_=_t),c&=~$}if(c=_,c=B()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*mk(c/1960))-c,10<c){i.timeoutHandle=Ff(Qk.bind(null,i,uk,vk),c);break}Qk(i,uk,vk);break;case 5:Qk(i,uk,vk);break;default:throw Error(p(329))}}}return Ek(i,B()),i.callbackNode===o?Hk.bind(null,i):null}function Ok(i,e){var o=tk;return i.current.memoizedState.isDehydrated&&(Lk(i,e).flags|=256),i=Jk(i,e),i!==2&&(e=uk,uk=o,e!==null&&Gj(e)),i}function Gj(i){uk===null?uk=i:uk.push.apply(uk,i)}function Pk(i){for(var e=i;;){if(e.flags&16384){var o=e.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var c=0;c<o.length;c++){var _=o[c],$=_.getSnapshot;_=_.value;try{if(!He($(),_))return!1}catch{return!1}}}if(o=e.child,e.subtreeFlags&16384&&o!==null)o.return=e,e=o;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Dk(i,e){for(e&=~sk,e&=~rk,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var o=31-oc(e),c=1<<o;i[o]=-1,e&=~c}}function Fk(i){if(K&6)throw Error(p(327));Ik();var e=uc(i,0);if(!(e&1))return Ek(i,B()),null;var o=Jk(i,e);if(i.tag!==0&&o===2){var c=xc(i);c!==0&&(e=c,o=Ok(i,c))}if(o===1)throw o=qk,Lk(i,0),Dk(i,e),Ek(i,B()),o;if(o===6)throw Error(p(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,Qk(i,uk,vk),Ek(i,B()),null}function Rk(i,e){var o=K;K|=1;try{return i(e)}finally{K=o,K===0&&(Hj=B()+500,fg&&jg())}}function Sk(i){xk!==null&&xk.tag===0&&!(K&6)&&Ik();var e=K;K|=1;var o=pk.transition,c=C;try{if(pk.transition=null,C=1,i)return i()}finally{C=c,pk.transition=o,K=e,!(K&6)&&jg()}}function Ij(){gj=fj.current,E(fj)}function Lk(i,e){i.finishedWork=null,i.finishedLanes=0;var o=i.timeoutHandle;if(o!==-1&&(i.timeoutHandle=-1,Gf(o)),Y!==null)for(o=Y.return;o!==null;){var c=o;switch(wg(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&$f();break;case 3:Jh(),E(Wf),E(H),Oh();break;case 5:Lh(c);break;case 4:Jh();break;case 13:E(M);break;case 19:E(M);break;case 10:Rg(c.type._context);break;case 22:case 23:Ij()}o=o.return}if(R=i,Y=i=wh(i.current,null),Z=gj=e,T=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(e=0;e<Wg.length;e++)if(o=Wg[e],c=o.interleaved,c!==null){o.interleaved=null;var _=c.next,$=o.pending;if($!==null){var _t=$.next;$.next=_,c.next=_t}o.pending=c}Wg=null}return i}function Nk(i,e){do{var o=Y;try{if(Qg(),Ph.current=ai,Sh){for(var c=N.memoizedState;c!==null;){var _=c.queue;_!==null&&(_.pending=null),c=c.next}Sh=!1}if(Rh=0,P=O=N=null,Th=!1,Uh=0,ok.current=null,o===null||o.return===null){T=1,qk=e,Y=null;break}t:{var $=i,_t=o.return,ga=o,_s=e;if(e=Z,ga.flags|=32768,_s!==null&&typeof _s=="object"&&typeof _s.then=="function"){var _c=_s,_l=ga,Tl=_l.tag;if(!(_l.mode&1)&&(Tl===0||Tl===11||Tl===15)){var Cl=_l.alternate;Cl?(_l.updateQueue=Cl.updateQueue,_l.memoizedState=Cl.memoizedState,_l.lanes=Cl.lanes):(_l.updateQueue=null,_l.memoizedState=null)}var Pl=Vi(_t);if(Pl!==null){Pl.flags&=-257,Wi(Pl,_t,ga,$,e),Pl.mode&1&&Ti($,_c,e),e=Pl,_s=_c;var Dl=e.updateQueue;if(Dl===null){var Jl=new Set;Jl.add(_s),e.updateQueue=Jl}else Dl.add(_s);break t}else{if(!(e&1)){Ti($,_c,e),uj();break t}_s=Error(p(426))}}else if(I&&ga.mode&1){var zl=Vi(_t);if(zl!==null){!(zl.flags&65536)&&(zl.flags|=256),Wi(zl,_t,ga,$,e),Jg(Ki(_s,ga));break t}}$=_s=Ki(_s,ga),T!==4&&(T=2),tk===null?tk=[$]:tk.push($),$=_t;do{switch($.tag){case 3:$.flags|=65536,e&=-e,$.lanes|=e;var Bl=Oi($,_s,e);fh($,Bl);break t;case 1:ga=_s;var Vl=$.type,_d=$.stateNode;if(!($.flags&128)&&(typeof Vl.getDerivedStateFromError=="function"||_d!==null&&typeof _d.componentDidCatch=="function"&&(Si===null||!Si.has(_d)))){$.flags|=65536,e&=-e,$.lanes|=e;var Sp=Ri($,ga,e);fh($,Sp);break t}}$=$.return}while($!==null)}Tk(o)}catch(Up){e=Up,Y===o&&o!==null&&(Y=o=o.return);continue}break}while(1)}function Kk(){var i=nk.current;return nk.current=ai,i===null?ai:i}function uj(){(T===0||T===3||T===2)&&(T=4),R===null||!(hh&268435455)&&!(rk&268435455)||Dk(R,Z)}function Jk(i,e){var o=K;K|=2;var c=Kk();(R!==i||Z!==e)&&(vk=null,Lk(i,e));do try{Uk();break}catch(_){Nk(i,_)}while(1);if(Qg(),K=o,nk.current=c,Y!==null)throw Error(p(261));return R=null,Z=0,T}function Uk(){for(;Y!==null;)Vk(Y)}function Mk(){for(;Y!==null&&!cc();)Vk(Y)}function Vk(i){var e=Wk(i.alternate,i,gj);i.memoizedProps=i.pendingProps,e===null?Tk(i):Y=e,ok.current=null}function Tk(i){var e=i;do{var o=e.alternate;if(i=e.return,e.flags&32768){if(o=Jj(o,e),o!==null){o.flags&=32767,Y=o;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{T=6,Y=null;return}}else if(o=Fj(o,e,gj),o!==null){Y=o;return}if(e=e.sibling,e!==null){Y=e;return}Y=e=i}while(e!==null);T===0&&(T=5)}function Qk(i,e,o){var c=C,_=pk.transition;try{pk.transition=null,C=1,Xk(i,e,o,c)}finally{pk.transition=_,C=c}return null}function Xk(i,e,o,c){do Ik();while(xk!==null);if(K&6)throw Error(p(327));o=i.finishedWork;var _=i.finishedLanes;if(o===null)return null;if(i.finishedWork=null,i.finishedLanes=0,o===i.current)throw Error(p(177));i.callbackNode=null,i.callbackPriority=0;var $=o.lanes|o.childLanes;if(Bc(i,$),i===R&&(Y=R=null,Z=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),$=(o.flags&15990)!==0,o.subtreeFlags&15990||$){$=pk.transition,pk.transition=null;var _t=C;C=1;var ga=K;K|=4,ok.current=null,Pj(i,o),ek(o,i),Oe(Df),dd=!!Cf,Df=Cf=null,i.current=o,ik(o),dc(),K=ga,C=_t,pk.transition=$}else i.current=o;if(wk&&(wk=!1,xk=i,yk=_),$=i.pendingLanes,$===0&&(Si=null),mc(o.stateNode),Ek(i,B()),e!==null)for(c=i.onRecoverableError,o=0;o<e.length;o++)_=e[o],c(_.value,{componentStack:_.stack,digest:_.digest});if(Pi)throw Pi=!1,i=Qi,Qi=null,i;return yk&1&&i.tag!==0&&Ik(),$=i.pendingLanes,$&1?i===Ak?zk++:(zk=0,Ak=i):zk=0,jg(),null}function Ik(){if(xk!==null){var i=Dc(yk),e=pk.transition,o=C;try{if(pk.transition=null,C=16>i?16:i,xk===null)var c=!1;else{if(i=xk,xk=null,yk=0,K&6)throw Error(p(331));var _=K;for(K|=4,V=i.current;V!==null;){var $=V,_t=$.child;if(V.flags&16){var ga=$.deletions;if(ga!==null){for(var _s=0;_s<ga.length;_s++){var _c=ga[_s];for(V=_c;V!==null;){var _l=V;switch(_l.tag){case 0:case 11:case 15:Qj(8,_l,$)}var Tl=_l.child;if(Tl!==null)Tl.return=_l,V=Tl;else for(;V!==null;){_l=V;var Cl=_l.sibling,Pl=_l.return;if(Tj(_l),_l===_c){V=null;break}if(Cl!==null){Cl.return=Pl,V=Cl;break}V=Pl}}}var Dl=$.alternate;if(Dl!==null){var Jl=Dl.child;if(Jl!==null){Dl.child=null;do{var zl=Jl.sibling;Jl.sibling=null,Jl=zl}while(Jl!==null)}}V=$}}if($.subtreeFlags&2064&&_t!==null)_t.return=$,V=_t;else t:for(;V!==null;){if($=V,$.flags&2048)switch($.tag){case 0:case 11:case 15:Qj(9,$,$.return)}var Bl=$.sibling;if(Bl!==null){Bl.return=$.return,V=Bl;break t}V=$.return}}var Vl=i.current;for(V=Vl;V!==null;){_t=V;var _d=_t.child;if(_t.subtreeFlags&2064&&_d!==null)_d.return=_t,V=_d;else t:for(_t=Vl;V!==null;){if(ga=V,ga.flags&2048)try{switch(ga.tag){case 0:case 11:case 15:Rj(9,ga)}}catch(Up){W(ga,ga.return,Up)}if(ga===_t){V=null;break t}var Sp=ga.sibling;if(Sp!==null){Sp.return=ga.return,V=Sp;break t}V=ga.return}}if(K=_,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,i)}catch{}c=!0}return c}finally{C=o,pk.transition=e}}return!1}function Yk(i,e,o){e=Ki(o,e),e=Oi(i,e,1),i=dh(i,e,1),e=L(),i!==null&&(Ac(i,1,e),Ek(i,e))}function W(i,e,o){if(i.tag===3)Yk(i,i,o);else for(;e!==null;){if(e.tag===3){Yk(e,i,o);break}else if(e.tag===1){var c=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Si===null||!Si.has(c))){i=Ki(o,i),i=Ri(e,i,1),e=dh(e,i,1),i=L(),e!==null&&(Ac(e,1,i),Ek(e,i));break}}e=e.return}}function Ui(i,e,o){var c=i.pingCache;c!==null&&c.delete(e),e=L(),i.pingedLanes|=i.suspendedLanes&o,R===i&&(Z&o)===o&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-gk?Lk(i,0):sk|=o),Ek(i,e)}function Zk(i,e){e===0&&(i.mode&1?(e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):e=1);var o=L();i=Zg(i,e),i!==null&&(Ac(i,e,o),Ek(i,o))}function vj(i){var e=i.memoizedState,o=0;e!==null&&(o=e.retryLane),Zk(i,o)}function ck(i,e){var o=0;switch(i.tag){case 13:var c=i.stateNode,_=i.memoizedState;_!==null&&(o=_.retryLane);break;case 19:c=i.stateNode;break;default:throw Error(p(314))}c!==null&&c.delete(e),Zk(i,o)}var Wk;Wk=function(i,e,o){if(i!==null)if(i.memoizedProps!==e.pendingProps||Wf.current)Ug=!0;else{if(!(i.lanes&o)&&!(e.flags&128))return Ug=!1,zj(i,e,o);Ug=!!(i.flags&131072)}else Ug=!1,I&&e.flags&1048576&&ug(e,ng,e.index);switch(e.lanes=0,e.tag){case 2:var c=e.type;jj(i,e),i=e.pendingProps;var _=Yf(e,H.current);Tg(e,o),_=Xh(null,e,c,i,_,o);var $=bi();return e.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zf(c)?($=!0,cg(e)):$=!1,e.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,ah(e),_.updater=nh,e.stateNode=_,_._reactInternals=e,rh(e,c,i,o),e=kj(null,e,c,!0,$,o)):(e.tag=0,I&&$&&vg(e),Yi(null,e,_,o),e=e.child),e;case 16:c=e.elementType;t:{switch(jj(i,e),i=e.pendingProps,_=c._init,c=_(c._payload),e.type=c,_=e.tag=$k(c),i=Lg(c,i),_){case 0:e=dj(null,e,c,i,o);break t;case 1:e=ij(null,e,c,i,o);break t;case 11:e=Zi(null,e,c,i,o);break t;case 14:e=aj(null,e,c,Lg(c.type,i),o);break t}throw Error(p(306,c,""))}return e;case 0:return c=e.type,_=e.pendingProps,_=e.elementType===c?_:Lg(c,_),dj(i,e,c,_,o);case 1:return c=e.type,_=e.pendingProps,_=e.elementType===c?_:Lg(c,_),ij(i,e,c,_,o);case 3:t:{if(lj(e),i===null)throw Error(p(387));c=e.pendingProps,$=e.memoizedState,_=$.element,bh(i,e),gh(e,c,null,o);var _t=e.memoizedState;if(c=_t.element,$.isDehydrated)if($={element:c,isDehydrated:!1,cache:_t.cache,pendingSuspenseBoundaries:_t.pendingSuspenseBoundaries,transitions:_t.transitions},e.updateQueue.baseState=$,e.memoizedState=$,e.flags&256){_=Ki(Error(p(423)),e),e=mj(i,e,c,o,_);break t}else if(c!==_){_=Ki(Error(p(424)),e),e=mj(i,e,c,o,_);break t}else for(yg=Lf(e.stateNode.containerInfo.firstChild),xg=e,I=!0,zg=null,o=Ch(e,null,c,o),e.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ig(),c===_){e=$i(i,e,o);break t}Yi(i,e,c,o)}e=e.child}return e;case 5:return Kh(e),i===null&&Eg(e),c=e.type,_=e.pendingProps,$=i!==null?i.memoizedProps:null,_t=_.children,Ef(c,_)?_t=null:$!==null&&Ef(c,$)&&(e.flags|=32),hj(i,e),Yi(i,e,_t,o),e.child;case 6:return i===null&&Eg(e),null;case 13:return pj(i,e,o);case 4:return Ih(e,e.stateNode.containerInfo),c=e.pendingProps,i===null?e.child=Bh(e,null,c,o):Yi(i,e,c,o),e.child;case 11:return c=e.type,_=e.pendingProps,_=e.elementType===c?_:Lg(c,_),Zi(i,e,c,_,o);case 7:return Yi(i,e,e.pendingProps,o),e.child;case 8:return Yi(i,e,e.pendingProps.children,o),e.child;case 12:return Yi(i,e,e.pendingProps.children,o),e.child;case 10:t:{if(c=e.type._context,_=e.pendingProps,$=e.memoizedProps,_t=_.value,G(Mg,c._currentValue),c._currentValue=_t,$!==null)if(He($.value,_t)){if($.children===_.children&&!Wf.current){e=$i(i,e,o);break t}}else for($=e.child,$!==null&&($.return=e);$!==null;){var ga=$.dependencies;if(ga!==null){_t=$.child;for(var _s=ga.firstContext;_s!==null;){if(_s.context===c){if($.tag===1){_s=ch(-1,o&-o),_s.tag=2;var _c=$.updateQueue;if(_c!==null){_c=_c.shared;var _l=_c.pending;_l===null?_s.next=_s:(_s.next=_l.next,_l.next=_s),_c.pending=_s}}$.lanes|=o,_s=$.alternate,_s!==null&&(_s.lanes|=o),Sg($.return,o,e),ga.lanes|=o;break}_s=_s.next}}else if($.tag===10)_t=$.type===e.type?null:$.child;else if($.tag===18){if(_t=$.return,_t===null)throw Error(p(341));_t.lanes|=o,ga=_t.alternate,ga!==null&&(ga.lanes|=o),Sg(_t,o,e),_t=$.sibling}else _t=$.child;if(_t!==null)_t.return=$;else for(_t=$;_t!==null;){if(_t===e){_t=null;break}if($=_t.sibling,$!==null){$.return=_t.return,_t=$;break}_t=_t.return}$=_t}Yi(i,e,_.children,o),e=e.child}return e;case 9:return _=e.type,c=e.pendingProps.children,Tg(e,o),_=Vg(_),c=c(_),e.flags|=1,Yi(i,e,c,o),e.child;case 14:return c=e.type,_=Lg(c,e.pendingProps),_=Lg(c.type,_),aj(i,e,c,_,o);case 15:return cj(i,e,e.type,e.pendingProps,o);case 17:return c=e.type,_=e.pendingProps,_=e.elementType===c?_:Lg(c,_),jj(i,e),e.tag=1,Zf(c)?(i=!0,cg(e)):i=!1,Tg(e,o),ph(e,c,_),rh(e,c,_,o),kj(null,e,c,!0,i,o);case 19:return yj(i,e,o);case 22:return ej(i,e,o)}throw Error(p(156,e.tag))};function Gk(i,e){return ac(i,e)}function al(i,e,o,c){this.tag=i,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(i,e,o,c){return new al(i,e,o,c)}function bj(i){return i=i.prototype,!(!i||!i.isReactComponent)}function $k(i){if(typeof i=="function")return bj(i)?1:0;if(i!=null){if(i=i.$$typeof,i===Da)return 11;if(i===Ga)return 14}return 2}function wh(i,e){var o=i.alternate;return o===null?(o=Bg(i.tag,e,i.key,i.mode),o.elementType=i.elementType,o.type=i.type,o.stateNode=i.stateNode,o.alternate=i,i.alternate=o):(o.pendingProps=e,o.type=i.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=i.flags&14680064,o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},o.sibling=i.sibling,o.index=i.index,o.ref=i.ref,o}function yh(i,e,o,c,_,$){var _t=2;if(c=i,typeof i=="function")bj(i)&&(_t=1);else if(typeof i=="string")_t=5;else t:switch(i){case ya:return Ah(o.children,_,$,e);case za:_t=8,_|=8;break;case Aa:return i=Bg(12,o,e,_|2),i.elementType=Aa,i.lanes=$,i;case Ea:return i=Bg(13,o,e,_),i.elementType=Ea,i.lanes=$,i;case Fa:return i=Bg(19,o,e,_),i.elementType=Fa,i.lanes=$,i;case Ia:return qj(o,_,$,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Ba:_t=10;break t;case Ca:_t=9;break t;case Da:_t=11;break t;case Ga:_t=14;break t;case Ha:_t=16,c=null;break t}throw Error(p(130,i==null?i:typeof i,""))}return e=Bg(_t,o,e,_),e.elementType=i,e.type=c,e.lanes=$,e}function Ah(i,e,o,c){return i=Bg(7,i,c,e),i.lanes=o,i}function qj(i,e,o,c){return i=Bg(22,i,c,e),i.elementType=Ia,i.lanes=o,i.stateNode={isHidden:!1},i}function xh(i,e,o){return i=Bg(6,i,null,e),i.lanes=o,i}function zh(i,e,o){return e=Bg(4,i.children!==null?i.children:[],i.key,e),e.lanes=o,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function bl(i,e,o,c,_){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=c,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function cl(i,e,o,c,_,$,_t,ga,_s){return i=new bl(i,e,o,ga,_s),e===1?(e=1,$===!0&&(e|=8)):e=0,$=Bg(3,null,null,e),i.current=$,$.stateNode=i,$.memoizedState={element:c,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah($),i}function dl(i,e,o){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:c==null?null:""+c,children:i,containerInfo:e,implementation:o}}function el(i){if(!i)return Vf;i=i._reactInternals;t:{if(Vb(i)!==i||i.tag!==1)throw Error(p(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Zf(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(e!==null);throw Error(p(171))}if(i.tag===1){var o=i.type;if(Zf(o))return bg(i,o,e)}return e}function fl(i,e,o,c,_,$,_t,ga,_s){return i=cl(o,c,!0,i,_,$,_t,ga,_s),i.context=el(null),o=i.current,c=L(),_=lh(o),$=ch(c,_),$.callback=e??null,dh(o,$,_),i.current.lanes=_,Ac(i,_,c),Ek(i,c),i}function gl(i,e,o,c){var _=e.current,$=L(),_t=lh(_);return o=el(o),e.context===null?e.context=o:e.pendingContext=o,e=ch($,_t),e.payload={element:i},c=c===void 0?null:c,c!==null&&(e.callback=c),i=dh(_,e,_t),i!==null&&(mh(i,_,_t,$),eh(i,_,_t)),_t}function hl(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function il(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var o=i.retryLane;i.retryLane=o!==0&&o<e?o:e}}function jl(i,e){il(i,e),(i=i.alternate)&&il(i,e)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(i){console.error(i)};function ml(i){this._internalRoot=i}nl.prototype.render=ml.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(p(409));gl(i,e,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;Sk(function(){gl(null,i,null,null)}),e[uf]=null}};function nl(i){this._internalRoot=i}nl.prototype.unstable_scheduleHydration=function(i){if(i){var e=Hc();i={blockedOn:null,target:i,priority:e};for(var o=0;o<Qc.length&&e!==0&&e<Qc[o].priority;o++);Qc.splice(o,0,i),o===0&&Vc(i)}};function ol(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function pl(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(i,e,o,c,_){if(_){if(typeof c=="function"){var $=c;c=function(){var _c=hl(_t);$.call(_c)}}var _t=fl(e,c,i,0,null,!1,!1,"",ql);return i._reactRootContainer=_t,i[uf]=_t.current,sf(i.nodeType===8?i.parentNode:i),Sk(),_t}for(;_=i.lastChild;)i.removeChild(_);if(typeof c=="function"){var ga=c;c=function(){var _c=hl(_s);ga.call(_c)}}var _s=cl(i,0,!1,null,null,!1,!1,"",ql);return i._reactRootContainer=_s,i[uf]=_s.current,sf(i.nodeType===8?i.parentNode:i),Sk(function(){gl(e,_s,o,c)}),_s}function sl(i,e,o,c,_){var $=o._reactRootContainer;if($){var _t=$;if(typeof _=="function"){var ga=_;_=function(){var _s=hl(_t);ga.call(_s)}}gl(e,_t,i,_)}else _t=rl(o,e,i,_,c);return hl(_t)}Ec=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var o=tc(e.pendingLanes);o!==0&&(Cc(e,o|1),Ek(e,B()),!(K&6)&&(Hj=B()+500,jg()))}break;case 13:Sk(function(){var c=Zg(i,1);if(c!==null){var _=L();mh(c,i,1,_)}}),jl(i,1)}};Fc=function(i){if(i.tag===13){var e=Zg(i,134217728);if(e!==null){var o=L();mh(e,i,134217728,o)}jl(i,134217728)}};Gc=function(i){if(i.tag===13){var e=lh(i),o=Zg(i,e);if(o!==null){var c=L();mh(o,i,e,c)}jl(i,e)}};Hc=function(){return C};Ic=function(i,e){var o=C;try{return C=i,e()}finally{C=o}};yb=function(i,e,o){switch(e){case"input":if(bb(i,o),e=o.name,o.type==="radio"&&e!=null){for(o=i;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<o.length;e++){var c=o[e];if(c!==i&&c.form===i.form){var _=Db(c);if(!_)throw Error(p(90));Wa(c),bb(c,_)}}}break;case"textarea":ib(i,o);break;case"select":e=o.value,e!=null&&fb(i,!!o.multiple,e,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Zb(i),i===null?null:i.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(i,e){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(e))throw Error(p(200));return dl(i,e,null,o)};reactDom_production_min.createRoot=function(i,e){if(!ol(i))throw Error(p(299));var o=!1,c="",_=ll;return e!=null&&(e.unstable_strictMode===!0&&(o=!0),e.identifierPrefix!==void 0&&(c=e.identifierPrefix),e.onRecoverableError!==void 0&&(_=e.onRecoverableError)),e=cl(i,1,!1,null,null,o,!1,c,_),i[uf]=e.current,sf(i.nodeType===8?i.parentNode:i),new ml(e)};reactDom_production_min.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(p(188)):(i=Object.keys(i).join(","),Error(p(268,i)));return i=Zb(e),i=i===null?null:i.stateNode,i};reactDom_production_min.flushSync=function(i){return Sk(i)};reactDom_production_min.hydrate=function(i,e,o){if(!pl(e))throw Error(p(200));return sl(null,i,e,!0,o)};reactDom_production_min.hydrateRoot=function(i,e,o){if(!ol(i))throw Error(p(405));var c=o!=null&&o.hydratedSources||null,_=!1,$="",_t=ll;if(o!=null&&(o.unstable_strictMode===!0&&(_=!0),o.identifierPrefix!==void 0&&($=o.identifierPrefix),o.onRecoverableError!==void 0&&(_t=o.onRecoverableError)),e=fl(e,null,i,1,o??null,_,!1,$,_t),i[uf]=e.current,sf(i),c)for(i=0;i<c.length;i++)o=c[i],_=o._getVersion,_=_(o._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[o,_]:e.mutableSourceEagerHydrationData.push(o,_);return new nl(e)};reactDom_production_min.render=function(i,e,o){if(!pl(e))throw Error(p(200));return sl(null,i,e,!1,o)};reactDom_production_min.unmountComponentAtNode=function(i){if(!pl(i))throw Error(p(40));return i._reactRootContainer?(Sk(function(){sl(null,null,i,!1,function(){i._reactRootContainer=null,i[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(i,e,o,c){if(!pl(o))throw Error(p(200));if(i==null||i._reactInternals===void 0)throw Error(p(38));return sl(i,e,o,!1,c)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";(function(i){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(o){console.error(o)}}e(),i.exports=reactDom_production_min})(reactDom);var m=reactDomExports;client$1.createRoot=m.createRoot,client$1.hydrateRoot=m.hydrateRoot;/**
 * @remix-run/router v1.3.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(i[c]=o[c])}return i},_extends$2.apply(this,arguments)}var Action;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createHashHistory(i){i===void 0&&(i={});function e(_,$){let{pathname:_t="/",search:ga="",hash:_s=""}=parsePath(_.location.hash.substr(1));return createLocation("",{pathname:_t,search:ga,hash:_s},$.state&&$.state.usr||null,$.state&&$.state.key||"default")}function o(_,$){let _t=_.document.querySelector("base"),ga="";if(_t&&_t.getAttribute("href")){let _s=_.location.href,_c=_s.indexOf("#");ga=_c===-1?_s:_s.slice(0,_c)}return ga+"#"+(typeof $=="string"?$:createPath($))}function c(_,$){warning$1(_.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify($)+")")}return getUrlBasedHistory(e,o,c,i)}function invariant(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function warning$1(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(i,e){return{usr:i.state,key:i.key,idx:e}}function createLocation(i,e,o,c){return o===void 0&&(o=null),_extends$2({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?parsePath(e):e,{state:o,key:e&&e.key||c||createKey()})}function createPath(i){let{pathname:e="/",search:o="",hash:c=""}=i;return o&&o!=="?"&&(e+=o.charAt(0)==="?"?o:"?"+o),c&&c!=="#"&&(e+=c.charAt(0)==="#"?c:"#"+c),e}function parsePath(i){let e={};if(i){let o=i.indexOf("#");o>=0&&(e.hash=i.substr(o),i=i.substr(0,o));let c=i.indexOf("?");c>=0&&(e.search=i.substr(c),i=i.substr(0,c)),i&&(e.pathname=i)}return e}function getUrlBasedHistory(i,e,o,c){c===void 0&&(c={});let{window:_=document.defaultView,v5Compat:$=!1}=c,_t=_.history,ga=Action.Pop,_s=null,_c=_l();_c==null&&(_c=0,_t.replaceState(_extends$2({},_t.state,{idx:_c}),""));function _l(){return(_t.state||{idx:null}).idx}function Tl(){ga=Action.Pop;let zl=_l(),Bl=zl==null?null:zl-_c;_c=zl,_s&&_s({action:ga,location:Jl.location,delta:Bl})}function Cl(zl,Bl){ga=Action.Push;let Vl=createLocation(Jl.location,zl,Bl);o&&o(Vl,zl),_c=_l()+1;let _d=getHistoryState(Vl,_c),Sp=Jl.createHref(Vl);try{_t.pushState(_d,"",Sp)}catch{_.location.assign(Sp)}$&&_s&&_s({action:ga,location:Jl.location,delta:1})}function Pl(zl,Bl){ga=Action.Replace;let Vl=createLocation(Jl.location,zl,Bl);o&&o(Vl,zl),_c=_l();let _d=getHistoryState(Vl,_c),Sp=Jl.createHref(Vl);_t.replaceState(_d,"",Sp),$&&_s&&_s({action:ga,location:Jl.location,delta:0})}function Dl(zl){let Bl=_.location.origin!=="null"?_.location.origin:_.location.href,Vl=typeof zl=="string"?zl:createPath(zl);return invariant(Bl,"No window.location.(origin|href) available to create URL for href: "+Vl),new URL(Vl,Bl)}let Jl={get action(){return ga},get location(){return i(_,_t)},listen(zl){if(_s)throw new Error("A history only accepts one active listener");return _.addEventListener(PopStateEventType,Tl),_s=zl,()=>{_.removeEventListener(PopStateEventType,Tl),_s=null}},createHref(zl){return e(_,zl)},createURL:Dl,encodeLocation(zl){let Bl=Dl(zl);return{pathname:Bl.pathname,search:Bl.search,hash:Bl.hash}},push:Cl,replace:Pl,go(zl){return _t.go(zl)}};return Jl}var ResultType;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(ResultType||(ResultType={}));function matchRoutes(i,e,o){o===void 0&&(o="/");let c=typeof e=="string"?parsePath(e):e,_=stripBasename(c.pathname||"/",o);if(_==null)return null;let $=flattenRoutes(i);rankRouteBranches($);let _t=null;for(let ga=0;_t==null&&ga<$.length;++ga)_t=matchRouteBranch($[ga],safelyDecodeURI(_));return _t}function flattenRoutes(i,e,o,c){e===void 0&&(e=[]),o===void 0&&(o=[]),c===void 0&&(c="");let _=($,_t,ga)=>{let _s={relativePath:ga===void 0?$.path||"":ga,caseSensitive:$.caseSensitive===!0,childrenIndex:_t,route:$};_s.relativePath.startsWith("/")&&(invariant(_s.relativePath.startsWith(c),'Absolute route path "'+_s.relativePath+'" nested under path '+('"'+c+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),_s.relativePath=_s.relativePath.slice(c.length));let _c=joinPaths([c,_s.relativePath]),_l=o.concat(_s);$.children&&$.children.length>0&&(invariant($.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_c+'".')),flattenRoutes($.children,e,_l,_c)),!($.path==null&&!$.index)&&e.push({path:_c,score:computeScore(_c,$.index),routesMeta:_l})};return i.forEach(($,_t)=>{var ga;if($.path===""||!((ga=$.path)!=null&&ga.includes("?")))_($,_t);else for(let _s of explodeOptionalSegments($.path))_($,_t,_s)}),e}function explodeOptionalSegments(i){let e=i.split("/");if(e.length===0)return[];let[o,...c]=e,_=o.endsWith("?"),$=o.replace(/\?$/,"");if(c.length===0)return _?[$,""]:[$];let _t=explodeOptionalSegments(c.join("/")),ga=[];return ga.push(..._t.map(_s=>_s===""?$:[$,_s].join("/"))),_&&ga.push(..._t),ga.map(_s=>i.startsWith("/")&&_s===""?"/":_s)}function rankRouteBranches(i){i.sort((e,o)=>e.score!==o.score?o.score-e.score:compareIndexes(e.routesMeta.map(c=>c.childrenIndex),o.routesMeta.map(c=>c.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=i=>i==="*";function computeScore(i,e){let o=i.split("/"),c=o.length;return o.some(isSplat)&&(c+=splatPenalty),e&&(c+=indexRouteValue),o.filter(_=>!isSplat(_)).reduce((_,$)=>_+(paramRe.test($)?dynamicSegmentValue:$===""?emptySegmentValue:staticSegmentValue),c)}function compareIndexes(i,e){return i.length===e.length&&i.slice(0,-1).every((c,_)=>c===e[_])?i[i.length-1]-e[e.length-1]:0}function matchRouteBranch(i,e){let{routesMeta:o}=i,c={},_="/",$=[];for(let _t=0;_t<o.length;++_t){let ga=o[_t],_s=_t===o.length-1,_c=_==="/"?e:e.slice(_.length)||"/",_l=matchPath({path:ga.relativePath,caseSensitive:ga.caseSensitive,end:_s},_c);if(!_l)return null;Object.assign(c,_l.params);let Tl=ga.route;$.push({params:c,pathname:joinPaths([_,_l.pathname]),pathnameBase:normalizePathname(joinPaths([_,_l.pathnameBase])),route:Tl}),_l.pathnameBase!=="/"&&(_=joinPaths([_,_l.pathnameBase]))}return $}function matchPath(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[o,c]=compilePath(i.path,i.caseSensitive,i.end),_=e.match(o);if(!_)return null;let $=_[0],_t=$.replace(/(.)\/+$/,"$1"),ga=_.slice(1);return{params:c.reduce((_c,_l,Tl)=>{if(_l==="*"){let Cl=ga[Tl]||"";_t=$.slice(0,$.length-Cl.length).replace(/(.)\/+$/,"$1")}return _c[_l]=safelyDecodeURIComponent(ga[Tl]||"",_l),_c},{}),pathname:$,pathnameBase:_t,pattern:i}}function compilePath(i,e,o){e===void 0&&(e=!1),o===void 0&&(o=!0),warning(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let c=[],_="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(_t,ga)=>(c.push(ga),"/([^\\/]+)"));return i.endsWith("*")?(c.push("*"),_+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?_+="\\/*$":i!==""&&i!=="/"&&(_+="(?:(?=\\/|$))"),[new RegExp(_,e?void 0:"i"),c]}function safelyDecodeURI(i){try{return decodeURI(i)}catch(e){return warning(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function safelyDecodeURIComponent(i,e){try{return decodeURIComponent(i)}catch(o){return warning(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+i+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+o+").")),i}}function stripBasename(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let o=e.endsWith("/")?e.length-1:e.length,c=i.charAt(o);return c&&c!=="/"?null:i.slice(o)||"/"}function warning(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function resolvePath(i,e){e===void 0&&(e="/");let{pathname:o,search:c="",hash:_=""}=typeof i=="string"?parsePath(i):i;return{pathname:o?o.startsWith("/")?o:resolvePathname(o,e):e,search:normalizeSearch(c),hash:normalizeHash(_)}}function resolvePathname(i,e){let o=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(_=>{_===".."?o.length>1&&o.pop():_!=="."&&o.push(_)}),o.length>1?o.join("/"):"/"}function getInvalidPathError(i,e,o,c){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(c)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(i){return i.filter((e,o)=>o===0||e.route.path&&e.route.path.length>0)}function resolveTo(i,e,o,c){c===void 0&&(c=!1);let _;typeof i=="string"?_=parsePath(i):(_=_extends$2({},i),invariant(!_.pathname||!_.pathname.includes("?"),getInvalidPathError("?","pathname","search",_)),invariant(!_.pathname||!_.pathname.includes("#"),getInvalidPathError("#","pathname","hash",_)),invariant(!_.search||!_.search.includes("#"),getInvalidPathError("#","search","hash",_)));let $=i===""||_.pathname==="",_t=$?"/":_.pathname,ga;if(c||_t==null)ga=o;else{let Tl=e.length-1;if(_t.startsWith("..")){let Cl=_t.split("/");for(;Cl[0]==="..";)Cl.shift(),Tl-=1;_.pathname=Cl.join("/")}ga=Tl>=0?e[Tl]:"/"}let _s=resolvePath(_,ga),_c=_t&&_t!=="/"&&_t.endsWith("/"),_l=($||_t===".")&&o.endsWith("/");return!_s.pathname.endsWith("/")&&(_c||_l)&&(_s.pathname+="/"),_s}const joinPaths=i=>i.join("/").replace(/\/\/+/g,"/"),normalizePathname=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,normalizeHash=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function isRouteErrorResponse(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const validMutationMethodsArr=["post","put","patch","delete"];[...validMutationMethodsArr];/**
 * React Router v6.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(i[c]=o[c])}return i},_extends$1.apply(this,arguments)}function isPolyfill(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}const is=typeof Object.is=="function"?Object.is:isPolyfill,{useState,useEffect,useLayoutEffect,useDebugValue}=React$1;function useSyncExternalStore$2(i,e,o){const c=e(),[{inst:_},$]=useState({inst:{value:c,getSnapshot:e}});return useLayoutEffect(()=>{_.value=c,_.getSnapshot=e,checkIfSnapshotChanged(_)&&$({inst:_})},[i,c,e]),useEffect(()=>(checkIfSnapshotChanged(_)&&$({inst:_}),i(()=>{checkIfSnapshotChanged(_)&&$({inst:_})})),[i]),useDebugValue(c),c}function checkIfSnapshotChanged(i){const e=i.getSnapshot,o=i.value;try{const c=e();return!is(o,c)}catch{return!0}}function useSyncExternalStore$1(i,e,o){return e()}const canUseDOM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",isServerEnvironment=!canUseDOM,shim=isServerEnvironment?useSyncExternalStore$1:useSyncExternalStore$2;"useSyncExternalStore"in React$1&&(i=>i.useSyncExternalStore)(React$1);const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[]}),RouteErrorContext=reactExports.createContext(null);function useHref(i,e){let{relative:o}=e===void 0?{}:e;useInRouterContext()||invariant(!1);let{basename:c,navigator:_}=reactExports.useContext(NavigationContext),{hash:$,pathname:_t,search:ga}=useResolvedPath(i,{relative:o}),_s=_t;return c!=="/"&&(_s=_t==="/"?c:joinPaths([c,_t])),_.createHref({pathname:_s,search:ga,hash:$})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useNavigate(){useInRouterContext()||invariant(!1);let{basename:i,navigator:e}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),_=JSON.stringify(getPathContributingMatches(o).map(ga=>ga.pathnameBase)),$=reactExports.useRef(!1);return reactExports.useEffect(()=>{$.current=!0}),reactExports.useCallback(function(ga,_s){if(_s===void 0&&(_s={}),!$.current)return;if(typeof ga=="number"){e.go(ga);return}let _c=resolveTo(ga,JSON.parse(_),c,_s.relative==="path");i!=="/"&&(_c.pathname=_c.pathname==="/"?i:joinPaths([i,_c.pathname])),(_s.replace?e.replace:e.push)(_c,_s.state,_s)},[i,e,_,c])}function useParams(){let{matches:i}=reactExports.useContext(RouteContext),e=i[i.length-1];return e?e.params:{}}function useResolvedPath(i,e){let{relative:o}=e===void 0?{}:e,{matches:c}=reactExports.useContext(RouteContext),{pathname:_}=useLocation(),$=JSON.stringify(getPathContributingMatches(c).map(_t=>_t.pathnameBase));return reactExports.useMemo(()=>resolveTo(i,JSON.parse($),_,o==="path"),[i,$,_,o])}function useRoutes(i,e){useInRouterContext()||invariant(!1);let{navigator:o}=reactExports.useContext(NavigationContext),c=reactExports.useContext(DataRouterStateContext),{matches:_}=reactExports.useContext(RouteContext),$=_[_.length-1],_t=$?$.params:{};$&&$.pathname;let ga=$?$.pathnameBase:"/";$&&$.route;let _s=useLocation(),_c;if(e){var _l;let Jl=typeof e=="string"?parsePath(e):e;ga==="/"||(_l=Jl.pathname)!=null&&_l.startsWith(ga)||invariant(!1),_c=Jl}else _c=_s;let Tl=_c.pathname||"/",Cl=ga==="/"?Tl:Tl.slice(ga.length)||"/",Pl=matchRoutes(i,{pathname:Cl}),Dl=_renderMatches(Pl&&Pl.map(Jl=>Object.assign({},Jl,{params:Object.assign({},_t,Jl.params),pathname:joinPaths([ga,o.encodeLocation?o.encodeLocation(Jl.pathname).pathname:Jl.pathname]),pathnameBase:Jl.pathnameBase==="/"?ga:joinPaths([ga,o.encodeLocation?o.encodeLocation(Jl.pathnameBase).pathname:Jl.pathnameBase])})),_,c||void 0);return e&&Dl?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},_c),navigationType:Action.Pop}},Dl):Dl}function DefaultErrorElement(){let i=useRouteError(),e=isRouteErrorResponse(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),o=i instanceof Error?i.stack:null,_={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},$=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),o?reactExports.createElement("pre",{style:_},o):null,$)}class RenderErrorBoundary extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,o){return o.location!==e.location?{error:e.error,location:e.location}:{error:e.error||o.error,location:o.location}}componentDidCatch(e,o){console.error("React Router caught the following error during render",e,o)}render(){return this.state.error?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(i){let{routeContext:e,match:o,children:c}=i,_=reactExports.useContext(DataRouterContext);return _&&_.static&&_.staticContext&&o.route.errorElement&&(_.staticContext._deepestRenderedBoundaryId=o.route.id),reactExports.createElement(RouteContext.Provider,{value:e},c)}function _renderMatches(i,e,o){if(e===void 0&&(e=[]),i==null)if(o!=null&&o.errors)i=o.matches;else return null;let c=i,_=o==null?void 0:o.errors;if(_!=null){let $=c.findIndex(_t=>_t.route.id&&(_==null?void 0:_[_t.route.id]));$>=0||invariant(!1),c=c.slice(0,Math.min(c.length,$+1))}return c.reduceRight(($,_t,ga)=>{let _s=_t.route.id?_==null?void 0:_[_t.route.id]:null,_c=o?_t.route.errorElement||reactExports.createElement(DefaultErrorElement,null):null,_l=e.concat(c.slice(0,ga+1)),Tl=()=>reactExports.createElement(RenderedRoute,{match:_t,routeContext:{outlet:$,matches:_l}},_s?_c:_t.route.element!==void 0?_t.route.element:$);return o&&(_t.route.errorElement||ga===0)?reactExports.createElement(RenderErrorBoundary,{location:o.location,component:_c,error:_s,children:Tl(),routeContext:{outlet:null,matches:_l}}):Tl()},null)}var DataRouterHook$1;(function(i){i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator"})(DataRouterHook$1||(DataRouterHook$1={}));var DataRouterStateHook$1;(function(i){i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator"})(DataRouterStateHook$1||(DataRouterStateHook$1={}));function useDataRouterState(i){let e=reactExports.useContext(DataRouterStateContext);return e||invariant(!1),e}function useRouteContext(i){let e=reactExports.useContext(RouteContext);return e||invariant(!1),e}function useCurrentRouteId(i){let e=useRouteContext(),o=e.matches[e.matches.length-1];return o.route.id||invariant(!1),o.route.id}function useRouteError(){var i;let e=reactExports.useContext(RouteErrorContext),o=useDataRouterState(DataRouterStateHook$1.UseRouteError),c=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return e||((i=o.errors)==null?void 0:i[c])}function Navigate(i){let{to:e,replace:o,state:c,relative:_}=i;useInRouterContext()||invariant(!1);let $=reactExports.useContext(DataRouterStateContext),_t=useNavigate();return reactExports.useEffect(()=>{$&&$.navigation.state!=="idle"||_t(e,{replace:o,state:c,relative:_})}),null}function Route(i){invariant(!1)}function Router(i){let{basename:e="/",children:o=null,location:c,navigationType:_=Action.Pop,navigator:$,static:_t=!1}=i;useInRouterContext()&&invariant(!1);let ga=e.replace(/^\/*/,"/"),_s=reactExports.useMemo(()=>({basename:ga,navigator:$,static:_t}),[ga,$,_t]);typeof c=="string"&&(c=parsePath(c));let{pathname:_c="/",search:_l="",hash:Tl="",state:Cl=null,key:Pl="default"}=c,Dl=reactExports.useMemo(()=>{let Jl=stripBasename(_c,ga);return Jl==null?null:{pathname:Jl,search:_l,hash:Tl,state:Cl,key:Pl}},[ga,_c,_l,Tl,Cl,Pl]);return Dl==null?null:reactExports.createElement(NavigationContext.Provider,{value:_s},reactExports.createElement(LocationContext.Provider,{children:o,value:{location:Dl,navigationType:_}}))}function Routes(i){let{children:e,location:o}=i,c=reactExports.useContext(DataRouterContext),_=c&&!e?c.router.routes:createRoutesFromChildren(e);return useRoutes(_,o)}var AwaitRenderStatus;(function(i){i[i.pending=0]="pending",i[i.success=1]="success",i[i.error=2]="error"})(AwaitRenderStatus||(AwaitRenderStatus={}));new Promise(()=>{});function createRoutesFromChildren(i,e){e===void 0&&(e=[]);let o=[];return reactExports.Children.forEach(i,(c,_)=>{if(!reactExports.isValidElement(c))return;if(c.type===reactExports.Fragment){o.push.apply(o,createRoutesFromChildren(c.props.children,e));return}c.type!==Route&&invariant(!1),!c.props.index||!c.props.children||invariant(!1);let $=[...e,_],_t={id:c.props.id||$.join("-"),caseSensitive:c.props.caseSensitive,element:c.props.element,index:c.props.index,path:c.props.path,loader:c.props.loader,action:c.props.action,errorElement:c.props.errorElement,hasErrorBoundary:c.props.errorElement!=null,shouldRevalidate:c.props.shouldRevalidate,handle:c.props.handle};c.props.children&&(_t.children=createRoutesFromChildren(c.props.children,$)),o.push(_t)}),o}/**
 * React Router DOM v6.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(i[c]=o[c])}return i},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(i,e){if(i==null)return{};var o={},c=Object.keys(i),_,$;for($=0;$<c.length;$++)_=c[$],!(e.indexOf(_)>=0)&&(o[_]=i[_]);return o}function isModifiedEvent(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function shouldProcessLinkClick(i,e){return i.button===0&&(!e||e==="_self")&&!isModifiedEvent(i)}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function HashRouter(i){let{basename:e,children:o,window:c}=i,_=reactExports.useRef();_.current==null&&(_.current=createHashHistory({window:c,v5Compat:!0}));let $=_.current,[_t,ga]=reactExports.useState({action:$.action,location:$.location});return reactExports.useLayoutEffect(()=>$.listen(ga),[$]),reactExports.createElement(Router,{basename:e,children:o,location:_t.location,navigationType:_t.action,navigator:$})}const isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Link=reactExports.forwardRef(function(e,o){let{onClick:c,relative:_,reloadDocument:$,replace:_t,state:ga,target:_s,to:_c,preventScrollReset:_l}=e,Tl=_objectWithoutPropertiesLoose(e,_excluded),Cl=typeof _c=="string"?_c:createPath(_c),Pl=/^[a-z+]+:\/\//i.test(Cl)||Cl.startsWith("//"),Dl=Cl,Jl=!1;if(isBrowser&&Pl){let _d=new URL(window.location.href),Sp=Cl.startsWith("//")?new URL(_d.protocol+Cl):new URL(Cl);Sp.origin===_d.origin?Dl=Sp.pathname+Sp.search+Sp.hash:Jl=!0}let zl=useHref(Dl,{relative:_}),Bl=useLinkClickHandler(Dl,{replace:_t,state:ga,target:_s,preventScrollReset:_l,relative:_});function Vl(_d){c&&c(_d),_d.defaultPrevented||Bl(_d)}return reactExports.createElement("a",_extends({},Tl,{href:Pl?Cl:zl,onClick:Jl||$?c:Vl,ref:o,target:_s}))});var DataRouterHook;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmitImpl="useSubmitImpl",i.UseFetcher="useFetcher"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(i){i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(i,e){let{target:o,replace:c,state:_,preventScrollReset:$,relative:_t}=e===void 0?{}:e,ga=useNavigate(),_s=useLocation(),_c=useResolvedPath(i,{relative:_t});return reactExports.useCallback(_l=>{if(shouldProcessLinkClick(_l,o)){_l.preventDefault();let Tl=c!==void 0?c:createPath(_s)===createPath(_c);ga(i,{replace:Tl,state:_,preventScrollReset:$,relative:_t})}},[_s,ga,_c,c,_,o,i,$,_t])}const logo="/assets/logo-1c1b7c38.png",Header=()=>jsx("header",{id:"nav",children:jsx("div",{className:"nav--list",children:jsx(Link,{to:"/",children:jsxs("h3",{id:"logo",children:[jsx("img",{src:logo,alt:"Site Logo"}),jsx("span",{children:"Group Chat"})]})})})}),index$2="",Lobby=()=>{const i=useNavigate(),[e,o]=reactExports.useState(sessionStorage.getItem("displayName")||""),[c,_]=reactExports.useState("");return jsx("main",{id:"room__lobby__container",children:jsxs("div",{id:"form__container",children:[jsx("div",{id:"form__container__header",children:jsx("p",{children:" Create or Join Room"})}),jsxs("form",{id:"lobby__form",onSubmit:_t=>{_t.preventDefault(),sessionStorage.setItem("displayName",e),i(`/room?roomName=${c}`)},children:[jsxs("div",{className:"form__field__wrapper",children:[jsx("label",{children:"Your Name"}),jsx("input",{type:"text",name:"name",required:!0,placeholder:"Enter your display name...",value:e,onChange:_t=>o(_t.target.value)})]}),jsxs("div",{className:"form__field__wrapper",children:[jsx("label",{children:"Room Name"}),jsx("input",{type:"text",name:"room",required:!0,placeholder:"Enter room name...",value:c,onChange:_t=>_(_t.target.value)})]}),jsx("div",{className:"form__field__wrapper",children:jsxs("button",{type:"submit",children:["Go to Room",jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:jsx("path",{d:"M13.025 1l-2.847 2.828 6.176 6.176h-16.354v3.992h16.354l-6.176 6.176 2.847 2.828 10.975-11z"})})]})})]})]})})};var agoraRtmSdkExports={},agoraRtmSdk={get exports(){return agoraRtmSdkExports},set exports(i){agoraRtmSdkExports=i}};/*
 @preserve
 AgoraRTM Web SDK 1.6.0-205 - commit: v1.5.1-67-g0f6d3600
 Copyright (C) 2018-2022 Agora Lab.
 This file is licensed under the AGORA, INC. SDK LICENSE AGREEMENT
 A copy of this license may be found at https://www.agora.io/en/sdk-license-agreement/
*/(function(module,exports){(function(i,e){module.exports=e()})(commonjsGlobal,function(){function Jg(i,e){var o=Object.keys(i);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(i);e&&(c=c.filter(function(_){return Object.getOwnPropertyDescriptor(i,_).enumerable})),o.push.apply(o,c)}return o}function tb(i){for(var e=1;e<arguments.length;e++){var o=arguments[e]!=null?arguments[e]:{};e%2?Jg(Object(o),!0).forEach(function(c){E(i,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):Jg(Object(o)).forEach(function(c){Object.defineProperty(i,c,Object.getOwnPropertyDescriptor(o,c))})}return i}function Ia(i){return(Ia=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(i)}function Zq(i,e,o,c,_,$,_t){try{var ga=i[$](_t),_s=ga.value}catch(_c){return void o(_c)}ga.done?e(_s):Promise.resolve(_s).then(c,_)}function za(i){return function(){var e=this,o=arguments;return new Promise(function(c,_){function $(_s){Zq(ga,c,_,$,_t,"next",_s)}function _t(_s){Zq(ga,c,_,$,_t,"throw",_s)}var ga=i.apply(e,o);$(void 0)})}}function ab(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function $q(i,e){for(var o=0;o<e.length;o++){var c=e[o];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(i,c.key,c)}}function Qb(i,e,o){return e&&$q(i.prototype,e),o&&$q(i,o),i}function E(i,e,o){return e in i?Object.defineProperty(i,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[e]=o,i}function nb(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),e&&ci(i,e)}function Tf(i){return(Tf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(i)}function ci(i,e){return(ci=Object.setPrototypeOf||function(o,c){return o.__proto__=c,o})(i,e)}function ar(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dm(i,e,o){return(dm=ar()?Reflect.construct:function(c,_,$){var _t=[null];return _t.push.apply(_t,_),c=new(Function.bind.apply(c,_t)),$&&ci(c,$.prototype),c}).apply(null,arguments)}function di(i){var e=typeof Map=="function"?new Map:void 0;return(di=function(o){function c(){return dm(o,arguments,Tf(this).constructor)}if(o===null||Function.toString.call(o).indexOf("[native code]")===-1)return o;if(typeof o!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(o))return e.get(o);e.set(o,c)}return c.prototype=Object.create(o.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),ci(c,o)})(i)}function em(i,e){if(i==null)return{};if(i==null)var o={};else{o={};var c,_=Object.keys(i);for(c=0;c<_.length;c++){var $=_[c];0<=e.indexOf($)||(o[$]=i[$])}}if(Object.getOwnPropertySymbols)for(c=Object.getOwnPropertySymbols(i),$=0;$<c.length;$++)_=c[$],0<=e.indexOf(_)||Object.prototype.propertyIsEnumerable.call(i,_)&&(o[_]=i[_]);return o}function L(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function ob(i){var e=ar();return function(){var o=Tf(i);if(e){var c=Tf(this).constructor;o=Reflect.construct(o,arguments,c)}else o=o.apply(this,arguments);return o=!o||typeof o!="object"&&typeof o!="function"?L(this):o}}function fm(i,e,o){return(fm=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(c,_,$){for(;!Object.prototype.hasOwnProperty.call(c,_)&&(c=Tf(c))!==null;);if(c)return(_=Object.getOwnPropertyDescriptor(c,_)).get?_.get.call($):_.value})(i,e,o||i)}function Lb(i,e){var o=Array.isArray(i)?i:void 0;if(!o)if((o=i&&(typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"]))==null)o=void 0;else{var c,_=[],$=!0,_t=!1;try{for(o=o.call(i);!($=(c=o.next()).done)&&(_.push(c.value),!e||_.length!==e);$=!0);}catch(_s){_t=!0;var ga=_s}finally{try{$||o.return==null||o.return()}finally{if(_t)throw ga}}o=_}if(!(i=o||br(i,e)))throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return i}function ra(i){var e=Array.isArray(i)?gm(i):void 0;if(e||(e=typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null?Array.from(i):void 0),!(i=e||br(i)))throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return i}function br(i,e){if(i){if(typeof i=="string")return gm(i,e);var o=Object.prototype.toString.call(i).slice(8,-1);if(o==="Object"&&i.constructor&&(o=i.constructor.name),o==="Map"||o==="Set")return Array.from(i);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return gm(i,e)}}function gm(i,e){(e==null||e>i.length)&&(e=i.length);for(var o=0,c=Array(e);o<e;o++)c[o]=i[o];return c}function Na(i,e,o,c,_){var $={};return Object.keys(c).forEach(function(_t){$[_t]=c[_t]}),$.enumerable=!!$.enumerable,$.configurable=!!$.configurable,("value"in $||$.initializer)&&($.writable=!0),$=o.slice().reverse().reduce(function(_t,ga){return ga(i,e,_t)||_t},$),_&&$.initializer!==void 0&&($.value=$.initializer?$.initializer.call(_):void 0,$.initializer=void 0),$.initializer===void 0&&(Object.defineProperty(i,e,$),$=null),$}function kc(i){var e={exports:{}};return i(e,e.exports),e.exports}function Kg(i){i||(i={});var e=i.ua;if(e||typeof navigator>"u"||(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var o=JA.test(e)&&!KA.test(e)||!!i.tablet&&LA.test(e);return!o&&i.tablet&&i.featureDetect&&navigator&&1<navigator.maxTouchPoints&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(o=!0),o}function cr(i,e){var o,c=3>arguments.length?i:arguments[2];return ub(i)===c?i[e]:(o=pd.f(i,e))?Fa(o,"value")?o.value:o.get===void 0?void 0:o.get.call(c):fb(o=Md(i))?cr(o,e,c):void 0}function MA(i){var e=i.charCodeAt(0)<<24,o=0|NA(~e),c=0,_=0|i.length,$="";if(5>o&&_>=o){for(e=e<<o>>>24+o,c=1;c<o;c=c+1|0)e=e<<6|63&i.charCodeAt(c);65535>=e?$+=Uf(e):1114111>=e?$+=Uf(55296+((e=e-65536|0)>>10)|0,56320+(1023&e)|0):c=0}for(;c<_;c=c+1|0)$+="";return $}function dr(){}function OA(i){var e=0|i.charCodeAt(0);if(55296<=e&&56319>=e){var o=0|i.charCodeAt(1);if(!(o==o&&56320<=o&&57343>=o))return Uf(239,191,189);if(65535<(e=(e-55296<<10)+o-56320+65536|0))return Uf(240|e>>>18,128|e>>>12&63,128|e>>>6&63,128|63&e)}return 127>=e?i:2047>=e?Uf(192|e>>>6,128|63&e):Uf(224|e>>>12,128|e>>>6&63,128|63&e)}function er(){}function kb(){kb.init.call(this)}function Cj(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+Ia(i))}function fr(i,e,o,c){Cj(o);var _=i._events;if(_===void 0)_=i._events=Object.create(null),i._eventsCount=0;else{_.newListener!==void 0&&(i.emit("newListener",e,o.listener?o.listener:o),_=i._events);var $=_[e]}return $===void 0?(_[e]=o,++i._eventsCount):(typeof $=="function"?$=_[e]=c?[o,$]:[$,o]:c?$.unshift(o):$.push(o),0<(o=i._maxListeners===void 0?kb.defaultMaxListeners:i._maxListeners)&&$.length>o&&!$.warned&&($.warned=!0,(o=Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",o.emitter=i,o.type=e,o.count=$.length,console&&console.warn&&console.warn(o))),i}function PA(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function gr(i,e,o){return i={fired:!1,wrapFn:void 0,target:i,type:e,listener:o},(e=PA.bind(i)).listener=o,i.wrapFn=e}function hr(i,e,o){if((i=i._events)===void 0)return[];if((e=i[e])===void 0)return[];if(typeof e=="function")return o?[e.listener||e]:[e];if(o)for(o=Array(e.length),i=0;i<o.length;++i)o[i]=e[i].listener||e[i];else o=ir(e,e.length);return o}function jr(i){var e=this._events;if(e!==void 0){if(typeof(i=e[i])=="function")return 1;if(i!==void 0)return i.length}return 0}function ir(i,e){for(var o=Array(e),c=0;c<e;++c)o[c]=i[c];return o}function QA(i,e,o){typeof i.on=="function"&&kr(i,"error",e,o)}function kr(i,e,o,c){if(typeof i.on=="function")c.once?i.once(e,o):i.on(e,o);else{if(typeof i.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+Ia(i));i.addEventListener(e,function _($){c.once&&i.removeEventListener(e,_),o($)})}}function RA(i){return i?ra(i):SA(function(){return[]},function(e,o){return e.push(o),e})}function lr(i,e){var o,c,_,$;return W.wrap(function(_t){for(;;)switch(_t.prev=_t.next){case 0:o=mr(i)([nr,nr,function(ga,_s){return _s}])[2],c=0;case 2:if(!(c<e.length)){_t.next=17;break}if(_=e[c],!(($=o(hm,_))instanceof Dj)){_t.next=11;break}if(($=im($.deref()))===hm){_t.next=10;break}return _t.next=10,$;case 10:return _t.abrupt("return");case 11:if($===hm){_t.next=14;break}return _t.next=14,$;case 14:c++,_t.next=2;break;case 17:case"end":return _t.stop()}},TA)}function Ej(i,e){return e!=null&&typeof e[Symbol.iterator]=="function"?lr(Ej(i),e):function(o){var c=o[2];return UA(o,function(_,$){return c(_,i($))})}}function Be(i){return Object.prototype.toString.call(i).slice(8,-1)}function Lg(i){return Be(i)==="Object"&&i.constructor===Object&&Object.getPrototypeOf(i)===Object.prototype}function or(i){var e;return(e=Be(i)==="Boolean"||Be(i)==="Null"||Be(i)==="Undefined")||(e=Be(i)==="Number"&&!isNaN(i)),e||Be(i)==="String"||Be(i)==="Symbol"}function Vf(i){var e=-1,o=i==null?0:i.length;for(this.clear();++e<o;){var c=i[e];this.set(c[0],c[1])}}function Mg(i){var e=-1,o=i==null?0:i.length;for(this.clear();++e<o;){var c=i[e];this.set(c[0],c[1])}}function Ng(i){var e=-1,o=i==null?0:i.length;for(this.clear();++e<o;){var c=i[e];this.set(c[0],c[1])}}function ei(i){var e=-1,o=i==null?0:i.length;for(this.__data__=new Fj;++e<o;)this.add(i[e])}function Og(i){this.size=(this.__data__=new Gj(i)).size}function Pg(i,e,o,c,_,$){var _t,ga=1&e,_s=2&e,_c=4&e;if(o&&(_t=_?o(i,c,_,$):o(i)),_t!==void 0)return _t;if(!Kc(i))return i;if(c=lc(i)){if(_t=VA(i),!ga)return jm(i,_t)}else{var _l=fi(i),Tl=_l=="[object Function]"||_l=="[object GeneratorFunction]";if(gi(i))return pr(i,ga);if(_l=="[object Object]"||_l=="[object Arguments]"||Tl&&!_){if(_t=_s||Tl?{}:qr(i),!ga)return _s?WA(i,XA(_t,i)):YA(i,ZA(_t,i))}else{if(!zb[_l])return _?i:{};_t=$A(i,_l,ga)}}if($||($=new Qg),_=$.get(i))return _;$.set(i,_t),aB(i)?i.forEach(function(Pl){_t.add(Pg(Pl,e,o,Pl,i,$))}):bB(i)&&i.forEach(function(Pl,Dl){_t.set(Dl,Pg(Pl,e,o,Dl,i,$))}),_s=_c?_s?rr:km:_s?hi:Wf;var Cl=c?void 0:_s(i);return cB(Cl||i,function(Pl,Dl){Cl&&(Pl=i[Dl=Pl]),sr(_t,Dl,Pg(Pl,e,o,Dl,i,$))}),_t}function lm(i,e){if(typeof i!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var o=function c(){var _=arguments,$=e?e.apply(this,_):_[0],_t=c.cache;return _t.has($)?_t.get($):(_=i.apply(this,_),c.cache=_t.set($,_)||_t,_)};return o.cache=new(lm.Cache||Fj),o}function tr(i){if(typeof i=="string")return i;if(lc(i))return Rg(i,tr)+"";if(Sg(i))return ur?ur.call(i):"";var e=i+"";return e=="0"&&1/i==-dB?"-0":e}function mm(i,e,o,c,_){var $=-1,_t=i.length;for(o||(o=eB),_||(_=[]);++$<_t;){var ga=i[$];0<e&&o(ga)?1<e?mm(ga,e-1,o,c,_):nm(_,ga):c||(_[_.length]=ga)}return _}function Tg(i,e,o,c,_){if(i===e)e=!0;else if(i==null||e==null||!ee(i)&&!ee(e))e=i!=i&&e!=e;else t:{var $=lc(i),_t=lc(e),ga=$?"[object Array]":fi(i),_s=_t?"[object Array]":fi(e),_c=(ga=ga=="[object Arguments]"?"[object Object]":ga)=="[object Object]";if(_t=(_s=_s=="[object Arguments]"?"[object Object]":_s)=="[object Object]",(_s=ga==_s)&&gi(i)){if(!gi(e)){e=!1;break t}$=!0,_c=!1}if(_s&&!_c)_||(_=new Qg),e=$||om(i)?vr(i,e,o,c,Tg,_):fB(i,e,ga,o,c,Tg,_);else{if(!(1&o)&&($=_c&&wr.call(i,"__wrapped__"),ga=_t&&wr.call(e,"__wrapped__"),$||ga)){i=$?i.value():i,e=ga?e.value():e,_||(_=new Qg),e=Tg(i,e,o,c,_);break t}if(_s)e:if(_||(_=new Qg),$=1&o,ga=km(i),_t=ga.length,_s=km(e).length,_t==_s||$){for(_s=_t;_s--;){var _l=ga[_s];if(!($?_l in e:gB.call(e,_l))){e=!1;break e}}if(_c=_.get(i),_l=_.get(e),_c&&_l)e=_c==e&&_l==i;else{_c=!0,_.set(i,e),_.set(e,i);for(var Tl=$;++_s<_t;){var Cl=i[_l=ga[_s]],Pl=e[_l];if(c)var Dl=$?c(Pl,Cl,_l,e,i,_):c(Cl,Pl,_l,i,e,_);if(Dl===void 0?Cl!==Pl&&!Tg(Cl,Pl,o,c,_):!Dl){_c=!1;break}Tl||(Tl=_l=="constructor")}_c&&!Tl&&(o=i.constructor)!=(c=e.constructor)&&"constructor"in i&&"constructor"in e&&!(typeof o=="function"&&o instanceof o&&typeof c=="function"&&c instanceof c)&&(_c=!1),_.delete(i),_.delete(e),e=_c}}else e=!1;else e=!1}}return e}function Ab(i,e,o){this.low=0|i,this.high=0|e,this.unsigned=!!o}function Lc(i){return(i&&i.__isLong__)===!0}function Xf(i,e){var o;if(e){if((e=0<=(i>>>=0)&&256>i)&&(o=xr[i]))return o;o=Bb(i,0>(0|i)?-1:0,!0),e&&(xr[i]=o)}else{if((e=-128<=(i|=0)&&128>i)&&(o=yr[i]))return o;o=Bb(i,0>i?-1:0,!1),e&&(yr[i]=o)}return o}function qd(i,e){if(isNaN(i))return e?Yf:rd;if(e){if(0>i)return Yf;if(i>=zr)return Ar}else{if(i<=-Br)return Mc;if(i+1>=Br)return Cr}return 0>i?qd(-i,e).neg():Bb(i%Ug|0,i/Ug|0,e)}function Bb(i,e,o){return new Ab(i,e,o)}function pm(i,e,o){if(i.length===0)throw Error("empty string");if(i==="NaN"||i==="Infinity"||i==="+Infinity"||i==="-Infinity")return rd;if(typeof e=="number"?(o=e,e=!1):e=!!e,2>(o=o||10)||36<o)throw RangeError("radix");var c;if(0<(c=i.indexOf("-")))throw Error("interior hyphen");if(c===0)return pm(i.substring(1),e,o).neg();c=qd(Hj(o,8));for(var _=rd,$=0;$<i.length;$+=8){var _t=Math.min(8,i.length-$),ga=parseInt(i.substring($,$+_t),o);8>_t?(_t=qd(Hj(o,_t)),_=_.mul(_t).add(qd(ga))):_=(_=_.mul(c)).add(qd(ga))}return _.unsigned=e,_}function Nd(i,e){return typeof i=="number"?qd(i,e):typeof i=="string"?pm(i,e):Bb(i.low,i.high,typeof e=="boolean"?e:i.unsigned)}function Ca(i,e){function o(){this.constructor=i}qm(i,e),i.prototype=e===null?Object.create(e):(o.prototype=e.prototype,new o)}function Vg(i){return typeof i=="function"}function Wg(i){setTimeout(function(){throw i},0)}function rm(i){return i!==null&&Ia(i)==="object"}function Dr(i){return i.reduce(function(e,o){return e.concat(o instanceof ii?o.errors:o)},[])}function sm(i){for(;i;){var e=i.destination,o=i.isStopped;if(i.closed||o)return!1;i=e&&e instanceof hb?e:null}return!0}function jf(i){return i}function tm(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return Er(i)}function Er(i){return i.length===0?jf:i.length===1?i[0]:function(e){return i.reduce(function(o,c){return c(o)},e)}}function Fr(i){if(i||(i=sd.Promise||Promise),!i)throw Error("no Promise impl found");return i}function Gr(){return function(i){return i.lift(new hB(i))}}function ji(i){return i?iB(i):$c}function iB(i){return new Za(function(e){return i.schedule(function(){return e.complete()})})}function Ce(i){return i&&typeof i.schedule=="function"}function um(i,e){return new Za(function(o){var c=new dc,_=0;return c.add(e.schedule(function(){_===i.length?o.complete():(o.next(i[_++]),o.closed||c.add(this.schedule()))})),c})}function ki(i,e){return e?um(i,e):new Za(Hr(i))}function Wb(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return Ce(e=i[i.length-1])?(i.pop(),um(i,e)):ki(i)}function Va(i,e){return new Za(e?function(o){return e.schedule(jB,0,{error:i,subscriber:o})}:function(o){return o.error(i)})}function jB(i){i.subscriber.error(i.error)}function kB(i,e){return e===void 0&&(e=0),function(o){return o.lift(new lB(i,e))}}function Ir(i){return i in vm&&(delete vm[i],!0)}function fe(){}function Wa(i,e){return function(o){if(typeof i!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return o.lift(new mB(i,e))}}function Jr(i,e,o){if(e){if(!Ce(e))return function(){for(var c=[],_=0;_<arguments.length;_++)c[_]=arguments[_];return Jr(i,o).apply(void 0,c).pipe(Wa(function($){return td($)?e.apply(void 0,$):e($)}))};o=e}return function(){for(var c=[],_=0;_<arguments.length;_++)c[_]=arguments[_];var $,_t=this,ga={context:_t,subject:$,callbackFunc:i,scheduler:o};return new Za(function(_s){if(o)return o.schedule(nB,0,{args:c,subscriber:_s,params:ga});if(!$){$=new li;try{i.apply(_t,c.concat([function(){for(var _c=[],_l=0;_l<arguments.length;_l++)_c[_l]=arguments[_l];$.next(1>=_c.length?_c[0]:_c),$.complete()}]))}catch(_c){sm($)?$.error(_c):console.warn(_c)}}return $.subscribe(_s)})}}function nB(i){var e=this,o=i.args,c=i.subscriber,_=i.params;i=_.callbackFunc;var $=_.context,_t=_.scheduler,ga=_.subject;if(!ga){ga=_.subject=new li,_=function(){for(var _s=[],_c=0;_c<arguments.length;_c++)_s[_c]=arguments[_c];e.add(_t.schedule(oB,0,{value:1>=_s.length?_s[0]:_s,subject:ga}))};try{i.apply($,o.concat([_]))}catch(_s){ga.error(_s)}}this.add(ga.subscribe(c))}function oB(i){var e=i.subject;e.next(i.value),e.complete()}function Kr(i,e,o){if(e){if(!Ce(e))return function(){for(var c=[],_=0;_<arguments.length;_++)c[_]=arguments[_];return Kr(i,o).apply(void 0,c).pipe(Wa(function($){return td($)?e.apply(void 0,$):e($)}))};o=e}return function(){for(var c=[],_=0;_<arguments.length;_++)c[_]=arguments[_];var $={subject:void 0,args:c,callbackFunc:i,scheduler:o,context:this};return new Za(function(_t){var ga=$.context,_s=$.subject;if(o)return o.schedule(pB,0,{params:$,subscriber:_t,context:ga});if(!_s){_s=$.subject=new li;try{i.apply(ga,c.concat([function(){for(var _c=[],_l=0;_l<arguments.length;_l++)_c[_l]=arguments[_l];(_l=_c.shift())?_s.error(_l):(_s.next(1>=_c.length?_c[0]:_c),_s.complete())}]))}catch(_c){sm(_s)?_s.error(_c):console.warn(_c)}}return _s.subscribe(_t)})}}function pB(i){var e=this,o=i.params,c=i.subscriber;i=i.context;var _=o.callbackFunc,$=o.args,_t=o.scheduler,ga=o.subject;if(!ga){ga=o.subject=new li,o=function(){for(var _s=[],_c=0;_c<arguments.length;_c++)_s[_c]=arguments[_c];(_c=_s.shift())?e.add(_t.schedule(Lr,0,{err:_c,subject:ga})):e.add(_t.schedule(qB,0,{value:1>=_s.length?_s[0]:_s,subject:ga}))};try{_.apply(i,$.concat([o]))}catch(_s){this.add(_t.schedule(Lr,0,{err:_s,subject:ga}))}}this.add(ga.subscribe(c))}function qB(i){var e=i.subject;e.next(i.value),e.complete()}function Lr(i){i.subject.error(i.err)}function Mr(i){return!!i&&typeof i.subscribe!="function"&&typeof i.then=="function"}function wm(i,e,o,c,_){if(_===void 0&&(_=new rB(i,o,c)),!_.closed)return e instanceof Za?e.subscribe(_):mi(e)(_)}function sB(i,e){return new Za(function(o){var c=new dc;return c.add(e.schedule(function(){var _=i[Xg]();c.add(_.subscribe({next:function($){c.add(e.schedule(function(){return o.next($)}))},error:function($){c.add(e.schedule(function(){return o.error($)}))},complete:function(){c.add(e.schedule(function(){return o.complete()}))}}))})),c})}function tB(i,e){return new Za(function(o){var c=new dc;return c.add(e.schedule(function(){return i.then(function(_){c.add(e.schedule(function(){o.next(_),c.add(e.schedule(function(){return o.complete()}))}))},function(_){c.add(e.schedule(function(){return o.error(_)}))})})),c})}function uB(i,e){if(!i)throw Error("Iterable cannot be null");return new Za(function(o){var c,_=new dc;return _.add(function(){c&&typeof c.return=="function"&&c.return()}),_.add(e.schedule(function(){c=i[kf](),_.add(e.schedule(function(){if(!o.closed){try{var $=c.next(),_t=$.value,ga=$.done}catch(_s){return void o.error(_s)}ga?o.complete():(o.next(_t),this.schedule())}}))})),_})}function Nr(i,e){if(i!=null){if(i&&typeof i[Xg]=="function")return sB(i,e);if(Mr(i))return tB(i,e);if(Or(i))return um(i,e);if(i&&typeof i[kf]=="function"||typeof i=="string")return uB(i,e)}throw new TypeError((i!==null&&Ia(i)||i)+" is not observable")}function ge(i,e){return e?Nr(i,e):i instanceof Za?i:new Za(mi(i))}function De(i,e){if(!e.closed){if(i instanceof Za)return i.subscribe(e);try{var o=mi(i)(e)}catch(c){e.error(c)}return o}}function Ac(i,e,o){return o===void 0&&(o=Number.POSITIVE_INFINITY),typeof e=="function"?function(c){return c.pipe(Ac(function(_,$){return ge(i(_,$)).pipe(Wa(function(_t,ga){return e(_,_t,$,ga)}))},o))}:(typeof e=="number"&&(o=e),function(c){return c.lift(new vB(i,o))})}function Ij(i){return i===void 0&&(i=Number.POSITIVE_INFINITY),Ac(jf,i)}function Pr(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return Ij(1)(Wb.apply(void 0,i))}function lf(i){return new Za(function(e){try{var o=i()}catch(c){return void e.error(c)}return(o?ge(o):ji()).subscribe(e)})}function Jj(i,e){return new Za(function(o){var c=i.length;if(c===0)o.complete();else for(var _=Array(c),$=0,_t=0,ga=function(_c){var _l=ge(i[_c]),Tl=!1;o.add(_l.subscribe({next:function(Cl){Tl||(Tl=!0,_t++),_[_c]=Cl},error:function(Cl){return o.error(Cl)},complete:function(){++$!==c&&Tl||(_t===c&&o.next(e?e.reduce(function(Cl,Pl,Dl){return Cl[Pl]=_[Dl],Cl},{}):_),o.complete())}}))},_s=0;_s<c;_s++)ga(_s)})}function Bc(i,e,o,c){return Vg(o)&&(c=o,o=void 0),c?Bc(i,e,o).pipe(Wa(function(_){return td(_)?c.apply(void 0,_):c(_)})):new Za(function(_){Qr(i,e,function($){1<arguments.length?_.next(Array.prototype.slice.call(arguments)):_.next($)},_,o)})}function Qr(i,e,o,c,_){if(i&&typeof i.addEventListener=="function"&&typeof i.removeEventListener=="function"){i.addEventListener(e,o,_);var $=function(){return i.removeEventListener(e,o,_)}}else if(i&&typeof i.on=="function"&&typeof i.off=="function")i.on(e,o),$=function(){return i.off(e,o)};else if(i&&typeof i.addListener=="function"&&typeof i.removeListener=="function")i.addListener(e,o),$=function(){return i.removeListener(e,o)};else{if(!i||!i.length)throw new TypeError("Invalid event target");for(var _t=0,ga=i.length;_t<ga;_t++)Qr(i[_t],e,o,c,_)}c.add($)}function Rr(i,e,o){return o?Rr(i,e).pipe(Wa(function(c){return td(c)?o.apply(void 0,c):o(c)})):new Za(function(c){var _=function(){for(var _t=[],ga=0;ga<arguments.length;ga++)_t[ga]=arguments[ga];return c.next(_t.length===1?_t[0]:_t)};try{var $=i(_)}catch(_t){return void c.error(_t)}if(Vg(e))return function(){return e(_,$)}})}function wB(i){var e=i.subscriber,o=i.condition;if(!e.closed){if(i.needIterate)try{i.state=i.iterate(i.state)}catch($){return void e.error($)}else i.needIterate=!0;if(o){var c=void 0;try{c=o(i.state)}catch($){return void e.error($)}if(!c)return void e.complete();if(e.closed)return}try{var _=i.resultSelector(i.state)}catch($){return void e.error($)}if(!e.closed&&(e.next(_),!e.closed))return this.schedule(i)}}function xm(i){return!td(i)&&0<=i-parseFloat(i)+1}function Yg(i,e){return i===void 0&&(i=0),e===void 0&&(e=Ee),(!xm(i)||0>i)&&(i=0),e&&typeof e.schedule=="function"||(e=Ee),new Za(function(o){return o.add(e.schedule(xB,i,{subscriber:o,counter:0,period:i})),o})}function xB(i){var e=i.subscriber,o=i.counter;i=i.period,e.next(o),this.schedule({subscriber:e,counter:o+1,period:i},i)}function Nc(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];e=Number.POSITIVE_INFINITY;var o=null,c=i[i.length-1];return Ce(c)?(o=i.pop(),1<i.length&&typeof i[i.length-1]=="number"&&(e=i.pop())):typeof c=="number"&&(e=i.pop()),o===null&&i.length===1&&i[0]instanceof Za?i[0]:Ij(e)(ki(i,o))}function ym(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];if(i.length===0)return $c;var o=i[0],c=i.slice(1);return i.length===1&&td(o)?ym.apply(void 0,o):new Za(function(_){var $=function(){return _.add(ym.apply(void 0,c).subscribe(_))};return ge(o).subscribe({next:function(_t){_.next(_t)},error:$,complete:$})})}function yB(i){var e=i.keys,o=i.index,c=i.subscriber,_=i.subscription;if(i=i.obj,!c.closed)if(o<e.length){var $=e[o];c.next([$,i[$]]),_.add(this.schedule({keys:e,index:o+1,subscriber:c,subscription:_,obj:i}))}else c.complete()}function zB(i,e){function o(){return!o.pred.apply(o.thisArg,arguments)}return o.pred=i,o.thisArg=e,o}function sc(i,e){return function(o){return o.lift(new AB(i,e))}}function bb(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];if(i.length===1){if(!td(i[0]))return i[0];i=i[0]}return ki(i,void 0).lift(new BB)}function CB(i){var e=i.start,o=i.index,c=i.subscriber;o>=i.count?c.complete():(c.next(e),c.closed||(i.index=o+1,i.start=e+1,this.schedule(i)))}function Fe(i,e,o){i===void 0&&(i=0);var c=-1;return xm(e)?c=1>Number(e)?1:Number(e):Ce(e)&&(o=e),Ce(o)||(o=Ee),new Za(function(_){var $=xm(i)?i:+i-o.now();return o.schedule(DB,$,{index:0,period:c,subscriber:_})})}function DB(i){var e=i.index,o=i.period,c=i.subscriber;if(c.next(e),!c.closed){if(o===-1)return c.complete();i.index=e+1,this.schedule(i,o)}}function zm(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return typeof(e=i[i.length-1])=="function"&&i.pop(),ki(i,void 0).lift(new EB(e))}function Kj(i){var e=arguments.length,o=Ee;Ce(arguments[arguments.length-1])&&(o=arguments[arguments.length-1],e--);var c=null;2<=e&&(c=arguments[1]);var _=Number.POSITIVE_INFINITY;return 3<=e&&(_=arguments[2]),function($){return $.lift(new FB(i,c,_,o))}}function Sr(i){var e=i.subscriber,o=i.context;o&&e.closeContext(o),e.closed||(i.context=e.openContext(),i.context.closeAction=this.schedule(i,i.bufferTimeSpan))}function GB(i){var e=i.bufferCreationInterval,o=i.bufferTimeSpan,c=i.subscriber,_=i.scheduler,$=c.openContext();c.closed||(c.add($.closeAction=_.schedule(Tr,o,{subscriber:c,context:$})),this.schedule(i,e))}function Tr(i){i.subscriber.closeContext(i.context)}function Rb(i){return function(e){var o=new HB(i);return e=e.lift(o),o.caught=e}}function Am(i,e){return Ac(i,e,1)}function Ur(i){return i===void 0&&(i=null),function(e){return e.lift(new IB(i))}}function mf(i,e){e===void 0&&(e=Ee);var o=i instanceof Date&&!isNaN(+i)?+i-e.now():Math.abs(i);return function(c){return c.lift(new JB(o,e))}}function Vr(i,e){return function(o){return o.lift(new KB(i,e))}}function Zf(i){return i===void 0&&(i=LB),function(e){return e.lift(new MB(i))}}function LB(){return new Lj}function Xb(i){return function(e){return i===0?ji():e.lift(new NB(i))}}function Mj(i){return function(e){return e.lift(new OB(i))}}function La(i,e){var o=2<=arguments.length;return function(c){return c.pipe(i?sc(function(_,$){return i(_,$,c)}):jf,Xb(1),o?Ur(e):Zf(function(){return new Lj}))}}function PB(){return function(i){return i.lift(new QB)}}function Wr(i){return function(e){return i===0?ji():e.lift(new RB(i))}}function ni(i){return function(e){return e.lift(new SB(i))}}function Nj(i,e){var o=!1;return 2<=arguments.length&&(o=!0),function(c){return c.lift(new TB(i,e,o))}}function Xr(i,e){return 2<=arguments.length?function(o){return tm(Nj(i,e),Wr(1),Ur(e))(o)}:function(o){return tm(Nj(function(c,_,$){return i(c,_,$+1)}),Wr(1))(o)}}function UB(i,e){return function(o){var c=typeof i=="function"?i:function(){return i};if(typeof e=="function")return o.lift(new VB(c,e));var _=Object.create(o,WB);return _.source=o,_.subjectFactory=c,_}}function Zg(i){return function(e){return e.lift(new XB(i,e))}}function YB(){return new ec}function $g(){return function(i){return Gr()(UB(YB)(i))}}function Yr(i,e,o){var c=i&&Ia(i)==="object"?i:{bufferSize:i,windowTime:e,refCount:!1,scheduler:o};return function(_){return _.lift(ZB(c))}}function ZB(i){var e,o,c=i.bufferSize,_=c===void 0?Number.POSITIVE_INFINITY:c,$=(c=i.windowTime)===void 0?Number.POSITIVE_INFINITY:c,_t=i.refCount,ga=i.scheduler,_s=0,_c=!1,_l=!1;return function(Tl){if(_s++,!e||_c){_c=!1;var Cl=(e=new ah(_,$,ga)).subscribe(this);o=Tl.subscribe({next:function(Pl){e.next(Pl)},error:function(Pl){_c=!0,e.error(Pl)},complete:function(){_l=!0,o=void 0,e.complete()}}),_l&&(o=void 0)}else Cl=e.subscribe(this);this.add(function(){_s--,Cl.unsubscribe(),Cl=void 0,o&&!_l&&_t&&_s===0&&(o.unsubscribe(),e=o=void 0)})}}function Cc(i,e){return typeof e=="function"?function(o){return o.pipe(Cc(function(c,_){return ge(i(c,_)).pipe(Wa(function($,_t){return e(c,$,_,_t)}))}))}:function(o){return o.lift(new $B(i))}}function he(i){return function(e){return e.lift(new aC(i))}}function Ka(i,e,o){return function(c){return c.lift(new bC(i,e,o))}}function cC(i,e,o){return e===void 0&&(e=Ee),o===void 0&&(o=dC),function(c){return c.lift(new eC(i,e,o.leading,o.trailing))}}function fC(i){i.subscriber.clearThrottle()}function gC(i,e,o){return o===void 0&&(o=Ee),function(c){var _=i instanceof Date&&!isNaN(+i),$=_?+i-o.now():Math.abs(i);return c.lift(new hC($,_,e,o))}}function Oc(i,e){return e===void 0&&(e=Ee),gC(i,Va(new ad),e)}function iC(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return function(o){var c;return typeof i[i.length-1]=="function"&&(c=i.pop()),o.lift(new jC(i,c))}}function Zr(i){(Bm||i)&&($r.abort(),i&&($r=new AbortController),Bm=i)}function as(i,e,o,c,_){i!==e&&bs(e,function($,_t){if(_||(_=new Qg),Kc($)){$=_;var ga=Cm(i,_t),_s=Cm(e,_t),_c=$.get(_s);if(_c)Dm(i,_t,_c);else{var _l=(_c=c?c(ga,_s,_t+"",i,e,$):void 0)===void 0;if(_l){var Tl=lc(_s),Cl=!Tl&&gi(_s),Pl=!Tl&&!Cl&&om(_s);_c=_s,Tl||Cl||Pl?lc(ga)?_c=ga:ee(ga)&&$f(ga)?_c=jm(ga):Cl?(_l=!1,_c=pr(_s,!0)):Pl?(_l=!1,_c=cs(_s,!0)):_c=[]:ds(_s)||oi(_s)?(_c=ga,oi(ga)?_c=bh(ga,hi(ga)):Kc(ga)&&!Em(ga)||(_c=qr(_s))):_l=!1}_l&&($.set(_s,_c),as(_c,_s,o,c,$),$.delete(_s)),Dm(i,_t,_c)}}else(ga=c?c(Cm(i,_t),$,_t+"",i,e,_):void 0)===void 0&&(ga=$),Dm(i,_t,ga)},hi)}function kC(i){var e=1,o=Fm;(1>=arguments.length?0:arguments.length-1)==1?typeof(1>=arguments.length?void 0:arguments[1])=="number"?e=1>=arguments.length?void 0:arguments[1]:o=1>=arguments.length?void 0:arguments[1]:(1>=arguments.length?0:arguments.length-1)==2&&(e=1>=arguments.length?void 0:arguments[1],o=2>=arguments.length?void 0:arguments[2]);var c=e||1;return function(_){return _.pipe(Nj(function($,_t){var ga=o.now(),_s=ga-i;if(($=$.filter(function(Tl){return Tl.until>_s})).length>=c){var _c=$[$.length-1],_l=$[0].until+i*Math.floor($.length/c);$.push({delay:_c.until<ga?_l-ga:_l-_c.until,until:_l,value:_t})}else $.push({delay:0,until:ga,value:_t});return $},[]),Wa(function($){return $[$.length-1]}),Am(function($){var _t=Wb($.value);return $.delay?_t.pipe(mf($.delay,o)):_t}))}}function lC(i,e){var o=(e=e===void 0?{protocols:es,makeWebSocket:fs}:e).protocols,c=o===void 0?es:o,_=(e=e.makeWebSocket)===void 0?fs:e;return new Za(function($){var _t,ga=new ec,_s=_(i,c),_c=!1,_l=!1,Tl=!1,Cl=function(Pl){if(_t)throw _c=!0,Pl=Error("Web socket message factory function called more than once"),$.error(Pl),Pl;return _t=Pl.subscribe(function(Dl){_s.send(Dl)}),ga};return _s.onopen=function(){Tl=!0,_l?(_c=!0,_s.close()):$.next(Cl)},_s.onmessage=function(Pl){ga.next(Pl.data)},_s.onerror=function(Pl){_c=!0,$.error(Error(Pl.message))},_s.onclose=function(Pl){_c||(_c=!0,_l?($.complete(),ga.complete()):$.error(Error(Pl.code===1e3?"Normal closure":Pl.reason)))},function(){_l=!0,_t&&_t.unsubscribe(),_c||(_c=!0,Tl&&_s.close())}})}function Oj(){this._listeners={}}function gs(i){return typeof Float32Array<"u"?function(){function e(_s,_c,_l){$[0]=_s,_c[_l]=_t[0],_c[_l+1]=_t[1],_c[_l+2]=_t[2],_c[_l+3]=_t[3]}function o(_s,_c,_l){$[0]=_s,_c[_l]=_t[3],_c[_l+1]=_t[2],_c[_l+2]=_t[1],_c[_l+3]=_t[0]}function c(_s,_c){return _t[0]=_s[_c],_t[1]=_s[_c+1],_t[2]=_s[_c+2],_t[3]=_s[_c+3],$[0]}function _(_s,_c){return _t[3]=_s[_c],_t[2]=_s[_c+1],_t[1]=_s[_c+2],_t[0]=_s[_c+3],$[0]}var $=new Float32Array([-0]),_t=new Uint8Array($.buffer),ga=_t[3]===128;i.writeFloatLE=ga?e:o,i.writeFloatBE=ga?o:e,i.readFloatLE=ga?c:_,i.readFloatBE=ga?_:c}():function(){function e(c,_,$,_t){var ga=0>_?1:0;if(ga&&(_=-_),_===0)c(0<1/_?0:2147483648,$,_t);else if(isNaN(_))c(2143289344,$,_t);else if(34028234663852886e22<_)c((ga<<31|2139095040)>>>0,$,_t);else if(11754943508222875e-54>_)c((ga<<31|Math.round(_/1401298464324817e-60))>>>0,$,_t);else{var _s=Math.floor(Math.log(_)/Math.LN2);c((ga<<31|_s+127<<23|8388607&Math.round(_*Math.pow(2,-_s)*8388608))>>>0,$,_t)}}function o(c,_,$){return $=c(_,$),c=2*($>>31)+1,_=$>>>23&255,$&=8388607,_===255?$?NaN:1/0*c:_===0?1401298464324817e-60*c*$:c*Math.pow(2,_-150)*($+8388608)}i.writeFloatLE=e.bind(null,hs),i.writeFloatBE=e.bind(null,is),i.readFloatLE=o.bind(null,js),i.readFloatBE=o.bind(null,ks)}(),typeof Float64Array<"u"?function(){function e(_s,_c,_l){$[0]=_s,_c[_l]=_t[0],_c[_l+1]=_t[1],_c[_l+2]=_t[2],_c[_l+3]=_t[3],_c[_l+4]=_t[4],_c[_l+5]=_t[5],_c[_l+6]=_t[6],_c[_l+7]=_t[7]}function o(_s,_c,_l){$[0]=_s,_c[_l]=_t[7],_c[_l+1]=_t[6],_c[_l+2]=_t[5],_c[_l+3]=_t[4],_c[_l+4]=_t[3],_c[_l+5]=_t[2],_c[_l+6]=_t[1],_c[_l+7]=_t[0]}function c(_s,_c){return _t[0]=_s[_c],_t[1]=_s[_c+1],_t[2]=_s[_c+2],_t[3]=_s[_c+3],_t[4]=_s[_c+4],_t[5]=_s[_c+5],_t[6]=_s[_c+6],_t[7]=_s[_c+7],$[0]}function _(_s,_c){return _t[7]=_s[_c],_t[6]=_s[_c+1],_t[5]=_s[_c+2],_t[4]=_s[_c+3],_t[3]=_s[_c+4],_t[2]=_s[_c+5],_t[1]=_s[_c+6],_t[0]=_s[_c+7],$[0]}var $=new Float64Array([-0]),_t=new Uint8Array($.buffer),ga=_t[7]===128;i.writeDoubleLE=ga?e:o,i.writeDoubleBE=ga?o:e,i.readDoubleLE=ga?c:_,i.readDoubleBE=ga?_:c}():function(){function e(c,_,$,_t,ga,_s){var _c=0>_t?1:0;if(_c&&(_t=-_t),_t===0)c(0,ga,_s+_),c(0<1/_t?0:2147483648,ga,_s+$);else if(isNaN(_t))c(0,ga,_s+_),c(2146959360,ga,_s+$);else if(17976931348623157e292<_t)c(0,ga,_s+_),c((_c<<31|2146435072)>>>0,ga,_s+$);else if(22250738585072014e-324>_t)c((_t/=5e-324)>>>0,ga,_s+_),c((_c<<31|_t/4294967296)>>>0,ga,_s+$);else{var _l=Math.floor(Math.log(_t)/Math.LN2);_l===1024&&(_l=1023),c(4503599627370496*(_t*=Math.pow(2,-_l))>>>0,ga,_s+_),c((_c<<31|_l+1023<<20|1048576*_t&1048575)>>>0,ga,_s+$)}}function o(c,_,$,_t,ga){return _=c(_t,ga+_),_t=c(_t,ga+$),c=2*(_t>>31)+1,_=4294967296*(1048575&_t)+_,($=_t>>>20&2047)===2047?_?NaN:1/0*c:$===0?5e-324*c*_:c*Math.pow(2,$-1075)*(_+4503599627370496)}i.writeDoubleLE=e.bind(null,hs,0,4),i.writeDoubleBE=e.bind(null,is,4,0),i.readDoubleLE=o.bind(null,js,0,4),i.readDoubleBE=o.bind(null,ks,4,0)}(),i}function hs(i,e,o){e[o]=255&i,e[o+1]=i>>>8&255,e[o+2]=i>>>16&255,e[o+3]=i>>>24}function is(i,e,o){e[o]=i>>>24,e[o+1]=i>>>16&255,e[o+2]=i>>>8&255,e[o+3]=255&i}function js(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16|i[e+3]<<24)>>>0}function ks(i,e){return(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}function mc(i,e){this.lo=i>>>0,this.hi=e>>>0}function pi(i,e,o){this.fn=i,this.len=e,this.next=void 0,this.val=o}function Gm(){}function mC(i){this.head=i.head,this.tail=i.tail,this.len=i.len,this.next=i.states}function ib(){this.len=0,this.tail=this.head=new pi(Gm,0,0),this.states=null}function Hm(i,e,o){e[o]=255&i}function Im(i,e){this.len=i,this.next=void 0,this.val=e}function Jm(i,e,o){for(;i.hi;)e[o++]=127&i.lo|128,i.lo=(i.lo>>>7|i.hi<<25)>>>0,i.hi>>>=7;for(;127<i.lo;)e[o++]=127&i.lo|128,i.lo>>>=7;e[o++]=i.lo}function Km(i,e,o){e[o]=255&i,e[o+1]=i>>>8&255,e[o+2]=i>>>16&255,e[o+3]=i>>>24}function ie(){Lm.call(this)}function nC(i,e,o){40>i.length?Ra.utf8.write(i,e,o):e.utf8Write?e.utf8Write(i,o):e.write(i,o)}function Od(i,e){return RangeError("index out of range: "+i.pos+" + "+(e||1)+" > "+i.len)}function Yb(i){this.buf=i,this.pos=0,this.len=i.length}function Mm(){var i=new ls(0,0),e=0;if(!(4<this.len-this.pos)){for(;3>e;++e){if(this.pos>=this.len)throw Od(this);if(i.lo=(i.lo|(127&this.buf[this.pos])<<7*e)>>>0,128>this.buf[this.pos++])return i}return i.lo=(i.lo|(127&this.buf[this.pos++])<<7*e)>>>0,i}for(;4>e;++e)if(i.lo=(i.lo|(127&this.buf[this.pos])<<7*e)>>>0,128>this.buf[this.pos++])return i;if(i.lo=(i.lo|(127&this.buf[this.pos])<<28)>>>0,i.hi=(i.hi|(127&this.buf[this.pos])>>4)>>>0,128>this.buf[this.pos++])return i;if(e=0,4<this.len-this.pos){for(;5>e;++e)if(i.hi=(i.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,128>this.buf[this.pos++])return i}else for(;5>e;++e){if(this.pos>=this.len)throw Od(this);if(i.hi=(i.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,128>this.buf[this.pos++])return i}throw Error("invalid varint encoding")}function Pj(i,e){return(i[e-4]|i[e-3]<<8|i[e-2]<<16|i[e-1]<<24)>>>0}function ms(){if(this.pos+8>this.len)throw Od(this,8);return new ls(Pj(this.buf,this.pos+=4),Pj(this.buf,this.pos+=4))}function ag(i){Nm.call(this,i)}function qi(i,e,o){if(typeof i!="function")throw TypeError("rpcImpl must be a function");Ra.EventEmitter.call(this),this.rpcImpl=i,this.requestDelimited=!!e,this.responseDelimited=!!o}function yb(i){return typeof i=="string"&&/^[\s\w!#$%&()+,.:;<=>?@[\]^{|}~-]{1,64}$/.test(i)&&i!=="null"}function ns(i){try{var e=i.split(".").map(function(c){return Number(c)})}catch{return!1}if(e.length!==4||e[0]===0)return!1;for(i=0;i<e.length;i++){var o=e[i];if(!Number.isInteger(o)||0>o||255<o)return!1}return!0}function os(i,e){if(!Array.isArray(e)||e.length===0||32<e.length||e.some(function(o){return o.length===0||32<o.length}))throw new ja("arguments is not valid",Ub);if(!yb(i))throw new ja("ID is invalid",Ub)}function ri(i){var e=i.attributes,o=i.attrSizeMap,c=i.maxAttrsCount,_=i.maxAttrValueSize;if(i=i.maxTotalSize,!Lg(e))throw new ja("attributes must be an object",Ub);if(Object.keys(e).length>c)throw new Dc("Exceed the limit of ".concat(c," attributes"),ch);if(Object.keys(e).length===0)throw new ja("The attributes is an empty object",Ub);var $=0,_t=0;for(e=Object.entries(e);_t<e.length;_t++){var ga=Lb(e[_t],2),_s=ga[1];ga=new Blob([ga[0]]).size;var _c=new Blob([_s]).size;if(ga===0||32<ga)throw new ja("Invalid attribute key",Ub);if(_c>_)throw new Dc("Invalid attribute value, over the limit of ".concat(_," bytes"),ch);if(typeof _s!="string"||_s.length===0)throw new ja("Invalid attribute value",Ub);$+=ga,$+=_c}if($>i)throw new Dc("The attributes size overflow",ch);if(o!==void 0){if(Object.keys(o).length>c)throw new Dc("Exceed the limit of ".concat(c," attributes"),ch);for($=c=0,o=Object.entries(o);$<o.length;$++){if(_t=(e=Lb(o[$],2))[1],(e=new Blob([e[0]]).size)===0)throw new ja("Invalid attribute key",Ub);if(_t>_)throw new Dc("Invalid attribute value, over the limit of ".concat(_," bytes"),ch);c+=e,c+=_t}if(c>i)throw new Dc("The attributes size overflow",ch)}}function nf(i){var e=i.items,o=i.maxMetaDataCount,c=i.maxMetaValueSize;if(i=i.type,!Array.isArray(e))throw new ja("params must be an MetadataItem array",Mb);var _=e.map(function(_c){return[_c.getKey(),_c.getValue()]});if(_.length>o)throw new Dc("Exceed the limit of ".concat(o," metadata items"),Om);if(_.length===0)throw new ja("The metadata is empty ",Mb);if((i==="Update"||i==="Delete")&&e.map(function(_c){return _c.getRevision()}).includes(0))throw new ja("The operation limit metadata revision can not set 0 ",of);for(o=0;o<_.length;o++){var $=Lb(_[o],2),_t=$[0];$=$[1];var ga=new Blob([_t??""]).size,_s=new Blob([$??""]).size;if((_t==null?void 0:_t[0])==="_")throw new ja("Invalid metaData key",Mb);if(ga===0||32<ga)throw new ja("Invalid metaData key",Om);if(typeof $!="string")throw new ja("Invalid metadata value",Mb);if(i!=="Delete"&&_s>c)throw new Dc("Invalid metadata value, over the limit of ".concat(c," bytes"),Om)}if(new Set(e.map(function(_c){return _c.getKey()})).size!==e.map(function(_c){return _c.getKey()}).length)throw new ja("meta data params key must be key must be unique",oC)}function Qj(i,e){return Math.floor(Math.random()*(Math.floor(e)-Math.ceil(i)+1))+i}function Rj(){var i=Qj(0,4294967295),e=Qj(1,4294967295);return new D(i,e,!0)}function fc(i){return i.toString().padEnd(32,"0")}function ps(i,e){return new TypeError("Unexpected ".concat(i,": ").concat(e))}function qs(i,e){return i=i.split(".").map(function(o){return Number(o)}),e=e.split(".").map(function(o){return Number(o)}),Math.sqrt(1e3*Math.pow(i[0]-e[0],2)+100*Math.pow(i[1]-e[1],2)+10*Math.pow(i[2]-e[2],2)+1*Math.pow(i[3]-e[3],2))}function rs(i){return i.lessThanOrEqual(Number.MAX_SAFE_INTEGER)?i.toNumber():i.toString()}function Pm(i,e){e="".concat(i).concat(e||"");var o=ss.get(e)||1;return ss.set(e,o+1),"".concat(i).concat(o)}function ts(i,e){var o=typeof e=="number"?e:e!==void 0&&typeof e!="string"?e.code:void 0;return e=typeof e!="number"&&typeof e!="string"&&e!==void 0&&e.serverCode!==void 0?e.serverCode:void 0,o="".concat(o!==void 0?" Error Code ".concat(o):"").concat(e!==void 0?", server Code ".concat(e):""),i=typeof i=="string"&&i?Sj(i):Array.isArray(i)&&typeof i[0]=="string"&&i[0]?Sj(us.apply(void 0,[i[0]].concat(ra(i.slice(1))))):"","".concat(o===""?"":"".concat(o," - ")).concat(i)}function pC(i,e){return Qm.apply(this,arguments)}function Qm(){return(Qm=za(W.mark(function i(e,o){return W.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!o||!o.aborted){c.next=2;break}return c.abrupt("return");case 2:return c.abrupt("return",new Promise(function(_){setTimeout(_,e),o==null||o.addEventListener("abort",_)}));case 3:case"end":return c.stop()}},i)}))).apply(this,arguments)}function Tj(i,e,o){return Rm.apply(this,arguments)}function Rm(){return(Rm=za(W.mark(function i(e,o,c){var _,$,_t,ga,_s,_c,_l,Tl,Cl,Pl,Dl,Jl,zl,Bl,Vl,_d,Sp,Up,Kp,Hp,_m,I0,Cp,Jp,Zp,i0;return W.wrap(function(Np){for(;;)switch(Np.prev=Np.next){case 0:if(_=o.body,$=o.headers,_t=$===void 0?{}:$,ga=o.timeout,_s=ga===void 0?1e4:ga,_c=o.signal,_l=o.withCredentials,Tl=_l!==void 0&&_l,Cl=(c||{}).useBinaryResponse,Pl=Cl!==void 0&&Cl,(Dl=new XMLHttpRequest).open("POST",e,!0),Dl.responseType=Pl?"arraybuffer":"text",Dl.withCredentials=Tl,Dl.timeout=_s,Jl=_ instanceof FormData,zl=_ instanceof Uint8Array,!(1<(Bl=Object.keys(_t).filter(function(Dp){return Dp.toLowerCase()==="content-type"})).length)){Np.next=14;break}throw new RangeError("multiple content-type");case 14:Bl.length===0&&(zl?_t["Content-Type"]="application/octet-stream":Jl||(_t["Content-Type"]="application/json"));case 15:if("setRequestHeader"in Dl){Np.next=46;break}return Dl.abort(),Np.next=19,fetch(e,{body:Jl||zl?_:JSON.stringify(_),cache:"no-cache",credentials:Tl?"include":"same-origin",headers:_t,method:"POST",mode:"cors",referrer:"no-referrer",signal:_c});case 19:if(Vl=Np.sent,!(200<=(_d=Vl.status)&&300>_d||_d===304)){Np.next=31;break}if(!Pl){Np.next=27;break}return Np.next=25,Vl.arrayBuffer();case 25:return Sp=Np.sent,Np.abrupt("return",{status:_d,responseData:Sp});case 27:return Np.next=29,Vl.text();case 29:return Up=Np.sent,Np.abrupt("return",{status:_d,responseText:Up});case 31:return Kp=new Pa(["Post XHR failure, status %d",_d]),Np.prev=32,Np.next=35,Vl.text();case 35:throw Hp=Np.sent,Kp.statusCode=_d,Kp.message=Hp||"Request failed, status ".concat(_d),Kp;case 41:throw Np.prev=41,Np.t0=Np.catch(32),Kp.statusCode=_d,Kp.message="Request failed, status ".concat(_d),Kp;case 46:if(Object.keys(_t).length!==0)for(_m=0,I0=Object.entries(_t);_m<I0.length;_m++)Cp=Lb(I0[_m],2),Jp=Cp[0],Zp=Cp[1],Dl.setRequestHeader(Jp,Zp);return _c!==void 0&&(i0=function Dp(){Dl.abort(),_c.removeEventListener("abort",Dp)},_c.addEventListener("abort",i0)),Jl||zl?Dl.send(_):Dl.send(JSON.stringify(_)),Np.abrupt("return",new Promise(function(Dp,Qp){Dl.onload=function(){var n0=Dl.status;if(200<=n0&&300>n0||n0===304)Dp(Pl?{status:n0,responseData:Dl.response}:{status:n0,responseText:Dl.responseText});else{var Bp=new Pa(["Post XHR failure, status %d",n0]);Bp.statusCode=n0,Bp.message=Dl.response||"Request failed, status ".concat(Dl.status),Qp(Bp)}},Dl.ontimeout=function(n0){Qp(new Pc(["XHR request timed out after %d ms",_s],{originalError:n0}))},Dl.onerror=function(){var n0=new Pa(["Post XHR failure, status %d",Dl.status]);n0.statusCode=Dl.status,n0.message=Dl.response||"Request failed, status ".concat(Dl.status),Qp(n0)},Dl.onabort=function(){try{Qp(new DOMException("The request aborted.","AbortError"))}catch{var n0=Error("The request aborted.");n0.name="AbortError",Qp(n0)}}}));case 50:case"end":return Np.stop()}},i,null,[[32,41]])}))).apply(this,arguments)}function vs(i,e){if(!Lg(i))throw new ja("message object is not a plain object",e);if(i.messageType===void 0)if(i.rawMessage instanceof Uint8Array){if(i.messageType="RAW",i.text!==void 0)throw new ja("Raw messages cannot have text property. Use description instead",e)}else{if(typeof i.text!="string")throw new ja("messageType is undefined",e);if(i.messageType="TEXT",i.rawMessage!==void 0)throw new ja("Text messages cannot have rawMessage property",e)}}function Uj(i){return Sm.apply(this,arguments)}function Sm(){return(Sm=za(W.mark(function i(e){var o,c,_,$,_t,ga,_s,_c,_l,Tl,Cl,Pl,Dl,Jl,zl,Bl,Vl,_d,Sp,Up,Kp;return W.wrap(function(Hp){for(;;)switch(Hp.prev=Hp.next){case 0:if(o=e.message,c=e.peerId,_=e.toPeer,$=e.session,_t=e.errorCodes,ga=e.diff,_s=e.logger,$!==void 0){Hp.next=3;break}throw new ia("The client is not logged in. Cannot do the operation",_t.NOT_LOGGED_IN);case 3:if(_c=!1,_l=_?o.messageType==="TEXT"?vb.P2pSMsgNoOfflineFlag:vb.P2pRMsgNoOfflineFlag:o.messageType==="TEXT"?vb.ChannelSMsg:vb.ChannelRMsg,o.messageType!=="TEXT"||!o.text.startsWith("AgoraRTMLegacyEndcallCompatibleMessagePrefix")||!_){Hp.next=14;break}if(Tl=o.text.split("_"),Cl=Lb(Tl,3),Pl=Cl[0],Dl=Cl[1],Cl[2]!==void 0&&yb(Dl)&&Pl==="AgoraRTMLegacyEndcallCompatibleMessagePrefix"){Hp.next=13;break}throw $.emit("messageCount",{messageCategory:_l,type:"common",key:"sentcount"}),$.emit("messageCount",{messageCategory:_l,type:"common",key:"invalidmessagecount"}),new ja("Message is not valid",si);case 13:_c=!0;case 14:if(Jl=Date.now(),zl=$.messageSentTimes.length-1,!((Bl=$.messageSentTimes[zl])&&Bl+3e3<Jl)){Hp.next=21;break}$.messageSentTimes=[Jl],Hp.next=34;break;case 21:Vl=zl;case 22:if(!(0<=Vl)){Hp.next=33;break}if(!($.messageSentTimes[Vl]+3e3<Jl)){Hp.next=26;break}return $.messageSentTimes=$.messageSentTimes.slice(Vl+1,zl+1),Hp.abrupt("break",33);case 26:if(!(180<=zl-Vl+1)){Hp.next=30;break}throw $.emit("messageCount",{messageCategory:_l,type:"common",key:"sentcount"}),$.emit("messageCount",{messageCategory:_l,type:"common",key:"toooftencount"}),new Dc("Message sent failed, exceeded the 180 message in 3 seconds",_t.TOO_OFTEN);case 30:Vl--,Hp.next=22;break;case 33:$.messageSentTimes.push(Jl);case 34:Hp.t0=o.messageType,Hp.next=Hp.t0==="TEXT"?37:Hp.t0==="RAW"?42:44;break;case 37:if(!_c){Hp.next=41;break}return _d=o.text.split("_"),Sp=Lb(_d,3),Up=Sp[1],Kp=Sp[2],_s.info("[rtm-API] EndCall message send api is called"),Hp.abrupt("return",$.sendInvitationMessage({peerId:c,type:"CallCancel",extra:Kp,channelId:Up,callId:"0"}));case 41:return Hp.abrupt("return",$.sendTextMessage(o.text,c,_,1e4-ga));case 42:return o.description===void 0&&(o.description=""),Hp.abrupt("return",$.sendRawMessage(o.rawMessage,o.description,c,_,1e4-ga));case 44:throw $.emit("messageCount",{messageCategory:_l,type:"common",key:"sentcount"}),$.emit("messageCount",{messageCategory:_l,type:"common",key:"invalidmessagecount"}),new ja("Invalid message type",si);case 47:case"end":return Hp.stop()}},i)}))).apply(this,arguments)}function qC(i){var e=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],o=i.replace(/(https?:\/\/)?(www.)?/i,"");return e||(o=o.split(".").slice(i.length-2).join(".")),o.indexOf("/")!==-1?o.split("/")[0]:o}function wb(i){if(typeof i!="string")return"[Sensitive Info]";var e=Math.floor(.7*i.length),o=i.length;return ws(i,e,o,"*".repeat(o-e))}function xs(i,e,o){function c(_){if(i===void 0)return i;if(or(_))return _;if(Array.isArray(_))return _.map(c);var $={},_t=0;for(_=Vj(_);_t<_.length;_t++){var ga=Lb(_[_t],2),_s=ga[0];if(typeof(ga=ga[1])=="string"&&o.includes(_s)){$[_s]=typeof ga=="string"?wb(ga):"[Sensitive Info]";break}e.includes(_s)?$[_s]="[Hidden Info]":$[_s]=ga==null?ga:o.includes(_s)?"[Sensitive Info]":c(ga)}return $}return Array.isArray(i)?i.map(c):c(i)}function ys(i){return Object.getOwnPropertyNames(i).forEach(function(e){Ia(e=i[e])=="object"&&e!==null&&ys(e)}),Object.freeze(i)}function ti(i){return new TextDecoder("utf-8").decode(i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength))}function Wj(i){return new TextEncoder().encode(i).length}function zs(){for(var i=0,e=arguments.length,o=Array(e),c=0;c<e;c++)o[c]=arguments[c];for(e=0;e<o.length;e++)i+=o[e].length;for(i=new Uint8Array(i),c=e=0;c<o.length;c++){var _=o[c];i.set(_,e),e+=_.length}return i}function dh(i,e,o){var c=i.match(/([^?#]+)(\?[^#]*)?(#.*)?/);if(i=c==null?void 0:c[1],c=c==null?void 0:c[2]){var _;for(c=c.substr(1).split("&"),_=0;_<c.length;_++)if(c[_].split("=")[0]==e){c[_]=e+"="+encodeURIComponent(o);break}return _==c.length&&c.push(e+"="+encodeURIComponent(o)),i+"?"+c.join("&")}return i+"?"+e+"="+encodeURIComponent(o)}function ws(i,e,o,c){return typeof i!="string"?"[Sensitive Info]":i.substring(0,e)+c+i.substring(o)}function ui(i){return typeof i=="string"&&i.length!==0&&i!=="false"&&i!=="null"&&i!=="undefined"}function As(i){var e=[];return function o(c){if(c===null||Ia(c)!=="object")return c;if(e.indexOf(c)!==-1)return"[Circular]";if(e.push(c),typeof c.toJSON=="function")try{var _=o(c.toJSON());return e.pop(),_}catch($){return"[Throws: "+($?$.message:"?")+"]"}return Array.isArray(c)?(_=c.map(o),e.pop(),_):(_=Object.keys(c).reduce(function($,_t){t:{if(rC.call(c,_t))try{var ga=c[_t];break t}catch(_s){ga="[Throws: "+(_s?_s.message:"?")+"]";break t}ga=c[_t]}return $[_t]=o(ga),$},{}),e.pop(),_)}(i)}function sC(i){if(!(100<(i=String(i)).length)&&(i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i))){var e=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*e;case"weeks":case"week":case"w":return 6048e5*e;case"days":case"day":case"d":return 864e5*e;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*e;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*e;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e}}}function Xj(i,e,o,c){return Math.round(i/o)+" "+c+(e>=1.5*o?"s":"")}function tC(i){var e=i.areas,o=i.excludedArea;if(e.length===1&&e[0]===oa.GLOBAL&&o===oa.CHINA)return eh([oa.OVERSEA]);if(e.includes(oa.GLOBAL)){if(i=vi(Yj).filter(function($){return $!==oa.GLOBAL&&$!==oa.OVERSEA}),o in wi){e=wi[o];var c=[].concat(ra(e??[]),[o]);return eh(i.filter(function($){return!c.includes($)}))}if(Bs(o)){var _=uC(o);return eh(i.filter(function($){return $!==o&&$!==_}))}}if(Bs(o)||o in wi)return eh(e);throw new ja("Invalid excludedArea area config")}function gb(i,e,o){o===void 0&&(o=Object.getOwnPropertyDescriptor(i,e));var c=o.value;return o.value=function(){for(var _=this,$=arguments.length,_t=Array($),ga=0;ga<$;ga++)_t[ga]=arguments[ga];this.invokeTracker.apply(this,["%s: ".concat(0<_t.length?"%s with args: ".concat(_t.map(function(){return"%o"})):"%s"),this.name,e].concat(ra(_t.map(fh))));try{var _s=c.apply(this,_t)}catch(_l){throw this.logError.apply(this,["".concat(_l.code!==void 0?"Error Code ".concat(_l.code,": "):"","%s failed").concat(0<_t.length?" with args: ".concat(_t.map(function(){return"%o"})):""),e].concat(ra(_t.map(fh)))),_l.originalError&&this.logError(_l.originalError),this.errorTracker(_l),_l}var _c=Date.now();return za(W.mark(function _l(){var Tl,Cl;return W.wrap(function(Pl){for(;;)switch(Pl.prev=Pl.next){case 0:return Pl.prev=0,Pl.next=3,_s;case 3:Tl=Pl.sent,Pl.next=12;break;case 6:return Pl.prev=6,Pl.t0=Pl.catch(0),_.logError.apply(_,["".concat(Pl.t0.code!==void 0?"Error Code ".concat(Pl.t0.code,": "):"","%s failed").concat(0<_t.length?" with args: ".concat(_t.map(function(){return"%o"})):""),e].concat(ra(_t.map(fh)))),Pl.t0.originalError&&_.logError(Pl.t0.originalError),_.errorTracker(Pl.t0),Pl.abrupt("return");case 12:Tl!==_s?Tl===void 0?_.resultTracker("%s promise resolves after %dms",e,Date.now()-_c):_.resultTracker("%s promise resolves after %dms, result is %o",e,Date.now()-_c,fh(Tl)):Be(Tl)!=="Object"||Lg(Tl)?_.resultTracker("%s result is %o",e,fh(Tl)):_.resultTracker("%s result is %s",e,Tl.name||((Cl=Tl.constructor)===null||Cl===void 0?void 0:Cl.name));case 13:case"end":return Pl.stop()}},_l,null,[[0,6]])}))(),_s},o}function je(i,e,o){o===void 0&&(o=Object.getOwnPropertyDescriptor(i,e));var c=o.value;return o.value=function(){for(var _=this,$=arguments.length,_t=Array($),ga=0;ga<$;ga++)_t[ga]=arguments[ga];this.invokeTracker.apply(this,["%s: ".concat(0<_t.length?"%s with args: ".concat(_t.map(function(){return"%o"})):"%s"),this.name,e].concat(_t));try{var _s=c.apply(this,_t)}catch(_l){throw this.logError.apply(this,["".concat(_l.code!==void 0?"Error Code ".concat(_l.code,": "):"","%s failed").concat(0<_t.length?" with args: ".concat(_t.map(function(){return"%o"})):""),e].concat(_t)),_l.originalError&&this.logError(_l.originalError),this.errorTracker(_l),_l}var _c=Date.now();return za(W.mark(function _l(){var Tl,Cl;return W.wrap(function(Pl){for(;;)switch(Pl.prev=Pl.next){case 0:return Pl.prev=0,Pl.next=3,_s;case 3:Tl=Pl.sent,Pl.next=12;break;case 6:return Pl.prev=6,Pl.t0=Pl.catch(0),_.logError.apply(_,["".concat(Pl.t0.code!==void 0?"Error Code ".concat(Pl.t0.code,": "):"","%s failed").concat(0<_t.length?" with args: ".concat(_t.map(function(){return"%o"})):""),e].concat(_t)),Pl.t0.originalError&&_.logError(Pl.t0.originalError),_.errorTracker(Pl.t0),Pl.abrupt("return");case 12:Tl!==_s?Tl===void 0?_.resultTracker("%s promise resolves after %dms",e,Date.now()-_c):_.resultTracker("%s promise resolves after %dms, result is %o",e,Date.now()-_c,Tl):Be(Tl)!=="Object"||Lg(Tl)?_.resultTracker("%s result is %o",e,Tl):_.resultTracker("%s result is %s",e,Tl.name||((Cl=Tl.constructor)===null||Cl===void 0?void 0:Cl.name));case 13:case"end":return Pl.stop()}},_l,null,[[0,6]])}))(),_s},o}function vC(i,e){var o="".concat(i,"Uri");if(typeof(o=Tm[o])!="number"||o===0)throw new TypeError("Got Unknown URI Name");return e=new(i=Cs[i])(e),e=i.encode(e).finish(),new wC({uri:o,data:e})}function Ds(i,e){var o=ui(null);return"".concat(i.split(".").join("-"),".edge.").concat(o?null:e?"sd-rtn.com":"agora.io")}function $a(i,e,o){return Um.apply(this,arguments)}function Um(){return(Um=za(W.mark(function i(e,o,c){var _,$,_t,ga=arguments;return W.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:return _=3<ga.length&&ga[3]!==void 0&&ga[3],$=xC[e].encode(o).finish(),_t=function(){var _c=za(W.mark(function _l(Tl){var Cl,Pl,Dl,Jl=arguments;return W.wrap(function(zl){for(;;)switch(zl.prev=zl.next){case 0:if(!(3<(Pl=1<Jl.length&&Jl[1]!==void 0?Jl[1]:0))){zl.next=3;break}return zl.abrupt("return");case 3:if(Dl=dh(Dl=c?"https://".concat((Cl=Ba==null?void 0:Ba.PROXY_NGINX[0])!==null&&Cl!==void 0?Cl:"webrtc-cloud-proxy.sd-rtn.com","/rs/?h=").concat(Tl,"&p=443&d=events/proto-raw"):"https://".concat(Tl,"/events/proto-raw"),"sentTs",Math.ceil(Date.now()/1e3).toString()),Dl=dh(Dl,"id",yC[e].toString()),!_){zl.next=9;break}return zl.next=9,pC(1e4);case 9:return zl.next=11,Tj(Dl,{body:$,timeout:2e4,headers:{"Content-Type":"application/octet-stream"}}).catch(function(Bl){return _t(Tl,Pl+1)});case 11:case"end":return zl.stop()}},_l)}));return function(_l){return _c.apply(this,arguments)}}(),_s.prev=3,_s.next=6,_t((Ba==null?void 0:Ba.EVENT_REPORT_DOMAIN[0])||ui(null)&&null||"webcollector-rtm.agora.io");case 6:_s.next=12;break;case 8:return _s.prev=8,_s.t0=_s.catch(3),_s.next=12,_t(Ba&&Es(1<(Ba==null?void 0:Ba.EVENT_REPORT_DOMAIN.length)?Ba==null?void 0:Ba.EVENT_REPORT_DOMAIN.slice(1):Ba==null?void 0:Ba.EVENT_REPORT_DOMAIN)||"rtm.statscollector.sd-rtn.com");case 12:case"end":return _s.stop()}},i,null,[[3,8]])}))).apply(this,arguments)}function Nb(i){return i===void 0?D.fromNumber(0):D.fromNumber(Date.now()-i)}function Zj(i,e){return D.fromValue(i).eq(e)}function ak(i,e){var o=e===void 0?i.val:e,c=i.isBoolean;e=i.isNumber;var _=i.oneof,$=i.len;if([c,e,_].filter(function(_t){return!_t}).length!==2)throw new TypeError("invalid field type");if(o!==void 0&&(i=!1,_!==void 0&&(_=Vm(_),zC(_,Zj).length===_.length&&AC(_,function(_t){return Zj(o,_t)})!==void 0&&(i=!0)),c=c!==void 0&&(o===0||o===1)&&$===1,e=e!==void 0&&o.toString(2).length<=$,!(i||c||e)))throw Error("invalid field value")}function pf(i,e){e=E({},Ge.STATE_REVISION,e!==void 0&&0<=e?e:void 0);for(var o=0;o<i.length;o++){var c=i[o];e[c.getKey()]=c.getValue(),e["".concat(Ge.STATE_REVISION_KEY_PREFIX).concat(c.getKey())]=0<=c.getRevision()||c.getRevision()===-2?c.getRevision():void 0}return Pd.omitBy(e,Pd.isUndefined)}function Wm(i){var e=JSON.parse(i);i={majorRevision:e[Ge.STATE_REVISION],items:[]};var o=Pd.omit(e,Ge.STATE_REVISION);return e=Object.keys(o).filter(function(c){return c[0]!=="_"}),i.items=e.map(function(c){return new Fs({key:c,value:o[c],revision:o["".concat(Ge.STATE_REVISION_KEY_PREFIX).concat(c)],updateTs:o["".concat(Ge.STATE_TIMESTAMP_PREFIX).concat(c)],authorUserId:o["".concat(Ge.STATE_AUTHOR_PREFIX).concat(c)]})}),i}function ud(i){var e=bd;return i!==bg.StateOk&&i!==bg.DuplicatedOperation&&(e=i===bg.OutdateRevision?of:i===bg.TimeOutError?cd:i===bg.ArgumentError?Mb:He),e}function Gs(i){return i.reduce(function(e,o){return e.concat(o instanceof bk.UnsubscriptionError?o.errors:o)},[])}function BC(i,e){do xi==2147483647?xi=0:xi++;while(gh.hasOwnProperty(xi));var o=xi;return gh[o]={callback:i,parameters:Array.prototype.slice.call(arguments,2)},Xm.postMessage({name:"setInterval",fakeId:o,time:e}),o}function Hs(i){return function(){var e=i();if(!e)throw new ia("Client is not logged in. Cannot do the operation");return e}}var qb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{},ck=function(i){return i&&i.Math==Math&&i},na=ck(typeof globalThis=="object"&&globalThis)||ck(typeof window=="object"&&window)||ck(typeof self=="object"&&self)||ck(typeof qb=="object"&&qb)||function(){return this}()||Function("return this")(),Ga=function(i){try{return!!i()}catch{return!0}},cb=!Ga(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Is={}.propertyIsEnumerable,Js=Object.getOwnPropertyDescriptor,yi=Js&&!Is.call({1:2},1)?function(i){return!!(i=Js(this,i))&&i.enumerable}:Is,ke=function(i,e){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:e}},CC={}.toString,Qd=function(i){return CC.call(i).slice(8,-1)},DC="".split,zi=Ga(function(){return!Object("z").propertyIsEnumerable(0)})?function(i){return Qd(i)=="String"?DC.call(i,""):Object(i)}:Object,Ec=function(i){if(i==null)throw TypeError("Can't call method on "+i);return i},Qc=function(i){return zi(Ec(i))},fb=function(i){return typeof i=="object"?i!==null:typeof i=="function"},le=function(i,e){if(!fb(i))return i;var o,c;if(e&&typeof(o=i.toString)=="function"&&!fb(c=o.call(i))||typeof(o=i.valueOf)=="function"&&!fb(c=o.call(i))||!e&&typeof(o=i.toString)=="function"&&!fb(c=o.call(i)))return c;throw TypeError("Can't convert object to primitive value")},Zb=function(i){return Object(Ec(i))},EC={}.hasOwnProperty,Fa=function(i,e){return EC.call(Zb(i),e)},hh=na.document,dk=fb(hh)&&fb(hh.createElement),Ks=!cb&&!Ga(function(){return Object.defineProperty(dk?hh.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),Ls=Object.getOwnPropertyDescriptor,pd={f:cb?Ls:function(i,e){if(i=Qc(i),e=le(e,!0),Ks)try{return Ls(i,e)}catch{}if(Fa(i,e))return ke(!yi.call(i,e),i[e])}},ub=function(i){if(!fb(i))throw TypeError(String(i)+" is not an object");return i},Ms=Object.defineProperty,$b={f:cb?Ms:function(i,e,o){if(ub(i),e=le(e,!0),ub(o),Ks)try{return Ms(i,e,o)}catch{}if("get"in o||"set"in o)throw TypeError("Accessors not supported");return"value"in o&&(i[e]=o.value),i}},ac=cb?function(i,e,o){return $b.f(i,e,ke(1,o))}:function(i,e,o){return i[e]=o,i},Ym=function(i,e){try{ac(na,i,e)}catch{na[i]=e}return e},qf=na["__core-js_shared__"]||Ym("__core-js_shared__",{}),FC=Function.toString;typeof qf.inspectSource!="function"&&(qf.inspectSource=function(i){return FC.call(i)});var Zm=qf.inspectSource,Ns=na.WeakMap,GC=typeof Ns=="function"&&/native code/.test(Zm(Ns)),rf=kc(function(i){(i.exports=function(e,o){return qf[e]||(qf[e]=o!==void 0?o:{})})("versions",[]).push({version:"3.12.1",mode:"global",copyright:" 2021 Denis Pushkarev (zloirock.ru)"})}),HC=0,IC=Math.random(),ih=function(i){return"Symbol("+String(i===void 0?"":i)+")_"+(++HC+IC).toString(36)},Os=rf("keys"),ek=function(i){return Os[i]||(Os[i]=ih(i))},jh={},JC=na.WeakMap;if(GC||qf.state)var cg=qf.state||(qf.state=new JC),KC=cg.get,Ps=cg.has,LC=cg.set,$m=function(i,e){if(Ps.call(cg,i))throw new TypeError("Object already initialized");return e.facade=i,LC.call(cg,i,e),e},fk=function(i){return KC.call(cg,i)||{}},an=function(i){return Ps.call(cg,i)};else{var kh=ek("state");jh[kh]=!0,$m=function(i,e){if(Fa(i,kh))throw new TypeError("Object already initialized");return e.facade=i,ac(i,kh,e),e},fk=function(i){return Fa(i,kh)?i[kh]:{}},an=function(i){return Fa(i,kh)}}var Sb={set:$m,get:fk,has:an,enforce:function(i){return an(i)?fk(i):$m(i,{})},getterFor:function(i){return function(e){var o;if(!fb(e)||(o=fk(e)).type!==i)throw TypeError("Incompatible receiver, "+i+" required");return o}}},Ob=kc(function(i){var e=Sb.get,o=Sb.enforce,c=String(String).split("String");(i.exports=function(_,$,_t,ga){var _s=!!ga&&!!ga.unsafe,_c=!!ga&&!!ga.enumerable;if(ga=!!ga&&!!ga.noTargetGet,typeof _t=="function"){typeof $!="string"||Fa(_t,"name")||ac(_t,"name",$);var _l=o(_t);_l.source||(_l.source=c.join(typeof $=="string"?$:""))}_===na?_c?_[$]=_t:Ym($,_t):(_s?!ga&&_[$]&&(_c=!0):delete _[$],_c?_[$]=_t:ac(_,$,_t))})(Function.prototype,"toString",function(){return typeof this=="function"&&e(this).source||Zm(this)})}),Qs=function(i){return typeof i=="function"?i:void 0},me=function(i,e){return 2>arguments.length?Qs(na[i])||Qs(na[i]):na[i]&&na[i][e]||na[i]&&na[i][e]},MC=Math.ceil,NC=Math.floor,Rd=function(i){return isNaN(i=+i)?0:(0<i?NC:MC)(i)},OC=Math.min,xb=function(i){return 0<i?OC(Rd(i),9007199254740991):0},PC=Math.max,QC=Math.min,dd=function(i,e){return 0>(i=Rd(i))?PC(i+e,0):QC(i,e)},Rs=function(i){return function(e,o,c){e=Qc(e);var _=xb(e.length);if(c=dd(c,_),i&&o!=o){for(;_>c;)if((o=e[c++])!=o)return!0}else for(;_>c;c++)if((i||c in e)&&e[c]===o)return i||c||0;return!i&&-1}},Ss=Rs(!0),bn=Rs(!1),Ts=function(i,e){i=Qc(i);var o,c=0,_=[];for(o in i)!Fa(jh,o)&&Fa(i,o)&&_.push(o);for(;e.length>c;)Fa(i,o=e[c++])&&(~bn(_,o)||_.push(o));return _},gk="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),RC=gk.concat("length","prototype"),dg={f:Object.getOwnPropertyNames||function(i){return Ts(i,RC)}},Ai={f:Object.getOwnPropertySymbols},Us=me("Reflect","ownKeys")||function(i){var e=dg.f(ub(i)),o=Ai.f;return o?e.concat(o(i)):e},Vs=function(i,e){for(var o=Us(e),c=$b.f,_=pd.f,$=0;$<o.length;$++){var _t=o[$];Fa(i,_t)||c(i,_t,_(e,_t))}},SC=/#|\.prototype\./,ne=function(i,e){return(i=TC[UC(i)])==VC||i!=WC&&(typeof e=="function"?Ga(e):!!e)},UC=ne.normalize=function(i){return String(i).replace(SC,".").toLowerCase()},TC=ne.data={},WC=ne.NATIVE="N",VC=ne.POLYFILL="P",XC=pd.f,wa=function(i,e){var o,c,_,$=i.target,_t=i.global,ga=i.stat;if(c=_t?na:ga?na[$]||Ym($,{}):(na[$]||{}).prototype)for(_ in e){var _s=e[_],_c=i.noTargetGet?(o=XC(c,_))&&o.value:c[_];if(!(o=ne(_t?_:$+(ga?".":"#")+_,i.forced))&&_c!==void 0){if(typeof _s==typeof _c)continue;Vs(_s,_c)}(i.sham||_c&&_c.sham)&&ac(_s,"sham",!0);try{Ob(c,_,_s,i)}catch{}}},hk=function(){var i=ub(this),e="";return i.global&&(e+="g"),i.ignoreCase&&(e+="i"),i.multiline&&(e+="m"),i.dotAll&&(e+="s"),i.unicode&&(e+="u"),i.sticky&&(e+="y"),e},Sd=Ga(function(){var i=/a/y;return i.lastIndex=2,i.exec("abcd")!=null}),YC=Ga(function(){var i=/^r/gy;return i.lastIndex=2,i.exec("str")!=null}),ik=RegExp.prototype.exec,ZC=rf("native-string-replace",String.prototype.replace),Ws=ik,cn=(d=/a/,b=/b*/g,ik.call(d,"a"),ik.call(b,"a"),d.lastIndex!==0||b.lastIndex!==0),Xs=Sd||YC,dn=/()??/.exec("")[1]!==void 0,d,b;(cn||dn||Xs)&&(Ws=function(i){var e,o=Xs&&this.sticky,c=hk.call(this),_=this.source,$=0,_t=i;if(o){(c=c.replace("y","")).indexOf("g")===-1&&(c+="g"),_t=String(i).slice(this.lastIndex),0<this.lastIndex&&(!this.multiline||this.multiline&&i[this.lastIndex-1]!==`
`)&&(_="(?: "+_+")",_t=" "+_t,$++);var ga=new RegExp("^(?:"+_+")",c)}if(dn&&(ga=new RegExp("^"+_+"$(?!\\s)",c)),cn)var _s=this.lastIndex;var _c=ik.call(o?ga:this,_t);return o?_c?(_c.input=_c.input.slice($),_c[0]=_c[0].slice($),_c.index=this.lastIndex,this.lastIndex+=_c[0].length):this.lastIndex=0:cn&&_c&&(this.lastIndex=this.global?_c.index+_c[0].length:_s),dn&&_c&&1<_c.length&&ZC.call(_c[0],ga,function(){for(e=1;e<arguments.length-2;e++)arguments[e]===void 0&&(_c[e]=void 0)}),_c});var Bi=Ws;wa({target:"RegExp",proto:!0,forced:/./.exec!==Bi},{exec:Bi});var lh=me("navigator","userAgent")||"",Ys=na.process,Zs=Ys&&Ys.versions,$s=Zs&&Zs.v8;if($s)var sf=$s.split("."),en=4>sf[0]?1:sf[0]+sf[1];else lh&&(sf=lh.match(/Edge\/(\d+)/),(!sf||74<=sf[1])&&(sf=lh.match(/Chrome\/(\d+)/))&&(en=sf[1]));var oe=en&&+en,pe=!!Object.getOwnPropertySymbols&&!Ga(function(){return!String(Symbol())||!Symbol.sham&&oe&&41>oe}),at=pe&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ci=rf("wks"),Di=na.Symbol,$C=at?Di:Di&&Di.withoutSetter||ih,mb=function(i){return Fa(Ci,i)&&(pe||typeof Ci[i]=="string")||(pe&&Fa(Di,i)?Ci[i]=Di[i]:Ci[i]=$C("Symbol."+i)),Ci[i]},aD=mb("species"),fn=RegExp.prototype,bD=!Ga(function(){var i=/./;return i.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(i,"$<a>")!=="7"}),bt="a".replace(/./,"$0")==="$0",ct=mb("replace"),dt=!!/./[ct]&&/./[ct]("a","$0")==="",cD=!Ga(function(){var i=/(?:)/,e=i.exec;return i.exec=function(){return e.apply(this,arguments)},(i="ab".split(i)).length!==2||i[0]!=="a"||i[1]!=="b"}),jk=function(i,e,o,c){var _=mb(i),$=!Ga(function(){var _c={};return _c[_]=function(){return 7},""[i](_c)!=7}),_t=$&&!Ga(function(){var _c=!1,_l=/a/;return i==="split"&&((_l={constructor:{}}).constructor[aD]=function(){return _l},_l.flags="",_l[_]=/./[_]),_l.exec=function(){return _c=!0,null},_l[_](""),!_c});if(!$||!_t||i==="replace"&&(!bD||!bt||dt)||i==="split"&&!cD){var ga=/./[_],_s=(o=o(_,""[i],function(_c,_l,Tl,Cl,Pl){var Dl=_l.exec;return Dl===Bi||Dl===fn.exec?$&&!Pl?{done:!0,value:ga.call(_l,Tl,Cl)}:{done:!0,value:_c.call(Tl,_l,Cl)}:{done:!1}},{REPLACE_KEEPS_$0:bt,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:dt}))[1];Ob(String.prototype,i,o[0]),Ob(fn,_,e==2?function(_c,_l){return _s.call(_c,this,_l)}:function(_c){return _s.call(_c,this)})}c&&ac(fn[_],"sham",!0)},dD=mb("match"),gn=function(i){var e;return fb(i)&&((e=i[dD])!==void 0?!!e:Qd(i)=="RegExp")},Rc=function(i){if(typeof i!="function")throw TypeError(String(i)+" is not a function");return i},eD=mb("species"),eg=function(i,e){var o;return(i=ub(i).constructor)===void 0||(o=ub(i)[eD])==null?e:Rc(o)},et=function(i){return function(e,o){e=String(Ec(e)),o=Rd(o);var c,_=e.length;if(0>o||o>=_)return i?"":void 0;var $=e.charCodeAt(o);return 55296>$||56319<$||o+1===_||56320>(c=e.charCodeAt(o+1))||57343<c?i?e.charAt(o):$:i?e.slice(o,o+2):c-56320+($-55296<<10)+65536}},fD=et(!1),ft=et(!0),hn=function(i,e,o){return e+(o?ft(i,e).length:1)},mh=function(i,e){var o=i.exec;if(typeof o=="function"){if(typeof(i=o.call(i,e))!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return i}if(Qd(i)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return Bi.call(i,e)},gD=[].push,hD=Math.min;jk("split",2,function(i,e,o){var c="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||1<".".split(/()()/).length||"".split(/.?/).length?function(_,$){var _t=String(Ec(this));if(($=$===void 0?4294967295:$>>>0)===0)return[];if(_===void 0)return[_t];if(!gn(_))return e.call(_t,_,$);var ga,_s,_c,_l=[],Tl=0;for(_=new RegExp(_.source,(_.ignoreCase?"i":"")+(_.multiline?"m":"")+(_.unicode?"u":"")+(_.sticky?"y":"")+"g");(ga=Bi.call(_,_t))&&!((_s=_.lastIndex)>Tl&&(_l.push(_t.slice(Tl,ga.index)),1<ga.length&&ga.index<_t.length&&gD.apply(_l,ga.slice(1)),_c=ga[0].length,Tl=_s,_l.length>=$));)_.lastIndex===ga.index&&_.lastIndex++;return Tl===_t.length?(_c||!_.test(""))&&_l.push(""):_l.push(_t.slice(Tl)),_l.length>$?_l.slice(0,$):_l}:"0".split(void 0,0).length?function(_,$){return _===void 0&&$===0?[]:e.call(this,_,$)}:e;return[function(_,$){var _t=Ec(this),ga=_==null?void 0:_[i];return ga!==void 0?ga.call(_,_t,$):c.call(String(_t),_,$)},function(_,$){var _t=o(c,_,this,$,c!==e);if(_t.done)return _t.value;var ga=ub(_);_=String(this);var _s=eg(ga,RegExp);if(_t=ga.unicode,ga=new _s(Sd?"^(?:"+ga.source+")":ga,(ga.ignoreCase?"i":"")+(ga.multiline?"m":"")+(ga.unicode?"u":"")+(Sd?"g":"y")),($=$===void 0?4294967295:$>>>0)===0)return[];if(_.length===0)return mh(ga,_)===null?[_]:[];var _c=0,_l=0;for(_s=[];_l<_.length;){ga.lastIndex=Sd?0:_l;var Tl,Cl=mh(ga,Sd?_.slice(_l):_);if(Cl===null||(Tl=hD(xb(ga.lastIndex+(Sd?_l:0)),_.length))===_c)_l=hn(_,_l,_t);else{if(_s.push(_.slice(_c,_l)),_s.length===$)return _s;for(_c=1;_c<=Cl.length-1;_c++)if(_s.push(Cl[_c]),_s.length===$)return _s;_l=_c=Tl}}return _s.push(_.slice(_c)),_s}]},Sd);var iD=/^[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*/,jD=/[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$/,jn=function(i){return function(e){return e=String(Ec(e)),1&i&&(e=e.replace(iD,"")),2&i&&(e=e.replace(jD,"")),e}},kD=jn(1),lD=jn(2),kk=jn(3),lk=na.parseInt,mD=/^[+-]?0[Xx]/,gt=lk(`	
\v\f\r \u2028\u2029\uFEFF08`)!==8||lk(`	
\v\f\r \u2028\u2029\uFEFF0x16`)!==22?function(i,e){return i=kk(String(i)),lk(i,e>>>0||(mD.test(i)?16:10))}:lk;wa({global:!0,forced:parseInt!=gt},{parseInt:gt});var tf=function(i,e,o){if(Rc(i),e===void 0)return i;switch(o){case 0:return function(){return i.call(e)};case 1:return function(c){return i.call(e,c)};case 2:return function(c,_){return i.call(e,c,_)};case 3:return function(c,_,$){return i.call(e,c,_,$)}}return function(){return i.apply(e,arguments)}},uf=Array.isArray||function(i){return Qd(i)=="Array"},nD=mb("species"),Ei=function(i,e){if(uf(i)){var o=i.constructor;typeof o!="function"||o!==Array&&!uf(o.prototype)?fb(o)&&(o=o[nD])===null&&(o=void 0):o=void 0}return new(o===void 0?Array:o)(e===0?0:e)},ht=[].push,vf=function(i){var e=i==1,o=i==2,c=i==3,_=i==4,$=i==6,_t=i==7,ga=i==5||$;return function(_s,_c,_l,Tl){var Cl=Zb(_s),Pl=zi(Cl);_c=tf(_c,_l,3),_l=xb(Pl.length);var Dl,Jl=0;for(Tl=Tl||Ei,_s=e?Tl(_s,_l):o||_t?Tl(_s,0):void 0;_l>Jl;Jl++)if((ga||Jl in Pl)&&(Dl=_c(Tl=Pl[Jl],Jl,Cl),i))if(e)_s[Jl]=Dl;else if(Dl)switch(i){case 3:return!0;case 5:return Tl;case 6:return Jl;case 2:ht.call(_s,Tl)}else switch(i){case 4:return!1;case 7:ht.call(_s,Tl)}return $?-1:c||_?_:_s}},fg=vf(0),it=vf(1),jt=vf(2),oD=vf(3),pD=vf(4),kt=vf(5),lt=vf(6),qD=mb("species"),Fi=function(i){return 51<=oe||!Ga(function(){var e=[];return(e.constructor={})[qD]=function(){return{foo:1}},e[i](Boolean).foo!==1})},rD=Fi("filter");wa({target:"Array",proto:!0,forced:!rD},{filter:function(i){return jt(this,i,1<arguments.length?arguments[1]:void 0)}});var Ie=Object.keys||function(i){return Ts(i,gk)},sD=Ga(function(){Ie(1)});wa({target:"Object",stat:!0,forced:sD},{keys:function(i){return Ie(Zb(i))}});var gg=function(i,e){var o=[][i];return!!o&&Ga(function(){o.call(null,e||function(){throw 1},1)})},tD=[].join,uD=zi!=Object,vD=gg("join",",");wa({target:"Array",proto:!0,forced:uD||!vD},{join:function(i){return tD.call(Qc(this),i===void 0?",":i)}});var wD=Fi("map");wa({target:"Array",proto:!0,forced:!wD},{map:function(i){return it(this,i,1<arguments.length?arguments[1]:void 0)}});var kn=function(i){var e=i.return;if(e!==void 0)return ub(e.call(i)).value},nh={},xD=mb("iterator"),yD=Array.prototype,ln=function(i){return i!==void 0&&(nh.Array===i||yD[xD]===i)},oh=function(i,e,o){(e=le(e))in i?$b.f(i,e,ke(0,o)):i[e]=o},zD=mb("toStringTag"),mt={};mt[zD]="z";var mn=String(mt)==="[object z]",AD=mb("toStringTag"),BD=Qd(function(){return arguments}())=="Arguments",ph=mn?Qd:function(i){var e;if(i===void 0)var o="Undefined";else{if(i===null)var c="Null";else{t:{var _=i=Object(i);try{c=_[AD];break t}catch{}c=void 0}c=typeof(o=c)=="string"?o:BD?Qd(i):(e=Qd(i))=="Object"&&typeof i.callee=="function"?"Arguments":e}o=c}return o},CD=mb("iterator"),Gi=function(i){if(i!=null)return i[CD]||i["@@iterator"]||nh[ph(i)]},hg=function(i){var e,o=Zb(i),c=typeof this=="function"?this:Array,_=arguments.length,$=1<_?arguments[1]:void 0,_t=$!==void 0,ga=Gi(o),_s=0;if(_t&&($=tf($,2<_?arguments[2]:void 0,2)),ga==null||c==Array&&ln(ga)){var _c=xb(o.length);for(c=new c(_c);_c>_s;_s++)ga=_t?$(o[_s],_s):o[_s],oh(c,_s,ga)}else for(_=(o=ga.call(o)).next,c=new c;!(e=_.call(o)).done;_s++){if(_t){ga=o;var _l=$;e=[e.value,_s];try{_c=_l(ub(e)[0],e[1])}catch(Tl){throw kn(ga),Tl}}else _c=e.value;oh(c,_s,ga=_c)}return c.length=_s,c},nt=mb("iterator"),ot=!1;try{var DD=0,pt={next:function(){return{done:!!DD++}},return:function(){ot=!0}};pt[nt]=function(){return this},Array.from(pt,function(){throw 2})}catch(i){}var mk=function(i,e){if(!e&&!ot)return!1;var o=!1;try{(e={})[nt]=function(){return{next:function(){return{done:o=!0}}}},i(e)}catch{}return o},ED=!mk(function(i){Array.from(i)});wa({target:"Array",stat:!0,forced:ED},{from:hg});var qt=!Ga(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype}),rt=ek("IE_PROTO"),FD=Object.prototype,Md=qt?Object.getPrototypeOf:function(i){return i=Zb(i),Fa(i,rt)?i[rt]:typeof i.constructor=="function"&&i instanceof i.constructor?i.constructor.prototype:i instanceof Object?FD:null},nn=mb("iterator"),st=!1,GD=function(){return this},ig;if([].keys){var tt=[].keys();if("next"in tt){var ut=Md(Md(tt));ut!==Object.prototype&&(ig=ut)}else st=!0}(ig==null||Ga(function(){var i={};return ig[nn].call(i)!==i}))&&(ig={}),Fa(ig,nn)||ac(ig,nn,GD);var nk=ig,ok=st,vt=cb?Object.defineProperties:function(i,e){ub(i);for(var o,c=Ie(e),_=c.length,$=0;_>$;)$b.f(i,o=c[$++],e[o]);return i},on=me("document","documentElement"),wt=ek("IE_PROTO"),pn=function(){},qn,pk=function(){try{qn=document.domain&&new ActiveXObject("htmlfile")}catch{}if(qn){var i=qn;i.write("<script><\/script>"),i.close(),i=i.parentWindow.Object}else(i=dk?hh.createElement("iframe"):{}).style.display="none",on.appendChild(i),i.src="javascript:",(i=i.contentWindow.document).open(),i.write("<script>document.F=Object<\/script>"),i.close(),i=i.F;for(pk=i,i=gk.length;i--;)delete pk.prototype[gk[i]];return pk()};jh[wt]=!0;var vd=Object.create||function(i,e){if(i!==null){pn.prototype=ub(i);var o=new pn;pn.prototype=null,o[wt]=i}else o=pk();return e===void 0?o:vt(o,e)},HD=$b.f,xt=mb("toStringTag"),Td=function(i,e,o){i&&!Fa(i=o?i:i.prototype,xt)&&HD(i,xt,{configurable:!0,value:e})},ID=function(){return this},yt=function(i,e,o){return e+=" Iterator",i.prototype=vd(nk,{next:ke(1,o)}),Td(i,e,!1),nh[e]=ID,i},gc=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,e={};try{var o=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;o.call(e,[]),i=e instanceof Array}catch{}return function(c,_){if(ub(c),!fb(_)&&_!==null)throw TypeError("Can't set "+String(_)+" as a prototype");return i?o.call(c,_):c.__proto__=_,c}}():void 0),Hi=mb("iterator"),JD=function(){return this},rn=function(i,e,o,c,_,$,_t){yt(o,e,c),c=function(Jl){if(Jl===_&&Cl)return Cl;if(!ok&&Jl in _l)return _l[Jl];switch(Jl){case"keys":case"values":case"entries":return function(){return new o(this,Jl)}}return function(){return new o(this)}};var ga,_s=e+" Iterator",_c=!1,_l=i.prototype,Tl=_l[Hi]||_l["@@iterator"]||_&&_l[_],Cl=!ok&&Tl||c(_),Pl=e=="Array"&&_l.entries||Tl;if(Pl&&(i=Md(Pl.call(new i)),nk!==Object.prototype&&i.next&&(Md(i)!==nk&&(gc?gc(i,nk):typeof i[Hi]!="function"&&ac(i,Hi,JD)),Td(i,_s,!0))),_=="values"&&Tl&&Tl.name!=="values"&&(_c=!0,Cl=function(){return Tl.call(this)}),_l[Hi]!==Cl&&ac(_l,Hi,Cl),nh[e]=Cl,_){var Dl={values:c("values"),keys:$?Cl:c("keys"),entries:c("entries")};if(_t)for(ga in Dl)!ok&&!_c&&ga in _l||Ob(_l,ga,Dl[ga]);else wa({target:e,proto:!0,forced:ok||_c},Dl)}return Dl},KD=Sb.set,LD=Sb.getterFor("String Iterator");rn(String,"String",function(i){KD(this,{type:"String Iterator",string:String(i),index:0})},function(){var i=LD(this),e=i.string,o=i.index;return o>=e.length?{value:void 0,done:!0}:(e=ft(e,o),i.index+=e.length,{value:e,done:!1})});var sn=mb("unscopables"),tn=Array.prototype;tn[sn]==null&&$b.f(tn,sn,{configurable:!0,value:vd(null)});var wf=function(i){tn[sn][i]=!0},zt=!0;"find"in[]&&Array(1).find(function(){zt=!1}),wa({target:"Array",proto:!0,forced:zt},{find:function(i){return kt(this,i,1<arguments.length?arguments[1]:void 0)}}),wf("find");var At=function(i){var e=String(Ec(this)),o="";if(0>(i=Rd(i))||1/0==i)throw RangeError("Wrong number of repetitions");for(;0<i;(i>>>=1)&&(e+=e))1&i&&(o+=e);return o};wa({target:"String",proto:!0},{repeat:At});var Bt=[].indexOf,Ct=!!Bt&&0>1/[1].indexOf(1,-0),MD=gg("indexOf");wa({target:"Array",proto:!0,forced:Ct||!MD},{indexOf:function(i){return Ct?Bt.apply(this,arguments)||0:bn(this,i,1<arguments.length?arguments[1]:void 0)}});var JA=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,KA=/CrOS/,LA=/android|ipad|playbook|silk/i;Kg.isMobile=Kg,Kg.default=Kg,wa({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991}),wa({target:"Number",stat:!0},{isNaN:function(i){return i!=i}}),na.Number.isNaN;var ND=mn?{}.toString:function(){return"[object "+ph(this)+"]"};mn||Ob(Object.prototype,"toString",ND,{unsafe:!0});var qk=na.Promise,qh=function(i,e,o){for(var c in e)Ob(i,c,e[c],o);return i},Dt=mb("species"),Ii=function(i){i=me(i);var e=$b.f;cb&&i&&!i[Dt]&&e(i,Dt,{configurable:!0,get:function(){return this}})},Ud=function(i,e,o){if(!(i instanceof e))throw TypeError("Incorrect "+(o?o+" ":"")+"invocation");return i},Ji=function(i,e){this.stopped=i,this.result=e},rk=function(i,e,o){var c,_=!(!o||!o.AS_ENTRIES),$=!(!o||!o.IS_ITERATOR),_t=!(!o||!o.INTERRUPTED),ga=tf(e,o&&o.that,1+_+_t),_s=function(_l){return _c&&kn(_c),new Ji(!0,_l)};if(e=function(_l){return _?(ub(_l),_t?ga(_l[0],_l[1],_s):ga(_l[0],_l[1])):_t?ga(_l,_s):ga(_l)},$)var _c=i;else{if(typeof($=Gi(i))!="function")throw TypeError("Target is not iterable");if(ln($)){for($=0,o=xb(i.length);o>$;$++)if((c=e(i[$]))&&c instanceof Ji)return c;return new Ji(!1)}_c=$.call(i)}for(i=_c.next;!($=i.call(_c)).done;){try{c=e($.value)}catch(_l){throw kn(_c),_l}if(typeof c=="object"&&c&&c instanceof Ji)return c}return new Ji(!1)},Et=/(?:iphone|ipod|ipad).*applewebkit/i.test(lh),qe=Qd(na.process)=="process",sk=na.location,un=na.setImmediate,Ft=na.clearImmediate,OD=na.process,Gt=na.MessageChannel,vn=na.Dispatch,wn=0,Ki={},xn=function(i){if(Ki.hasOwnProperty(i)){var e=Ki[i];delete Ki[i],e()}},yn=function(i){return function(){xn(i)}},Ht=function(i){xn(i.data)},It=function(i){na.postMessage(i+"",sk.protocol+"//"+sk.host)};if(!un||!Ft)if(un=function(i){for(var e=[],o=1;arguments.length>o;)e.push(arguments[o++]);return Ki[++wn]=function(){(typeof i=="function"?i:Function(i)).apply(void 0,e)},Li(wn),wn},Ft=function(i){delete Ki[i]},qe)var Li=function(i){OD.nextTick(yn(i))};else if(vn&&vn.now)Li=function(i){vn.now(yn(i))};else if(Gt&&!Et){var Jt=new Gt,Kt=Jt.port2;Jt.port1.onmessage=Ht,Li=tf(Kt.postMessage,Kt,1)}else na.addEventListener&&typeof postMessage=="function"&&!na.importScripts&&sk&&sk.protocol!=="file:"&&!Ga(It)?(Li=It,na.addEventListener("message",Ht,!1)):Li="onreadystatechange"in(dk?hh.createElement("script"):{})?function(i){on.appendChild(dk?hh.createElement("script"):{}).onreadystatechange=function(){on.removeChild(this),xn(i)}}:function(i){setTimeout(yn(i),0)};var zn=un,PD=/web0s(?!.*chrome)/i.test(lh),QD=pd.f,Lt=na.MutationObserver||na.WebKitMutationObserver,Mt=na.document,Nt=na.process,tk=na.Promise,Ot=QD(na,"queueMicrotask"),Pt=Ot&&Ot.value,jg,Mi;if(!Pt){var vk=function(){var i;for(qe&&(i=Nt.domain)&&i.exit();jg;){var e=jg.fn;jg=jg.next;try{e()}catch(o){throw jg?uk():Mi=void 0,o}}Mi=void 0,i&&i.enter()};if(Et||qe||PD||!Lt||!Mt)if(tk&&tk.resolve){var An=tk.resolve(void 0);An.constructor=tk;var RD=An.then,uk=function(){RD.call(An,vk)}}else uk=qe?function(){Nt.nextTick(vk)}:function(){zn.call(na,vk)};else{var Qt=!0,Rt=Mt.createTextNode("");new Lt(vk).observe(Rt,{characterData:!0}),uk=function(){Rt.data=Qt=!Qt}}}var St=Pt||function(i){i={fn:i,next:void 0},Mi&&(Mi.next=i),jg||(jg=i,uk()),Mi=i},SD=function(i){var e,o;this.promise=new i(function(c,_){if(e!==void 0||o!==void 0)throw TypeError("Bad Promise constructor");e=c,o=_}),this.resolve=Rc(e),this.reject=Rc(o)},Bn={f:function(i){return new SD(i)}},TD=function(i,e){var o=na.console;o&&o.error&&(arguments.length===1?o.error(i):o.error(i,e))},Cn=function(i){try{return{error:!1,value:i()}}catch(e){return{error:!0,value:e}}},UD=typeof window=="object",VD=mb("species"),Tt=Sb.get,WD=Sb.set,XD=Sb.getterFor("Promise"),kg=qk&&qk.prototype,ed=qk,wk=kg,Ut=na.TypeError,Dn=na.document,En=na.process,rh=Bn.f,YD=rh,ZD=!!(Dn&&Dn.createEvent&&na.dispatchEvent),Vt=typeof PromiseRejectionEvent=="function",Wt=!1,Ni=ne("Promise",function(){var i=Zm(ed)!==String(ed);if(!i&&oe===66)return!0;if(51<=oe&&/native code/.test(ed))return!1;var e=new ed(function(c){c(1)}),o=function(c){c(function(){},function(){})};return(e.constructor={})[VD]=o,!(Wt=e.then(function(){})instanceof o)||!i&&UD&&!Vt}),$D=Ni||!mk(function(i){ed.all(i).catch(function(){})}),Xt=function(i){var e;return!(!fb(i)||typeof(e=i.then)!="function")&&e},Fn=function(i,e){if(!i.notified){i.notified=!0;var o=i.reactions;St(function(){for(var c=i.value,_=i.state==1,$=0;o.length>$;){var _t,ga=o[$++],_s=_?ga.ok:ga.fail,_c=ga.resolve,_l=ga.reject,Tl=ga.domain;try{if(_s){if(_||(i.rejection===2&&aE(i),i.rejection=1),_s===!0)var Cl=c;else if(Tl&&Tl.enter(),Cl=_s(c),Tl){Tl.exit();var Pl=!0}Cl===ga.promise?_l(Ut("Promise-chain cycle")):(_t=Xt(Cl))?_t.call(Cl,_c,_l):_c(Cl)}else _l(c)}catch(Dl){Tl&&!Pl&&Tl.exit(),_l(Dl)}}i.reactions=[],i.notified=!1,e&&!i.rejection&&bE(i)})}},Yt=function(i,e,o){var c;if(ZD){var _=Dn.createEvent("Event");_.promise=e,_.reason=o,_.initEvent(i,!1,!0),na.dispatchEvent(_)}else _={promise:e,reason:o};!Vt&&(c=na["on"+i])?c(_):i==="unhandledrejection"&&TD("Unhandled promise rejection",o)},bE=function(i){zn.call(na,function(){var e=i.facade,o=i.value;if(i.rejection!==1&&!i.parent){var c=Cn(function(){qe?En.emit("unhandledRejection",o,e):Yt("unhandledrejection",e,o)});if(i.rejection=qe||i.rejection!==1&&!i.parent?2:1,c.error)throw c.value}})},aE=function(i){zn.call(na,function(){var e=i.facade;qe?En.emit("rejectionHandled",e):Yt("rejectionhandled",e,i.value)})},sh=function(i,e,o){return function(c){i(e,c,o)}},th=function(i,e,o){i.done||(i.done=!0,o&&(i=o),i.value=e,i.state=2,Fn(i,!0))},Gn=function(i,e,o){if(!i.done){i.done=!0,o&&(i=o);try{if(i.facade===e)throw Ut("Promise can't be resolved itself");var c=Xt(e);c?St(function(){var _={done:!1};try{c.call(e,sh(Gn,_,i),sh(th,_,i))}catch($){th(_,$,i)}}):(i.value=e,i.state=1,Fn(i,!1))}catch(_){th({done:!1},_,i)}}};if(Ni){ed=function(i){Ud(this,ed,"Promise"),Rc(i),Hn.call(this);var e=Tt(this);try{i(sh(Gn,e),sh(th,e))}catch(o){th(e,o)}},wk=ed.prototype;var Hn=function(i){WD(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})};Hn.prototype=qh(wk,{then:function(i,e){var o=XD(this),c=rh(eg(this,ed));return c.ok=typeof i!="function"||i,c.fail=typeof e=="function"&&e,c.domain=qe?En.domain:void 0,o.parent=!0,o.reactions.push(c),o.state!=0&&Fn(o,!1),c.promise},catch:function(i){return this.then(void 0,i)}});var cE=function(){var i=new Hn,e=Tt(i);this.promise=i,this.resolve=sh(Gn,e),this.reject=sh(th,e)};if(Bn.f=rh=function(i){return i===ed||i===dE?new cE(i):YD(i)},typeof qk=="function"&&kg!==Object.prototype){var eE=kg.then;Wt||(Ob(kg,"then",function(i,e){var o=this;return new ed(function(c,_){eE.call(o,c,_)}).then(i,e)},{unsafe:!0}),Ob(kg,"catch",wk.catch,{unsafe:!0}));try{delete kg.constructor}catch{}gc&&gc(kg,wk)}}wa({global:!0,wrap:!0,forced:Ni},{Promise:ed}),Td(ed,"Promise",!1),Ii("Promise");var dE=me("Promise");wa({target:"Promise",stat:!0,forced:Ni},{reject:function(i){var e=rh(this);return e.reject.call(void 0,i),e.promise}}),wa({target:"Promise",stat:!0,forced:Ni},{resolve:function(i){if(ub(this),!fb(i)||i.constructor!==this){var e=Bn.f(this);(0,e.resolve)(i),i=e.promise}return i}}),wa({target:"Promise",stat:!0,forced:$D},{all:function(i){var e=this,o=rh(e),c=o.resolve,_=o.reject,$=Cn(function(){var _t=Rc(e.resolve),ga=[],_s=0,_c=1;rk(i,function(_l){var Tl=_s++,Cl=!1;ga.push(void 0),_c++,_t.call(e,_l).then(function(Pl){Cl||(Cl=!0,ga[Tl]=Pl,--_c||c(ga))},_)}),--_c||c(ga)});return $.error&&_($.value),o.promise},race:function(i){var e=this,o=rh(e),c=o.reject,_=Cn(function(){var $=Rc(e.resolve);rk(i,function(_t){$.call(e,_t).then(o.resolve,c)})});return _.error&&c(_.value),o.promise}});var fE=Math.floor,gE="".replace,hE=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,iE=/\$([$&'`]|\d{1,2})/g,jE=function(i,e,o,c,_,$){var _t=o+i.length,ga=c.length,_s=iE;return _!==void 0&&(_=Zb(_),_s=hE),gE.call($,_s,function(_c,_l){switch(_l.charAt(0)){case"$":return"$";case"&":return i;case"`":return e.slice(0,o);case"'":return e.slice(_t);case"<":_c=_[_l.slice(1,-1)];break;default:var Tl=+_l;if(Tl===0)return _c;if(Tl>ga)return(Tl=fE(Tl/10))===0?_c:Tl<=ga?c[Tl-1]===void 0?_l.charAt(1):c[Tl-1]+_l.charAt(1):_c;_c=c[Tl-1]}return _c===void 0?"":_c})},kE=Math.max,lE=Math.min;jk("replace",2,function(i,e,o,c){var _=c.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,$=c.REPLACE_KEEPS_$0,_t=_?"$":"$0";return[function(ga,_s){var _c=Ec(this),_l=ga==null?void 0:ga[i];return _l!==void 0?_l.call(ga,_c,_s):e.call(String(_c),ga,_s)},function(ga,_s){if(!_&&$||typeof _s=="string"&&_s.indexOf(_t)===-1){var _c=o(e,ga,this,_s);if(_c.done)return _c.value}var _l=ub(ga);ga=String(this),(_c=typeof _s=="function")||(_s=String(_s));var Tl=_l.global;if(Tl){var Cl=_l.unicode;_l.lastIndex=0}for(var Pl=[];;){var Dl=mh(_l,ga);if(Dl===null||(Pl.push(Dl),!Tl))break;String(Dl[0])===""&&(_l.lastIndex=hn(ga,xb(_l.lastIndex),Cl))}for(Cl="",Tl=_l=0;Tl<Pl.length;Tl++){Dl=Pl[Tl];for(var Jl=String(Dl[0]),zl=kE(lE(Rd(Dl.index),ga.length),0),Bl=[],Vl=1;Vl<Dl.length;Vl++){var _d=Bl,Sp=Dl[Vl];_d.push.call(_d,Sp===void 0?Sp:String(Sp))}Dl=Dl.groups,_c?(Bl=[Jl].concat(Bl,zl,ga),Dl!==void 0&&Bl.push(Dl),Dl=String(_s.apply(void 0,Bl))):Dl=jE(Jl,ga,zl,Bl,Dl,_s),zl>=_l&&(Cl+=ga.slice(_l,zl)+Dl,_l=zl+Jl.length)}return Cl+ga.slice(_l)}]});var mE=Fi("slice"),nE=mb("species"),oE=[].slice,pE=Math.max;wa({target:"Array",proto:!0,forced:!mE},{slice:function(i,e){var o=Qc(this),c=xb(o.length);if(i=dd(i,c),e=dd(e===void 0?c:e,c),uf(o)){var _=o.constructor;if(typeof _!="function"||_!==Array&&!uf(_.prototype)?fb(_)&&(_=_[nE])===null&&(_=void 0):_=void 0,_===Array||_===void 0)return oE.call(o,i,e)}for(_=new(_===void 0?Array:_)(pE(e-i,0)),c=0;i<e;i++,c++)i in o&&oh(_,c,o[i]);return _.length=c,_}});var qE=Sb.set,rE=Sb.getterFor("Array Iterator"),xf=rn(Array,"Array",function(i,e){qE(this,{type:"Array Iterator",target:Qc(i),index:0,kind:e})},function(){var i=rE(this),e=i.target,o=i.kind,c=i.index++;return!e||c>=e.length?(i.target=void 0,{value:void 0,done:!0}):o=="keys"?{value:c,done:!1}:o=="values"?{value:e[c],done:!1}:{value:[c,e[c]],done:!1}},"values");nh.Arguments=nh.Array,wf("keys"),wf("values"),wf("entries");var Zt=typeof ArrayBuffer<"u"&&typeof DataView<"u",uh=function(i){if(i===void 0)return 0;i=Rd(i);var e=xb(i);if(i!==e)throw RangeError("Wrong length or index");return e},sE=Math.abs,Je=Math.pow,tE=Math.floor,uE=Math.log,vE=Math.LN2,In=function(i){var e=Zb(this),o=xb(e.length),c=arguments.length,_=dd(1<c?arguments[1]:void 0,o);for(o=(c=2<c?arguments[2]:void 0)===void 0?o:dd(c,o);o>_;)e[_++]=i;return e},wE=dg.f,xE=$b.f,vh=Sb.get,$t=Sb.set,Vd=na.ArrayBuffer,fd=Vd,Wd=na.DataView,xk=Wd&&Wd.prototype,au=Object.prototype,yk=na.RangeError,bu=function(i,e,o){var c,_=Array(o),$=(1<<(o=8*o-e-1))-1,_t=$>>1,ga=e===23?Je(2,-24)-Je(2,-77):0,_s=0>i||i===0&&0>1/i?1:0,_c=0;if((i=sE(i))!=i||1/0===i){i=i!=i?1:0;var _l=$}else _l=tE(uE(i)/vE),1>i*(c=Je(2,-_l))&&(_l--,c*=2),2<=(i=1<=_l+_t?i+ga/c:i+ga*Je(2,1-_t))*c&&(_l++,c/=2),_l+_t>=$?(i=0,_l=$):1<=_l+_t?(i=(i*c-1)*Je(2,e),_l+=_t):(i=i*Je(2,_t-1)*Je(2,e),_l=0);for(;8<=e;_[_c++]=255&i,i/=256,e-=8);for(_l=_l<<e|i,o+=e;0<o;_[_c++]=255&_l,_l/=256,o-=8);return _[--_c]|=128*_s,_},cu=function(i,e){var o=i.length,c=8*o-e-1,_=(1<<c)-1,$=_>>1;c-=7,--o;var _t=i[o--],ga=127&_t;for(_t>>=7;0<c;ga=256*ga+i[o],o--,c-=8);var _s=ga&(1<<-c)-1;for(ga>>=-c,c+=e;0<c;_s=256*_s+i[o],o--,c-=8);if(ga===0)ga=1-$;else{if(ga===_)return _s?NaN:_t?-1/0:1/0;_s+=Je(2,e),ga-=$}return(_t?-1:1)*_s*Je(2,ga-e)},du=function(i){return[255&i]},eu=function(i){return[255&i,i>>8&255]},fu=function(i){return[255&i,i>>8&255,i>>16&255,i>>24&255]},gu=function(i){return i[3]<<24|i[2]<<16|i[1]<<8|i[0]},yE=function(i){return bu(i,23,4)},zE=function(i){return bu(i,52,8)},zk=function(i,e){xE(i.prototype,e,{get:function(){return vh(this)[e]}})},yf=function(i,e,o,c){o=uh(o);var _=vh(i);if(o+e>_.byteLength)throw yk("Wrong index");return i=vh(_.buffer).bytes,o+=_.byteOffset,e=i.slice(o,o+e),c?e:e.reverse()},zf=function(i,e,o,c,_,$){o=uh(o);var _t=vh(i);if(o+e>_t.byteLength)throw yk("Wrong index");for(i=vh(_t.buffer).bytes,o+=_t.byteOffset,c=c(+_),_=0;_<e;_++)i[o+_]=c[$?_:e-_-1]};if(Zt){if(!Ga(function(){Vd(1)})||!Ga(function(){new Vd(-1)})||Ga(function(){return new Vd,new Vd(1.5),new Vd(NaN),Vd.name!="ArrayBuffer"})){fd=function(i){return Ud(this,fd),new Vd(uh(i))};for(var AE=fd.prototype=Vd.prototype,hu=wE(Vd),iu=0,Jn;hu.length>iu;)(Jn=hu[iu++])in fd||ac(fd,Jn,Vd[Jn]);AE.constructor=fd}gc&&Md(xk)!==au&&gc(xk,au);var Ak=new Wd(new fd(2)),ju=xk.setInt8;Ak.setInt8(0,2147483648),Ak.setInt8(1,2147483649),!Ak.getInt8(0)&&Ak.getInt8(1)||qh(xk,{setInt8:function(i,e){ju.call(this,i,e<<24>>24)},setUint8:function(i,e){ju.call(this,i,e<<24>>24)}},{unsafe:!0})}else fd=function(i){Ud(this,fd,"ArrayBuffer"),i=uh(i),$t(this,{bytes:In.call(Array(i),0),byteLength:i}),cb||(this.byteLength=i)},Wd=function(i,e,o){Ud(this,Wd,"DataView"),Ud(i,fd,"DataView");var c=vh(i).byteLength;if(0>(e=Rd(e))||e>c)throw yk("Wrong offset");if(e+(o=o===void 0?c-e:xb(o))>c)throw yk("Wrong length");$t(this,{buffer:i,byteLength:o,byteOffset:e}),cb||(this.buffer=i,this.byteLength=o,this.byteOffset=e)},cb&&(zk(fd,"byteLength"),zk(Wd,"buffer"),zk(Wd,"byteLength"),zk(Wd,"byteOffset")),qh(Wd.prototype,{getInt8:function(i){return yf(this,1,i)[0]<<24>>24},getUint8:function(i){return yf(this,1,i)[0]},getInt16:function(i){var e=yf(this,2,i,1<arguments.length?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(i){var e=yf(this,2,i,1<arguments.length?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(i){return gu(yf(this,4,i,1<arguments.length?arguments[1]:void 0))},getUint32:function(i){return gu(yf(this,4,i,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(i){return cu(yf(this,4,i,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(i){return cu(yf(this,8,i,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(i,e){zf(this,1,i,du,e)},setUint8:function(i,e){zf(this,1,i,du,e)},setInt16:function(i,e){zf(this,2,i,eu,e,2<arguments.length?arguments[2]:void 0)},setUint16:function(i,e){zf(this,2,i,eu,e,2<arguments.length?arguments[2]:void 0)},setInt32:function(i,e){zf(this,4,i,fu,e,2<arguments.length?arguments[2]:void 0)},setUint32:function(i,e){zf(this,4,i,fu,e,2<arguments.length?arguments[2]:void 0)},setFloat32:function(i,e){zf(this,4,i,yE,e,2<arguments.length?arguments[2]:void 0)},setFloat64:function(i,e){zf(this,8,i,zE,e,2<arguments.length?arguments[2]:void 0)}});Td(fd,"ArrayBuffer"),Td(Wd,"DataView");var Oi={ArrayBuffer:fd,DataView:Wd},Kn=Oi.ArrayBuffer,ku=Oi.DataView,lu=Kn.prototype.slice,BE=Ga(function(){return!new Kn(2).slice(1,void 0).byteLength});wa({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:BE},{slice:function(i,e){if(lu!==void 0&&e===void 0)return lu.call(ub(this),i);var o=ub(this).byteLength;i=dd(i,o),e=dd(e===void 0?o:e,o),o=new(eg(this,Kn))(xb(e-i));for(var c=new ku(this),_=new ku(o),$=0;i<e;)_.setUint8($++,c.getUint8(i++));return o}});var CE=$b.f,Bk=na.Int8Array,Ln=Bk&&Bk.prototype,mu=na.Uint8ClampedArray,nu=mu&&mu.prototype,re=Bk&&Md(Bk),Xd=Ln&&Md(Ln),ou=Object.prototype,pu=ou.isPrototypeOf,qu=mb("toStringTag"),Mn=ih("TYPED_ARRAY_TAG"),Ke=Zt&&!!gc&&ph(na.opera)!=="Opera",ru=!1,gd,se={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},DE={BigInt64Array:8,BigUint64Array:8},Ck=function(i){return!!fb(i)&&(i=ph(i),Fa(se,i)||Fa(DE,i))};for(gd in se)na[gd]||(Ke=!1);if((!Ke||typeof re!="function"||re===Function.prototype)&&(re=function(){throw TypeError("Incorrect invocation")},Ke))for(gd in se)na[gd]&&gc(na[gd],re);if((!Ke||!Xd||Xd===ou)&&(Xd=re.prototype,Ke))for(gd in se)na[gd]&&gc(na[gd].prototype,Xd);if(Ke&&Md(nu)!==Xd&&gc(nu,Xd),cb&&!Fa(Xd,qu))for(gd in ru=!0,CE(Xd,qu,{get:function(){return fb(this)?this[Mn]:void 0}}),se)na[gd]&&ac(na[gd],Mn,gd);var Pi=Ke,su=ru&&Mn,Gb=function(i){if(Ck(i))return i;throw TypeError("Target is not a typed array")},wh=function(i){if(gc){if(pu.call(re,i))return i}else for(var e in se)if(Fa(se,gd)){var o=na[e];if(o&&(i===o||pu.call(o,i)))return i}throw TypeError("Target is not a typed array constructor")},Cb=function(i,e,o){if(cb){if(o)for(var c in se){var _=na[c];if(_&&Fa(_.prototype,i))try{delete _.prototype[i]}catch{}}Xd[i]&&!o||Ob(Xd,i,o?e:Ke&&Ln[i]||e)}},tu=function(i,e,o){var c,_;if(cb){if(gc){if(o){for(c in se)if((_=na[c])&&Fa(_,i))try{delete _[i]}catch{}}if(re[i]&&!o)return;try{return Ob(re,i,o?e:Ke&&re[i]||e)}catch{}}for(c in se)!(_=na[c])||_[i]&&!o||Ob(_,i,e)}},uu=re,Qi=Xd,EE=na.ArrayBuffer,lg=na.Int8Array,Nn=!Pi||!Ga(function(){lg(1)})||!Ga(function(){new lg(-1)})||!mk(function(i){new lg,new lg(null),new lg(1.5),new lg(i)},!0)||Ga(function(){return new lg(new EE(2),1,void 0).length!==1}),Dk=function(i,e){if(0>(i=Rd(i)))throw RangeError("The argument can't be less than 0");if(i%e)throw RangeError("Wrong offset");return i},On=function(i){var e=Zb(i),o=arguments.length,c=1<o?arguments[1]:void 0,_=c!==void 0,$=Gi(e);if($!=null&&!ln($)){var _t=$.call(e),ga=_t.next;for(e=[];!($=ga.call(_t)).done;)e.push($.value)}for(_&&2<o&&(c=tf(c,arguments[2],2)),$=xb(e.length),_t=new(wh(this))($),o=0;$>o;o++)_t[o]=_?c(e[o],o):e[o];return _t},Ek=function(i,e,o){var c,_;return gc&&typeof(c=e.constructor)=="function"&&c!==o&&fb(_=c.prototype)&&_!==o.prototype&&gc(i,_),i},Ri=kc(function(i){var e=dg.f,o=Sb.get,c=Sb.set,_=$b.f,$=pd.f,_t=Math.round,ga=na.RangeError,_s=Oi.ArrayBuffer,_c=Oi.DataView,_l=function(zl,Bl){var Vl=0,_d=Bl.length;for(zl=new(wh(zl))(_d);_d>Vl;)zl[Vl]=Bl[Vl++];return zl},Tl=function(zl,Bl){_(zl,Bl,{get:function(){return o(this)[Bl]}})},Cl=function(zl){var Bl;return zl instanceof _s||(Bl=ph(zl))=="ArrayBuffer"||Bl=="SharedArrayBuffer"},Pl=function(zl,Bl){return Ck(zl)&&typeof Bl!="symbol"&&Bl in zl&&String(+Bl)==String(Bl)},Dl=function(zl,Bl){return Pl(zl,Bl=le(Bl,!0))?ke(2,zl[Bl]):$(zl,Bl)},Jl=function(zl,Bl,Vl){return!(Pl(zl,Bl=le(Bl,!0))&&fb(Vl)&&Fa(Vl,"value"))||Fa(Vl,"get")||Fa(Vl,"set")||Vl.configurable||Fa(Vl,"writable")&&!Vl.writable||Fa(Vl,"enumerable")&&!Vl.enumerable?_(zl,Bl,Vl):(zl[Bl]=Vl.value,zl)};cb?(Pi||(pd.f=Dl,$b.f=Jl,Tl(Qi,"buffer"),Tl(Qi,"byteOffset"),Tl(Qi,"byteLength"),Tl(Qi,"length")),wa({target:"Object",stat:!0,forced:!Pi},{getOwnPropertyDescriptor:Dl,defineProperty:Jl}),i.exports=function(zl,Bl,Vl){var _d=zl.match(/\d+$/)[0]/8,Sp=zl+(Vl?"Clamped":"")+"Array",Up="get"+zl,Kp="set"+zl,Hp=na[Sp],_m=Hp;zl=_m&&_m.prototype;var I0={},Cp=function(Jp,Zp){_(Jp,Zp,{get:function(){var i0=o(this);return i0.view[Up](Zp*_d+i0.byteOffset,!0)},set:function(i0){var Np=o(this);Vl&&(i0=0>(i0=_t(i0))?0:255<i0?255:255&i0),Np.view[Kp](Zp*_d+Np.byteOffset,i0,!0)},enumerable:!0})};Pi?Nn&&(_m=Bl(function(Jp,Zp,i0,Np){return Ud(Jp,_m,Sp),Ek(fb(Zp)?Cl(Zp)?Np!==void 0?new Hp(Zp,Dk(i0,_d),Np):i0!==void 0?new Hp(Zp,Dk(i0,_d)):new Hp(Zp):Ck(Zp)?_l(_m,Zp):On.call(_m,Zp):new Hp(uh(Zp)),Jp,_m)}),gc&&gc(_m,uu),fg(e(Hp),function(Jp){Jp in _m||ac(_m,Jp,Hp[Jp])}),_m.prototype=zl):(_m=Bl(function(Jp,Zp,i0,Np){Ud(Jp,_m,Sp);var Dp=0,Qp=0;if(fb(Zp)){if(!Cl(Zp))return Ck(Zp)?_l(_m,Zp):On.call(_m,Zp);var n0=Zp;if(Qp=Dk(i0,_d),Zp=Zp.byteLength,Np===void 0){if(Zp%_d||0>(Np=Zp-Qp))throw ga("Wrong length")}else if((Np=xb(Np)*_d)+Qp>Zp)throw ga("Wrong length");Zp=Np/_d}else Zp=uh(Zp),n0=new _s(Np=Zp*_d);for(c(Jp,{buffer:n0,byteOffset:Qp,byteLength:Np,length:Zp,view:new _c(n0)});Dp<Zp;)Cp(Jp,Dp++)}),gc&&gc(_m,uu),zl=_m.prototype=vd(Qi)),zl.constructor!==_m&&ac(zl,"constructor",_m),su&&ac(zl,su,Sp),I0[Sp]=_m,wa({global:!0,forced:_m!=Hp,sham:!Pi},I0),"BYTES_PER_ELEMENT"in _m||ac(_m,"BYTES_PER_ELEMENT",_d),"BYTES_PER_ELEMENT"in zl||ac(zl,"BYTES_PER_ELEMENT",_d),Ii(Sp)}):i.exports=function(){}});Ri("Uint8",function(i){return function(e,o,c){return i(this,e,o,c)}});var FE=Math.min,GE=[].copyWithin||function(i,e){var o=Zb(this),c=xb(o.length),_=dd(i,c),$=dd(e,c),_t=2<arguments.length?arguments[2]:void 0;for(c=FE((_t===void 0?c:dd(_t,c))-$,c-_),_t=1,$<_&&_<$+c&&(_t=-1,$+=c-1,_+=c-1);0<c--;)$ in o?o[_]=o[$]:delete o[_],_+=_t,$+=_t;return o};Cb("copyWithin",function(i,e){return GE.call(Gb(this),i,e,2<arguments.length?arguments[2]:void 0)}),Cb("every",function(i){return pD(Gb(this),i,1<arguments.length?arguments[1]:void 0)}),Cb("fill",function(i){return In.apply(Gb(this),arguments)}),Cb("filter",function(i){var e=jt(Gb(this),i,1<arguments.length?arguments[1]:void 0),o=eg(this,this.constructor),c=0,_=e.length;for(o=new(wh(o))(_);_>c;)o[c]=e[c++];return o}),Cb("find",function(i){return kt(Gb(this),i,1<arguments.length?arguments[1]:void 0)}),Cb("findIndex",function(i){return lt(Gb(this),i,1<arguments.length?arguments[1]:void 0)}),Cb("forEach",function(i){fg(Gb(this),i,1<arguments.length?arguments[1]:void 0)}),Cb("includes",function(i){return Ss(Gb(this),i,1<arguments.length?arguments[1]:void 0)}),Cb("indexOf",function(i){return bn(Gb(this),i,1<arguments.length?arguments[1]:void 0)});var vu=mb("iterator"),wu=na.Uint8Array,HE=xf.values,IE=xf.keys,JE=xf.entries,Pn=wu&&wu.prototype[vu],xu=!!Pn&&(Pn.name=="values"||Pn.name==null),yu=function(){return HE.call(Gb(this))};Cb("entries",function(){return JE.call(Gb(this))}),Cb("keys",function(){return IE.call(Gb(this))}),Cb("values",yu,!xu),Cb(vu,yu,!xu);var KE=[].join;Cb("join",function(i){return KE.apply(Gb(this),arguments)});var LE=Math.min,Qn=[].lastIndexOf,zu=!!Qn&&0>1/[1].lastIndexOf(1,-0),ME=gg("lastIndexOf"),Rn=zu||!ME?function(i){if(zu)return Qn.apply(this,arguments)||0;var e=Qc(this),o=xb(e.length),c=o-1;for(1<arguments.length&&(c=LE(c,Rd(arguments[1]))),0>c&&(c=o+c);0<=c;c--)if(c in e&&e[c]===i)return c||0;return-1}:Qn;Cb("lastIndexOf",function(i){return Rn.apply(Gb(this),arguments)}),Cb("map",function(i){return it(Gb(this),i,1<arguments.length?arguments[1]:void 0,function(e,o){return new(wh(eg(e,e.constructor)))(o)})});var Au=function(i){return function(e,o,c,_){Rc(o),e=Zb(e);var $=zi(e),_t=xb(e.length),ga=i?_t-1:0,_s=i?-1:1;if(2>c)for(;;){if(ga in $){_=$[ga],ga+=_s;break}if(ga+=_s,i?0>ga:_t<=ga)throw TypeError("Reduce of empty array with no initial value")}for(;i?0<=ga:_t>ga;ga+=_s)ga in $&&(_=o(_,$[ga],ga,e));return _}},Bu=Au(!1),Cu=Au(!0);Cb("reduce",function(i){return Bu(Gb(this),i,arguments.length,1<arguments.length?arguments[1]:void 0)}),Cb("reduceRight",function(i){return Cu(Gb(this),i,arguments.length,1<arguments.length?arguments[1]:void 0)});var NE=Math.floor;Cb("reverse",function(){for(var i,e=Gb(this).length,o=NE(e/2),c=0;c<o;)i=this[c],this[c++]=this[--e],this[e]=i;return this});var OE=Ga(function(){new Int8Array(1).set({})});Cb("set",function(i){Gb(this);var e=Dk(1<arguments.length?arguments[1]:void 0,1),o=this.length,c=Zb(i),_=xb(c.length),$=0;if(_+e>o)throw RangeError("Wrong length");for(;$<_;)this[e+$]=c[$++]},OE);var PE=[].slice,QE=Ga(function(){new Int8Array(1).slice()});Cb("slice",function(i,e){i=PE.call(Gb(this),i,e);var o=eg(this,this.constructor);e=0;var c=i.length;for(o=new(wh(o))(c);c>e;)o[e]=i[e++];return o},QE),Cb("some",function(i){return oD(Gb(this),i,1<arguments.length?arguments[1]:void 0)});var RE=[].sort;Cb("sort",function(i){return RE.call(Gb(this),i)}),Cb("subarray",function(i,e){var o=Gb(this),c=o.length;return i=dd(i,c),new(eg(o,o.constructor))(o.buffer,o.byteOffset+i*o.BYTES_PER_ELEMENT,xb((e===void 0?c:dd(e,c))-i))});var Fk=na.Int8Array,Du=[].toLocaleString,SE=[].slice,TE=!!Fk&&Ga(function(){Du.call(new Fk(1))}),UE=Ga(function(){return[1,2].toLocaleString()!=new Fk([1,2]).toLocaleString()})||!Ga(function(){Fk.prototype.toLocaleString.call([1,2])});Cb("toLocaleString",function(){return Du.apply(TE?SE.call(Gb(this)):Gb(this),arguments)},UE);var Eu=na.Uint8Array,VE=Eu&&Eu.prototype||{},Gk=[].toString,WE=[].join;Ga(function(){Gk.call({})})&&(Gk=function(){return WE.call(this)}),Cb("toString",Gk,VE.toString!=Gk);var Fu=Oi.ArrayBuffer;wa({global:!0,forced:na.ArrayBuffer!==Fu},{ArrayBuffer:Fu}),Ii("ArrayBuffer");var XE=$b.f,Sn=Function.prototype,YE=Sn.toString,ZE=/^\s*function ([^ (]*)/;!cb||"name"in Sn||XE(Sn,"name",{configurable:!0,get:function(){try{return YE.call(this).match(ZE)[1]}catch{return""}}});var Gu=RegExp.prototype,Hu=Gu.toString,$E=Ga(function(){return Hu.call({source:"a",flags:"b"})!="/a/b"}),aF=Hu.name!="toString";($E||aF)&&Ob(RegExp.prototype,"toString",function(){var i=ub(this),e=String(i.source),o=i.flags;return"/"+e+"/"+(i=String(o===void 0&&i instanceof RegExp&&!("flags"in Gu)?hk.call(i):o))},{unsafe:!0});var bF=Fi("splice"),cF=Math.max,dF=Math.min;wa({target:"Array",proto:!0,forced:!bF},{splice:function(i,e){var o,c,_=Zb(this),$=xb(_.length),_t=dd(i,$),ga=arguments.length;if(ga===0?ga=o=0:ga===1?(ga=0,o=$-_t):(ga-=2,o=dF(cF(Rd(e),0),$-_t)),9007199254740991<$+ga-o)throw TypeError("Maximum allowed length exceeded");var _s=Ei(_,o);for(c=0;c<o;c++){var _c=_t+c;_c in _&&oh(_s,c,_[_c])}if(_s.length=o,ga<o){for(c=_t;c<$-o;c++){var _l=c+ga;(_c=c+o)in _?_[_l]=_[_c]:delete _[_l]}for(c=$;c>$-o+ga;c--)delete _[c-1]}else if(ga>o)for(c=$-o;c>_t;c--)_l=c+ga-1,(_c=c+o-1)in _?_[_l]=_[_c]:delete _[_l];for(c=0;c<ga;c++)_[c+_t]=arguments[c+2];return _.length=$-o+ga,_s}});var Tn={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Un=mb("iterator"),Iu=mb("toStringTag"),Vn=xf.values,Hk;for(Hk in Tn){var Ju=na[Hk],Le=Ju&&Ju.prototype;if(Le){if(Le[Un]!==Vn)try{ac(Le,Un,Vn)}catch{Le[Un]=Vn}if(Le[Iu]||ac(Le,Iu,Hk),Tn[Hk]){for(var xh in xf)if(Le[xh]!==xf[xh])try{ac(Le,xh,xf[xh])}catch{Le[xh]=xf[xh]}}}}var Ku=Object.is||function(i,e){return i===e?i!==0||1/i==1/e:i!=i&&e!=e};jk("search",1,function(i,e,o){return[function(c){var _=Ec(this),$=c==null?void 0:c[i];return $!==void 0?$.call(c,_):new RegExp(c)[i](String(_))},function(c){var _=o(e,c,this);if(_.done)return _.value;c=ub(c);var $=String(this);return _=c.lastIndex,Ku(_,0)||(c.lastIndex=0),$=mh(c,$),Ku(c.lastIndex,_)||(c.lastIndex=_),$===null?-1:$.index}]}),kc(function(i){(function(e,o){i.exports?i.exports=o(e):o(e)})(typeof self<"u"?self:qb,function(e){function o(Cp){return btoa(Cp).replace(/=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function c(Cp){return Cp=(Cp+="===").slice(0,-Cp.length%4),atob(Cp.replace(/-/g,"+").replace(/_/g,"/"))}function _(Cp){for(var Jp=new Uint8Array(Cp.length),Zp=0;Zp<Cp.length;Zp++)Jp[Zp]=Cp.charCodeAt(Zp);return Jp}function $(Cp){return Cp instanceof ArrayBuffer&&(Cp=new Uint8Array(Cp)),String.fromCharCode.apply(String,Cp)}function _t(Cp){var Jp={name:(Cp.name||Cp||"").toUpperCase().replace("V","v")};switch(Jp.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":Cp.length&&(Jp.length=Cp.length);break;case"HMAC":Cp.hash&&(Jp.hash=_t(Cp.hash)),Cp.length&&(Jp.length=Cp.length);break;case"RSAES-PKCS1-v1_5":Cp.publicExponent&&(Jp.publicExponent=new Uint8Array(Cp.publicExponent)),Cp.modulusLength&&(Jp.modulusLength=Cp.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":Cp.hash&&(Jp.hash=_t(Cp.hash)),Cp.publicExponent&&(Jp.publicExponent=new Uint8Array(Cp.publicExponent)),Cp.modulusLength&&(Jp.modulusLength=Cp.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return Jp}function ga(Cp){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[Cp.name][(Cp.hash||{}).name||Cp.length||""]}function _s(Cp){(Cp instanceof ArrayBuffer||Cp instanceof Uint8Array)&&(Cp=JSON.parse(decodeURIComponent(escape($(Cp)))));var Jp={kty:Cp.kty,alg:Cp.alg,ext:Cp.ext||Cp.extractable};switch(Jp.kty){case"oct":Jp.k=Cp.k;case"RSA":"n e d p q dp dq qi oth".split(" ").forEach(function(Zp){Zp in Cp&&(Jp[Zp]=Cp[Zp])});break;default:throw new TypeError("Unsupported key type")}return Jp}function _c(Cp){return Cp=_s(Cp),Up&&(Cp.extractable=Cp.ext,delete Cp.ext),_(unescape(encodeURIComponent(JSON.stringify(Cp)))).buffer}function _l(Cp){var Jp=Tl(Cp),Zp=!1;switch(2<Jp.length&&(Zp=!0,Jp.shift()),Cp={ext:!0},Jp[0][0]){case"1.2.840.113549.1.1.1":var i0="n e d p q dp dq qi".split(" ");for(Jp=Tl(Jp[1]),Zp&&Jp.shift(),Zp=0;Zp<Jp.length;Zp++)Jp[Zp][0]||(Jp[Zp]=Jp[Zp].subarray(1)),Cp[i0[Zp]]=o($(Jp[Zp]));Cp.kty="RSA";break;default:throw new TypeError("Unsupported key type")}return Cp}function Tl(Cp,Jp){if(Cp instanceof ArrayBuffer&&(Cp=new Uint8Array(Cp)),Jp||(Jp={pos:0,end:Cp.length}),2>Jp.end-Jp.pos||Jp.end>Cp.length)throw new RangeError("Malformed DER");var Zp=Cp[Jp.pos++],i0=Cp[Jp.pos++];if(128<=i0){if(i0&=127,Jp.end-Jp.pos<i0)throw new RangeError("Malformed DER");for(var Np=0;i0--;)Np<<=8,Np|=Cp[Jp.pos++];i0=Np}if(Jp.end-Jp.pos<i0)throw new RangeError("Malformed DER");switch(Zp){case 2:Zp=Cp.subarray(Jp.pos,Jp.pos+=i0);break;case 3:if(Cp[Jp.pos++])throw Error("Unsupported bit string");i0--;case 4:Zp=new Uint8Array(Cp.subarray(Jp.pos,Jp.pos+=i0)).buffer;break;case 5:Zp=null;break;case 6:if(!((Cp=btoa($(Cp.subarray(Jp.pos,Jp.pos+=i0))))in Hp))throw Error("Unsupported OBJECT ID "+Cp);Zp=Hp[Cp];break;case 48:for(Zp=[],i0=Jp.pos+i0;Jp.pos<i0;)Zp.push(Tl(Cp,Jp));break;default:throw Error("Unsupported DER tag 0x"+Zp.toString(16))}return Zp}function Cl(Cp,Jp){Jp||(Jp=[]);var Zp=Jp.length+2;if(Jp.push(0,0),Cp instanceof Uint8Array)for(var i0=2,Np=Cp.length,Dp=0;Dp<Np;Dp++)Jp.push(Cp[Dp]);else if(Cp instanceof ArrayBuffer)for(i0=4,Np=Cp.byteLength,Cp=new Uint8Array(Cp),Dp=0;Dp<Np;Dp++)Jp.push(Cp[Dp]);else if(Cp===null)i0=5,Np=0;else if(typeof Cp=="string"&&Cp in _m)for(i0=6,Np=(Cp=_(atob(_m[Cp]))).length,Dp=0;Dp<Np;Dp++)Jp.push(Cp[Dp]);else if(Cp instanceof Array){for(Dp=0;Dp<Cp.length;Dp++)Cl(Cp[Dp],Jp);i0=48,Np=Jp.length-Zp}else{if(!(Ia(Cp)==="object"&&Cp.tag===3&&Cp.value instanceof ArrayBuffer))throw Error("Unsupported DER value "+Cp);for(i0=3,Np=(Cp=new Uint8Array(Cp.value)).byteLength,Jp.push(0),Dp=0;Dp<Np;Dp++)Jp.push(Cp[Dp]);Np++}if(128<=Np){for(Dp=Np,Np=4,Jp.splice(Zp,0,Dp>>24&255,Dp>>16&255,Dp>>8&255,255&Dp);1<Np&&!(Dp>>24);)Dp<<=8,Np--;4>Np&&Jp.splice(Zp,4-Np),Np|=128}return Jp.splice(Zp-2,2,i0,Np),Jp}function Pl(Cp,Jp,Zp,i0){Object.defineProperties(this,{_key:{value:Cp},type:{value:Cp.type,enumerable:!0},extractable:{value:Zp===void 0?Cp.extractable:Zp,enumerable:!0},algorithm:{value:Jp===void 0?Cp.algorithm:Jp,enumerable:!0},usages:{value:i0===void 0?Cp.usages:i0,enumerable:!0}})}function Dl(Cp){return Cp==="verify"||Cp==="encrypt"||Cp==="wrapKey"}function Jl(Cp){return Cp==="sign"||Cp==="decrypt"||Cp==="unwrapKey"}if(typeof Promise!="function")throw"Promise support required";var zl=e.crypto||e.msCrypto;if(zl){var Bl=zl.subtle||zl.webkitSubtle;if(Bl){var Vl=e.Crypto||zl.constructor||Object,_d=e.SubtleCrypto||Bl.constructor||Object;e.CryptoKey||e.Key;var Sp=-1<e.navigator.userAgent.indexOf("Edge/"),Up=!!e.msCrypto&&!Sp,Kp=!zl.subtle&&!!zl.webkitSubtle;if(Up||Kp){var Hp={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},_m={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"};if(["generateKey","importKey","unwrapKey"].forEach(function(Cp){var Jp=Bl[Cp];Bl[Cp]=function(Zp,i0,Np){var Dp=[].slice.call(arguments);switch(Cp){case"generateKey":var Qp=_t(Zp),n0=i0,Bp=Np;break;case"importKey":Qp=_t(Np),n0=Dp[3],Bp=Dp[4],Zp==="jwk"&&((i0=_s(i0)).alg||(i0.alg=ga(Qp)),i0.key_ops||(i0.key_ops=i0.kty!=="oct"?"d"in i0?Bp.filter(Jl):Bp.filter(Dl):Bp.slice()),Dp[1]=_c(i0));break;case"unwrapKey":Qp=Dp[4],n0=Dp[5],Bp=Dp[6],Dp[2]=Np._key}if(Cp==="generateKey"&&Qp.name==="HMAC"&&Qp.hash)return Qp.length=Qp.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[Qp.hash.name],Bl.importKey("raw",zl.getRandomValues(new Uint8Array(Qp.length+7>>3)),Qp,n0,Bp);if(Kp&&Cp==="generateKey"&&Qp.name==="RSASSA-PKCS1-v1_5"&&(!Qp.modulusLength||2048<=Qp.modulusLength))return(Zp=_t(Zp)).name="RSAES-PKCS1-v1_5",delete Zp.hash,Bl.generateKey(Zp,!0,["encrypt","decrypt"]).then(function(_f){return Promise.all([Bl.exportKey("jwk",_f.publicKey),Bl.exportKey("jwk",_f.privateKey)])}).then(function(_f){return _f[0].alg=_f[1].alg=ga(Qp),_f[0].key_ops=Bp.filter(Dl),_f[1].key_ops=Bp.filter(Jl),Promise.all([Bl.importKey("jwk",_f[0],Qp,!0,_f[0].key_ops),Bl.importKey("jwk",_f[1],Qp,n0,_f[1].key_ops)])}).then(function(_f){return{publicKey:_f[0],privateKey:_f[1]}});if((Kp||Up&&(Qp.hash||{}).name==="SHA-1")&&Cp==="importKey"&&Zp==="jwk"&&Qp.name==="HMAC"&&i0.kty==="oct")return Bl.importKey("raw",_(c(i0.k)),Np,Dp[3],Dp[4]);if(Kp&&Cp==="importKey"&&(Zp==="spki"||Zp==="pkcs8"))return Bl.importKey("jwk",_l(i0),Np,Dp[3],Dp[4]);if(Up&&Cp==="unwrapKey")return Bl.decrypt(Dp[3],Np,i0).then(function(_f){return Bl.importKey(Zp,_f,Dp[4],Dp[5],Dp[6])});try{var c0=Jp.apply(Bl,Dp)}catch(_f){return Promise.reject(_f)}return Up&&(c0=new Promise(function(_f,O0){c0.onabort=c0.onerror=function(_0){O0(_0)},c0.oncomplete=function(_0){_f(_0.target.result)}})),c0=c0.then(function(_f){return Qp.name!=="HMAC"||Qp.length||(Qp.length=8*_f.algorithm.length),Qp.name.search("RSA")==0&&(Qp.modulusLength||(Qp.modulusLength=(_f.publicKey||_f).algorithm.modulusLength),Qp.publicExponent||(Qp.publicExponent=(_f.publicKey||_f).algorithm.publicExponent)),_f.publicKey&&_f.privateKey?{publicKey:new Pl(_f.publicKey,Qp,n0,Bp.filter(Dl)),privateKey:new Pl(_f.privateKey,Qp,n0,Bp.filter(Jl))}:new Pl(_f,Qp,n0,Bp)})}}),["exportKey","wrapKey"].forEach(function(Cp){var Jp=Bl[Cp];Bl[Cp]=function(Zp,i0,Np){var Dp=[].slice.call(arguments);switch(Cp){case"exportKey":Dp[1]=i0._key;break;case"wrapKey":Dp[1]=i0._key,Dp[2]=Np._key}if((Kp||Up&&(i0.algorithm.hash||{}).name==="SHA-1")&&Cp==="exportKey"&&Zp==="jwk"&&i0.algorithm.name==="HMAC"&&(Dp[0]="raw"),!Kp||Cp!=="exportKey"||Zp!=="spki"&&Zp!=="pkcs8"||(Dp[0]="jwk"),Up&&Cp==="wrapKey")return Bl.exportKey(Zp,i0).then(function(n0){return Zp==="jwk"&&(n0=_(unescape(encodeURIComponent(JSON.stringify(_s(n0)))))),Bl.encrypt(Dp[3],Np,n0)});try{var Qp=Jp.apply(Bl,Dp)}catch(n0){return Promise.reject(n0)}return Up&&(Qp=new Promise(function(n0,Bp){Qp.onabort=Qp.onerror=function(c0){Bp(c0)},Qp.oncomplete=function(c0){n0(c0.target.result)}})),Cp==="exportKey"&&Zp==="jwk"&&(Qp=Qp.then(function(n0){return(Kp||Up&&(i0.algorithm.hash||{}).name==="SHA-1")&&i0.algorithm.name==="HMAC"?{kty:"oct",alg:ga(i0.algorithm),key_ops:i0.usages.slice(),ext:!0,k:o($(n0))}:((n0=_s(n0)).alg||(n0.alg=ga(i0.algorithm)),n0.key_ops||(n0.key_ops=i0.type==="public"?i0.usages.filter(Dl):i0.type==="private"?i0.usages.filter(Jl):i0.usages.slice()),n0)})),!Kp||Cp!=="exportKey"||Zp!=="spki"&&Zp!=="pkcs8"||(Qp=Qp.then(function(n0){var Bp=[["",null]],c0=!1;switch((n0=_s(n0)).kty){case"RSA":for(var _f="n e d p q dp dq qi".split(" "),O0=[],_0=0;_0<_f.length&&_f[_0]in n0;_0++){var __=O0[_0]=_(c(n0[_f[_0]]));128&__[0]&&(O0[_0]=new Uint8Array(__.length+1),O0[_0].set(__,1))}2<O0.length&&(c0=!0,O0.unshift(new Uint8Array([0]))),Bp[0][0]="1.2.840.113549.1.1.1";break;default:throw new TypeError("Unsupported key type")}return Bp.push(new Uint8Array(Cl(O0)).buffer),c0?Bp.unshift(new Uint8Array([0])):Bp[1]={tag:3,value:Bp[1]},new Uint8Array(Cl(Bp)).buffer})),Qp}}),["encrypt","decrypt","sign","verify"].forEach(function(Cp){var Jp=Bl[Cp];Bl[Cp]=function(Zp,i0,Np,Dp){if(Up&&(!Np.byteLength||Dp&&!Dp.byteLength))throw Error("Empty input is not allowed");var Qp=[].slice.call(arguments),n0=_t(Zp);if(!Up||Cp!=="sign"&&Cp!=="verify"||Zp!=="RSASSA-PKCS1-v1_5"&&Zp!=="HMAC"||(Qp[0]={name:Zp}),Up&&i0.algorithm.hash&&(Qp[0].hash=Qp[0].hash||i0.algorithm.hash),Up&&Cp==="decrypt"&&n0.name==="AES-GCM"){var Bp=Zp.tagLength>>3;Qp[2]=(Np.buffer||Np).slice(0,Np.byteLength-Bp),Zp.tag=(Np.buffer||Np).slice(Np.byteLength-Bp)}Up&&n0.name==="AES-GCM"&&Qp[0].tagLength===void 0&&(Qp[0].tagLength=128),Qp[1]=i0._key;try{var c0=Jp.apply(Bl,Qp)}catch(_f){return Promise.reject(_f)}return Up&&(c0=new Promise(function(_f,O0){c0.onabort=c0.onerror=function(_0){O0(_0)},c0.oncomplete=function(_0){if(_0=_0.target.result,Cp==="encrypt"&&_0 instanceof AesGcmEncryptResult){var __=_0.ciphertext,yp=_0.tag;(_0=new Uint8Array(__.byteLength+yp.byteLength)).set(new Uint8Array(__),0),_0.set(new Uint8Array(yp),__.byteLength),_0=_0.buffer}_f(_0)}})),c0}}),Up){var I0=Bl.digest;Bl.digest=function(Cp,Jp){if(!Jp.byteLength)throw Error("Empty input is not allowed");try{var Zp=I0.call(Bl,Cp,Jp)}catch(i0){return Promise.reject(i0)}return Zp=new Promise(function(i0,Np){Zp.onabort=Zp.onerror=function(Dp){Np(Dp)},Zp.oncomplete=function(Dp){i0(Dp.target.result)}})},e.crypto=Object.create(zl,{getRandomValues:{value:function(Cp){return zl.getRandomValues(Cp)}},subtle:{value:Bl}}),e.CryptoKey=Pl}Kp&&(zl.subtle=Bl,e.Crypto=Vl,e.SubtleCrypto=_d,e.CryptoKey=Pl)}}}})}),function(i){i.console||(i.console={}),i=i.console;for(var e,o=function(){},c=["memory"],_="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profiles profileEnd show table time timeEnd timeline timelineEnd timeStamp trace warn".split(" ");e=c.pop();)i[e]||(i[e]={});for(;e=_.pop();)i[e]||(i[e]=o)}(typeof window>"u"?qb:window),wa({target:"Object",stat:!0},{setPrototypeOf:gc});var eF=Ga(function(){Md(1)});wa({target:"Object",stat:!0,forced:eF,sham:!qt},{getPrototypeOf:function(i){return Md(Zb(i))}});var Lu=[].slice,Wn={},fF=Function.bind||function(i){var e=Rc(this),o=Lu.call(arguments,1),c=function(){var _=o.concat(Lu.call(arguments));if(this instanceof c){var $=_.length;if(!($ in Wn)){for(var _t=[],ga=0;ga<$;ga++)_t[ga]="a["+ga+"]";Wn[$]=Function("C,a","return new C("+_t.join(",")+")")}_=Wn[$](e,_)}else _=e.apply(i,_);return _};return fb(e.prototype)&&(c.prototype=e.prototype),c},Xn=me("Reflect","construct"),Mu=Ga(function(){function i(){}return!(Xn(function(){},[],i)instanceof i)}),Nu=!Ga(function(){Xn(function(){})}),Ou=Mu||Nu;wa({target:"Reflect",stat:!0,forced:Ou,sham:Ou},{construct:function(i,e){Rc(i),ub(e);var o=3>arguments.length?i:Rc(arguments[2]);if(Nu&&!Mu)return Xn(i,e,o);if(i==o){switch(e.length){case 0:return new i;case 1:return new i(e[0]);case 2:return new i(e[0],e[1]);case 3:return new i(e[0],e[1],e[2]);case 4:return new i(e[0],e[1],e[2],e[3])}return(o=[null]).push.apply(o,e),new(fF.apply(i,o))}o=o.prototype,o=vd(fb(o)?o:Object.prototype);var c=Function.apply.call(i,o,e);return fb(c)?c:o}}),wa({target:"Reflect",stat:!0},{get:cr});var Pu=pd.f,gF=Ga(function(){Pu(1)});wa({target:"Object",stat:!0,forced:!cb||gF,sham:!cb},{getOwnPropertyDescriptor:function(i,e){return Pu(Qc(i),e)}});var Qu=dg.f,hF={}.toString,Ru=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Yn=function(i){if(Ru&&hF.call(i)=="[object Window]")try{var e=Qu(i)}catch{e=Ru.slice()}else e=Qu(Qc(i));return e},Su={f:mb},iF=$b.f,Ik=function(i){var e=na.Symbol||(na.Symbol={});Fa(e,i)||iF(e,i,{value:Su.f(i)})},Sc=ek("hidden"),Tu=mb("toPrimitive"),jF=Sb.set,Uu=Sb.getterFor("Symbol"),wd=Object.prototype,Tc=na.Symbol,Si=me("JSON","stringify"),Vu=pd.f,Af=$b.f,Wu=Yn,kF=yi,Me=rf("symbols"),Ti=rf("op-symbols"),Zn=rf("string-to-symbol-registry"),$n=rf("symbol-to-string-registry"),lF=rf("wks"),ao=na.QObject,bo=!ao||!ao.prototype||!ao.prototype.findChild,co=cb&&Ga(function(){return vd(Af({},"a",{get:function(){return Af(this,"a",{value:7}).a}})).a!=7})?function(i,e,o){var c=Vu(wd,e);c&&delete wd[e],Af(i,e,o),c&&i!==wd&&Af(wd,e,c)}:Af,eo=function(i,e){var o=Me[i]=vd(Tc.prototype);return jF(o,{type:"Symbol",tag:i,description:e}),cb||(o.description=e),o},fo=at?function(i){return typeof i=="symbol"}:function(i){return Object(i)instanceof Tc},Jk=function(i,e,o){return i===wd&&Jk(Ti,e,o),ub(i),e=le(e,!0),ub(o),Fa(Me,e)?(o.enumerable?(Fa(i,Sc)&&i[Sc][e]&&(i[Sc][e]=!1),o=vd(o,{enumerable:ke(0,!1)})):(Fa(i,Sc)||Af(i,Sc,ke(1,{})),i[Sc][e]=!0),co(i,e,o)):Af(i,e,o)},Xu=function(i,e){ub(i);var o=Qc(e);return e=Ie(o).concat(go(o)),fg(e,function(c){cb&&!ho.call(o,c)||Jk(i,c,o[c])}),i},ho=function(i){i=le(i,!0);var e=kF.call(this,i);return!(this===wd&&Fa(Me,i)&&!Fa(Ti,i))&&(!(e||!Fa(this,i)||!Fa(Me,i)||Fa(this,Sc)&&this[Sc][i])||e)},Yu=function(i,e){if(i=Qc(i),e=le(e,!0),i!==wd||!Fa(Me,e)||Fa(Ti,e)){var o=Vu(i,e);return!o||!Fa(Me,e)||Fa(i,Sc)&&i[Sc][e]||(o.enumerable=!0),o}},Zu=function(i){i=Wu(Qc(i));var e=[];return fg(i,function(o){Fa(Me,o)||Fa(jh,o)||e.push(o)}),e},go=function(i){var e=i===wd;i=Wu(e?Ti:Qc(i));var o=[];return fg(i,function(c){!Fa(Me,c)||e&&!Fa(wd,c)||o.push(Me[c])}),o};if(pe||(Tc=function(){if(this instanceof Tc)throw TypeError("Symbol is not a constructor");var i=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,e=ih(i),o=function(c){this===wd&&o.call(Ti,c),Fa(this,Sc)&&Fa(this[Sc],e)&&(this[Sc][e]=!1),co(this,e,ke(1,c))};return cb&&bo&&co(wd,e,{configurable:!0,set:o}),eo(e,i)},Ob(Tc.prototype,"toString",function(){return Uu(this).tag}),Ob(Tc,"withoutSetter",function(i){return eo(ih(i),i)}),yi=ho,$b.f=Jk,pd.f=Yu,dg.f=Yn=Zu,Ai.f=go,Su.f=function(i){return eo(mb(i),i)},cb&&(Af(Tc.prototype,"description",{configurable:!0,get:function(){return Uu(this).description}}),Ob(wd,"propertyIsEnumerable",ho,{unsafe:!0}))),wa({global:!0,wrap:!0,forced:!pe,sham:!pe},{Symbol:Tc}),fg(Ie(lF),function(i){Ik(i)}),wa({target:"Symbol",stat:!0,forced:!pe},{for:function(i){if(i=String(i),Fa(Zn,i))return Zn[i];var e=Tc(i);return Zn[i]=e,$n[e]=i,e},keyFor:function(i){if(!fo(i))throw TypeError(i+" is not a symbol");if(Fa($n,i))return $n[i]},useSetter:function(){bo=!0},useSimple:function(){bo=!1}}),wa({target:"Object",stat:!0,forced:!pe,sham:!cb},{create:function(i,e){return e===void 0?vd(i):Xu(vd(i),e)},defineProperty:Jk,defineProperties:Xu,getOwnPropertyDescriptor:Yu}),wa({target:"Object",stat:!0,forced:!pe},{getOwnPropertyNames:Zu,getOwnPropertySymbols:go}),wa({target:"Object",stat:!0,forced:Ga(function(){Ai.f(1)})},{getOwnPropertySymbols:function(i){return Ai.f(Zb(i))}}),Si){var mF=!pe||Ga(function(){var i=Tc();return Si([i])!="[null]"||Si({a:i})!="{}"||Si(Object(i))!="{}"});wa({target:"JSON",stat:!0,forced:mF},{stringify:function(i,e,o){for(var c,_=[i],$=1;arguments.length>$;)_.push(arguments[$++]);if(c=e,(fb(e)||i!==void 0)&&!fo(i))return uf(e)||(e=function(_t,ga){if(typeof c=="function"&&(ga=c.call(this,_t,ga)),!fo(ga))return ga}),_[1]=e,Si.apply(null,_)}})}Tc.prototype[Tu]||ac(Tc.prototype,Tu,Tc.prototype.valueOf),Td(Tc,"Symbol"),jh[Sc]=!0;var nF=$b.f,Ne=na.Symbol;if(cb&&typeof Ne=="function"&&(!("description"in Ne.prototype)||Ne().description!==void 0)){var $u={},Ui=function(){var i=1>arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),e=this instanceof Ui?new Ne(i):i===void 0?Ne():Ne(i);return i===""&&($u[e]=!0),e};Vs(Ui,Ne);var io=Ui.prototype=Ne.prototype;io.constructor=Ui;var oF=io.toString,pF=String(Ne("test"))=="Symbol(test)",qF=/^Symbol\((.*)\)[^)]+$/;nF(io,"description",{configurable:!0,get:function(){var i=fb(this)?this.valueOf():this,e=oF.call(i);return Fa($u,i)?"":(i=pF?e.slice(7,-1):e.replace(qF,"$1"))===""?void 0:i}}),wa({global:!0,forced:!0},{Symbol:Ui})}Ik("toStringTag"),Td(na.JSON,"JSON",!0),Td(Math,"Math",!0),function(){function i(Tl,Cl){if(!(Tl instanceof Cl))throw new TypeError("Cannot call a class as a function")}function e(Tl,Cl){for(var Pl=0;Pl<Cl.length;Pl++){var Dl=Cl[Pl];Dl.enumerable=Dl.enumerable||!1,Dl.configurable=!0,"value"in Dl&&(Dl.writable=!0),Object.defineProperty(Tl,Dl.key,Dl)}}function o(Tl,Cl,Pl){return Cl&&e(Tl.prototype,Cl),Pl&&e(Tl,Pl),Tl}function c(Tl){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(Cl){return Cl.__proto__||Object.getPrototypeOf(Cl)})(Tl)}function _(Tl,Cl){return(_=Object.setPrototypeOf||function(Pl,Dl){return Pl.__proto__=Dl,Pl})(Tl,Cl)}function $(Tl){if(Tl===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Tl}function _t(Tl){var Cl=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var Pl=c(Tl);if(Cl){var Dl=c(this).constructor;Pl=Reflect.construct(Pl,arguments,Dl)}else Pl=Pl.apply(this,arguments);return Pl=!Pl||Ia(Pl)!=="object"&&typeof Pl!="function"?$(this):Pl}}function ga(Tl,Cl,Pl){return(ga=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(Dl,Jl,zl){for(;!Object.prototype.hasOwnProperty.call(Dl,Jl)&&(Dl=c(Dl))!==null;);if(Dl)return(Jl=Object.getOwnPropertyDescriptor(Dl,Jl)).get?Jl.get.call(zl):Jl.value})(Tl,Cl,Pl||Tl)}var _s=function(){function Tl(){i(this,Tl),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return o(Tl,[{key:"addEventListener",value:function(Cl,Pl,Dl){Cl in this.listeners||(this.listeners[Cl]=[]),this.listeners[Cl].push({callback:Pl,options:Dl})}},{key:"removeEventListener",value:function(Cl,Pl){if(Cl in this.listeners){for(var Dl=0,Jl=(Cl=this.listeners[Cl]).length;Dl<Jl;Dl++)if(Cl[Dl].callback===Pl){Cl.splice(Dl,1);break}}}},{key:"dispatchEvent",value:function(Cl){if(Cl.type in this.listeners){for(var Pl=this.listeners[Cl.type].slice(),Dl=0,Jl=Pl.length;Dl<Jl;Dl++){var zl=Pl[Dl];try{zl.callback.call(this,Cl)}catch(Bl){Promise.resolve().then(function(){throw Bl})}zl.options&&zl.options.once&&this.removeEventListener(Cl.type,zl.callback)}return!Cl.defaultPrevented}}}]),Tl}(),_c=function(Tl){function Cl(){i(this,Cl);var Dl=Pl.call(this);return Dl.listeners||_s.call($(Dl)),Object.defineProperty($(Dl),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty($(Dl),"onabort",{value:null,writable:!0,configurable:!0}),Dl}(function(Dl,Jl){if(typeof Jl!="function"&&Jl!==null)throw new TypeError("Super expression must either be null or a function");Dl.prototype=Object.create(Jl&&Jl.prototype,{constructor:{value:Dl,writable:!0,configurable:!0}}),Jl&&_(Dl,Jl)})(Cl,Tl);var Pl=_t(Cl);return o(Cl,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(Dl){Dl.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,Dl)),ga(c(Cl.prototype),"dispatchEvent",this).call(this,Dl)}}]),Cl}(_s),_l=function(){function Tl(){i(this,Tl),Object.defineProperty(this,"signal",{value:new _c,writable:!0,configurable:!0})}return o(Tl,[{key:"abort",value:function(){try{var Cl=new Event("abort")}catch{typeof document<"u"?document.createEvent?(Cl=document.createEvent("Event")).initEvent("abort",!1,!1):(Cl=document.createEventObject()).type="abort":Cl={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(Cl)}},{key:"toString",value:function(){return"[object AbortController]"}}]),Tl}();typeof Symbol<"u"&&Symbol.toStringTag&&(_l.prototype[Symbol.toStringTag]="AbortController",_c.prototype[Symbol.toStringTag]="AbortSignal"),function(Tl){if(Tl.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL){console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill");var Cl=!0}else Cl=typeof Tl.Request=="function"&&!Tl.Request.prototype.hasOwnProperty("signal")||!Tl.AbortController;Cl&&(Tl.AbortController=_l,Tl.AbortSignal=_c)}(typeof self<"u"?self:qb)}();var rF=Math.floor,sF=Math.log,tF=Math.LOG2E;wa({target:"Math",stat:!0},{clz32:function(i){return(i>>>=0)?31-rF(sF(i+.5)*tF):32}});var uF=Math.log,vF=Math.LN2,NA=Math.clz32||function(i){return 31-uF(i>>>0)/vF|0},Uf=String.fromCharCode,av={}.toString,jo=window.Uint8Array,ko=jo||Array,wF=av.call((window.ArrayBuffer||ko).prototype),lo;dr.prototype.decode=function(i){if(i=i&&i.buffer||i,av.call(i)!==wF)throw Error("Failed to execute 'decode' on 'TextDecoder': The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");for(var e="",o=0,c=0|(i=jo?new ko(i):i).length;o<c;o=o+32768|0)e+=Uf.apply(0,i[jo?"slice":"subarray"](o,o+32768|0));return e.replace(/[\xc0-\xff][\x80-\xbf]*/g,MA)},window.TextDecoder||(window.TextDecoder=dr),er.prototype.encode=function(i){for(var e=0|(i=i===void 0?"":(""+i).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,OA)).length,o=new ko(e),c=0;c<e;c=c+1|0)o[c]=i.charCodeAt(c);return o},window.TextEncoder||(window.TextEncoder=er),function(i){var e,o,c,_,$,_t,ga,_s,_c,_l,Tl,Cl,Pl;(o=e||(e={})).LOGIN="LOGIN",o.LOGIN_SUCCESS="LOGIN_SUCCESS",o.LOGIN_FAILURE="LOGIN_FAILURE",o.LOGIN_TIMEOUT="LOGIN_TIMEOUT",o.INTERRUPTED="INTERRUPTED",o.LOGOUT="LOGOUT",o.BANNED_BY_SERVER="BANNED_BY_SERVER",o.REMOTE_LOGIN="REMOTE_LOGIN",o.TOKEN_EXPIRED="TOKEN_EXPIRED",i.ConnectionChangeReason=e,function(Dl){Dl.DISCONNECTED="DISCONNECTED",Dl.CONNECTING="CONNECTING",Dl.CONNECTED="CONNECTED",Dl.RECONNECTING="RECONNECTING",Dl.ABORTED="ABORTED"}(c||(c={})),i.ConnectionState=c,function(Dl){Dl.IDLE="IDLE",Dl.SENT_TO_REMOTE="SENT_TO_REMOTE",Dl.RECEIVED_BY_REMOTE="RECEIVED_BY_REMOTE",Dl.ACCEPTED_BY_REMOTE="ACCEPTED_BY_REMOTE",Dl.REFUSED_BY_REMOTE="REFUSED_BY_REMOTE",Dl.CANCELED="CANCELED",Dl.FAILURE="FAILURE"}(_||(_={})),i.LocalInvitationState=_,function(Dl){Dl.INVITATION_RECEIVED="INVITATION_RECEIVED",Dl.ACCEPT_SENT_TO_LOCAL="ACCEPT_SENT_TO_LOCAL",Dl.REFUSED="REFUSED",Dl.ACCEPTED="ACCEPTED",Dl.CANCELED="CANCELED",Dl.FAILURE="FAILURE"}($||($={})),i.RemoteInvitationState=$,function(Dl){Dl.UNKNOWN="UNKNOWN",Dl.PEER_NO_RESPONSE="PEER_NO_RESPONSE",Dl.INVITATION_EXPIRE="INVITATION_EXPIRE",Dl.PEER_OFFLINE="PEER_OFFLINE",Dl.NOT_LOGGEDIN="NOT_LOGGEDIN"}(_t||(_t={})),i.LocalInvitationFailureReason=_t,function(Dl){Dl.UNKNOWN="UNKNOWN",Dl.PEER_OFFLINE="PEER_OFFLINE",Dl.ACCEPT_FAILURE="ACCEPT_FAILURE",Dl.INVITATION_EXPIRE="INVITATION_EXPIRE"}(ga||(ga={})),i.RemoteInvitationFailureReason=ga,function(Dl){Dl.ONLINE="ONLINE",Dl.UNREACHABLE="UNREACHABLE",Dl.OFFLINE="OFFLINE"}(_s||(_s={})),i.PeerOnlineState=_s,function(Dl){Dl.UNSUBSCRIBED="UNSUBSCRIBED",Dl.SUBSCRIBED="SUBSCRIBED"}(_c||(_c={})),i.subscribedState=_c,(_l||(_l={})).ONLINE_STATUS="ONLINE_STATUS",i.PeerSubscriptionOption=_l,function(Dl){Dl.TEXT="TEXT",Dl.RAW="RAW"}(Tl||(Tl={})),i.MessageType=Tl,function(Dl){Dl.CN="CN",Dl.NA="NA",Dl.EU="EU",Dl.AS="AS",Dl.JP="JP",Dl.IN="IN",Dl.GLOB="GLOB",Dl.OC="OC",Dl.SA="SA",Dl.AF="AF",Dl.OVS="OVS"}(Cl||(Cl={})),i.LegacyAreaCode=Cl,function(Dl){Dl.GLOBAL="GLOBAL",Dl.INDIA="INDIA",Dl.JAPAN="JAPAN",Dl.ASIA="ASIA",Dl.EUROPE="EUROPE",Dl.CHINA="CHINA",Dl.NORTH_AMERICA="NORTH_AMERICA"}(Pl||(Pl={})),i.AreaCode=Pl}(lo||(lo={}));var Oa=lo;wa({target:"Array",proto:!0},{includes:function(i){return Ss(this,i,1<arguments.length?arguments[1]:void 0)}}),wf("includes");var mo=function(i){if(gn(i))throw TypeError("The method doesn't accept regular expressions");return i},xF=mb("match"),no=function(i){var e=/./;try{"/./"[i](e)}catch{try{return e[xF]=!1,"/./"[i](e)}catch{}}return!1};wa({target:"String",proto:!0,forced:!no("includes")},{includes:function(i){return!!~String(Ec(this)).indexOf(mo(i),1<arguments.length?arguments[1]:void 0)}});var Yd={RECONNECTING_AP_INTERVAL:2500,RECONNECTING_AP_NUM:2,DISABLE_MESSAGE_COMPRESSION:!1,LOG_UPLOAD_INTERVAL:3e3,LOG_HANDLER:void 0,ENABLE_EDGE_AUTO_FALLBACK:!0};Ik("iterator"),Ik("asyncIterator");var oo=gg("forEach")?[].forEach:function(i){return fg(this,i,1<arguments.length?arguments[1]:void 0)},bv;for(bv in Tn){var cv=na[bv],Kk=cv&&cv.prototype;if(Kk&&Kk.forEach!==oo)try{ac(Kk,"forEach",oo)}catch{Kk.forEach=oo}}var yF=[].reverse,dv=[1,2];wa({target:"Array",proto:!0,forced:String(dv)===String(dv.reverse())},{reverse:function(){return uf(this)&&(this.length=this.length),yF.call(this)}});var W=kc(function(i){i=function(e){function o(Np,Dp,Qp){return Object.defineProperty(Np,Dp,{value:Qp,enumerable:!0,configurable:!0,writable:!0}),Np[Dp]}function c(Np,Dp,Qp,n0){return Dp=Object.create((Dp&&Dp.prototype instanceof $?Dp:$).prototype),n0=new Pl(n0||[]),Dp._invoke=function(Bp,c0,_f){var O0=Hp;return function(_0,__){if(O0===I0)throw Error("Generator is already running");if(O0===Cp){if(_0==="throw")throw __;return Jl()}for(_f.method=_0,_f.arg=__;;){if((_0=_f.delegate)&&(_0=_l(_0,_f))){if(_0===Jp)continue;return _0}if(_f.method==="next")_f.sent=_f._sent=_f.arg;else if(_f.method==="throw"){if(O0===Hp)throw O0=Cp,_f.arg;_f.dispatchException(_f.arg)}else _f.method==="return"&&_f.abrupt("return",_f.arg);if(O0=I0,(_0=_(Bp,c0,_f)).type==="normal"){if(O0=_f.done?Cp:_m,_0.arg===Jp)continue;return{value:_0.arg,done:_f.done}}_0.type==="throw"&&(O0=Cp,_f.method="throw",_f.arg=_0.arg)}}}(Np,Qp,n0),Dp}function _(Np,Dp,Qp){try{return{type:"normal",arg:Np.call(Dp,Qp)}}catch(n0){return{type:"throw",arg:n0}}}function $(){}function _t(){}function ga(){}function _s(Np){["next","throw","return"].forEach(function(Dp){o(Np,Dp,function(Qp){return this._invoke(Dp,Qp)})})}function _c(Np,Dp){function Qp(Bp,c0,_f,O0){if((Bp=_(Np[Bp],Np,c0)).type!=="throw"){var _0=Bp.arg;return(Bp=_0.value)&&Ia(Bp)==="object"&&Vl.call(Bp,"__await")?Dp.resolve(Bp.__await).then(function(__){Qp("next",__,_f,O0)},function(__){Qp("throw",__,_f,O0)}):Dp.resolve(Bp).then(function(__){_0.value=__,_f(_0)},function(__){return Qp("throw",__,_f,O0)})}O0(Bp.arg)}var n0;this._invoke=function(Bp,c0){function _f(){return new Dp(function(O0,_0){Qp(Bp,c0,O0,_0)})}return n0=n0?n0.then(_f,_f):_f()}}function _l(Np,Dp){var Qp=Np.iterator[Dp.method];if(Qp===zl){if(Dp.delegate=null,Dp.method==="throw"){if(Np.iterator.return&&(Dp.method="return",Dp.arg=zl,_l(Np,Dp),Dp.method==="throw"))return Jp;Dp.method="throw",Dp.arg=new TypeError("The iterator does not provide a 'throw' method")}return Jp}return(Qp=_(Qp,Np.iterator,Dp.arg)).type==="throw"?(Dp.method="throw",Dp.arg=Qp.arg,Dp.delegate=null,Jp):(Qp=Qp.arg)?Qp.done?(Dp[Np.resultName]=Qp.value,Dp.next=Np.nextLoc,Dp.method!=="return"&&(Dp.method="next",Dp.arg=zl),Dp.delegate=null,Jp):Qp:(Dp.method="throw",Dp.arg=new TypeError("iterator result is not an object"),Dp.delegate=null,Jp)}function Tl(Np){var Dp={tryLoc:Np[0]};1 in Np&&(Dp.catchLoc=Np[1]),2 in Np&&(Dp.finallyLoc=Np[2],Dp.afterLoc=Np[3]),this.tryEntries.push(Dp)}function Cl(Np){var Dp=Np.completion||{};Dp.type="normal",delete Dp.arg,Np.completion=Dp}function Pl(Np){this.tryEntries=[{tryLoc:"root"}],Np.forEach(Tl,this),this.reset(!0)}function Dl(Np){if(Np){var Dp=Np[Sp];if(Dp)return Dp.call(Np);if(typeof Np.next=="function")return Np;if(!isNaN(Np.length)){var Qp=-1;return(Dp=function n0(){for(;++Qp<Np.length;)if(Vl.call(Np,Qp))return n0.value=Np[Qp],n0.done=!1,n0;return n0.value=zl,n0.done=!0,n0}).next=Dp}}return{next:Jl}}function Jl(){return{value:zl,done:!0}}var zl,Bl=Object.prototype,Vl=Bl.hasOwnProperty,_d=typeof Symbol=="function"?Symbol:{},Sp=_d.iterator||"@@iterator",Up=_d.asyncIterator||"@@asyncIterator",Kp=_d.toStringTag||"@@toStringTag";try{o({},"")}catch{o=function(Dp,Qp,n0){return Dp[Qp]=n0}}e.wrap=c;var Hp="suspendedStart",_m="suspendedYield",I0="executing",Cp="completed",Jp={};o(_d={},Sp,function(){return this});var Zp=Object.getPrototypeOf;(Zp=Zp&&Zp(Zp(Dl([]))))&&Zp!==Bl&&Vl.call(Zp,Sp)&&(_d=Zp);var i0=ga.prototype=$.prototype=Object.create(_d);return _t.prototype=ga,o(i0,"constructor",ga),o(ga,"constructor",_t),_t.displayName=o(ga,Kp,"GeneratorFunction"),e.isGeneratorFunction=function(Np){return!!(Np=typeof Np=="function"&&Np.constructor)&&(Np===_t||(Np.displayName||Np.name)==="GeneratorFunction")},e.mark=function(Np){return Object.setPrototypeOf?Object.setPrototypeOf(Np,ga):(Np.__proto__=ga,o(Np,Kp,"GeneratorFunction")),Np.prototype=Object.create(i0),Np},e.awrap=function(Np){return{__await:Np}},_s(_c.prototype),o(_c.prototype,Up,function(){return this}),e.AsyncIterator=_c,e.async=function(Np,Dp,Qp,n0,Bp){Bp===void 0&&(Bp=Promise);var c0=new _c(c(Np,Dp,Qp,n0),Bp);return e.isGeneratorFunction(Dp)?c0:c0.next().then(function(_f){return _f.done?_f.value:c0.next()})},_s(i0),o(i0,Kp,"Generator"),o(i0,Sp,function(){return this}),o(i0,"toString",function(){return"[object Generator]"}),e.keys=function(Np){var Dp,Qp=[];for(Dp in Np)Qp.push(Dp);return Qp.reverse(),function n0(){for(;Qp.length;){var Bp=Qp.pop();if(Bp in Np)return n0.value=Bp,n0.done=!1,n0}return n0.done=!0,n0}},e.values=Dl,Pl.prototype={constructor:Pl,reset:function(Np){if(this.next=this.prev=0,this.sent=this._sent=zl,this.done=!1,this.delegate=null,this.method="next",this.arg=zl,this.tryEntries.forEach(Cl),!Np)for(var Dp in this)Dp.charAt(0)==="t"&&Vl.call(this,Dp)&&!isNaN(+Dp.slice(1))&&(this[Dp]=zl)},stop:function(){this.done=!0;var Np=this.tryEntries[0].completion;if(Np.type==="throw")throw Np.arg;return this.rval},dispatchException:function(Np){function Dp(_0,__){return c0.type="throw",c0.arg=Np,Qp.next=_0,__&&(Qp.method="next",Qp.arg=zl),!!__}if(this.done)throw Np;for(var Qp=this,n0=this.tryEntries.length-1;0<=n0;--n0){var Bp=this.tryEntries[n0],c0=Bp.completion;if(Bp.tryLoc==="root")return Dp("end");if(Bp.tryLoc<=this.prev){var _f=Vl.call(Bp,"catchLoc"),O0=Vl.call(Bp,"finallyLoc");if(_f&&O0){if(this.prev<Bp.catchLoc)return Dp(Bp.catchLoc,!0);if(this.prev<Bp.finallyLoc)return Dp(Bp.finallyLoc)}else if(_f){if(this.prev<Bp.catchLoc)return Dp(Bp.catchLoc,!0)}else{if(!O0)throw Error("try statement without catch or finally");if(this.prev<Bp.finallyLoc)return Dp(Bp.finallyLoc)}}}},abrupt:function(Np,Dp){for(var Qp=this.tryEntries.length-1;0<=Qp;--Qp){var n0=this.tryEntries[Qp];if(n0.tryLoc<=this.prev&&Vl.call(n0,"finallyLoc")&&this.prev<n0.finallyLoc){var Bp=n0;break}}return Bp&&(Np==="break"||Np==="continue")&&Bp.tryLoc<=Dp&&Dp<=Bp.finallyLoc&&(Bp=null),(Qp=Bp?Bp.completion:{}).type=Np,Qp.arg=Dp,Bp?(this.method="next",this.next=Bp.finallyLoc,Jp):this.complete(Qp)},complete:function(Np,Dp){if(Np.type==="throw")throw Np.arg;return Np.type==="break"||Np.type==="continue"?this.next=Np.arg:Np.type==="return"?(this.rval=this.arg=Np.arg,this.method="return",this.next="end"):Np.type==="normal"&&Dp&&(this.next=Dp),Jp},finish:function(Np){for(var Dp=this.tryEntries.length-1;0<=Dp;--Dp){var Qp=this.tryEntries[Dp];if(Qp.finallyLoc===Np)return this.complete(Qp.completion,Qp.afterLoc),Cl(Qp),Jp}},catch:function(Np){for(var Dp=this.tryEntries.length-1;0<=Dp;--Dp){var Qp=this.tryEntries[Dp];if(Qp.tryLoc===Np){if((Np=Qp.completion).type==="throw"){var n0=Np.arg;Cl(Qp)}return n0}}throw Error("illegal catch attempt")},delegateYield:function(Np,Dp,Qp){return this.delegate={iterator:Dl(Np),resultName:Dp,nextLoc:Qp},this.method==="next"&&(this.arg=zl),Jp}},e}(i.exports);try{regeneratorRuntime=i}catch{(typeof globalThis>"u"?"undefined":Ia(globalThis))==="object"?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}}),ev=!Ga(function(){return Object.isExtensible(Object.preventExtensions({}))}),po=kc(function(i){var e=$b.f,o=ih("meta"),c=0,_=Object.isExtensible||function(){return!0},$=function(ga){e(ga,o,{value:{objectID:"O"+ ++c,weakData:{}}})},_t=i.exports={REQUIRED:!1,fastKey:function(ga,_s){if(!fb(ga))return typeof ga=="symbol"?ga:(typeof ga=="string"?"S":"P")+ga;if(!Fa(ga,o)){if(!_(ga))return"F";if(!_s)return"E";$(ga)}return ga[o].objectID},getWeakData:function(ga,_s){if(!Fa(ga,o)){if(!_(ga))return!0;if(!_s)return!1;$(ga)}return ga[o].weakData},onFreeze:function(ga){return ev&&_t.REQUIRED&&_(ga)&&!Fa(ga,o)&&$(ga),ga}};jh[o]=!0}),fv=function(i,e,o){var c=i.indexOf("Map")!==-1,_=i.indexOf("Weak")!==-1,$=c?"set":"add",_t=na[i],ga=_t&&_t.prototype,_s=_t,_c={},_l=function(zl){var Bl=ga[zl];Ob(ga,zl,zl=="add"?function(Vl){return Bl.call(this,Vl===0?0:Vl),this}:zl=="delete"?function(Vl){return!(_&&!fb(Vl))&&Bl.call(this,Vl===0?0:Vl)}:zl=="get"?function(Vl){return _&&!fb(Vl)?void 0:Bl.call(this,Vl===0?0:Vl)}:zl=="has"?function(Vl){return!(_&&!fb(Vl))&&Bl.call(this,Vl===0?0:Vl)}:function(Vl,_d){return Bl.call(this,Vl===0?0:Vl,_d),this})};if(ne(i,typeof _t!="function"||!(_||ga.forEach&&!Ga(function(){new _t().entries().next()}))))_s=o.getConstructor(e,i,c,$),po.REQUIRED=!0;else if(ne(i,!0)){var Tl=new _s,Cl=Tl[$](_?{}:-0,1)!=Tl,Pl=Ga(function(){Tl.has(1)}),Dl=mk(function(zl){new _t(zl)}),Jl=!_&&Ga(function(){for(var zl=new _t,Bl=5;Bl--;)zl[$](Bl,Bl);return!zl.has(-0)});Dl||((_s=e(function(zl,Bl){return Ud(zl,_s,i),zl=Ek(new _t,zl,_s),Bl!=null&&rk(Bl,zl[$],{that:zl,AS_ENTRIES:c}),zl})).prototype=ga,ga.constructor=_s),(Pl||Jl)&&(_l("delete"),_l("has"),c&&_l("get")),(Jl||Cl)&&_l($),_&&ga.clear&&delete ga.clear}return _c[i]=_s,wa({global:!0,forced:_s!=_t},_c),Td(_s,i),_||o.setStrong(_s,i,c),_s},zF=$b.f,gv=po.fastKey,hv=Sb.set,qo=Sb.getterFor,iv={getConstructor:function(i,e,o,c){var _=i(function(_s,_c){Ud(_s,_,e),hv(_s,{type:e,index:vd(null),first:void 0,last:void 0,size:0}),cb||(_s.size=0),_c!=null&&rk(_c,_s[c],{that:_s,AS_ENTRIES:o})}),$=qo(e),_t=function(_s,_c,_l){var Tl,Cl=$(_s),Pl=ga(_s,_c);return Pl?Pl.value=_l:(Cl.last=Pl={index:Tl=gv(_c,!0),key:_c,value:_l,previous:_c=Cl.last,next:void 0,removed:!1},Cl.first||(Cl.first=Pl),_c&&(_c.next=Pl),cb?Cl.size++:_s.size++,Tl!=="F"&&(Cl.index[Tl]=Pl)),_s},ga=function(_s,_c){_s=$(_s);var _l=gv(_c);if(_l!=="F")return _s.index[_l];for(_s=_s.first;_s;_s=_s.next)if(_s.key==_c)return _s};return qh(_.prototype,{clear:function(){for(var _s=$(this),_c=_s.index,_l=_s.first;_l;)_l.removed=!0,_l.previous&&(_l.previous=_l.previous.next=void 0),delete _c[_l.index],_l=_l.next;_s.first=_s.last=void 0,cb?_s.size=0:this.size=0},delete:function(_s){var _c=$(this);if(_s=ga(this,_s)){var _l=_s.next,Tl=_s.previous;delete _c.index[_s.index],_s.removed=!0,Tl&&(Tl.next=_l),_l&&(_l.previous=Tl),_c.first==_s&&(_c.first=_l),_c.last==_s&&(_c.last=Tl),cb?_c.size--:this.size--}return!!_s},forEach:function(_s){for(var _c,_l=$(this),Tl=tf(_s,1<arguments.length?arguments[1]:void 0,3);_c=_c?_c.next:_l.first;)for(Tl(_c.value,_c.key,this);_c&&_c.removed;)_c=_c.previous},has:function(_s){return!!ga(this,_s)}}),qh(_.prototype,o?{get:function(_s){return(_s=ga(this,_s))&&_s.value},set:function(_s,_c){return _t(this,_s===0?0:_s,_c)}}:{add:function(_s){return _t(this,_s=_s===0?0:_s,_s)}}),cb&&zF(_.prototype,"size",{get:function(){return $(this).size}}),_},setStrong:function(i,e,o){var c=e+" Iterator",_=qo(e),$=qo(c);rn(i,e,function(_t,ga){hv(this,{type:c,target:_t,state:_(_t),kind:ga,last:void 0})},function(){for(var _t=$(this),ga=_t.kind,_s=_t.last;_s&&_s.removed;)_s=_s.previous;return _t.target&&(_t.last=_s=_s?_s.next:_t.state.first)?ga=="keys"?{value:_s.key,done:!1}:ga=="values"?{value:_s.value,done:!1}:{value:[_s.key,_s.value],done:!1}:(_t.target=void 0,{value:void 0,done:!0})},o?"entries":"values",!o,!0),Ii(e)}};fv("Set",function(i){return function(){return i(this,arguments.length?arguments[0]:void 0)}},iv);var AF=yi,jv=function(i){return function(e){e=Qc(e);for(var o,c=Ie(e),_=c.length,$=0,_t=[];_>$;)o=c[$++],cb&&!AF.call(e,o)||_t.push(i?[o,e[o]]:e[o]);return _t}},BF=jv(!0),CF=jv(!1);wa({target:"Object",stat:!0},{values:function(i){return CF(i)}});var ro=me("Reflect","apply"),DF=Function.apply,EF=!Ga(function(){ro(function(){})});wa({target:"Reflect",stat:!0,forced:EF},{apply:function(i,e,o){return Rc(i),ub(o),ro?ro(i,e,o):DF.call(i,e,o)}}),wa({target:"Reflect",stat:!0},{ownKeys:Us});var kv=mb("isConcatSpreadable"),FF=51<=oe||!Ga(function(){var i=[];return i[kv]=!1,i.concat()[0]!==i}),GF=Fi("concat");wa({target:"Array",proto:!0,forced:!FF||!GF},{concat:function(i){var e,o=Zb(this),c=Ei(o,0),_=0,$=-1;for(e=arguments.length;$<e;$++){var _t=$===-1?o:arguments[$],ga=_t;if(fb(ga)){var _s=ga[kv];ga=_s!==void 0?!!_s:uf(ga)}else ga=!1;if(ga){if(9007199254740991<_+(_s=xb(_t.length)))throw TypeError("Maximum allowed index exceeded");for(ga=0;ga<_s;ga++,_++)ga in _t&&oh(c,_,_t[ga])}else{if(9007199254740991<=_)throw TypeError("Maximum allowed index exceeded");oh(c,_++,_t)}}return c.length=_,c}});var HF=Yn,IF=Ga(function(){return!Object.getOwnPropertyNames(1)});wa({target:"Object",stat:!0,forced:IF},{getOwnPropertyNames:HF});var JF=dg.f,KF=pd.f,LF=$b.f,Bf=na.Number,Lk=Bf.prototype,MF=Qd(vd(Lk))=="Number",lv=function(i){var e,o=le(i,!1);if(typeof o=="string"&&2<o.length){if((i=(o=kk(o)).charCodeAt(0))===43||i===45){if((i=o.charCodeAt(2))===88||i===120)return NaN}else if(i===48){switch(o.charCodeAt(1)){case 66:case 98:i=2;var c=49;break;case 79:case 111:i=8,c=55;break;default:return+o}var _=(o=o.slice(2)).length;for(e=0;e<_;e++){var $=o.charCodeAt(e);if(48>$||$>c)return NaN}return parseInt(o,i)}}return+o};if(ne("Number",!Bf(" 0o1")||!Bf("0b1")||Bf("+0x1"))){for(var mg=function(i){var e=1>arguments.length?0:i,o=this;return o instanceof mg&&(MF?Ga(function(){Lk.valueOf.call(o)}):Qd(o)!="Number")?Ek(new Bf(lv(e)),o,mg):lv(e)},mv=cb?JF(Bf):"MAX_VALUE MIN_VALUE NaN NEGATIVE_INFINITY POSITIVE_INFINITY EPSILON isFinite isInteger isNaN isSafeInteger MAX_SAFE_INTEGER MIN_SAFE_INTEGER parseFloat parseInt isInteger fromString range".split(" "),so=0,Mk;mv.length>so;so++)Fa(Bf,Mk=mv[so])&&!Fa(mg,Mk)&&LF(mg,Mk,KF(Bf,Mk));mg.prototype=Lk,Lk.constructor=mg,Ob(na,"Number",mg)}var yh=(typeof Reflect>"u"?"undefined":Ia(Reflect))==="object"?Reflect:null,nv=yh&&typeof yh.apply=="function"?yh.apply:function(i,e,o){return Function.prototype.apply.call(i,e,o)},NF=yh&&typeof yh.ownKeys=="function"?yh.ownKeys:Object.getOwnPropertySymbols?function(i){return Object.getOwnPropertyNames(i).concat(Object.getOwnPropertySymbols(i))}:function(i){return Object.getOwnPropertyNames(i)},ov=Number.isNaN||function(i){return i!=i};kb.EventEmitter=kb,kb.prototype._events=void 0,kb.prototype._eventsCount=0,kb.prototype._maxListeners=void 0;var pv=10;Object.defineProperty(kb,"defaultMaxListeners",{enumerable:!0,get:function(){return pv},set:function(i){if(typeof i!="number"||0>i||ov(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");pv=i}}),kb.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},kb.prototype.setMaxListeners=function(i){if(typeof i!="number"||0>i||ov(i))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+i+".");return this._maxListeners=i,this},kb.prototype.getMaxListeners=function(){return this._maxListeners===void 0?kb.defaultMaxListeners:this._maxListeners},kb.prototype.emit=function(i){for(var e=[],o=1;o<arguments.length;o++)e.push(arguments[o]);o=i==="error";var c=this._events;if(c!==void 0)o=o&&c.error===void 0;else if(!o)return!1;if(o){var _;throw 0<e.length&&(_=e[0]),_ instanceof Error?_:((e=Error("Unhandled error."+(_?" ("+_.message+")":""))).context=_,e)}if((o=c[i])===void 0)return!1;if(typeof o=="function")nv(o,this,e);else for(c=ir(o,_=o.length),o=0;o<_;++o)nv(c[o],this,e);return!0},kb.prototype.addListener=function(i,e){return fr(this,i,e,!1)},kb.prototype.on=kb.prototype.addListener,kb.prototype.prependListener=function(i,e){return fr(this,i,e,!0)},kb.prototype.once=function(i,e){return Cj(e),this.on(i,gr(this,i,e)),this},kb.prototype.prependOnceListener=function(i,e){return Cj(e),this.prependListener(i,gr(this,i,e)),this},kb.prototype.removeListener=function(i,e){var o;Cj(e);var c=this._events;if(c===void 0)return this;var _=c[i];if(_===void 0)return this;if(_===e||_.listener===e)--this._eventsCount==0?this._events=Object.create(null):(delete c[i],c.removeListener&&this.emit("removeListener",i,_.listener||e));else if(typeof _!="function"){var $=-1;for(o=_.length-1;0<=o;o--)if(_[o]===e||_[o].listener===e){var _t=_[o].listener;$=o;break}if(0>$)return this;if($===0)_.shift();else{for(;$+1<_.length;$++)_[$]=_[$+1];_.pop()}_.length===1&&(c[i]=_[0]),c.removeListener!==void 0&&this.emit("removeListener",i,_t||e)}return this},kb.prototype.off=kb.prototype.removeListener,kb.prototype.removeAllListeners=function(i){var e=this._events;if(e===void 0)return this;if(e.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):e[i]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete e[i]),this;if(arguments.length===0){var o=Object.keys(e);for(e=0;e<o.length;++e){var c=o[e];c!=="removeListener"&&this.removeAllListeners(c)}return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(o=e[i])=="function")this.removeListener(i,o);else if(o!==void 0)for(e=o.length-1;0<=e;e--)this.removeListener(i,o[e]);return this},kb.prototype.listeners=function(i){return hr(this,i,!0)},kb.prototype.rawListeners=function(i){return hr(this,i,!1)},kb.listenerCount=function(i,e){return typeof i.listenerCount=="function"?i.listenerCount(e):jr.call(i,e)},kb.prototype.listenerCount=jr,kb.prototype.eventNames=function(){return 0<this._eventsCount?NF(this._events):[]},kb.once=function(i,e){return new Promise(function(o,c){function _(_t){i.removeListener(e,$),c(_t)}function $(){typeof i.removeListener=="function"&&i.removeListener("error",_),o([].slice.call(arguments))}kr(i,e,$,{once:!0}),e!=="error"&&QA(i,_,{once:!0})})};var zh=Object.assign,qv=Object.defineProperty,Vi=!zh||Ga(function(){if(cb&&zh({b:1},zh(qv({},"a",{enumerable:!0,get:function(){qv(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var i={},e={},o=Symbol();return i[o]=7,"abcdefghijklmnopqrst".split("").forEach(function(c){e[c]=c}),zh({},i)[o]!=7||Ie(zh({},e)).join("")!="abcdefghijklmnopqrst"})?function(i,e){for(var o=Zb(i),c=arguments.length,_=1,$=Ai.f,_t=yi;c>_;)for(var ga,_s=zi(arguments[_++]),_c=$?Ie(_s).concat($(_s)):Ie(_s),_l=_c.length,Tl=0;_l>Tl;)ga=_c[Tl++],(!cb||_t.call(_s,ga))&&(o[ga]=_s[ga]);return o}:zh;wa({target:"Object",stat:!0,forced:Object.assign!==Vi},{assign:Vi}),fv("Map",function(i){return function(){return i(this,arguments.length?arguments[0]:void 0)}},iv);var OF=Math.log,PF=Math.LN2;wa({target:"Math",stat:!0},{log2:function(i){return OF(i)/PF}});var QF=$b.f,RF=dg.f,SF=Sb.enforce,TF=mb("match"),te=na.RegExp,to=te.prototype,Wi=/a/g,uo=/a/g,vo=new te(Wi)!==Wi;if(cb&&ne("RegExp",!vo||Sd||Ga(function(){return uo[TF]=!1,te(Wi)!=Wi||te(uo)==uo||te(Wi,"i")!="/a/i"}))){for(var Oe=function(i,e){var o,c=this instanceof Oe,_=gn(i),$=e===void 0;return!c&&_&&i.constructor===Oe&&$||(vo?_&&!$&&(i=i.source):i instanceof Oe&&($&&(e=hk.call(i)),i=i.source),Sd&&(o=!!e&&-1<e.indexOf("y"))&&(e=e.replace(/y/g,"")),i=Ek(vo?new te(i,e):te(i,e),c?this:to,Oe),Sd&&o&&(SF(i).sticky=!0)),i},UF=function(i){i in Oe||QF(Oe,i,{configurable:!0,get:function(){return te[i]},set:function(e){te[i]=e}})},rv=RF(te),sv=0;rv.length>sv;)UF(rv[sv++]);to.constructor=Oe,Oe.prototype=to,Ob(na,"RegExp",Oe)}Ii("RegExp"),Ri("Float32",function(i){return function(e,o,c){return i(this,e,o,c)}}),Ri("Float64",function(i){return function(e,o,c){return i(this,e,o,c)}}),Ri("Uint32",function(i){return function(e,o,c){return i(this,e,o,c)}}),Ri("Uint16",function(i){return function(e,o,c){return i(this,e,o,c)}});var wo=function(i,e){return i===e?0:i==null?e==null?0:-1:e==null?i==null?0:1:typeof i.compare=="function"?i.compare(e):typeof e.compare=="function"?-e.compare(i):i<e?-1:i>e?1:0},xo=[],tv=xo.sort,VF=Ga(function(){xo.sort(void 0)}),WF=Ga(function(){xo.sort(null)}),XF=gg("sort");wa({target:"Array",proto:!0,forced:VF||!WF||!XF},{sort:function(i){return i===void 0?tv.call(Zb(this)):tv.call(Zb(this),Rc(i))}});var uv=Object.getPrototypeOf({}),Xi=function(i,e){var o;return i===e||(i==null?i==e:Ia(i.equiv)==="function"?i.equiv(e):e==null?i==e:Ia(e.equiv)==="function"?e.equiv(i):Ia(i)!=="string"&&Ia(e)!=="string"&&((o=Object.getPrototypeOf(i))!=null&&o!==uv||(o=Object.getPrototypeOf(e))!=null&&o!==uv?Ia(i)!=="function"&&i.length!==void 0&&Ia(e)!=="function"&&e.length!==void 0?ZF(i,e):i instanceof Set&&e instanceof Set?$F(i,e):i instanceof Map&&e instanceof Map?aG(i,e):i instanceof Date&&e instanceof Date?i.getTime()===e.getTime():i instanceof RegExp&&e instanceof RegExp?i.toString()===e.toString():i!=i&&e!=e:YF(i,e)))},ZF=function(i,e){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xi,c=i.length;if(c===e.length)for(;0<=--c&&o(i[c],e[c]););return 0>c},$F=function(i,e){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xi;return i.size===e.size&&o(ra(i.keys()).sort(),ra(e.keys()).sort())},aG=function(i,e){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xi;return i.size===e.size&&o(ra(i).sort(),ra(e).sort())},YF=function(i,e){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xi;if(Object.keys(i).length!==Object.keys(e).length)return!1;for(var c in i)if(!e.hasOwnProperty(c)||!o(i[c],e[c]))return!1;return!0},vv=function(i){var e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:function(o){return o!==void 0?": "+o:""};return function(o){function c($){return ab(this,c),_.call(this,i($)+e($))}nb(c,o);var _=ob(c);return c}(di(Error))},bG=vv(function(){return"illegal argument(s)"}),Nk=function(i){throw new bG(i)},yo=vv(function(){return"index out of bounds"}),wv=1/4294967295,cG=function(){function i(){ab(this,i)}return Qb(i,[{key:"float",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return this.int()*wv*e}},{key:"norm",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(this.int()*wv-.5)*e}},{key:"minmax",value:function(e,o){return this.float()*(o-e)+e}}]),i}(),zo=Math.random,dG=new(function(i){function e(){return ab(this,e),o.apply(this,arguments)}nb(e,i);var o=ob(e);return Qb(e,[{key:"int",value:function(){return 4294967296*zo()>>>0}},{key:"float",value:function(){var c=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return zo()*c}},{key:"norm",value:function(){var c=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(zo()-.5)*c}}]),e}(cG)),hm=Symbol(),nr=function(){},eG=po.onFreeze,Ao=Object.freeze,fG=Ga(function(){Ao(1)});wa({target:"Object",stat:!0,forced:fG,sham:!ev},{freeze:function(i){return Ao&&fb(i)?Ao(eG(i)):i}});var gG=gg("reduce"),hG=!qe&&79<oe&&83>oe;wa({target:"Array",proto:!0,forced:!gG||hG},{reduce:function(i){return Bu(this,i,arguments.length,1<arguments.length?arguments[1]:void 0)}});var mr=function(i){return i!=null&&typeof i.xform=="function"?i.xform():i},Dj=function(){function i(e){ab(this,i),this.value=e}return Qb(i,[{key:"deref",value:function(){return this.value}}]),i}(),im=function(i){return i instanceof Dj?i.deref():i},SA=function(i,e){return[i,function(o){return o},e]},iG=W.mark(function(i,e){var o,c,_,$,_t,ga;return W.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:o=mr(i)(RA()),c=o[1],_=o[2],$=0;case 4:if(!($<e.length)){_s.next=15;break}if(_t=e[$],!((ga=_([],_t))instanceof Dj)){_s.next=10;break}return _s.delegateYield(im(c(ga.deref())),"t0",9);case 9:return _s.abrupt("return");case 10:if(!ga.length){_s.next=12;break}return _s.delegateYield(ga,"t1",12);case 12:$++,_s.next=4;break;case 15:return _s.delegateYield(im(c([])),"t2",16);case 16:case"end":return _s.stop()}},iG)}),TA=W.mark(lr),UA=function(i,e){return[i[0],i[1],e]},xv=!0;"findIndex"in[]&&Array(1).findIndex(function(){xv=!1}),wa({target:"Array",proto:!0,forced:xv},{findIndex:function(i){return lt(this,i,1<arguments.length?arguments[1]:void 0)}}),wf("findIndex"),wa({target:"Array",proto:!0},{fill:In}),wf("fill");var jG=function(){function i(e){ab(this,i),this._length=0,e&&this.into(e)}return Qb(i,[{key:"length",get:function(){return this._length}},{key:"copy",value:function(){return new i(this)}},{key:"empty",value:function(){return new i}},{key:"clear",value:function(){this.release()}},{key:"release",value:function(){for(var e,o=this.head;o;)e=o.next,delete o.value,delete o.prev,delete o.next,o=e;return delete this.head,delete this.tail,this._length=0,!0}},{key:"compare",value:function(e){var o=this._length;if(o<e._length)return-1;if(o>e._length)return 1;if(o===0)return 0;o=this.head,e=e.head;for(var c=0;o&&c==0;)c=wo(o.value,e.value),o=o.next,e=e.next;return c}},{key:"equiv",value:function(e){if(!(e instanceof i||e!=null&&typeof e!="function"&&e.length!==void 0)||this._length!==e.length)return!1;if(!this._length||this===e)return!0;for(var o=this.head,c=0;c<e.length;c++){if(!Xi(o.value,e[c]))return!1;o=o.next}return!0}},{key:Symbol.iterator,value:W.mark(function e(){var o;return W.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:o=this.head;case 1:if(!o){c.next=7;break}return c.next=4,o.value;case 4:o=o.next,c.next=1;break;case 7:case"end":return c.stop()}},e,this)})},{key:"seq",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;if(!(e>=o||0>e)){e=this.nthCell(e);var c=this.nthCell(o-1);return o=function _($){return{first:function(){return $.value},next:function(){return $!==c&&$.next?_($.next):void 0}}},e?o(e):void 0}}},{key:"cycle",value:W.mark(function e(){return W.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.delegateYield(this,"t0",2);case 2:o.next=0;break;case 4:case"end":return o.stop()}},e,this)})},{key:"$reduce",value:function(e,o){for(var c=this.head;c&&!(o instanceof Dj);)o=e(o,c.value),c=c.next;return o}},{key:"drop",value:function(){var e=this.head;if(e)return(this.head=e.next)?delete this.head.prev:delete this.tail,this._length--,e.value}},{key:"cons",value:function(e){return e={value:e,next:this.head},this.head?this.head.prev=e:this.tail=e,this.head=e,this._length++,this}},{key:"insertBefore",value:function(e,o){return e||Nk("cell is undefined"),o={value:o,next:e,prev:e.prev},e.prev?e.prev.next=o:this.head=o,e.prev=o,this._length++,this}},{key:"insertAfter",value:function(e,o){return e||Nk("cell is undefined"),o={value:o,next:e.next,prev:e},e.next?e.next.prev=o:this.tail=o,e.next=o,this._length++,this}},{key:"insertBeforeNth",value:function(e,o){if(0>e&&(e+=this._length),0>=e)return this.cons(o);if(0>e||e>=this._length)throw new yo(e);return this.insertBefore(this.nthCellUnsafe(e),o)}},{key:"insertAfterNth",value:function(e,o){if(0>e&&(e+=this._length),e>=this._length-1)return this.push(o);if(0>e||e>=this._length)throw new yo(e);return this.insertAfter(this.nthCellUnsafe(e),o)}},{key:"insertSorted",value:function(e,o){o=o||wo;for(var c=this.head;c;){if(0>=o(e,c.value))return this.insertBefore(c,e);c=c.next}return this.push(e)}},{key:"find",value:function(e){for(var o=this.head;o;){if(o.value===e)return o;o=o.next}}},{key:"findWith",value:function(e){for(var o=this.head;o;){if(e(o.value))return o;o=o.next}}},{key:"concat",value:function(){for(var e=this.copy(),o=arguments.length,c=Array(o),_=0;_<o;_++)c[_]=arguments[_];for(o=0;o<c.length;o++)e.into(c[o]);return e}},{key:"into",value:function(e){for(var o=0;o<e.length;o++)this.push(e[o])}},{key:"slice",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;e=0>e?e+this._length:e,o=0>o?o+this._length:o,(0>e||0>o)&&Nk("invalid indices: ${from} / ${to}");for(var c=new i,_=this.nthCell(e);_&&++e<=o;)c.push(_.value),_=_.next;return c}},{key:"splice",value:function(e){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,c=2<arguments.length?arguments[2]:void 0;if(typeof e=="number"){if(0>e&&(e+=this._length),0>e||e>=this._length)throw new yo(e);var _=this.nthCellUnsafe(e)}else _=e;var $=new i;if(0<o)for(;_&&0<o--;)this.remove(_),$.push(_.value),_=_.next;else _&&(_=_.next);if(c)if(_)for(o=0;o<c.length;o++)this.insertBefore(_,c[o]);else for(_=0;_<c.length;_++)this.push(c[_]);return $}},{key:"remove",value:function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,this._length--,this}},{key:"swap",value:function(e,o){if(e!==o){var c=e.value;e.value=o.value,o.value=c}return this}},{key:"push",value:function(e){return this.tail?(e={value:e,prev:this.tail},this.tail=this.tail.next=e,this._length++,this):this.cons(e)}},{key:"pop",value:function(){var e=this.tail;if(e)return(this.tail=e.prev)?delete this.tail.next:delete this.head,this._length--,e.value}},{key:"first",value:function(){return this.head&&this.head.value}},{key:"peek",value:function(){return this.tail&&this.tail.value}},{key:"setHead",value:function(e){return this.head?(this.head.value=e,this):this.cons(e)}},{key:"setTail",value:function(e){return this.tail?(this.tail.value=e,this):this.push(e)}},{key:"setNth",value:function(e,o){var c=this.nthCell(e);return!c&&Nk("index out of bounds: ".concat(e)),c.value=o,this}},{key:"nth",value:function(e,o){return(e=this.nthCell(e))?e.value:o}},{key:"nthCell",value:function(e){if(0>e&&(e+=this._length),!(0>e||e>=this._length))return this.nthCellUnsafe(e)}},{key:"rotateLeft",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:return this.push(this.drop())}}},{key:"rotateRight",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:var e=this.peek();return this.pop(),this.cons(e)}}},{key:"map",value:function(e){for(var o=new i,c=this.head;c;)o.push(e(c.value)),c=c.next;return o}},{key:"filter",value:function(e){for(var o=new i,c=this.head;c;)e(c.value)&&o.push(c.value),c=c.next;return o}},{key:"reduce",value:function(e,o){for(var c=this.head;c;)o=e(o,c.value),c=c.next;return o}},{key:"shuffle",value:function(e){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:dG;if(2>this._length)return this;for(e=e??Math.ceil(1.5*Math.log2(this._length));0<e;e--)for(var c=this.head;c;){var _=c.next;.5>o.float()?this.asHead(c):this.asTail(c),c=_}return this}},{key:"sort",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:wo;if(!this._length)return this;for(var o=1;;){var c=this.head;this.tail=this.head=void 0;for(var _=0;c;){_++;for(var $=c,_t=0,ga=0;ga<o&&(_t++,$=$.next);ga++);for(ga=o;0<_t||0<ga&&$;){if(_t===0){var _s=$;$=$.next,ga--}else $&&ga!==0?0>=e(c.value,$.value)?(_s=c,c=c.next,_t--):(_s=$,$=$.next,ga--):(_s=c,c=c.next,_t--);this.tail?this.tail.next=_s:this.head=_s,_s.prev=this.tail,this.tail=_s}c=$}if(this.tail.next=void 0,1>=_)return this;o*=2}}},{key:"reverse",value:function(){for(var e=this.head,o=this.tail,c=(this._length>>>1)+(1&this._length);e&&o&&0<c;){var _=e.value;e.value=o.value,o.value=_,e=e.next,o=o.prev,c--}return this}},{key:"asHead",value:function(e){return e===this.head||(this.remove(e),this.head.prev=e,e.next=this.head,e.prev=void 0,this.head=e,this._length++),this}},{key:"asTail",value:function(e){return e===this.tail||(this.remove(e),this.tail.next=e,e.prev=this.tail,e.next=void 0,this.tail=e,this._length++),this}},{key:"toString",value:function(){for(var e=[],o=this.head;o;)e.push(String(o.value)),o=o.next;return e.join(", ")}},{key:"toJSON",value:function(){return ra(this)}},{key:"nthCellUnsafe",value:function(e){if(e<=this._length>>1)var o=this.head,c="next";else o=this.tail,c="prev",e=this._length-e-1;for(;0<e--&&o;)o=o[c];return o}}]),i}(),ue=function(){function i(e,o){ab(this,i),o=Object.assign({maxlen:1/0,maxsize:1/0,map:function(){return new Map},ksize:function(){return 0},vsize:function(){return 0}},o),this.map=o.map(),this.items=new jG,this._size=0,this.opts=o,e&&this.into(e)}return Qb(i,[{key:"length",get:function(){return this.items.length}},{key:"size",get:function(){return this._size}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"entries",value:function(){return Ej(function(e){return[e.k,e]},this.items)}},{key:"keys",value:function(){return Ej(function(e){return e.k},this.items)}},{key:"values",value:function(){return Ej(function(e){return e.v},this.items)}},{key:"copy",value:function(){var e=this.empty();e.items=this.items.copy();for(var o=e.items.head;o;)e.map.set(o.value.k,o),o=o.next;return e}},{key:"empty",value:function(){return new i(null,this.opts)}},{key:"release",value:function(){this._size=0,this.map.clear();var e=this.opts.release;if(e){for(var o;o=this.items.drop();)e(o.k,o.v);return!0}return this.items.release()}},{key:"has",value:function(e){return this.map.has(e)}},{key:"get",value:function(e,o){return(e=this.map.get(e))?this.resetEntry(e):o}},{key:"set",value:function(e,o){var c=this.opts.ksize(e)+this.opts.vsize(o),_=this.map.get(e);return this._size+=Math.max(0,c-(_?_.value.s:0)),this.ensureSize()&&this.doSetEntry(_,e,o,c),o}},{key:"into",value:function(e){for(var o=0;o<e.length;o++){var c=e[o];this.set(c[0],c[1])}return this}},{key:"getSet",value:function(e,o){var c=this,_=this.map.get(e);return _?Promise.resolve(this.resetEntry(_)):o().then(function($){return c.set(e,$)})}},{key:"delete",value:function(e){return!!(e=this.map.get(e))&&(this.removeEntry(e),!0)}},{key:"resetEntry",value:function(e){return this.items.asTail(e),e.value.v}},{key:"ensureSize",value:function(){for(var e=this.opts.release,o=this.opts.maxsize,c=this.opts.maxlen;this._size>o||this.length>=c;){var _=this.items.drop();if(!_)return!1;this.map.delete(_.k),e&&e(_.k,_.v),this._size-=_.s}return!0}},{key:"removeEntry",value:function(e){var o=e.value;this.map.delete(o.k),this.items.remove(e),this.opts.release&&this.opts.release(o.k,o.v),this._size-=o.s}},{key:"doSetEntry",value:function(e,o,c,_){e?(e.value.v=c,e.value.s=_,this.items.asTail(e)):(this.items.push({k:o,v:c,s:_}),this.map.set(o,this.items.tail))}}]),i}(),kG=function(i){function e(c,_){return ab(this,e),_=Object.assign({ttl:36e5},_),o.call(this,c,_)}nb(e,i);var o=ob(e);return Qb(e,[{key:"empty",value:function(){return new e(null,this.opts)}},{key:"has",value:function(c){return this.get(c)!==void 0}},{key:"get",value:function(c,_){if(c=this.map.get(c)){if(c.value.t>=Date.now())return this.resetEntry(c);this.removeEntry(c)}return _}},{key:"set",value:function(c,_){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,_t=this.opts.ksize(c)+this.opts.vsize(_),ga=this.map.get(c);return this._size+=Math.max(0,_t-(ga?ga.value.s:0)),this.ensureSize()&&($=Date.now()+$,ga?(ga.value.v=_,ga.value.s=_t,ga.value.t=$,this.items.asTail(ga)):(this.items.push({k:c,v:_,s:_t,t:$}),this.map.set(c,this.items.tail))),_}},{key:"getSet",value:function(c,_){var $=this,_t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,ga=this.get(c);return ga?Promise.resolve(ga):_().then(function(_s){return $.set(c,_s,_t)})}},{key:"prune",value:function(){for(var c=Date.now(),_=this.items.head;_;)_.value.t<c&&this.removeEntry(_),_=_.next}},{key:"ensureSize",value:function(){for(var c=this.opts.maxsize,_=this.opts.maxlen,$=Date.now(),_t=this.items.head;_t&&(this._size>c||this.length>=_);)_t.value.t<$&&this.removeEntry(_t),_t=_t.next;return fm(Tf(e.prototype),"ensureSize",this).call(this)}}]),e}(ue),yv=Ia(qb)=="object"&&qb&&qb.Object===Object&&qb,lG=(typeof self>"u"?"undefined":Ia(self))=="object"&&self&&self.Object===Object&&self,hd=yv||lG||Function("return this")(),xd=hd.Symbol,zv=Object.prototype,mG=zv.hasOwnProperty,nG=zv.toString,Yi=xd?xd.toStringTag:void 0,oG=Object.prototype.toString,Av=xd?xd.toStringTag:void 0,ng=function(i){if(i==null)i=i===void 0?"[object Undefined]":"[object Null]";else if(Av&&Av in Object(i)){var e=mG.call(i,Yi),o=i[Yi];try{i[Yi]=void 0;var c=!0}catch{}var _=nG.call(i);c&&(e?i[Yi]=o:delete i[Yi]),i=_}else i=oG.call(i);return i},Kc=function(i){var e=Ia(i);return i!=null&&(e=="object"||e=="function")},Em=function(i){return!!Kc(i)&&((i=ng(i))=="[object Function]"||i=="[object GeneratorFunction]"||i=="[object AsyncFunction]"||i=="[object Proxy]")},Bo=hd["__core-js_shared__"],Bv=function(){var i=/[^.]+$/.exec(Bo&&Bo.keys&&Bo.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}(),pG=Function.prototype.toString,og=function(i){if(i!=null){try{return pG.call(i)}catch{}return i+""}return""},qG=/^\[object .+?Constructor\]$/,rG=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pg=function(i,e){return i=i==null?void 0:i[e],!Kc(i)||Bv&&Bv in i||!(Em(i)?rG:qG).test(og(i))?void 0:i},Zi=pg(Object,"create"),sG=Object.prototype.hasOwnProperty,tG=Object.prototype.hasOwnProperty;Vf.prototype.clear=function(){this.__data__=Zi?Zi(null):{},this.size=0},Vf.prototype.delete=function(i){return i=this.has(i)&&delete this.__data__[i],this.size-=i?1:0,i},Vf.prototype.get=function(i){var e=this.__data__;return Zi?(i=e[i])==="__lodash_hash_undefined__"?void 0:i:sG.call(e,i)?e[i]:void 0},Vf.prototype.has=function(i){var e=this.__data__;return Zi?e[i]!==void 0:tG.call(e,i)},Vf.prototype.set=function(i,e){var o=this.__data__;return this.size+=this.has(i)?0:1,o[i]=Zi&&e===void 0?"__lodash_hash_undefined__":e,this};var $i=function(i,e){return i===e||i!=i&&e!=e},Ok=function(i,e){for(var o=i.length;o--;)if($i(i[o][0],e))return o;return-1},uG=Array.prototype.splice;Mg.prototype.clear=function(){this.__data__=[],this.size=0},Mg.prototype.delete=function(i){var e=this.__data__;return!(0>(i=Ok(e,i)))&&(i==e.length-1?e.pop():uG.call(e,i,1),--this.size,!0)},Mg.prototype.get=function(i){var e=this.__data__;return 0>(i=Ok(e,i))?void 0:e[i][1]},Mg.prototype.has=function(i){return-1<Ok(this.__data__,i)},Mg.prototype.set=function(i,e){var o=this.__data__,c=Ok(o,i);return 0>c?(++this.size,o.push([i,e])):o[c][1]=e,this};var Gj=Mg,aj=pg(hd,"Map"),Pk=function(i,e){i=i.__data__;var o=Ia(e);return(o=="string"||o=="number"||o=="symbol"||o=="boolean"?e!=="__proto__":e===null)?i[typeof e=="string"?"string":"hash"]:i.map};Ng.prototype.clear=function(){this.size=0,this.__data__={hash:new Vf,map:new(aj||Gj),string:new Vf}},Ng.prototype.delete=function(i){return i=Pk(this,i).delete(i),this.size-=i?1:0,i},Ng.prototype.get=function(i){return Pk(this,i).get(i)},Ng.prototype.has=function(i){return Pk(this,i).has(i)},Ng.prototype.set=function(i,e){var o=Pk(this,i),c=o.size;return o.set(i,e),this.size+=o.size==c?0:1,this};var Fj=Ng;ei.prototype.add=ei.prototype.push=function(i){return this.__data__.set(i,"__lodash_hash_undefined__"),this},ei.prototype.has=function(i){return this.__data__.has(i)};var Cv=function(i,e,o,c){var _=i.length;for(o+=c?1:-1;c?o--:++o<_;)if(e(i[o],o,i))return o;return-1},vG=function(i){return i!=i},wG=function(i,e){var o;if(o=!(i==null||!i.length)){if(e==e)t:{o=-1;for(var c=i.length;++o<c;)if(i[o]===e){i=o;break t}i=-1}else i=Cv(i,vG,0);o=-1<i}return o},xG=function(i,e,o){for(var c=-1,_=i==null?0:i.length;++c<_;)if(o(e,i[c]))return!0;return!1},yG=function(i,e){return i.has(e)},Ah=pg(hd,"Set"),zG=function(){},Co=function(i){var e=-1,o=Array(i.size);return i.forEach(function(c){o[++e]=c}),o},AG=1/0,BG=Ah&&1/Co(new Ah([,-0]))[1]==AG?function(i){return new Ah(i)}:zG,Do=function(i,e,o){var c=-1,_=wG,$=i.length,_t=!0,ga=[],_s=ga;if(o)_t=!1,_=xG;else if(200<=$){if(_=e?null:BG(i))return Co(_);_t=!1,_=yG,_s=new ei}else _s=e?[]:ga;t:for(;++c<$;){var _c=i[c],_l=e?e(_c):_c;if(_c=o||_c!==0?_c:0,_t&&_l==_l){for(var Tl=_s.length;Tl--;)if(_s[Tl]===_l)continue t;e&&_s.push(_l),ga.push(_c)}else _(_s,_l,o)||(_s!==ga&&_s.push(_l),ga.push(_c))}return ga},Dv=function(i){for(var e=-1,o=i==null?0:i.length,c={};++e<o;){var _=i[e];c[_[0]]=_[1]}return c},Rg=function(i,e){for(var o=-1,c=i==null?0:i.length,_=Array(c);++o<c;)_[o]=e(i[o],o,i);return _};Og.prototype.clear=function(){this.__data__=new Gj,this.size=0},Og.prototype.delete=function(i){var e=this.__data__;return i=e.delete(i),this.size=e.size,i},Og.prototype.get=function(i){return this.__data__.get(i)},Og.prototype.has=function(i){return this.__data__.has(i)},Og.prototype.set=function(i,e){var o=this.__data__;if(o instanceof Gj){var c=o.__data__;if(!aj||199>c.length)return c.push([i,e]),this.size=++o.size,this;o=this.__data__=new Fj(c)}return o.set(i,e),this.size=o.size,this};var Qg=Og,cB=function(i,e){for(var o=-1,c=i==null?0:i.length;++o<c&&e(i[o],o,i)!==!1;);return i},Qk=function(){try{var i=pg(Object,"defineProperty");return i({},"",{}),i}catch{}}(),bj=function(i,e,o){e=="__proto__"&&Qk?Qk(i,e,{configurable:!0,enumerable:!0,value:o,writable:!0}):i[e]=o},CG=Object.prototype.hasOwnProperty,sr=function(i,e,o){var c=i[e];CG.call(i,e)&&$i(c,o)&&(o!==void 0||e in i)||bj(i,e,o)},bh=function(i,e,o,c){var _=!o;o||(o={});for(var $=-1,_t=e.length;++$<_t;){var ga=e[$],_s=c?c(o[ga],i[ga],ga,o,i):void 0;_s===void 0&&(_s=i[ga]),_?bj(o,ga,_s):sr(o,ga,_s)}return o},ee=function(i){return i!=null&&Ia(i)=="object"},Ev=function(i){return ee(i)&&ng(i)=="[object Arguments]"},Fv=Object.prototype,DG=Fv.hasOwnProperty,EG=Fv.propertyIsEnumerable,oi=Ev(function(){return arguments}())?Ev:function(i){return ee(i)&&DG.call(i,"callee")&&!EG.call(i,"callee")},lc=Array.isArray,FG=function(){return!1},gi=kc(function(i,e){var o=(e=e&&!e.nodeType&&e)&&i&&!i.nodeType&&i;e=o&&o.exports===e?hd.Buffer:void 0,i.exports=(e?e.isBuffer:void 0)||FG}),GG=/^(?:0|[1-9]\d*)$/,Eo=function(i,e){var o=Ia(i);return!!(e=e??9007199254740991)&&(o=="number"||o!="symbol"&&GG.test(i))&&-1<i&&i%1==0&&i<e},Fo=function(i){return typeof i=="number"&&-1<i&&i%1==0&&9007199254740991>=i},Hb={};Hb["[object Float32Array]"]=Hb["[object Float64Array]"]=Hb["[object Int8Array]"]=Hb["[object Int16Array]"]=Hb["[object Int32Array]"]=Hb["[object Uint8Array]"]=Hb["[object Uint8ClampedArray]"]=Hb["[object Uint16Array]"]=Hb["[object Uint32Array]"]=!0,Hb["[object Arguments]"]=Hb["[object Array]"]=Hb["[object ArrayBuffer]"]=Hb["[object Boolean]"]=Hb["[object DataView]"]=Hb["[object Date]"]=Hb["[object Error]"]=Hb["[object Function]"]=Hb["[object Map]"]=Hb["[object Number]"]=Hb["[object Object]"]=Hb["[object RegExp]"]=Hb["[object Set]"]=Hb["[object String]"]=Hb["[object WeakMap]"]=!1;var HG=function(i){return ee(i)&&Fo(i.length)&&!!Hb[ng(i)]},Rk=function(i){return function(e){return i(e)}},Bh=kc(function(i,e){var o=e&&!e.nodeType&&e;o=(e=o&&i&&!i.nodeType&&i)&&e.exports===o&&yv.process;t:{try{var c=e&&e.require&&e.require("util").types;if(c){var _=c;break t}_=o&&o.binding&&o.binding("util");break t}catch{}_=void 0}i.exports=_}),Gv=Bh&&Bh.isTypedArray,om=Gv?Rk(Gv):HG,IG=Object.prototype.hasOwnProperty,Hv=function(i,e){var o=lc(i),c=!o&&oi(i),_=!o&&!c&&gi(i),$=!o&&!c&&!_&&om(i);if(o=o||c||_||$){c=i.length;for(var _t=String,ga=-1,_s=Array(c);++ga<c;)_s[ga]=_t(ga);c=_s}else c=[];for(var _c in _t=c.length,i)!e&&!IG.call(i,_c)||o&&(_c=="length"||_&&(_c=="offset"||_c=="parent")||$&&(_c=="buffer"||_c=="byteLength"||_c=="byteOffset")||Eo(_c,_t))||c.push(_c);return c},JG=Object.prototype,Go=function(i){var e=i&&i.constructor;return i===(typeof e=="function"&&e.prototype||JG)},Iv=function(i,e){return function(o){return i(e(o))}},KG=Iv(Object.keys,Object),LG=Object.prototype.hasOwnProperty,$f=function(i){return i!=null&&Fo(i.length)&&!Em(i)},Wf=function(i){if($f(i))i=Hv(i);else if(Go(i)){var e,o=[];for(e in Object(i))LG.call(i,e)&&e!="constructor"&&o.push(e);i=o}else i=KG(i);return i},ZA=function(i,e){return i&&bh(e,Wf(e),i)},MG=Object.prototype.hasOwnProperty,hi=function(i){if($f(i))i=Hv(i,!0);else if(Kc(i)){var e=Go(i),o=[];for(c in i)(c!="constructor"||!e&&MG.call(i,c))&&o.push(c);i=o}else{var c=[];if(i!=null)for(e in Object(i))c.push(e);i=c}return i},XA=function(i,e){return i&&bh(e,hi(e),i)},pr=kc(function(i,e){var o=(e=e&&!e.nodeType&&e)&&i&&!i.nodeType&&i,c=(e=o&&o.exports===e?hd.Buffer:void 0)?e.allocUnsafe:void 0;i.exports=function(_,$){return $?_.slice():($=_.length,$=c?c($):new _.constructor($),_.copy($),$)}}),jm=function(i,e){var o=-1,c=i.length;for(e||(e=Array(c));++o<c;)e[o]=i[o];return e},NG=function(i,e){for(var o=-1,c=i==null?0:i.length,_=0,$=[];++o<c;){var _t=i[o];e(_t,o,i)&&($[_++]=_t)}return $},Jv=function(){return[]},OG=Object.prototype.propertyIsEnumerable,Kv=Object.getOwnPropertySymbols,Ho=Kv?function(i){return i==null?[]:(i=Object(i),NG(Kv(i),function(e){return OG.call(i,e)}))}:Jv,YA=function(i,e){return bh(i,Ho(i),e)},nm=function(i,e){for(var o=-1,c=e.length,_=i.length;++o<c;)i[_+o]=e[o];return i},Io=Iv(Object.getPrototypeOf,Object),Lv=Object.getOwnPropertySymbols?function(i){for(var e=[];i;)nm(e,Ho(i)),i=Io(i);return e}:Jv,WA=function(i,e){return bh(i,Lv(i),e)},Mv=function(i,e,o){return e=e(i),lc(i)?e:nm(e,o(i))},km=function(i){return Mv(i,Wf,Ho)},rr=function(i){return Mv(i,hi,Lv)},Jo=pg(hd,"DataView"),Ko=pg(hd,"Promise"),Lo=pg(hd,"WeakMap"),PG=og(Jo),QG=og(aj),RG=og(Ko),SG=og(Ah),TG=og(Lo),qg=ng;(Jo&&qg(new Jo(new ArrayBuffer(1)))!="[object DataView]"||aj&&qg(new aj)!="[object Map]"||Ko&&qg(Ko.resolve())!="[object Promise]"||Ah&&qg(new Ah)!="[object Set]"||Lo&&qg(new Lo)!="[object WeakMap]")&&(qg=function(i){var e=ng(i);if(i=(i=e=="[object Object]"?i.constructor:void 0)?og(i):"")switch(i){case PG:return"[object DataView]";case QG:return"[object Map]";case RG:return"[object Promise]";case SG:return"[object Set]";case TG:return"[object WeakMap]"}return e});var fi=qg,UG=Object.prototype.hasOwnProperty,VA=function(i){var e=i.length,o=new i.constructor(e);return e&&typeof i[0]=="string"&&UG.call(i,"index")&&(o.index=i.index,o.input=i.input),o},Sk=hd.Uint8Array,Mo=function(i){var e=new i.constructor(i.byteLength);return new Sk(e).set(new Sk(i)),e},VG=/\w*$/,Nv=xd?xd.prototype:void 0,Ov=Nv?Nv.valueOf:void 0,cs=function(i,e){return e=e?Mo(i.buffer):i.buffer,new i.constructor(e,i.byteOffset,i.length)},$A=function(i,e,o){var c=i.constructor;switch(e){case"[object ArrayBuffer]":return Mo(i);case"[object Boolean]":case"[object Date]":return new c(+i);case"[object DataView]":return e=o?Mo(i.buffer):i.buffer,new i.constructor(e,i.byteOffset,i.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return cs(i,o);case"[object Map]":return new c;case"[object Number]":case"[object String]":return new c(i);case"[object RegExp]":return(e=new i.constructor(i.source,VG.exec(i))).lastIndex=i.lastIndex,e;case"[object Set]":return new c;case"[object Symbol]":return Ov?Object(Ov.call(i)):{}}},Pv=Object.create,WG=function(){function i(){}return function(e){return Kc(e)?Pv?Pv(e):(i.prototype=e,e=new i,i.prototype=void 0,e):{}}}(),qr=function(i){return typeof i.constructor!="function"||Go(i)?{}:WG(Io(i))},XG=function(i){return ee(i)&&fi(i)=="[object Map]"},Qv=Bh&&Bh.isMap,bB=Qv?Rk(Qv):XG,YG=function(i){return ee(i)&&fi(i)=="[object Set]"},Rv=Bh&&Bh.isSet,aB=Rv?Rk(Rv):YG,zb={};zb["[object Arguments]"]=zb["[object Array]"]=zb["[object ArrayBuffer]"]=zb["[object DataView]"]=zb["[object Boolean]"]=zb["[object Date]"]=zb["[object Float32Array]"]=zb["[object Float64Array]"]=zb["[object Int8Array]"]=zb["[object Int16Array]"]=zb["[object Int32Array]"]=zb["[object Map]"]=zb["[object Number]"]=zb["[object Object]"]=zb["[object RegExp]"]=zb["[object Set]"]=zb["[object String]"]=zb["[object Symbol]"]=zb["[object Uint8Array]"]=zb["[object Uint8ClampedArray]"]=zb["[object Uint16Array]"]=zb["[object Uint32Array]"]=!0,zb["[object Error]"]=zb["[object Function]"]=zb["[object WeakMap]"]=!1;var Sg=function(i){return Ia(i)=="symbol"||ee(i)&&ng(i)=="[object Symbol]"},ZG=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$G=/^\w*$/,No=function(i,e){if(lc(i))return!1;var o=Ia(i);return!(o!="number"&&o!="symbol"&&o!="boolean"&&i!=null&&!Sg(i))||$G.test(i)||!ZG.test(i)||e!=null&&i in Object(e)};lm.Cache=Fj;var aH=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bH=/\\(\\)?/g,cH=function(i){var e=(i=lm(i,function(o){return e.size===500&&e.clear(),o})).cache;return i}(function(i){var e=[];return i.charCodeAt(0)===46&&e.push(""),i.replace(aH,function(o,c,_,$){e.push(_?$.replace(bH,"$1"):c||o)}),e}),dB=1/0,Sv=xd?xd.prototype:void 0,ur=Sv?Sv.toString:void 0,Tk=function(i,e){return lc(i)?i:No(i,e)?[i]:cH(i==null?"":tr(i))},dH=1/0,cj=function(i){if(typeof i=="string"||Sg(i))return i;var e=i+"";return e=="0"&&1/i==-dH?"-0":e},Uk=function(i,e){for(var o=0,c=(e=Tk(e,i)).length;i!=null&&o<c;)i=i[cj(e[o++])];return o&&o==c?i:void 0},eH=function(i,e){if(!(2>(e=Tk(e,i)).length)){var o=e,c=0,_=-1,$=-1,_t=o.length;for(0>c&&(c=-c>_t?0:_t+c),0>(_=_>_t?_t:_)&&(_+=_t),_t=c>_?0:_-c>>>0,c>>>=0,_=Array(_t);++$<_t;)_[$]=o[$+c];i=Uk(i,_)}return(o=i==null)||(o=e==null?0:e.length,o=delete i[cj(o?e[o-1]:void 0)]),o},Tv=Function.prototype.toString,fH=Object.prototype.hasOwnProperty,gH=Tv.call(Object),ds=function(i){return!(!ee(i)||ng(i)!="[object Object]")&&((i=Io(i))===null||typeof(i=fH.call(i,"constructor")&&i.constructor)=="function"&&i instanceof i&&Tv.call(i)==gH)},hH=function(i){return ds(i)?void 0:i},Uv=xd?xd.isConcatSpreadable:void 0,eB=function(i){return lc(i)||oi(i)||!!(Uv&&i&&i[Uv])},iH=function(i){return i!=null&&i.length?mm(i,1):[]},jH=function(i,e,o){switch(o.length){case 0:return i.call(e);case 1:return i.call(e,o[0]);case 2:return i.call(e,o[0],o[1]);case 3:return i.call(e,o[0],o[1],o[2])}return i.apply(e,o)},Vv=Math.max,Wv=function(i,e,o){return e=Vv(e===void 0?i.length-1:e,0),function(){for(var c=arguments,_=-1,$=Vv(c.length-e,0),_t=Array($);++_<$;)_t[_]=c[e+_];for(_=-1,$=Array(e+1);++_<e;)$[_]=c[_];return $[e]=o(_t),jH(i,this,$)}},kH=function(i){return function(){return i}},Vk=function(i){return i},lH=Date.now,Xv=function(i){var e=0,o=0;return function(){var c=lH(),_=16-(c-o);if(o=c,0<_){if(800<=++e)return arguments[0]}else e=0;return i.apply(void 0,arguments)}}(Qk?function(i,e){return Qk(i,"toString",{configurable:!0,enumerable:!1,value:kH(e),writable:!0})}:Vk),Oo=function(i){return Xv(Wv(i,void 0,iH),i+"")}(function(i,e){var o={};if(i==null)return o;var c=!1;e=Rg(e,function($){return $=Tk($,i),c||(c=1<$.length),$}),bh(i,rr(i),o),c&&(o=Pg(o,7,hH));for(var _=e.length;_--;)eH(o,e[_]);return o}),mH=function(i,e,o,c){for(var _=-1,$=i==null?0:i.length;++_<$;){var _t=i[_];e(c,_t,o(_t),i)}return c},bs=function(i,e,o){for(var c=-1,_=Object(i),$=(o=o(i)).length;$--;){var _t=o[++c];if(e(_[_t],_t,_)===!1)break}return i},Yv=function(i,e){return i&&bs(i,e,Wf)},Po=function(i,e){return function(o,c){if(o==null)return o;if(!$f(o))return i(o,c);for(var _=o.length,$=-1,_t=Object(o);++$<_&&c(_t[$],$,_t)!==!1;);return o}}(Yv),nH=function(i,e,o,c){return Po(i,function(_,$,_t){e(c,_,o(_),_t)}),c},Zv=function(i,e){for(var o=-1,c=i==null?0:i.length;++o<c;)if(e(i[o],o,i))return!0;return!1},vr=function(i,e,o,c,_,$){var _t=1&o,ga=i.length,_s=e.length;if(ga!=_s&&!(_t&&_s>ga))return!1;_s=$.get(i);var _c=$.get(e);if(_s&&_c)return _s==e&&_c==i;_s=-1,_c=!0;var _l=2&o?new ei:void 0;for($.set(i,e),$.set(e,i);++_s<ga;){var Tl=i[_s],Cl=e[_s];if(c)var Pl=_t?c(Cl,Tl,_s,e,i,$):c(Tl,Cl,_s,i,e,$);if(Pl!==void 0){if(Pl)continue;_c=!1;break}if(_l){if(!Zv(e,function(Dl,Jl){if(!_l.has(Jl)&&(Tl===Dl||_(Tl,Dl,o,c,$)))return _l.push(Jl)})){_c=!1;break}}else if(Tl!==Cl&&!_(Tl,Cl,o,c,$)){_c=!1;break}}return $.delete(i),$.delete(e),_c},oH=function(i){var e=-1,o=Array(i.size);return i.forEach(function(c,_){o[++e]=[_,c]}),o},$v=xd?xd.prototype:void 0,Qo=$v?$v.valueOf:void 0,fB=function(i,e,o,c,_,$,_t){switch(o){case"[object DataView]":if(i.byteLength!=e.byteLength||i.byteOffset!=e.byteOffset)break;i=i.buffer,e=e.buffer;case"[object ArrayBuffer]":if(i.byteLength!=e.byteLength||!$(new Sk(i),new Sk(e)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return $i(+i,+e);case"[object Error]":return i.name==e.name&&i.message==e.message;case"[object RegExp]":case"[object String]":return i==e+"";case"[object Map]":var ga=oH;case"[object Set]":if(ga||(ga=Co),i.size!=e.size&&!(1&c))break;return(o=_t.get(i))?o==e:(c|=2,_t.set(i,e),e=vr(ga(i),ga(e),c,_,$,_t),_t.delete(i),e);case"[object Symbol]":if(Qo)return Qo.call(i)==Qo.call(e)}return!1},gB=Object.prototype.hasOwnProperty,wr=Object.prototype.hasOwnProperty,pH=function(i,e,o,c){var _=o.length,$=_,_t=!c;if(i==null)return!$;for(i=Object(i);_--;){var ga=o[_];if(_t&&ga[2]?ga[1]!==i[ga[0]]:!(ga[0]in i))return!1}for(;++_<$;){var _s=(ga=o[_])[0],_c=i[_s],_l=ga[1];if(_t&&ga[2]){if(_c===void 0&&!(_s in i))return!1}else{if(ga=new Qg,c)var Tl=c(_c,_l,_s,i,e,ga);if(Tl===void 0?!Tg(_l,_c,3,c,ga):!Tl)return!1}}return!0},qH=function(i){for(var e=Wf(i),o=e.length;o--;){var c=e[o],_=i[c];e[o]=[c,_,_==_&&!Kc(_)]}return e},aw=function(i,e){return function(o){return o!=null&&o[i]===e&&(e!==void 0||i in Object(o))}},rH=function(i){var e=qH(i);return e.length==1&&e[0][2]?aw(e[0][0],e[0][1]):function(o){return o===i||pH(o,i,e)}},sH=function(i,e){return No(i)&&e==e&&!Kc(e)?aw(cj(i),e):function(o){var c=o==null?void 0:Uk(o,i);if((c=c===void 0?void 0:c)===void 0&&c===e){if(c=o!=null){for(var _=-1,$=(c=Tk(c=i,o)).length,_t=!1;++_<$;){var ga=cj(c[_]);if(!(_t=o!=null&&o!=null&&ga in Object(o)))break;o=o[ga]}_t||++_!=$?c=_t:c=!!($=o==null?0:o.length)&&Fo($)&&Eo(ga,$)&&(lc(o)||oi(o))}ga=c}else ga=Tg(e,c,3);return ga}},tH=function(i){return function(e){return e==null?void 0:e[i]}},uH=function(i){return function(e){return Uk(e,i)}},Ch=function(i){return typeof i=="function"?i:i==null?Vk:Ia(i)=="object"?lc(i)?sH(i[0],i[1]):rH(i):No(i)?tH(cj(i)):uH(i)},Ro=function(i,e){return function(o,c){var _={};return(lc(o)?mH:nH)(o,i,Ch(c),_)}}(function(i,e,o){bj(i,o,e)}),Pe=function(i,e){var o={};return e=Ch(e),Yv(i,function(c,_,$){bj(o,_,e(c,_,$))}),o};wa({target:"String",proto:!0,forced:Ga(function(){var i="".sub('"');return i!==i.toLowerCase()||3<i.split('"').length})},{sub:function(){return"<sub>"+String(Ec(this))+"</sub>"}});var D=Ab,yd=null;try{yd=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(i){}Ab.prototype.__isLong__,Object.defineProperty(Ab.prototype,"__isLong__",{value:!0}),Ab.isLong=Lc;var yr={},xr={};Ab.fromInt=Xf,Ab.fromNumber=qd,Ab.fromBits=Bb;var Hj=Math.pow;Ab.fromString=pm,Ab.fromValue=Nd;var Ug=4294967296,zr=Ug*Ug,Br=zr/2,bw=Xf(16777216),rd=Xf(0);Ab.ZERO=rd;var Yf=Xf(0,!0);Ab.UZERO=Yf;var Dh=Xf(1);Ab.ONE=Dh;var cw=Xf(1,!0);Ab.UONE=cw;var So=Xf(-1);Ab.NEG_ONE=So;var Cr=Bb(-1,2147483647,!1);Ab.MAX_VALUE=Cr;var Ar=Bb(-1,-1,!0);Ab.MAX_UNSIGNED_VALUE=Ar;var Mc=Bb(0,-2147483648,!1);Ab.MIN_VALUE=Mc;var sa=Ab.prototype;sa.toInt=function(){return this.unsigned?this.low>>>0:this.low},sa.toNumber=function(){return this.unsigned?(this.high>>>0)*Ug+(this.low>>>0):this.high*Ug+(this.low>>>0)},sa.toString=function(i){if(2>(i=i||10)||36<i)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Mc)){var e=qd(i),o=this.div(e);return e=o.mul(e).sub(this),o.toString(i)+e.toInt().toString(i)}return"-"+this.neg().toString(i)}o=qd(Hj(i,6),this.unsigned),e=this;for(var c="";;){var _=e.div(o),$=(e.sub(_.mul(o)).toInt()>>>0).toString(i);if((e=_).isZero())return $+c;for(;6>$.length;)$="0"+$;c=""+$+c}},sa.getHighBits=function(){return this.high},sa.getHighBitsUnsigned=function(){return this.high>>>0},sa.getLowBits=function(){return this.low},sa.getLowBitsUnsigned=function(){return this.low>>>0},sa.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Mc)?64:this.neg().getNumBitsAbs();for(var i=this.high!=0?this.high:this.low,e=31;0<e&&!(i&1<<e);e--);return this.high!=0?e+33:e+1},sa.isZero=function(){return this.high===0&&this.low===0},sa.eqz=sa.isZero,sa.isNegative=function(){return!this.unsigned&&0>this.high},sa.isPositive=function(){return this.unsigned||0<=this.high},sa.isOdd=function(){return(1&this.low)==1},sa.isEven=function(){return(1&this.low)==0},sa.equals=function(i){return Lc(i)||(i=Nd(i)),(this.unsigned===i.unsigned||this.high>>>31!=1||i.high>>>31!=1)&&this.high===i.high&&this.low===i.low},sa.eq=sa.equals,sa.notEquals=function(i){return!this.eq(i)},sa.neq=sa.notEquals,sa.ne=sa.notEquals,sa.lessThan=function(i){return 0>this.comp(i)},sa.lt=sa.lessThan,sa.lessThanOrEqual=function(i){return 0>=this.comp(i)},sa.lte=sa.lessThanOrEqual,sa.le=sa.lessThanOrEqual,sa.greaterThan=function(i){return 0<this.comp(i)},sa.gt=sa.greaterThan,sa.greaterThanOrEqual=function(i){return 0<=this.comp(i)},sa.gte=sa.greaterThanOrEqual,sa.ge=sa.greaterThanOrEqual,sa.compare=function(i){if(Lc(i)||(i=Nd(i)),this.eq(i))return 0;var e=this.isNegative(),o=i.isNegative();return e&&!o?-1:!e&&o?1:this.unsigned?i.high>>>0>this.high>>>0||i.high===this.high&&i.low>>>0>this.low>>>0?-1:1:this.sub(i).isNegative()?-1:1},sa.comp=sa.compare,sa.negate=function(){return!this.unsigned&&this.eq(Mc)?Mc:this.not().add(Dh)},sa.neg=sa.negate,sa.add=function(i){Lc(i)||(i=Nd(i));var e=this.high>>>16,o=65535&this.high,c=this.low>>>16,_=i.high>>>16,$=65535&i.high,_t=i.low>>>16;return c=(_t=((i=(65535&this.low)+(65535&i.low))>>>16)+(c+_t))>>>16,Bb((65535&_t)<<16|65535&i,(e=((c+=o+$)>>>16)+(e+_)&65535)<<16|65535&c,this.unsigned)},sa.subtract=function(i){return Lc(i)||(i=Nd(i)),this.add(i.neg())},sa.sub=sa.subtract,sa.multiply=function(i){if(this.isZero())return rd;if(Lc(i)||(i=Nd(i)),yd){var e=yd.mul(this.low,this.high,i.low,i.high);return Bb(e,yd.get_high(),this.unsigned)}if(i.isZero())return rd;if(this.eq(Mc))return i.isOdd()?Mc:rd;if(i.eq(Mc))return this.isOdd()?Mc:rd;if(this.isNegative())return i.isNegative()?this.neg().mul(i.neg()):this.neg().mul(i).neg();if(i.isNegative())return this.mul(i.neg()).neg();if(this.lt(bw)&&i.lt(bw))return qd(this.toNumber()*i.toNumber(),this.unsigned);e=this.high>>>16;var o=65535&this.high,c=this.low>>>16,_=65535&this.low,$=i.high>>>16,_t=65535&i.high,ga=i.low>>>16,_s=_*(i=65535&i.low),_c=(_s>>>16)+c*i,_l=_c>>>16;_l+=(_c=(65535&_c)+_*ga)>>>16;var Tl=(_l+=o*i)>>>16;return Bb((65535&_c)<<16|65535&_s,(Tl=(Tl+=(_l=(65535&_l)+c*ga)>>>16)+((_l=(65535&_l)+_*_t)>>>16)+(e*i+o*ga+c*_t+_*$)&65535)<<16|65535&_l,this.unsigned)},sa.mul=sa.multiply,sa.divide=function(i){if(Lc(i)||(i=Nd(i)),i.isZero())throw Error("division by zero");if(yd)return this.unsigned||this.high!==-2147483648||i.low!==-1||i.high!==-1?Bb(i=(this.unsigned?yd.div_u:yd.div_s)(this.low,this.high,i.low,i.high),yd.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Yf:rd;if(this.unsigned){if(i.unsigned||(i=i.toUnsigned()),i.gt(this))return Yf;if(i.gt(this.shru(1)))return cw;var e=Yf}else{if(this.eq(Mc)){if(i.eq(Dh)||i.eq(So))return Mc;if(i.eq(Mc))return Dh;var o=this.shr(1).div(i).shl(1);if(o.eq(rd))return i.isNegative()?Dh:So;var c=this.sub(i.mul(o));return o.add(c.div(i))}if(i.eq(Mc))return this.unsigned?Yf:rd;if(this.isNegative())return i.isNegative()?this.neg().div(i.neg()):this.neg().div(i).neg();if(i.isNegative())return this.div(i.neg()).neg();e=rd}for(c=this;c.gte(i);){o=Math.max(1,Math.floor(c.toNumber()/i.toNumber()));var _=Math.ceil(Math.log(o)/Math.LN2);_=48>=_?1:Hj(2,_-48);for(var $=qd(o),_t=$.mul(i);_t.isNegative()||_t.gt(c);)_t=($=qd(o-=_,this.unsigned)).mul(i);$.isZero()&&($=Dh),e=e.add($),c=c.sub(_t)}return e},sa.div=sa.divide,sa.modulo=function(i){return Lc(i)||(i=Nd(i)),yd?Bb(i=(this.unsigned?yd.rem_u:yd.rem_s)(this.low,this.high,i.low,i.high),yd.get_high(),this.unsigned):this.sub(this.div(i).mul(i))},sa.mod=sa.modulo,sa.rem=sa.modulo,sa.not=function(){return Bb(~this.low,~this.high,this.unsigned)},sa.and=function(i){return Lc(i)||(i=Nd(i)),Bb(this.low&i.low,this.high&i.high,this.unsigned)},sa.or=function(i){return Lc(i)||(i=Nd(i)),Bb(this.low|i.low,this.high|i.high,this.unsigned)},sa.xor=function(i){return Lc(i)||(i=Nd(i)),Bb(this.low^i.low,this.high^i.high,this.unsigned)},sa.shiftLeft=function(i){return Lc(i)&&(i=i.toInt()),(i&=63)==0?this:32>i?Bb(this.low<<i,this.high<<i|this.low>>>32-i,this.unsigned):Bb(0,this.low<<i-32,this.unsigned)},sa.shl=sa.shiftLeft,sa.shiftRight=function(i){return Lc(i)&&(i=i.toInt()),(i&=63)==0?this:32>i?Bb(this.low>>>i|this.high<<32-i,this.high>>i,this.unsigned):Bb(this.high>>i-32,0<=this.high?0:-1,this.unsigned)},sa.shr=sa.shiftRight,sa.shiftRightUnsigned=function(i){if(Lc(i)&&(i=i.toInt()),(i&=63)===0)return this;var e=this.high;return 32>i?Bb(this.low>>>i|e<<32-i,e>>>i,this.unsigned):Bb(i===32?e:e>>>i-32,0,this.unsigned)},sa.shru=sa.shiftRightUnsigned,sa.shr_u=sa.shiftRightUnsigned,sa.toSigned=function(){return this.unsigned?Bb(this.low,this.high,!1):this},sa.toUnsigned=function(){return this.unsigned?this:Bb(this.low,this.high,!0)},sa.toBytes=function(i){return i?this.toBytesLE():this.toBytesBE()},sa.toBytesLE=function(){var i=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&i,i>>>8&255,i>>>16&255,i>>>24]},sa.toBytesBE=function(){var i=this.high,e=this.low;return[i>>>24,i>>>16&255,i>>>8&255,255&i,e>>>24,e>>>16&255,e>>>8&255,255&e]},Ab.fromBytes=function(i,e,o){return o?Ab.fromBytesLE(i,e):Ab.fromBytesBE(i,e)},Ab.fromBytesLE=function(i,e){return new Ab(i[0]|i[1]<<8|i[2]<<16|i[3]<<24,i[4]|i[5]<<8|i[6]<<16|i[7]<<24,e)},Ab.fromBytesBE=function(i,e){return new Ab(i[4]<<24|i[5]<<16|i[6]<<8|i[7],i[0]<<24|i[1]<<16|i[2]<<8|i[3],e)};var qm=function(i,e){return(qm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var _ in c)c.hasOwnProperty(_)&&(o[_]=c[_])})(i,e)},To=!1,sd={Promise:void 0,set useDeprecatedSynchronousErrorHandling(i){i?console.warn(`DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: 
`+Error().stack):To&&console.log("RxJS: Back to a better error behavior. Thank you. <3"),To=i},get useDeprecatedSynchronousErrorHandling(){return To}},Wk={closed:!0,next:function(i){},error:function(i){if(sd.useDeprecatedSynchronousErrorHandling)throw i;Wg(i)},complete:function(){}},td=Array.isArray||function(i){return i&&typeof i.length=="number"},ii=function(){function i(e){return Error.call(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(o,c){return c+1+") "+o.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e,this}return i.prototype=Object.create(Error.prototype),i}(),dc=function(){function i(e){this.closed=!1,this._subscriptions=this._parentOrParents=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return i.prototype.unsubscribe=function(){if(!this.closed){var e=this._parentOrParents,o=this._ctorUnsubscribe,c=this._unsubscribe,_=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,e instanceof i)e.remove(this);else if(e!==null)for(var $=0;$<e.length;++$)e[$].remove(this);if(Vg(c)){o&&(this._unsubscribe=void 0);try{c.call(this)}catch(ga){var _t=ga instanceof ii?Dr(ga.errors):[ga]}}if(td(_)){for($=-1,e=_.length;++$<e;)if(rm(o=_[$]))try{o.unsubscribe()}catch(ga){_t=_t||[],ga instanceof ii?_t=_t.concat(Dr(ga.errors)):_t.push(ga)}}if(_t)throw new ii(_t)}},i.prototype.add=function(e){var o=e;if(!e)return i.EMPTY;switch(Ia(e)){case"function":o=new i(e);case"object":if(o===this||o.closed||typeof o.unsubscribe!="function")return o;if(this.closed)return o.unsubscribe(),o;o instanceof i||(e=o,(o=new i)._subscriptions=[e]);break;default:throw Error("unrecognized teardown "+e+" added to Subscription.")}if((e=o._parentOrParents)===null)o._parentOrParents=this;else if(e instanceof i){if(e===this)return o;o._parentOrParents=[e,this]}else{if(e.indexOf(this)!==-1)return o;e.push(this)}return(e=this._subscriptions)===null?this._subscriptions=[o]:e.push(o),o},i.prototype.remove=function(e){var o=this._subscriptions;o&&(e=o.indexOf(e))!==-1&&o.splice(e,1)},i.EMPTY=function(e){return e.closed=!0,e}(new i),i}(),Xk=typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),hb=function(i){function e(o,c,_){var $=i.call(this)||this;switch($.syncErrorValue=null,$.syncErrorThrown=!1,$.syncErrorThrowable=!1,$.isStopped=!1,arguments.length){case 0:$.destination=Wk;break;case 1:if(!o){$.destination=Wk;break}if(Ia(o)==="object"){o instanceof e?($.syncErrorThrowable=o.syncErrorThrowable,$.destination=o,o.add($)):($.syncErrorThrowable=!0,$.destination=new dw($,o));break}default:$.syncErrorThrowable=!0,$.destination=new dw($,o,c,_)}return $}return Ca(e,i),e.prototype[Xk]=function(){return this},e.create=function(o,c,_){return(o=new e(o,c,_)).syncErrorThrowable=!1,o},e.prototype.next=function(o){this.isStopped||this._next(o)},e.prototype.error=function(o){this.isStopped||(this.isStopped=!0,this._error(o))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,i.prototype.unsubscribe.call(this))},e.prototype._next=function(o){this.destination.next(o)},e.prototype._error=function(o){this.destination.error(o),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var o=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.isStopped=this.closed=!1,this._parentOrParents=o,this},e}(dc),dw=function(i){function e(o,c,_,$){var _t=i.call(this)||this;if(_t._parentSubscriber=o,o=_t,Vg(c))var ga=c;else c&&(ga=c.next,_=c.error,$=c.complete,c!==Wk&&(Vg((o=Object.create(c)).unsubscribe)&&_t.add(o.unsubscribe.bind(o)),o.unsubscribe=_t.unsubscribe.bind(_t)));return _t._context=o,_t._next=ga,_t._error=_,_t._complete=$,_t}return Ca(e,i),e.prototype.next=function(o){if(!this.isStopped&&this._next){var c=this._parentSubscriber;sd.useDeprecatedSynchronousErrorHandling&&c.syncErrorThrowable?this.__tryOrSetError(c,this._next,o)&&this.unsubscribe():this.__tryOrUnsub(this._next,o)}},e.prototype.error=function(o){if(!this.isStopped){var c=this._parentSubscriber,_=sd.useDeprecatedSynchronousErrorHandling;if(this._error)_&&c.syncErrorThrowable?this.__tryOrSetError(c,this._error,o):this.__tryOrUnsub(this._error,o),this.unsubscribe();else if(c.syncErrorThrowable)_?(c.syncErrorValue=o,c.syncErrorThrown=!0):Wg(o),this.unsubscribe();else{if(this.unsubscribe(),_)throw o;Wg(o)}}},e.prototype.complete=function(){var o=this;if(!this.isStopped){var c=this._parentSubscriber;if(this._complete){var _=function(){return o._complete.call(o._context)};sd.useDeprecatedSynchronousErrorHandling&&c.syncErrorThrowable?this.__tryOrSetError(c,_):this.__tryOrUnsub(_)}this.unsubscribe()}},e.prototype.__tryOrUnsub=function(o,c){try{o.call(this._context,c)}catch(_){if(this.unsubscribe(),sd.useDeprecatedSynchronousErrorHandling)throw _;Wg(_)}},e.prototype.__tryOrSetError=function(o,c,_){if(!sd.useDeprecatedSynchronousErrorHandling)throw Error("bad call");try{c.call(this._context,_)}catch($){return sd.useDeprecatedSynchronousErrorHandling?(o.syncErrorValue=$,o.syncErrorThrown=!0):Wg($),!0}return!1},e.prototype._unsubscribe=function(){var o=this._parentSubscriber;this._parentSubscriber=this._context=null,o.unsubscribe()},e}(hb),Xg=typeof Symbol=="function"&&Symbol.observable||"@@observable",Za=function(){function i(e){this._isScalar=!1,e&&(this._subscribe=e)}return i.prototype.lift=function(e){var o=new i;return o.source=this,o.operator=e,o},i.prototype.subscribe=function(e,o,c){var _=this.operator;t:{if(e){if(e instanceof hb)break t;if(e[Xk]){e=e[Xk]();break t}}e=e||o||c?new hb(e,o,c):new hb(Wk)}if(_?e.add(_.call(e,this.source)):e.add(this.source||sd.useDeprecatedSynchronousErrorHandling&&!e.syncErrorThrowable?this._subscribe(e):this._trySubscribe(e)),sd.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable&&(e.syncErrorThrowable=!1,e.syncErrorThrown))throw e.syncErrorValue;return e},i.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(o){sd.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=o),sm(e)?e.error(o):console.warn(o)}},i.prototype.forEach=function(e,o){var c=this;return new(o=Fr(o))(function(_,$){var _t=c.subscribe(function(ga){try{e(ga)}catch(_s){$(_s),_t&&_t.unsubscribe()}},$,_)})},i.prototype._subscribe=function(e){var o=this.source;return o&&o.subscribe(e)},i.prototype[Xg]=function(){return this},i.prototype.pipe=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return e.length===0?this:Er(e)(this)},i.prototype.toPromise=function(e){var o=this;return new(e=Fr(e))(function(c,_){var $;o.subscribe(function(_t){return $=_t},function(_t){return _(_t)},function(){return c($)})})},i.create=function(e){return new i(e)},i}(),Cf=function(){function i(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return i.prototype=Object.create(Error.prototype),i}(),ew=function(i){function e(o,c){var _=i.call(this)||this;return _.subject=o,_.subscriber=c,_.closed=!1,_}return Ca(e,i),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var o=this.subject,c=o.observers;this.subject=null,!c||c.length===0||o.isStopped||o.closed||(o=c.indexOf(this.subscriber))!==-1&&c.splice(o,1)}},e}(dc),fw=function(i){function e(o){var c=i.call(this,o)||this;return c.destination=o,c}return Ca(e,i),e}(hb),ec=function(i){function e(){var o=i.call(this)||this;return o.observers=[],o.closed=!1,o.isStopped=!1,o.hasError=!1,o.thrownError=null,o}return Ca(e,i),e.prototype[Xk]=function(){return new fw(this)},e.prototype.lift=function(o){var c=new gw(this,this);return c.operator=o,c},e.prototype.next=function(o){if(this.closed)throw new Cf;if(!this.isStopped){var c=this.observers,_=c.length;c=c.slice();for(var $=0;$<_;$++)c[$].next(o)}},e.prototype.error=function(o){if(this.closed)throw new Cf;this.hasError=!0,this.thrownError=o,this.isStopped=!0;var c=this.observers,_=c.length;c=c.slice();for(var $=0;$<_;$++)c[$].error(o);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new Cf;this.isStopped=!0;var o=this.observers,c=o.length;o=o.slice();for(var _=0;_<c;_++)o[_].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.closed=this.isStopped=!0,this.observers=null},e.prototype._trySubscribe=function(o){if(this.closed)throw new Cf;return i.prototype._trySubscribe.call(this,o)},e.prototype._subscribe=function(o){if(this.closed)throw new Cf;return this.hasError?(o.error(this.thrownError),dc.EMPTY):this.isStopped?(o.complete(),dc.EMPTY):(this.observers.push(o),new ew(this,o))},e.prototype.asObservable=function(){var o=new Za;return o.source=this,o},e.create=function(o,c){return new gw(o,c)},e}(Za),gw=function(i){function e(o,c){var _=i.call(this)||this;return _.destination=o,_.source=c,_}return Ca(e,i),e.prototype.next=function(o){var c=this.destination;c&&c.next&&c.next(o)},e.prototype.error=function(o){var c=this.destination;c&&c.error&&this.destination.error(o)},e.prototype.complete=function(){var o=this.destination;o&&o.complete&&this.destination.complete()},e.prototype._subscribe=function(o){return this.source?this.source.subscribe(o):dc.EMPTY},e}(ec),hB=function(){function i(e){this.connectable=e}return i.prototype.call=function(e,o){var c=this.connectable;return c._refCount++,e=new vH(e,c),o=o.subscribe(e),e.closed||(e.connection=c.connect()),o},i}(),vH=function(i){function e(o,c){return(o=i.call(this,o)||this).connectable=c,o}return Ca(e,i),e.prototype._unsubscribe=function(){var o=this.connectable;if(o){this.connectable=null;var c=o._refCount;0>=c?this.connection=null:(o._refCount=c-1,1<c?this.connection=null:(c=this.connection,o=o._connection,this.connection=null,!o||c&&o!==c||o.unsubscribe()))}else this.connection=null},e}(hb),hw=function(i){function e(o,c){var _=i.call(this)||this;return _.source=o,_.subjectFactory=c,_._refCount=0,_._isComplete=!1,_}return Ca(e,i),e.prototype._subscribe=function(o){return this.getSubject().subscribe(o)},e.prototype.getSubject=function(){var o=this._subject;return o&&!o.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var o=this._connection;return o||(this._isComplete=!1,(o=this._connection=new dc).add(this.source.subscribe(new wH(this.getSubject(),this))),o.closed&&(this._connection=null,o=dc.EMPTY)),o},e.prototype.refCount=function(){return Gr()(this)},e}(Za),WB=function(){var i=hw.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:i._subscribe},_isComplete:{value:i._isComplete,writable:!0},getSubject:{value:i.getSubject},connect:{value:i.connect},refCount:{value:i.refCount}}}(),wH=function(i){function e(o,c){return(o=i.call(this,o)||this).connectable=c,o}return Ca(e,i),e.prototype._error=function(o){this._unsubscribe(),i.prototype._error.call(this,o)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),i.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var o=this.connectable;if(o){this.connectable=null;var c=o._connection;o._refCount=0,o._subject=null,o._connection=null,c&&c.unsubscribe()}},e}(fw);(function(i){function e(o,c){return(o=i.call(this,o)||this).connectable=c,o}Ca(e,i),e.prototype._unsubscribe=function(){var o=this.connectable;if(o){this.connectable=null;var c=o._refCount;0>=c?this.connection=null:(o._refCount=c-1,1<c?this.connection=null:(c=this.connection,o=o._connection,this.connection=null,!o||c&&o!==c||o.unsubscribe()))}else this.connection=null}})(hb),function(i){function e(o,c,_,$,_t){return(o=i.call(this,o)||this).keySelector=c,o.elementSelector=_,o.durationSelector=$,o.subjectSelector=_t,o.groups=null,o.attemptedToUnsubscribe=!1,o.count=0,o}Ca(e,i),e.prototype._next=function(o){try{var c=this.keySelector(o)}catch(_){return void this.error(_)}this._group(o,c)},e.prototype._group=function(o,c){var _=this.groups;_||(_=this.groups=new Map);var $=_.get(c);if(this.elementSelector)try{var _t=this.elementSelector(o)}catch(ga){this.error(ga)}else _t=o;if(!$&&($=this.subjectSelector?this.subjectSelector():new ec,_.set(c,$),o=new Uo(c,$,this),this.destination.next(o),this.durationSelector)){o=void 0;try{o=this.durationSelector(new Uo(c,$))}catch(ga){return void this.error(ga)}this.add(o.subscribe(new xH(c,$,this)))}$.closed||$.next(_t)},e.prototype._error=function(o){var c=this.groups;c&&(c.forEach(function(_,$){_.error(o)}),c.clear()),this.destination.error(o)},e.prototype._complete=function(){var o=this.groups;o&&(o.forEach(function(c,_){c.complete()}),o.clear()),this.destination.complete()},e.prototype.removeGroup=function(o){this.groups.delete(o)},e.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,this.count===0&&i.prototype.unsubscribe.call(this))}}(hb);var xH=function(i){function e(o,c,_){var $=i.call(this,c)||this;return $.key=o,$.group=c,$.parent=_,$}return Ca(e,i),e.prototype._next=function(o){this.complete()},e.prototype._unsubscribe=function(){var o=this.parent,c=this.key;this.key=this.parent=null,o&&o.removeGroup(c)},e}(hb),Uo=function(i){function e(o,c,_){var $=i.call(this)||this;return $.key=o,$.groupSubject=c,$.refCountSubscription=_,$}return Ca(e,i),e.prototype._subscribe=function(o){var c=new dc,_=this.refCountSubscription,$=this.groupSubject;return _&&!_.closed&&c.add(new yH(_)),c.add($.subscribe(o)),c},e}(Za),yH=function(i){function e(o){var c=i.call(this)||this;return c.parent=o,o.count++,c}return Ca(e,i),e.prototype.unsubscribe=function(){var o=this.parent;o.closed||this.closed||(i.prototype.unsubscribe.call(this),--o.count,o.count===0&&o.attemptedToUnsubscribe&&o.unsubscribe())},e}(dc),zH=function(i){function e(o){var c=i.call(this)||this;return c._value=o,c}return Ca(e,i),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(o){var c=i.prototype._subscribe.call(this,o);return c&&!c.closed&&o.next(this._value),c},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Cf;return this._value},e.prototype.next=function(o){i.prototype.next.call(this,this._value=o)},e}(ec),dj=function(i){function e(o,c){var _=i.call(this,o,c)||this;return _.scheduler=o,_.work=c,_.pending=!1,_}return Ca(e,i),e.prototype.schedule=function(o,c){if(c===void 0&&(c=0),this.closed)return this;this.state=o,o=this.id;var _=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(_,o,c)),this.pending=!0,this.delay=c,this.id=this.id||this.requestAsyncId(_,this.id,c),this},e.prototype.requestAsyncId=function(o,c,_){return _===void 0&&(_=0),setInterval(o.flush.bind(o,this),_)},e.prototype.recycleAsyncId=function(o,c,_){if(_===void 0&&(_=0),_!==null&&this.delay===_&&this.pending===!1)return c;clearInterval(c)},e.prototype.execute=function(o,c){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(o=this._execute(o,c))?o:void(this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},e.prototype._execute=function(o,c){c=!1;var _=void 0;try{this.work(o)}catch($){c=!0,_=!!$&&$||Error($)}if(c)return this.unsubscribe(),_},e.prototype._unsubscribe=function(){var o=this.id,c=this.scheduler,_=c.actions,$=_.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,$!==-1&&_.splice($,1),o!=null&&(this.id=this.recycleAsyncId(c,o,null)),this.delay=null},e}(function(i){function e(o,c){return i.call(this)||this}return Ca(e,i),e.prototype.schedule=function(o,c){return this},e}(dc)),AH=function(i){function e(o,c){var _=i.call(this,o,c)||this;return _.scheduler=o,_.work=c,_}return Ca(e,i),e.prototype.schedule=function(o,c){return c===void 0&&(c=0),0<c?i.prototype.schedule.call(this,o,c):(this.delay=c,this.state=o,this.scheduler.flush(this),this)},e.prototype.execute=function(o,c){return 0<c||this.closed?i.prototype.execute.call(this,o,c):this._execute(o,c)},e.prototype.requestAsyncId=function(o,c,_){return _===void 0&&(_=0),_!==null&&0<_||_===null&&0<this.delay?i.prototype.requestAsyncId.call(this,o,c,_):o.flush(this)},e}(dj),Vo=function(){function i(e,o){o===void 0&&(o=i.now),this.SchedulerAction=e,this.now=o}return i.prototype.schedule=function(e,o,c){return o===void 0&&(o=0),new this.SchedulerAction(this,e).schedule(c,o)},i.now=function(){return Date.now()},i}(),ej=function(i){function e(o,c){c===void 0&&(c=Vo.now);var _=i.call(this,o,function(){return e.delegate&&e.delegate!==_?e.delegate.now():c()})||this;return _.actions=[],_.active=!1,_.scheduled=void 0,_}return Ca(e,i),e.prototype.schedule=function(o,c,_){return c===void 0&&(c=0),e.delegate&&e.delegate!==this?e.delegate.schedule(o,c,_):i.prototype.schedule.call(this,o,c,_)},e.prototype.flush=function(o){var c=this.actions;if(this.active)c.push(o);else{var _;this.active=!0;do if(_=o.execute(o.state,o.delay))break;while(o=c.shift());if(this.active=!1,_){for(;o=c.shift();)o.unsubscribe();throw _}}},e}(Vo),fj=new(function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return Ca(e,i),e}(ej))(AH),$c=new Za(function(i){return i.complete()}),Hr=function(i){return function(e){for(var o=0,c=i.length;o<c&&!e.closed;o++)e.next(i[o]);e.complete()}},Wo;(function(i){i.NEXT="N",i.ERROR="E",i.COMPLETE="C"})(Wo||(Wo={}));var Eh=function(){function i(e,o,c){this.kind=e,this.value=o,this.error=c,this.hasValue=e==="N"}return i.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},i.prototype.do=function(e,o,c){switch(this.kind){case"N":return e&&e(this.value);case"E":return o&&o(this.error);case"C":return c&&c()}},i.prototype.accept=function(e,o,c){return e&&typeof e.next=="function"?this.observe(e):this.do(e,o,c)},i.prototype.toObservable=function(){switch(this.kind){case"N":return Wb(this.value);case"E":return Va(this.error);case"C":return ji()}throw Error("unexpected notification kind value")},i.createNext=function(e){return e!==void 0?new i("N",e):i.undefinedValueNotification},i.createError=function(e){return new i("E",void 0,e)},i.createComplete=function(){return i.completeNotification},i.completeNotification=new i("C"),i.undefinedValueNotification=new i("N",void 0),i}(),lB=function(){function i(e,o){o===void 0&&(o=0),this.scheduler=e,this.delay=o}return i.prototype.call=function(e,o){return o.subscribe(new iw(e,this.scheduler,this.delay))},i}(),iw=function(i){function e(o,c,_){return _===void 0&&(_=0),(o=i.call(this,o)||this).scheduler=c,o.delay=_,o}return Ca(e,i),e.dispatch=function(o){o.notification.observe(o.destination),this.unsubscribe()},e.prototype.scheduleMessage=function(o){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new BH(o,this.destination)))},e.prototype._next=function(o){this.scheduleMessage(Eh.createNext(o))},e.prototype._error=function(o){this.scheduleMessage(Eh.createError(o)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(Eh.createComplete()),this.unsubscribe()},e}(hb),BH=function(i,e){this.notification=i,this.destination=e},ah=function(i){function e(o,c,_){o===void 0&&(o=Number.POSITIVE_INFINITY),c===void 0&&(c=Number.POSITIVE_INFINITY);var $=i.call(this)||this;return $.scheduler=_,$._events=[],$._infiniteTimeWindow=!1,$._bufferSize=1>o?1:o,$._windowTime=1>c?1:c,c===Number.POSITIVE_INFINITY?($._infiniteTimeWindow=!0,$.next=$.nextInfiniteTimeWindow):$.next=$.nextTimeWindow,$}return Ca(e,i),e.prototype.nextInfiniteTimeWindow=function(o){if(!this.isStopped){var c=this._events;c.push(o),c.length>this._bufferSize&&c.shift()}i.prototype.next.call(this,o)},e.prototype.nextTimeWindow=function(o){this.isStopped||(this._events.push(new CH(this._getNow(),o)),this._trimBufferThenGetEvents()),i.prototype.next.call(this,o)},e.prototype._subscribe=function(o){var c=this._infiniteTimeWindow,_=c?this._events:this._trimBufferThenGetEvents(),$=this.scheduler,_t=_.length;if(this.closed)throw new Cf;if(this.isStopped||this.hasError)var ga=dc.EMPTY;else this.observers.push(o),ga=new ew(this,o);if($&&o.add(o=new iw(o,$)),c)for(c=0;c<_t&&!o.closed;c++)o.next(_[c]);else for(c=0;c<_t&&!o.closed;c++)o.next(_[c].value);return this.hasError?o.error(this.thrownError):this.isStopped&&o.complete(),ga},e.prototype._getNow=function(){return(this.scheduler||fj).now()},e.prototype._trimBufferThenGetEvents=function(){for(var o=this._getNow(),c=this._bufferSize,_=this._windowTime,$=this._events,_t=$.length,ga=0;ga<_t&&!(o-$[ga].time<_);)ga++;return _t>c&&(ga=Math.max(ga,_t-c)),0<ga&&$.splice(0,ga),$},e}(ec),CH=function(i,e){this.time=i,this.value=e},li=function(i){function e(){var o=i!==null&&i.apply(this,arguments)||this;return o.value=null,o.hasNext=!1,o.hasCompleted=!1,o}return Ca(e,i),e.prototype._subscribe=function(o){return this.hasError?(o.error(this.thrownError),dc.EMPTY):this.hasCompleted&&this.hasNext?(o.next(this.value),o.complete(),dc.EMPTY):i.prototype._subscribe.call(this,o)},e.prototype.next=function(o){this.hasCompleted||(this.value=o,this.hasNext=!0)},e.prototype.error=function(o){this.hasCompleted||i.prototype.error.call(this,o)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&i.prototype.next.call(this,this.value),i.prototype.complete.call(this)},e}(ec),DH=1,EH=Promise.resolve(),vm={},jw={setImmediate:function(i){var e=DH++;return vm[e]=!0,EH.then(function(){return Ir(e)&&i()}),e},clearImmediate:function(i){Ir(i)}},FH=function(i){function e(o,c){var _=i.call(this,o,c)||this;return _.scheduler=o,_.work=c,_}return Ca(e,i),e.prototype.requestAsyncId=function(o,c,_){return _===void 0&&(_=0),_!==null&&0<_?i.prototype.requestAsyncId.call(this,o,c,_):(o.actions.push(this),o.scheduled||(o.scheduled=jw.setImmediate(o.flush.bind(o,null))))},e.prototype.recycleAsyncId=function(o,c,_){if(_===void 0&&(_=0),_!==null&&0<_||_===null&&0<this.delay)return i.prototype.recycleAsyncId.call(this,o,c,_);o.actions.length===0&&(jw.clearImmediate(c),o.scheduled=void 0)},e}(dj),Fm=new(function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return Ca(e,i),e.prototype.flush=function(o){this.active=!0,this.scheduled=void 0;var c,_=this.actions,$=-1,_t=_.length;o=o||_.shift();do if(c=o.execute(o.state,o.delay))break;while(++$<_t&&(o=_.shift()));if(this.active=!1,c){for(;++$<_t&&(o=_.shift());)o.unsubscribe();throw c}},e}(ej))(FH),GH=Fm,Xo=new ej(dj),Ee=Xo,HH=function(i){function e(o,c){var _=i.call(this,o,c)||this;return _.scheduler=o,_.work=c,_}return Ca(e,i),e.prototype.requestAsyncId=function(o,c,_){return _===void 0&&(_=0),_!==null&&0<_?i.prototype.requestAsyncId.call(this,o,c,_):(o.actions.push(this),o.scheduled||(o.scheduled=requestAnimationFrame(function(){return o.flush(null)})))},e.prototype.recycleAsyncId=function(o,c,_){if(_===void 0&&(_=0),_!==null&&0<_||_===null&&0<this.delay)return i.prototype.recycleAsyncId.call(this,o,c,_);o.actions.length===0&&(cancelAnimationFrame(c),o.scheduled=void 0)},e}(dj),kw=new(function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return Ca(e,i),e.prototype.flush=function(o){this.active=!0,this.scheduled=void 0;var c,_=this.actions,$=-1,_t=_.length;o=o||_.shift();do if(c=o.execute(o.state,o.delay))break;while(++$<_t&&(o=_.shift()));if(this.active=!1,c){for(;++$<_t&&(o=_.shift());)o.unsubscribe();throw c}},e}(ej))(HH),IH=function(i){function e(o,c){o===void 0&&(o=lw),c===void 0&&(c=Number.POSITIVE_INFINITY);var _=i.call(this,o,function(){return _.frame})||this;return _.maxFrames=c,_.frame=0,_.index=-1,_}return Ca(e,i),e.prototype.flush=function(){for(var o,c,_=this.actions,$=this.maxFrames;(c=_[0])&&c.delay<=$&&(_.shift(),this.frame=c.delay,!(o=c.execute(c.state,c.delay))););if(o){for(;c=_.shift();)c.unsubscribe();throw o}},e.frameTimeFactor=10,e}(ej),lw=function(i){function e(o,c,_){_===void 0&&(_=o.index+=1);var $=i.call(this,o,c)||this;return $.scheduler=o,$.work=c,$.index=_,$.active=!0,$.index=o.index=_,$}return Ca(e,i),e.prototype.schedule=function(o,c){if(c===void 0&&(c=0),!this.id)return i.prototype.schedule.call(this,o,c);this.active=!1;var _=new e(this.scheduler,this.work);return this.add(_),_.schedule(o,c)},e.prototype.requestAsyncId=function(o,c,_){return _===void 0&&(_=0),this.delay=o.frame+_,(o=o.actions).push(this),o.sort(e.sortActions),!0},e.prototype.recycleAsyncId=function(o,c,_){},e.prototype._execute=function(o,c){if(this.active===!0)return i.prototype._execute.call(this,o,c)},e.sortActions=function(o,c){return o.delay===c.delay?o.index===c.index?0:o.index>c.index?1:-1:o.delay>c.delay?1:-1},e}(dj),Yo=function(){function i(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return i.prototype=Object.create(Error.prototype),i}(),Lj=function(){function i(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return i.prototype=Object.create(Error.prototype),i}(),ad=function(){function i(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return i.prototype=Object.create(Error.prototype),i}(),mB=function(){function i(e,o){this.project=e,this.thisArg=o}return i.prototype.call=function(e,o){return o.subscribe(new JH(e,this.project,this.thisArg))},i}(),JH=function(i){function e(o,c,_){return(o=i.call(this,o)||this).project=c,o.count=0,o.thisArg=_||o,o}return Ca(e,i),e.prototype._next=function(o){try{var c=this.project.call(this.thisArg,o,this.count++)}catch(_){return void this.destination.error(_)}this.destination.next(c)},e}(hb),Zo=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return Ca(e,i),e.prototype.notifyNext=function(o,c,_,$,_t){this.destination.next(c)},e.prototype.notifyError=function(o,c){this.destination.error(o)},e.prototype.notifyComplete=function(o){this.destination.complete()},e}(hb),rB=function(i){function e(o,c,_){var $=i.call(this)||this;return $.parent=o,$.outerValue=c,$.outerIndex=_,$.index=0,$}return Ca(e,i),e.prototype._next=function(o){this.parent.notifyNext(this.outerValue,o,this.outerIndex,this.index++,this)},e.prototype._error=function(o){this.parent.notifyError(o,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(hb),KH=function(i){return function(e){return i.then(function(o){e.closed||(e.next(o),e.complete())},function(o){return e.error(o)}).then(null,Wg),e}},kf=typeof Symbol=="function"&&Symbol.iterator?Symbol.iterator:"@@iterator",LH=function(i){return function(e){for(var o=i[kf]();;){var c=void 0;try{c=o.next()}catch(_){return e.error(_),e}if(c.done){e.complete();break}if(e.next(c.value),e.closed)break}return typeof o.return=="function"&&e.add(function(){o.return&&o.return()}),e}},MH=function(i){return function(e){var o=i[Xg]();if(typeof o.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return o.subscribe(e)}},Or=function(i){return i&&typeof i.length=="number"&&typeof i!="function"},mi=function(i){if(i&&typeof i[Xg]=="function")return MH(i);if(Or(i))return Hr(i);if(Mr(i))return KH(i);if(i&&typeof i[kf]=="function")return LH(i);throw i=rm(i)?"an invalid object":"'"+i+"'",new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},mw={},OH=function(){function i(e){this.resultSelector=e}return i.prototype.call=function(e,o){return o.subscribe(new NH(e,this.resultSelector))},i}(),NH=function(i){function e(o,c){return(o=i.call(this,o)||this).resultSelector=c,o.active=0,o.values=[],o.observables=[],o}return Ca(e,i),e.prototype._next=function(o){this.values.push(mw),this.observables.push(o)},e.prototype._complete=function(){var o=this.observables,c=o.length;if(c===0)this.destination.complete();else{this.toRespond=this.active=c;for(var _=0;_<c;_++)this.add(wm(this,o[_],void 0,_))}},e.prototype.notifyComplete=function(o){--this.active==0&&this.destination.complete()},e.prototype.notifyNext=function(o,c,_){var $=(o=this.values)[_];$=this.toRespond?$===mw?--this.toRespond:this.toRespond:0,o[_]=c,$===0&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},e.prototype._tryResultSelector=function(o){try{var c=this.resultSelector.apply(this,o)}catch(_){return void this.destination.error(_)}this.destination.next(c)},e}(Zo),Qe=function(i){function e(o){var c=i.call(this)||this;return c.parent=o,c}return Ca(e,i),e.prototype._next=function(o){this.parent.notifyNext(o)},e.prototype._error=function(o){this.parent.notifyError(o),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(hb);(function(i){function e(o,c,_){var $=i.call(this)||this;return $.parent=o,$.outerValue=c,$.outerIndex=_,$}Ca(e,i),e.prototype._next=function(o){this.parent.notifyNext(this.outerValue,o,this.outerIndex,this)},e.prototype._error=function(o){this.parent.notifyError(o),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()}})(hb);var Re=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return Ca(e,i),e.prototype.notifyNext=function(o){this.destination.next(o)},e.prototype.notifyError=function(o){this.destination.error(o)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(hb);(function(i){function e(){return i!==null&&i.apply(this,arguments)||this}Ca(e,i),e.prototype.notifyNext=function(o,c,_,$){this.destination.next(c)},e.prototype.notifyError=function(o){this.destination.error(o)},e.prototype.notifyComplete=function(o){this.destination.complete()}})(hb);var vB=function(){function i(e,o){o===void 0&&(o=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=o}return i.prototype.call=function(e,o){return o.subscribe(new PH(e,this.project,this.concurrent))},i}(),PH=function(i){function e(o,c,_){return _===void 0&&(_=Number.POSITIVE_INFINITY),(o=i.call(this,o)||this).project=c,o.concurrent=_,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return Ca(e,i),e.prototype._next=function(o){this.active<this.concurrent?this._tryNext(o):this.buffer.push(o)},e.prototype._tryNext=function(o){var c=this.index++;try{var _=this.project(o,c)}catch($){return void this.destination.error($)}this.active++,this._innerSub(_)},e.prototype._innerSub=function(o){var c=new Qe(this),_=this.destination;_.add(c),(o=De(o,c))!==c&&_.add(o)},e.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(o){this.destination.next(o)},e.prototype.notifyComplete=function(){var o=this.buffer;this.active--,0<o.length?this._next(o.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},e}(Re),$o=na.parseFloat,nw=-1/0!=1/$o(`	
\v\f\r \u2028\u2029\uFEFF-0`)?function(i){i=kk(String(i));var e=$o(i);return e===0&&i.charAt(0)=="-"?-0:e}:$o;wa({global:!0,forced:parseFloat!=nw},{parseFloat:nw});var ap=new Za(fe),AB=function(){function i(e,o){this.predicate=e,this.thisArg=o}return i.prototype.call=function(e,o){return o.subscribe(new QH(e,this.predicate,this.thisArg))},i}(),QH=function(i){function e(o,c,_){return(o=i.call(this,o)||this).predicate=c,o.thisArg=_,o.count=0,o}return Ca(e,i),e.prototype._next=function(o){try{var c=this.predicate.call(this.thisArg,o,this.count++)}catch(_){return void this.destination.error(_)}c&&this.destination.next(o)},e}(hb),BB=function(){function i(){}return i.prototype.call=function(e,o){return o.subscribe(new RH(e))},i}(),RH=function(i){function e(o){return(o=i.call(this,o)||this).hasFirst=!1,o.observables=[],o.subscriptions=[],o}return Ca(e,i),e.prototype._next=function(o){this.observables.push(o)},e.prototype._complete=function(){var o=this.observables,c=o.length;if(c===0)this.destination.complete();else{for(var _=0;_<c&&!this.hasFirst;_++){var $=wm(this,o[_],void 0,_);this.subscriptions&&this.subscriptions.push($),this.add($)}this.observables=null}},e.prototype.notifyNext=function(o,c,_){if(!this.hasFirst){for(this.hasFirst=!0,o=0;o<this.subscriptions.length;o++)if(o!==_){var $=this.subscriptions[o];$.unsubscribe(),this.remove($)}this.subscriptions=null}this.destination.next(c)},e}(Zo),EB=function(){function i(e){this.resultSelector=e}return i.prototype.call=function(e,o){return o.subscribe(new SH(e,this.resultSelector))},i}(),SH=function(i){function e(o,c,_){return(o=i.call(this,o)||this).resultSelector=c,o.iterators=[],o.active=0,o.resultSelector=typeof c=="function"?c:void 0,o}return Ca(e,i),e.prototype._next=function(o){var c=this.iterators;td(o)?c.push(new TH(o)):typeof o[kf]=="function"?c.push(new UH(o[kf]())):c.push(new VH(this.destination,this,o))},e.prototype._complete=function(){var o=this.iterators,c=o.length;if(this.unsubscribe(),c===0)this.destination.complete();else{this.active=c;for(var _=0;_<c;_++){var $=o[_];$.stillUnsubscribed?this.destination.add($.subscribe()):this.active--}}},e.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},e.prototype.checkIterators=function(){for(var o=this.iterators,c=o.length,_=this.destination,$=0;$<c;$++){var _t=o[$];if(typeof _t.hasValue=="function"&&!_t.hasValue())return}var ga=!1,_s=[];for($=0;$<c;$++){var _c=(_t=o[$]).next();if(_t.hasCompleted()&&(ga=!0),_c.done)return void _.complete();_s.push(_c.value)}this.resultSelector?this._tryresultSelector(_s):_.next(_s),ga&&_.complete()},e.prototype._tryresultSelector=function(o){try{var c=this.resultSelector.apply(this,o)}catch(_){return void this.destination.error(_)}this.destination.next(c)},e}(hb),UH=function(){function i(e){this.iterator=e,this.nextResult=e.next()}return i.prototype.hasValue=function(){return!0},i.prototype.next=function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e},i.prototype.hasCompleted=function(){var e=this.nextResult;return!(!e||!e.done)},i}(),TH=function(){function i(e){this.array=e,this.length=this.index=0,this.length=e.length}return i.prototype[kf]=function(){return this},i.prototype.next=function(e){e=this.index++;var o=this.array;return e<this.length?{value:o[e],done:!1}:{value:null,done:!0}},i.prototype.hasValue=function(){return this.array.length>this.index},i.prototype.hasCompleted=function(){return this.array.length===this.index},i}(),VH=function(i){function e(o,c,_){return(o=i.call(this,o)||this).parent=c,o.observable=_,o.stillUnsubscribed=!0,o.buffer=[],o.isComplete=!1,o}return Ca(e,i),e.prototype[kf]=function(){return this},e.prototype.next=function(){var o=this.buffer;return o.length===0&&this.isComplete?{value:null,done:!0}:{value:o.shift(),done:!1}},e.prototype.hasValue=function(){return 0<this.buffer.length},e.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},e.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(o){this.buffer.push(o),this.parent.checkIterators()},e.prototype.subscribe=function(){return De(this.observable,new Qe(this))},e}(Re),WH=Object.freeze({__proto__:null,Observable:Za,ConnectableObservable:hw,GroupedObservable:Uo,observable:Xg,Subject:ec,BehaviorSubject:zH,ReplaySubject:ah,AsyncSubject:li,asap:GH,asapScheduler:Fm,async:Ee,asyncScheduler:Xo,queue:fj,queueScheduler:fj,animationFrame:kw,animationFrameScheduler:kw,VirtualTimeScheduler:IH,VirtualAction:lw,Scheduler:Vo,Subscription:dc,Subscriber:hb,Notification:Eh,get NotificationKind(){return Wo},pipe:tm,noop:fe,identity:jf,isObservable:function(i){return!!i&&(i instanceof Za||typeof i.lift=="function"&&typeof i.subscribe=="function")},ArgumentOutOfRangeError:Yo,EmptyError:Lj,ObjectUnsubscribedError:Cf,UnsubscriptionError:ii,TimeoutError:ad,bindCallback:Jr,bindNodeCallback:Kr,combineLatest:function(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];var o=e=void 0;return Ce(i[i.length-1])&&(o=i.pop()),typeof i[i.length-1]=="function"&&(e=i.pop()),i.length===1&&td(i[0])&&(i=i[0]),ki(i,o).lift(new OH(e))},concat:Pr,defer:lf,empty:ji,forkJoin:function(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];if(i.length===1){var o=i[0];if(td(o))return Jj(o,null);if(rm(o)&&Object.getPrototypeOf(o)===Object.prototype)return Jj((i=Object.keys(o)).map(function(_){return o[_]}),i)}if(typeof i[i.length-1]=="function"){var c=i.pop();return Jj(i=i.length===1&&td(i[0])?i[0]:i,null).pipe(Wa(function(_){return c.apply(void 0,_)}))}return Jj(i,null)},from:ge,fromEvent:Bc,fromEventPattern:Rr,generate:function(i,e,o,c,_){if(arguments.length==1){var $=i.initialState;e=i.condition,o=i.iterate;var _t=i.resultSelector||jf;_=i.scheduler}else c===void 0||Ce(c)?($=i,_t=jf,_=c):($=i,_t=c);return new Za(function(ga){var _s=$;if(_)return _.schedule(wB,0,{subscriber:ga,iterate:o,condition:e,resultSelector:_t,state:_s});for(;;){if(e){var _c=void 0;try{_c=e(_s)}catch(_l){ga.error(_l);break}if(!_c){ga.complete();break}}_c=void 0;try{_c=_t(_s)}catch(_l){ga.error(_l);break}if(ga.next(_c),ga.closed)break;try{_s=o(_s)}catch(_l){ga.error(_l);break}}})},iif:function(i,e,o){return e===void 0&&(e=$c),o===void 0&&(o=$c),lf(function(){return i()?e:o})},interval:Yg,merge:Nc,never:function(){return ap},of:Wb,onErrorResumeNext:ym,pairs:function(i,e){return new Za(e?function(o){var c=Object.keys(i),_=new dc;return _.add(e.schedule(yB,0,{keys:c,index:0,subscriber:o,subscription:_,obj:i})),_}:function(o){for(var c=Object.keys(i),_=0;_<c.length&&!o.closed;_++){var $=c[_];i.hasOwnProperty($)&&o.next([$,i[$]])}o.complete()})},partition:function(i,e,o){return[sc(e,o)(new Za(mi(i))),sc(zB(e,o))(new Za(mi(i)))]},race:bb,range:function(i,e,o){return i===void 0&&(i=0),new Za(function(c){e===void 0&&(e=i,i=0);var _=0,$=i;if(o)return o.schedule(CB,0,{index:_,count:e,start:i,subscriber:c});for(;;){if(_++>=e){c.complete();break}if(c.next($++),c.closed)break}})},throwError:Va,timer:Fe,using:function(i,e){return new Za(function(o){try{var c=i()}catch(_t){return void o.error(_t)}try{var _=e(c)}catch(_t){return void o.error(_t)}var $=(_?ge(_):$c).subscribe(o);return function(){$.unsubscribe(),c&&c.unsubscribe()}})},zip:zm,scheduled:Nr,EMPTY:$c,NEVER:ap,config:sd}),FB=function(){function i(e,o,c,_){this.bufferTimeSpan=e,this.bufferCreationInterval=o,this.maxBufferSize=c,this.scheduler=_}return i.prototype.call=function(e,o){return o.subscribe(new XH(e,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},i}(),YH=function(){this.buffer=[]},XH=function(i){function e(o,c,_,$,_t){if((o=i.call(this,o)||this).bufferTimeSpan=c,o.bufferCreationInterval=_,o.maxBufferSize=$,o.scheduler=_t,o.contexts=[],$=o.openContext(),o.timespanOnly=_==null||0>_,o.timespanOnly)o.add($.closeAction=_t.schedule(Sr,c,{subscriber:o,context:$,bufferTimeSpan:c}));else{var ga={bufferTimeSpan:c,bufferCreationInterval:_,subscriber:o,scheduler:_t};o.add($.closeAction=_t.schedule(Tr,c,{subscriber:o,context:$})),o.add(_t.schedule(GB,_,ga))}return o}return Ca(e,i),e.prototype._next=function(o){for(var c,_=this.contexts,$=_.length,_t=0;_t<$;_t++){var ga=_[_t],_s=ga.buffer;_s.push(o),_s.length==this.maxBufferSize&&(c=ga)}c&&this.onBufferFull(c)},e.prototype._error=function(o){this.contexts.length=0,i.prototype._error.call(this,o)},e.prototype._complete=function(){for(var o=this.contexts,c=this.destination;0<o.length;){var _=o.shift();c.next(_.buffer)}i.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.contexts=null},e.prototype.onBufferFull=function(o){if(this.closeContext(o),(o=o.closeAction).unsubscribe(),this.remove(o),!this.closed&&this.timespanOnly){o=this.openContext();var c=this.bufferTimeSpan;this.add(o.closeAction=this.scheduler.schedule(Sr,c,{subscriber:this,context:o,bufferTimeSpan:c}))}},e.prototype.openContext=function(){var o=new YH;return this.contexts.push(o),o},e.prototype.closeContext=function(o){this.destination.next(o.buffer);var c=this.contexts;0<=(c?c.indexOf(o):-1)&&c.splice(c.indexOf(o),1)},e}(hb),HB=function(){function i(e){this.selector=e}return i.prototype.call=function(e,o){return o.subscribe(new ZH(e,this.selector,this.caught))},i}(),ZH=function(i){function e(o,c,_){return(o=i.call(this,o)||this).selector=c,o.caught=_,o}return Ca(e,i),e.prototype.error=function(o){if(!this.isStopped){var c=void 0;try{c=this.selector(o,this.caught)}catch(_){return void i.prototype.error.call(this,_)}this._unsubscribeAndRecycle(),o=new Qe(this),this.add(o),(c=De(c,o))!==o&&this.add(c)}},e}(Re),IB=function(){function i(e){this.defaultValue=e}return i.prototype.call=function(e,o){return o.subscribe(new $H(e,this.defaultValue))},i}(),$H=function(i){function e(o,c){return(o=i.call(this,o)||this).defaultValue=c,o.isEmpty=!0,o}return Ca(e,i),e.prototype._next=function(o){this.isEmpty=!1,this.destination.next(o)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(hb),JB=function(){function i(e,o){this.delay=e,this.scheduler=o}return i.prototype.call=function(e,o){return o.subscribe(new aI(e,this.delay,this.scheduler))},i}(),aI=function(i){function e(o,c,_){return(o=i.call(this,o)||this).delay=c,o.scheduler=_,o.queue=[],o.active=!1,o.errored=!1,o}return Ca(e,i),e.dispatch=function(o){for(var c=o.source,_=c.queue,$=o.scheduler,_t=o.destination;0<_.length&&0>=_[0].time-$.now();)_.shift().notification.observe(_t);0<_.length?(c=Math.max(0,_[0].time-$.now()),this.schedule(o,c)):(this.unsubscribe(),c.active=!1)},e.prototype._schedule=function(o){this.active=!0,this.destination.add(o.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:o}))},e.prototype.scheduleNotification=function(o){if(this.errored!==!0){var c=this.scheduler;o=new bI(c.now()+this.delay,o),this.queue.push(o),this.active===!1&&this._schedule(c)}},e.prototype._next=function(o){this.scheduleNotification(Eh.createNext(o))},e.prototype._error=function(o){this.errored=!0,this.queue=[],this.destination.error(o),this.unsubscribe()},e.prototype._complete=function(){this.scheduleNotification(Eh.createComplete()),this.unsubscribe()},e}(hb),bI=function(i,e){this.time=i,this.notification=e},KB=function(){function i(e,o){this.keySelector=e,this.flushes=o}return i.prototype.call=function(e,o){return o.subscribe(new cI(e,this.keySelector,this.flushes))},i}(),cI=function(i){function e(o,c,_){return(o=i.call(this,o)||this).keySelector=c,o.values=new Set,_&&o.add(De(_,new Qe(o))),o}return Ca(e,i),e.prototype.notifyNext=function(){this.values.clear()},e.prototype.notifyError=function(o){this._error(o)},e.prototype._next=function(o){this.keySelector?this._useKeySelector(o):this._finalizeNext(o,o)},e.prototype._useKeySelector=function(o){var c=this.destination;try{var _=this.keySelector(o)}catch($){return void c.error($)}this._finalizeNext(_,o)},e.prototype._finalizeNext=function(o,c){var _=this.values;_.has(o)||(_.add(o),this.destination.next(c))},e}(Re),MB=function(){function i(e){this.errorFactory=e}return i.prototype.call=function(e,o){return o.subscribe(new dI(e,this.errorFactory))},i}(),dI=function(i){function e(o,c){return(o=i.call(this,o)||this).errorFactory=c,o.hasValue=!1,o}return Ca(e,i),e.prototype._next=function(o){this.hasValue=!0,this.destination.next(o)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var o=void 0;try{o=this.errorFactory()}catch(c){o=c}this.destination.error(o)},e}(hb),NB=function(){function i(e){if(this.total=e,0>this.total)throw new Yo}return i.prototype.call=function(e,o){return o.subscribe(new eI(e,this.total))},i}(),eI=function(i){function e(o,c){return(o=i.call(this,o)||this).total=c,o.count=0,o}return Ca(e,i),e.prototype._next=function(o){var c=this.total,_=++this.count;_<=c&&(this.destination.next(o),_===c&&(this.destination.complete(),this.unsubscribe()))},e}(hb),OB=function(){function i(e){this.callback=e}return i.prototype.call=function(e,o){return o.subscribe(new fI(e,this.callback))},i}(),fI=function(i){function e(o,c){return(o=i.call(this,o)||this).add(new dc(c)),o}return Ca(e,i),e}(hb),QB=function(){function i(){}return i.prototype.call=function(e,o){return o.subscribe(new gI(e))},i}(),gI=function(i){function e(){return i!==null&&i.apply(this,arguments)||this}return Ca(e,i),e.prototype._next=function(o){},e}(hb),RB=function(){function i(e){if(this.total=e,0>this.total)throw new Yo}return i.prototype.call=function(e,o){return o.subscribe(new hI(e,this.total))},i}(),hI=function(i){function e(o,c){return(o=i.call(this,o)||this).total=c,o.ring=[],o.count=0,o}return Ca(e,i),e.prototype._next=function(o){var c=this.ring,_=this.total,$=this.count++;c.length<_?c.push(o):c[$%_]=o},e.prototype._complete=function(){var o=this.destination,c=this.count;if(0<c)for(var _=this.count>=this.total?this.total:this.count,$=this.ring,_t=0;_t<_;_t++){var ga=c++%_;o.next($[ga])}o.complete()},e}(hb),SB=function(){function i(e){this.value=e}return i.prototype.call=function(e,o){return o.subscribe(new iI(e,this.value))},i}(),iI=function(i){function e(o,c){return(o=i.call(this,o)||this).value=c,o}return Ca(e,i),e.prototype._next=function(o){this.destination.next(this.value)},e}(hb),TB=function(){function i(e,o,c){c===void 0&&(c=!1),this.accumulator=e,this.seed=o,this.hasSeed=c}return i.prototype.call=function(e,o){return o.subscribe(new jI(e,this.accumulator,this.seed,this.hasSeed))},i}(),jI=function(i){function e(o,c,_,$){return(o=i.call(this,o)||this).accumulator=c,o._seed=_,o.hasSeed=$,o.index=0,o}return Ca(e,i),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(o){this.hasSeed=!0,this._seed=o},enumerable:!0,configurable:!0}),e.prototype._next=function(o){if(this.hasSeed)return this._tryNext(o);this.seed=o,this.destination.next(o)},e.prototype._tryNext=function(o){var c=this.index++;try{var _=this.accumulator(this.seed,o,c)}catch($){this.destination.error($)}this.seed=_,this.destination.next(_)},e}(hb),VB=function(){function i(e,o){this.subjectFactory=e,this.selector=o}return i.prototype.call=function(e,o){var c=this.selector,_=this.subjectFactory();return(e=c(_).subscribe(e)).add(o.subscribe(_)),e},i}(),XB=function(){function i(e,o){this.notifier=e,this.source=o}return i.prototype.call=function(e,o){return o.subscribe(new kI(e,this.notifier,this.source))},i}(),kI=function(i){function e(o,c,_){return(o=i.call(this,o)||this).notifier=c,o.source=_,o}return Ca(e,i),e.prototype.error=function(o){if(!this.isStopped){var c=this.errors,_=this.retries,$=this.retriesSubscription;if(_)this.retriesSubscription=this.errors=void 0;else{c=new ec;try{_=(0,this.notifier)(c)}catch(_t){return i.prototype.error.call(this,_t)}$=De(_,new Qe(this))}this._unsubscribeAndRecycle(),this.errors=c,this.retries=_,this.retriesSubscription=$,c.next(o)}},e.prototype._unsubscribe=function(){var o=this.errors,c=this.retriesSubscription;o&&(o.unsubscribe(),this.errors=void 0),c&&(c.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},e.prototype.notifyNext=function(){var o=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=o,this.source.subscribe(this)},e}(Re),$B=function(){function i(e){this.project=e}return i.prototype.call=function(e,o){return o.subscribe(new lI(e,this.project))},i}(),lI=function(i){function e(o,c){return(o=i.call(this,o)||this).project=c,o.index=0,o}return Ca(e,i),e.prototype._next=function(o){var c=this.index++;try{var _=this.project(o,c)}catch($){return void this.destination.error($)}this._innerSub(_)},e.prototype._innerSub=function(o){var c=this.innerSubscription;c&&c.unsubscribe(),c=new Qe(this);var _=this.destination;_.add(c),this.innerSubscription=De(o,c),this.innerSubscription!==c&&_.add(this.innerSubscription)},e.prototype._complete=function(){var o=this.innerSubscription;o&&!o.closed||i.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=void 0},e.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&i.prototype._complete.call(this)},e.prototype.notifyNext=function(o){this.destination.next(o)},e}(Re),aC=function(){function i(e){this.notifier=e}return i.prototype.call=function(e,o){e=new mI(e);var c=De(this.notifier,new Qe(e));return c&&!e.seenValue?(e.add(c),o.subscribe(e)):e},i}(),mI=function(i){function e(o){return(o=i.call(this,o)||this).seenValue=!1,o}return Ca(e,i),e.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},e.prototype.notifyComplete=function(){},e}(Re),bC=function(){function i(e,o,c){this.nextOrObserver=e,this.error=o,this.complete=c}return i.prototype.call=function(e,o){return o.subscribe(new nI(e,this.nextOrObserver,this.error,this.complete))},i}(),nI=function(i){function e(o,c,_,$){return(o=i.call(this,o)||this)._tapNext=fe,o._tapError=fe,o._tapComplete=fe,o._tapError=_||fe,o._tapComplete=$||fe,Vg(c)?(o._context=o,o._tapNext=c):c&&(o._context=c,o._tapNext=c.next||fe,o._tapError=c.error||fe,o._tapComplete=c.complete||fe),o}return Ca(e,i),e.prototype._next=function(o){try{this._tapNext.call(this._context,o)}catch(c){return void this.destination.error(c)}this.destination.next(o)},e.prototype._error=function(o){try{this._tapError.call(this._context,o)}catch(c){return void this.destination.error(c)}this.destination.error(o)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(o){return void this.destination.error(o)}return this.destination.complete()},e}(hb),dC={leading:!0,trailing:!1};(function(i){function e(o,c,_,$){var _t=i.call(this,o)||this;return _t.destination=o,_t.durationSelector=c,_t._leading=_,_t._trailing=$,_t._hasValue=!1,_t}Ca(e,i),e.prototype._next=function(o){this._hasValue=!0,this._sendValue=o,this._throttled||(this._leading?this.send():this.throttle(o))},e.prototype.send=function(){var o=this._sendValue;this._hasValue&&(this.destination.next(o),this.throttle(o)),this._hasValue=!1,this._sendValue=void 0},e.prototype.throttle=function(o){(o=this.tryDurationSelector(o))&&this.add(this._throttled=De(o,new Qe(this)))},e.prototype.tryDurationSelector=function(o){try{return this.durationSelector(o)}catch(c){return this.destination.error(c),null}},e.prototype.throttlingDone=function(){var o=this._throttled,c=this._trailing;o&&o.unsubscribe(),this._throttled=void 0,c&&this.send()},e.prototype.notifyNext=function(){this.throttlingDone()},e.prototype.notifyComplete=function(){this.throttlingDone()}})(Re);for(var eC=function(){function i(e,o,c,_){this.duration=e,this.scheduler=o,this.leading=c,this.trailing=_}return i.prototype.call=function(e,o){return o.subscribe(new oI(e,this.duration,this.scheduler,this.leading,this.trailing))},i}(),oI=function(i){function e(o,c,_,$,_t){return(o=i.call(this,o)||this).duration=c,o.scheduler=_,o.leading=$,o.trailing=_t,o._hasTrailingValue=!1,o._trailingValue=null,o}return Ca(e,i),e.prototype._next=function(o){this.throttled?this.trailing&&(this._trailingValue=o,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(fC,this.duration,{subscriber:this})),this.leading?this.destination.next(o):this.trailing&&(this._trailingValue=o,this._hasTrailingValue=!0))},e.prototype._complete=function(){this._hasTrailingValue&&this.destination.next(this._trailingValue),this.destination.complete()},e.prototype.clearThrottle=function(){var o=this.throttled;o&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),o.unsubscribe(),this.remove(o),this.throttled=null)},e}(hb),hC=function(){function i(e,o,c,_){this.waitFor=e,this.absoluteTimeout=o,this.withObservable=c,this.scheduler=_}return i.prototype.call=function(e,o){return o.subscribe(new pI(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},i}(),pI=function(i){function e(o,c,_,$,_t){return(o=i.call(this,o)||this).absoluteTimeout=c,o.waitFor=_,o.withObservable=$,o.scheduler=_t,o.scheduleTimeout(),o}return Ca(e,i),e.dispatchTimeout=function(o){var c=o.withObservable;o._unsubscribeAndRecycle(),o.add(De(c,new Qe(o)))},e.prototype.scheduleTimeout=function(){var o=this.action;o?this.action=o.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(o){this.absoluteTimeout||this.scheduleTimeout(),i.prototype._next.call(this,o)},e.prototype._unsubscribe=function(){this.action=void 0,this.withObservable=this.scheduler=null},e}(Re),jC=function(){function i(e,o){this.observables=e,this.project=o}return i.prototype.call=function(e,o){return o.subscribe(new qI(e,this.observables,this.project))},i}(),qI=function(i){function e(o,c,_){(o=i.call(this,o)||this).observables=c,o.project=_,o.toRespond=[],_=c.length,o.values=Array(_);for(var $=0;$<_;$++)o.toRespond.push($);for($=0;$<_;$++)o.add(wm(o,c[$],void 0,$));return o}return Ca(e,i),e.prototype.notifyNext=function(o,c,_){this.values[_]=c,0<(o=this.toRespond).length&&(_=o.indexOf(_))!==-1&&o.splice(_,1)},e.prototype.notifyComplete=function(){},e.prototype._next=function(o){this.toRespond.length===0&&(o=[o].concat(this.values),this.project?this._tryProject(o):this.destination.next(o))},e.prototype._tryProject=function(o){try{var c=this.project.apply(this,o)}catch(_){return void this.destination.error(_)}this.destination.next(c)},e}(Zo),ow=kc(function(i){var e=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(e){var o=new Uint8Array(16);i.exports=function(){return e(o),o}}else{var c=Array(16);i.exports=function(){for(var _,$=0;16>$;$++)!(3&$)&&(_=4294967296*Math.random()),c[$]=_>>>((3&$)<<3)&255;return c}}}),tc=[],Yk=0;256>Yk;++Yk)tc[Yk]=(Yk+256).toString(16).substr(1);var pw=function(i,e){return e=e||0,[tc[i[e++]],tc[i[e++]],tc[i[e++]],tc[i[e++]],"-",tc[i[e++]],tc[i[e++]],"-",tc[i[e++]],tc[i[e++]],"-",tc[i[e++]],tc[i[e++]],"-",tc[i[e++]],tc[i[e++]],tc[i[e++]],tc[i[e++]],tc[i[e++]],tc[i[e++]]].join("")},gj=function(i,e,o){if(o=e&&o||0,typeof i=="string"&&(e=i==="binary"?Array(16):null,i=null),(i=(i=i||{}).random||(i.rng||ow)())[6]=15&i[6]|64,i[8]=63&i[8]|128,e)for(var c=0;16>c;++c)e[o+c]=i[c];return e||pw(i)},hj=gj(),Bm=!1,$r=new AbortController,Se,Df,bp,cp,Ef,rg,Zd,sg,zd,dp,Te,tg,Ue,Ve,We,Fh,Uc,$d;(function(i){i[i.ATTRIBUTE_OPERATION_ERR_FAILURE=2]="ATTRIBUTE_OPERATION_ERR_FAILURE",i[i.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=3]="ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT",i[i.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=4]="ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW",i[i.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN=5]="ATTRIBUTE_OPERATION_ERR_TOO_OFTEN",i[i.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND=6]="ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND",i[i.ATTRIBUTE_OPERATION_ERR_TIMEOUT=7]="ATTRIBUTE_OPERATION_ERR_TIMEOUT",i[i.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=102]="ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN"})(Se||(Se={})),function(i){i[i.CHANNEL_MESSAGE_ERR_FAILURE=1]="CHANNEL_MESSAGE_ERR_FAILURE",i[i.CHANNEL_MESSAGE_ERR_TIMEOUT=2]="CHANNEL_MESSAGE_ERR_TIMEOUT",i[i.CHANNEL_MESSAGE_ERR_TOO_OFTEN=3]="CHANNEL_MESSAGE_ERR_TOO_OFTEN",i[i.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=4]="CHANNEL_MESSAGE_ERR_INVALID_MESSAGE",i[i.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL=5]="CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL",i[i.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(Df||(Df={})),function(i){i[i.CREATE_CHANNEL_ERR_INVALID_ARGUMENT=1]="CREATE_CHANNEL_ERR_INVALID_ARGUMENT"}(bp||(bp={})),function(i){i[i.CREATE_INSTANCE_ERR_INVALID_ARGUMENT=1]="CREATE_INSTANCE_ERR_INVALID_ARGUMENT"}(cp||(cp={})),function(i){i[i.GET_MEMBERS_ERR_FAILURE=1]="GET_MEMBERS_ERR_FAILURE",i[i.GET_MEMBERS_ERR_REJECTED=2]="GET_MEMBERS_ERR_REJECTED",i[i.GET_MEMBERS_ERR_TIMEOUT=3]="GET_MEMBERS_ERR_TIMEOUT",i[i.GET_MEMBERS_ERR_TOO_OFTEN=4]="GET_MEMBERS_ERR_TOO_OFTEN",i[i.GET_MEMBERS_ERR_NOT_IN_CHANNEL=5]="GET_MEMBERS_ERR_NOT_IN_CHANNEL",i[i.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=102]="GET_MEMBERS_ERR_USER_NOT_LOGGED_IN"}(Ef||(Ef={})),function(i){i[i.INVITATION_API_CALL_ERR_INVALID_ARGUMENT=1]="INVITATION_API_CALL_ERR_INVALID_ARGUMENT",i[i.INVITATION_API_CALL_ERR_NOT_STARTED=2]="INVITATION_API_CALL_ERR_NOT_STARTED",i[i.INVITATION_API_CALL_ERR_ALREADY_END=3]="INVITATION_API_CALL_ERR_ALREADY_END",i[i.INVITATION_API_CALL_ERR_ALREADY_ACCEPT=4]="INVITATION_API_CALL_ERR_ALREADY_ACCEPT",i[i.INVITATION_API_CALL_ERR_ALREADY_SENT=5]="INVITATION_API_CALL_ERR_ALREADY_SENT"}(rg||(rg={})),function(i){i[i.JOIN_CHANNEL_ERR_FAILURE=1]="JOIN_CHANNEL_ERR_FAILURE",i[i.JOIN_CHANNEL_ERR_REJECTED=2]="JOIN_CHANNEL_ERR_REJECTED",i[i.JOIN_CHANNEL_ERR_INVALID_ARGUMENT=3]="JOIN_CHANNEL_ERR_INVALID_ARGUMENT",i[i.JOIN_CHANNEL_TIMEOUT=4]="JOIN_CHANNEL_TIMEOUT",i[i.JOIN_CHANNEL_ERR_EXCEED_LIMIT=5]="JOIN_CHANNEL_ERR_EXCEED_LIMIT",i[i.JOIN_CHANNEL_ERR_ALREADY_JOINED=6]="JOIN_CHANNEL_ERR_ALREADY_JOINED",i[i.JOIN_CHANNEL_ERR_TOO_OFTEN=7]="JOIN_CHANNEL_ERR_TOO_OFTEN",i[i.JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN=8]="JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN",i[i.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN",i[i.JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE=201]="JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE",i[i.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=202]="JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID"}(Zd||(Zd={})),function(i){i[i.LEAVE_CHANNEL_ERR_FAILURE=1]="LEAVE_CHANNEL_ERR_FAILURE",i[i.LEAVE_CHANNEL_ERR_REJECTED=2]="LEAVE_CHANNEL_ERR_REJECTED",i[i.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=3]="LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL",i[i.LEAVE_CHANNEL_ERR_KICKED=4]="LEAVE_CHANNEL_ERR_KICKED",i[i.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN"}(sg||(sg={})),function(i){i[i.LOGIN_ERR_UNKNOWN=1]="LOGIN_ERR_UNKNOWN",i[i.LOGIN_ERR_REJECTED=2]="LOGIN_ERR_REJECTED",i[i.LOGIN_ERR_INVALID_ARGUMENT=3]="LOGIN_ERR_INVALID_ARGUMENT",i[i.LOGIN_ERR_INVALID_APP_ID=4]="LOGIN_ERR_INVALID_APP_ID",i[i.LOGIN_ERR_INVALID_TOKEN=5]="LOGIN_ERR_INVALID_TOKEN",i[i.LOGIN_ERR_TOKEN_EXPIRED=6]="LOGIN_ERR_TOKEN_EXPIRED",i[i.LOGIN_ERR_NOT_AUTHORIZED=7]="LOGIN_ERR_NOT_AUTHORIZED",i[i.LOGIN_ERR_ALREADY_LOGIN=8]="LOGIN_ERR_ALREADY_LOGIN",i[i.LOGIN_ERR_TIMEOUT=9]="LOGIN_ERR_TIMEOUT",i[i.LOGIN_ERR_TOO_OFTEN=10]="LOGIN_ERR_TOO_OFTEN",i[i.LOGIN_ERR_ABORTED_BY_LOGOUT=201]="LOGIN_ERR_ABORTED_BY_LOGOUT"}(zd||(zd={})),function(i){i[i.LOGOUT_ERR_USER_NOT_LOGGED_IN=102]="LOGOUT_ERR_USER_NOT_LOGGED_IN"}(dp||(dp={})),function(i){i[i.PEER_MESSAGE_ERR_FAILURE=1]="PEER_MESSAGE_ERR_FAILURE",i[i.PEER_MESSAGE_ERR_TIMEOUT=2]="PEER_MESSAGE_ERR_TIMEOUT",i[i.PEER_MESSAGE_ERR_TOO_OFTEN=5]="PEER_MESSAGE_ERR_TOO_OFTEN",i[i.PEER_MESSAGE_ERR_INVALID_USERID=6]="PEER_MESSAGE_ERR_INVALID_USERID",i[i.PEER_MESSAGE_ERR_INVALID_MESSAGE=7]="PEER_MESSAGE_ERR_INVALID_MESSAGE",i[i.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE=8]="PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE",i[i.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(Te||(Te={})),function(i){i[i.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT=2]="QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT",i[i.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED=3]="QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED",i[i.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT=4]="QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT",i[i.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN=5]="QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN",i[i.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN"}(tg||(tg={})),function(i){i[i.RENEW_TOKEN_ERR_FAILURE=1]="RENEW_TOKEN_ERR_FAILURE",i[i.RENEW_TOKEN_ERR_INVALID_ARGUMENT=2]="RENEW_TOKEN_ERR_INVALID_ARGUMENT",i[i.RENEW_TOKEN_ERR_REJECTED=3]="RENEW_TOKEN_ERR_REJECTED",i[i.RENEW_TOKEN_ERR_TOO_OFTEN=4]="RENEW_TOKEN_ERR_TOO_OFTEN",i[i.RENEW_TOKEN_ERR_TOKEN_EXPIRED=5]="RENEW_TOKEN_ERR_TOKEN_EXPIRED",i[i.RENEW_TOKEN_ERR_INVALID_TOKEN=6]="RENEW_TOKEN_ERR_INVALID_TOKEN",i[i.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=102]="RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN",i[i.RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT=201]="RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT"}(Ue||(Ue={})),function(i){i[i.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE=1]="GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE",i[i.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT=2]="GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT",i[i.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN=3]="GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN",i[i.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT=4]="GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT",i[i.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT=5]="GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT",i[i.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED=101]="GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED",i[i.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN=102]="GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN"}(Ve||(Ve={})),function(i){i[i.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE=1]="PEER_SUBSCRIPTION_STATUS_ERR_FAILURE",i[i.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT=2]="PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT",i[i.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED=3]="PEER_SUBSCRIPTION_STATUS_ERR_REJECTED",i[i.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT=4]="PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT",i[i.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN=5]="PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN",i[i.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW=6]="PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW",i[i.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN=102]="PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN"}(We||(We={})),function(i){i[i.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE=1]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE",i[i.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT=2]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT",i[i.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN=3]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN",i[i.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN"}(Fh||(Fh={})),function(i){i[i.METADATA_OPERATION_ERR_OK=0]="METADATA_OPERATION_ERR_OK",i[i.METADATA_OPERATION_ERR_FAILURE=1]="METADATA_OPERATION_ERR_FAILURE",i[i.METADATA_OPERATION_ERR_INVALID_USER_ID=2]="METADATA_OPERATION_ERR_INVALID_USER_ID",i[i.METADATA_OPERATION_ERR_INVALID_ARGUMENT=3]="METADATA_OPERATION_ERR_INVALID_ARGUMENT",i[i.METADATA_OPERATION_ERR_SIZE_OVERFLOW=4]="METADATA_OPERATION_ERR_SIZE_OVERFLOW",i[i.METADATA_OPERATION_ERR_DUPLICATE_KEY=5]="METADATA_OPERATION_ERR_DUPLICATE_KEY",i[i.METADATA_OPERATION_ERR_TOO_OFTEN=6]="METADATA_OPERATION_ERR_TOO_OFTEN",i[i.METADATA_OPERATION_ERR_TIMEOUT=7]="METADATA_OPERATION_ERR_TIMEOUT",i[i.METADATA_OPERATION_ERR_OUTDATE_REVISION=8]="METADATA_OPERATION_ERR_OUTDATE_REVISION",i[i.METADATA_OPERATION_ERR_NOT_IN_CHANNEL=9]="METADATA_OPERATION_ERR_NOT_IN_CHANNEL",i[i.METADATA_OPERATION_ERR_NOT_INITIALIZED=101]="METADATA_OPERATION_ERR_NOT_INITIALIZED",i[i.METADATA_OPERATION_ERR_USER_NOT_LOGGED_IN=102]="METADATA_OPERATION_ERR_USER_NOT_LOGGED_IN"}(Uc||(Uc={})),function(i){i[i.METADATA_SUBSCRIPTION_ERR_OK=0]="METADATA_SUBSCRIPTION_ERR_OK",i[i.METADATA_SUBSCRIPTION_ERR_FAILURE=1]="METADATA_SUBSCRIPTION_ERR_FAILURE",i[i.METADATA_SUBSCRIPTION_ERR_TIMEOUT=2]="METADATA_SUBSCRIPTION_ERR_TIMEOUT",i[i.METADATA_SUBSCRIPTION_ERR_INVALID_ARGUMENT=3]="METADATA_SUBSCRIPTION_ERR_INVALID_ARGUMENT",i[i.METADATA_SUBSCRIPTION_ERR_TOO_OFTEN=4]="METADATA_SUBSCRIPTION_ERR_TOO_OFTEN",i[i.METADATA_SUBSCRIPTION_ERR_OVERFLOW=5]="METADATA_SUBSCRIPTION_ERR_OVERFLOW",i[i.METADATA_SUBSCRIPTION_USER_NOT_SUBSCRIBED=6]="METADATA_SUBSCRIPTION_USER_NOT_SUBSCRIBED",i[i.METADATA_SUBSCRIPTION_ERR_NOT_INITIALIZED=101]="METADATA_SUBSCRIPTION_ERR_NOT_INITIALIZED",i[i.METADATA_SUBSCRIPTION_ERR_NOT_LOGGED_IN=102]="METADATA_SUBSCRIPTION_ERR_NOT_LOGGED_IN"}($d||($d={}));var Ad=Se.ATTRIBUTE_OPERATION_ERR_FAILURE,Ub=Se.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,ch=Se.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW;Se.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN;var qw=Se.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND,Bd=Se.ATTRIBUTE_OPERATION_ERR_TIMEOUT,Cd=Se.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,Zk=Df.CHANNEL_MESSAGE_ERR_FAILURE,ep=Df.CHANNEL_MESSAGE_ERR_TIMEOUT,rw=Df.CHANNEL_MESSAGE_ERR_TOO_OFTEN,fp=Df.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE,rI=Df.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL,gp=Df.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,sI=bp.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,sw=cp.CREATE_INSTANCE_ERR_INVALID_ARGUMENT;Ve.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE;var tw=Ve.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT;Ve.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN;var uw=Ve.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT,tI=Ve.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT;Ve.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED;var uI=Ve.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN,vI=Ef.GET_MEMBERS_ERR_FAILURE,wI=Ef.GET_MEMBERS_ERR_REJECTED;Ef.GET_MEMBERS_ERR_TIMEOUT,Ef.GET_MEMBERS_ERR_TOO_OFTEN;var xI=Ef.GET_MEMBERS_ERR_NOT_IN_CHANNEL,yI=Ef.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN,ve=rg.INVITATION_API_CALL_ERR_INVALID_ARGUMENT,zI=rg.INVITATION_API_CALL_ERR_NOT_STARTED,$k=rg.INVITATION_API_CALL_ERR_ALREADY_END,vw=rg.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,AI=rg.INVITATION_API_CALL_ERR_ALREADY_SENT,ww=Zd.JOIN_CHANNEL_ERR_FAILURE;Zd.JOIN_CHANNEL_ERR_REJECTED;var BI=Zd.JOIN_CHANNEL_ERR_INVALID_ARGUMENT,xw=Zd.JOIN_CHANNEL_TIMEOUT,yw=Zd.JOIN_CHANNEL_ERR_EXCEED_LIMIT,zw=Zd.JOIN_CHANNEL_ERR_ALREADY_JOINED;Zd.JOIN_CHANNEL_ERR_TOO_OFTEN;var Aw=Zd.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,Bw=Zd.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,Cw=sg.LEAVE_CHANNEL_ERR_FAILURE,Dw=sg.LEAVE_CHANNEL_ERR_REJECTED,CI=sg.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,DI=sg.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN,EI=sg.LEAVE_CHANNEL_ERR_KICKED,Ew=zd.LOGIN_ERR_UNKNOWN,ij=zd.LOGIN_ERR_REJECTED,al=zd.LOGIN_ERR_INVALID_ARGUMENT,Fw=zd.LOGIN_ERR_INVALID_APP_ID,Gw=zd.LOGIN_ERR_INVALID_TOKEN,bl=zd.LOGIN_ERR_TOKEN_EXPIRED;zd.LOGIN_ERR_NOT_AUTHORIZED;var FI=zd.LOGIN_ERR_ALREADY_LOGIN,GI=zd.LOGIN_ERR_TIMEOUT,HI=zd.LOGIN_ERR_TOO_OFTEN,Hw=dp.LOGOUT_ERR_USER_NOT_LOGGED_IN,Iw=Te.PEER_MESSAGE_ERR_FAILURE,hp=Te.PEER_MESSAGE_ERR_TIMEOUT,Jw=Te.PEER_MESSAGE_ERR_TOO_OFTEN,Kw=Te.PEER_MESSAGE_ERR_INVALID_USERID,si=Te.PEER_MESSAGE_ERR_INVALID_MESSAGE,ip=Te.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN;Te.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE;var Lw=tg.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT;tg.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED;var II=tg.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT;tg.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN;var JI=tg.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN,jp=Ue.RENEW_TOKEN_ERR_FAILURE,KI=Ue.RENEW_TOKEN_ERR_INVALID_ARGUMENT;Ue.RENEW_TOKEN_ERR_REJECTED,Ue.RENEW_TOKEN_ERR_TOO_OFTEN;var LI=Ue.RENEW_TOKEN_ERR_TOKEN_EXPIRED,MI=Ue.RENEW_TOKEN_ERR_INVALID_TOKEN,Mw=Ue.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN,Nw=We.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE,jj=We.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT;We.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED;var NI=We.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT;We.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN;var Ow=We.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW,kp=We.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN;Fh.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE,Fh.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT,Fh.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN,Fh.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN;var bd=Uc.METADATA_OPERATION_ERR_OK,He=Uc.METADATA_OPERATION_ERR_FAILURE;Uc.METADATA_OPERATION_ERR_INVALID_USER_ID;var Mb=Uc.METADATA_OPERATION_ERR_INVALID_ARGUMENT,Om=Uc.METADATA_OPERATION_ERR_SIZE_OVERFLOW,oC=Uc.METADATA_OPERATION_ERR_DUPLICATE_KEY,Vc=Uc.METADATA_OPERATION_ERR_TOO_OFTEN,cd=Uc.METADATA_OPERATION_ERR_TIMEOUT,of=Uc.METADATA_OPERATION_ERR_OUTDATE_REVISION;Uc.METADATA_OPERATION_ERR_NOT_INITIALIZED;var oc=Uc.METADATA_OPERATION_ERR_USER_NOT_LOGGED_IN,kj=Uc.METADATA_OPERATION_ERR_NOT_IN_CHANNEL,Pw=$d.METADATA_SUBSCRIPTION_ERR_OK,lp=$d.METADATA_SUBSCRIPTION_ERR_FAILURE,cl=$d.METADATA_SUBSCRIPTION_ERR_TIMEOUT,dl=$d.METADATA_SUBSCRIPTION_ERR_INVALID_ARGUMENT;$d.METADATA_SUBSCRIPTION_ERR_TOO_OFTEN;var OI=$d.METADATA_SUBSCRIPTION_ERR_OVERFLOW,PI=$d.METADATA_SUBSCRIPTION_USER_NOT_SUBSCRIBED;$d.METADATA_SUBSCRIPTION_ERR_NOT_INITIALIZED,$d.METADATA_SUBSCRIPTION_ERR_NOT_LOGGED_IN;var QI=function(i,e){var o;return Po(i,function(c,_,$){return!(o=e(c,_,$))}),!!o},el=function(i,e,o){if(!Kc(o))return!1;var c=Ia(e);return!!(c=="number"?$f(o)&&Eo(e,o.length):c=="string"&&e in o)&&$i(o[e],i)},mp=function(i,e,o){var c=lc(i)?Zv:QI;return o&&el(i,e,o)&&(e=void 0),c(i,Ch(e))},RI=function(i,e){var o=-1,c=$f(i)?Array(i.length):[];return Po(i,function(_,$,_t){c[++o]=e(_,$,_t)}),c},SI=function(i,e){var o=i.length;for(i.sort(e);o--;)i[o]=i[o].value;return i},TI=function(i,e,o){e=e.length?Rg(e,function(_){return lc(_)?function($){return Uk($,_.length===1?_[0]:_)}:_}):[Vk];var c=-1;return e=Rg(e,Rk(Ch)),i=RI(i,function(_,$,_t){return{criteria:Rg(e,function(ga){return ga(_)}),index:++c,value:_}}),SI(i,function(_,$){t:{for(var _t=-1,ga=_.criteria,_s=$.criteria,_c=ga.length,_l=o.length;++_t<_c;){e:{var Tl=ga[_t],Cl=_s[_t];if(Tl!==Cl){var Pl=Tl!==void 0,Dl=Tl===null,Jl=Tl==Tl,zl=Sg(Tl),Bl=Cl!==void 0,Vl=Cl===null,_d=Cl==Cl,Sp=Sg(Cl);if(!Vl&&!Sp&&!zl&&Tl>Cl||zl&&Bl&&_d&&!Vl&&!Sp||Dl&&Bl&&_d||!Pl&&_d||!Jl){Tl=1;break e}if(!Dl&&!zl&&!Sp&&Tl<Cl||Sp&&Pl&&Jl&&!Dl&&!zl||Vl&&Pl&&Jl||!Bl&&Jl||!_d){Tl=-1;break e}}Tl=0}if(Tl){_=_t>=_l?Tl:Tl*(o[_t]=="desc"?-1:1);break t}}_=_.index-$.index}return _})},Qw=function(i,e){return Xv(Wv(i,e,Vk),i+"")},Rw=Qw(function(i,e){if(i==null)return[];var o=e.length;return 1<o&&el(i,e[0],e[1])?e=[]:2<o&&el(e[0],e[1],e[2])&&(e=[e[0]]),TI(i,mm(e,1),[])}),Sw=function(i){if(i.__esModule)return i;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(i).forEach(function(o){var c=Object.getOwnPropertyDescriptor(i,o);Object.defineProperty(e,o,c.get?c:{enumerable:!0,get:function(){return i[o]}})}),e}(WH),Tw=kc(function(i,e){Object.defineProperty(e,"__esModule",{value:!0});var o=[],c=function(_,$){return new WebSocket(_,$)};e.normalClosureMessage="Normal closure",e.default=function(_,$){var _t=($=$===void 0?{protocols:o,makeWebSocket:c}:$).protocols,ga=_t===void 0?o:_t,_s=($=$.makeWebSocket)===void 0?c:$;return new Sw.Observable(function(_c){var _l,Tl=new Sw.Subject,Cl=_s(_,ga),Pl=!1,Dl=!1,Jl=function(zl){if(_l)throw Pl=!0,zl=Error("Web socket message factory function called more than once"),_c.error(zl),zl;return _l=zl.subscribe(function(Bl){Cl.send(Bl)}),Tl};return Cl.onopen=function(){Dl?(Pl=!0,Cl.close()):_c.next(Jl)},Cl.onmessage=function(zl){Tl.next(zl.data)},Cl.onerror=function(zl){Pl=!0,_c.error(Error(zl.message))},Cl.onclose=function(zl){Pl||(Pl=!0,Dl?(_c.complete(),Tl.complete()):_c.error(Error(zl.code===1e3?e.normalClosureMessage:zl.reason)))},function(){Dl=!0,_l&&_l.unsubscribe(),Pl||(Pl=!0,Cl.close())}})}});(function(i){i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")&&i.default})(Tw);var Dm=function(i,e,o){(o===void 0||$i(i[e],o))&&(o!==void 0||e in i)||bj(i,e,o)},Cm=function(i,e){if((e!=="constructor"||typeof i[e]!="function")&&e!="__proto__")return i[e]},UI=function(i){return Qw(function(e,o){var c=-1,_=o.length,$=1<_?o[_-1]:void 0,_t=2<_?o[2]:void 0;for($=3<i.length&&typeof $=="function"?(_--,$):void 0,_t&&el(o[0],o[1],_t)&&($=3>_?void 0:$,_=1),e=Object(e);++c<_;)(_t=o[c])&&i(e,_t,c,$);return e})}(function(i,e,o,c){as(i,e,o,c)}),VI=Math.floor,WI=Math.random,Uw=function(i,e){return i+VI(WI()*(e-i+1))},Vw=function(i){var e=i.length;return e?i[Uw(0,e-1)]:void 0},XI=function(i,e){return Rg(e,function(o){return i[o]})},Vm=function(i){return i==null?[]:XI(i,Wf(i))},YI=function(i){return Vw(Vm(i))},Es=function(i){return(lc(i)?Vw:YI)(i)},es=[],fs=function(i,e){return new WebSocket(i,e)};cb&&(/./g.flags!="g"||Sd)&&$b.f(RegExp.prototype,"flags",{configurable:!0,get:hk});var ZI=Math.floor;wa({target:"Number",stat:!0},{isInteger:function(i){return!fb(i)&&isFinite(i)&&ZI(i)===i}}),tu("from",On,Nn);var $I=function(i,e){for(var o=Array(arguments.length-1),c=0,_=2,$=!0;_<arguments.length;)o[c++]=arguments[_++];return new Promise(function(_t,ga){o[c]=function(_s){if($)if($=!1,_s)ga(_s);else{for(var _c=Array(arguments.length-1),_l=0;_l<_c.length;)_c[_l++]=arguments[_l];_t.apply(null,_c)}};try{i.apply(e||null,o)}catch(_s){$&&($=!1,ga(_s))}})},aJ=kc(function(i,e){e.length=function(_){var $=_.length;if(!$)return 0;for(var _t=0;1<--$%4&&_.charAt($)==="=";)++_t;return Math.ceil(3*_.length)/4-_t};var o=Array(64),c=Array(123);for(i=0;64>i;)c[o[i]=26>i?i+65:52>i?i+71:62>i?i-4:i-59|43]=i++;e.encode=function(_,$,_t){for(var ga,_s=null,_c=[],_l=0,Tl=0;$<_t;){var Cl=_[$++];switch(Tl){case 0:_c[_l++]=o[Cl>>2],ga=(3&Cl)<<4,Tl=1;break;case 1:_c[_l++]=o[ga|Cl>>4],ga=(15&Cl)<<2,Tl=2;break;case 2:_c[_l++]=o[ga|Cl>>6],_c[_l++]=o[63&Cl],Tl=0}8191<_l&&((_s||(_s=[])).push(String.fromCharCode.apply(String,_c)),_l=0)}return Tl&&(_c[_l++]=o[ga],_c[_l++]=61,Tl===1&&(_c[_l++]=61)),_s?(_l&&_s.push(String.fromCharCode.apply(String,_c.slice(0,_l))),_s.join("")):String.fromCharCode.apply(String,_c.slice(0,_l))},e.decode=function(_,$,_t){for(var ga,_s=_t,_c=0,_l=0;_l<_.length;){var Tl=_.charCodeAt(_l++);if(Tl===61&&1<_c)break;if((Tl=c[Tl])===void 0)throw Error("invalid encoding");switch(_c){case 0:ga=Tl,_c=1;break;case 1:$[_t++]=ga<<2|(48&Tl)>>4,ga=Tl,_c=2;break;case 2:$[_t++]=(15&ga)<<4|(60&Tl)>>2,ga=Tl,_c=3;break;case 3:$[_t++]=(3&ga)<<6|Tl,_c=0}}if(_c===1)throw Error("invalid encoding");return _t-_s},e.test=function(_){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(_)}});Oj.prototype.on=function(i,e,o){return(this._listeners[i]||(this._listeners[i]=[])).push({fn:e,ctx:o||this}),this},Oj.prototype.off=function(i,e){if(i===void 0)this._listeners={};else if(e===void 0)this._listeners[i]=[];else{i=this._listeners[i];for(var o=0;o<i.length;)i[o].fn===e?i.splice(o,1):++o}return this},Oj.prototype.emit=function(i){var e=this._listeners[i];if(e){for(var o=[],c=1;c<arguments.length;)o.push(arguments[c++]);for(c=0;c<e.length;)e[c].fn.apply(e[c++].ctx,o)}return this};var bJ=gs(gs),cJ=function(d){try{var b=eval("quire".replace(/^/,"re"))(d);if(b&&(b.length||Object.keys(b).length))return b}catch(i){}return null},dJ=kc(function(i,e){e.length=function(o){for(var c,_=0,$=0;$<o.length;++$)128>(c=o.charCodeAt($))?_+=1:2048>c?_+=2:(64512&c)==55296&&(64512&o.charCodeAt($+1))==56320?(++$,_+=4):_+=3;return _},e.read=function(o,c,_){if(1>_-c)return"";for(var $,_t=null,ga=[],_s=0;c<_;)128>($=o[c++])?ga[_s++]=$:191<$&&224>$?ga[_s++]=(31&$)<<6|63&o[c++]:239<$&&365>$?($=((7&$)<<18|(63&o[c++])<<12|(63&o[c++])<<6|63&o[c++])-65536,ga[_s++]=55296+($>>10),ga[_s++]=56320+(1023&$)):ga[_s++]=(15&$)<<12|(63&o[c++])<<6|63&o[c++],8191<_s&&((_t||(_t=[])).push(String.fromCharCode.apply(String,ga)),_s=0);return _t?(_s&&_t.push(String.fromCharCode.apply(String,ga.slice(0,_s))),_t.join("")):String.fromCharCode.apply(String,ga.slice(0,_s))},e.write=function(o,c,_){for(var $,_t,ga=_,_s=0;_s<o.length;++_s)128>($=o.charCodeAt(_s))?c[_++]=$:(2048>$?c[_++]=$>>6|192:((64512&$)==55296&&(64512&(_t=o.charCodeAt(_s+1)))==56320?($=65536+((1023&$)<<10)+(1023&_t),++_s,c[_++]=$>>18|240,c[_++]=$>>12&63|128):c[_++]=$>>12|224,c[_++]=$>>6&63|128),c[_++]=63&$|128);return _-ga}}),eJ=function(i,e,o){var c=o||8192,_=c>>>1,$=null,_t=c;return function(ga){return 1>ga||ga>_?i(ga):(_t+ga>c&&($=i(c),_t=0),ga=e.call($,_t,_t+=ga),7&_t&&(_t=1+(7|_t)),ga)}},ug=mc.zero=new mc(0,0);ug.toNumber=function(){return 0},ug.zzEncode=ug.zzDecode=function(){return this},ug.length=function(){return 1};var fJ=mc.zeroHash="\0\0\0\0\0\0\0\0";mc.fromNumber=function(i){if(i===0)return ug;var e=0>i;e&&(i=-i);var o=i>>>0;return i=(i-o)/4294967296>>>0,e&&(i=~i>>>0,o=~o>>>0,4294967295<++o&&(o=0,4294967295<++i&&(i=0))),new mc(o,i)},mc.from=function(i){if(typeof i=="number")return mc.fromNumber(i);if(Ra.isString(i)){if(!Ra.Long)return mc.fromNumber(parseInt(i,10));i=Ra.Long.fromString(i)}return i.low||i.high?new mc(i.low>>>0,i.high>>>0):ug},mc.prototype.toNumber=function(i){if(!i&&this.hi>>>31){i=1+~this.lo>>>0;var e=~this.hi>>>0;return i||(e=e+1>>>0),-(i+4294967296*e)}return this.lo+4294967296*this.hi},mc.prototype.toLong=function(i){return Ra.Long?new Ra.Long(0|this.lo,0|this.hi,!!i):{low:0|this.lo,high:0|this.hi,unsigned:!!i}};var Ff=String.prototype.charCodeAt;mc.fromHash=function(i){return i===fJ?ug:new mc((Ff.call(i,0)|Ff.call(i,1)<<8|Ff.call(i,2)<<16|Ff.call(i,3)<<24)>>>0,(Ff.call(i,4)|Ff.call(i,5)<<8|Ff.call(i,6)<<16|Ff.call(i,7)<<24)>>>0)},mc.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},mc.prototype.zzEncode=function(){var i=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^i)>>>0,this.lo=(this.lo<<1^i)>>>0,this},mc.prototype.zzDecode=function(){var i=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^i)>>>0,this.hi=(this.hi>>>1^i)>>>0,this},mc.prototype.length=function(){var i=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,o=this.hi>>>24;return o===0?e===0?16384>i?128>i?1:2:2097152>i?3:4:16384>e?128>e?5:6:2097152>e?7:8:128>o?9:10};var Ra=kc(function(i,e){function o(_,$,_t){for(var ga=Object.keys($),_s=0;_s<ga.length;++_s)_[ga[_s]]!==void 0&&_t||(_[ga[_s]]=$[ga[_s]]);return _}function c(_){function $(_t,ga){if(!(this instanceof $))return new $(_t,ga);Object.defineProperty(this,"message",{get:function(){return _t}}),Error.captureStackTrace?Error.captureStackTrace(this,$):Object.defineProperty(this,"stack",{value:Error().stack||""}),ga&&o(this,ga)}return($.prototype=Object.create(Error.prototype)).constructor=$,Object.defineProperty($.prototype,"name",{get:function(){return _}}),$.prototype.toString=function(){return this.name+": "+this.message},$}e.asPromise=$I,e.base64=aJ,e.EventEmitter=Oj,e.float=bJ,e.inquire=cJ,e.utf8=dJ,e.pool=eJ,e.LongBits=mc,e.isNode=!!(qb!==void 0&&qb&&qb.process&&qb.process.versions&&qb.process.versions.node),e.global=e.isNode&&qb||typeof window<"u"&&window||typeof self<"u"&&self||qb,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(_){return typeof _=="number"&&isFinite(_)&&Math.floor(_)===_},e.isString=function(_){return typeof _=="string"||_ instanceof String},e.isObject=function(_){return _&&Ia(_)==="object"},e.isset=e.isSet=function(_,$){var _t=_[$];return!(_t==null||!_.hasOwnProperty($))&&(Ia(_t)!=="object"||0<(Array.isArray(_t)?_t.length:Object.keys(_t).length))},e.Buffer=function(){try{var _=e.inquire("buffer").Buffer;return _.prototype.utf8Write?_:null}catch{return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(_){return typeof _=="number"?e.Buffer?e._Buffer_allocUnsafe(_):new e.Array(_):e.Buffer?e._Buffer_from(_):typeof Uint8Array>"u"?_:new Uint8Array(_)},e.Array=typeof Uint8Array<"u"?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(_){return _?e.LongBits.from(_).toHash():e.LongBits.zeroHash},e.longFromHash=function(_,$){return _=e.LongBits.fromHash(_),e.Long?e.Long.fromBits(_.lo,_.hi,$):_.toNumber(!!$)},e.merge=o,e.lcFirst=function(_){return _.charAt(0).toLowerCase()+_.substring(1)},e.newError=c,e.ProtocolError=c("ProtocolError"),e.oneOfGetter=function(_){for(var $={},_t=0;_t<_.length;++_t)$[_[_t]]=1;return function(){for(var ga=Object.keys(this),_s=ga.length-1;-1<_s;--_s)if($[ga[_s]]===1&&this[ga[_s]]!==void 0&&this[ga[_s]]!==null)return ga[_s]}},e.oneOfSetter=function(_){return function($){for(var _t=0;_t<_.length;++_t)_[_t]!==$&&delete this[_[_t]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var _=e.Buffer;_?(e._Buffer_from=_.from!==Uint8Array.from&&_.from||function($,_t){return new _($,_t)},e._Buffer_allocUnsafe=_.allocUnsafe||function($){return new _($)}):e._Buffer_from=e._Buffer_allocUnsafe=null}}),Lm=ib,np,fl=Ra.LongBits,Ww=Ra.base64,Xw=Ra.utf8,Yw=function(){return Ra.Buffer?function(){return(ib.create=function(){return new np})()}:function(){return new ib}};ib.create=Yw(),ib.alloc=function(i){return new Ra.Array(i)},Ra.Array!==Array&&(ib.alloc=Ra.pool(ib.alloc,Ra.Array.prototype.subarray)),ib.prototype._push=function(i,e,o){return this.tail=this.tail.next=new pi(i,e,o),this.len+=e,this},Im.prototype=Object.create(pi.prototype),Im.prototype.fn=function(i,e,o){for(;127<i;)e[o++]=127&i|128,i>>>=7;e[o]=i},ib.prototype.uint32=function(i){return this.len+=(this.tail=this.tail.next=new Im(128>(i>>>=0)?1:16384>i?2:2097152>i?3:268435456>i?4:5,i)).len,this},ib.prototype.int32=function(i){return 0>i?this._push(Jm,10,fl.fromNumber(i)):this.uint32(i)},ib.prototype.sint32=function(i){return this.uint32((i<<1^i>>31)>>>0)},ib.prototype.uint64=function(i){return i=fl.from(i),this._push(Jm,i.length(),i)},ib.prototype.int64=ib.prototype.uint64,ib.prototype.sint64=function(i){return i=fl.from(i).zzEncode(),this._push(Jm,i.length(),i)},ib.prototype.bool=function(i){return this._push(Hm,1,i?1:0)},ib.prototype.fixed32=function(i){return this._push(Km,4,i>>>0)},ib.prototype.sfixed32=ib.prototype.fixed32,ib.prototype.fixed64=function(i){return i=fl.from(i),this._push(Km,4,i.lo)._push(Km,4,i.hi)},ib.prototype.sfixed64=ib.prototype.fixed64,ib.prototype.float=function(i){return this._push(Ra.float.writeFloatLE,4,i)},ib.prototype.double=function(i){return this._push(Ra.float.writeDoubleLE,8,i)};var gJ=Ra.Array.prototype.set?function(i,e,o){e.set(i,o)}:function(i,e,o){for(var c=0;c<i.length;++c)e[o+c]=i[c]};ib.prototype.bytes=function(i){var e=i.length>>>0;if(!e)return this._push(Hm,1,0);if(Ra.isString(i)){var o=ib.alloc(e=Ww.length(i));Ww.decode(i,o,0),i=o}return this.uint32(e)._push(gJ,e,i)},ib.prototype.string=function(i){var e=Xw.length(i);return e?this.uint32(e)._push(Xw.write,e,i):this._push(Hm,1,0)},ib.prototype.fork=function(){return this.states=new mC(this),this.head=this.tail=new pi(Gm,0,0),this.len=0,this},ib.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new pi(Gm,0,0),this.len=0),this},ib.prototype.ldelim=function(){var i=this.head,e=this.tail,o=this.len;return this.reset().uint32(o),o&&(this.tail.next=i.next,this.tail=e,this.len+=o),this},ib.prototype.finish=function(){for(var i=this.head.next,e=this.constructor.alloc(this.len),o=0;i;)i.fn(i.val,e,o),o+=i.len,i=i.next;return e},ib._configure=function(i){np=i,ib.create=Yw(),np._configure()},(ie.prototype=Object.create(Lm.prototype)).constructor=ie,ie._configure=function(){ie.alloc=Ra._Buffer_allocUnsafe,ie.writeBytesBuffer=Ra.Buffer&&Ra.Buffer.prototype instanceof Uint8Array&&Ra.Buffer.prototype.set.name==="set"?function(i,e,o){e.set(i,o)}:function(i,e,o){if(i.copy)i.copy(e,o,0,i.length);else for(var c=0;c<i.length;)e[o++]=i[c++]}},ie.prototype.bytes=function(i){Ra.isString(i)&&(i=Ra._Buffer_from(i,"base64"));var e=i.length>>>0;return this.uint32(e),e&&this._push(ie.writeBytesBuffer,e,i),this},ie.prototype.string=function(i){var e=Ra.Buffer.byteLength(i);return this.uint32(e),e&&this._push(nC,e,i),this},ie._configure();var Nm=Yb,op,ls=Ra.LongBits,hJ=Ra.utf8,Zw=typeof Uint8Array<"u"?function(i){if(i instanceof Uint8Array||Array.isArray(i))return new Yb(i);throw Error("illegal buffer")}:function(i){if(Array.isArray(i))return new Yb(i);throw Error("illegal buffer")},$w=function(){return Ra.Buffer?function(i){return(Yb.create=function(e){return Ra.Buffer.isBuffer(e)?new op(e):Zw(e)})(i)}:Zw};Yb.create=$w(),Yb.prototype._slice=Ra.Array.prototype.subarray||Ra.Array.prototype.slice,Yb.prototype.uint32=function(){var i=4294967295;return function(){if(i=(127&this.buf[this.pos])>>>0,128>this.buf[this.pos++]||(i=(i|(127&this.buf[this.pos])<<7)>>>0,128>this.buf[this.pos++])||(i=(i|(127&this.buf[this.pos])<<14)>>>0,128>this.buf[this.pos++])||(i=(i|(127&this.buf[this.pos])<<21)>>>0,128>this.buf[this.pos++])||(i=(i|(15&this.buf[this.pos])<<28)>>>0,128>this.buf[this.pos++]))return i;if((this.pos+=5)>this.len)throw this.pos=this.len,Od(this,10);return i}}(),Yb.prototype.int32=function(){return 0|this.uint32()},Yb.prototype.sint32=function(){var i=this.uint32();return i>>>1^-(1&i)|0},Yb.prototype.bool=function(){return this.uint32()!==0},Yb.prototype.fixed32=function(){if(this.pos+4>this.len)throw Od(this,4);return Pj(this.buf,this.pos+=4)},Yb.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Od(this,4);return 0|Pj(this.buf,this.pos+=4)},Yb.prototype.float=function(){if(this.pos+4>this.len)throw Od(this,4);var i=Ra.float.readFloatLE(this.buf,this.pos);return this.pos+=4,i},Yb.prototype.double=function(){if(this.pos+8>this.len)throw Od(this,4);var i=Ra.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,i},Yb.prototype.bytes=function(){var i=this.uint32(),e=this.pos,o=this.pos+i;if(o>this.len)throw Od(this,i);return this.pos+=i,Array.isArray(this.buf)?this.buf.slice(e,o):e===o?new this.buf.constructor(0):this._slice.call(this.buf,e,o)},Yb.prototype.string=function(){var i=this.bytes();return hJ.read(i,0,i.length)},Yb.prototype.skip=function(i){if(typeof i=="number"){if(this.pos+i>this.len)throw Od(this,i);this.pos+=i}else do if(this.pos>=this.len)throw Od(this);while(128&this.buf[this.pos++]);return this},Yb.prototype.skipType=function(i){switch(i){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(i=7&this.uint32())!=4;)this.skipType(i);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+i+" at offset "+this.pos)}return this},Yb._configure=function(i){op=i,Yb.create=$w(),op._configure();var e=Ra.Long?"toLong":"toNumber";Ra.merge(Yb.prototype,{int64:function(){return Mm.call(this)[e](!1)},uint64:function(){return Mm.call(this)[e](!0)},sint64:function(){return Mm.call(this).zzDecode()[e](!1)},fixed64:function(){return ms.call(this)[e](!0)},sfixed64:function(){return ms.call(this)[e](!1)}})},(ag.prototype=Object.create(Nm.prototype)).constructor=ag,ag._configure=function(){Ra.Buffer&&(ag.prototype._slice=Ra.Buffer.prototype.slice)},ag.prototype.string=function(){var i=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+i,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+i,this.len))},ag._configure(),(qi.prototype=Object.create(Ra.EventEmitter.prototype)).constructor=qi,qi.prototype.rpcCall=function i(e,o,c,_,$){if(!_)throw TypeError("request must be specified");var _t=this;if(!$)return Ra.asPromise(i,_t,e,o,c,_);if(_t.rpcImpl)try{return _t.rpcImpl(e,o[_t.requestDelimited?"encodeDelimited":"encode"](_).finish(),function(ga,_s){if(ga)return _t.emit("error",ga,e),$(ga);if(_s!==null){if(!(_s instanceof c))try{_s=c[_t.responseDelimited?"decodeDelimited":"decode"](_s)}catch(_c){return _t.emit("error",_c,e),$(_c)}return _t.emit("data",_s,e),$(null,_s)}_t.end(!0)})}catch(ga){_t.emit("error",ga,e),setTimeout(function(){$(ga)},0)}else setTimeout(function(){$(Error("already ended"))},0)},qi.prototype.end=function(i){return this.rpcImpl&&(i||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var iJ=kc(function(i,e){e.Service=qi}),jJ={},ae=kc(function(i,e){function o(){c.util._configure(),c.Writer._configure(c.BufferWriter),c.Reader._configure(c.BufferReader)}var c=e;c.build="minimal",c.Writer=Lm,c.BufferWriter=ie,c.Reader=Nm,c.BufferReader=ag,c.util=Ra,c.rpc=iJ,c.roots=jJ,c.configure=o,o()});ae.util.Long=D,ae.configure();var T=ae.Reader,ta=ae.Writer,I=ae.util,Q=ae.roots.default||(ae.roots.default={}),kJ=Q.URI=function(){var i={},e=Object.create(i);return e[i[0]="Unknown"]=0,e[i[1]="PingUri"]=1,e[i[2]="PongUri"]=2,e[i[11]="UserJoinUri"]=11,e[i[12]="UserRespUri"]=12,e[i[15]="UserTicketNearlyExpireUri"]=15,e[i[16]="UserRenewTokenReqUri"]=16,e[i[17]="UserRenewTokenRespUri"]=17,e[i[21]="UserQuitUri"]=21,e[i[22]="UserDropUri"]=22,e[i[31]="GroupEnterUri"]=31,e[i[32]="GroupLeaveUri"]=32,e[i[33]="GroupReplyUri"]=33,e[i[35]="GroupDropUri"]=35,e[i[36]="GroupEnterNoticeUri"]=36,e[i[37]="GroupLeaveNoticeUri"]=37,e[i[38]="GroupEventNoticeUri"]=38,e[i[39]="GroupCountNoticeUri"]=39,e[i[41]="UserStatusListUri"]=41,e[i[42]="UserStatusResultUri"]=42,e[i[51]="GroupStatusListUri"]=51,e[i[52]="GroupStatusResultUri"]=52,e[i[55]="GroupAllUsersListUri"]=55,e[i[56]="GroupAllUsersResultUri"]=56,e[i[100]="MessageUri"]=100,e[i[101]="AckUri"]=101,e[i[201]="UserJoinNoticeUri"]=201,e[i[202]="UserQuitNoticeUri"]=202,e[i[203]="UserWaitNoticeUri"]=203,e[i[301]="UserAttributeGetUri"]=301,e[i[302]="UserAttributeRetUri"]=302,e[i[303]="UserAttributeSetUri"]=303,e[i[304]="UserAttributeModUri"]=304,e[i[305]="UserAttributeDelUri"]=305,e[i[307]="UserAttributeRspUri"]=307,e[i[308]="UserAttributeErrUri"]=308,e[i[311]="UserAttributeKeysGetUri"]=311,e[i[312]="UserAttributeKeysRetUri"]=312,e[i[351]="GroupAttributeGetUri"]=351,e[i[352]="GroupAttributeRetUri"]=352,e[i[353]="GroupAttributeSetUri"]=353,e[i[354]="GroupAttributeModUri"]=354,e[i[355]="GroupAttributeDelUri"]=355,e[i[356]="GroupAttributeAltUri"]=356,e[i[357]="GroupAttributeRspUri"]=357,e[i[358]="GroupAttributeErrUri"]=358,e[i[361]="GroupAttributeKeysGetUri"]=361,e[i[362]="GroupAttributeKeysRetUri"]=362,e[i[401]="SubscribeUserStatusUri"]=401,e[i[402]="UnsubscribeUserStatusUri"]=402,e[i[499]="SubscribeResponseUri"]=499,e[i[601]="StateSubscribeUri"]=601,e[i[602]="StateUpdateUri"]=602,e[i[603]="StateSubscribeResultUri"]=603,e[i[604]="StateUnsubscribeUri"]=604,e[i[605]="StateSetUri"]=605,e[i[606]="StateModifyUri"]=606,e[i[607]="StateRequestResultUri"]=607,e[i[608]="StateGetUri"]=608,e[i[609]="StateGetResultUri"]=609,e[i[610]="StateLockAcquireUri"]=610,e[i[611]="StateLockReleaseUri"]=611,e[i[612]="StateLockAcquireResultUri"]=612,e[i[613]="StateLockUpdateUri"]=613,e[i[614]="StateLockReleaseResultUri"]=614,e[i[615]="StateLockDisableUri"]=615,e[i[616]="StateLockDisableResultUri"]=616,e}(),gl=Q.Wrapper=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.uri=0,i.prototype.data=I.newBuffer([]),i.encode=function(e,o){return o||(o=ta.create()),e.uri!=null&&Object.hasOwnProperty.call(e,"uri")&&o.uint32(8).int32(e.uri),e.data!=null&&Object.hasOwnProperty.call(e,"data")&&o.uint32(18).bytes(e.data),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.Wrapper;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.uri=e.int32();break;case 2:c.data=e.bytes();break;default:e.skipType(7&_)}}return c},i}(),lJ=Q.Ping=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.ms=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.ms!=null&&Object.hasOwnProperty.call(e,"ms")&&o.uint32(16).uint64(e.ms),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.Ping;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.ms=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),mJ=Q.Pong=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.ms=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.ms!=null&&Object.hasOwnProperty.call(e,"ms")&&o.uint32(16).uint64(e.ms),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.Pong;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.ms=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),nJ=Q.UserJoin=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.opt=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.instance=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.account="",i.prototype.ticket="",i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.opt!=null&&Object.hasOwnProperty.call(e,"opt")&&o.uint32(16).uint64(e.opt),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&o.uint32(24).uint64(e.instance),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(34).string(e.account),e.ticket!=null&&Object.hasOwnProperty.call(e,"ticket")&&o.uint32(42).string(e.ticket),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserJoin;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.opt=e.uint64();break;case 3:c.instance=e.uint64();break;case 4:c.account=e.string();break;case 5:c.ticket=e.string();break;default:e.skipType(7&_)}}return c},i}(),oJ=Q.UserResp=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.account="",i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(18).string(e.account),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(24).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserResp;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.account=e.string();break;case 3:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),pJ=Q.UserQuit=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.encode=function(e,o){return o||(o=ta.create()),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserQuit;e.pos<o;){var _=e.uint32();e.skipType(7&_)}return c},i}(),qJ=Q.UserDrop=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(8).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserDrop;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),rJ=Q.UserTicketNearlyExpire=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.expireTs=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.ticket="",i.encode=function(e,o){return o||(o=ta.create()),e.expireTs!=null&&Object.hasOwnProperty.call(e,"expireTs")&&o.uint32(8).uint64(e.expireTs),e.ticket!=null&&Object.hasOwnProperty.call(e,"ticket")&&o.uint32(18).string(e.ticket),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserTicketNearlyExpire;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.expireTs=e.uint64();break;case 2:c.ticket=e.string();break;default:e.skipType(7&_)}}return c},i}(),sJ=Q.UserRenewTokenReq=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.instance=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.account="",i.prototype.ticket="",i.encode=function(e,o){return o||(o=ta.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&o.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(16).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(26).string(e.account),e.ticket!=null&&Object.hasOwnProperty.call(e,"ticket")&&o.uint32(34).string(e.ticket),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserRenewTokenReq;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.instance=e.uint64();break;case 2:c.seq=e.uint64();break;case 3:c.account=e.string();break;case 4:c.ticket=e.string();break;default:e.skipType(7&_)}}return c},i}(),tJ=Q.UserRenewTokenResp=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(16).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserRenewTokenResp;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),uJ=Q.GroupEnter=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.account="",i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(18).string(e.account),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupEnter;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.account=e.string();break;default:e.skipType(7&_)}}return c},i}(),vJ=Q.GroupLeave=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.account="",i.encode=function(e,o){return o||(o=ta.create()),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(10).string(e.account),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupLeave;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.account=e.string();break;default:e.skipType(7&_)}}return c},i}(),wJ=Q.GroupReply=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.account="",i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(18).string(e.account),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(24).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupReply;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.account=e.string();break;case 3:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),ax=Q.GroupLeaveNotice=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.user="",i.prototype.group="",i.prototype.instance=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.size=0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&o.uint32(18).string(e.user),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&o.uint32(26).string(e.group),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&o.uint32(32).uint64(e.instance),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&o.uint32(40).uint32(e.size),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupLeaveNotice;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.user=e.string();break;case 3:c.group=e.string();break;case 4:c.instance=e.uint64();break;case 5:c.size=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),bx=Q.GroupEnterNotice=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.user="",i.prototype.group="",i.prototype.instance=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.size=0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&o.uint32(18).string(e.user),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&o.uint32(26).string(e.group),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&o.uint32(32).uint64(e.instance),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&o.uint32(40).uint32(e.size),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupEnterNotice;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.user=e.string();break;case 3:c.group=e.string();break;case 4:c.instance=e.uint64();break;case 5:c.size=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),cx=Q.Message=function(){function i(e){if(this.MiscMap={},e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.instance=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.dialogue=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.sequence=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.options=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.src="",i.prototype.dst="",i.prototype.payload=I.newBuffer([]),i.prototype.MiscMap=I.emptyObject,i.prototype.ms=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){if(o||(o=ta.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&o.uint32(8).uint64(e.instance),e.dialogue!=null&&Object.hasOwnProperty.call(e,"dialogue")&&o.uint32(16).uint64(e.dialogue),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&o.uint32(24).uint64(e.sequence),e.options!=null&&Object.hasOwnProperty.call(e,"options")&&o.uint32(32).uint64(e.options),e.src!=null&&Object.hasOwnProperty.call(e,"src")&&o.uint32(42).string(e.src),e.dst!=null&&Object.hasOwnProperty.call(e,"dst")&&o.uint32(50).string(e.dst),e.payload!=null&&Object.hasOwnProperty.call(e,"payload")&&o.uint32(58).bytes(e.payload),e.MiscMap!=null&&Object.hasOwnProperty.call(e,"MiscMap"))for(var c=Object.keys(e.MiscMap),_=0;_<c.length;++_)o.uint32(66).fork().uint32(10).string(c[_]).uint32(18).bytes(e.MiscMap[c[_]]).ldelim();return e.ms!=null&&Object.hasOwnProperty.call(e,"ms")&&o.uint32(72).uint64(e.ms),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c,_,$=new Q.Message;e.pos<o;)switch(c=e.uint32(),c>>>3){case 1:$.instance=e.uint64();break;case 2:$.dialogue=e.uint64();break;case 3:$.sequence=e.uint64();break;case 4:$.options=e.uint64();break;case 5:$.src=e.string();break;case 6:$.dst=e.string();break;case 7:$.payload=e.bytes();break;case 8:$.MiscMap===I.emptyObject&&($.MiscMap={});var _t=e.uint32()+e.pos;for(c="",_=[];e.pos<_t;){var ga=e.uint32();switch(ga>>>3){case 1:c=e.string();break;case 2:_=e.bytes();break;default:e.skipType(7&ga)}}$.MiscMap[c]=_;break;case 9:$.ms=e.uint64();break;default:e.skipType(7&c)}return $},i}(),dx=Q.Ack=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.instance=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.dialogue=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.sequence=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&o.uint32(8).uint64(e.instance),e.dialogue!=null&&Object.hasOwnProperty.call(e,"dialogue")&&o.uint32(16).uint64(e.dialogue),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&o.uint32(24).uint64(e.sequence),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(32).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.Ack;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.instance=e.uint64();break;case 2:c.dialogue=e.uint64();break;case 3:c.sequence=e.uint64();break;case 4:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),xJ=Q.GroupDrop=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.account="",i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(10).string(e.account),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(16).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupDrop;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.account=e.string();break;case 2:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),yJ=Q.GroupAllUsersList=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.group="",i.prototype.pageSize=0,i.prototype.pageNumber=0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&o.uint32(18).string(e.group),e.pageSize!=null&&Object.hasOwnProperty.call(e,"pageSize")&&o.uint32(24).uint32(e.pageSize),e.pageNumber!=null&&Object.hasOwnProperty.call(e,"pageNumber")&&o.uint32(32).uint32(e.pageNumber),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAllUsersList;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.group=e.string();break;case 3:c.pageSize=e.uint32();break;case 4:c.pageNumber=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),zJ=Q.GroupAllUsersResult=function(){function i(e){if(this.memberInfos=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.group="",i.prototype.totalSize=0,i.prototype.pageSize=0,i.prototype.pageNumber=0,i.prototype.memberInfos=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&o.uint32(18).string(e.group),e.totalSize!=null&&Object.hasOwnProperty.call(e,"totalSize")&&o.uint32(24).uint32(e.totalSize),e.pageSize!=null&&Object.hasOwnProperty.call(e,"pageSize")&&o.uint32(32).uint32(e.pageSize),e.pageNumber!=null&&Object.hasOwnProperty.call(e,"pageNumber")&&o.uint32(40).uint32(e.pageNumber),e.memberInfos!=null&&e.memberInfos.length)for(var c=0;c<e.memberInfos.length;++c)Q.GroupAllUsersResult.MemberInfo.encode(e.memberInfos[c],o.uint32(50).fork()).ldelim();return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAllUsersResult;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.group=e.string();break;case 3:c.totalSize=e.uint32();break;case 4:c.pageSize=e.uint32();break;case 5:c.pageNumber=e.uint32();break;case 6:c.memberInfos&&c.memberInfos.length||(c.memberInfos=[]),c.memberInfos.push(Q.GroupAllUsersResult.MemberInfo.decode(e,e.uint32()));break;default:e.skipType(7&_)}}return c},i.MemberInfo=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.account="",e.prototype.ts=0,e.encode=function(o,c){return c||(c=ta.create()),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&c.uint32(10).string(o.account),o.ts!=null&&Object.hasOwnProperty.call(o,"ts")&&c.uint32(16).uint32(o.ts),c},e.decode=function(o,c){o instanceof T||(o=T.create(o)),c=c===void 0?o.len:o.pos+c;for(var _=new Q.GroupAllUsersResult.MemberInfo;o.pos<c;){var $=o.uint32();switch($>>>3){case 1:_.account=o.string();break;case 2:_.ts=o.uint32();break;default:o.skipType(7&$)}}return _},e}(),i}(),AJ=Q.UserStatusList=function(){function i(e){if(this.users=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.users=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.users!=null&&e.users.length)for(var c=0;c<e.users.length;++c)o.uint32(18).string(e.users[c]);return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserStatusList;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.users&&c.users.length||(c.users=[]),c.users.push(e.string());break;default:e.skipType(7&_)}}return c},i}(),BJ=Q.UserStatusResult=function(){function i(e){if(this.userInfos=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.userInfos=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.userInfos!=null&&e.userInfos.length)for(var c=0;c<e.userInfos.length;++c)Q.UserStatusResult.UserStatusInfo.encode(e.userInfos[c],o.uint32(18).fork()).ldelim();return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserStatusResult;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.userInfos&&c.userInfos.length||(c.userInfos=[]),c.userInfos.push(Q.UserStatusResult.UserStatusInfo.decode(e,e.uint32()));break;default:e.skipType(7&_)}}return c},i.UserStatusInfo=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.account="",e.prototype.ts=0,e.encode=function(o,c){return c||(c=ta.create()),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&c.uint32(10).string(o.account),o.ts!=null&&Object.hasOwnProperty.call(o,"ts")&&c.uint32(16).uint32(o.ts),c},e.decode=function(o,c){o instanceof T||(o=T.create(o)),c=c===void 0?o.len:o.pos+c;for(var _=new Q.UserStatusResult.UserStatusInfo;o.pos<c;){var $=o.uint32();switch($>>>3){case 1:_.account=o.string();break;case 2:_.ts=o.uint32();break;default:o.skipType(7&$)}}return _},e}(),i}(),CJ=Q.UserAttributeGet=function(){function i(e){if(this.attributes=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.account="",i.prototype.attributes=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(18).string(e.account),e.attributes!=null&&e.attributes.length)for(var c=0;c<e.attributes.length;++c)o.uint32(26).string(e.attributes[c]);return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserAttributeGet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.account=e.string();break;case 3:c.attributes&&c.attributes.length||(c.attributes=[]),c.attributes.push(e.string());break;default:e.skipType(7&_)}}return c},i}(),DJ=Q.UserAttributeRet=function(){function i(e){if(this.attributeInfos=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.attributeInfos=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.attributeInfos!=null&&e.attributeInfos.length)for(var c=0;c<e.attributeInfos.length;++c)Q.UserAttributeRet.AttributeInfo.encode(e.attributeInfos[c],o.uint32(18).fork()).ldelim();return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserAttributeRet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.attributeInfos&&c.attributeInfos.length||(c.attributeInfos=[]),c.attributeInfos.push(Q.UserAttributeRet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&_)}}return c},i.AttributeInfo=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.key="",e.prototype.value="",e.encode=function(o,c){return c||(c=ta.create()),o.key!=null&&Object.hasOwnProperty.call(o,"key")&&c.uint32(10).string(o.key),o.value!=null&&Object.hasOwnProperty.call(o,"value")&&c.uint32(18).string(o.value),c},e.decode=function(o,c){o instanceof T||(o=T.create(o)),c=c===void 0?o.len:o.pos+c;for(var _=new Q.UserAttributeRet.AttributeInfo;o.pos<c;){var $=o.uint32();switch($>>>3){case 1:_.key=o.string();break;case 2:_.value=o.string();break;default:o.skipType(7&$)}}return _},e}(),i}(),EJ=Q.UserAttributeSet=function(){function i(e){if(this.attributeInfos=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.account="",i.prototype.attributeInfos=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(18).string(e.account),e.attributeInfos!=null&&e.attributeInfos.length)for(var c=0;c<e.attributeInfos.length;++c)Q.UserAttributeSet.AttributeInfo.encode(e.attributeInfos[c],o.uint32(26).fork()).ldelim();return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserAttributeSet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.account=e.string();break;case 3:c.attributeInfos&&c.attributeInfos.length||(c.attributeInfos=[]),c.attributeInfos.push(Q.UserAttributeSet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&_)}}return c},i.AttributeInfo=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.key="",e.prototype.value="",e.encode=function(o,c){return c||(c=ta.create()),o.key!=null&&Object.hasOwnProperty.call(o,"key")&&c.uint32(10).string(o.key),o.value!=null&&Object.hasOwnProperty.call(o,"value")&&c.uint32(18).string(o.value),c},e.decode=function(o,c){o instanceof T||(o=T.create(o)),c=c===void 0?o.len:o.pos+c;for(var _=new Q.UserAttributeSet.AttributeInfo;o.pos<c;){var $=o.uint32();switch($>>>3){case 1:_.key=o.string();break;case 2:_.value=o.string();break;default:o.skipType(7&$)}}return _},e}(),i}(),FJ=Q.UserAttributeMod=function(){function i(e){if(this.attributeInfos=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.account="",i.prototype.attributeInfos=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(18).string(e.account),e.attributeInfos!=null&&e.attributeInfos.length)for(var c=0;c<e.attributeInfos.length;++c)Q.UserAttributeMod.AttributeInfo.encode(e.attributeInfos[c],o.uint32(26).fork()).ldelim();return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserAttributeMod;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.account=e.string();break;case 3:c.attributeInfos&&c.attributeInfos.length||(c.attributeInfos=[]),c.attributeInfos.push(Q.UserAttributeMod.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&_)}}return c},i.AttributeInfo=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.key="",e.prototype.value="",e.encode=function(o,c){return c||(c=ta.create()),o.key!=null&&Object.hasOwnProperty.call(o,"key")&&c.uint32(10).string(o.key),o.value!=null&&Object.hasOwnProperty.call(o,"value")&&c.uint32(18).string(o.value),c},e.decode=function(o,c){o instanceof T||(o=T.create(o)),c=c===void 0?o.len:o.pos+c;for(var _=new Q.UserAttributeMod.AttributeInfo;o.pos<c;){var $=o.uint32();switch($>>>3){case 1:_.key=o.string();break;case 2:_.value=o.string();break;default:o.skipType(7&$)}}return _},e}(),i}(),GJ=Q.UserAttributeDel=function(){function i(e){if(this.attributes=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.account="",i.prototype.attributes=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(18).string(e.account),e.attributes!=null&&e.attributes.length)for(var c=0;c<e.attributes.length;++c)o.uint32(26).string(e.attributes[c]);return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserAttributeDel;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.account=e.string();break;case 3:c.attributes&&c.attributes.length||(c.attributes=[]),c.attributes.push(e.string());break;default:e.skipType(7&_)}}return c},i}(),HJ=Q.UserAttributeErr=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(16).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserAttributeErr;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),IJ=Q.UserAttributeKeysGet=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.account="",i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&o.uint32(18).string(e.account),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserAttributeKeysGet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.account=e.string();break;default:e.skipType(7&_)}}return c},i}(),JJ=Q.UserAttributeKeysRet=function(){function i(e){if(this.keys=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.keys=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.keys!=null&&e.keys.length)for(var c=0;c<e.keys.length;++c)o.uint32(18).string(e.keys[c]);return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserAttributeKeysRet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.keys&&c.keys.length||(c.keys=[]),c.keys.push(e.string());break;default:e.skipType(7&_)}}return c},i}(),KJ=Q.UserAttributeRsp=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserAttributeRsp;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),LJ=Q.GroupStatusList=function(){function i(e){if(this.groups=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.groups=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.groups!=null&&e.groups.length)for(var c=0;c<e.groups.length;++c)o.uint32(18).string(e.groups[c]);return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupStatusList;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.groups&&c.groups.length||(c.groups=[]),c.groups.push(e.string());break;default:e.skipType(7&_)}}return c},i}(),MJ=Q.GroupStatusResult=function(){function i(e){if(this.groupInfos=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.groupInfos=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.groupInfos!=null&&e.groupInfos.length)for(var c=0;c<e.groupInfos.length;++c)Q.GroupStatusResult.GroupInfo.encode(e.groupInfos[c],o.uint32(18).fork()).ldelim();return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupStatusResult;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.groupInfos&&c.groupInfos.length||(c.groupInfos=[]),c.groupInfos.push(Q.GroupStatusResult.GroupInfo.decode(e,e.uint32()));break;default:e.skipType(7&_)}}return c},i.GroupInfo=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.group="",e.prototype.memberCount=0,e.encode=function(o,c){return c||(c=ta.create()),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&c.uint32(10).string(o.group),o.memberCount!=null&&Object.hasOwnProperty.call(o,"memberCount")&&c.uint32(16).uint32(o.memberCount),c},e.decode=function(o,c){o instanceof T||(o=T.create(o)),c=c===void 0?o.len:o.pos+c;for(var _=new Q.GroupStatusResult.GroupInfo;o.pos<c;){var $=o.uint32();switch($>>>3){case 1:_.group=o.string();break;case 2:_.memberCount=o.uint32();break;default:o.skipType(7&$)}}return _},e}(),i}(),NJ=Q.GroupCountNotice=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.instance=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.group="",i.prototype.size=0,i.encode=function(e,o){return o||(o=ta.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&o.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(16).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&o.uint32(26).string(e.group),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&o.uint32(32).uint32(e.size),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupCountNotice;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.instance=e.uint64();break;case 2:c.seq=e.uint64();break;case 3:c.group=e.string();break;case 4:c.size=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),OJ=Q.GroupAttributeGet=function(){function i(e){if(this.attributes=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.group="",i.prototype.attributes=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&o.uint32(18).string(e.group),e.attributes!=null&&e.attributes.length)for(var c=0;c<e.attributes.length;++c)o.uint32(26).string(e.attributes[c]);return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAttributeGet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.group=e.string();break;case 3:c.attributes&&c.attributes.length||(c.attributes=[]),c.attributes.push(e.string());break;default:e.skipType(7&_)}}return c},i}(),PJ=Q.GroupAttributeRet=function(){function i(e){if(this.attributeMaps=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.attributeMaps=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.attributeMaps!=null&&e.attributeMaps.length)for(var c=0;c<e.attributeMaps.length;++c)Q.GroupAttributeRet.AttributeMap.encode(e.attributeMaps[c],o.uint32(18).fork()).ldelim();return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAttributeRet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.attributeMaps&&c.attributeMaps.length||(c.attributeMaps=[]),c.attributeMaps.push(Q.GroupAttributeRet.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&_)}}return c},i.AttributeMap=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=I.Long?I.Long.fromBits(0,0,!0):0,e.encode=function(o,c){return c||(c=ta.create()),o.key!=null&&Object.hasOwnProperty.call(o,"key")&&c.uint32(10).string(o.key),o.value!=null&&Object.hasOwnProperty.call(o,"value")&&c.uint32(18).string(o.value),o.origin!=null&&Object.hasOwnProperty.call(o,"origin")&&c.uint32(26).string(o.origin),o.ms!=null&&Object.hasOwnProperty.call(o,"ms")&&c.uint32(32).uint64(o.ms),c},e.decode=function(o,c){o instanceof T||(o=T.create(o)),c=c===void 0?o.len:o.pos+c;for(var _=new Q.GroupAttributeRet.AttributeMap;o.pos<c;){var $=o.uint32();switch($>>>3){case 1:_.key=o.string();break;case 2:_.value=o.string();break;case 3:_.origin=o.string();break;case 4:_.ms=o.uint64();break;default:o.skipType(7&$)}}return _},e}(),i}(),QJ=Q.GroupAttributeSet=function(){function i(e){if(this.attributeInfos=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.group="",i.prototype.broadcast=!1,i.prototype.attributeInfos=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&o.uint32(18).string(e.group),e.broadcast!=null&&Object.hasOwnProperty.call(e,"broadcast")&&o.uint32(24).bool(e.broadcast),e.attributeInfos!=null&&e.attributeInfos.length)for(var c=0;c<e.attributeInfos.length;++c)Q.GroupAttributeSet.AttributeInfo.encode(e.attributeInfos[c],o.uint32(34).fork()).ldelim();return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAttributeSet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.group=e.string();break;case 3:c.broadcast=e.bool();break;case 4:c.attributeInfos&&c.attributeInfos.length||(c.attributeInfos=[]),c.attributeInfos.push(Q.GroupAttributeSet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&_)}}return c},i.AttributeInfo=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.key="",e.prototype.value="",e.encode=function(o,c){return c||(c=ta.create()),o.key!=null&&Object.hasOwnProperty.call(o,"key")&&c.uint32(10).string(o.key),o.value!=null&&Object.hasOwnProperty.call(o,"value")&&c.uint32(18).string(o.value),c},e.decode=function(o,c){o instanceof T||(o=T.create(o)),c=c===void 0?o.len:o.pos+c;for(var _=new Q.GroupAttributeSet.AttributeInfo;o.pos<c;){var $=o.uint32();switch($>>>3){case 1:_.key=o.string();break;case 2:_.value=o.string();break;default:o.skipType(7&$)}}return _},e}(),i}(),RJ=Q.GroupAttributeMod=function(){function i(e){if(this.attributeInfos=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.group="",i.prototype.broadcast=!1,i.prototype.attributeInfos=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&o.uint32(18).string(e.group),e.broadcast!=null&&Object.hasOwnProperty.call(e,"broadcast")&&o.uint32(24).bool(e.broadcast),e.attributeInfos!=null&&e.attributeInfos.length)for(var c=0;c<e.attributeInfos.length;++c)Q.GroupAttributeMod.AttributeInfo.encode(e.attributeInfos[c],o.uint32(34).fork()).ldelim();return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAttributeMod;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.group=e.string();break;case 3:c.broadcast=e.bool();break;case 4:c.attributeInfos&&c.attributeInfos.length||(c.attributeInfos=[]),c.attributeInfos.push(Q.GroupAttributeMod.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&_)}}return c},i.AttributeInfo=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.key="",e.prototype.value="",e.encode=function(o,c){return c||(c=ta.create()),o.key!=null&&Object.hasOwnProperty.call(o,"key")&&c.uint32(10).string(o.key),o.value!=null&&Object.hasOwnProperty.call(o,"value")&&c.uint32(18).string(o.value),c},e.decode=function(o,c){o instanceof T||(o=T.create(o)),c=c===void 0?o.len:o.pos+c;for(var _=new Q.GroupAttributeMod.AttributeInfo;o.pos<c;){var $=o.uint32();switch($>>>3){case 1:_.key=o.string();break;case 2:_.value=o.string();break;default:o.skipType(7&$)}}return _},e}(),i}(),SJ=Q.GroupAttributeDel=function(){function i(e){if(this.attributes=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.group="",i.prototype.broadcast=!1,i.prototype.attributes=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&o.uint32(18).string(e.group),e.broadcast!=null&&Object.hasOwnProperty.call(e,"broadcast")&&o.uint32(24).bool(e.broadcast),e.attributes!=null&&e.attributes.length)for(var c=0;c<e.attributes.length;++c)o.uint32(34).string(e.attributes[c]);return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAttributeDel;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.group=e.string();break;case 3:c.broadcast=e.bool();break;case 4:c.attributes&&c.attributes.length||(c.attributes=[]),c.attributes.push(e.string());break;default:e.skipType(7&_)}}return c},i}(),TJ=Q.GroupAttributeAlt=function(){function i(e){if(this.attributeMaps=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.group="",i.prototype.instance=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.attributeMaps=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&o.uint32(18).string(e.group),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&o.uint32(24).uint64(e.instance),e.attributeMaps!=null&&e.attributeMaps.length)for(var c=0;c<e.attributeMaps.length;++c)Q.GroupAttributeAlt.AttributeMap.encode(e.attributeMaps[c],o.uint32(34).fork()).ldelim();return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAttributeAlt;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.group=e.string();break;case 3:c.instance=e.uint64();break;case 4:c.attributeMaps&&c.attributeMaps.length||(c.attributeMaps=[]),c.attributeMaps.push(Q.GroupAttributeAlt.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&_)}}return c},i.AttributeMap=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=I.Long?I.Long.fromBits(0,0,!0):0,e.encode=function(o,c){return c||(c=ta.create()),o.key!=null&&Object.hasOwnProperty.call(o,"key")&&c.uint32(10).string(o.key),o.value!=null&&Object.hasOwnProperty.call(o,"value")&&c.uint32(18).string(o.value),o.origin!=null&&Object.hasOwnProperty.call(o,"origin")&&c.uint32(26).string(o.origin),o.ms!=null&&Object.hasOwnProperty.call(o,"ms")&&c.uint32(32).uint64(o.ms),c},e.decode=function(o,c){o instanceof T||(o=T.create(o)),c=c===void 0?o.len:o.pos+c;for(var _=new Q.GroupAttributeAlt.AttributeMap;o.pos<c;){var $=o.uint32();switch($>>>3){case 1:_.key=o.string();break;case 2:_.value=o.string();break;case 3:_.origin=o.string();break;case 4:_.ms=o.uint64();break;default:o.skipType(7&$)}}return _},e}(),i}(),UJ=Q.GroupAttributeRsp=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAttributeRsp;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),VJ=Q.GroupAttributeErr=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(16).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAttributeErr;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),WJ=Q.GroupAttributeKeysGet=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.group="",i.encode=function(e,o){return o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&o.uint32(18).string(e.group),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAttributeKeysGet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.group=e.string();break;default:e.skipType(7&_)}}return c},i}(),XJ=Q.GroupAttributeKeysRet=function(){function i(e){if(this.keys=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.keys=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.keys!=null&&e.keys.length)for(var c=0;c<e.keys.length;++c)o.uint32(18).string(e.keys[c]);return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.GroupAttributeKeysRet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.keys&&c.keys.length||(c.keys=[]),c.keys.push(e.string());break;default:e.skipType(7&_)}}return c},i}(),YJ=Q.SubscribeUserStatus=function(){function i(e){if(this.users=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.users=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.users!=null&&e.users.length)for(var c=0;c<e.users.length;++c)o.uint32(18).string(e.users[c]);return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.SubscribeUserStatus;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.users&&c.users.length||(c.users=[]),c.users.push(e.string());break;default:e.skipType(7&_)}}return c},i}(),ZJ=Q.UnsubscribeUserStatus=function(){function i(e){if(this.users=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.users=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.users!=null&&e.users.length)for(var c=0;c<e.users.length;++c)o.uint32(18).string(e.users[c]);return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UnsubscribeUserStatus;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.users&&c.users.length||(c.users=[]),c.users.push(e.string());break;default:e.skipType(7&_)}}return c},i}(),$J=Q.UserJoinNotice=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.instance=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.user="",i.encode=function(e,o){return o||(o=ta.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&o.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(16).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&o.uint32(26).string(e.user),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserJoinNotice;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.instance=e.uint64();break;case 2:c.seq=e.uint64();break;case 3:c.user=e.string();break;default:e.skipType(7&_)}}return c},i}(),aK=Q.UserQuitNotice=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.instance=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.user="",i.encode=function(e,o){return o||(o=ta.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&o.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(16).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&o.uint32(26).string(e.user),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserQuitNotice;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.instance=e.uint64();break;case 2:c.seq=e.uint64();break;case 3:c.user=e.string();break;default:e.skipType(7&_)}}return c},i}(),bK=Q.UserWaitNotice=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.instance=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.user="",i.encode=function(e,o){return o||(o=ta.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&o.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(16).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&o.uint32(26).string(e.user),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.UserWaitNotice;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.instance=e.uint64();break;case 2:c.seq=e.uint64();break;case 3:c.user=e.string();break;default:e.skipType(7&_)}}return c},i}(),cK=Q.StateSubscribe=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.subTarget="",i.prototype.sequence=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.subTarget!=null&&Object.hasOwnProperty.call(e,"subTarget")&&o.uint32(18).string(e.subTarget),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&o.uint32(24).uint64(e.sequence),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(32).uint64(e.flags),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateSubscribe;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.subTarget=e.string();break;case 3:c.sequence=e.uint64();break;case 4:c.flags=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),dK=Q.StateUpdate=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.subTarget="",i.prototype.allStates="",i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.subTarget!=null&&Object.hasOwnProperty.call(e,"subTarget")&&o.uint32(18).string(e.subTarget),e.allStates!=null&&Object.hasOwnProperty.call(e,"allStates")&&o.uint32(26).string(e.allStates),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(32).uint64(e.flags),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateUpdate;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.subTarget=e.string();break;case 3:c.allStates=e.string();break;case 4:c.flags=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),eK=Q.StateSubscribeResult=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.subTarget="",i.prototype.sequence=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.subTarget!=null&&Object.hasOwnProperty.call(e,"subTarget")&&o.uint32(18).string(e.subTarget),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&o.uint32(24).uint64(e.sequence),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(32).uint64(e.flags),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(40).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateSubscribeResult;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.subTarget=e.string();break;case 3:c.sequence=e.uint64();break;case 4:c.flags=e.uint64();break;case 5:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),fK=Q.StateUnsubscribe=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.subTarget="",i.prototype.sequence=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.subTarget!=null&&Object.hasOwnProperty.call(e,"subTarget")&&o.uint32(18).string(e.subTarget),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&o.uint32(24).uint64(e.sequence),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(32).uint64(e.flags),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateUnsubscribe;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.subTarget=e.string();break;case 3:c.sequence=e.uint64();break;case 4:c.flags=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),gK=Q.StateSet=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.author="",i.prototype.value="",i.prototype.lock="",i.prototype.requestUuid="",i.prototype.sequence=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.baseRevision=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.lockRev=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.author!=null&&Object.hasOwnProperty.call(e,"author")&&o.uint32(18).string(e.author),e.value!=null&&Object.hasOwnProperty.call(e,"value")&&o.uint32(26).string(e.value),e.lock!=null&&Object.hasOwnProperty.call(e,"lock")&&o.uint32(34).string(e.lock),e.requestUuid!=null&&Object.hasOwnProperty.call(e,"requestUuid")&&o.uint32(42).string(e.requestUuid),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&o.uint32(48).uint64(e.sequence),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(56).uint64(e.flags),e.baseRevision!=null&&Object.hasOwnProperty.call(e,"baseRevision")&&o.uint32(64).uint64(e.baseRevision),e.lockRev!=null&&Object.hasOwnProperty.call(e,"lockRev")&&o.uint32(72).uint64(e.lockRev),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateSet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.author=e.string();break;case 3:c.value=e.string();break;case 4:c.lock=e.string();break;case 5:c.requestUuid=e.string();break;case 6:c.sequence=e.uint64();break;case 7:c.flags=e.uint64();break;case 8:c.baseRevision=e.uint64();break;case 9:c.lockRev=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),hK=Q.StateModify=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.author="",i.prototype.value="",i.prototype.lock="",i.prototype.requestUuid="",i.prototype.sequence=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.baseRevision=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.lockRev=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.author!=null&&Object.hasOwnProperty.call(e,"author")&&o.uint32(18).string(e.author),e.value!=null&&Object.hasOwnProperty.call(e,"value")&&o.uint32(26).string(e.value),e.lock!=null&&Object.hasOwnProperty.call(e,"lock")&&o.uint32(34).string(e.lock),e.requestUuid!=null&&Object.hasOwnProperty.call(e,"requestUuid")&&o.uint32(42).string(e.requestUuid),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&o.uint32(48).uint64(e.sequence),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(56).uint64(e.flags),e.baseRevision!=null&&Object.hasOwnProperty.call(e,"baseRevision")&&o.uint32(64).uint64(e.baseRevision),e.lockRev!=null&&Object.hasOwnProperty.call(e,"lockRev")&&o.uint32(72).uint64(e.lockRev),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateModify;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.author=e.string();break;case 3:c.value=e.string();break;case 4:c.lock=e.string();break;case 5:c.requestUuid=e.string();break;case 6:c.sequence=e.uint64();break;case 7:c.flags=e.uint64();break;case 8:c.baseRevision=e.uint64();break;case 9:c.lockRev=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),iK=Q.StateRequestResult=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.requestUuid="",i.prototype.sequence=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.requestUuid!=null&&Object.hasOwnProperty.call(e,"requestUuid")&&o.uint32(10).string(e.requestUuid),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&o.uint32(16).uint64(e.sequence),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(24).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateRequestResult;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.requestUuid=e.string();break;case 2:c.sequence=e.uint64();break;case 3:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),jK=Q.StateGet=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.subTarget="",i.prototype.lock="",i.prototype.sequence=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.lockRev=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.subTarget!=null&&Object.hasOwnProperty.call(e,"subTarget")&&o.uint32(18).string(e.subTarget),e.lock!=null&&Object.hasOwnProperty.call(e,"lock")&&o.uint32(26).string(e.lock),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&o.uint32(32).uint64(e.sequence),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(40).uint64(e.flags),e.lockRev!=null&&Object.hasOwnProperty.call(e,"lockRev")&&o.uint32(48).uint64(e.lockRev),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateGet;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.subTarget=e.string();break;case 3:c.lock=e.string();break;case 4:c.sequence=e.uint64();break;case 5:c.flags=e.uint64();break;case 6:c.lockRev=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),kK=Q.StateGetResult=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.subTarget="",i.prototype.allStates="",i.prototype.sequence=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.subTarget!=null&&Object.hasOwnProperty.call(e,"subTarget")&&o.uint32(18).string(e.subTarget),e.allStates!=null&&Object.hasOwnProperty.call(e,"allStates")&&o.uint32(26).string(e.allStates),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&o.uint32(32).uint64(e.sequence),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(40).uint64(e.flags),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(48).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateGetResult;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.subTarget=e.string();break;case 3:c.allStates=e.string();break;case 4:c.sequence=e.uint64();break;case 5:c.flags=e.uint64();break;case 6:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),lK=Q.StateLockAcquire=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.lock="",i.prototype.requestUuid="",i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.ttl=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.lock!=null&&Object.hasOwnProperty.call(e,"lock")&&o.uint32(18).string(e.lock),e.requestUuid!=null&&Object.hasOwnProperty.call(e,"requestUuid")&&o.uint32(26).string(e.requestUuid),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(32).uint64(e.flags),e.ttl!=null&&Object.hasOwnProperty.call(e,"ttl")&&o.uint32(40).uint64(e.ttl),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateLockAcquire;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.lock=e.string();break;case 3:c.requestUuid=e.string();break;case 4:c.flags=e.uint64();break;case 5:c.ttl=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),mK=Q.StateLockRelease=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.lock="",i.prototype.requestUuid="",i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.lock!=null&&Object.hasOwnProperty.call(e,"lock")&&o.uint32(18).string(e.lock),e.requestUuid!=null&&Object.hasOwnProperty.call(e,"requestUuid")&&o.uint32(26).string(e.requestUuid),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(32).uint64(e.flags),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateLockRelease;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.lock=e.string();break;case 3:c.requestUuid=e.string();break;case 4:c.flags=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),nK=Q.StateLockAcquireResult=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.lock="",i.prototype.requestUuid="",i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.lockRev=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.code=0,i.prototype.reason="",i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.lock!=null&&Object.hasOwnProperty.call(e,"lock")&&o.uint32(18).string(e.lock),e.requestUuid!=null&&Object.hasOwnProperty.call(e,"requestUuid")&&o.uint32(26).string(e.requestUuid),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(32).uint64(e.flags),e.lockRev!=null&&Object.hasOwnProperty.call(e,"lockRev")&&o.uint32(40).uint64(e.lockRev),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(48).uint32(e.code),e.reason!=null&&Object.hasOwnProperty.call(e,"reason")&&o.uint32(58).string(e.reason),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateLockAcquireResult;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.lock=e.string();break;case 3:c.requestUuid=e.string();break;case 4:c.flags=e.uint64();break;case 5:c.lockRev=e.uint64();break;case 6:c.code=e.uint32();break;case 7:c.reason=e.string();break;default:e.skipType(7&_)}}return c},i}(),oK=Q.StateLockUpdate=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.lock="",i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.lock!=null&&Object.hasOwnProperty.call(e,"lock")&&o.uint32(18).string(e.lock),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(24).uint64(e.flags),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(32).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateLockUpdate;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.lock=e.string();break;case 3:c.flags=e.uint64();break;case 4:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),pK=Q.StateLockReleaseResult=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.lock="",i.prototype.requestUuid="",i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.lock!=null&&Object.hasOwnProperty.call(e,"lock")&&o.uint32(18).string(e.lock),e.requestUuid!=null&&Object.hasOwnProperty.call(e,"requestUuid")&&o.uint32(26).string(e.requestUuid),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(32).uint64(e.flags),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(40).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateLockReleaseResult;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.lock=e.string();break;case 3:c.requestUuid=e.string();break;case 4:c.flags=e.uint64();break;case 5:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),qK=Q.StateLockDisable=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.lock="",i.prototype.userId="",i.prototype.requestUuid="",i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.lock!=null&&Object.hasOwnProperty.call(e,"lock")&&o.uint32(18).string(e.lock),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(26).string(e.userId),e.requestUuid!=null&&Object.hasOwnProperty.call(e,"requestUuid")&&o.uint32(34).string(e.requestUuid),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(40).uint64(e.flags),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateLockDisable;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.lock=e.string();break;case 3:c.userId=e.string();break;case 4:c.requestUuid=e.string();break;case 5:c.flags=e.uint64();break;default:e.skipType(7&_)}}return c},i}(),rK=Q.StateLockDisableResult=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.target="",i.prototype.lock="",i.prototype.requestUuid="",i.prototype.flags=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.code=0,i.encode=function(e,o){return o||(o=ta.create()),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(10).string(e.target),e.lock!=null&&Object.hasOwnProperty.call(e,"lock")&&o.uint32(18).string(e.lock),e.requestUuid!=null&&Object.hasOwnProperty.call(e,"requestUuid")&&o.uint32(26).string(e.requestUuid),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(32).uint64(e.flags),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(40).uint32(e.code),o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.StateLockDisableResult;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.target=e.string();break;case 2:c.lock=e.string();break;case 3:c.requestUuid=e.string();break;case 4:c.flags=e.uint64();break;case 5:c.code=e.uint32();break;default:e.skipType(7&_)}}return c},i}(),sK=Q.SubscribeResponse=function(){function i(e){if(this.errors=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.seq=I.Long?I.Long.fromBits(0,0,!0):0,i.prototype.errors=I.emptyArray,i.encode=function(e,o){if(o||(o=ta.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(8).uint64(e.seq),e.errors!=null&&e.errors.length)for(var c=0;c<e.errors.length;++c)Q.SubscribeResponse.SubscribeErrorsType.encode(e.errors[c],o.uint32(18).fork()).ldelim();return o},i.decode=function(e,o){e instanceof T||(e=T.create(e)),o=o===void 0?e.len:e.pos+o;for(var c=new Q.SubscribeResponse;e.pos<o;){var _=e.uint32();switch(_>>>3){case 1:c.seq=e.uint64();break;case 2:c.errors&&c.errors.length||(c.errors=[]),c.errors.push(Q.SubscribeResponse.SubscribeErrorsType.decode(e,e.uint32()));break;default:e.skipType(7&_)}}return c},i.SubscribeErrorsType=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.account="",e.prototype.code=0,e.encode=function(o,c){return c||(c=ta.create()),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&c.uint32(10).string(o.account),o.code!=null&&Object.hasOwnProperty.call(o,"code")&&c.uint32(16).uint32(o.code),c},e.decode=function(o,c){o instanceof T||(o=T.create(o)),c=c===void 0?o.len:o.pos+c;for(var _=new Q.SubscribeResponse.SubscribeErrorsType;o.pos<c;){var $=o.uint32();switch($>>>3){case 1:_.account=o.string();break;case 2:_.code=o.uint32();break;default:o.skipType(7&$)}}return _},e}(),i}(),tK=Object.freeze({__proto__:null,URI:kJ,Wrapper:gl,Ping:lJ,Pong:mJ,UserJoin:nJ,UserResp:oJ,UserQuit:pJ,UserDrop:qJ,UserTicketNearlyExpire:rJ,UserRenewTokenReq:sJ,UserRenewTokenResp:tJ,GroupEnter:uJ,GroupLeave:vJ,GroupReply:wJ,GroupLeaveNotice:ax,GroupEnterNotice:bx,Message:cx,Ack:dx,GroupDrop:xJ,GroupAllUsersList:yJ,GroupAllUsersResult:zJ,UserStatusList:AJ,UserStatusResult:BJ,UserAttributeGet:CJ,UserAttributeRet:DJ,UserAttributeSet:EJ,UserAttributeMod:FJ,UserAttributeDel:GJ,UserAttributeErr:HJ,UserAttributeKeysGet:IJ,UserAttributeKeysRet:JJ,UserAttributeRsp:KJ,GroupStatusList:LJ,GroupStatusResult:MJ,GroupCountNotice:NJ,GroupAttributeGet:OJ,GroupAttributeRet:PJ,GroupAttributeSet:QJ,GroupAttributeMod:RJ,GroupAttributeDel:SJ,GroupAttributeAlt:TJ,GroupAttributeRsp:UJ,GroupAttributeErr:VJ,GroupAttributeKeysGet:WJ,GroupAttributeKeysRet:XJ,SubscribeUserStatus:YJ,UnsubscribeUserStatus:ZJ,UserJoinNotice:$J,UserQuitNotice:aK,UserWaitNotice:bK,StateSubscribe:cK,StateUpdate:dK,StateSubscribeResult:eK,StateUnsubscribe:fK,StateSet:gK,StateModify:hK,StateRequestResult:iK,StateGet:jK,StateGetResult:kK,StateLockAcquire:lK,StateLockRelease:mK,StateLockAcquireResult:nK,StateLockUpdate:oK,StateLockReleaseResult:pK,StateLockDisable:qK,StateLockDisableResult:rK,SubscribeResponse:sK,default:Q}),uK=Math.ceil,ex=function(i){return function(e,o,c){var _=(e=String(Ec(e))).length;return c=c===void 0?" ":String(c),(o=xb(o))<=_||c==""?e:(o-=_,(_=At.call(c,uK(o/c.length))).length>o&&(_=_.slice(0,o)),i?e+_:_+e)}},vK=ex(!1),wK=ex(!0),fx=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(lh);wa({target:"String",proto:!0,forced:fx},{padEnd:function(i){return wK(this,i,1<arguments.length?arguments[1]:void 0)}}),wa({target:"Object",stat:!0},{entries:function(i){return BF(i)}});var xK=pd.f,gx="".endsWith,yK=Math.min,hx=no("endsWith"),zK=!hx&&!!function(){var i=xK(String.prototype,"endsWith");return i&&!i.writable}();wa({target:"String",proto:!0,forced:!zK&&!hx},{endsWith:function(i){var e=String(Ec(this));mo(i);var o=1<arguments.length?arguments[1]:void 0,c=xb(e.length);return o=o===void 0?c:yK(xb(o),c),c=String(i),gx?gx.call(e,c,o):e.slice(o-c.length,o)===c}}),jk("match",1,function(i,e,o){return[function(c){var _=Ec(this),$=c==null?void 0:c[i];return $!==void 0?$.call(c,_):new RegExp(c)[i](String(_))},function(c){var _=o(e,c,this);if(_.done)return _.value;if(c=ub(c),_=String(this),!c.global)return mh(c,_);var $=c.unicode;c.lastIndex=0;for(var _t,ga=[],_s=0;(_t=mh(c,_))!==null;)_t=String(_t[0]),ga[_s]=_t,_t===""&&(c.lastIndex=hn(_,xb(c.lastIndex),$)),_s++;return _s===0?null:ga}]});var AK=pd.f,ix="".startsWith,BK=Math.min,jx=no("startsWith"),CK=!jx&&!!function(){var i=AK(String.prototype,"startsWith");return i&&!i.writable}();wa({target:"String",proto:!0,forced:!CK&&!jx},{startsWith:function(i){var e=String(Ec(this));mo(i);var o=xb(BK(1<arguments.length?arguments[1]:void 0,e.length)),c=String(i);return ix?ix.call(e,c,o):e.slice(o,o+c.length)===c}});var us=function(i){var e=/(%?)(%([jds]))/g,o=Array.prototype.slice.call(arguments,1);return o.length&&(i=i.replace(e,function(c,_,$,_t){switch($=o.shift(),_t){case"s":$=""+$;break;case"d":$=Number($);break;case"j":$=JSON.stringify($)}return _?(o.unshift($),c):$})),o.length&&(i+=" "+o.join(" ")),""+(i=i.replace(/%{2,2}/g,"%"))},DK=/\s/,EK=/^\s+/,kx=NaN,FK=/^[-+]0x[0-9a-f]+$/i,GK=/^0b[01]+$/i,HK=/^0o[0-7]+$/i,IK=parseInt,hl=function(i){if(typeof i=="number")return i;if(Sg(i))return kx;if(Kc(i)&&(i=typeof i.valueOf=="function"?i.valueOf():i,i=Kc(i)?i+"":i),typeof i!="string")return i===0?i:+i;if(i){for(var e=i.slice,o=i.length;o--&&DK.test(i.charAt(o)););i=e.call(i,0,o+1).replace(EK,"")}return(e=GK.test(i))||HK.test(i)?IK(i.slice(2),e?2:8):FK.test(i)?kx:+i},JK=Math.max,KK=Math.min,LK=function(i,e,o){function c(Vl){var _d=_s,Sp=_c;return _s=_c=void 0,Pl=Vl,_l=i.apply(Sp,_d)}function _(Vl){var _d=Vl-Cl;return Vl-=Pl,Cl===void 0||_d>=e||0>_d||Jl&&Vl>=Bl}function $(){var Vl=hd.Date.now();if(_(Vl))return _t(Vl);var _d=setTimeout,Sp=Vl-Pl;Vl=e-(Vl-Cl),Sp=Jl?KK(Vl,Bl-Sp):Vl,Tl=_d($,Sp)}function _t(Vl){return Tl=void 0,zl&&_s?c(Vl):(_s=_c=void 0,_l)}function ga(){var Vl=hd.Date.now(),_d=_(Vl);if(_s=arguments,_c=this,Cl=Vl,_d){if(Tl===void 0)return Pl=Vl=Cl,Tl=setTimeout($,e),Dl?c(Vl):_l;if(Jl)return clearTimeout(Tl),Tl=setTimeout($,e),c(Cl)}return Tl===void 0&&(Tl=setTimeout($,e)),_l}var _s,_c,_l,Tl,Cl,Pl=0,Dl=!1,Jl=!1,zl=!0;if(typeof i!="function")throw new TypeError("Expected a function");if(e=hl(e)||0,Kc(o)){Dl=!!o.leading;var Bl=(Jl="maxWait"in o)?JK(hl(o.maxWait)||0,e):Bl;zl="trailing"in o?!!o.trailing:zl}return ga.cancel=function(){Tl!==void 0&&clearTimeout(Tl),Pl=0,_s=Cl=_c=Tl=void 0},ga.flush=function(){return Tl===void 0?_l:_t(hd.Date.now())},ga},vb;(function(i){i[i.ChannelSMsg=1]="ChannelSMsg",i[i.ChannelRMsg=2]="ChannelRMsg",i[i.P2pSMsgOfflineFlag=3]="P2pSMsgOfflineFlag",i[i.P2pRMsgOfflineFlag=4]="P2pRMsgOfflineFlag",i[i.P2pSMsgNoOfflineFlag=5]="P2pSMsgNoOfflineFlag",i[i.P2pRMsgNoOfflineFlag=6]="P2pRMsgNoOfflineFlag",i[i.P2pCallInvitation=7]="P2pCallInvitation",i[i.P2pCallCancellation=8]="P2pCallCancellation",i[i.P2pCallAcceptance=9]="P2pCallAcceptance",i[i.P2pCallRefusal=10]="P2pCallRefusal"})(vb||(vb={}));var Xe=function(i){function e(c,_){return ab(this,e),E(L(c=o.call(this,ts(c,_))),"originalError",void 0),E(L(c),"code",void 0),E(L(c),"serverCode",void 0),typeof _=="number"?c.code=_:typeof _=="string"?c.name=_:_!==void 0&&(_.originalError&&(c.originalError=_.originalError),_.code!==void 0&&(c.code=_.code),_.serverCode!==void 0&&(c.serverCode=_.serverCode)),c}nb(e,i);var o=ob(e);return e}(di(Error)),Ib=function(i){function e(c,_){return ab(this,e),E(L(c=o.call(this,ts(c,_))),"name","RtmInternalError"),E(L(c),"code",void 0),c.code=_,c}nb(e,i);var o=ob(e);return e}(di(Error)),il=function(){return function(i){function e(c){ab(this,e);var _=Object.keys(c);return o.call(this,c[_[0]],_[0])}nb(e,i);var o=ob(e);return e}(Ib)},rb=il(),Pc=function(i){function e(){ab(this,e);for(var c=arguments.length,_=Array(c),$=0;$<c;$++)_[$]=arguments[$];return E(L(c=o.call.apply(o,[this].concat(_))),"name","RtmTimeoutError"),c}nb(e,i);var o=ob(e);return e}(Xe),ja=function(i){function e(){ab(this,e);for(var c=arguments.length,_=Array(c),$=0;$<c;$++)_[$]=arguments[$];return E(L(c=o.call.apply(o,[this].concat(_))),"name","RtmInvalidArgumentError"),c}nb(e,i);var o=ob(e);return e}(Xe),ia=function(i){function e(){ab(this,e);for(var c=arguments.length,_=Array(c),$=0;$<c;$++)_[$]=arguments[$];return E(L(c=o.call.apply(o,[this].concat(_))),"name","RtmInvalidStatusError"),c}nb(e,i);var o=ob(e);return e}(Xe),Dc=function(i){function e(){ab(this,e);for(var c=arguments.length,_=Array(c),$=0;$<c;$++)_[$]=arguments[$];return E(L(c=o.call.apply(o,[this].concat(_))),"name","RtmLimitExceededError"),c}nb(e,i);var o=ob(e);return e}(Xe),Fc=function(i){function e(){ab(this,e);for(var c=arguments.length,_=Array(c),$=0;$<c;$++)_[$]=arguments[$];return E(L(c=o.call.apply(o,[this].concat(_))),"name","RtmInvokeTooOftenError"),c}nb(e,i);var o=ob(e);return e}(Xe),Pa=function(i){function e(){ab(this,e);for(var c=arguments.length,_=Array(c),$=0;$<c;$++)_[$]=arguments[$];return E(L(c=o.call.apply(o,[this].concat(_))),"name","RtmUnavailableError"),E(L(c),"serverCode",void 0),E(L(c),"statusCode",void 0),c}nb(e,i);var o=ob(e);return e}(Xe),Gh=function(i){function e(){ab(this,e);for(var c=arguments.length,_=Array(c),$=0;$<c;$++)_[$]=arguments[$];return E(L(c=o.call.apply(o,[this].concat(_))),"name","RtmUnauthenticatedError"),E(L(c),"serverCode",void 0),c}nb(e,i);var o=ob(e);return e}(Xe),id=function(i){function e(){ab(this,e);for(var c=arguments.length,_=Array(c),$=0;$<c;$++)_[$]=arguments[$];return E(L(c=o.call.apply(o,[this].concat(_))),"name","RtmUnknownError"),c}nb(e,i);var o=ob(e);return e}(Xe),uc=function(i){return i instanceof Pc||i instanceof ad},Sa=function(i){return i instanceof Xe},vg=function(i,e,o){return['Executing "%s.%s" timed out after %ds',i,e,o/1e3]},ss=new Map,MK=function(){var i=new Date;return"".concat(i.toISOString().split("T")[1].replace(/\..+/,""),".").concat(i.getMilliseconds())},vi=Object.keys,Vj=Object.entries.bind(Object),Sj=function(i){return typeof i=="string"?i.endsWith(".")?i:"".concat(i,"."):i},NK=Ga(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1});wa({target:"Date",proto:!0,forced:NK},{toJSON:function(i){i=Zb(this);var e=le(i);return typeof e!="number"||isFinite(e)?i.toISOString():null}}),wa({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var rC=Object.prototype.hasOwnProperty,lx=function(i,e,o){return JSON.stringify(As(i),e,o)};lx.ensureProperties=As;var OK=function(i,e){e=e||{};var o=Ia(i);if(o==="string"&&0<i.length)return sC(i);if(o==="number"&&isFinite(i))return e.long?i=864e5<=(e=Math.abs(i))?Xj(i,e,864e5,"day"):36e5<=e?Xj(i,e,36e5,"hour"):6e4<=e?Xj(i,e,6e4,"minute"):1e3<=e?Xj(i,e,1e3,"second"):i+" ms":i=864e5<=(e=Math.abs(i))?Math.round(i/864e5)+"d":36e5<=e?Math.round(i/36e5)+"h":6e4<=e?Math.round(i/6e4)+"m":1e3<=e?Math.round(i/1e3)+"s":i+"ms",i;throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))},PK=function(i){function e(_){function $(){for(var _s=arguments.length,_c=Array(_s),_l=0;_l<_s;_l++)_c[_l]=arguments[_l];if($.enabled){_s=Number(new Date),$.diff=_s-(_t||_s),$.prev=_t,_t=$.curr=_s,_c[0]=e.coerce(_c[0]),typeof _c[0]!="string"&&_c.unshift("%O");var Tl=0;_c[0]=_c[0].replace(/%([a-zA-Z%])/g,function(Cl,Pl){return Cl==="%%"?"%":(Tl++,typeof(Pl=e.formatters[Pl])=="function"&&(Cl=Pl.call($,_c[Tl]),_c.splice(Tl,1),Tl--),Cl)}),e.formatArgs.call($,_c),($.log||e.log).apply($,_c)}}var _t,ga=null;return $.namespace=_,$.useColors=e.useColors(),$.color=e.selectColor(_),$.extend=o,$.destroy=e.destroy,Object.defineProperty($,"enabled",{enumerable:!0,configurable:!1,get:function(){return ga===null?e.enabled(_):ga},set:function(_s){ga=_s}}),typeof e.init=="function"&&e.init($),$}function o(_,$){return(_=e(this.namespace+($===void 0?":":$)+_)).log=this.log,_}function c(_){return _.toString().substring(2,_.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(_){return _ instanceof Error?_.stack||_.message:_},e.disable=function(){var _=[].concat(ra(e.names.map(c)),ra(e.skips.map(c).map(function($){return"-"+$}))).join(",");return e.enable(""),_},e.enable=function(_){e.save(_),e.names=[],e.skips=[];var $,_t=(typeof _=="string"?_:"").split(/[\s,]+/),ga=_t.length;for($=0;$<ga;$++)_t[$]&&((_=_t[$].replace(/\*/g,".*?"))[0]==="-"?e.skips.push(new RegExp("^"+_.substr(1)+"$")):e.names.push(new RegExp("^"+_+"$")))},e.enabled=function(_){if(_[_.length-1]==="*")return!0;var $,_t=0;for($=e.skips.length;_t<$;_t++)if(e.skips[_t].test(_))return!1;for(_t=0,$=e.names.length;_t<$;_t++)if(e.names[_t].test(_))return!0;return!1},e.humanize=OK,e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(i).forEach(function(_){e[_]=i[_]}),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(_){for(var $=0,_t=0;_t<_.length;_t++)$=($<<5)-$+_.charCodeAt(_t),$|=0;return e.colors[Math.abs($)%e.colors.length]},e.enable(e.load()),e},mx=kc(function(i,e){e.formatArgs=function(_){if(_[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+_[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),this.useColors){var $="color: "+this.color;_.splice(1,0,$,"color: inherit");var _t=0,ga=0;_[0].replace(/%[a-zA-Z%]/g,function(_s){_s!=="%%"&&(_t++,_s==="%c"&&(ga=_t))}),_.splice(ga,0,$)}},e.save=function(_){try{_?e.storage.setItem("debug",_):e.storage.removeItem("debug")}catch{}},e.load=function(){try{var _=e.storage.getItem("debug")}catch{}return!_&&typeof process<"u"&&"env"in process&&(_={}.DEBUG),_},e.useColors=function(){return!(typeof window>"u"||!window.process||window.process.type!=="renderer"&&!window.process.__nwjs)||(typeof navigator>"u"||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))};t:{try{var o=localStorage;break t}catch{}o=void 0}var c;e.storage=o,e.destroy=(c=!1,function(){c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),e.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" "),e.log=console.debug||console.log||function(){},i.exports=PK(e),i.exports.formatters.j=function(_){try{return JSON.stringify(_)}catch($){return"[UnexpectedJSONParseError]: "+$.message}}}),nx=mx("RTM:DEBUG"),Hh;nx.enabled=!1,function(i){i[i.Uploading=0]="Uploading",i[i.Free=1]="Free"}(Hh||(Hh={}));var QK=function(){function i(e){ab(this,i),E(this,"uploadRequest",void 0),E(this,"uploadState",void 0),E(this,"uploadResendCount",void 0),E(this,"LogCache",void 0),E(this,"LogsToPost",void 0),E(this,"processId",void 0),E(this,"sdkVersion",void 0),E(this,"logId",void 0),E(this,"rtmConfig",void 0),this.processId=e.processId,this.sdkVersion=e.sdkVersion,this.rtmConfig=e.rtmConfig,this.uploadRequest=e.uploadRequest,this.uploadState=Hh.Free,this.uploadResendCount=0,this.LogCache=[],this.LogsToPost=[],this.logId=0}return Qb(i,[{key:"upload",value:function(e){this.LogCache.push(e),this.uploadState===Hh.Free&&(this.LogsToPost=40>this.LogCache.length?this.LogCache.splice(0,this.LogCache.length):this.LogCache.splice(0,40),this.postLog(this.LogsToPost))}},{key:"postLog",value:function(e){var o=this;this.uploadState=Hh.Uploading,setTimeout(za(W.mark(function c(){var _,$,_t;return W.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:return _={sdk_version:o.sdkVersion,process_id:o.processId,payload:JSON.stringify(e)},ga.prev=1,ga.next=4,o.uploadRequest(_,($=o.rtmConfig.enableCloudProxy)!==null&&$!==void 0&&$);case 4:if(!Bm){ga.next=6;break}throw Error("RTM is busy");case 6:ga.next=13;break;case 8:return ga.prev=8,ga.t0=ga.catch(1),_t=2>o.uploadResendCount++?2e3:1e4,setTimeout(function(){return o.postLog(o.LogsToPost)},_t),ga.abrupt("return");case 13:if(nx('The logs uploaded for "process-'.concat(hj,'"')),o.LogCache.length!==0){ga.next=17;break}return o.uploadState=Hh.Free,ga.abrupt("return");case 17:o.uploadResendCount=0,o.LogsToPost=40>o.LogCache.length?o.LogCache.splice(0,o.LogCache.length):o.LogCache.splice(0,40),o.postLog(o.LogsToPost);case 20:case"end":return ga.stop()}},c,null,[[1,8]])})),wg.getParameter("LOG_UPLOAD_INTERVAL"))}}]),i}(),ox=function(i,e,o,c,_,$,_t,ga){var _s=0;for(_t=!!_t&&tf(_t,ga,3);_s<c;){if(_s in o){if(ga=_t?_t(o[_s],_s,e):o[_s],0<$&&uf(ga))_=ox(i,e,ga,xb(ga.length),_,$-1)-1;else{if(9007199254740991<=_)throw TypeError("Exceed the acceptable array length");i[_]=ga}_++}_s++}return _},px=ox;wa({target:"Array",proto:!0},{flat:function(){var i=arguments.length?arguments[0]:void 0,e=Zb(this),o=xb(e.length),c=Ei(e,0);return c.length=px(c,e,e,o,0,i===void 0?1:Rd(i)),c}});var RK=["CODE"],jd,Gf,oa;(function(i){i.CHINA="CN",i.ASIA="AS",i.NORTH_AMERICA="NA",i.EUROPE="EU",i.JAPAN="JP",i.INDIA="IN",i.OCEANIA="OC",i.SOUTH_AMERICA="SA",i.AFRICA="AF",i.OVERSEA="OVERSEA",i.GLOBAL="GLOBAL"})(oa||(oa={}));var SK={CN:oa.CHINA,NA:oa.NORTH_AMERICA,EU:oa.EUROPE,AS:oa.ASIA,JP:oa.JAPAN,IN:oa.INDIA,GLOB:oa.GLOBAL,AF:oa.AFRICA,OC:oa.OVERSEA,OVS:oa.OVERSEA,SA:oa.SOUTH_AMERICA},Yj=ys((jd={},E(jd,oa.ASIA,{CODE:oa.ASIA,AP_DOMAINS:["ap-web-1-asia.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-asia.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_AP:["proxy-ap-web-asia.agora.io"],PROXY_NGINX:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]}),E(jd,oa.NORTH_AMERICA,{CODE:oa.NORTH_AMERICA,AP_DOMAINS:["ap-web-1-north-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-north-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_AP:["proxy-ap-web-america.agora.io"],PROXY_NGINX:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]}),E(jd,oa.EUROPE,{CODE:oa.EUROPE,AP_DOMAINS:["ap-web-1-europe.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-europe.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_AP:["proxy-ap-web-europe.agora.io"],PROXY_NGINX:["europe.webrtc-cloud-proxy.sd-rtn.com"]}),E(jd,oa.JAPAN,{CODE:oa.JAPAN,AP_DOMAINS:["ap-web-1-japan.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-japan.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_AP:["proxy-ap-web-japan.agora.io"],PROXY_NGINX:["japan.webrtc-cloud-proxy.sd-rtn.com"]}),E(jd,oa.INDIA,{CODE:oa.INDIA,AP_DOMAINS:["ap-web-1-india.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-india.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_AP:["proxy-ap-web-india.agora.io"],PROXY_NGINX:["india.webrtc-cloud-proxy.sd-rtn.com"]}),E(jd,oa.OVERSEA,{CODE:oa.OVERSEA,AP_DOMAINS:["ap-web-1-oversea.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_AP:["proxy-ap-web-oversea.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.agora.io"]}),E(jd,oa.GLOBAL,{CODE:oa.GLOBAL,AP_DOMAINS:["ap-web-1.agora.io","ap-web-2.agora.io"],AP_BACKUP_DOMAINS:["ap-web-3.agora.io","ap-web-4.agora.io"],EVENT_REPORT_DOMAIN:["webcollector-rtm.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["webcollector-1.agora.io"],LOG_UPLOAD_SERVER:["logservice-rtm.agora.io"],PROXY_AP:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.sd-rtn.com"]}),E(jd,oa.OCEANIA,{CODE:oa.OCEANIA,AP_DOMAINS:["ap-web-1-oceania.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oceania.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_AP:["proxy-ap-web-oceania.agora.io"],PROXY_NGINX:["oceania.webrtc-cloud-proxy.sd-rtn.com"]}),E(jd,oa.SOUTH_AMERICA,{CODE:oa.SOUTH_AMERICA,AP_DOMAINS:["ap-web-1-south-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-south-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_AP:["proxy-ap-web-south-america.agora.io"],PROXY_NGINX:["south-america.webrtc-cloud-proxy.sd-rtn.com"]}),E(jd,oa.AFRICA,{CODE:oa.AFRICA,AP_DOMAINS:["ap-web-1-africa.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-africa.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_AP:["proxy-ap-web-africa.agora.io"],PROXY_NGINX:["africa.webrtc-cloud-proxy.sd-rtn.com"]}),E(jd,oa.CHINA,{CODE:oa.CHINA,AP_DOMAINS:["webrtc2-2.ap.sd-rtn.com"],AP_BACKUP_DOMAINS:["webrtc2-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_AP:["proxy-ap-web.agoraio.cn"],PROXY_NGINX:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),jd)),wi=(Gf={},E(Gf,oa.ASIA,[oa.CHINA,oa.JAPAN,oa.INDIA]),E(Gf,oa.EUROPE,[]),E(Gf,oa.NORTH_AMERICA,[]),E(Gf,oa.SOUTH_AMERICA,[]),E(Gf,oa.OCEANIA,[]),E(Gf,oa.AFRICA,[]),Gf),qx=[oa.OVERSEA,oa.GLOBAL,oa.CHINA,oa.NORTH_AMERICA,oa.EUROPE,oa.ASIA,oa.JAPAN,oa.INDIA,oa.OCEANIA,oa.SOUTH_AMERICA,oa.AFRICA],Bs=function(i){return Object.values(wi).flat().includes(i)},uC=function(i){var e;return(e=Vj(wi).find(function(o){return(o=Lb(o,2))[0],o[1].includes(i)}))===null||e===void 0?void 0:e[0]},TK=function(i){return i.sort(function(e,o){return qx.indexOf(e)-qx.indexOf(o)})},eh=function(i){var e=new Set;if((i=TK(i).slice(0,3).map(function(o){var c=Yj[o];if(c===void 0)throw new Ib("invalid area key");return o=c.CODE,c=em(c,RK),e.add(o),c})).length===0)throw new Ib("areas cannot be empty");return tb({CODES:e},i.reduce(function(o,c){for(var _=0,$=Vj(o);_<$.length;_++){var _t=Lb($[_],2),ga=_t[0];_t=_t[1],o[ga]=Array.from(new Set([].concat(ra(c[ga]),ra(_t))))}return o}))},Ba,rx=function(){var i=za(W.mark(function e(o,c){var _,$,_t,ga,_s,_c=arguments;return W.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(!(2<($=2<_c.length&&_c[2]!==void 0?_c[2]:0))){_l.next=3;break}return _l.abrupt("return");case 3:return _t={withCredentials:!0,body:o,timeout:2e4},ga=0<$?(Ba==null?void 0:Ba.LOG_UPLOAD_SERVER[0])||"rtm.logservice.sd-rtn.com":(Ba==null?void 0:Ba.LOG_UPLOAD_SERVER[0])||"logservice-rtm.agora.io",_s=c?"https://".concat((_=Ba==null?void 0:Ba.PROXY_NGINX[0])!==null&&_!==void 0?_:"webrtc-cloud-proxy.sd-rtn.com","/ls/?h=").concat(ga,"&p=443&d=upload/v1"):"https://".concat(ga,"/upload/v1"),_l.next=8,Tj(_s,_t).catch(function(Tl){return rx(o,c,$+1)});case 8:case"end":return _l.stop()}},e)}));return function(e,o){return i.apply(this,arguments)}}(),sx=new QK({processId:"process-".concat(hj),sdkVersion:"Agora_RTM_SDK_for_Web_".concat("v1.5.1-67-g0f6d3600"),uploadRequest:rx,rtmConfig:{}}),pp="text payload rawMessage thumbnail attributeInfos keys value extra".split(" "),tx="account ticket uid detail token account fileName cname user group key origin users src dst lastUpdateUserId channel cert wan_ip".split(" "),ux=["serverReceivedTs","hasPeerReceived","messageType","enableNotificationToChannelMembers","lastUpdateTs"],UK="ChannelMessage MemberLeft MessageFromPeer LocalInvitationRefused LocalInvitationAccepted RemoteInvitationCanceled PeersOnlineStatusChanged AttributesUpdated MemberJoined".split(" "),fh=function(i){if(typeof i=="string")return wb(i);if(Array.isArray(i)&&i.every(function($){return typeof $=="string"}))return i.map(function($){return wb($)});if(!or(i)){for(var e={},o=0;o<ux.length;o++){var c=ux[o];c in i&&(e[c]=i[c])}if(0<Object.keys(e).length)return e;if(5>Object.keys(i).length){for(o=0,i=Object.entries(i);o<i.length;o++){var _=Lb(i[o],2);c=_[0],_=_[1],pp.includes(c)?e[c]="[Hidden Info]":e[wb(c)]=typeof _=="string"?wb(_):"[Sensitive Info]"}return e}return"[Sensitive Info]"}return i},vx=function(i){return Ia(i)==="object"?Lg(i)?xs(Pg(i,5),pp,tx):i.constructor&&i.constructor.name:i},wx=function(i,e){return i instanceof Error?i.message:typeof i!="string"?JSON.stringify(xs(Pg(i,5),pp,tx)):(e=e.map(function(o){return o instanceof Error?o.message:Ia(o)==="object"?lx(Array.isArray(o)?o.map(vx):vx(o)):o}),us.apply(void 0,[i.replace(/%[%Oo]/g,function(o){return o==="%%"?"%":o==="%o"||o==="%O"?"%s":o})].concat(ra(e))))},VK=1,xx=function(i,e,o){var c=mx(i);return c.enabled=!0,c.log=o,c.useColors=!1,function(_){for(var $=arguments.length,_t=Array(1<$?$-1:0),ga=1;ga<$;ga++)_t[ga-1]=arguments[ga];if(e.enableLogUpload){$=Sj(_);var _s=wx($,_t);sx.upload({log_item_id:"".concat(VK++),log_level:i,payload_str:"[".concat(MK(),"] ").concat(i," - ").concat(256<_s.length?_s.slice(0,256):_s)})}switch($=function(_c){var _l=_s||wx(Sj(_),_t),Tl=Yd.LOG_HANDLER;typeof Tl=="function"&&Tl({level:_c,message:_l}),c(_l)},i){case"RTM:INFO":e.logFilter.info&&$("log");break;case"RTM:WARN":e.logFilter.warn&&$("warning");break;case"RTM:ERROR":e.logFilter.error&&$("error");break;case"RTM:TRACK":e.logFilter.track&&$("log");break;case"RTM:MSG:RECV":case"RTM:MSG:SEND":e.logFilter.debug&&$("debug");break;case"RTM:DEBUG":e.logFilter.debug&&$("debug")}}},qp,yx=function(i){return function(e){var o=qp===1||i===void 0?"":"Ins#".concat(i," ");return"".concat(o).concat(e)}},rp=function(i,e,o){var c=yx(qp);return xx("RTM:".concat(e),o,function(_){return i(c(_))})},Dd=function(){return function(i){function e(c,_){var $=2<arguments.length&&arguments[2]!==void 0&&arguments[2];ab(this,e);var _t=o.call(this);if(E(L(_t),"logError",void 0),E(L(_t),"invokeTracker",void 0),E(L(_t),"resultTracker",void 0),E(L(_t),"errorTracker",void 0),E(L(_t),"eventTracker",void 0),E(L(_t),"info",void 0),E(L(_t),"warn",void 0),E(L(_t),"log",void 0),E(L(_t),"genLogger",void 0),E(L(_t),"loggerId",void 0),E(L(_t),"logger",void 0),E(L(_t),"name",void 0),_t.logger=c,_t.name=_,_t.loggerId=c.loggerId,_t.info=c.info,_t.warn=c.warn,_t.logError=c.logError,_t.genLogger=c.genLogger,_t.log=c.genLogger("RTM:DEBUG","<".concat(_,"> ")),_t.invokeTracker=c.genTracker("Invoke"),_t.eventTracker=c.genTracker("Event"),_t.resultTracker=c.genTracker("Result"),_t.errorTracker=c.genTracker("Error"),$){var ga=_t.emit.bind(L(_t));_t.emit=function(){for(var _s=arguments.length,_c=Array(_s),_l=0;_l<_s;_l++)_c[_l]=arguments[_l];_s=_c[0],_l=_c.slice(1);var Tl=UK.includes(_s);_t.eventTracker.apply(_t,["%s: ".concat(0<_l.length?"%s emitted with args: ".concat(_l.map(function(){return"%o"})):"%s emitted"),_,_s].concat(ra(Tl?_l.map(fh):_l)));try{ga.apply(void 0,_c)}catch(Cl){_t.logError("Caught in the callback function of the event %s",_s,Cl)}}}return _t}nb(e,i);var o=ob(e);return e}(kb)},WK=function(i){return rp(console.log.bind(console),"INFO",i)},XK=function(i){return rp(console.warn.bind(console),"WARN",i)},YK=function(i){return rp(console.error.bind(console),"ERROR",i)},zx=function(i,e){return function(o){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"",_=yx(i),$=console.debug.bind(console),_t=xx(o,e,function(ga){return $(_(ga))});return function(ga){for(var _s=arguments.length,_c=Array(1<_s?_s-1:0),_l=1;_l<_s;_l++)_c[_l-1]=arguments[_l];return _t.apply(void 0,[c+ga].concat(_c))}}},ZK=function(i,e){return function(o){return zx(i,e)("RTM:TRACK","[".concat(o,"] "))}},Tm=Q.URI,wC=gl,$K=em(tK,["Wrapper"]),Cs=Oo($K,"URI"),Ax=function(i,e){var o=-1,c=i.length,_=c-1;for(e=e===void 0?c:e;++o<e;){var $=i[c=Uw(o,_)];i[c]=i[o],i[o]=$}return i.length=e,i},aL=function(i){return Ax(jm(i))},bL=function(i){return Ax(Vm(i))},Ih=function(i){return(lc(i)?aL:bL)(i)},Jh={0:9591,1:9593},xg=function(i){var e=ui(null);return"https://".concat(e?null:i,"/api/v1")},cL=Wb.apply(void 0,ra(Ih(["web-1.ap.sd-rtn.com","web-2.ap.sd-rtn.com"].map(xg)))),dL=Wb.apply(void 0,ra(Ih(["ap-web-1.agora.io","ap-web-2.agora.io"].map(xg)))),eL=Wb.apply(void 0,ra(Ih(["web-3.ap.sd-rtn.com","web-4.ap.sd-rtn.com"].map(xg)))),fL=Wb.apply(void 0,ra(Ih(["ap-web-3.agora.io","ap-web-4.agora.io"].map(xg)))),vc=ae.Writer,O=ae.util,bc=ae.roots.default||(ae.roots.default={}),gL=bc.Session=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.sid="",i.prototype.userId="",i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.elapse=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.appId="",i.prototype.ver="",i.prototype.buildno=0,i.prototype.installId="",i.prototype.os=0,i.prototype.did="",i.prototype.index=null,i.prototype.token="",i.prototype.version=0,i.prototype.subVersion=0,i.encode=function(e,o){return o||(o=vc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&o.uint32(32).int64(e.elapse),e.appId!=null&&Object.hasOwnProperty.call(e,"appId")&&o.uint32(42).string(e.appId),e.ver!=null&&Object.hasOwnProperty.call(e,"ver")&&o.uint32(50).string(e.ver),e.buildno!=null&&Object.hasOwnProperty.call(e,"buildno")&&o.uint32(56).int32(e.buildno),e.installId!=null&&Object.hasOwnProperty.call(e,"installId")&&o.uint32(66).string(e.installId),e.os!=null&&Object.hasOwnProperty.call(e,"os")&&o.uint32(128).int32(e.os),e.did!=null&&Object.hasOwnProperty.call(e,"did")&&o.uint32(138).string(e.did),e.index!=null&&Object.hasOwnProperty.call(e,"index")&&bc.Session.CommonIndex.encode(e.index,o.uint32(162).fork()).ldelim(),e.token!=null&&Object.hasOwnProperty.call(e,"token")&&o.uint32(170).string(e.token),e.version!=null&&Object.hasOwnProperty.call(e,"version")&&o.uint32(176).int32(e.version),e.subVersion!=null&&Object.hasOwnProperty.call(e,"subVersion")&&o.uint32(184).int32(e.subVersion),o},i.CommonIndex=function(){function e(o){if(o)for(var c=Object.keys(o),_=0;_<c.length;++_)o[c[_]]!=null&&(this[c[_]]=o[c[_]])}return e.prototype.index1="",e.prototype.index2="",e.prototype.index3="",e.encode=function(o,c){return c||(c=vc.create()),o.index1!=null&&Object.hasOwnProperty.call(o,"index1")&&c.uint32(10).string(o.index1),o.index2!=null&&Object.hasOwnProperty.call(o,"index2")&&c.uint32(18).string(o.index2),o.index3!=null&&Object.hasOwnProperty.call(o,"index3")&&c.uint32(26).string(o.index3),c},e}(),i}(),hL=bc.ApEvent=function(){function i(e){if(this.linkServerList=[],e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.sid="",i.prototype.userId="",i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.elapse=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.apAddr="",i.prototype.linkServerList=O.emptyArray,i.prototype.errCode=0,i.prototype.serverErrCode=0,i.prototype.isp="",i.prototype.opId=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.envId=0,i.prototype.flag=0,i.prototype.area="",i.encode=function(e,o){if(o||(o=vc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&o.uint32(32).int64(e.elapse),e.apAddr!=null&&Object.hasOwnProperty.call(e,"apAddr")&&o.uint32(50).string(e.apAddr),e.linkServerList!=null&&e.linkServerList.length)for(var c=0;c<e.linkServerList.length;++c)o.uint32(58).string(e.linkServerList[c]);return e.errCode!=null&&Object.hasOwnProperty.call(e,"errCode")&&o.uint32(72).int32(e.errCode),e.serverErrCode!=null&&Object.hasOwnProperty.call(e,"serverErrCode")&&o.uint32(80).int32(e.serverErrCode),e.isp!=null&&Object.hasOwnProperty.call(e,"isp")&&o.uint32(90).string(e.isp),e.opId!=null&&Object.hasOwnProperty.call(e,"opId")&&o.uint32(96).int64(e.opId),e.envId!=null&&Object.hasOwnProperty.call(e,"envId")&&o.uint32(104).int32(e.envId),e.flag!=null&&Object.hasOwnProperty.call(e,"flag")&&o.uint32(112).int32(e.flag),e.area!=null&&Object.hasOwnProperty.call(e,"area")&&o.uint32(122).string(e.area),o},i}(),iL=bc.ApRequest=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.sid="",i.prototype.userId="",i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.elapse=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.apAddr="",i.prototype.opId=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.envId=0,i.prototype.flag=0,i.encode=function(e,o){return o||(o=vc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&o.uint32(32).int64(e.elapse),e.apAddr!=null&&Object.hasOwnProperty.call(e,"apAddr")&&o.uint32(42).string(e.apAddr),e.opId!=null&&Object.hasOwnProperty.call(e,"opId")&&o.uint32(48).int64(e.opId),e.envId!=null&&Object.hasOwnProperty.call(e,"envId")&&o.uint32(56).int32(e.envId),e.flag!=null&&Object.hasOwnProperty.call(e,"flag")&&o.uint32(64).int32(e.flag),o},i}(),jL=bc.LinkLoginRequest=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.sid="",i.prototype.userId="",i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.elapse=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.destServerIp="",i.prototype.linkId=0,i.encode=function(e,o){return o||(o=vc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&o.uint32(32).int64(e.elapse),e.destServerIp!=null&&Object.hasOwnProperty.call(e,"destServerIp")&&o.uint32(42).string(e.destServerIp),e.linkId!=null&&Object.hasOwnProperty.call(e,"linkId")&&o.uint32(48).int32(e.linkId),o},i}(),kL=bc.Link=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.sid="",i.prototype.userId="",i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.elapse=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.ec=0,i.prototype.sc=0,i.prototype.destServerIp="",i.prototype.ackedServerIp="",i.prototype.responseTime=0,i.encode=function(e,o){return o||(o=vc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&o.uint32(32).int64(e.elapse),e.ec!=null&&Object.hasOwnProperty.call(e,"ec")&&o.uint32(40).int32(e.ec),e.sc!=null&&Object.hasOwnProperty.call(e,"sc")&&o.uint32(48).int32(e.sc),e.destServerIp!=null&&Object.hasOwnProperty.call(e,"destServerIp")&&o.uint32(58).string(e.destServerIp),e.ackedServerIp!=null&&Object.hasOwnProperty.call(e,"ackedServerIp")&&o.uint32(66).string(e.ackedServerIp),e.responseTime!=null&&Object.hasOwnProperty.call(e,"responseTime")&&o.uint32(72).int32(e.responseTime),o},i}(),lL=bc.Logout=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.sid="",i.prototype.userId="",i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.elapse=O.Long?O.Long.fromBits(0,0,!1):0,i.encode=function(e,o){return o||(o=vc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&o.uint32(32).int64(e.elapse),o},i}(),mL=bc.KickedOff=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.sid="",i.prototype.userId="",i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.elapse=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.linkId=0,i.prototype.code=0,i.prototype.server="",i.prototype.serverCode=0,i.encode=function(e,o){return o||(o=vc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&o.uint32(32).int64(e.elapse),e.linkId!=null&&Object.hasOwnProperty.call(e,"linkId")&&o.uint32(48).int32(e.linkId),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(56).int32(e.code),e.server!=null&&Object.hasOwnProperty.call(e,"server")&&o.uint32(66).string(e.server),e.serverCode!=null&&Object.hasOwnProperty.call(e,"serverCode")&&o.uint32(72).int32(e.serverCode),o},i}(),nL=bc.ChnJoin=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.sid="",i.prototype.userId="",i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.elapse=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.cname="",i.prototype.errCode=0,i.encode=function(e,o){return o||(o=vc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&o.uint32(32).int64(e.elapse),e.cname!=null&&Object.hasOwnProperty.call(e,"cname")&&o.uint32(50).string(e.cname),e.errCode!=null&&Object.hasOwnProperty.call(e,"errCode")&&o.uint32(56).int32(e.errCode),o},i}(),oL=bc.ChnJoinRes=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.sid="",i.prototype.userId="",i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.elapse=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.cname="",i.prototype.errCode=0,i.prototype.serverErrCode=0,i.encode=function(e,o){return o||(o=vc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&o.uint32(32).int64(e.elapse),e.cname!=null&&Object.hasOwnProperty.call(e,"cname")&&o.uint32(50).string(e.cname),e.errCode!=null&&Object.hasOwnProperty.call(e,"errCode")&&o.uint32(56).int32(e.errCode),e.serverErrCode!=null&&Object.hasOwnProperty.call(e,"serverErrCode")&&o.uint32(64).int32(e.serverErrCode),o},i}(),pL=bc.ChnLeave=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.sid="",i.prototype.userId="",i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.elapse=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.cname="",i.prototype.errCode=0,i.encode=function(e,o){return o||(o=vc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&o.uint32(32).int64(e.elapse),e.cname!=null&&Object.hasOwnProperty.call(e,"cname")&&o.uint32(50).string(e.cname),e.errCode!=null&&Object.hasOwnProperty.call(e,"errCode")&&o.uint32(56).int32(e.errCode),o},i}(),qL=bc.ConnectionStateChange=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.sid="",i.prototype.userId="",i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.elapse=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.oldState=0,i.prototype.newState=0,i.prototype.reason=0,i.prototype.reconnId=0,i.encode=function(e,o){return o||(o=vc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&o.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&o.uint32(32).int64(e.elapse),e.oldState!=null&&Object.hasOwnProperty.call(e,"oldState")&&o.uint32(40).int32(e.oldState),e.newState!=null&&Object.hasOwnProperty.call(e,"newState")&&o.uint32(48).int32(e.newState),e.reason!=null&&Object.hasOwnProperty.call(e,"reason")&&o.uint32(56).int32(e.reason),e.reconnId!=null&&Object.hasOwnProperty.call(e,"reconnId")&&o.uint32(64).int32(e.reconnId),o},i}(),Bx=bc.RtmSdkMessageCount=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.vid=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.sid="",i.prototype.messagecategory=0,i.prototype.reportsequence=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.sentcount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.receivedcount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack10mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack25mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack50mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack75mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack100mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack150mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack200mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack250mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack300mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack400mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack500mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack600mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack800mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack1000mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack2000mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack3000mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack5000mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerack7000mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.peerackslowcount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack10mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack25mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack50mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack75mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack100mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack150mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack200mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack250mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack300mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack400mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack500mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack600mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack800mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack1000mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack2000mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack3000mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack5000mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientack7000mscount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.norecipientackslowcount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.acktimeoutcount=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.apimajorversion=0,i.prototype.apiminorversion=0,i.prototype.os=0,i.prototype.toooftencount=0,i.prototype.receiverofflinecount=0,i.prototype.invalidmessagecount=0,i.prototype.unknowerrorcount=0,i.prototype.servercachedcount=0,i.prototype.timeoutcount=0,i.prototype.successcount=0,i.prototype.userid="",i.encode=function(e,o){return o||(o=vc.create()),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(8).int64(e.lts),e.vid!=null&&Object.hasOwnProperty.call(e,"vid")&&o.uint32(16).int64(e.vid),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(26).string(e.sid),e.messagecategory!=null&&Object.hasOwnProperty.call(e,"messagecategory")&&o.uint32(32).int32(e.messagecategory),e.reportsequence!=null&&Object.hasOwnProperty.call(e,"reportsequence")&&o.uint32(40).int64(e.reportsequence),e.sentcount!=null&&Object.hasOwnProperty.call(e,"sentcount")&&o.uint32(48).int64(e.sentcount),e.receivedcount!=null&&Object.hasOwnProperty.call(e,"receivedcount")&&o.uint32(56).int64(e.receivedcount),e.peerack10mscount!=null&&Object.hasOwnProperty.call(e,"peerack10mscount")&&o.uint32(64).int64(e.peerack10mscount),e.peerack25mscount!=null&&Object.hasOwnProperty.call(e,"peerack25mscount")&&o.uint32(72).int64(e.peerack25mscount),e.peerack50mscount!=null&&Object.hasOwnProperty.call(e,"peerack50mscount")&&o.uint32(80).int64(e.peerack50mscount),e.peerack75mscount!=null&&Object.hasOwnProperty.call(e,"peerack75mscount")&&o.uint32(88).int64(e.peerack75mscount),e.peerack100mscount!=null&&Object.hasOwnProperty.call(e,"peerack100mscount")&&o.uint32(96).int64(e.peerack100mscount),e.peerack150mscount!=null&&Object.hasOwnProperty.call(e,"peerack150mscount")&&o.uint32(104).int64(e.peerack150mscount),e.peerack200mscount!=null&&Object.hasOwnProperty.call(e,"peerack200mscount")&&o.uint32(112).int64(e.peerack200mscount),e.peerack250mscount!=null&&Object.hasOwnProperty.call(e,"peerack250mscount")&&o.uint32(120).int64(e.peerack250mscount),e.peerack300mscount!=null&&Object.hasOwnProperty.call(e,"peerack300mscount")&&o.uint32(128).int64(e.peerack300mscount),e.peerack400mscount!=null&&Object.hasOwnProperty.call(e,"peerack400mscount")&&o.uint32(136).int64(e.peerack400mscount),e.peerack500mscount!=null&&Object.hasOwnProperty.call(e,"peerack500mscount")&&o.uint32(144).int64(e.peerack500mscount),e.peerack600mscount!=null&&Object.hasOwnProperty.call(e,"peerack600mscount")&&o.uint32(152).int64(e.peerack600mscount),e.peerack800mscount!=null&&Object.hasOwnProperty.call(e,"peerack800mscount")&&o.uint32(160).int64(e.peerack800mscount),e.peerack1000mscount!=null&&Object.hasOwnProperty.call(e,"peerack1000mscount")&&o.uint32(168).int64(e.peerack1000mscount),e.peerack2000mscount!=null&&Object.hasOwnProperty.call(e,"peerack2000mscount")&&o.uint32(176).int64(e.peerack2000mscount),e.peerack3000mscount!=null&&Object.hasOwnProperty.call(e,"peerack3000mscount")&&o.uint32(184).int64(e.peerack3000mscount),e.peerack5000mscount!=null&&Object.hasOwnProperty.call(e,"peerack5000mscount")&&o.uint32(192).int64(e.peerack5000mscount),e.peerack7000mscount!=null&&Object.hasOwnProperty.call(e,"peerack7000mscount")&&o.uint32(200).int64(e.peerack7000mscount),e.peerackslowcount!=null&&Object.hasOwnProperty.call(e,"peerackslowcount")&&o.uint32(208).int64(e.peerackslowcount),e.norecipientack10mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack10mscount")&&o.uint32(216).int64(e.norecipientack10mscount),e.norecipientack25mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack25mscount")&&o.uint32(224).int64(e.norecipientack25mscount),e.norecipientack50mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack50mscount")&&o.uint32(232).int64(e.norecipientack50mscount),e.norecipientack75mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack75mscount")&&o.uint32(240).int64(e.norecipientack75mscount),e.norecipientack100mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack100mscount")&&o.uint32(248).int64(e.norecipientack100mscount),e.norecipientack150mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack150mscount")&&o.uint32(256).int64(e.norecipientack150mscount),e.norecipientack200mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack200mscount")&&o.uint32(264).int64(e.norecipientack200mscount),e.norecipientack250mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack250mscount")&&o.uint32(272).int64(e.norecipientack250mscount),e.norecipientack300mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack300mscount")&&o.uint32(280).int64(e.norecipientack300mscount),e.norecipientack400mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack400mscount")&&o.uint32(288).int64(e.norecipientack400mscount),e.norecipientack500mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack500mscount")&&o.uint32(296).int64(e.norecipientack500mscount),e.norecipientack600mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack600mscount")&&o.uint32(304).int64(e.norecipientack600mscount),e.norecipientack800mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack800mscount")&&o.uint32(312).int64(e.norecipientack800mscount),e.norecipientack1000mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack1000mscount")&&o.uint32(320).int64(e.norecipientack1000mscount),e.norecipientack2000mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack2000mscount")&&o.uint32(328).int64(e.norecipientack2000mscount),e.norecipientack3000mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack3000mscount")&&o.uint32(336).int64(e.norecipientack3000mscount),e.norecipientack5000mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack5000mscount")&&o.uint32(344).int64(e.norecipientack5000mscount),e.norecipientack7000mscount!=null&&Object.hasOwnProperty.call(e,"norecipientack7000mscount")&&o.uint32(352).int64(e.norecipientack7000mscount),e.norecipientackslowcount!=null&&Object.hasOwnProperty.call(e,"norecipientackslowcount")&&o.uint32(360).int64(e.norecipientackslowcount),e.acktimeoutcount!=null&&Object.hasOwnProperty.call(e,"acktimeoutcount")&&o.uint32(368).int64(e.acktimeoutcount),e.apimajorversion!=null&&Object.hasOwnProperty.call(e,"apimajorversion")&&o.uint32(376).int32(e.apimajorversion),e.apiminorversion!=null&&Object.hasOwnProperty.call(e,"apiminorversion")&&o.uint32(384).int32(e.apiminorversion),e.os!=null&&Object.hasOwnProperty.call(e,"os")&&o.uint32(392).int32(e.os),e.toooftencount!=null&&Object.hasOwnProperty.call(e,"toooftencount")&&o.uint32(400).int32(e.toooftencount),e.receiverofflinecount!=null&&Object.hasOwnProperty.call(e,"receiverofflinecount")&&o.uint32(408).int32(e.receiverofflinecount),e.invalidmessagecount!=null&&Object.hasOwnProperty.call(e,"invalidmessagecount")&&o.uint32(416).int32(e.invalidmessagecount),e.unknowerrorcount!=null&&Object.hasOwnProperty.call(e,"unknowerrorcount")&&o.uint32(424).int32(e.unknowerrorcount),e.servercachedcount!=null&&Object.hasOwnProperty.call(e,"servercachedcount")&&o.uint32(432).int32(e.servercachedcount),e.timeoutcount!=null&&Object.hasOwnProperty.call(e,"timeoutcount")&&o.uint32(440).int32(e.timeoutcount),e.successcount!=null&&Object.hasOwnProperty.call(e,"successcount")&&o.uint32(448).int32(e.successcount),e.userid!=null&&Object.hasOwnProperty.call(e,"userid")&&o.uint32(458).string(e.userid),o},i}(),rL=bc.SyncOperateEvent=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.userid="",i.prototype.vid=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.sid="",i.prototype.requestts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.replyts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.target="",i.prototype.eventtype="",i.prototype.revision=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.uuid="",i.prototype.sdktype=0,i.prototype.flags=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.code=0,i.prototype.seq=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.index=null,i.prototype.lock="",i.prototype.lockrev=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.subtarget="",i.prototype.usersid="",i.encode=function(e,o){return o||(o=vc.create()),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(8).int64(e.lts),e.userid!=null&&Object.hasOwnProperty.call(e,"userid")&&o.uint32(26).string(e.userid),e.vid!=null&&Object.hasOwnProperty.call(e,"vid")&&o.uint32(32).int64(e.vid),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(42).string(e.sid),e.requestts!=null&&Object.hasOwnProperty.call(e,"requestts")&&o.uint32(48).int64(e.requestts),e.replyts!=null&&Object.hasOwnProperty.call(e,"replyts")&&o.uint32(56).int64(e.replyts),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(66).string(e.target),e.eventtype!=null&&Object.hasOwnProperty.call(e,"eventtype")&&o.uint32(74).string(e.eventtype),e.revision!=null&&Object.hasOwnProperty.call(e,"revision")&&o.uint32(80).int64(e.revision),e.uuid!=null&&Object.hasOwnProperty.call(e,"uuid")&&o.uint32(90).string(e.uuid),e.sdktype!=null&&Object.hasOwnProperty.call(e,"sdktype")&&o.uint32(96).int32(e.sdktype),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(104).int64(e.flags),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(112).int32(e.code),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(120).int64(e.seq),e.index!=null&&Object.hasOwnProperty.call(e,"index")&&bc.CommonIndex.encode(e.index,o.uint32(130).fork()).ldelim(),e.lock!=null&&Object.hasOwnProperty.call(e,"lock")&&o.uint32(138).string(e.lock),e.lockrev!=null&&Object.hasOwnProperty.call(e,"lockrev")&&o.uint32(144).int64(e.lockrev),e.subtarget!=null&&Object.hasOwnProperty.call(e,"subtarget")&&o.uint32(154).string(e.subtarget),e.usersid!=null&&Object.hasOwnProperty.call(e,"usersid")&&o.uint32(162).string(e.usersid),o},i}(),sL=bc.SyncSubscribeEvent=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.userid="",i.prototype.vid=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.sid="",i.prototype.target="",i.prototype.eventtype="",i.prototype.sdktype=0,i.prototype.flags=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.code=0,i.prototype.seq=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.requestts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.replyts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.index=null,i.prototype.subtarget="",i.prototype.usersid="",i.encode=function(e,o){return o||(o=vc.create()),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(8).int64(e.lts),e.userid!=null&&Object.hasOwnProperty.call(e,"userid")&&o.uint32(26).string(e.userid),e.vid!=null&&Object.hasOwnProperty.call(e,"vid")&&o.uint32(32).int64(e.vid),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(42).string(e.sid),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(66).string(e.target),e.eventtype!=null&&Object.hasOwnProperty.call(e,"eventtype")&&o.uint32(74).string(e.eventtype),e.sdktype!=null&&Object.hasOwnProperty.call(e,"sdktype")&&o.uint32(96).int32(e.sdktype),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(104).int64(e.flags),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(112).int32(e.code),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&o.uint32(120).int64(e.seq),e.requestts!=null&&Object.hasOwnProperty.call(e,"requestts")&&o.uint32(128).int64(e.requestts),e.replyts!=null&&Object.hasOwnProperty.call(e,"replyts")&&o.uint32(136).int64(e.replyts),e.index!=null&&Object.hasOwnProperty.call(e,"index")&&bc.CommonIndex.encode(e.index,o.uint32(146).fork()).ldelim(),e.subtarget!=null&&Object.hasOwnProperty.call(e,"subtarget")&&o.uint32(154).string(e.subtarget),e.usersid!=null&&Object.hasOwnProperty.call(e,"usersid")&&o.uint32(162).string(e.usersid),o},i}(),tL=bc.SyncUpdateEvent=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.lts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.userid="",i.prototype.vid=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.sid="",i.prototype.replyts=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.target="",i.prototype.eventtype="",i.prototype.revision=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.sdktype=0,i.prototype.flags=O.Long?O.Long.fromBits(0,0,!1):0,i.prototype.count=0,i.prototype.delta=0,i.prototype.code=0,i.prototype.index=null,i.prototype.subtarget="",i.encode=function(e,o){return o||(o=vc.create()),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&o.uint32(8).int64(e.lts),e.userid!=null&&Object.hasOwnProperty.call(e,"userid")&&o.uint32(26).string(e.userid),e.vid!=null&&Object.hasOwnProperty.call(e,"vid")&&o.uint32(32).int64(e.vid),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&o.uint32(42).string(e.sid),e.replyts!=null&&Object.hasOwnProperty.call(e,"replyts")&&o.uint32(56).int64(e.replyts),e.target!=null&&Object.hasOwnProperty.call(e,"target")&&o.uint32(66).string(e.target),e.eventtype!=null&&Object.hasOwnProperty.call(e,"eventtype")&&o.uint32(74).string(e.eventtype),e.revision!=null&&Object.hasOwnProperty.call(e,"revision")&&o.uint32(80).int64(e.revision),e.sdktype!=null&&Object.hasOwnProperty.call(e,"sdktype")&&o.uint32(96).int32(e.sdktype),e.flags!=null&&Object.hasOwnProperty.call(e,"flags")&&o.uint32(104).int64(e.flags),e.count!=null&&Object.hasOwnProperty.call(e,"count")&&o.uint32(112).int32(e.count),e.delta!=null&&Object.hasOwnProperty.call(e,"delta")&&o.uint32(120).int32(e.delta),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&o.uint32(128).int32(e.code),e.index!=null&&Object.hasOwnProperty.call(e,"index")&&bc.CommonIndex.encode(e.index,o.uint32(138).fork()).ldelim(),e.subtarget!=null&&Object.hasOwnProperty.call(e,"subtarget")&&o.uint32(162).string(e.subtarget),o},i}(),uL=bc.CommonIndex=function(){function i(e){if(e)for(var o=Object.keys(e),c=0;c<o.length;++c)e[o[c]]!=null&&(this[o[c]]=e[o[c]])}return i.prototype.index1="",i.prototype.index2="",i.prototype.index3="",i.encode=function(e,o){return o||(o=vc.create()),e.index1!=null&&Object.hasOwnProperty.call(e,"index1")&&o.uint32(10).string(e.index1),e.index2!=null&&Object.hasOwnProperty.call(e,"index2")&&o.uint32(18).string(e.index2),e.index3!=null&&Object.hasOwnProperty.call(e,"index3")&&o.uint32(26).string(e.index3),o},i}(),xC=Object.freeze({__proto__:null,Session:gL,ApEvent:hL,ApRequest:iL,LinkLoginRequest:jL,Link:kL,Logout:lL,KickedOff:mL,ChnJoin:nL,ChnJoinRes:oL,ChnLeave:pL,ConnectionStateChange:qL,RtmSdkMessageCount:Bx,SyncOperateEvent:rL,SyncSubscribeEvent:sL,SyncUpdateEvent:tL,CommonIndex:uL,default:bc}),yC=Object.freeze({__proto__:null,Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191,RtmSdkMessageCount:510,SyncOperateEvent:9654,SyncSubscribeEvent:9651,default:{Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191,RtmSdkMessageCount:510,SyncOperateEvent:9654,SyncSubscribeEvent:9651}}),Cx=il(),sp=function(i){function e(c,_,$,_t,ga,_s){var _c,_l;ab(this,e);var Tl=o.call(this,ga,Pm("Socket-",ga.loggerId));if(E(L(Tl),"isActiveClose",!1),E(L(Tl),"loggedIn",!1),E(L(Tl),"useNewDomain",void 0),E(L(Tl),"receivedPacket",new ec),E(L(Tl),"open$",void 0),E(L(Tl),"input$",new ec),E(L(Tl),"userJoin$",new ec),E(L(Tl),"attemptsSinceLastError",0),E(L(Tl),"message$",new ec),E(L(Tl),"socket$",void 0),E(L(Tl),"toClose",new ec),E(L(Tl),"toReconnect",new ec),E(L(Tl),"sendLogger",void 0),E(L(Tl),"receiveLogger",void 0),E(L(Tl),"ip",void 0),E(L(Tl),"env",void 0),E(L(Tl),"ticket",void 0),E(L(Tl),"context",void 0),E(L(Tl),"getDomain",function(){return Ds(Tl.ip,Tl.useNewDomain)}),E(L(Tl),"socketReconnector",function(Dl){var Jl=function(zl){return Tl.attemptsSinceLastError+=1,Tl.warn("The %s of Env %d reconnecting %s",Tl.name,Tl.env,zl.message),Fe(3e3)};return Dl.pipe(Rb(function(zl){return Tl.log("socket connection closed"),Tl.loggedIn=!1,2<=Tl.attemptsSinceLastError?(Tl.warn("socket connection failure"),Tl.emit("connectionFailure"),Tl.close(),Va(zl)):Tl.isActiveClose?$c:(Tl.emit("reconnect"),Tl.useNewDomain=!Tl.useNewDomain,Va(zl))}),Zg(function(zl){return zl.pipe(Cc(Jl))}))}),Tl.ip=c,Tl.env=_,Tl.ticket=$,Tl.context=_t,Tl.useNewDomain=_s??.5<=Math.random(),Tl.sendLogger=Tl.genLogger("RTM:MSG:SEND"),Tl.receiveLogger=Tl.genLogger("RTM:MSG:RECV"),_!==0&&_!==1)throw new Cx({ILLEGAL_RTM_ENV:"The env number is out of rtm env count"});var Cl=Jh[_];Tl.log("Opening websocket address %s for the Env %d",Tl.ip,Tl.env),$a("LinkLoginRequest",{sid:Tl.context.sid,userId:Tl.context.uid,lts:D.fromNumber(Date.now()),elapse:Nb(Tl.context.startTime),destServerIp:Tl.ip,linkId:Tl.env},(_c=Tl.context.config.enableCloudProxy||Tl.context.socketUseProxy)!==null&&_c!==void 0&&_c),$a("LinkLoginRequest",{sid:Tl.context.sid,userId:Tl.context.uid,lts:D.fromNumber(Date.now()),elapse:Nb(Tl.context.startTime),destServerIp:Tl.ip,linkId:Tl.env},(_l=Tl.context.config.enableCloudProxy||Tl.context.socketUseProxy)!==null&&_l!==void 0&&_l);var Pl=Nc(Tl.input$,Tl.userJoin$.pipe(kC(2)),Tl.message$).pipe(Wa(function(Dl){return gl.encode(Dl).finish()}));return c=Nc(lC("",{protocols:[],makeWebSocket:function(){if(Tl.context.config.enableCloudProxy||Tl.context.socketUseProxy){if(Tl.context.cloudProxyServers.length===0)throw Tl.logError("No cloud proxy server to connect"),new Pa;var Dl=ui(null)?JSON.parse(null.replace(/-/g,".")):Tl.context.cloudProxyServers;Dl=dh(Dl="wss://".concat(Ds(Es(Dl),!1),"/"),"sid",Tl.context.sid),Dl=dh(Dl,"remote_port",Cl.toString()),Dl=dh(Dl,"remote_ip",Tl.ip),Dl=dh(Dl,"token",Tl.context.key),Dl=new WebSocket(Dl)}else Dl=new WebSocket("wss://".concat(Tl.getDomain(),":").concat(Cl));return Dl.binaryType="arraybuffer",Dl}}),Tl.toReconnect),Tl.socket$=bb(c,ap.pipe(Oc(7e3),Rb(function(Dl){return uc(Dl)&&Tl.warn("socket open timed out"),Va(Dl)}))).pipe(Wa(function(Dl){if(Dl instanceof Error)throw Tl.warn("Env_%d: Force reconnect the socket",Tl.env),Dl;return Dl(Pl).pipe(Wa(function(Jl){return gl.decode(new Uint8Array(Jl))}))}),Tl.socketReconnector),Tl.open$=Tl.socket$.pipe(Ka(function(Dl){Tl.log("Websocket opened",Tl.name),Dl.subscribe(function(Jl){var zl=Jl.data;Jl=Tm[Jl.uri].slice(0,-3),zl=Cs[Jl].decode(zl);var Bl=UI({},Oo(zl,"toJSON"),function(Up,Kp){return Kp instanceof D?rs(Kp):Kp}),Vl=!1;if((zl instanceof bx||zl instanceof ax)&&zl.instance.lessThanOrEqual(4294967295)&&(Vl=!0),zl instanceof cx||zl instanceof dx){var _d=zl.instance,Sp=zl.sequence;(zl.dialogue.lessThanOrEqual(4294967295)||_d.lessThanOrEqual(4294967295)||Sp.lessThan(1))&&(Vl=!0)}Vl?Tl.warn("Env_%d: Illegal %s, abandoned %o",Tl.env,Jl,Bl):(Jl!=="Pong"&&Tl.receiveLogger("Env_%d: %s %o",Tl.env,Jl,Bl),Tl.receivedPacket.next([Jl,zl]))},function(){})}),ni(void 0),he(Tl.toClose),$g()),Tl}nb(e,i);var o=ob(e);return Qb(e,[{key:"address",get:function(){return"".concat(this.ip,":").concat(Jh[this.env])}},{key:"sendPacket",value:function(c,_){if(c!=="Ping"){var $=Pe(_,function(_t){return _t instanceof D?rs(_t):_t});this.sendLogger("Env_%d: %s %o",this.env,c,$)}_=vC(c,_),c==="UserJoin"?this.userJoin$.next(_):c==="Message"?this.message$.next(_):this.input$.next(_)}},{key:"close",value:function(){this.isActiveClose=!0,this.loggedIn=!1,this.toClose.next()}},{key:"fromReceived",value:function(c){return this.receivedPacket.pipe(sc(function(_){return Lb(_,1)[0]===c}),Wa(function(_){return Lb(_,2)[1]}))}},{key:"forceReconnect",value:function(){this.toReconnect.next(new Cx({FORCE_RECONNECTING:"Connection seems broken, try force reconnecting"}))}}]),e}(Dd());wa({target:"String",proto:!0,forced:fx},{padStart:function(i){return vK(this,i,1<arguments.length?arguments[1]:void 0)}});var vL=function(i){var e=vi(Yj);i=qC(i);for(var o=0;o<e.length;o++){var c=Yj[e[o]];if(c!=null&&c.AP_DOMAINS.includes(i)||c!=null&&c.AP_BACKUP_DOMAINS.includes(i)||c!=null&&c.PROXY_AP.includes(i))return[c.CODE]}return[oa.CHINA,oa.GLOBAL]},wL={INVALID_APP_ID:"Illegal App ID",NO_AUTHORIZED:"Signature verification failed",TOKEN_TIMEOUT:"Dynamic key expired",INVALID_TOKEN_UID:"UID in the security key(token) is not valid",APP_ID_NO_ACTIVATED:"The vendor is not activated",DYNAMIC_KEY_NOT_ENABLED:"The vendor did not enable the dynamic key, but uses the dynamic key",DYNAMIC_ENABLED_BUT_STATIC_KEY:"The vendor enabled the dynamic key, but uses the static key",TOKEN_EXPIRED:"The token has expired",INVALID_USER_ID:"The user ID to login does not match the token",FORBIDDEN_REGION:"Forbidden to access the request in this area",CANNOT_MEET_AREA_DEMAND:"Cannot allocate to meet the requirements of the given area limit"},Dx={5:"INVALID_APP_ID",7:"INVALID_USER_ID",9:"NO_AUTHORIZED",10:"TOKEN_TIMEOUT",11:"APP_ID_NO_ACTIVATED",12:"INVALID_TOKEN_UID",13:"TOKEN_EXPIRED",14:"DYNAMIC_KEY_NOT_ENABLED",15:"DYNAMIC_ENABLED_BUT_STATIC_KEY",18:"FORBIDDEN_REGION",19:"CANNOT_MEET_AREA_DEMAND"},xL=[100,101,102],jl=/web-(\d)/,Ex=function(i){function e(c,_){var $=2<arguments.length&&arguments[2]!==void 0&&arguments[2];ab(this,e);var _t=o.call(this,_,"AccessPoint");return E(L(_t),"handleUniLbsError",function(ga,_s){var _c=ga;if(4<ga.toString().length){var _l=ga.toString().padStart(8,"0"),Tl=parseInt(_l.slice(0,4),10);if(_l=parseInt(_l.slice(4,8),10),Tl===201)_c=_l;else if(Tl===101&&!xL.includes(_l))return Va(Error("service is currently unavailable"))}if(Tl=_c.toString(),!Object.keys(Dx).includes(Tl))return(ga=new Pa(["Login is rejected by the server. The response code is %d",ga],ij)).serverCode=_c,Va(ga);switch(Tl=Dx[Tl],_c=wL[Tl],Tl){case"INVALID_APP_ID":case"APP_ID_NO_ACTIVATED":return(_s=new Gh(_c,Fw)).serverCode=ga,Va(_s);case"INVALID_USER_ID":return(_s=new Gh(_c,al)).serverCode=ga,Va(_s);case"TOKEN_EXPIRED":case"TOKEN_TIMEOUT":return(_s=new Gh(_c,bl)).serverCode=ga,Va(_s);case"NO_AUTHORIZED":case"INVALID_TOKEN_UID":case"DYNAMIC_KEY_NOT_ENABLED":case"DYNAMIC_ENABLED_BUT_STATIC_KEY":return(_s=new Gh(_c,Gw)).serverCode=ga,Va(_s);case"CANNOT_MEET_AREA_DEMAND":return(_s=vL(_s)).forEach(function(Cl){return _t.failedAreas.add(Cl)}),_t.failedAreas.size===(Ba===void 0?2:Ba.CODES.size)?((_s=new ja(_c,ij)).serverCode=ga,Va(_s)):Va(Error("ap ".concat(_s.join(", ")," cannot meet requirement")));case"FORBIDDEN_REGION":return(_s=new Pa(_c,ij)).serverCode=ga,Va(_s);default:return Va(ps("ApResErrType",Tl))}}),E(L(_t),"getApEdgeInfo$",void 0),E(L(_t),"getApEdgeInfoEndFirst$",void 0),E(L(_t),"apFinish$",new ec),E(L(_t),"retryCount",0),E(L(_t),"failedAreas",new Set),E(L(_t),"usedUrl",[]),E(L(_t),"newDomainUsed",!1),E(L(_t),"backupNewDomainUsed",!1),E(L(_t),"genUrl",function(){return Ba===void 0?zm.apply(void 0,ra(Ih([cL,dL]))).pipe(Am(function(ga){return Wb.apply(void 0,ra(ga))})):Wb.apply(void 0,ra(Ba.AP_DOMAINS.slice(0,3).map(xg)))}),E(L(_t),"genBackupUrl",function(){return Ba===void 0?zm.apply(void 0,ra(Ih([eL,fL]))).pipe(Am(function(ga){return Wb.apply(void 0,ra(ga))})):Wb.apply(void 0,ra(Ba.AP_BACKUP_DOMAINS.slice(0,3).map(xg)))}),E(L(_t),"getApUrl$",function(ga){var _s,_c;return _t.genUrl().pipe(sc(function(_l){return(!_t.newDomainUsed||!_l.includes("sd-rtn.com"))&&(_l.includes("sd-rtn.com")&&(_t.newDomainUsed=!0),!mp(_t.usedUrl,function(Tl){var Cl;return Tl===((Cl=_l.match(jl))===null||Cl===void 0?void 0:Cl[1])}))}),Ka(function(_l){var Tl;Ba===void 0&&typeof(_l=(Tl=_l.match(jl))===null||Tl===void 0?void 0:Tl[1])=="string"&&_t.usedUrl.push(_l)}),Xb(ga?Math.max(Yd.RECONNECTING_AP_NUM,(_s=Ba==null?void 0:Ba.CODES.size)!==null&&_s!==void 0?_s:0):(_c=Ba==null?void 0:Ba.CODES.size)!==null&&_c!==void 0?_c:2),Zf(function(){return e.runOutOfUrlSymbol}),Rb(function(_l,Tl){return _t.newDomainUsed=!1,_l===e.runOutOfUrlSymbol?(_t.usedUrl=[],Tl):Va(_l)}))}),E(L(_t),"getBackupApUrl$",function(ga){var _s,_c;return _t.genBackupUrl().pipe(sc(function(_l){return(!_t.backupNewDomainUsed||!_l.includes("sd-rtn.com"))&&(_l.includes("sd-rtn.com")&&(_t.backupNewDomainUsed=!0),!mp(_t.usedUrl,function(Tl){var Cl;return Tl===((Cl=_l.match(jl))===null||Cl===void 0?void 0:Cl[1])}))}),Ka(function(_l){var Tl;Ba===void 0&&typeof(_l=(Tl=_l.match(jl))===null||Tl===void 0?void 0:Tl[1])=="string"&&_t.usedUrl.push(_l)}),Xb(ga?Math.max(Yd.RECONNECTING_AP_NUM,(_s=Ba==null?void 0:Ba.CODES.size)!==null&&_s!==void 0?_s:0):(_c=Ba==null?void 0:Ba.CODES.size)!==null&&_c!==void 0?_c:2),Zf(function(){return e.runOutOfUrlSymbol}),Rb(function(_l,Tl){return _t.backupNewDomainUsed=!1,_l===e.runOutOfUrlSymbol?(_t.usedUrl=[],Tl):Va(_l)}))}),E(L(_t),"getProxyApUrl$",function(ga){var _s,_c;return Wb.apply(void 0,ra(((Ba==null?void 0:Ba.PROXY_AP.slice(0,3))||["ap-proxy-1.agora.io","ap-proxy-2.agora.io"]).map(xg))).pipe(Xb(ga?Math.max(Yd.RECONNECTING_AP_NUM,(_s=Ba==null?void 0:Ba.CODES.size)!==null&&_s!==void 0?_s:0):(_c=Ba==null?void 0:Ba.CODES.size)!==null&&_c!==void 0?_c:2))}),E(L(_t),"context",void 0),E(L(_t),"fetchCloudProxy",function(ga,_s){var _c=Pm("AP-",_t.loggerId);_t.log("The AccessPoint requests %s(%s)",ga,_c);var _l,Tl=new AbortController;return _t.apFinish$.pipe(Xb(1)).subscribe(function(){return Tl.abort()}),lf(za(W.mark(function Cl(){var Pl,Dl;return W.wrap(function(Jl){for(;;)switch(Jl.prev=Jl.next){case 0:return Dl=Qj(0,Number.MAX_SAFE_INTEGER),_t.log("%s request opid: %d",_c,Dl),$a("ApRequest",{sid:_t.context.sid,userId:_t.context.uid,lts:D.fromNumber(Date.now()),elapse:Nb(_t.context.startTime),apAddr:ga,opId:D.fromNumber(Dl),envId:0,flag:128},(Pl=_t.context.config.enableCloudProxy)!==null&&Pl!==void 0&&Pl),Jl.abrupt("return",Tj(ga,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"90","Content-Type":"application/json"},body:{sid:_t.context.sid,opid:Dl,appid:_t.context.appId,client_ts:Math.ceil(Date.now()/1e3),request_bodies:[{uri:22,buffer:{service_ids:[7,16],key:_s??_t.context.key,cname:_t.context.uid,uid:0,detail:tb({},Ba===void 0?{11:[oa.CHINA,oa.GLOBAL].join(),12:"1"}:{11:Array.from(Ba.CODES).map(function(zl){return zl===oa.OVERSEA?"".concat(oa.ASIA,",").concat(oa.EUROPE,",").concat(oa.AFRICA,",").concat(oa.NORTH_AMERICA,",").concat(oa.SOUTH_AMERICA,",").concat(oa.OCEANIA):zl}).join(","),12:"1"})}}]},signal:Tl.signal}));case 4:case"end":return Jl.stop()}},Cl)}))).pipe(Rb(function(Cl){return Cl.name!=="AbortError"&&(_t.logError(Cl),_t.warn("The AP server %s request failure",ga,Cl)),$c}),Ac((_l=za(W.mark(function Cl(Pl){var Dl,Jl,zl,Bl,Vl,_d,Sp,Up,Kp,Hp,_m,I0,Cp,Jp,Zp,i0,Np,Dp,Qp;return W.wrap(function(n0){for(;;)switch(n0.prev=n0.next){case 0:if(Dl=Pl.responseText,Jl=JSON.parse(Dl),_t.log("The %s response is %o",_c,Jl),((zl=Jl.response_body)===void 0||zl.length===0||zl.some(function(Bp){var c0;return((c0=Bp.buffer)===null||c0===void 0?void 0:c0.code)===void 0||Bp.uri!==23}))&&Va(new Pa("cloud proxy response_body not valid",ij)),(Bl=zl.filter(function(Bp){return Bp.buffer.code!==0})).length===0){n0.next=14;break}if((Vl=Bl.find(function(Bp){return Bp.buffer.flag===128}))===void 0){n0.next=12;break}return n0.abrupt("return",_t.handleUniLbsError(Vl.buffer.code,ga));case 12:return _t.logError("cloud proxy error response"),n0.abrupt("return",_t.handleUniLbsError(Bl[0].buffer.code,ga));case 14:for(_d=[],Sp=0;Sp<zl.length;Sp++)if(((Hp=zl[Sp])==null||(Up=Hp.buffer)===null||Up===void 0?void 0:Up.flag)===262144)(_m=Hp.buffer)===null||_m===void 0||(I0=_m.edges_services)===null||I0===void 0||(Cp=I0.forEach)===null||Cp===void 0||Cp.call(I0,function(Bp){ns(Bp=Bp.ip)&&_t.context.cloudProxyServers.indexOf(Bp)===-1&&(_t.log("got cloud proxy server: %s",Bp),_t.context.cloudProxyServers.push(Bp))});else if((Hp==null||(Kp=Hp.buffer)===null||Kp===void 0?void 0:Kp.flag)===128){for(Np=function(Bp,c0){var _f=c0[Bp];_d.some(function(O0){return O0.ip===_f.ip})||_d.push({ip:_f.ip,ticket:Hp.buffer.cert})},Dp=0,Qp=Hp.buffer.edges_services;Dp<Qp.length;Dp++)Np(Dp,Qp);_t.context.rtmArea=(Jp=(Zp=Hp.buffer)===null||Zp===void 0||(i0=Zp.detail)===null||i0===void 0?void 0:i0[9])!==null&&Jp!==void 0?Jp:""}return n0.abrupt("return",Wb.apply(void 0,ra(_d).concat([fj])));case 19:case"end":return n0.stop()}},Cl)})),function(Cl){return _l.apply(this,arguments)})),Rb(function(Cl){return Sa(Cl)?Va(Cl):$c}),Ij(),sc(function(Cl){return Cl!==void 0&&typeof Cl.ip=="string"&&typeof Cl.ticket=="string"&&ns(Cl.ip)}))}),E(L(_t),"fetchAp",function(ga,_s){var _c=Pm("AP-",_t.loggerId);_t.log("The AccessPoint requests %s(%s)",ga,_c);var _l=new AbortController;_t.apFinish$.pipe(Xb(1)).subscribe(function(){return _l.abort()});var Tl,Cl=Qj(0,Number.MAX_SAFE_INTEGER);return lf(za(W.mark(function Pl(){var Dl;return W.wrap(function(Jl){for(;;)switch(Jl.prev=Jl.next){case 0:return _t.log("%s request opid: %d",_c,Cl),$a("ApRequest",{sid:_t.context.sid,userId:_t.context.uid,lts:D.fromNumber(Date.now()),elapse:Nb(_t.context.startTime),apAddr:ga,opId:D.fromNumber(Cl),envId:0,flag:128},(Dl=_t.context.config.enableCloudProxy)!==null&&Dl!==void 0&&Dl),Jl.abrupt("return",Tj(ga,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"69","Content-Type":"application/json"},body:{flag:128,opid:Cl,key:_s||_t.context.key,cname:_t.context.uid,detail:tb({},Ba===void 0?{11:[oa.CHINA,oa.GLOBAL].join(),12:"1"}:{11:Array.from(Ba.CODES).map(function(zl){return zl===oa.OVERSEA?"".concat(oa.ASIA,",").concat(oa.EUROPE,",").concat(oa.AFRICA,",").concat(oa.NORTH_AMERICA,",").concat(oa.SOUTH_AMERICA,",").concat(oa.OCEANIA):zl}).join(","),12:"1"}),uid:0,sid:_t.context.sid},signal:_l.signal}));case 3:case"end":return Jl.stop()}},Pl)}))).pipe(Rb(function(Pl){return Pl.name!=="AbortError"&&(_t.logError(Pl),_t.warn("The AP server %s request failure",ga,Pl)),$c}),Ac((Tl=za(W.mark(function Pl(Dl){var Jl,zl,Bl,Vl,_d,Sp,Up,Kp,Hp,_m;return W.wrap(function(I0){for(;;)switch(I0.prev=I0.next){case 0:if(Bl=Dl.responseText,Vl=JSON.parse(Bl),_t.log("The %s response is %o",_c,Vl),Sp=(_d=Vl).code,Up=_d.addresses,Kp=_d.detail,_t.context.vid=(Jl=Kp[8])!==null&&Jl!==void 0?Jl:"",$a("ApEvent",{sid:_t.context.sid,userId:_t.context.uid,lts:D.fromNumber(Date.now()),elapse:Nb(_t.context.startTime),apAddr:ga,linkServerList:Up.map(function(Cp){return Cp.ip}),serverErrCode:Sp,flag:128,envId:0,opId:D.fromNumber(Cl),errCode:0,area:Kp[9],isp:Kp[2]},(zl=_t.context.config.enableCloudProxy)!==null&&zl!==void 0&&zl),_t.info(Vl),Sp===0){I0.next=9;break}return I0.abrupt("return",_t.handleUniLbsError(Sp,ga));case 9:if(Hp=Up,ui(null)&&(_m=JSON.parse(null.replace(/-/g,".")),Hp=_m.map(function(Cp){return{ip:Cp,ticket:Hp[0].ticket}})),Hp.length!==0){I0.next=14;break}return I0.abrupt("return",Va(Error("No available edge address to connect")));case 14:return _t.context.rtmArea=Kp==null?void 0:Kp[9],I0.abrupt("return",Wb.apply(void 0,ra(Hp).concat([fj])));case 16:case"end":return I0.stop()}},Pl)})),function(Pl){return Tl.apply(this,arguments)})),Ij(),Rb(function(Pl){return Sa(Pl)?Va(Pl):$c}),sc(function(Pl){return Pl!==void 0&&typeof Pl.ip=="string"&&typeof Pl.ticket=="string"}))}),_t.context=c,_t.getApEdgeInfoEndFirst$=function(){var ga=0<arguments.length&&arguments[0]!==void 0&&arguments[0];return Fe(0,ga||$?Yd.RECONNECTING_AP_INTERVAL:2e3).pipe(Xb(1),Ka(function(){_t.retryCount+=1}),Ac(function(){return _t.context.config.enableCloudProxy||_t.context.socketUseProxy?_t.getProxyApUrl$(ga||$):(4<=_t.retryCount&&(_t.retryCount=0),3>=_t.retryCount?_t.getApUrl$(ga||$):_t.getBackupApUrl$(ga||$))}),Ac(function(_s){return _t.context.config.enableCloudProxy||_t.context.socketUseProxy?_t.fetchCloudProxy(_s):_t.fetchAp(_s)}),Rb(function(_s){return _s instanceof ad&&_t.warn("AP request timeout"),Va(_s)}),Vr(function(_s){return _s.ip}),he(_t.apFinish$))},_t.getApEdgeInfo$=function(ga){return Fe(0,ga||$?Yd.RECONNECTING_AP_INTERVAL:2e3).pipe(Xb(8),Ka(function(){_t.retryCount+=1}),Ac(function(){return _t.context.config.enableCloudProxy||_t.context.socketUseProxy?_t.getProxyApUrl$(ga||$):3>=_t.retryCount?_t.getApUrl$(ga||$):_t.getBackupApUrl$(ga||$)}),Ac(function(_s){return(_t.context.config.enableCloudProxy||_t.context.socketUseProxy?_t.fetchCloudProxy(_s):_t.fetchAp(_s)).pipe()}),Rb(function(_s){return _s instanceof ad&&_t.warn("AP request timeout"),Va(_s)}),Vr(function(_s){return _s.ip}),he(_t.apFinish$))},_t}nb(e,i);var o=ob(e);return Qb(e,[{key:"clearUp",value:function(){this.failedAreas.clear(),this.retryCount=0}}]),e}(Dd());E(Ex,"runOutOfUrlSymbol",Symbol("AP urls are used up"));var Fx=il(),Gx=function(i){function e(c,_,$){ab(this,e);var _t=o.call(this,_,"Connection");E(L(_t),"apClient",void 0),E(L(_t),"lastOpenSockets",[new ah(1),new ah(1)]),E(L(_t),"curOpenSockets",[void 0,void 0]),E(L(_t),"ipIterator",0),E(L(_t),"loginSocketOpenFailureCount",0),E(L(_t),"firstEnv",.5<=Math.random()?1:0),E(L(_t),"firstSocketOpener",void 0),E(L(_t),"secondSocketOpener",void 0),E(L(_t),"firstOpenKeeperSubject",new ec),E(L(_t),"secondOpenKeeperSubject",new ec),E(L(_t),"blacklistedIP",{}),E(L(_t),"edgeInfoReplayed",void 0),E(L(_t),"firstEnvOpenSocket",void 0),E(L(_t),"firstOpenKeeperSub",void 0),E(L(_t),"secondOpenKeeperSub",void 0),E(L(_t),"context",void 0),E(L(_t),"logger",void 0),_t.context=c,_t.logger=_,_t.apClient=new Ex(_t.context,_),_t.apClient.apFinish$.subscribe(function(){_t.log("Ap client fetch finished")});var ga,_s=[];return _t.edgeInfoReplayed=_t.apClient.getApEdgeInfo$($).pipe(Zg(function(_c){return _c.pipe(Ka(function(_l){if(Sa(_l))throw _l}),mf($?wg.getParameter("RECONNECTING_AP_INTERVAL"):900),he(Fe(2e4)))}),sc(function(_c){var _l;return!mp(_s,_c)&&1>=((_l=_t.blacklistedIP[_c.ip])!==null&&_l!==void 0?_l:0)}),Zf(function(){return new Fx({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),Ka(function(_c){_s.push(_c),_t.log("An edge info got %o",_c)}),Ka({error:function(_c){_t.emit("connectionInitFailure",_c)}}),Mj(function(){_t.apClient.clearUp()}),Yr()),_t.firstEnvOpenSocket=_t.edgeInfoReplayed.pipe(Ac(function(_c){if(_c===void 0)return Va(Error("Invalid edge info"));var _l=new sp(_c.ip,_t.firstEnv,_c.ticket,_t.context,_,ga);if(_t.firstEnv=_t.firstEnv===1?0:1,_l.once("connectionFailure",function(){return _t.onSocketConnectionFailure(_l)}),!$&&Yd.ENABLE_EDGE_AUTO_FALLBACK&&!_t.context.config.enableCloudProxy){var Tl,Cl=Date.now();_l.on("reconnect",function(){var Pl;_t.loginSocketOpenFailureCount+=1,(Pl=Tl)!==null&&Pl!==void 0||(Tl=Date.now()-Cl),500>Tl&&1<_t.loginSocketOpenFailureCount&&(_t.context.socketUseProxy=!0)})}return ga=!_l.useNewDomain,_l.open$.pipe(ni(_l))}),Ka(function(_c){_t.log("The websocket of ENV_%d opened to %s:%d",_c.env,_c.ip,Jh[_c.env]),_t.curOpenSockets[_c.env]=_c,_t.lastOpenSockets[_c.env].next(_c),_t.firstEnv=_c.env,_t.openSecondSocket(_c.env,_c.ip,_c.useNewDomain)}),Xb(1),$g()),_t.firstSocketOpener=_t.firstEnvOpenSocket.pipe(Ac(function(_c){return _c.open$.pipe(Ka(function(){_t.log("The websocket of first ENV_%d re-opened to %s:%d",_c.env,_c.ip,Jh[_c.env]),_t.curOpenSockets[_c.env]=_c,_t.lastOpenSockets[_c.env].next(_c)}))})),c=_t.firstOpenKeeperSubject.pipe(Cc(jf)),_t.firstOpenKeeperSub=c.subscribe({error:_t.logError}),_t}nb(e,i);var o=ob(e);return Qb(e,[{key:"initConnection",value:function(){this.firstOpenKeeperSubject.next(this.firstSocketOpener)}},{key:"closeSocket",value:function(c,_){if(![0,1].includes(c))throw new rb({INVALID_ENV:"The env argument is not 0 or 1"});var $=c===this.firstEnv?this.firstOpenKeeperSub:this.secondOpenKeeperSub;this.firstOpenKeeperSub=void 0;var _t=this.curOpenSockets[c];this.curOpenSockets[c]=void 0,_t&&(_t.isActiveClose=!0,setTimeout(function(){_t.close()},_)),$!==void 0&&setTimeout(function(){$==null||$.unsubscribe()},_)}},{key:"waitClosing",value:function(c){var _=this;return c.isActiveClose=!0,c.open$.pipe(PB(),Rb(function($){return $.message===Tw.normalClosureMessage?$c:Va($)}),Oc(5e3),Rb(function($){return $ instanceof ad?(_.warn("Force closing the ENV_%d connection",c.env),$c):Va($)}))}},{key:"onSocketConnectionFailure",value:function(c){var _=[0,1].filter(function($){return $!==c.env})[0];(_=this.curOpenSockets[_])&&_.loggedIn?this.reopenSocketWithApRequest(c.env):this.emit("socketsFailure")}},{key:"openSecondSocket",value:function(c,_,$){var _t=this,ga=c===1?0:1;this.secondSocketOpener=this.edgeInfoReplayed.pipe(Xr(function(_s,_c){return[].concat(ra(_s),[_c])},[]),Wa(function(_s){return Rw(_s,function(_c){return qs(_,_c.ip)}).slice(-1)[0]}),Xb(1),Ac(function(_s){if(_s===void 0)return Va(Error("Invalid edge info"));var _c=new sp(_s.ip,ga,_s.ticket,_t.context,_t.logger,$);return _c.on("connectionFailure",function(){return _t.onSocketConnectionFailure(_c)}),_c.open$.pipe(Ka(function(){_t.lastOpenSockets[ga].next(_c),_t.curOpenSockets[ga]=_c}))}),$g()),this.secondOpenKeeperSub=this.secondOpenKeeperSubject.pipe(Cc(jf)).subscribe({error:this.logError}),this.secondOpenKeeperSubject.next(this.secondSocketOpener)}},{key:"reopenSocketWithApRequest",value:function(c){var _=this,$=[0,1].filter(function(_s){return _s!==c})[0];if(($=this.curOpenSockets[$])!==void 0){var _t,ga=$.ip;$=this.apClient.getApEdgeInfoEndFirst$(!0).pipe(Zf(function(){return new Fx({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),Zg(function(_s){return _s.pipe(Ka(function(_c){if(_c.code===bl)_.emit("tokenExpired"),_.apClient.apFinish$.next(void 0);else if(Sa(_c))throw _c}),mf(wg.getParameter("RECONNECTING_AP_INTERVAL")),he(Fe(15e3)))}),Ka(function(_s){_.log("An edge info got %o",_s)}),Mj(function(){_.apClient.clearUp()})).pipe(Xr(function(_s,_c){return[].concat(ra(_s),[_c])},[]),Wa(function(_s){return(_s=Rw(_s,function(_c){return qs(ga,_c.ip)})).length-1>=_.ipIterator?_s.slice(-_.ipIterator++-1)[0]:(_.ipIterator=0,_s.slice(-1)[0])}),Zf(),Ac(function(_s){if(_s===void 0)return Va(Error("Invalid edge info"));var _c=new sp(_s.ip,c,_s.ticket,_.context,_.logger,_t);return _c.on("connectionFailure",function(){return _.onSocketConnectionFailure(_c)}),_t=!_c.useNewDomain,_c.open$.pipe(ni(_c))}),Ka(function(_s){_.log("The websocket of ENV_%d re-opened to %s:%d using ap",_s.env,_s.ip,Jh[_s.env]),_.curOpenSockets[c]=_s,_.lastOpenSockets[c].next(_s)}),Ac(function(_s){return _s.open$.pipe(Ka(function(){_.log("The websocket of ENV_%d re-opened to %s:%d",_s.env,_s.ip,Jh[_s.env]),_.curOpenSockets[c]=_s,_.lastOpenSockets[c].next(_s)}))}),$g()),c===this.firstEnv?this.firstOpenKeeperSubject.next($):this.secondOpenKeeperSubject.next($)}}}]),e}(Dd()),yL=function(i){function e(c,_,$){return ab(this,e),E(L($=o.call(this,$,"Context")),"_token",void 0),E(L($),"config",void 0),E(L($),"_uid",void 0),E(L($),"_sid",void 0),E(L($),"_vid",void 0),E(L($),"_startTime",void 0),E(L($),"_lastModifyMeteDataTime",-1),E(L($),"_lastGetMetaDataTime",-1),E(L($),"_lastSubscribeMetaDataTime",-1),E(L($),"_area","CN"),E(L($),"_socketUseProxy",!1),E(L($),"appId",void 0),E(L($),"enableCloudProxy",!1),E(L($),"cloudProxyServers",[]),$.appId=c,$.config=_,$}nb(e,i);var o=ob(e);return Qb(e,[{key:"socketUseProxy",get:function(){return this._socketUseProxy&&Yd.ENABLE_EDGE_AUTO_FALLBACK},set:function(c){this.log("socketUseProxy is set to %s",c),this._socketUseProxy=c}},{key:"token",set:function(c){this._token=typeof c=="string"&&c?c:void 0}},{key:"uid",get:function(){if(typeof this._uid=="string"&&this._uid)return this._uid;throw new Ib("Cannot get illegal uid")},set:function(c){if(this.log("The user ID is set to %s",wb(c)),!yb(c))throw new Ib;this._uid=c}},{key:"vid",get:function(){if(typeof this._vid=="string")return this._vid;throw new Ib("Cannot get illegal vid")},set:function(c){if(typeof c!="string")throw new Ib;this._vid=c}},{key:"key",get:function(){if(typeof this._token=="string"&&this._token)return this._token;if(typeof this.appId=="string"&&this.appId)return this.appId;throw new Ib("Cannot get illegal key")}},{key:"sid",get:function(){if(typeof this._sid=="string"&&this._sid)return this._sid;throw new Ib("Cannot get illegal sid")},set:function(c){if(this.log("sid is set to %s",c),typeof c!="string"||!c)throw new Ib;this._sid=c}},{key:"startTime",get:function(){if(typeof this._startTime=="number"&&this._startTime)return this._startTime;throw new Ib("Cannot get illegal startTime")},set:function(c){if(this.log("startTime is set to %s",c),typeof c!="number"||!c)throw new Ib;this._startTime=c}},{key:"rtmArea",get:function(){if(typeof this._area=="string"&&this._area)return this._area;throw new Ib("Cannot get illegal area")},set:function(c){this.log("area is set to %s",c),typeof c=="string"&&c?this._area=c:this.warn("set area failed")}},{key:"lastModifyMeteDataTime",get:function(){if(typeof this._lastModifyMeteDataTime=="number"&&this._lastModifyMeteDataTime)return this._lastModifyMeteDataTime;throw new Ib("Cannot get illegal lastModifyMeteDataTime")},set:function(c){if(this.log("lastModifyMeteDataTime is set to %s",c),typeof c!="number"||!c)throw new Ib;this._lastModifyMeteDataTime=c}},{key:"lastGetMetaDataTime",get:function(){if(typeof this._lastGetMetaDataTime=="number"&&this._lastGetMetaDataTime)return this._lastGetMetaDataTime;throw new Ib("Cannot get illegal lastGetMetaDataTime")},set:function(c){if(this.log("lastGetMetaDataTime is set to %s",c),typeof c!="number"||!c)throw new Ib;this._lastGetMetaDataTime=c}},{key:"lastSubscribeMetaDataTime",get:function(){if(typeof this._lastSubscribeMetaDataTime=="number"&&this._lastSubscribeMetaDataTime)return this._lastSubscribeMetaDataTime;throw new Ib("Cannot get illegal lastSubscribeMetaDataTime")},set:function(c){if(this.log("lastSubscribeMetaDataTime is set to %s",c),typeof c!="number"||!c)throw new Ib;this._lastGetMetaDataTime=c}}]),e}(Dd());tu("of",function(){for(var i=0,e=arguments.length,o=new(wh(this))(e);e>i;)o[i]=arguments[i++];return o},Nn),wa({target:"Array",proto:!0,forced:Rn!==[].lastIndexOf},{lastIndexOf:Rn}),wa({target:"Array",proto:!0},{flatMap:function(i){var e=Zb(this),o=xb(e.length);Rc(i);var c=Ei(e,0);return c.length=px(c,e,e,o,0,1,i,1<arguments.length?arguments[1]:void 0),c}}),wf("flatMap");var zL=gg("reduceRight"),AL=!qe&&79<oe&&83>oe;wa({target:"Array",proto:!0,forced:!zL||AL},{reduceRight:function(i){return Cu(this,i,arguments.length,1<arguments.length?arguments[1]:void 0)}});var tp=function(i){return Ga(function(){return!!`	
\v\f\r \u2028\u2029\uFEFF`[i]()||""[i]()!=""||`	
\v\f\r \u2028\u2029\uFEFF`[i].name!==i})};wa({target:"String",proto:!0,forced:tp("trim")},{trim:function(){return kk(this)}});var Hx=tp("trimEnd"),Ix=Hx?function(){return lD(this)}:"".trimEnd;wa({target:"String",proto:!0,forced:Hx},{trimEnd:Ix,trimRight:Ix});var Jx=tp("trimStart"),Kx=Jx?function(){return kD(this)}:"".trimStart;wa({target:"String",proto:!0,forced:Jx},{trimStart:Kx,trimLeft:Kx});var Pd=kc(function(i,e){(function(){function o(Gp,r0,Ul){switch(Ul.length){case 0:return Gp.call(r0);case 1:return Gp.call(r0,Ul[0]);case 2:return Gp.call(r0,Ul[0],Ul[1]);case 3:return Gp.call(r0,Ul[0],Ul[1],Ul[2])}return Gp.apply(r0,Ul)}function c(Gp,r0,Ul,P0){for(var j0=-1,y0=Gp==null?0:Gp.length;++j0<y0;){var s1=Gp[j0];r0(P0,s1,Ul(s1),Gp)}return P0}function _(Gp,r0){for(var Ul=-1,P0=Gp==null?0:Gp.length;++Ul<P0&&r0(Gp[Ul],Ul,Gp)!==!1;);return Gp}function $(Gp,r0){for(var Ul=Gp==null?0:Gp.length;Ul--&&r0(Gp[Ul],Ul,Gp)!==!1;);return Gp}function _t(Gp,r0){for(var Ul=-1,P0=Gp==null?0:Gp.length;++Ul<P0;)if(!r0(Gp[Ul],Ul,Gp))return!1;return!0}function ga(Gp,r0){for(var Ul=-1,P0=Gp==null?0:Gp.length,j0=0,y0=[];++Ul<P0;){var s1=Gp[Ul];r0(s1,Ul,Gp)&&(y0[j0++]=s1)}return y0}function _s(Gp,r0){return!(Gp==null||!Gp.length)&&-1<Bl(Gp,r0,0)}function _c(Gp,r0,Ul){for(var P0=-1,j0=Gp==null?0:Gp.length;++P0<j0;)if(Ul(r0,Gp[P0]))return!0;return!1}function _l(Gp,r0){for(var Ul=-1,P0=Gp==null?0:Gp.length,j0=Array(P0);++Ul<P0;)j0[Ul]=r0(Gp[Ul],Ul,Gp);return j0}function Tl(Gp,r0){for(var Ul=-1,P0=r0.length,j0=Gp.length;++Ul<P0;)Gp[j0+Ul]=r0[Ul];return Gp}function Cl(Gp,r0,Ul,P0){var j0=-1,y0=Gp==null?0:Gp.length;for(P0&&y0&&(Ul=Gp[++j0]);++j0<y0;)Ul=r0(Ul,Gp[j0],j0,Gp);return Ul}function Pl(Gp,r0,Ul,P0){var j0=Gp==null?0:Gp.length;for(P0&&j0&&(Ul=Gp[--j0]);j0--;)Ul=r0(Ul,Gp[j0],j0,Gp);return Ul}function Dl(Gp,r0){for(var Ul=-1,P0=Gp==null?0:Gp.length;++Ul<P0;)if(r0(Gp[Ul],Ul,Gp))return!0;return!1}function Jl(Gp,r0,Ul){var P0;return Ul(Gp,function(j0,y0,s1){if(r0(j0,y0,s1))return P0=y0,!1}),P0}function zl(Gp,r0,Ul,P0){var j0=Gp.length;for(Ul+=P0?1:-1;P0?Ul--:++Ul<j0;)if(r0(Gp[Ul],Ul,Gp))return Ul;return-1}function Bl(Gp,r0,Ul){if(r0==r0)t:{--Ul;for(var P0=Gp.length;++Ul<P0;)if(Gp[Ul]===r0){Gp=Ul;break t}Gp=-1}else Gp=zl(Gp,_d,Ul);return Gp}function Vl(Gp,r0,Ul,P0){--Ul;for(var j0=Gp.length;++Ul<j0;)if(P0(Gp[Ul],r0))return Ul;return-1}function _d(Gp){return Gp!=Gp}function Sp(Gp,r0){var Ul=Gp==null?0:Gp.length;return Ul?_m(Gp,r0)/Ul:L1}function Up(Gp){return function(r0){return r0==null?yp:r0[Gp]}}function Kp(Gp){return function(r0){return Gp==null?yp:Gp[r0]}}function Hp(Gp,r0,Ul,P0,j0){return j0(Gp,function(y0,s1,by){Ul=P0?(P0=!1,y0):r0(Ul,y0,s1,by)}),Ul}function _m(Gp,r0){for(var Ul,P0=-1,j0=Gp.length;++P0<j0;){var y0=r0(Gp[P0]);y0!==yp&&(Ul=Ul===yp?y0:Ul+y0)}return Ul}function I0(Gp,r0){for(var Ul=-1,P0=Array(Gp);++Ul<Gp;)P0[Ul]=r0(Ul);return P0}function Cp(Gp){return Gp&&Gp.slice(0,__(Gp)+1).replace(vO,"")}function Jp(Gp){return function(r0){return Gp(r0)}}function Zp(Gp,r0){return _l(r0,function(Ul){return Gp[Ul]})}function i0(Gp,r0){return Gp.has(r0)}function Np(Gp,r0){for(var Ul=-1,P0=Gp.length;++Ul<P0&&-1<Bl(r0,Gp[Ul],0););return Ul}function Dp(Gp,r0){for(var Ul=Gp.length;Ul--&&-1<Bl(r0,Gp[Ul],0););return Ul}function Qp(Gp){return"\\"+y3[Gp]}function n0(Gp){var r0=-1,Ul=Array(Gp.size);return Gp.forEach(function(P0,j0){Ul[++r0]=[j0,P0]}),Ul}function Bp(Gp,r0){return function(Ul){return Gp(r0(Ul))}}function c0(Gp,r0){for(var Ul=-1,P0=Gp.length,j0=0,y0=[];++Ul<P0;){var s1=Gp[Ul];s1!==r0&&s1!=="__lodash_placeholder__"||(Gp[Ul]="__lodash_placeholder__",y0[j0++]=Ul)}return y0}function _f(Gp){var r0=-1,Ul=Array(Gp.size);return Gp.forEach(function(P0){Ul[++r0]=P0}),Ul}function O0(Gp){if(BS.test(Gp)){for(var r0=My.lastIndex=0;My.test(Gp);)++r0;Gp=r0}else Gp=IU(Gp);return Gp}function _0(Gp){return BS.test(Gp)?Gp.match(My)||[]:Gp.split("")}function __(Gp){for(var r0=Gp.length;r0--&&f3.test(Gp.charAt(r0)););return r0}var yp,dy=1/0,L1=NaN,o0=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],H0=/\b__p \+= '';/g,z_=/\b(__p \+=) '' \+/g,VS=/(__e\(.*?\)|\b__t\)) \+\n'';/g,iS=/&(?:amp|lt|gt|quot|#39);/g,gO=/[&<>"']/g,hy=RegExp(iS.source),IS=RegExp(gO.source),gN=/<%-([\s\S]+?)%>/g,mN=/<%([\s\S]+?)%>/g,h3=/<%=([\s\S]+?)%>/g,p3=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xy=/^\w*$/,sT=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,mO=/[\\^$.*+?()[\]{}|]/g,vN=RegExp(mO.source),vO=/^\s+/,f3=/\s/,g3=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,m3=/\{\n\/\* \[wrapped with (.+)\] \*/,BT=/,? & /,v3=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,fU=/[()=,{}\[\]\/\s]/,EN=/\\(\\)?/g,E3=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_3=/\w*$/,gU=/^[-+]0x[0-9a-f]+$/i,mU=/^0b[01]+$/i,vU=/^\[object .+?Constructor\]$/,EU=/^0o[0-7]+$/i,_N=/^(?:0|[1-9]\d*)$/,_U=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,aT=/($^)/,yU=/['\n\r\u2028\u2029\\]/g,bU=/['\u2019]/g,SU=/[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]/g,My=/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]?|[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,TU=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['\u2019](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,BS=/[\u200d\ud800-\udfff\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff\ufe0e\ufe0f]/,yN=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,bN="Array Buffer DataView Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Math Object Promise RegExp Set String Symbol TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap _ clearTimeout isFinite parseInt setTimeout".split(" "),SN=-1,F_={};F_["[object Float32Array]"]=F_["[object Float64Array]"]=F_["[object Int8Array]"]=F_["[object Int16Array]"]=F_["[object Int32Array]"]=F_["[object Uint8Array]"]=F_["[object Uint8ClampedArray]"]=F_["[object Uint16Array]"]=F_["[object Uint32Array]"]=!0,F_["[object Arguments]"]=F_["[object Array]"]=F_["[object ArrayBuffer]"]=F_["[object Boolean]"]=F_["[object DataView]"]=F_["[object Date]"]=F_["[object Error]"]=F_["[object Function]"]=F_["[object Map]"]=F_["[object Number]"]=F_["[object Object]"]=F_["[object RegExp]"]=F_["[object Set]"]=F_["[object String]"]=F_["[object WeakMap]"]=!1;var O_={};O_["[object Arguments]"]=O_["[object Array]"]=O_["[object ArrayBuffer]"]=O_["[object DataView]"]=O_["[object Boolean]"]=O_["[object Date]"]=O_["[object Float32Array]"]=O_["[object Float64Array]"]=O_["[object Int8Array]"]=O_["[object Int16Array]"]=O_["[object Int32Array]"]=O_["[object Map]"]=O_["[object Number]"]=O_["[object Object]"]=O_["[object RegExp]"]=O_["[object Set]"]=O_["[object String]"]=O_["[object Symbol]"]=O_["[object Uint8Array]"]=O_["[object Uint8ClampedArray]"]=O_["[object Uint16Array]"]=O_["[object Uint32Array]"]=!0,O_["[object Error]"]=O_["[object Function]"]=O_["[object WeakMap]"]=!1;var y3={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},RU=parseFloat,wU=parseInt,TN=Ia(qb)=="object"&&qb&&qb.Object===Object&&qb,RN=(typeof self>"u"?"undefined":Ia(self))=="object"&&self&&self.Object===Object&&self,v1=TN||RN||Function("return this")(),wN=e&&!e.nodeType&&e,cT=wN&&i&&!i.nodeType&&i,Uy=cT&&cT.exports===wN,IN=Uy&&TN.process,yy=function(){try{var Gp=cT&&cT.require&&cT.require("util").types;return Gp||IN&&IN.binding&&IN.binding("util")}catch{}}(),E1=yy&&yy.isArrayBuffer,b3=yy&&yy.isDate,S3=yy&&yy.isMap,T3=yy&&yy.isRegExp,R3=yy&&yy.isSet,EO=yy&&yy.isTypedArray,IU=Up("length"),OU=Kp({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),w3=Kp({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),CU=Kp({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),uT=function Gp(r0){function Ul(_i){if(e1(_i)&&!K0(_i)&&!(_i instanceof y0)){if(_i instanceof j0)return _i;if(y_.call(_i,"__wrapped__"))return BR(_i)}return new j0(_i)}function P0(){}function j0(_i,_u){this.__wrapped__=_i,this.__actions__=[],this.__chain__=!!_u,this.__index__=0,this.__values__=yp}function y0(_i){this.__wrapped__=_i,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function s1(_i){var _u=-1,Sl=_i==null?0:_i.length;for(this.clear();++_u<Sl;){var xl=_i[_u];this.set(xl[0],xl[1])}}function by(_i){var _u=-1,Sl=_i==null?0:_i.length;for(this.clear();++_u<Sl;){var xl=_i[_u];this.set(xl[0],xl[1])}}function oS(_i){var _u=-1,Sl=_i==null?0:_i.length;for(this.clear();++_u<Sl;){var xl=_i[_u];this.set(xl[0],xl[1])}}function lT(_i){var _u=-1,Sl=_i==null?0:_i.length;for(this.__data__=new oS;++_u<Sl;)this.add(_i[_u])}function jy(_i){this.size=(this.__data__=new by(_i)).size}function I3(_i,_u){var Sl,xl=K0(_i),Kl=!xl&&RT(_i),vp=!xl&&!Kl&&YS(_i),Op=!xl&&!Kl&&!vp&&dR(_i),xp=(Kl=(xl=xl||Kl||vp||Op)?I0(_i.length,tM):[]).length;for(Sl in _i)!_u&&!y_.call(_i,Sl)||xl&&(Sl=="length"||vp&&(Sl=="offset"||Sl=="parent")||Op&&(Sl=="buffer"||Sl=="byteLength"||Sl=="byteOffset")||NS(Sl,xp))||Kl.push(Sl);return Kl}function O3(_i){var _u=_i.length;return _u?_i[PR(0,_u-1)]:yp}function AU(_i,_u){return zO(Z1(_i),qS(_u,0,_i.length))}function NU(_i){return zO(Z1(_i))}function ON(_i,_u,Sl){(Sl===yp||ty(_i[_u],Sl))&&(Sl!==yp||_u in _i)||Fy(_i,_u,Sl)}function GS(_i,_u,Sl){var xl=_i[_u];y_.call(_i,_u)&&ty(xl,Sl)&&(Sl!==yp||_u in _i)||Fy(_i,_u,Sl)}function AR(_i,_u){for(var Sl=_i.length;Sl--;)if(ty(_i[Sl][0],_u))return Sl;return-1}function CN(_i,_u,Sl,xl){return zS(_i,function(Kl,vp,Op){_u(xl,Kl,Sl(Kl),Op)}),xl}function C3(_i,_u){return _i&&uS(_u,l1(_u),_i)}function Fy(_i,_u,Sl){_u=="__proto__"&&WR?WR(_i,_u,{configurable:!0,enumerable:!0,value:Sl,writable:!0}):_i[_u]=Sl}function AN(_i,_u){for(var Sl=-1,xl=_u.length,Kl=d1(xl),vp=_i==null;++Sl<xl;)Kl[Sl]=vp?yp:QN(_i,_u[Sl]);return Kl}function qS(_i,_u,Sl){return _i==_i&&(Sl!==yp&&(_i=_i<=Sl?_i:Sl),_u!==yp&&(_i=_i>=_u?_i:_u)),_i}function Sy(_i,_u,Sl,xl,Kl,vp){var Op,xp=1&_u,Mp=2&_u,$p=4&_u;if(Sl&&(Op=Kl?Sl(_i,xl,Kl,vp):Sl(_i)),Op!==yp)return Op;if(!V_(_i))return _i;if(xl=K0(_i)){if(Op=function(u0){var C0=u0.length,x0=new u0.constructor(C0);return C0&&typeof u0[0]=="string"&&y_.call(u0,"index")&&(x0.index=u0.index,x0.input=u0.input),x0}(_i),!xp)return Z1(_i,Op)}else{var t0=p1(_i),g0=t0=="[object Function]"||t0=="[object GeneratorFunction]";if(YS(_i))return V3(_i,xp);if(t0=="[object Object]"||t0=="[object Arguments]"||g0&&!Kl){if(Op=Mp||g0?{}:$3(_i),!xp)return Mp?function(u0,C0){return uS(u0,fM(u0),C0)}(_i,function(u0,C0){return u0&&uS(C0,ny(C0),u0)}(Op,_i)):function(u0,C0){return uS(u0,JR(u0),C0)}(_i,C3(Op,_i))}else{if(!O_[t0])return Kl?_i:{};Op=function(u0,C0,x0){var r_=u0.constructor;switch(C0){case"[object ArrayBuffer]":return BN(u0);case"[object Boolean]":case"[object Date]":return new r_(+u0);case"[object DataView]":return C0=x0?BN(u0.buffer):u0.buffer,new u0.constructor(C0,u0.byteOffset,u0.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return cS(u0,x0);case"[object Map]":return new r_;case"[object Number]":case"[object String]":return new r_(u0);case"[object RegExp]":return(C0=new u0.constructor(u0.source,_3.exec(u0))).lastIndex=u0.lastIndex,C0;case"[object Set]":return new r_;case"[object Symbol]":return yT?B_(yT.call(u0)):{}}}(_i,t0,xp)}}if(vp||(vp=new jy),Kl=vp.get(_i))return Kl;vp.set(_i,Op),IM(_i)?_i.forEach(function(u0){Op.add(Sy(u0,_u,Sl,u0,_i,vp))}):wM(_i)&&_i.forEach(function(u0,C0){Op.set(C0,Sy(u0,_u,Sl,C0,_i,vp))}),Mp=$p?Mp?GO:BO:Mp?ny:l1;var S0=xl?yp:Mp(_i);return _(S0||_i,function(u0,C0){S0&&(u0=_i[C0=u0]),GS(Op,C0,Sy(u0,_u,Sl,C0,_i,vp))}),Op}function A3(_i,_u,Sl){var xl=Sl.length;if(_i==null)return!xl;for(_i=B_(_i);xl--;){var Kl=Sl[xl],vp=_u[Kl],Op=_i[Kl];if(Op===yp&&!(Kl in _i)||!vp(Op))return!1}return!0}function N3(_i,_u,Sl){if(typeof _i!="function")throw new my("Expected a function");return bT(function(){_i.apply(yp,Sl)},_u)}function NR(_i,_u,Sl,xl){var Kl=-1,vp=_s,Op=!0,xp=_i.length,Mp=[],$p=_u.length;if(!xp)return Mp;Sl&&(_u=_l(_u,Jp(Sl))),xl?(vp=_c,Op=!1):200<=_u.length&&(vp=i0,Op=!1,_u=new lT(_u));t:for(;++Kl<xp;){var t0=_i[Kl],g0=Sl==null?t0:Sl(t0);if(t0=xl||t0!==0?t0:0,Op&&g0==g0){for(var S0=$p;S0--;)if(_u[S0]===g0)continue t;Mp.push(t0)}else vp(_u,g0,xl)||Mp.push(t0)}return Mp}function kU(_i,_u){var Sl=!0;return zS(_i,function(xl,Kl,vp){return Sl=!!_u(xl,Kl,vp)}),Sl}function _O(_i,_u,Sl){for(var xl=-1,Kl=_i.length;++xl<Kl;){var vp=_i[xl],Op=_u(vp);if(Op!=null&&(xp===yp?Op==Op&&!gy(Op):Sl(Op,xp)))var xp=Op,Mp=vp}return Mp}function k3(_i,_u){var Sl=[];return zS(_i,function(xl,Kl,vp){_u(xl,Kl,vp)&&Sl.push(xl)}),Sl}function P1(_i,_u,Sl,xl,Kl){var vp=-1,Op=_i.length;for(Sl||(Sl=UU),Kl||(Kl=[]);++vp<Op;){var xp=_i[vp];0<_u&&Sl(xp)?1<_u?P1(xp,_u-1,Sl,xl,Kl):Tl(Kl,xp):xl||(Kl[Kl.length]=xp)}return Kl}function Vy(_i,_u){return _i&&IL(_i,_u,l1)}function NN(_i,_u){return _i&&pM(_i,_u,l1)}function yO(_i,_u){return ga(_u,function(Sl){return kS(_i[Sl])})}function OS(_i,_u){for(var Sl=0,xl=(_u=aS(_u,_i)).length;_i!=null&&Sl<xl;)_i=_i[lS(_u[Sl++])];return Sl&&Sl==xl?_i:yp}function GT(_i,_u,Sl){return _u=_u(_i),K0(_i)?_u:Tl(_u,Sl(_i))}function G1(_i){if(_i==null)return _i===yp?"[object Undefined]":"[object Null]";if(ET&&ET in B_(_i)){var _u=y_.call(_i,ET),Sl=_i[ET];try{_i[ET]=yp;var xl=!0}catch{}var Kl=h2.call(_i);xl&&(_u?_i[ET]=Sl:delete _i[ET]),_i=Kl}else _i=h2.call(_i);return _i}function kN(_i,_u){return _i>_u}function LU(_i,_u){return _i!=null&&y_.call(_i,_u)}function PU(_i,_u){return _i!=null&&_u in B_(_i)}function bO(_i,_u,Sl){for(var xl=Sl?_c:_s,Kl=_i[0].length,vp=_i.length,Op=vp,xp=d1(vp),Mp=1/0,$p=[];Op--;){var t0=_i[Op];Op&&_u&&(t0=_l(t0,Jp(_u))),Mp=D1(t0.length,Mp),xp[Op]=!Sl&&(_u||120<=Kl&&120<=t0.length)?new lT(Op&&t0):yp}t0=_i[0];var g0=-1,S0=xp[0];t:for(;++g0<Kl&&$p.length<Mp;){var u0=t0[g0],C0=_u?_u(u0):u0;if(u0=Sl||u0!==0?u0:0,S0?!S0.has(C0):!xl($p,C0,Sl)){for(Op=vp;--Op;){var x0=xp[Op];if(x0?!x0.has(C0):!xl(_i[Op],C0,Sl))continue t}S0&&S0.push(C0),$p.push(u0)}}return $p}function kR(_i,_u,Sl){return(_u=(_i=2>(_u=aS(_u,_i)).length?_i:OS(_i,u1(_u,0,-1)))==null?_i:_i[lS(Ry(_u))])==null?yp:o(_u,_i,Sl)}function L3(_i){return e1(_i)&&G1(_i)=="[object Arguments]"}function WS(_i,_u,Sl,xl,Kl){if(_i===_u)return!0;if(_i==null||_u==null||!e1(_i)&&!e1(_u))return _i!=_i&&_u!=_u;t:{var vp=K0(_i),Op=K0(_u),xp=vp?"[object Array]":p1(_i),Mp=Op?"[object Array]":p1(_u),$p=(xp=xp=="[object Arguments]"?"[object Object]":xp)=="[object Object]";if(Op=(Mp=Mp=="[object Arguments]"?"[object Object]":Mp)=="[object Object]",(Mp=xp==Mp)&&YS(_i)){if(!YS(_u)){_u=!1;break t}vp=!0,$p=!1}if(Mp&&!$p)Kl||(Kl=new jy),_u=vp||dR(_i)?FO(_i,_u,Sl,xl,WS,Kl):function(x0,r_,x_,D0,w_,Z_,f1){switch(x_){case"[object DataView]":if(x0.byteLength!=r_.byteLength||x0.byteOffset!=r_.byteOffset)break;x0=x0.buffer,r_=r_.buffer;case"[object ArrayBuffer]":if(x0.byteLength!=r_.byteLength||!Z_(new mT(x0),new mT(r_)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return ty(+x0,+r_);case"[object Error]":return x0.name==r_.name&&x0.message==r_.message;case"[object RegExp]":case"[object String]":return x0==r_+"";case"[object Map]":var ry=n0;case"[object Set]":if(ry||(ry=_f),x0.size!=r_.size&&!(1&D0))break;return(x_=f1.get(x0))?x_==r_:(D0|=2,f1.set(x0,r_),r_=FO(ry(x0),ry(r_),D0,w_,Z_,f1),f1.delete(x0),r_);case"[object Symbol]":if(yT)return yT.call(x0)==yT.call(r_)}return!1}(_i,_u,xp,Sl,xl,WS,Kl);else{if(!(1&Sl)&&(vp=$p&&y_.call(_i,"__wrapped__"),xp=Op&&y_.call(_u,"__wrapped__"),vp||xp)){_i=vp?_i.value():_i,_u=xp?_u.value():_u,Kl||(Kl=new jy),_u=WS(_i,_u,Sl,xl,Kl);break t}if(Mp)e:if(Kl||(Kl=new jy),vp=1&Sl,xp=BO(_i),Op=xp.length,Mp=BO(_u).length,Op==Mp||vp){for(Mp=Op;Mp--;){var t0=xp[Mp];if(!(vp?t0 in _u:y_.call(_u,t0))){_u=!1;break e}}if($p=Kl.get(_i),t0=Kl.get(_u),$p&&t0)_u=$p==_u&&t0==_i;else{$p=!0,Kl.set(_i,_u),Kl.set(_u,_i);for(var g0=vp;++Mp<Op;){var S0=_i[t0=xp[Mp]],u0=_u[t0];if(xl)var C0=vp?xl(u0,S0,t0,_u,_i,Kl):xl(S0,u0,t0,_i,_u,Kl);if(C0===yp?S0!==u0&&!WS(S0,u0,Sl,xl,Kl):!C0){$p=!1;break}g0||(g0=t0=="constructor")}$p&&!g0&&(Sl=_i.constructor)!=(xl=_u.constructor)&&"constructor"in _i&&"constructor"in _u&&!(typeof Sl=="function"&&Sl instanceof Sl&&typeof xl=="function"&&xl instanceof xl)&&($p=!1),Kl.delete(_i),Kl.delete(_u),_u=$p}}else _u=!1;else _u=!1}}return _u}function sS(_i,_u,Sl,xl){var Kl=Sl.length,vp=Kl,Op=!xl;if(_i==null)return!vp;for(_i=B_(_i);Kl--;){var xp=Sl[Kl];if(Op&&xp[2]?xp[1]!==_i[xp[0]]:!(xp[0]in _i))return!1}for(;++Kl<vp;){var Mp=(xp=Sl[Kl])[0],$p=_i[Mp],t0=xp[1];if(Op&&xp[2]){if($p===yp&&!(Mp in _i))return!1}else{if(xp=new jy,xl)var g0=xl($p,t0,Mp,_i,_u,xp);if(g0===yp?!WS(t0,$p,3,xl,xp):!g0)return!1}}return!0}function Ty(_i){return!(!V_(_i)||eM&&eM in _i)&&(kS(_i)?nM:vU).test(hT(_i))}function LN(_i){return typeof _i=="function"?_i:_i==null?j1:Ia(_i)=="object"?K0(_i)?$1(_i[0],_i[1]):D3(_i):ZT(_i)}function wO(_i){if(!VR(_i))return WU(_i);var _u,Sl=[];for(_u in B_(_i))y_.call(_i,_u)&&_u!="constructor"&&Sl.push(_u);return Sl}function PN(_i,_u){return _i<_u}function P3(_i,_u){var Sl=-1,xl=ey(_i)?d1(_i.length):[];return zS(_i,function(Kl,vp,Op){xl[++Sl]=_u(Kl,vp,Op)}),xl}function D3(_i){var _u=JT(_i);return _u.length==1&&_u[0][2]?HO(_u[0][0],_u[0][1]):function(Sl){return Sl===_i||sS(Sl,_i,_u)}}function $1(_i,_u){return qO(_i)&&_u==_u&&!V_(_u)?HO(lS(_i),_u):function(Sl){var xl=QN(Sl,_i);return xl===yp&&xl===_u?QT(Sl,_i):WS(_u,xl,3)}}function IO(_i,_u,Sl,xl,Kl){_i!==_u&&IL(_u,function(vp,Op){if(Kl||(Kl=new jy),V_(vp)){vp=Kl;var xp=KN(_i,Op),Mp=KN(_u,Op),$p=vp.get(Mp);if($p)ON(_i,Op,$p);else{var t0=($p=xl?xl(xp,Mp,Op+"",_i,_u,vp):yp)===yp;if(t0){var g0=K0(Mp),S0=!g0&&YS(Mp),u0=!g0&&!S0&&dR(Mp);$p=Mp,g0||S0||u0?K0(xp)?$p=xp:i1(xp)?$p=Z1(xp):S0?(t0=!1,$p=V3(Mp,!0)):u0?(t0=!1,$p=cS(Mp,!0)):$p=[]:qR(Mp)||RT(Mp)?($p=xp,RT(xp)?$p=Yx(xp):V_(xp)&&!kS(xp)||($p=$3(Mp))):t0=!1}t0&&(vp.set(Mp,$p),IO($p,Mp,Sl,xl,vp),vp.delete(Mp)),ON(_i,Op,$p)}}else(xp=xl?xl(KN(_i,Op),vp,Op+"",_i,_u,Kl):yp)===yp&&(xp=vp),ON(_i,Op,xp)},ny)}function x3(_i,_u){var Sl=_i.length;if(Sl)return NS(_u+=0>_u?Sl:0,Sl)?_i[_u]:yp}function M3(_i,_u,Sl){_u=_u.length?_l(_u,function(Kl){return K0(Kl)?function(vp){return OS(vp,Kl.length===1?Kl[0]:Kl)}:Kl}):[j1];var xl=-1;return _u=_l(_u,Jp(U0())),function(Kl,vp){var Op=Kl.length;for(Kl.sort(vp);Op--;)Kl[Op]=Kl[Op].value;return Kl}(_i=P3(_i,function(Kl,vp,Op){return{criteria:_l(_u,function(xp){return xp(Kl)}),index:++xl,value:Kl}}),function(Kl,vp){t:{for(var Op=-1,xp=Kl.criteria,Mp=vp.criteria,$p=xp.length,t0=Sl.length;++Op<$p;){var g0=B3(xp[Op],Mp[Op]);if(g0){if(Op>=t0){Kl=g0;break t}Kl=g0*(Sl[Op]=="desc"?-1:1);break t}}Kl=Kl.index-vp.index}return Kl})}function LR(_i,_u,Sl){for(var xl=-1,Kl=_u.length,vp={};++xl<Kl;){var Op=_u[xl],xp=OS(_i,Op);Sl(xp,Op)&&qT(vp,aS(Op,_i),xp)}return vp}function CO(_i,_u,Sl,xl){var Kl=xl?Vl:Bl,vp=-1,Op=_u.length,xp=_i;for(_i===_u&&(_u=Z1(_u)),Sl&&(xp=_l(_i,Jp(Sl)));++vp<Op;){var Mp=0,$p=_u[vp];for($p=Sl?Sl($p):$p;-1<(Mp=Kl(xp,$p,Mp,xl));)xp!==_i&&g2.call(xp,Mp,1),g2.call(_i,Mp,1)}return _i}function U3(_i,_u){for(var Sl=_i?_u.length:0,xl=Sl-1;Sl--;){var Kl=_u[Sl];if(Sl==xl||Kl!==vp){var vp=Kl;NS(Kl)?g2.call(_i,Kl,1):MN(_i,Kl)}}return _i}function PR(_i,_u){return _i+v2(TL()*(_u-_i+1))}function DN(_i,_u){var Sl="";if(!_i||1>_u||9007199254740991<_u)return Sl;do _u%2&&(Sl+=_i),(_u=v2(_u/2))&&(_i+=_i);while(_u);return Sl}function s_(_i,_u){return NL(HN(_i,_u,j1),_i+"")}function DU(_i){return O3(fT(_i))}function xU(_i,_u){return zO(_i=fT(_i),qS(_u,0,_i.length))}function qT(_i,_u,Sl,xl){if(!V_(_i))return _i;for(var Kl=-1,vp=(_u=aS(_u,_i)).length,Op=vp-1,xp=_i;xp!=null&&++Kl<vp;){var Mp=lS(_u[Kl]),$p=Sl;if(Mp==="__proto__"||Mp==="constructor"||Mp==="prototype")break;if(Kl!=Op){var t0=xp[Mp];($p=xl?xl(t0,Mp,xp):yp)===yp&&($p=V_(t0)?t0:NS(_u[Kl+1])?[]:{})}GS(xp,Mp,$p),xp=xp[Mp]}return _i}function MU(_i){return zO(fT(_i))}function u1(_i,_u,Sl){var xl=-1,Kl=_i.length;for(0>_u&&(_u=-_u>Kl?0:Kl+_u),0>(Sl=Sl>Kl?Kl:Sl)&&(Sl+=Kl),Kl=_u>Sl?0:Sl-_u>>>0,_u>>>=0,Sl=d1(Kl);++xl<Kl;)Sl[xl]=_i[xl+_u];return Sl}function AO(_i,_u){var Sl;return zS(_i,function(xl,Kl,vp){return!(Sl=_u(xl,Kl,vp))}),!!Sl}function kO(_i,_u,Sl){var xl=0,Kl=_i==null?xl:_i.length;if(typeof _u=="number"&&_u==_u&&2147483647>=Kl){for(;xl<Kl;){var vp=xl+Kl>>>1,Op=_i[vp];Op!==null&&!gy(Op)&&(Sl?Op<=_u:Op<_u)?xl=vp+1:Kl=vp}return Kl}return xN(_i,_u,j1,Sl)}function xN(_i,_u,Sl,xl){var Kl=0,vp=_i==null?0:_i.length;if(vp===0)return 0;for(var Op=(_u=Sl(_u))!=_u,xp=_u===null,Mp=gy(_u),$p=_u===yp;Kl<vp;){var t0=v2((Kl+vp)/2),g0=Sl(_i[t0]),S0=g0!==yp,u0=g0===null,C0=g0==g0,x0=gy(g0);(Op?xl||C0:$p?C0&&(xl||S0):xp?C0&&S0&&(xl||!u0):Mp?C0&&S0&&!u0&&(xl||!x0):!u0&&!x0&&(xl?g0<=_u:g0<_u))?Kl=t0+1:vp=t0}return D1(vp,4294967294)}function j3(_i,_u){for(var Sl=-1,xl=_i.length,Kl=0,vp=[];++Sl<xl;){var Op=_i[Sl],xp=_u?_u(Op):Op;if(!Sl||!ty(xp,Mp)){var Mp=xp;vp[Kl++]=Op===0?0:Op}}return vp}function F3(_i){return typeof _i=="number"?_i:gy(_i)?L1:+_i}function py(_i){if(typeof _i=="string")return _i;if(K0(_i))return _l(_i,py)+"";if(gy(_i))return dM?dM.call(_i):"";var _u=_i+"";return _u=="0"&&1/_i==-dy?"-0":_u}function fy(_i,_u,Sl){var xl=-1,Kl=_s,vp=_i.length,Op=!0,xp=[],Mp=xp;if(Sl)Op=!1,Kl=_c;else if(200<=vp){if(Kl=_u?null:OL(_i))return _f(Kl);Op=!1,Kl=i0,Mp=new lT}else Mp=_u?[]:xp;t:for(;++xl<vp;){var $p=_i[xl],t0=_u?_u($p):$p;if($p=Sl||$p!==0?$p:0,Op&&t0==t0){for(var g0=Mp.length;g0--;)if(Mp[g0]===t0)continue t;_u&&Mp.push(t0),xp.push($p)}else Kl(Mp,t0,Sl)||(Mp!==xp&&Mp.push(t0),xp.push($p))}return xp}function MN(_i,_u){return(_i=2>(_u=aS(_u,_i)).length?_i:OS(_i,u1(_u,0,-1)))==null||delete _i[lS(Ry(_u))]}function CS(_i,_u,Sl,xl){for(var Kl=_i.length,vp=xl?Kl:-1;(xl?vp--:++vp<Kl)&&_u(_i[vp],vp,_i););return Sl?u1(_i,xl?0:vp,xl?vp+1:Kl):u1(_i,xl?vp+1:0,xl?Kl:vp)}function UN(_i,_u){return _i instanceof y0&&(_i=_i.value()),Cl(_u,function(Sl,xl){return xl.func.apply(xl.thisArg,Tl([Sl],xl.args))},_i)}function jN(_i,_u,Sl){var xl=_i.length;if(2>xl)return xl?fy(_i[0]):[];for(var Kl=-1,vp=d1(xl);++Kl<xl;)for(var Op=_i[Kl],xp=-1;++xp<xl;)xp!=Kl&&(vp[Kl]=NR(vp[Kl]||Op,_i[xp],_u,Sl));return fy(P1(vp,1),_u,Sl)}function a1(_i,_u,Sl){for(var xl=-1,Kl=_i.length,vp=_u.length,Op={};++xl<Kl;)Sl(Op,_i[xl],xl<vp?_u[xl]:yp);return Op}function FN(_i){return i1(_i)?_i:[]}function VN(_i){return typeof _i=="function"?_i:j1}function aS(_i,_u){return K0(_i)?_i:qO(_i,_u)?[_i]:gM(R_(_i))}function HS(_i,_u,Sl){var xl=_i.length;return Sl=Sl===yp?xl:Sl,!_u&&Sl>=xl?_i:u1(_i,_u,Sl)}function V3(_i,_u){return _u?_i.slice():(_u=_i.length,_u=rM?rM(_u):new _i.constructor(_u),_i.copy(_u),_u)}function BN(_i){var _u=new _i.constructor(_i.byteLength);return new mT(_u).set(new mT(_i)),_u}function cS(_i,_u){return _u=_u?BN(_i.buffer):_i.buffer,new _i.constructor(_u,_i.byteOffset,_i.length)}function B3(_i,_u){if(_i!==_u){var Sl=_i!==yp,xl=_i===null,Kl=_i==_i,vp=gy(_i),Op=_u!==yp,xp=_u===null,Mp=_u==_u,$p=gy(_u);if(!xp&&!$p&&!vp&&_i>_u||vp&&Op&&Mp&&!xp&&!$p||xl&&Op&&Mp||!Sl&&Mp||!Kl)return 1;if(!xl&&!vp&&!$p&&_i<_u||$p&&Sl&&Kl&&!xl&&!vp||xp&&Sl&&Kl||!Op&&Kl||!Mp)return-1}return 0}function G3(_i,_u,Sl,xl){var Kl=-1,vp=_i.length,Op=Sl.length,xp=-1,Mp=_u.length,$p=h1(vp-Op,0),t0=d1(Mp+$p);for(xl=!xl;++xp<Mp;)t0[xp]=_u[xp];for(;++Kl<Op;)(xl||Kl<vp)&&(t0[Sl[Kl]]=_i[Kl]);for(;$p--;)t0[xp++]=_i[Kl++];return t0}function q3(_i,_u,Sl,xl){var Kl=-1,vp=_i.length,Op=-1,xp=Sl.length,Mp=-1,$p=_u.length,t0=h1(vp-xp,0),g0=d1(t0+$p);for(xl=!xl;++Kl<t0;)g0[Kl]=_i[Kl];for(t0=Kl;++Mp<$p;)g0[t0+Mp]=_u[Mp];for(;++Op<xp;)(xl||Kl<vp)&&(g0[t0+Sl[Op]]=_i[Kl++]);return g0}function Z1(_i,_u){var Sl=-1,xl=_i.length;for(_u||(_u=d1(xl));++Sl<xl;)_u[Sl]=_i[Sl];return _u}function uS(_i,_u,Sl,xl){var Kl=!Sl;Sl||(Sl={});for(var vp=-1,Op=_u.length;++vp<Op;){var xp=_u[vp],Mp=xl?xl(Sl[xp],_i[xp],xp,Sl,_i):yp;Mp===yp&&(Mp=_i[xp]),Kl?Fy(Sl,xp,Mp):GS(Sl,xp,Mp)}return Sl}function DR(_i,_u){return function(Sl,xl){var Kl=K0(Sl)?c:CN,vp=_u?_u():{};return Kl(Sl,_i,U0(xl,2),vp)}}function WT(_i){return s_(function(_u,Sl){var xl=-1,Kl=Sl.length,vp=1<Kl?Sl[Kl-1]:yp,Op=2<Kl?Sl[2]:yp;for(vp=3<_i.length&&typeof vp=="function"?(Kl--,vp):yp,Op&&W1(Sl[0],Sl[1],Op)&&(vp=3>Kl?yp:vp,Kl=1),_u=B_(_u);++xl<Kl;)(Op=Sl[xl])&&_i(_u,Op,xl,vp);return _u})}function W3(_i,_u){return function(Sl,xl){if(Sl==null)return Sl;if(!ey(Sl))return _i(Sl,xl);for(var Kl=Sl.length,vp=_u?Kl:-1,Op=B_(Sl);(_u?vp--:++vp<Kl)&&xl(Op[vp],vp,Op)!==!1;);return Sl}}function DO(_i){return function(_u,Sl,xl){for(var Kl=-1,vp=B_(_u),Op=(xl=xl(_u)).length;Op--;){var xp=xl[_i?Op:++Kl];if(Sl(vp[xp],xp,vp)===!1)break}return _u}}function xR(_i){return function(_u){_u=R_(_u);var Sl=BS.test(_u)?_0(_u):yp,xl=Sl?Sl[0]:_u.charAt(0);return _u=Sl?HS(Sl,1).join(""):_u.slice(1),xl[_i]()+_u}}function HT(_i){return function(_u){return Cl(Zx($x(_u).replace(bU,"")),_i,"")}}function KT(_i){return function(){var _u=arguments;switch(_u.length){case 0:return new _i;case 1:return new _i(_u[0]);case 2:return new _i(_u[0],_u[1]);case 3:return new _i(_u[0],_u[1],_u[2]);case 4:return new _i(_u[0],_u[1],_u[2],_u[3]);case 5:return new _i(_u[0],_u[1],_u[2],_u[3],_u[4]);case 6:return new _i(_u[0],_u[1],_u[2],_u[3],_u[4],_u[5]);case 7:return new _i(_u[0],_u[1],_u[2],_u[3],_u[4],_u[5],_u[6])}var Sl=oR(_i.prototype);return V_(_u=_i.apply(Sl,_u))?_u:Sl}}function H3(_i){return function(_u,Sl,xl){var Kl=B_(_u);if(!ey(_u)){var vp=U0(Sl,3);_u=l1(_u),Sl=function(Op){return vp(Kl[Op],Op,Kl)}}return-1<(Sl=_i(_u,Sl,xl))?Kl[vp?_u[Sl]:Sl]:yp}}function K3(_i){return AS(function(_u){var Sl=_u.length,xl=Sl,Kl=j0.prototype.thru;for(_i&&_u.reverse();xl--;){var vp=_u[xl];if(typeof vp!="function")throw new my("Expected a function");if(Kl&&!Op&&UR(vp)=="wrapper")var Op=new j0([],!0)}for(xl=Op?xl:Sl;++xl<Sl;){var xp=(Kl=UR(vp=_u[xl]))=="wrapper"?CL(vp):yp;Op=xp&&FR(xp[0])&&xp[1]==424&&!xp[4].length&&xp[9]==1?Op[UR(xp[0])].apply(Op,xp[3]):vp.length==1&&FR(vp)?Op[Kl]():Op.thru(vp)}return function(){var Mp=arguments,$p=Mp[0];if(Op&&Mp.length==1&&K0($p))return Op.plant($p).value();var t0=0;for(Mp=Sl?_u[t0].apply(this,Mp):$p;++t0<Sl;)Mp=_u[t0].call(this,Mp);return Mp}})}function By(_i,_u,Sl,xl,Kl,vp,Op,xp,Mp,$p){var t0=128&_u,g0=1&_u,S0=2&_u,u0=24&_u,C0=512&_u,x0=S0?yp:KT(_i);return function r_(){for(var x_=arguments.length,D0=d1(x_),w_=x_;w_--;)D0[w_]=arguments[w_];if(u0){var Z_,f1=YT(r_);for(w_=D0.length,Z_=0;w_--;)D0[w_]===f1&&++Z_}if(xl&&(D0=G3(D0,xl,Kl,u0)),vp&&(D0=q3(D0,vp,Op,u0)),x_-=Z_,u0&&x_<$p)return f1=c0(D0,f1),WN(_i,_u,By,r_.placeholder,Sl,D0,f1,xp,Mp,$p-x_);if(f1=g0?Sl:this,w_=S0?f1[_i]:_i,x_=D0.length,xp){Z_=D0.length;for(var ry=D1(xp.length,Z_),I2=Z1(D0);ry--;){var hR=xp[ry];D0[ry]=NS(hR,Z_)?I2[hR]:yp}}else C0&&1<x_&&D0.reverse();return t0&&Mp<x_&&(D0.length=Mp),this&&this!==v1&&this instanceof r_&&(w_=x0||KT(w_)),w_.apply(f1,D0)}}function z3(_i,_u){return function(Sl,xl){return function(Kl,vp,Op,xp){return Vy(Kl,function(Mp,$p,t0){vp(xp,Op(Mp),$p,t0)}),xp}(Sl,_i,_u(xl),{})}}function xO(_i,_u){return function(Sl,xl){var Kl;if(Sl===yp&&xl===yp)return _u;if(Sl!==yp&&(Kl=Sl),xl!==yp){if(Kl===yp)return xl;typeof Sl=="string"||typeof xl=="string"?(Sl=py(Sl),xl=py(xl)):(Sl=F3(Sl),xl=F3(xl)),Kl=_i(Sl,xl)}return Kl}}function GN(_i){return AS(function(_u){return _u=_l(_u,Jp(U0())),s_(function(Sl){var xl=this;return _i(_u,function(Kl){return o(Kl,xl,Sl)})})})}function zT(_i,_u){var Sl=(_u=_u===yp?" ":py(_u)).length;return 2>Sl?Sl?DN(_u,_i):_u:(Sl=DN(_u,m2(_i/O0(_u))),BS.test(_u)?HS(_0(Sl),0,_i).join(""):Sl.slice(0,_i))}function qN(_i){return function(_u,Sl,xl){xl&&typeof xl!="number"&&W1(_u,Sl,xl)&&(Sl=xl=yp),_u=wy(_u),Sl===yp?(Sl=_u,_u=0):Sl=wy(Sl),xl=xl===yp?_u<Sl?1:-1:wy(xl);var Kl=-1;Sl=h1(m2((Sl-_u)/(xl||1)),0);for(var vp=d1(Sl);Sl--;)vp[_i?Sl:++Kl]=_u,_u+=xl;return vp}}function Gy(_i){return function(_u,Sl){return typeof _u=="string"&&typeof Sl=="string"||(_u=Iy(_u),Sl=Iy(Sl)),_i(_u,Sl)}}function WN(_i,_u,Sl,xl,Kl,vp,Op,xp,Mp,$p){var t0=8&_u;return 4&(_u=(_u|(t0?32:64))&~(t0?64:32))||(_u&=-4),Kl=[_i,_u,Kl,t0?vp:yp,t0?Op:yp,vp=t0?yp:vp,Op=t0?yp:Op,xp,Mp,$p],Sl=Sl.apply(yp,Kl),FR(_i)&&QR(Sl,Kl),Sl.placeholder=xl,Z3(Sl,_i,_u)}function jO(_i){var _u=tR[_i];return function(Sl,xl){return Sl=Iy(Sl),(xl=xl==null?0:D1(n_(xl),292))&&cM(Sl)?(Sl=(R_(Sl)+"e").split("e"),+((Sl=(R_(Sl=_u(Sl[0]+"e"+(+Sl[1]+xl)))+"e").split("e"))[0]+"e"+(+Sl[1]-xl))):_u(Sl)}}function MR(_i){return function(_u){var Sl=p1(_u);return Sl=="[object Map]"?n0(_u):Sl=="[object Set]"?function(xl){var Kl=-1,vp=Array(xl.size);return xl.forEach(function(Op){vp[++Kl]=[Op,Op]}),vp}(_u):function(xl,Kl){return _l(Kl,function(vp){return[vp,xl[vp]]})}(_u,_i(_u))}}function q1(_i,_u,Sl,xl,Kl,vp,Op,xp){var Mp=2&_u;if(!Mp&&typeof _i!="function")throw new my("Expected a function");var $p=xl?xl.length:0;if($p||(_u&=-97,xl=Kl=yp),Op=Op===yp?Op:h1(n_(Op),0),xp=xp===yp?xp:n_(xp),$p-=Kl?Kl.length:0,64&_u){var t0=xl,g0=Kl;xl=Kl=yp}var S0=Mp?yp:CL(_i);return vp=[_i,_u,Sl,xl,Kl,t0,g0,vp,Op,xp],S0&&(_u=(Sl=vp[1])|(_i=S0[1]),xl=_i==128&&Sl==8||_i==128&&Sl==256&&vp[7].length<=S0[8]||_i==384&&S0[7].length<=S0[8]&&Sl==8,131>_u||xl)&&(1&_i&&(vp[2]=S0[2],_u|=1&Sl?0:4),(Sl=S0[3])&&(xl=vp[3],vp[3]=xl?G3(xl,Sl,S0[4]):Sl,vp[4]=xl?c0(vp[3],"__lodash_placeholder__"):S0[4]),(Sl=S0[5])&&(xl=vp[5],vp[5]=xl?q3(xl,Sl,S0[6]):Sl,vp[6]=xl?c0(vp[5],"__lodash_placeholder__"):S0[6]),(Sl=S0[7])&&(vp[7]=Sl),128&_i&&(vp[8]=vp[8]==null?S0[8]:D1(vp[8],S0[8])),vp[9]==null&&(vp[9]=S0[9]),vp[0]=S0[0],vp[1]=_u),_i=vp[0],_u=vp[1],Sl=vp[2],xl=vp[3],Kl=vp[4],!(xp=vp[9]=vp[9]===yp?Mp?0:_i.length:h1(vp[9]-$p,0))&&24&_u&&(_u&=-25),Mp=_u&&_u!=1?_u==8||_u==16?function(u0,C0,x0){var r_=KT(u0);return function x_(){for(var D0=arguments.length,w_=d1(D0),Z_=D0,f1=YT(x_);Z_--;)w_[Z_]=arguments[Z_];return(D0-=(Z_=3>D0&&w_[0]!==f1&&w_[D0-1]!==f1?[]:c0(w_,f1)).length)<x0?WN(u0,C0,By,x_.placeholder,yp,w_,Z_,yp,yp,x0-D0):o(this&&this!==v1&&this instanceof x_?r_:u0,this,w_)}}(_i,_u,xp):_u!=32&&_u!=33||Kl.length?By.apply(yp,vp):function(u0,C0,x0,r_){var x_=1&C0,D0=KT(u0);return function w_(){for(var Z_=-1,f1=arguments.length,ry=-1,I2=r_.length,hR=d1(I2+f1),qM=this&&this!==v1&&this instanceof w_?D0:u0;++ry<I2;)hR[ry]=r_[ry];for(;f1--;)hR[ry++]=arguments[++Z_];return o(qM,x_?x0:this,hR)}}(_i,_u,Sl,xl):function(u0,C0,x0){var r_=1&C0,x_=KT(u0);return function D0(){return(this&&this!==v1&&this instanceof D0?x_:u0).apply(r_?x0:this,arguments)}}(_i,_u,Sl),Z3((S0?YR:QR)(Mp,vp),_i,_u)}function Y3(_i,_u,Sl,xl){return _i===yp||ty(_i,nR[Sl])&&!y_.call(xl,Sl)?_u:_i}function J3(_i,_u,Sl,xl,Kl,vp){return V_(_i)&&V_(_u)&&(vp.set(_u,_i),IO(_i,_u,yp,J3,vp),vp.delete(_u)),_i}function X3(_i){return qR(_i)?yp:_i}function FO(_i,_u,Sl,xl,Kl,vp){var Op=1&Sl,xp=_i.length,Mp=_u.length;if(xp!=Mp&&!(Op&&Mp>xp))return!1;Mp=vp.get(_i);var $p=vp.get(_u);if(Mp&&$p)return Mp==_u&&$p==_i;Mp=-1,$p=!0;var t0=2&Sl?new lT:yp;for(vp.set(_i,_u),vp.set(_u,_i);++Mp<xp;){var g0=_i[Mp],S0=_u[Mp];if(xl)var u0=Op?xl(S0,g0,Mp,_u,_i,vp):xl(g0,S0,Mp,_i,_u,vp);if(u0!==yp){if(u0)continue;$p=!1;break}if(t0){if(!Dl(_u,function(C0,x0){if(!t0.has(x0)&&(g0===C0||Kl(g0,C0,Sl,xl,vp)))return t0.push(x0)})){$p=!1;break}}else if(g0!==S0&&!Kl(g0,S0,Sl,xl,vp)){$p=!1;break}}return vp.delete(_i),vp.delete(_u),$p}function AS(_i){return NL(HN(_i,yp,Rx),_i+"")}function BO(_i){return GT(_i,l1,JR)}function GO(_i){return GT(_i,ny,fM)}function UR(_i){for(var _u=_i.name+"",Sl=iR[_u],xl=y_.call(iR,_u)?Sl.length:0;xl--;){var Kl=Sl[xl],vp=Kl.func;if(vp==null||vp==_i)return Kl.name}return _u}function YT(_i){return(y_.call(Ul,"placeholder")?Ul:_i).placeholder}function U0(){var _i=Ul.iteratee||a2;return _i=_i===a2?LN:_i,arguments.length?_i(arguments[0],arguments[1]):_i}function jR(_i,_u){_i=_i.__data__;var Sl=Ia(_u);return(Sl=="string"||Sl=="number"||Sl=="symbol"||Sl=="boolean"?_u!=="__proto__":_u===null)?_i[typeof _u=="string"?"string":"hash"]:_i.map}function JT(_i){for(var _u=l1(_i),Sl=_u.length;Sl--;){var xl=_u[Sl],Kl=_i[xl];_u[Sl]=[xl,Kl,Kl==Kl&&!V_(Kl)]}return _u}function dT(_i,_u){return Ty(_i=_i==null?yp:_i[_u])?_i:yp}function Q3(_i,_u,Sl){for(var xl=-1,Kl=(_u=aS(_u,_i)).length,vp=!1;++xl<Kl;){var Op=lS(_u[xl]);if(!(vp=_i!=null&&Sl(_i,Op)))break;_i=_i[Op]}return vp||++xl!=Kl?vp:!!(Kl=_i==null?0:_i.length)&&o2(Kl)&&NS(Op,Kl)&&(K0(_i)||RT(_i))}function $3(_i){return typeof _i.constructor!="function"||VR(_i)?{}:oR(f2(_i))}function UU(_i){return K0(_i)||RT(_i)||!!(sM&&_i&&_i[sM])}function NS(_i,_u){var Sl=Ia(_i);return!!(_u=_u??9007199254740991)&&(Sl=="number"||Sl!="symbol"&&_N.test(_i))&&-1<_i&&_i%1==0&&_i<_u}function W1(_i,_u,Sl){if(!V_(Sl))return!1;var xl=Ia(_u);return!!(xl=="number"?ey(Sl)&&NS(_u,Sl.length):xl=="string"&&_u in Sl)&&ty(Sl[_u],_i)}function qO(_i,_u){if(K0(_i))return!1;var Sl=Ia(_i);return!(Sl!="number"&&Sl!="symbol"&&Sl!="boolean"&&_i!=null&&!gy(_i))||xy.test(_i)||!p3.test(_i)||_u!=null&&_i in B_(_u)}function FR(_i){var _u=UR(_i),Sl=Ul[_u];return typeof Sl=="function"&&_u in y0.prototype&&(_i===Sl||!!(_u=CL(Sl))&&_i===_u[0])}function VR(_i){var _u=_i&&_i.constructor;return _i===(typeof _u=="function"&&_u.prototype||nR)}function HO(_i,_u){return function(Sl){return Sl!=null&&Sl[_i]===_u&&(_u!==yp||_i in B_(Sl))}}function HN(_i,_u,Sl){return _u=h1(_u===yp?_i.length-1:_u,0),function(){for(var xl=arguments,Kl=-1,vp=h1(xl.length-_u,0),Op=d1(vp);++Kl<vp;)Op[Kl]=xl[_u+Kl];for(Kl=-1,vp=d1(_u+1);++Kl<_u;)vp[Kl]=xl[Kl];return vp[_u]=Sl(Op),o(_i,this,vp)}}function KN(_i,_u){if((_u!=="constructor"||typeof _i[_u]!="function")&&_u!="__proto__")return _i[_u]}function Z3(_i,_u,Sl){var xl=_u+"";_u=NL;var Kl=jU,vp=(vp=xl.match(m3))?vp[1].split(BT):[];return Sl=Kl(vp,Sl),(Kl=Sl.length)&&(Sl[vp=Kl-1]=(1<Kl?"& ":"")+Sl[vp],Sl=Sl.join(2<Kl?", ":" "),xl=xl.replace(g3,`{
/* [wrapped with `+Sl+`] */
`)),_u(_i,xl)}function _x(_i){var _u=0,Sl=0;return function(){var xl=HU(),Kl=16-(xl-Sl);if(Sl=xl,0<Kl){if(800<=++_u)return arguments[0]}else _u=0;return _i.apply(yp,arguments)}}function zO(_i,_u){var Sl=-1,xl=_i.length,Kl=xl-1;for(_u=_u===yp?xl:_u;++Sl<_u;){var vp=_i[xl=PR(Sl,Kl)];_i[xl]=_i[Sl],_i[Sl]=vp}return _i.length=_u,_i}function lS(_i){if(typeof _i=="string"||gy(_i))return _i;var _u=_i+"";return _u=="0"&&1/_i==-dy?"-0":_u}function hT(_i){if(_i!=null){try{return d2.call(_i)}catch{}return _i+""}return""}function jU(_i,_u){return _(o0,function(Sl){var xl="_."+Sl[0];_u&Sl[1]&&!_s(_i,xl)&&_i.push(xl)}),_i.sort()}function BR(_i){if(_i instanceof y0)return _i.clone();var _u=new j0(_i.__wrapped__,_i.__chain__);return _u.__actions__=Z1(_i.__actions__),_u.__index__=_i.__index__,_u.__values__=_i.__values__,_u}function Sx(_i,_u,Sl){var xl=_i==null?0:_i.length;return xl?(0>(Sl=Sl==null?0:n_(Sl))&&(Sl=h1(xl+Sl,0)),zl(_i,U0(_u,3),Sl)):-1}function Tx(_i,_u,Sl){var xl=_i==null?0:_i.length;if(!xl)return-1;var Kl=xl-1;return Sl!==yp&&(Kl=n_(Sl),Kl=0>Sl?h1(xl+Kl,0):D1(Kl,xl-1)),zl(_i,U0(_u,3),Kl,!0)}function Rx(_i){return _i!=null&&_i.length?P1(_i,1):[]}function JO(_i){return _i&&_i.length?_i[0]:yp}function Ry(_i){var _u=_i==null?0:_i.length;return _u?_i[_u-1]:yp}function Ox(_i,_u){return _i&&_i.length&&_u&&_u.length?CO(_i,_u):_i}function zN(_i){return _i==null?_i:_2.call(_i)}function t2(_i){if(!_i||!_i.length)return[];var _u=0;return _i=ga(_i,function(Sl){if(i1(Sl))return _u=h1(Sl.length,_u),!0}),I0(_u,function(Sl){return _l(_i,Up(Sl))})}function Nx(_i,_u){return _i&&_i.length?(_i=t2(_i),_u==null?_i:_l(_i,function(Sl){return o(_u,yp,Sl)})):[]}function GR(_i){return(_i=Ul(_i)).__chain__=!0,_i}function XT(_i,_u){return _u(_i)}function Lx(_i,_u){return(K0(_i)?_:zS)(_i,U0(_u,3))}function Px(_i,_u){return(K0(_i)?$:hM)(_i,U0(_u,3))}function e2(_i,_u){return(K0(_i)?_l:P3)(_i,U0(_u,3))}function YN(_i,_u,Sl){return _u=Sl?yp:_u,_u=_i&&_u==null?_i.length:_u,q1(_i,128,yp,yp,yp,yp,_u)}function JN(_i,_u){var Sl;if(typeof _u!="function")throw new my("Expected a function");return _i=n_(_i),function(){return 0<--_i&&(Sl=_u.apply(this,arguments)),1>=_i&&(_u=yp),Sl}}function n2(_i,_u,Sl){function xl(D0){var w_=Mp,Z_=$p;return Mp=$p=yp,u0=D0,t0=_i.apply(Z_,w_)}function Kl(D0){var w_=D0-S0;return D0-=u0,S0===yp||w_>=_u||0>w_||x0&&D0>=x_}function vp(){var D0=uR();if(Kl(D0))return Op(D0);var w_=bT,Z_=D0-u0;D0=_u-(D0-S0),Z_=x0?D1(D0,x_-Z_):D0,g0=w_(vp,Z_)}function Op(D0){return g0=yp,r_&&Mp?xl(D0):(Mp=$p=yp,t0)}function xp(){var D0=uR(),w_=Kl(D0);if(Mp=arguments,$p=this,S0=D0,w_){if(g0===yp)return u0=D0=S0,g0=bT(vp,_u),C0?xl(D0):t0;if(x0)return sR(g0),g0=bT(vp,_u),xl(S0)}return g0===yp&&(g0=bT(vp,_u)),t0}var Mp,$p,t0,g0,S0,u0=0,C0=!1,x0=!1,r_=!0;if(typeof _i!="function")throw new my("Expected a function");if(_u=Iy(_u)||0,V_(Sl)){C0=!!Sl.leading;var x_=(x0="maxWait"in Sl)?h1(Iy(Sl.maxWait)||0,_u):x_;r_="trailing"in Sl?!!Sl.trailing:r_}return xp.cancel=function(){g0!==yp&&sR(g0),u0=0,Mp=S0=$p=g0=yp},xp.flush=function(){return g0===yp?t0:Op(uR())},xp}function r2(_i,_u){if(typeof _i!="function"||_u!=null&&typeof _u!="function")throw new my("Expected a function");var Sl=function xl(){var Kl=arguments,vp=_u?_u.apply(this,Kl):Kl[0],Op=xl.cache;return Op.has(vp)?Op.get(vp):(Kl=_i.apply(this,Kl),xl.cache=Op.set(vp,Kl)||Op,Kl)};return Sl.cache=new(r2.Cache||oS),Sl}function i2(_i){if(typeof _i!="function")throw new my("Expected a function");return function(){var _u=arguments;switch(_u.length){case 0:return!_i.call(this);case 1:return!_i.call(this,_u[0]);case 2:return!_i.call(this,_u[0],_u[1]);case 3:return!_i.call(this,_u[0],_u[1],_u[2])}return!_i.apply(this,_u)}}function ty(_i,_u){return _i===_u||_i!=_i&&_u!=_u}function ey(_i){return _i!=null&&o2(_i.length)&&!kS(_i)}function i1(_i){return e1(_i)&&ey(_i)}function XN(_i){if(!e1(_i))return!1;var _u=G1(_i);return _u=="[object Error]"||_u=="[object DOMException]"||typeof _i.message=="string"&&typeof _i.name=="string"&&!qR(_i)}function kS(_i){return!!V_(_i)&&((_i=G1(_i))=="[object Function]"||_i=="[object GeneratorFunction]"||_i=="[object AsyncFunction]"||_i=="[object Proxy]")}function Mx(_i){return typeof _i=="number"&&_i==n_(_i)}function o2(_i){return typeof _i=="number"&&-1<_i&&_i%1==0&&9007199254740991>=_i}function V_(_i){var _u=Ia(_i);return _i!=null&&(_u=="object"||_u=="function")}function e1(_i){return _i!=null&&Ia(_i)=="object"}function Ux(_i){return typeof _i=="number"||e1(_i)&&G1(_i)=="[object Number]"}function qR(_i){return!(!e1(_i)||G1(_i)!="[object Object]")&&((_i=f2(_i))===null||typeof(_i=y_.call(_i,"constructor")&&_i.constructor)=="function"&&_i instanceof _i&&d2.call(_i)==LS)}function pT(_i){return typeof _i=="string"||!K0(_i)&&e1(_i)&&G1(_i)=="[object String]"}function gy(_i){return Ia(_i)=="symbol"||e1(_i)&&G1(_i)=="[object Symbol]"}function Vx(_i){if(!_i)return[];if(ey(_i))return pT(_i)?_0(_i):Z1(_i);if(vT&&_i[vT]){_i=_i[vT]();for(var _u,Sl=[];!(_u=_i.next()).done;)Sl.push(_u.value);return Sl}return((_u=p1(_i))=="[object Map]"?n0:_u=="[object Set]"?_f:fT)(_i)}function wy(_i){return _i?(_i=Iy(_i))===dy||_i===-dy?17976931348623157e292*(0>_i?-1:1):_i==_i?_i:0:_i===0?_i:0}function n_(_i){var _u=(_i=wy(_i))%1;return _i==_i?_u?_i-_u:_i:0}function Wx(_i){return _i?qS(n_(_i),0,4294967295):0}function Iy(_i){if(typeof _i=="number")return _i;if(gy(_i))return L1;if(V_(_i)&&(_i=V_(_i=typeof _i.valueOf=="function"?_i.valueOf():_i)?_i+"":_i),typeof _i!="string")return _i===0?_i:+_i;_i=Cp(_i);var _u=mU.test(_i);return _u||EU.test(_i)?wU(_i.slice(2),_u?2:8):gU.test(_i)?L1:+_i}function Yx(_i){return uS(_i,ny(_i))}function R_(_i){return _i==null?"":py(_i)}function QN(_i,_u,Sl){return(_i=_i==null?yp:OS(_i,_u))===yp?Sl:_i}function QT(_i,_u){return _i!=null&&Q3(_i,_u,PU)}function l1(_i){return ey(_i)?I3(_i):wO(_i)}function ny(_i){if(ey(_i))_i=I3(_i,!0);else if(V_(_i)){var _u=VR(_i),Sl=[];for(xl in _i)(xl!="constructor"||!_u&&y_.call(_i,xl))&&Sl.push(xl);_i=Sl}else{var xl=[];if(_i!=null)for(_u in B_(_i))xl.push(_u);_i=xl}return _i}function Xx(_i,_u){if(_i==null)return{};var Sl=_l(GO(_i),function(xl){return[xl]});return _u=U0(_u),LR(_i,Sl,function(xl,Kl){return _u(xl,Kl[0])})}function fT(_i){return _i==null?[]:Zp(_i,l1(_i))}function Qx(_i){return w2(R_(_i).toLowerCase())}function $x(_i){return(_i=R_(_i))&&_i.replace(_U,OU).replace(SU,"")}function Zx(_i,_u,Sl){return _i=R_(_i),(_u=Sl?yp:_u)===yp?yN.test(_i)?_i.match(TU)||[]:_i.match(v3)||[]:_i.match(_u)||[]}function s2(_i){return function(){return _i}}function j1(_i){return _i}function a2(_i){return LN(typeof _i=="function"?_i:Sy(_i,1))}function c2(_i,_u,Sl){var xl=l1(_u),Kl=yO(_u,xl);Sl!=null||V_(_u)&&(Kl.length||!xl.length)||(Sl=_u,_u=_i,_i=this,Kl=yO(_u,l1(_u)));var vp=!(V_(Sl)&&"chain"in Sl&&!Sl.chain),Op=kS(_i);return _(Kl,function(xp){var Mp=_u[xp];_i[xp]=Mp,Op&&(_i.prototype[xp]=function(){var $p=this.__chain__;if(vp||$p){var t0=_i(this.__wrapped__);return(t0.__actions__=Z1(this.__actions__)).push({func:Mp,args:arguments,thisArg:_i}),t0.__chain__=$p,t0}return Mp.apply(_i,Tl([this.value()],arguments))})}),_i}function $T(){}function ZT(_i){return qO(_i)?Up(lS(_i)):function(_u){return function(Sl){return OS(Sl,_u)}}(_i)}function $N(){return[]}function ZN(){return!1}var _k,d1=(r0=r0==null?v1:uT.defaults(v1.Object(),r0,uT.pick(v1,bN))).Array,u2=r0.Date,EL=r0.Error,gT=r0.Function,tR=r0.Math,B_=r0.Object,_L=r0.RegExp,tM=r0.String,my=r0.TypeError,eR=d1.prototype,nR=B_.prototype,l2=r0["__core-js_shared__"],d2=gT.prototype.toString,y_=nR.hasOwnProperty,FU=0,eM=(_k=/[^.]+$/.exec(l2&&l2.keys&&l2.keys.IE_PROTO||""))?"Symbol(src)_1."+_k:"",h2=nR.toString,LS=d2.call(B_),VU=v1._,nM=_L("^"+d2.call(y_).replace(mO,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),p2=Uy?r0.Buffer:yp,KS=r0.Symbol,mT=r0.Uint8Array,rM=p2?p2.allocUnsafe:yp,f2=Bp(B_.getPrototypeOf,B_),iM=B_.create,oM=nR.propertyIsEnumerable,g2=eR.splice,sM=KS?KS.isConcatSpreadable:yp,vT=KS?KS.iterator:yp,ET=KS?KS.toStringTag:yp,WR=function(){try{var _i=dT(B_,"defineProperty");return _i({},"",{}),_i}catch{}}(),BU=r0.clearTimeout!==v1.clearTimeout&&r0.clearTimeout,aM=u2&&u2.now!==v1.Date.now&&u2.now,GU=r0.setTimeout!==v1.setTimeout&&r0.setTimeout,m2=tR.ceil,v2=tR.floor,SL=B_.getOwnPropertySymbols,qU=p2?p2.isBuffer:yp,cM=r0.isFinite,uM=eR.join,WU=Bp(B_.keys,B_),h1=tR.max,D1=tR.min,HU=u2.now,E2=r0.parseInt,TL=tR.random,_2=eR.reverse,RL=dT(r0,"DataView"),HR=dT(r0,"Map"),dS=dT(r0,"Promise"),rR=dT(r0,"Set"),KR=dT(r0,"WeakMap"),zR=dT(B_,"create"),y2=KR&&new KR,iR={},KU=hT(RL),zU=hT(HR),b2=hT(dS),YU=hT(rR),lM=hT(KR),_T=KS?KS.prototype:yp,yT=_T?_T.valueOf:yp,dM=_T?_T.toString:yp,oR=function(){function _i(){}return function(_u){return V_(_u)?iM?iM(_u):(_i.prototype=_u,_u=new _i,_i.prototype=yp,_u):{}}}();Ul.templateSettings={escape:gN,evaluate:mN,interpolate:h3,variable:"",imports:{_:Ul}},Ul.prototype=P0.prototype,Ul.prototype.constructor=Ul,j0.prototype=oR(P0.prototype),j0.prototype.constructor=j0,y0.prototype=oR(P0.prototype),y0.prototype.constructor=y0,s1.prototype.clear=function(){this.__data__=zR?zR(null):{},this.size=0},s1.prototype.delete=function(_i){return _i=this.has(_i)&&delete this.__data__[_i],this.size-=_i?1:0,_i},s1.prototype.get=function(_i){var _u=this.__data__;return zR?(_i=_u[_i])==="__lodash_hash_undefined__"?yp:_i:y_.call(_u,_i)?_u[_i]:yp},s1.prototype.has=function(_i){var _u=this.__data__;return zR?_u[_i]!==yp:y_.call(_u,_i)},s1.prototype.set=function(_i,_u){var Sl=this.__data__;return this.size+=this.has(_i)?0:1,Sl[_i]=zR&&_u===yp?"__lodash_hash_undefined__":_u,this},by.prototype.clear=function(){this.__data__=[],this.size=0},by.prototype.delete=function(_i){var _u=this.__data__;return!(0>(_i=AR(_u,_i)))&&(_i==_u.length-1?_u.pop():g2.call(_u,_i,1),--this.size,!0)},by.prototype.get=function(_i){var _u=this.__data__;return 0>(_i=AR(_u,_i))?yp:_u[_i][1]},by.prototype.has=function(_i){return-1<AR(this.__data__,_i)},by.prototype.set=function(_i,_u){var Sl=this.__data__,xl=AR(Sl,_i);return 0>xl?(++this.size,Sl.push([_i,_u])):Sl[xl][1]=_u,this},oS.prototype.clear=function(){this.size=0,this.__data__={hash:new s1,map:new(HR||by),string:new s1}},oS.prototype.delete=function(_i){return _i=jR(this,_i).delete(_i),this.size-=_i?1:0,_i},oS.prototype.get=function(_i){return jR(this,_i).get(_i)},oS.prototype.has=function(_i){return jR(this,_i).has(_i)},oS.prototype.set=function(_i,_u){var Sl=jR(this,_i),xl=Sl.size;return Sl.set(_i,_u),this.size+=Sl.size==xl?0:1,this},lT.prototype.add=lT.prototype.push=function(_i){return this.__data__.set(_i,"__lodash_hash_undefined__"),this},lT.prototype.has=function(_i){return this.__data__.has(_i)},jy.prototype.clear=function(){this.__data__=new by,this.size=0},jy.prototype.delete=function(_i){var _u=this.__data__;return _i=_u.delete(_i),this.size=_u.size,_i},jy.prototype.get=function(_i){return this.__data__.get(_i)},jy.prototype.has=function(_i){return this.__data__.has(_i)},jy.prototype.set=function(_i,_u){var Sl=this.__data__;if(Sl instanceof by){var xl=Sl.__data__;if(!HR||199>xl.length)return xl.push([_i,_u]),this.size=++Sl.size,this;Sl=this.__data__=new oS(xl)}return Sl.set(_i,_u),this.size=Sl.size,this};var zS=W3(Vy),hM=W3(NN,!0),IL=DO(),pM=DO(!0),YR=y2?function(_i,_u){return y2.set(_i,_u),_i}:j1,JU=WR?function(_i,_u){return WR(_i,"toString",{configurable:!0,enumerable:!1,value:s2(_u),writable:!0})}:j1,sR=BU||function(_i){return v1.clearTimeout(_i)},OL=rR&&1/_f(new rR([,-0]))[1]==dy?function(_i){return new rR(_i)}:$T,CL=y2?function(_i){return y2.get(_i)}:$T,JR=SL?function(_i){return _i==null?[]:(_i=B_(_i),ga(SL(_i),function(_u){return oM.call(_i,_u)}))}:$N,fM=SL?function(_i){for(var _u=[];_i;)Tl(_u,JR(_i)),_i=f2(_i);return _u}:$N,p1=G1;(RL&&p1(new RL(new ArrayBuffer(1)))!="[object DataView]"||HR&&p1(new HR)!="[object Map]"||dS&&p1(dS.resolve())!="[object Promise]"||rR&&p1(new rR)!="[object Set]"||KR&&p1(new KR)!="[object WeakMap]")&&(p1=function(_i){var _u=G1(_i);if(_i=(_i=_u=="[object Object]"?_i.constructor:yp)?hT(_i):"")switch(_i){case KU:return"[object DataView]";case zU:return"[object Map]";case b2:return"[object Promise]";case YU:return"[object Set]";case lM:return"[object WeakMap]"}return _u});var XR=l2?kS:ZN,QR=_x(YR),bT=GU||function(_i,_u){return v1.setTimeout(_i,_u)},NL=_x(JU),gM=function(_i){var _u=(_i=r2(_i,function(Sl){return _u.size===500&&_u.clear(),Sl})).cache;return _i}(function(_i){var _u=[];return _i.charCodeAt(0)===46&&_u.push(""),_i.replace(sT,function(Sl,xl,Kl,vp){_u.push(Kl?vp.replace(EN,"$1"):xl||Sl)}),_u}),mM=s_(function(_i,_u){return i1(_i)?NR(_i,P1(_u,1,i1,!0)):[]}),XU=s_(function(_i,_u){var Sl=Ry(_u);return i1(Sl)&&(Sl=yp),i1(_i)?NR(_i,P1(_u,1,i1,!0),U0(Sl,2)):[]}),vM=s_(function(_i,_u){var Sl=Ry(_u);return i1(Sl)&&(Sl=yp),i1(_i)?NR(_i,P1(_u,1,i1,!0),yp,Sl):[]}),LL=s_(function(_i){var _u=_l(_i,FN);return _u.length&&_u[0]===_i[0]?bO(_u):[]}),QU=s_(function(_i){var _u=Ry(_i),Sl=_l(_i,FN);return _u===Ry(Sl)?_u=yp:Sl.pop(),Sl.length&&Sl[0]===_i[0]?bO(Sl,U0(_u,2)):[]}),$U=s_(function(_i){var _u=Ry(_i),Sl=_l(_i,FN);return(_u=typeof _u=="function"?_u:yp)&&Sl.pop(),Sl.length&&Sl[0]===_i[0]?bO(Sl,yp,_u):[]}),PL=s_(Ox),DL=AS(function(_i,_u){var Sl=_i==null?0:_i.length,xl=AN(_i,_u);return U3(_i,_l(_u,function(Kl){return NS(Kl,Sl)?+Kl:Kl}).sort(B3)),xl}),ZU=s_(function(_i){return fy(P1(_i,1,i1,!0))}),t5=s_(function(_i){var _u=Ry(_i);return i1(_u)&&(_u=yp),fy(P1(_i,1,i1,!0),U0(_u,2))}),EM=s_(function(_i){var _u=Ry(_i);return _u=typeof _u=="function"?_u:yp,fy(P1(_i,1,i1,!0),yp,_u)}),ML=s_(function(_i,_u){return i1(_i)?NR(_i,_u):[]}),e5=s_(function(_i){return jN(ga(_i,i1))}),ST=s_(function(_i){var _u=Ry(_i);return i1(_u)&&(_u=yp),jN(ga(_i,i1),U0(_u,2))}),n5=s_(function(_i){var _u=Ry(_i);return _u=typeof _u=="function"?_u:yp,jN(ga(_i,i1),yp,_u)}),_M=s_(t2),r5=s_(function(_i){var _u=_i.length;return _u=typeof(_u=1<_u?_i[_u-1]:yp)=="function"?(_i.pop(),_u):yp,Nx(_i,_u)}),aR=AS(function(_i){var _u=_i.length,Sl=_u?_i[0]:0,xl=this.__wrapped__,Kl=function(vp){return AN(vp,_i)};return!(1<_u||this.__actions__.length)&&xl instanceof y0&&NS(Sl)?((xl=xl.slice(Sl,+Sl+(_u?1:0))).__actions__.push({func:XT,args:[Kl],thisArg:yp}),new j0(xl,this.__chain__).thru(function(vp){return _u&&!vp.length&&vp.push(yp),vp})):this.thru(Kl)}),TT=DR(function(_i,_u,Sl){y_.call(_i,Sl)?++_i[Sl]:Fy(_i,Sl,1)}),yM=H3(Sx),bM=H3(Tx),cR=DR(function(_i,_u,Sl){y_.call(_i,Sl)?_i[Sl].push(_u):Fy(_i,Sl,[_u])}),UL=s_(function(_i,_u,Sl){var xl=-1,Kl=typeof _u=="function",vp=ey(_i)?d1(_i.length):[];return zS(_i,function(Op){vp[++xl]=Kl?o(_u,Op,Sl):kR(Op,_u,Sl)}),vp}),i5=DR(function(_i,_u,Sl){Fy(_i,Sl,_u)}),SM=DR(function(_i,_u,Sl){_i[Sl?0:1].push(_u)},function(){return[[],[]]}),o5=s_(function(_i,_u){if(_i==null)return[];var Sl=_u.length;return 1<Sl&&W1(_i,_u[0],_u[1])?_u=[]:2<Sl&&W1(_u[0],_u[1],_u[2])&&(_u=[_u[0]]),M3(_i,P1(_u,1),[])}),uR=aM||function(){return v1.Date.now()},S2=s_(function(_i,_u,Sl){var xl=1;if(Sl.length){var Kl=c0(Sl,YT(S2));xl|=32}return q1(_i,xl,_u,Sl,Kl)}),TM=s_(function(_i,_u,Sl){var xl=3;if(Sl.length){var Kl=c0(Sl,YT(TM));xl|=32}return q1(_u,xl,_i,Sl,Kl)}),lR=s_(function(_i,_u){return N3(_i,1,_u)}),s5=s_(function(_i,_u,Sl){return N3(_i,Iy(_u)||0,Sl)});r2.Cache=oS;var a5=s_(function(_i,_u){var Sl=(_u=_u.length==1&&K0(_u[0])?_l(_u[0],Jp(U0())):_l(P1(_u,1),Jp(U0()))).length;return s_(function(xl){for(var Kl=-1,vp=D1(xl.length,Sl);++Kl<vp;)xl[Kl]=_u[Kl].call(this,xl[Kl]);return o(_i,this,xl)})}),FL=s_(function(_i,_u){var Sl=c0(_u,YT(FL));return q1(_i,32,yp,_u,Sl)}),VL=s_(function(_i,_u){var Sl=c0(_u,YT(VL));return q1(_i,64,yp,_u,Sl)}),c5=AS(function(_i,_u){return q1(_i,256,yp,yp,yp,_u)}),BL=Gy(kN),RM=Gy(function(_i,_u){return _i>=_u}),RT=L3(function(){return arguments}())?L3:function(_i){return e1(_i)&&y_.call(_i,"callee")&&!oM.call(_i,"callee")},K0=d1.isArray,u5=E1?Jp(E1):function(_i){return e1(_i)&&G1(_i)=="[object ArrayBuffer]"},YS=qU||ZN,l5=b3?Jp(b3):function(_i){return e1(_i)&&G1(_i)=="[object Date]"},wM=S3?Jp(S3):function(_i){return e1(_i)&&p1(_i)=="[object Map]"},GL=T3?Jp(T3):function(_i){return e1(_i)&&G1(_i)=="[object RegExp]"},IM=R3?Jp(R3):function(_i){return e1(_i)&&p1(_i)=="[object Set]"},dR=EO?Jp(EO):function(_i){return e1(_i)&&o2(_i.length)&&!!F_[G1(_i)]},OM=Gy(PN),wT=Gy(function(_i,_u){return _i<=_u}),d5=WT(function(_i,_u){if(VR(_u)||ey(_u))uS(_u,l1(_u),_i);else for(var Sl in _u)y_.call(_u,Sl)&&GS(_i,Sl,_u[Sl])}),CM=WT(function(_i,_u){uS(_u,ny(_u),_i)}),T2=WT(function(_i,_u,Sl,xl){uS(_u,ny(_u),_i,xl)}),h5=WT(function(_i,_u,Sl,xl){uS(_u,l1(_u),_i,xl)}),p5=AS(AN),f5=s_(function(_i,_u){_i=B_(_i);var Sl=-1,xl=_u.length,Kl=2<xl?_u[2]:yp;for(Kl&&W1(_u[0],_u[1],Kl)&&(xl=1);++Sl<xl;)for(var vp=ny(Kl=_u[Sl]),Op=-1,xp=vp.length;++Op<xp;){var Mp=vp[Op],$p=_i[Mp];($p===yp||ty($p,nR[Mp])&&!y_.call(_i,Mp))&&(_i[Mp]=Kl[Mp])}return _i}),AM=s_(function(_i){return _i.push(yp,J3),o(NM,yp,_i)}),g5=z3(function(_i,_u,Sl){_u!=null&&typeof _u.toString!="function"&&(_u=h2.call(_u)),_i[_u]=Sl},s2(j1)),m5=z3(function(_i,_u,Sl){_u!=null&&typeof _u.toString!="function"&&(_u=h2.call(_u)),y_.call(_i,_u)?_i[_u].push(Sl):_i[_u]=[Sl]},U0),v5=s_(kR),E5=WT(function(_i,_u,Sl){IO(_i,_u,Sl)}),NM=WT(function(_i,_u,Sl,xl){IO(_i,_u,Sl,xl)}),kM=AS(function(_i,_u){var Sl={};if(_i==null)return Sl;var xl=!1;_u=_l(_u,function(vp){return vp=aS(vp,_i),xl||(xl=1<vp.length),vp}),uS(_i,GO(_i),Sl),xl&&(Sl=Sy(Sl,7,X3));for(var Kl=_u.length;Kl--;)MN(Sl,_u[Kl]);return Sl}),LM=AS(function(_i,_u){return _i==null?{}:function(Sl,xl){return LR(Sl,xl,function(Kl,vp){return QT(Sl,vp)})}(_i,_u)}),PM=MR(l1),$R=MR(ny),WL=HT(function(_i,_u,Sl){return _u=_u.toLowerCase(),_i+(Sl?Qx(_u):_u)}),DM=HT(function(_i,_u,Sl){return _i+(Sl?"-":"")+_u.toLowerCase()}),R2=HT(function(_i,_u,Sl){return _i+(Sl?" ":"")+_u.toLowerCase()}),xM=xR("toLowerCase"),_5=HT(function(_i,_u,Sl){return _i+(Sl?"_":"")+_u.toLowerCase()}),MM=HT(function(_i,_u,Sl){return _i+(Sl?" ":"")+w2(_u)}),y5=HT(function(_i,_u,Sl){return _i+(Sl?" ":"")+_u.toUpperCase()}),w2=xR("toUpperCase"),HL=s_(function(_i,_u){try{return o(_i,yp,_u)}catch(Sl){return XN(Sl)?Sl:new EL(Sl)}}),b5=AS(function(_i,_u){return _(_u,function(Sl){Sl=lS(Sl),Fy(_i,Sl,S2(_i[Sl],_i))}),_i}),UM=K3(),S5=K3(!0),T5=s_(function(_i,_u){return function(Sl){return kR(Sl,_i,_u)}}),jM=s_(function(_i,_u){return function(Sl){return kR(_i,Sl,_u)}}),R5=GN(_l),FM=GN(_t),w5=GN(Dl),I5=qN(),O5=qN(!0),VM=xO(function(_i,_u){return _i+_u},0),C5=jO("ceil"),A5=xO(function(_i,_u){return _i/_u},1),KL=jO("floor"),BM=xO(function(_i,_u){return _i*_u},1),GM=jO("round"),N5=xO(function(_i,_u){return _i-_u},0);return Ul.after=function(_i,_u){if(typeof _u!="function")throw new my("Expected a function");return _i=n_(_i),function(){if(1>--_i)return _u.apply(this,arguments)}},Ul.ary=YN,Ul.assign=d5,Ul.assignIn=CM,Ul.assignInWith=T2,Ul.assignWith=h5,Ul.at=p5,Ul.before=JN,Ul.bind=S2,Ul.bindAll=b5,Ul.bindKey=TM,Ul.castArray=function(){if(!arguments.length)return[];var _i=arguments[0];return K0(_i)?_i:[_i]},Ul.chain=GR,Ul.chunk=function(_i,_u,Sl){if(_u=(Sl?W1(_i,_u,Sl):_u===yp)?1:h1(n_(_u),0),!(Sl=_i==null?0:_i.length)||1>_u)return[];for(var xl=0,Kl=0,vp=d1(m2(Sl/_u));xl<Sl;)vp[Kl++]=u1(_i,xl,xl+=_u);return vp},Ul.compact=function(_i){for(var _u=-1,Sl=_i==null?0:_i.length,xl=0,Kl=[];++_u<Sl;){var vp=_i[_u];vp&&(Kl[xl++]=vp)}return Kl},Ul.concat=function(){var _i=arguments.length;if(!_i)return[];for(var _u=d1(_i-1),Sl=arguments[0];_i--;)_u[_i-1]=arguments[_i];return Tl(K0(Sl)?Z1(Sl):[Sl],P1(_u,1))},Ul.cond=function(_i){var _u=_i==null?0:_i.length,Sl=U0();return _i=_u?_l(_i,function(xl){if(typeof xl[1]!="function")throw new my("Expected a function");return[Sl(xl[0]),xl[1]]}):[],s_(function(xl){for(var Kl=-1;++Kl<_u;){var vp=_i[Kl];if(o(vp[0],this,xl))return o(vp[1],this,xl)}})},Ul.conforms=function(_i){return function(_u){var Sl=l1(_u);return function(xl){return A3(xl,_u,Sl)}}(Sy(_i,1))},Ul.constant=s2,Ul.countBy=TT,Ul.create=function(_i,_u){return _i=oR(_i),_u==null?_i:C3(_i,_u)},Ul.curry=function _i(_u,Sl,xl){return(_u=q1(_u,8,yp,yp,yp,yp,yp,Sl=xl?yp:Sl)).placeholder=_i.placeholder,_u},Ul.curryRight=function _i(_u,Sl,xl){return(_u=q1(_u,16,yp,yp,yp,yp,yp,Sl=xl?yp:Sl)).placeholder=_i.placeholder,_u},Ul.debounce=n2,Ul.defaults=f5,Ul.defaultsDeep=AM,Ul.defer=lR,Ul.delay=s5,Ul.difference=mM,Ul.differenceBy=XU,Ul.differenceWith=vM,Ul.drop=function(_i,_u,Sl){var xl=_i==null?0:_i.length;return xl?u1(_i,0>(_u=Sl||_u===yp?1:n_(_u))?0:_u,xl):[]},Ul.dropRight=function(_i,_u,Sl){var xl=_i==null?0:_i.length;return xl?u1(_i,0,0>(_u=xl-(_u=Sl||_u===yp?1:n_(_u)))?0:_u):[]},Ul.dropRightWhile=function(_i,_u){return _i&&_i.length?CS(_i,U0(_u,3),!0,!0):[]},Ul.dropWhile=function(_i,_u){return _i&&_i.length?CS(_i,U0(_u,3),!0):[]},Ul.fill=function(_i,_u,Sl,xl){var Kl=_i==null?0:_i.length;if(!Kl)return[];for(Sl&&typeof Sl!="number"&&W1(_i,_u,Sl)&&(Sl=0,xl=Kl),Kl=_i.length,0>(Sl=n_(Sl))&&(Sl=-Sl>Kl?0:Kl+Sl),0>(xl=xl===yp||xl>Kl?Kl:n_(xl))&&(xl+=Kl),xl=Sl>xl?0:Wx(xl);Sl<xl;)_i[Sl++]=_u;return _i},Ul.filter=function(_i,_u){return(K0(_i)?ga:k3)(_i,U0(_u,3))},Ul.flatMap=function(_i,_u){return P1(e2(_i,_u),1)},Ul.flatMapDeep=function(_i,_u){return P1(e2(_i,_u),dy)},Ul.flatMapDepth=function(_i,_u,Sl){return Sl=Sl===yp?1:n_(Sl),P1(e2(_i,_u),Sl)},Ul.flatten=Rx,Ul.flattenDeep=function(_i){return _i!=null&&_i.length?P1(_i,dy):[]},Ul.flattenDepth=function(_i,_u){return _i!=null&&_i.length?P1(_i,_u=_u===yp?1:n_(_u)):[]},Ul.flip=function(_i){return q1(_i,512)},Ul.flow=UM,Ul.flowRight=S5,Ul.fromPairs=function(_i){for(var _u=-1,Sl=_i==null?0:_i.length,xl={};++_u<Sl;){var Kl=_i[_u];xl[Kl[0]]=Kl[1]}return xl},Ul.functions=function(_i){return _i==null?[]:yO(_i,l1(_i))},Ul.functionsIn=function(_i){return _i==null?[]:yO(_i,ny(_i))},Ul.groupBy=cR,Ul.initial=function(_i){return _i!=null&&_i.length?u1(_i,0,-1):[]},Ul.intersection=LL,Ul.intersectionBy=QU,Ul.intersectionWith=$U,Ul.invert=g5,Ul.invertBy=m5,Ul.invokeMap=UL,Ul.iteratee=a2,Ul.keyBy=i5,Ul.keys=l1,Ul.keysIn=ny,Ul.map=e2,Ul.mapKeys=function(_i,_u){var Sl={};return _u=U0(_u,3),Vy(_i,function(xl,Kl,vp){Fy(Sl,_u(xl,Kl,vp),xl)}),Sl},Ul.mapValues=function(_i,_u){var Sl={};return _u=U0(_u,3),Vy(_i,function(xl,Kl,vp){Fy(Sl,Kl,_u(xl,Kl,vp))}),Sl},Ul.matches=function(_i){return D3(Sy(_i,1))},Ul.matchesProperty=function(_i,_u){return $1(_i,Sy(_u,1))},Ul.memoize=r2,Ul.merge=E5,Ul.mergeWith=NM,Ul.method=T5,Ul.methodOf=jM,Ul.mixin=c2,Ul.negate=i2,Ul.nthArg=function(_i){return _i=n_(_i),s_(function(_u){return x3(_u,_i)})},Ul.omit=kM,Ul.omitBy=function(_i,_u){return Xx(_i,i2(U0(_u)))},Ul.once=function(_i){return JN(2,_i)},Ul.orderBy=function(_i,_u,Sl,xl){return _i==null?[]:(K0(_u)||(_u=_u==null?[]:[_u]),K0(Sl=xl?yp:Sl)||(Sl=Sl==null?[]:[Sl]),M3(_i,_u,Sl))},Ul.over=R5,Ul.overArgs=a5,Ul.overEvery=FM,Ul.overSome=w5,Ul.partial=FL,Ul.partialRight=VL,Ul.partition=SM,Ul.pick=LM,Ul.pickBy=Xx,Ul.property=ZT,Ul.propertyOf=function(_i){return function(_u){return _i==null?yp:OS(_i,_u)}},Ul.pull=PL,Ul.pullAll=Ox,Ul.pullAllBy=function(_i,_u,Sl){return _i&&_i.length&&_u&&_u.length?CO(_i,_u,U0(Sl,2)):_i},Ul.pullAllWith=function(_i,_u,Sl){return _i&&_i.length&&_u&&_u.length?CO(_i,_u,yp,Sl):_i},Ul.pullAt=DL,Ul.range=I5,Ul.rangeRight=O5,Ul.rearg=c5,Ul.reject=function(_i,_u){return(K0(_i)?ga:k3)(_i,i2(U0(_u,3)))},Ul.remove=function(_i,_u){var Sl=[];if(!_i||!_i.length)return Sl;var xl=-1,Kl=[],vp=_i.length;for(_u=U0(_u,3);++xl<vp;){var Op=_i[xl];_u(Op,xl,_i)&&(Sl.push(Op),Kl.push(xl))}return U3(_i,Kl),Sl},Ul.rest=function(_i,_u){if(typeof _i!="function")throw new my("Expected a function");return s_(_i,_u=_u===yp?_u:n_(_u))},Ul.reverse=zN,Ul.sampleSize=function(_i,_u,Sl){return _u=(Sl?W1(_i,_u,Sl):_u===yp)?1:n_(_u),(K0(_i)?AU:xU)(_i,_u)},Ul.set=function(_i,_u,Sl){return _i==null?_i:qT(_i,_u,Sl)},Ul.setWith=function(_i,_u,Sl,xl){return xl=typeof xl=="function"?xl:yp,_i==null?_i:qT(_i,_u,Sl,xl)},Ul.shuffle=function(_i){return(K0(_i)?NU:MU)(_i)},Ul.slice=function(_i,_u,Sl){var xl=_i==null?0:_i.length;return xl?(Sl&&typeof Sl!="number"&&W1(_i,_u,Sl)?(_u=0,Sl=xl):(_u=_u==null?0:n_(_u),Sl=Sl===yp?xl:n_(Sl)),u1(_i,_u,Sl)):[]},Ul.sortBy=o5,Ul.sortedUniq=function(_i){return _i&&_i.length?j3(_i):[]},Ul.sortedUniqBy=function(_i,_u){return _i&&_i.length?j3(_i,U0(_u,2)):[]},Ul.split=function(_i,_u,Sl){return Sl&&typeof Sl!="number"&&W1(_i,_u,Sl)&&(_u=Sl=yp),(Sl=Sl===yp?4294967295:Sl>>>0)?(_i=R_(_i))&&(typeof _u=="string"||_u!=null&&!GL(_u))&&!(_u=py(_u))&&BS.test(_i)?HS(_0(_i),0,Sl):_i.split(_u,Sl):[]},Ul.spread=function(_i,_u){if(typeof _i!="function")throw new my("Expected a function");return _u=_u==null?0:h1(n_(_u),0),s_(function(Sl){var xl=Sl[_u];return Sl=HS(Sl,0,_u),xl&&Tl(Sl,xl),o(_i,this,Sl)})},Ul.tail=function(_i){var _u=_i==null?0:_i.length;return _u?u1(_i,1,_u):[]},Ul.take=function(_i,_u,Sl){return _i&&_i.length?u1(_i,0,0>(_u=Sl||_u===yp?1:n_(_u))?0:_u):[]},Ul.takeRight=function(_i,_u,Sl){var xl=_i==null?0:_i.length;return xl?u1(_i,0>(_u=xl-(_u=Sl||_u===yp?1:n_(_u)))?0:_u,xl):[]},Ul.takeRightWhile=function(_i,_u){return _i&&_i.length?CS(_i,U0(_u,3),!1,!0):[]},Ul.takeWhile=function(_i,_u){return _i&&_i.length?CS(_i,U0(_u,3)):[]},Ul.tap=function(_i,_u){return _u(_i),_i},Ul.throttle=function(_i,_u,Sl){var xl=!0,Kl=!0;if(typeof _i!="function")throw new my("Expected a function");return V_(Sl)&&(xl="leading"in Sl?!!Sl.leading:xl,Kl="trailing"in Sl?!!Sl.trailing:Kl),n2(_i,_u,{leading:xl,maxWait:_u,trailing:Kl})},Ul.thru=XT,Ul.toArray=Vx,Ul.toPairs=PM,Ul.toPairsIn=$R,Ul.toPath=function(_i){return K0(_i)?_l(_i,lS):gy(_i)?[_i]:Z1(gM(R_(_i)))},Ul.toPlainObject=Yx,Ul.transform=function(_i,_u,Sl){var xl=K0(_i),Kl=xl||YS(_i)||dR(_i);if(_u=U0(_u,4),Sl==null){var vp=_i&&_i.constructor;Sl=Kl?xl?new vp:[]:V_(_i)&&kS(vp)?oR(f2(_i)):{}}return(Kl?_:Vy)(_i,function(Op,xp,Mp){return _u(Sl,Op,xp,Mp)}),Sl},Ul.unary=function(_i){return YN(_i,1)},Ul.union=ZU,Ul.unionBy=t5,Ul.unionWith=EM,Ul.uniq=function(_i){return _i&&_i.length?fy(_i):[]},Ul.uniqBy=function(_i,_u){return _i&&_i.length?fy(_i,U0(_u,2)):[]},Ul.uniqWith=function(_i,_u){return _u=typeof _u=="function"?_u:yp,_i&&_i.length?fy(_i,yp,_u):[]},Ul.unset=function(_i,_u){return _i==null||MN(_i,_u)},Ul.unzip=t2,Ul.unzipWith=Nx,Ul.update=function(_i,_u,Sl){return _i!=null&&(_i=qT(_i,_u,(Sl=VN(Sl))(OS(_i,_u)),void 0)),_i},Ul.updateWith=function(_i,_u,Sl,xl){return xl=typeof xl=="function"?xl:yp,_i!=null&&(_i=qT(_i,_u,(Sl=VN(Sl))(OS(_i,_u)),xl)),_i},Ul.values=fT,Ul.valuesIn=function(_i){return _i==null?[]:Zp(_i,ny(_i))},Ul.without=ML,Ul.words=Zx,Ul.wrap=function(_i,_u){return FL(VN(_u),_i)},Ul.xor=e5,Ul.xorBy=ST,Ul.xorWith=n5,Ul.zip=_M,Ul.zipObject=function(_i,_u){return a1(_i||[],_u||[],GS)},Ul.zipObjectDeep=function(_i,_u){return a1(_i||[],_u||[],qT)},Ul.zipWith=r5,Ul.entries=PM,Ul.entriesIn=$R,Ul.extend=CM,Ul.extendWith=T2,c2(Ul,Ul),Ul.add=VM,Ul.attempt=HL,Ul.camelCase=WL,Ul.capitalize=Qx,Ul.ceil=C5,Ul.clamp=function(_i,_u,Sl){return Sl===yp&&(Sl=_u,_u=yp),Sl!==yp&&(Sl=(Sl=Iy(Sl))==Sl?Sl:0),_u!==yp&&(_u=(_u=Iy(_u))==_u?_u:0),qS(Iy(_i),_u,Sl)},Ul.clone=function(_i){return Sy(_i,4)},Ul.cloneDeep=function(_i){return Sy(_i,5)},Ul.cloneDeepWith=function(_i,_u){return Sy(_i,5,_u=typeof _u=="function"?_u:yp)},Ul.cloneWith=function(_i,_u){return Sy(_i,4,_u=typeof _u=="function"?_u:yp)},Ul.conformsTo=function(_i,_u){return _u==null||A3(_i,_u,l1(_u))},Ul.deburr=$x,Ul.defaultTo=function(_i,_u){return _i==null||_i!=_i?_u:_i},Ul.divide=A5,Ul.endsWith=function(_i,_u,Sl){_i=R_(_i),_u=py(_u);var xl=_i.length;return xl=Sl=Sl===yp?xl:qS(n_(Sl),0,xl),0<=(Sl-=_u.length)&&_i.slice(Sl,xl)==_u},Ul.eq=ty,Ul.escape=function(_i){return(_i=R_(_i))&&IS.test(_i)?_i.replace(gO,w3):_i},Ul.escapeRegExp=function(_i){return(_i=R_(_i))&&vN.test(_i)?_i.replace(mO,"\\$&"):_i},Ul.every=function(_i,_u,Sl){var xl=K0(_i)?_t:kU;return Sl&&W1(_i,_u,Sl)&&(_u=yp),xl(_i,U0(_u,3))},Ul.find=yM,Ul.findIndex=Sx,Ul.findKey=function(_i,_u){return Jl(_i,U0(_u,3),Vy)},Ul.findLast=bM,Ul.findLastIndex=Tx,Ul.findLastKey=function(_i,_u){return Jl(_i,U0(_u,3),NN)},Ul.floor=KL,Ul.forEach=Lx,Ul.forEachRight=Px,Ul.forIn=function(_i,_u){return _i==null?_i:IL(_i,U0(_u,3),ny)},Ul.forInRight=function(_i,_u){return _i==null?_i:pM(_i,U0(_u,3),ny)},Ul.forOwn=function(_i,_u){return _i&&Vy(_i,U0(_u,3))},Ul.forOwnRight=function(_i,_u){return _i&&NN(_i,U0(_u,3))},Ul.get=QN,Ul.gt=BL,Ul.gte=RM,Ul.has=function(_i,_u){return _i!=null&&Q3(_i,_u,LU)},Ul.hasIn=QT,Ul.head=JO,Ul.identity=j1,Ul.includes=function(_i,_u,Sl,xl){return _i=ey(_i)?_i:fT(_i),Sl=Sl&&!xl?n_(Sl):0,xl=_i.length,0>Sl&&(Sl=h1(xl+Sl,0)),pT(_i)?Sl<=xl&&-1<_i.indexOf(_u,Sl):!!xl&&-1<Bl(_i,_u,Sl)},Ul.indexOf=function(_i,_u,Sl){var xl=_i==null?0:_i.length;return xl?(0>(Sl=Sl==null?0:n_(Sl))&&(Sl=h1(xl+Sl,0)),Bl(_i,_u,Sl)):-1},Ul.inRange=function(_i,_u,Sl){return _u=wy(_u),Sl===yp?(Sl=_u,_u=0):Sl=wy(Sl),(_i=Iy(_i))>=D1(_u,Sl)&&_i<h1(_u,Sl)},Ul.invoke=v5,Ul.isArguments=RT,Ul.isArray=K0,Ul.isArrayBuffer=u5,Ul.isArrayLike=ey,Ul.isArrayLikeObject=i1,Ul.isBoolean=function(_i){return _i===!0||_i===!1||e1(_i)&&G1(_i)=="[object Boolean]"},Ul.isBuffer=YS,Ul.isDate=l5,Ul.isElement=function(_i){return e1(_i)&&_i.nodeType===1&&!qR(_i)},Ul.isEmpty=function(_i){if(_i==null)return!0;if(ey(_i)&&(K0(_i)||typeof _i=="string"||typeof _i.splice=="function"||YS(_i)||dR(_i)||RT(_i)))return!_i.length;var _u=p1(_i);if(_u=="[object Map]"||_u=="[object Set]")return!_i.size;if(VR(_i))return!wO(_i).length;for(var Sl in _i)if(y_.call(_i,Sl))return!1;return!0},Ul.isEqual=function(_i,_u){return WS(_i,_u)},Ul.isEqualWith=function(_i,_u,Sl){var xl=(Sl=typeof Sl=="function"?Sl:yp)?Sl(_i,_u):yp;return xl===yp?WS(_i,_u,yp,Sl):!!xl},Ul.isError=XN,Ul.isFinite=function(_i){return typeof _i=="number"&&cM(_i)},Ul.isFunction=kS,Ul.isInteger=Mx,Ul.isLength=o2,Ul.isMap=wM,Ul.isMatch=function(_i,_u){return _i===_u||sS(_i,_u,JT(_u))},Ul.isMatchWith=function(_i,_u,Sl){return Sl=typeof Sl=="function"?Sl:yp,sS(_i,_u,JT(_u),Sl)},Ul.isNaN=function(_i){return Ux(_i)&&_i!=+_i},Ul.isNative=function(_i){if(XR(_i))throw new EL("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ty(_i)},Ul.isNil=function(_i){return _i==null},Ul.isNull=function(_i){return _i===null},Ul.isNumber=Ux,Ul.isObject=V_,Ul.isObjectLike=e1,Ul.isPlainObject=qR,Ul.isRegExp=GL,Ul.isSafeInteger=function(_i){return Mx(_i)&&-9007199254740991<=_i&&9007199254740991>=_i},Ul.isSet=IM,Ul.isString=pT,Ul.isSymbol=gy,Ul.isTypedArray=dR,Ul.isUndefined=function(_i){return _i===yp},Ul.isWeakMap=function(_i){return e1(_i)&&p1(_i)=="[object WeakMap]"},Ul.isWeakSet=function(_i){return e1(_i)&&G1(_i)=="[object WeakSet]"},Ul.join=function(_i,_u){return _i==null?"":uM.call(_i,_u)},Ul.kebabCase=DM,Ul.last=Ry,Ul.lastIndexOf=function(_i,_u,Sl){var xl=_i==null?0:_i.length;if(!xl)return-1;var Kl=xl;if(Sl!==yp&&(Kl=0>(Kl=n_(Sl))?h1(xl+Kl,0):D1(Kl,xl-1)),_u==_u)t:{for(Sl=Kl+1;Sl--;)if(_i[Sl]===_u){_i=Sl;break t}_i=Sl}else _i=zl(_i,_d,Kl,!0);return _i},Ul.lowerCase=R2,Ul.lowerFirst=xM,Ul.lt=OM,Ul.lte=wT,Ul.max=function(_i){return _i&&_i.length?_O(_i,j1,kN):yp},Ul.maxBy=function(_i,_u){return _i&&_i.length?_O(_i,U0(_u,2),kN):yp},Ul.mean=function(_i){return Sp(_i,j1)},Ul.meanBy=function(_i,_u){return Sp(_i,U0(_u,2))},Ul.min=function(_i){return _i&&_i.length?_O(_i,j1,PN):yp},Ul.minBy=function(_i,_u){return _i&&_i.length?_O(_i,U0(_u,2),PN):yp},Ul.stubArray=$N,Ul.stubFalse=ZN,Ul.stubObject=function(){return{}},Ul.stubString=function(){return""},Ul.stubTrue=function(){return!0},Ul.multiply=BM,Ul.nth=function(_i,_u){return _i&&_i.length?x3(_i,n_(_u)):yp},Ul.noConflict=function(){return v1._===this&&(v1._=VU),this},Ul.noop=$T,Ul.now=uR,Ul.pad=function(_i,_u,Sl){_i=R_(_i);var xl=(_u=n_(_u))?O0(_i):0;return!_u||xl>=_u?_i:zT(v2(_u=(_u-xl)/2),Sl)+_i+zT(m2(_u),Sl)},Ul.padEnd=function(_i,_u,Sl){_i=R_(_i);var xl=(_u=n_(_u))?O0(_i):0;return _u&&xl<_u?_i+zT(_u-xl,Sl):_i},Ul.padStart=function(_i,_u,Sl){_i=R_(_i);var xl=(_u=n_(_u))?O0(_i):0;return _u&&xl<_u?zT(_u-xl,Sl)+_i:_i},Ul.parseInt=function(_i,_u,Sl){return Sl||_u==null?_u=0:_u&&(_u=+_u),E2(R_(_i).replace(vO,""),_u||0)},Ul.random=function(_i,_u,Sl){if(Sl&&typeof Sl!="boolean"&&W1(_i,_u,Sl)&&(_u=Sl=yp),Sl===yp&&(typeof _u=="boolean"?(Sl=_u,_u=yp):typeof _i=="boolean"&&(Sl=_i,_i=yp)),_i===yp&&_u===yp?(_i=0,_u=1):(_i=wy(_i),_u===yp?(_u=_i,_i=0):_u=wy(_u)),_i>_u){var xl=_i;_i=_u,_u=xl}return Sl||_i%1||_u%1?(Sl=TL(),D1(_i+Sl*(_u-_i+RU("1e-"+((Sl+"").length-1))),_u)):PR(_i,_u)},Ul.reduce=function(_i,_u,Sl){var xl=K0(_i)?Cl:Hp,Kl=3>arguments.length;return xl(_i,U0(_u,4),Sl,Kl,zS)},Ul.reduceRight=function(_i,_u,Sl){var xl=K0(_i)?Pl:Hp,Kl=3>arguments.length;return xl(_i,U0(_u,4),Sl,Kl,hM)},Ul.repeat=function(_i,_u,Sl){return _u=(Sl?W1(_i,_u,Sl):_u===yp)?1:n_(_u),DN(R_(_i),_u)},Ul.replace=function(){var _i=arguments,_u=R_(_i[0]);return 3>_i.length?_u:_u.replace(_i[1],_i[2])},Ul.result=function(_i,_u,Sl){var xl=-1,Kl=(_u=aS(_u,_i)).length;for(Kl||(Kl=1,_i=yp);++xl<Kl;){var vp=_i==null?yp:_i[lS(_u[xl])];vp===yp&&(xl=Kl,vp=Sl),_i=kS(vp)?vp.call(_i):vp}return _i},Ul.round=GM,Ul.runInContext=Gp,Ul.sample=function(_i){return(K0(_i)?O3:DU)(_i)},Ul.size=function(_i){if(_i==null)return 0;if(ey(_i))return pT(_i)?O0(_i):_i.length;var _u=p1(_i);return _u=="[object Map]"||_u=="[object Set]"?_i.size:wO(_i).length},Ul.snakeCase=_5,Ul.some=function(_i,_u,Sl){var xl=K0(_i)?Dl:AO;return Sl&&W1(_i,_u,Sl)&&(_u=yp),xl(_i,U0(_u,3))},Ul.sortedIndex=function(_i,_u){return kO(_i,_u)},Ul.sortedIndexBy=function(_i,_u,Sl){return xN(_i,_u,U0(Sl,2))},Ul.sortedIndexOf=function(_i,_u){var Sl=_i==null?0:_i.length;if(Sl){var xl=kO(_i,_u);if(xl<Sl&&ty(_i[xl],_u))return xl}return-1},Ul.sortedLastIndex=function(_i,_u){return kO(_i,_u,!0)},Ul.sortedLastIndexBy=function(_i,_u,Sl){return xN(_i,_u,U0(Sl,2),!0)},Ul.sortedLastIndexOf=function(_i,_u){if(_i!=null&&_i.length){var Sl=kO(_i,_u,!0)-1;if(ty(_i[Sl],_u))return Sl}return-1},Ul.startCase=MM,Ul.startsWith=function(_i,_u,Sl){return _i=R_(_i),Sl=Sl==null?0:qS(n_(Sl),0,_i.length),_u=py(_u),_i.slice(Sl,Sl+_u.length)==_u},Ul.subtract=N5,Ul.sum=function(_i){return _i&&_i.length?_m(_i,j1):0},Ul.sumBy=function(_i,_u){return _i&&_i.length?_m(_i,U0(_u,2)):0},Ul.template=function(_i,_u,Sl){var xl=Ul.templateSettings;Sl&&W1(_i,_u,Sl)&&(_u=yp),_i=R_(_i),_u=T2({},_u,xl,Y3);var Kl,vp,Op=l1(Sl=T2({},_u.imports,xl.imports,Y3)),xp=Zp(Sl,Op),Mp=0;Sl=_u.interpolate||aT;var $p="__p += '";Sl=_L((_u.escape||aT).source+"|"+Sl.source+"|"+(Sl===h3?E3:aT).source+"|"+(_u.evaluate||aT).source+"|$","g");var t0="//# sourceURL="+(y_.call(_u,"sourceURL")?(_u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++SN+"]")+`
`;if(_i.replace(Sl,function(g0,S0,u0,C0,x0,r_){return u0||(u0=C0),$p+=_i.slice(Mp,r_).replace(yU,Qp),S0&&(Kl=!0,$p+=`' +
__e(`+S0+`) +
'`),x0&&(vp=!0,$p+=`';
`+x0+`;
__p += '`),u0&&($p+=`' +
((__t = (`+u0+`)) == null ? '' : __t) +
'`),Mp=r_+g0.length,g0}),$p+=`';
`,_u=y_.call(_u,"variable")&&_u.variable){if(fU.test(_u))throw new EL("Invalid `variable` option passed into `_.template`")}else $p=`with (obj) {
`+$p+`
}
`;if($p=(vp?$p.replace(H0,""):$p).replace(z_,"$1").replace(VS,"$1;"),$p="function("+(_u||"obj")+`) {
`+(_u?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Kl?", __e = _.escape":"")+(vp?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+$p+`return __p
}`,(_u=HL(function(){return gT(Op,t0+"return "+$p).apply(yp,xp)})).source=$p,XN(_u))throw _u;return _u},Ul.times=function(_i,_u){if(1>(_i=n_(_i))||9007199254740991<_i)return[];var Sl=4294967295,xl=D1(_i,4294967295);for(_i-=4294967295,xl=I0(xl,_u=U0(_u));++Sl<_i;)_u(Sl);return xl},Ul.toFinite=wy,Ul.toInteger=n_,Ul.toLength=Wx,Ul.toLower=function(_i){return R_(_i).toLowerCase()},Ul.toNumber=Iy,Ul.toSafeInteger=function(_i){return _i?qS(n_(_i),-9007199254740991,9007199254740991):_i===0?_i:0},Ul.toString=R_,Ul.toUpper=function(_i){return R_(_i).toUpperCase()},Ul.trim=function(_i,_u,Sl){return(_i=R_(_i))&&(Sl||_u===yp)?Cp(_i):_i&&(_u=py(_u))?HS(_i=_0(_i),_u=Np(_i,Sl=_0(_u)),Sl=Dp(_i,Sl)+1).join(""):_i},Ul.trimEnd=function(_i,_u,Sl){return(_i=R_(_i))&&(Sl||_u===yp)?_i.slice(0,__(_i)+1):_i&&(_u=py(_u))?HS(_i=_0(_i),0,_u=Dp(_i,_0(_u))+1).join(""):_i},Ul.trimStart=function(_i,_u,Sl){return(_i=R_(_i))&&(Sl||_u===yp)?_i.replace(vO,""):_i&&(_u=py(_u))?HS(_i=_0(_i),_u=Np(_i,_0(_u))).join(""):_i},Ul.truncate=function(_i,_u){var Sl=30,xl="...";if(V_(_u)){var Kl="separator"in _u?_u.separator:Kl;Sl="length"in _u?n_(_u.length):Sl,xl="omission"in _u?py(_u.omission):xl}if(_u=(_i=R_(_i)).length,BS.test(_i)){var vp=_0(_i);_u=vp.length}if(Sl>=_u)return _i;if(1>(_u=Sl-O0(xl)))return xl;if(Sl=vp?HS(vp,0,_u).join(""):_i.slice(0,_u),Kl===yp)return Sl+xl;if(vp&&(_u+=Sl.length-_u),GL(Kl)){if(_i.slice(_u).search(Kl)){for(vp=Sl,Kl.global||(Kl=_L(Kl.source,R_(_3.exec(Kl))+"g")),Kl.lastIndex=0;_i=Kl.exec(vp);)var Op=_i.index;Sl=Sl.slice(0,Op===yp?_u:Op)}}else _i.indexOf(py(Kl),_u)!=_u&&-1<(Kl=Sl.lastIndexOf(Kl))&&(Sl=Sl.slice(0,Kl));return Sl+xl},Ul.unescape=function(_i){return(_i=R_(_i))&&hy.test(_i)?_i.replace(iS,CU):_i},Ul.uniqueId=function(_i){var _u=++FU;return R_(_i)+_u},Ul.upperCase=y5,Ul.upperFirst=w2,Ul.each=Lx,Ul.eachRight=Px,Ul.first=JO,c2(Ul,function(){var _i={};return Vy(Ul,function(_u,Sl){y_.call(Ul.prototype,Sl)||(_i[Sl]=_u)}),_i}(),{chain:!1}),Ul.VERSION="4.17.21",_("bind bindKey curry curryRight partial partialRight".split(" "),function(_i){Ul[_i].placeholder=Ul}),_(["drop","take"],function(_i,_u){y0.prototype[_i]=function(Sl){Sl=Sl===yp?1:h1(n_(Sl),0);var xl=this.__filtered__&&!_u?new y0(this):this.clone();return xl.__filtered__?xl.__takeCount__=D1(Sl,xl.__takeCount__):xl.__views__.push({size:D1(Sl,4294967295),type:_i+(0>xl.__dir__?"Right":"")}),xl},y0.prototype[_i+"Right"]=function(Sl){return this.reverse()[_i](Sl).reverse()}}),_(["filter","map","takeWhile"],function(_i,_u){var Sl=_u+1,xl=Sl==1||Sl==3;y0.prototype[_i]=function(Kl){var vp=this.clone();return vp.__iteratees__.push({iteratee:U0(Kl,3),type:Sl}),vp.__filtered__=vp.__filtered__||xl,vp}}),_(["head","last"],function(_i,_u){var Sl="take"+(_u?"Right":"");y0.prototype[_i]=function(){return this[Sl](1).value()[0]}}),_(["initial","tail"],function(_i,_u){var Sl="drop"+(_u?"":"Right");y0.prototype[_i]=function(){return this.__filtered__?new y0(this):this[Sl](1)}}),y0.prototype.compact=function(){return this.filter(j1)},y0.prototype.find=function(_i){return this.filter(_i).head()},y0.prototype.findLast=function(_i){return this.reverse().find(_i)},y0.prototype.invokeMap=s_(function(_i,_u){return typeof _i=="function"?new y0(this):this.map(function(Sl){return kR(Sl,_i,_u)})}),y0.prototype.reject=function(_i){return this.filter(i2(U0(_i)))},y0.prototype.slice=function(_i,_u){_i=n_(_i);var Sl=this;return Sl.__filtered__&&(0<_i||0>_u)?new y0(Sl):(0>_i?Sl=Sl.takeRight(-_i):_i&&(Sl=Sl.drop(_i)),_u!==yp&&(Sl=0>(_u=n_(_u))?Sl.dropRight(-_u):Sl.take(_u-_i)),Sl)},y0.prototype.takeRightWhile=function(_i){return this.reverse().takeWhile(_i).reverse()},y0.prototype.toArray=function(){return this.take(4294967295)},Vy(y0.prototype,function(_i,_u){var Sl=/^(?:filter|find|map|reject)|While$/.test(_u),xl=/^(?:head|last)$/.test(_u),Kl=Ul[xl?"take"+(_u=="last"?"Right":""):_u],vp=xl||/^find/.test(_u);Kl&&(Ul.prototype[_u]=function(){var Op=this.__wrapped__,xp=xl?[1]:arguments,Mp=Op instanceof y0,$p=xp[0],t0=Mp||K0(Op),g0=function(C0){return C0=Kl.apply(Ul,Tl([C0],xp)),xl&&S0?C0[0]:C0};t0&&Sl&&typeof $p=="function"&&$p.length!=1&&(Mp=t0=!1);var S0=this.__chain__,u0=!!this.__actions__.length;return $p=vp&&!S0,Mp=Mp&&!u0,!vp&&t0?(Op=Mp?Op:new y0(this),(Op=_i.apply(Op,xp)).__actions__.push({func:XT,args:[g0],thisArg:yp}),new j0(Op,S0)):$p&&Mp?_i.apply(this,xp):(Op=this.thru(g0),$p?xl?Op.value()[0]:Op.value():Op)})}),_("pop push shift sort splice unshift".split(" "),function(_i){var _u=eR[_i],Sl=/^(?:push|sort|unshift)$/.test(_i)?"tap":"thru",xl=/^(?:pop|shift)$/.test(_i);Ul.prototype[_i]=function(){var Kl=arguments;if(xl&&!this.__chain__){var vp=this.value();return _u.apply(K0(vp)?vp:[],Kl)}return this[Sl](function(Op){return _u.apply(K0(Op)?Op:[],Kl)})}}),Vy(y0.prototype,function(_i,_u){if(_i=Ul[_u]){var Sl=_i.name+"";y_.call(iR,Sl)||(iR[Sl]=[]),iR[Sl].push({name:_u,func:_i})}}),iR[By(yp,2).name]=[{name:"wrapper",func:yp}],y0.prototype.clone=function(){var _i=new y0(this.__wrapped__);return _i.__actions__=Z1(this.__actions__),_i.__dir__=this.__dir__,_i.__filtered__=this.__filtered__,_i.__iteratees__=Z1(this.__iteratees__),_i.__takeCount__=this.__takeCount__,_i.__views__=Z1(this.__views__),_i},y0.prototype.reverse=function(){if(this.__filtered__){var _i=new y0(this);_i.__dir__=-1,_i.__filtered__=!0}else(_i=this.clone()).__dir__*=-1;return _i},y0.prototype.value=function(){for(var _i=this.__wrapped__.value(),_u=this.__dir__,Sl=K0(_i),xl=0>_u,Kl=Sl?_i.length:0,vp=0,Op=Kl,xp=this.__views__,Mp=-1,$p=xp.length;++Mp<$p;){var t0=xp[Mp],g0=t0.size;switch(t0.type){case"drop":vp+=g0;break;case"dropRight":Op-=g0;break;case"take":Op=D1(Op,vp+g0);break;case"takeRight":vp=h1(vp,Op-g0)}}if(Op=(xp=Op)-vp,vp=xl?xp:vp-1,Mp=(xp=this.__iteratees__).length,$p=0,t0=D1(Op,this.__takeCount__),!Sl||!xl&&Kl==Op&&t0==Op)return UN(_i,this.__actions__);Sl=[];t:for(;Op--&&$p<t0;){for(xl=-1,Kl=_i[vp+=_u];++xl<Mp;){var S0=xp[xl];if(g0=S0.iteratee,S0=S0.type,g0=g0(Kl),S0==2)Kl=g0;else if(!g0){if(S0==1)continue t;break t}}Sl[$p++]=Kl}return Sl},Ul.prototype.at=aR,Ul.prototype.chain=function(){return GR(this)},Ul.prototype.commit=function(){return new j0(this.value(),this.__chain__)},Ul.prototype.next=function(){this.__values__===yp&&(this.__values__=Vx(this.value()));var _i=this.__index__>=this.__values__.length;return{done:_i,value:_i?yp:this.__values__[this.__index__++]}},Ul.prototype.plant=function(_i){for(var _u,Sl=this;Sl instanceof P0;){var xl=BR(Sl);xl.__index__=0,xl.__values__=yp,_u?Kl.__wrapped__=xl:_u=xl;var Kl=xl;Sl=Sl.__wrapped__}return Kl.__wrapped__=_i,_u},Ul.prototype.reverse=function(){var _i=this.__wrapped__;return _i instanceof y0?(this.__actions__.length&&(_i=new y0(this)),(_i=_i.reverse()).__actions__.push({func:XT,args:[zN],thisArg:yp}),new j0(_i,this.__chain__)):this.thru(zN)},Ul.prototype.toJSON=Ul.prototype.valueOf=Ul.prototype.value=function(){return UN(this.__wrapped__,this.__actions__)},Ul.prototype.first=Ul.prototype.head,vT&&(Ul.prototype[vT]=function(){return this}),Ul}();cT?((cT.exports=uT)._=uT,wN._=uT):v1._=uT}).call(qb)}),Nz=1/0,wq=function(i){return i?(i=hl(i))===Nz||i===-Nz?17976931348623157e292*(0>i?-1:1):i==i?i:0:i===0?i:0},KO=Math.max,AC=function(i,e,o){var c=Object(i);if(!$f(i)){var _=Ch(e);i=Wf(i),e=function($){return _(c[$],$,c)}}return-1<(e=function($,_t,ga){var _s=$==null?0:$.length;if(!_s)return-1;if(ga==null)ga=0;else{var _c=(ga=wq(ga))%1;ga=ga==ga?_c?ga-_c:ga:0}return 0>ga&&(ga=KO(_s+ga,0)),Cv($,Ch(_t),ga)}(i,e,o))?c[_?i[e]:e]:void 0},zC=function(i,e){return i&&i.length?Do(i,void 0,typeof e=="function"?e:void 0):[]},Oz=function(){function i(){ab(this,i),E(this,"size",0),E(this,"fields",new Map)}return Qb(i,[{key:"define",value:function(e,o,c){if(this.size+=c,64<this.size)throw new RangeError("the struct over 64 bits is not supported");ak(o={val:0,isNumber:o==="number",isBoolean:o==="boolean",oneof:o==="number"||o==="boolean"?void 0:o,len:c}),this.fields.set(e,o)}},{key:"set",value:function(e,o){if(!(e=this.fields.get(e)))throw Error("field not found");var c=e.oneof;if(!D.isLong(o)&&typeof o!="number")if(typeof o=="boolean")o=o?1:0;else{if(c===void 0)throw Error("invalid field type");if((o=c[o])===void 0)throw Error("field type not found")}ak(e,o),e.val=o}},{key:"toNumber",value:function(){for(var e=0,o=0,c=0,_=Array.from(this.fields);c<_.length;c++){var $=Lb(_[c],2)[1],_t=$.len;($=$.val)!==void 0&&(e+=D.fromValue($).shiftLeft(o).toNumber(),o+=_t)}return e}},{key:"toLong",value:function(){for(var e=D.fromNumber(0,!0),o=0,c=0,_=Array.from(this.fields);c<_.length;c++){var $=Lb(_[c],2)[1],_t=$.len;($=$.val)!==void 0&&(e=D.fromValue($).shiftLeft(o).add(e),o+=_t)}return e}},{key:"assert",value:function(e,o){function c(_t){if(!D.isLong(_t)&&typeof _t!="number")if(typeof _t=="boolean")_t=_t?1:0;else{if($===void 0)throw Error("invalid field type");if((_t=$[_t])===void 0)throw Error("field type not found")}return ak(_,_t),Zj(_t,_.val)}var _=this.fields.get(e);if(!_)throw Error("field not found");var $=_.oneof;if(!Array.isArray(o))return c(o);if(o.length===1)return c(o[0]);if(o.every(function(_t){return typeof _t=="string"})&&$!==void 0)return o.some(function(_t){return c(_t)});throw Error("invalid valueTypes")}},{key:"from",value:function(e){e=D.fromValue(e);for(var o=0,c=0,_=Array.from(this.fields);c<_.length;c++){var $=Lb(_[c],2)[1],_t=$.len,ga=D.fromNumber(Math.pow(2,_t)-1,!0).shiftLeft(o);ak($,ga=e.and(ga).shiftRightUnsigned(o)),$.val=ga,o+=_t}}},{key:"typeOf",value:function(e){if((e=this.fields.get(e))!==void 0){var o=e.oneof;if(e=e.val,o!==void 0){var c=0;for(o=Object.entries(o);c<o.length;c++){var _=Lb(o[c],2),$=_[0];if(Zj(e,_[1]))return $}}}throw new TypeError("can only get type of oneof type")}}]),i}(),Pz=function(i){function e(c){ab(this,e);var _=o.call(this);return _.define("Rejoin","boolean",1),_.define("Unused","number",31),_.define("Platform","number",8),_.define("Version","number",12),_.define("Subversion","number",12),_.set("Platform",7),_.set("Version",7),_.set("Subversion",228),_.set("Rejoin",c),_}nb(e,i);var o=ob(e);return e}(Oz),LO=tb(tb({},{PeerTextMessage:0,ChannelTextMessage:1,VendorTextMessage:2}),{PeerRawMessage:3,ChannelRawMessage:4,VendorRawMessage:5}),Qz={CallInvite:101,CallAccept:102,CallReject:103,CallCancel:104},MO=tb(tb({},LO),Qz),NO={Uncompressed:0,Zlib:1},Yh=function(i){function e(c){ab(this,e);var _=o.call(this);if(_.define("MessageType",MO,8),_.define("BroadcastJumps","number",2),_.define("ToCache","boolean",1),_.define("FromCache","boolean",1),_.define("CompressionMethod",NO,2),_.define("IterationNumber","number",4),_.define("BufferedMessage","boolean",1),_.define("ToArchive","boolean",1),_.define("FromArchive","boolean",1),typeof c=="number"||D.isLong(c))_.from(c);else if(c!==void 0){var $=0;for(c=Vj(c);$<c.length;$++){var _t=Lb(c[$],2);_.set(_t[0],_t[1])}}return _}nb(e,i);var o=ob(e);return Qb(e,[{key:"isTextMessage",value:function(){return this.assert("MessageType",["PeerTextMessage","ChannelTextMessage","VendorTextMessage"])}},{key:"isRawMessage",value:function(){return this.assert("MessageType",["ChannelRawMessage","PeerRawMessage","VendorRawMessage"])}},{key:"isRawPeerMessage",value:function(){return this.assert("MessageType","PeerRawMessage")}},{key:"isRawChannelMessage",value:function(){return this.assert("MessageType","ChannelRawMessage")}},{key:"isPeerTextMessage",value:function(){return this.assert("MessageType","PeerTextMessage")}},{key:"isChannelTextMessage",value:function(){return this.assert("MessageType","ChannelTextMessage")}},{key:"isInvitation",value:function(c){var _=this;return c!==void 0?this.assert("MessageType",c):vi(Qz).some(function($){return _.assert("MessageType",$)})}},{key:"isPeerMessage",value:function(){return this.assert("MessageType",["PeerTextMessage","PeerRawMessage"])}},{key:"isZlibCompressed",value:function(){return this.assert("CompressionMethod","Zlib")}},{key:"isFromCache",value:function(){return this.assert("FromCache",!0)}},{key:"isBufferedMessage",value:function(){return this.assert("BufferedMessage",!0)}},{key:"getInvitationType",value:function(){if(!this.isInvitation())throw new TypeError("cannot get InvitationType of a normal message type");return this.typeOf("MessageType")}}]),e}(Oz),Fs=function(){function i(e){var o,c,_,$,_t;ab(this,i),E(this,"key",void 0),E(this,"value",void 0),E(this,"revision",void 0),E(this,"updateTs",void 0),E(this,"authorUserId",void 0),this.key=(o=e==null?void 0:e.key)!==null&&o!==void 0?o:"",this.value=(c=e==null?void 0:e.value)!==null&&c!==void 0?c:"",this.revision=(_=e==null?void 0:e.revision)!==null&&_!==void 0?_:-1,this.updateTs=($=e==null?void 0:e.updateTs)!==null&&$!==void 0?$:0,this.authorUserId=(_t=e==null?void 0:e.authorUserId)!==null&&_t!==void 0?_t:""}return Qb(i,[{key:"setKey",value:function(e){if(typeof e!="string")throw new Ib("Cannot set MetaDataItem key as ".concat(e));this.key=e,this.key=e}},{key:"getKey",value:function(){if(typeof this.key=="string")return this.key;throw new Ib("Cannot get MetaDataItem key")}},{key:"setValue",value:function(e){if(typeof e!="string"&&!Pd.isNull(null))throw new Ib("Cannot set MetaDataItem value as ".concat(e));this.value=e}},{key:"getValue",value:function(){if(typeof this.value=="string"||Pd.isNull(null))return this.value;throw new Ib("Cannot get MetaDataItem value")}},{key:"setRevision",value:function(e){if(typeof e!="number"||e%1!=0)throw new Ib("Cannot set MetaDataItem revision as ".concat(e));this.revision=e}},{key:"getRevision",value:function(){if(typeof this.revision=="number")return this.revision;throw new Ib("Cannot get MetaDataItem revision")}},{key:"getUpdateTs",value:function(){return this.updateTs}},{key:"getAuthorUserId",value:function(){return this.authorUserId}}]),i}(),Ge,bg;(function(i){i.STATE_REVISION_KEY_PREFIX="_rev_",i.STATE_TIMESTAMP_PREFIX="_t_",i.STATE_AUTHOR_PREFIX="_m_",i.STATE_REVISION="_rev",i.STATE_INTERNAL_PREFIX="_"})(Ge||(Ge={})),function(i){i[i.StateOk=0]="StateOk",i[i.DuplicatedOperation=1]="DuplicatedOperation",i[i.SyncServerError=2]="SyncServerError",i[i.ArgumentError=3]="ArgumentError",i[i.AuthicationError=4]="AuthicationError",i[i.ExceedLimitationError=5]="ExceedLimitationError",i[i.OutdateRevision=6]="OutdateRevision",i[i.LockAcquireFailed=7]="LockAcquireFailed",i[i.LockExpired=8]="LockExpired",i[i.LockWatching=9]="LockWatching",i[i.InvalidLock=10]="InvalidLock",i[i.TimeOutError=100]="TimeOutError",i[i.UnknownError=255]="UnknownError"}(bg||(bg={}));var OO=Math.max,PO=Math.min,Rz=function(i,e,o){return e=wq(e),o===void 0?(o=e,e=0):o=wq(o),(i=hl(i))>=PO(e,o)&&i<OO(e,o)},Wl=function(i){function e(c,_,$){return ab(this,e),E(L(_=o.call(this,_,"MessageReport")),"messagecount",_.getInitMessageCount()),E(L(_),"context",void 0),E(L(_),"rtmMessageCategory",void 0),E(L(_),"seq",D.fromNumber(1,!0)),_.context=c,_.rtmMessageCategory=$,_}nb(e,i);var o=ob(e);return Qb(e,[{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1)}},{key:"getInitMessageCount",value:function(){return{peerack10mscount:D.fromNumber(0),peerack25mscount:D.fromNumber(0),peerack50mscount:D.fromNumber(0),peerack75mscount:D.fromNumber(0),peerack100mscount:D.fromNumber(0),peerack150mscount:D.fromNumber(0),peerack200mscount:D.fromNumber(0),peerack250mscount:D.fromNumber(0),peerack300mscount:D.fromNumber(0),peerack400mscount:D.fromNumber(0),peerack500mscount:D.fromNumber(0),peerack600mscount:D.fromNumber(0),peerack800mscount:D.fromNumber(0),peerack1000mscount:D.fromNumber(0),peerack2000mscount:D.fromNumber(0),peerack3000mscount:D.fromNumber(0),peerack5000mscount:D.fromNumber(0),peerack7000mscount:D.fromNumber(0),peerackslowcount:D.fromNumber(0),norecipientack10mscount:D.fromNumber(0),norecipientack25mscount:D.fromNumber(0),norecipientack50mscount:D.fromNumber(0),norecipientack75mscount:D.fromNumber(0),norecipientack100mscount:D.fromNumber(0),norecipientack150mscount:D.fromNumber(0),norecipientack200mscount:D.fromNumber(0),norecipientack250mscount:D.fromNumber(0),norecipientack300mscount:D.fromNumber(0),norecipientack400mscount:D.fromNumber(0),norecipientack500mscount:D.fromNumber(0),norecipientack600mscount:D.fromNumber(0),norecipientack800mscount:D.fromNumber(0),norecipientack1000mscount:D.fromNumber(0),norecipientack2000mscount:D.fromNumber(0),norecipientack3000mscount:D.fromNumber(0),norecipientack5000mscount:D.fromNumber(0),norecipientack7000mscount:D.fromNumber(0),norecipientackslowcount:D.fromNumber(0),sentcount:D.fromNumber(0),receivedcount:D.fromNumber(0),acktimeoutcount:D.fromNumber(0),toooftencount:0,receiverofflinecount:0,invalidmessagecount:0,unknowerrorcount:0,servercachedcount:0,timeoutcount:0,successcount:0}}},{key:"updatePeerAckCount",value:function(c){c/=2;for(var _=[[0,10],[10,25],[25,50],[50,75],[75,100],[100,150],[150,200],[200,250],[250,300],[300,400],[400,500],[500,600],[600,800],[800,1e3],[1e3,2e3],[2e3,3e3],[3e3,5e3],[5e3,7e3]],$=0;$<_.length;$++){var _t,ga=_[$];if(Rz(c,ga[0],ga[1]))ga="peerack".concat(ga[1],"mscount"),this.messagecount[ga]=(_t=this.messagecount[ga])===null||_t===void 0?void 0:_t.add(1);else if(7e3<c){var _s;this.messagecount.peerackslowcount=(_s=this.messagecount.peerackslowcount)===null||_s===void 0?void 0:_s.add(1)}}}},{key:"updateNorecipientackCount",value:function(c){c/=2;for(var _=[[0,10],[10,25],[25,50],[50,75],[75,100],[100,150],[150,200],[200,250],[250,300],[300,400],[400,500],[500,600],[600,800],[800,1e3],[1e3,2e3],[2e3,3e3],[3e3,5e3],[5e3,7e3]],$=0;$<_.length;$++){var _t,ga=_[$];if(Rz(c,ga[0],ga[1]))ga="norecipientack".concat(ga[1],"mscount"),this.messagecount[ga]=(_t=this.messagecount[ga])===null||_t===void 0?void 0:_t.add(1);else if(7e3<c){var _s;this.messagecount.norecipientackslowcount=(_s=this.messagecount.norecipientackslowcount)===null||_s===void 0?void 0:_s.add(1)}}}},{key:"updateCommonCount",value:function(c){var _=this.messagecount[c];D.isLong(_)?this.messagecount[c]=_.add(1):this.messagecount[c]=_+1}},{key:"report",value:function(){var c,_;$a("RtmSdkMessageCount",new Bx(tb(tb({},this.messagecount),{},{vid:D.fromString((c=this.context.vid)!==null&&c!==void 0?c:"0"),os:7,lts:D.fromNumber(Date.now()),sid:this.context.sid,reportsequence:this.incGetSeq(),apimajorversion:7,apiminorversion:228,userid:this.context.uid,messagecategory:this.rtmMessageCategory})),(_=this.context.config.enableCloudProxy)!==null&&_!==void 0&&_),this.messagecount=tb(tb({},this.messagecount),{},{toooftencount:0,receiverofflinecount:0,invalidmessagecount:0,unknowerrorcount:0,servercachedcount:0,timeoutcount:0,successcount:0})}}]),e}(Dd()),QO=function(i){function e(c){return ab(this,e),E(L(c=o.call(this,c,"ChatManager")),"dialogueLru",new kG(void 0,{maxlen:1e4,ttl:1e4})),c}nb(e,i);var o=ob(e);return Qb(e,[{key:"getChatInfo",value:function(c){var _=this.dialogueLru.get(c);if(this.dialogueLru.prune(),_){var $=_.dialogue,_t={dialogue:$,sequence:_=_.sequence.add(1)};return this.dialogueLru.set(c,{dialogue:$,sequence:_}),_t}return $={dialogue:Rj(),sequence:D.fromNumber(1,!0)},this.dialogueLru.set(c,$),$}}]),e}(Dd()),X={};Ia(module)=="object"&&(module.exports=X),X.parse=function(i,e){var o,c=X.bin.readUshort,_=X.bin.readUint,$={};for(o=(i=new Uint8Array(i)).length-4;_(i,o)!=101010256;)o--;var _t=c(i,o=o+4+4);c(i,o+=2),_(i,o+=2),o=_(i,o+=4);for(var ga=0;ga<_t;ga++){_(i,o),o+=4,o+=4,o+=4,_(i,o+=4);var _s=_(i,o+=4),_c=_(i,o+=4),_l=c(i,o+=4),Tl=c(i,o+2),Cl=c(i,o+4);o+=6;var Pl=_(i,o+=8);o+=4,o+=_l+Tl+Cl,X._readLocal(i,Pl,$,_s,_c,e)}return $},X._readLocal=function(i,e,o,c,_,$){var _t=X.bin.readUshort,ga=X.bin.readUint;ga(i,e),_t(i,e+=4),_t(i,e+=2);var _s=_t(i,e+=2);ga(i,e+=2),ga(i,e+=4),ga=_t(i,e=e+4+8);var _c=_t(i,e+=2);if(e+=2,_t=X.bin.readUTF8(i,e,ga),e=e+ga+_c,$)o[_t]={size:_,csize:c};else if(i=new Uint8Array(i.buffer,e),_s==0)o[_t]=new Uint8Array(i.buffer.slice(e,e+c));else{if(_s!=8)throw"unknown compression method: "+_s;e=new Uint8Array(_),X.inflateRaw(i,e),o[_t]=e}},X.inflateRaw=function(i,e){return X.F.inflate(i,e)},X.inflate=function(i,e){return i[0],i[1],X.inflateRaw(new Uint8Array(i.buffer,i.byteOffset+2,i.length-2),e)},X.deflate=function(i,e){e==null&&(e={level:6});var o=0,c=new Uint8Array(50+Math.floor(1.1*i.length));return c[o]=120,c[o+1]=156,o=X.F.deflateRaw(i,c,o+2,e.level),i=X.adler(i,0,i.length),c[o+0]=i>>>24&255,c[o+1]=i>>>16&255,c[o+2]=i>>>8&255,c[o+3]=i>>>0&255,new Uint8Array(c.buffer,0,o+4)},X.deflateRaw=function(i,e){e==null&&(e={level:6});var o=new Uint8Array(50+Math.floor(1.1*i.length)),c=X.F.deflateRaw(i,o,c,e.level);return new Uint8Array(o.buffer,0,c)},X.encode=function(i,e){e==null&&(e=!1);var o,c=0,_=X.bin.writeUint,$=X.bin.writeUshort,_t={};for(o in i){var ga=!X._noNeed(o)&&!e,_s=i[o],_c=X.crc.crc(_s,0,_s.length);_t[o]={cpr:ga,usize:_s.length,crc:_c,file:ga?X.deflateRaw(_s):_s}}for(o in _t)c+=_t[o].file.length+30+46+2*X.bin.sizeUTF8(o);for(o in i=new Uint8Array(c+22),e=0,_s=[],_t)_c=_t[o],_s.push(e),e=X._writeHeader(i,e,o,_c,0);for(o in c=0,ga=e,_t)_c=_t[o],_s.push(e),e=X._writeHeader(i,e,o,_c,1,_s[c++]);return _t=e-ga,_(i,e,101010256),$(i,e=e+4+4,c),$(i,e+=2,c),_(i,e+=2,_t),_(i,e+4,ga),i.buffer},X._noNeed=function(i){return i=i.split(".").pop().toLowerCase(),"png,jpg,jpeg,zip".indexOf(i)!=-1},X._writeHeader=function(i,e,o,c,_,$){var _t=X.bin.writeUint,ga=X.bin.writeUshort,_s=c.file;return _t(i,e,_==0?67324752:33639248),e+=4,_==1&&(e+=2),ga(i,e,20),ga(i,e+=2,0),ga(i,e+=2,c.cpr?8:0),_t(i,e+=2,0),_t(i,e+=4,c.crc),_t(i,e+=4,_s.length),_t(i,e+=4,c.usize),ga(i,e+=4,X.bin.sizeUTF8(o)),ga(i,e+=2,0),e+=2,_==1&&(_t(i,e=e+2+2+6,$),e+=4),e+=o=X.bin.writeUTF8(i,e,o),_==0&&(i.set(_s,e),e+=_s.length),e},X.crc={table:function(){for(var i=new Uint32Array(256),e=0;256>e;e++){for(var o=e,c=0;8>c;c++)o=1&o?3988292384^o>>>1:o>>>1;i[e]=o}return i}(),update:function(i,e,o,c){for(var _=0;_<c;_++)i=X.crc.table[255&(i^e[o+_])]^i>>>8;return i},crc:function(i,e,o){return 4294967295^X.crc.update(4294967295,i,e,o)}},X.adler=function(i,e,o){var c=1,_=0,$=e;for(e+=o;$<e;){for(o=Math.min($+5552,e);$<o;)_+=c+=i[$++];c%=65521,_%=65521}return _<<16|c},X.bin={readUshort:function(i,e){return i[e]|i[e+1]<<8},writeUshort:function(i,e,o){i[e]=255&o,i[e+1]=o>>8&255},readUint:function(i,e){return 16777216*i[e+3]+(i[e+2]<<16|i[e+1]<<8|i[e])},writeUint:function(i,e,o){i[e]=255&o,i[e+1]=o>>8&255,i[e+2]=o>>16&255,i[e+3]=o>>24&255},readASCII:function(i,e,o){for(var c="",_=0;_<o;_++)c+=String.fromCharCode(i[e+_]);return c},writeASCII:function(i,e,o){for(var c=0;c<o.length;c++)i[e+c]=o.charCodeAt(c)},pad:function(i){return 2>i.length?"0"+i:i},readUTF8:function(i,e,o){for(var c,_="",$=0;$<o;$++)_+="%"+X.bin.pad(i[e+$].toString(16));try{c=decodeURIComponent(_)}catch{return X.bin.readASCII(i,e,o)}return c},writeUTF8:function(i,e,o){for(var c=o.length,_=0,$=0;$<c;$++){var _t=o.charCodeAt($);if(!(4294967168&_t))i[e+_]=_t,_++;else if(!(4294965248&_t))i[e+_]=192|_t>>6,i[e+_+1]=128|_t>>0&63,_+=2;else if(!(4294901760&_t))i[e+_]=224|_t>>12,i[e+_+1]=128|_t>>6&63,i[e+_+2]=128|_t>>0&63,_+=3;else{if(4292870144&_t)throw"e";i[e+_]=240|_t>>18,i[e+_+1]=128|_t>>12&63,i[e+_+2]=128|_t>>6&63,i[e+_+3]=128|_t>>0&63,_+=4}}return _},sizeUTF8:function(i){for(var e=i.length,o=0,c=0;c<e;c++){var _=i.charCodeAt(c);if(!(4294967168&_))o++;else if(!(4294965248&_))o+=2;else if(!(4294901760&_))o+=3;else{if(4292870144&_)throw"e";o+=4}}return o}},X.F={},X.F.deflateRaw=function(i,e,o,c){var _=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][c],$=X.F.U,_t=X.F._goodIndex;X.F._hash;var ga=X.F._putsE,_s=0;o<<=3;var _c=0,_l=i.length;if(c==0){for(;_s<_l;){var Tl=Math.min(65535,_l-_s);ga(e,o,_s+Tl==_l?1:0),o=X.F._copyExact(i,_s,Tl,e,o+8),_s+=Tl}return o>>>3}ga=$.lits,c=$.strt;var Cl=$.prev,Pl=0,Dl=0,Jl=0,zl=0,Bl=0;for(2<_l&&(c[Bl=X.F._hash(i,0)]=0),_s=0;_s<_l;_s++){if(Tl=Bl,_s+1<_l-2){Bl=X.F._hash(i,_s+1);var Vl=_s+1&32767;Cl[Vl]=c[Bl],c[Bl]=Vl}if(_c<=_s){if((14e3<Pl||26697<Dl)&&100<_l-_s&&(_c<_s&&(ga[Pl]=_s-_c,Pl+=2,_c=_s),o=X.F._writeBlock(_s==_l-1||_c==_l?1:0,ga,Pl,zl,i,Jl,_s-Jl,e,o),Pl=Dl=zl=0,Jl=_s),Vl=0,_s<_l-2&&(Vl=X.F._bestMatch(i,_s,Cl,Tl,Math.min(_[2],_l-_s),_[3])),Vl!=0){Tl=Vl>>>16,Vl&=65535;var _d=_t(Tl,$.of0);$.lhst[257+_d]++;var Sp=_t(Vl,$.df0);$.dhst[Sp]++,zl+=$.exb[_d]+$.dxb[Sp],ga[Pl]=Tl<<23|_s-_c,ga[Pl+1]=Vl<<16|_d<<8|Sp,Pl+=2,_c=_s+Tl}else $.lhst[i[_s]]++;Dl++}}for(Jl==_s&&i.length!=0||(_c<_s&&(ga[Pl]=_s-_c,Pl+=2),o=X.F._writeBlock(1,ga,Pl,zl,i,Jl,_s-Jl,e,o));7&o;)o++;return o>>>3},X.F._bestMatch=function(i,e,o,c,_,$){var _t=32767&e,ga=o[_t],_s=_t-ga+32768&32767;if(ga==_t||c!=X.F._hash(i,e-_s))return 0;for(var _c=c=0,_l=Math.min(32767,e);_s<=_l&&--$!=0&&ga!=_t;){if((c==0||i[e+c]==i[e+c-_s])&&(_t=X.F._howLong(i,e,_s))>c){if(_c=_s,(c=_t)>=_)break;_s+2<_t&&(_t=_s+2);for(var Tl=0,Cl=0;Cl<_t-2;Cl++){var Pl=e-_s+Cl+32768&32767,Dl=Pl-o[Pl]+32768&32767;Dl>Tl&&(Tl=Dl,ga=Pl)}}_s+=(_t=ga)-(ga=o[_t])+32768&32767}return c<<16|_c},X.F._howLong=function(i,e,o){if(i[e]!=i[e-o]||i[e+1]!=i[e+1-o]||i[e+2]!=i[e+2-o])return 0;var c=e,_=Math.min(i.length,e+258);for(e+=3;e<_&&i[e]==i[e-o];)e++;return e-c},X.F._hash=function(i,e){return(i[e]<<8|i[e+1])+(i[e+2]<<4)&65535},X.saved=0,X.F._writeBlock=function(i,e,o,c,_,$,_t,ga,_s){var _c=X.F.U,_l=X.F._putsF,Tl=X.F._putsE;_c.lhst[256]++;var Cl=X.F.getTrees(),Pl=Cl[0],Dl=Cl[1],Jl=Cl[2],zl=Cl[3],Bl=Cl[4],Vl=Cl[5],_d=Cl[6];Cl=Cl[7];var Sp=32+(_s+3&7?8-(_s+3&7):0)+(_t<<3),Up=c+X.F.contSize(_c.fltree,_c.lhst)+X.F.contSize(_c.fdtree,_c.dhst);c=c+X.F.contSize(_c.ltree,_c.lhst)+X.F.contSize(_c.dtree,_c.dhst),c+=14+3*Vl+X.F.contSize(_c.itree,_c.ihst)+(2*_c.ihst[16]+3*_c.ihst[17]+7*_c.ihst[18]);for(var Kp=0;286>Kp;Kp++)_c.lhst[Kp]=0;for(Kp=0;30>Kp;Kp++)_c.dhst[Kp]=0;for(Kp=0;19>Kp;Kp++)_c.ihst[Kp]=0;if(Sp=Sp<Up&&Sp<c?0:Up<c?1:2,_l(ga,_s,i),_l(ga,_s+1,Sp),_s+=3,Sp==0){for(;7&_s;)_s++;_s=X.F._copyExact(_,$,_t,ga,_s)}else{if(Sp==1)var Hp=_c.fltree,_m=_c.fdtree;if(Sp==2){for(X.F.makeCodes(_c.ltree,Pl),X.F.revCodes(_c.ltree,Pl),X.F.makeCodes(_c.dtree,Dl),X.F.revCodes(_c.dtree,Dl),X.F.makeCodes(_c.itree,Jl),X.F.revCodes(_c.itree,Jl),Hp=_c.ltree,_m=_c.dtree,Tl(ga,_s,zl-257),Tl(ga,_s+=5,Bl-1),Tl(ga,_s+=5,Vl-4),_s+=4,i=0;i<Vl;i++)Tl(ga,_s+3*i,_c.itree[1+(_c.ordr[i]<<1)]);_s=X.F._codeTiny(_d,_c.itree,ga,_s+3*Vl),_s=X.F._codeTiny(Cl,_c.itree,ga,_s)}for(Vl=0;Vl<o;Vl+=2){for(_d=(i=e[Vl])>>>23,i=$+(8388607&i);$<i;)_s=X.F._writeLit(_[$++],Hp,ga,_s);_d!=0&&(i=(Pl=e[Vl+1])>>16,_t=Pl>>8&255,Pl&=255,Tl(ga,_s=X.F._writeLit(257+_t,Hp,ga,_s),_d-_c.of0[_t]),_s+=_c.exb[_t],_l(ga,_s=X.F._writeLit(Pl,_m,ga,_s),i-_c.df0[Pl]),_s+=_c.dxb[Pl],$+=_d)}_s=X.F._writeLit(256,Hp,ga,_s)}return _s},X.F._copyExact=function(i,e,o,c,_){var $=_>>>3;return c[$]=o,c[$+1]=o>>>8,c[$+2]=255-c[$],c[$+3]=255-c[$+1],$+=4,c.set(new Uint8Array(i.buffer,e,o),$),_+(o+4<<3)},X.F.getTrees=function(){for(var i=X.F.U,e=X.F._hufTree(i.lhst,i.ltree,15),o=X.F._hufTree(i.dhst,i.dtree,15),c=[],_=X.F._lenCodes(i.ltree,c),$=[],_t=X.F._lenCodes(i.dtree,$),ga=0;ga<c.length;ga+=2)i.ihst[c[ga]]++;for(ga=0;ga<$.length;ga+=2)i.ihst[$[ga]]++;ga=X.F._hufTree(i.ihst,i.itree,7);for(var _s=19;4<_s&&i.itree[1+(i.ordr[_s-1]<<1)]==0;)_s--;return[e,o,ga,_,_t,_s,c,$]},X.F.getSecond=function(i){for(var e=[],o=0;o<i.length;o+=2)e.push(i[o+1]);return e},X.F.nonZero=function(i){for(var e="",o=0;o<i.length;o+=2)i[o+1]!=0&&(e+=(o>>1)+",");return e},X.F.contSize=function(i,e){for(var o=0,c=0;c<e.length;c++)o+=e[c]*i[1+(c<<1)];return o},X.F._codeTiny=function(i,e,o,c){for(var _=0;_<i.length;_+=2){var $=i[_],_t=i[_+1];c=X.F._writeLit($,e,o,c);var ga=$==16?2:$==17?3:7;15<$&&(X.F._putsE(o,c,_t,ga),c+=ga)}return c},X.F._lenCodes=function(i,e){for(var o=i.length;o!=2&&i[o-1]==0;)o-=2;for(var c=0;c<o;c+=2){var _=i[c+1],$=c+3<o?i[c+3]:-1,_t=c+5<o?i[c+5]:-1,ga=c==0?-1:i[c-1];if(_==0&&$==_&&_t==_){for($=c+5;$+2<o&&i[$+2]==_;)$+=2;11>(_=Math.min($+1-c>>>1,138))?e.push(17,_-3):e.push(18,_-11),c+=2*_-2}else if(_==ga&&$==_&&_t==_){for($=c+5;$+2<o&&i[$+2]==_;)$+=2;_=Math.min($+1-c>>>1,6),e.push(16,_-3),c+=2*_-2}else e.push(_,0)}return o>>>1},X.F._hufTree=function(i,e,o){var c=[],_=i.length,$=e.length,_t=0;for(_t=0;_t<$;_t+=2)e[_t]=0,e[_t+1]=0;for(_t=0;_t<_;_t++)i[_t]!=0&&c.push({lit:_t,f:i[_t]});if(i=c.length,_=c.slice(0),i==0)return 0;if(i==1)return e[1+((o=c[0].lit)<<1)]=1,e[1+((o==0?1:0)<<1)]=1;c.sort(function(_l,Tl){return _l.f-Tl.f}),_t=c[0],$=c[1];var ga=0,_s=1,_c=2;for(c[0]={lit:-1,f:_t.f+$.f,l:_t,r:$,d:0};_s!=i-1;)_t=ga!=_s&&(_c==i||c[ga].f<c[_c].f)?c[ga++]:c[_c++],$=ga!=_s&&(_c==i||c[ga].f<c[_c].f)?c[ga++]:c[_c++],c[_s++]={lit:-1,f:_t.f+$.f,l:_t,r:$};for((c=X.F.setDepth(c[_s-1],0))>o&&(X.F.restrictDepth(_,o,c),c=o),_t=0;_t<i;_t++)e[1+(_[_t].lit<<1)]=_[_t].d;return c},X.F.setDepth=function(i,e){return i.lit!=-1?i.d=e:Math.max(X.F.setDepth(i.l,e+1),X.F.setDepth(i.r,e+1))},X.F.restrictDepth=function(i,e,o){var c=0,_=1<<o-e,$=0;for(i.sort(function(ga,_s){return _s.d==ga.d?ga.f-_s.f:_s.d-ga.d}),c=0;c<i.length&&i[c].d>e;c++){var _t=i[c].d;i[c].d=e,$+=_-(1<<o-_t)}for($>>>=o-e;0<$;)(_t=i[c].d)<e?(i[c].d++,$-=1<<e-_t-1):c++;for(;0<=c;c--)i[c].d==e&&0>$&&(i[c].d--,$++);$!=0&&console.log("debt left")},X.F._goodIndex=function(i,e){var o=0;return e[16|o]<=i&&(o|=16),e[8|o]<=i&&(o|=8),e[4|o]<=i&&(o|=4),e[2|o]<=i&&(o|=2),e[1|o]<=i&&(o|=1),o},X.F._writeLit=function(i,e,o,c){return X.F._putsF(o,c,e[i<<1]),c+e[1+(i<<1)]},X.F.inflate=function(i,e){var o=Uint8Array;if(i[0]==3&&i[1]==0)return e||new o(0);var c=X.F,_=c._bitsF,$=c._bitsE,_t=c._decodeTiny,ga=c.makeCodes,_s=c.codes2map,_c=c._get17,_l=c.U,Tl=e==null;Tl&&(e=new o(i.length>>>2<<3));for(var Cl,Pl,Dl,Jl,zl=0,Bl=0,Vl=Pl=0,_d=0;zl==0;)if(zl=_(i,_d,1),Cl=_(i,_d+1,2),_d+=3,Cl==0)7&_d&&(_d+=8-(7&_d)),Cl=i[(_d=4+(_d>>>3))-4]|i[_d-3]<<8,Tl&&(e=X.F._check(e,Vl+Cl)),e.set(new o(i.buffer,i.byteOffset+_d,Cl),Vl),_d=_d+Cl<<3,Vl+=Cl;else{if(Tl&&(e=X.F._check(e,Vl+131072)),Cl==1&&(Dl=_l.flmap,Jl=_l.fdmap,Bl=511,Pl=31),Cl==2){for(Pl=$(i,_d,5)+257,Cl=$(i,_d+5,5)+1,Dl=$(i,_d+10,4)+4,_d+=14,Jl=0;38>Jl;Jl+=2)_l.itree[Jl]=0,_l.itree[Jl+1]=0;for(Bl=1,Jl=0;Jl<Dl;Jl++){var Sp=$(i,_d+3*Jl,3);_l.itree[1+(_l.ordr[Jl]<<1)]=Sp,Sp>Bl&&(Bl=Sp)}_d+=3*Dl,ga(_l.itree,Bl),_s(_l.itree,Bl,_l.imap),Dl=_l.lmap,Jl=_l.dmap,_d=_t(_l.imap,(1<<Bl)-1,Pl+Cl,i,_d,_l.ttree),Bl=(1<<(Sp=c._copyOut(_l.ttree,0,Pl,_l.ltree)))-1,Pl=(1<<(Cl=c._copyOut(_l.ttree,Pl,Cl,_l.dtree)))-1,ga(_l.ltree,Sp),_s(_l.ltree,Sp,Dl),ga(_l.dtree,Cl),_s(_l.dtree,Cl,Jl)}for(;;)if(_d+=15&(Cl=Dl[_c(i,_d)&Bl]),(Sp=Cl>>>4)>>>8==0)e[Vl++]=Sp;else{if(Sp==256)break;Cl=Vl+Sp-254,264<Sp&&(Cl=Vl+((Sp=_l.ldef[Sp-257])>>>3)+$(i,_d,7&Sp),_d+=7&Sp),_d+=15&(Sp=Jl[_c(i,_d)&Pl]);var Up=((Sp=_l.ddef[Sp>>>4])>>>4)+_(i,_d,15&Sp);for(_d+=15&Sp,Tl&&(e=X.F._check(e,Vl+131072));Vl<Cl;)e[Vl]=e[Vl++-Up],e[Vl]=e[Vl++-Up],e[Vl]=e[Vl++-Up],e[Vl]=e[Vl++-Up];Vl=Cl}}return e.length==Vl?e:e.slice(0,Vl)},X.F._check=function(i,e){var o=i.length;return e<=o?i:((e=new Uint8Array(Math.max(o<<1,e))).set(i,0),e)},X.F._decodeTiny=function(i,e,o,c,_,$){for(var _t=X.F._bitsE,ga=X.F._get17,_s=0;_s<o;){var _c=i[ga(c,_)&e];_+=15&_c;var _l=_c>>>4;if(15>=_l)$[_s]=_l,_s++;else{var Tl=_c=0;for(_l==16?(Tl=3+_t(c,_,2),_+=2,_c=$[_s-1]):_l==17?(Tl=3+_t(c,_,3),_+=3):_l==18&&(Tl=11+_t(c,_,7),_+=7),_l=_s+Tl;_s<_l;)$[_s]=_c,_s++}}return _},X.F._copyOut=function(i,e,o,c){for(var _=0,$=0,_t=c.length>>>1;$<o;){var ga=i[$+e];c[$<<1]=0,c[1+($<<1)]=ga,ga>_&&(_=ga),$++}for(;$<_t;)c[$<<1]=0,c[1+($<<1)]=0,$++;return _},X.F.makeCodes=function(i,e){var o,c,_=X.F.U,$=i.length,_t=_.bl_count;for(o=0;o<=e;o++)_t[o]=0;for(o=1;o<$;o+=2)_t[i[o]]++;for(_=_.next_code,o=0,_t[0]=0,c=1;c<=e;c++)o=o+_t[c-1]<<1,_[c]=o;for(e=0;e<$;e+=2)(_t=i[e+1])!=0&&(i[e]=_[_t],_[_t]++)},X.F.codes2map=function(i,e,o){for(var c=i.length,_=X.F.U.rev15,$=0;$<c;$+=2)if(i[$+1]!=0){var _t=i[$+1],ga=$>>1<<4|_t,_s=e-_t;for(_s=(_t=i[$]<<_s)+(1<<_s);_t!=_s;)o[_[_t]>>>15-e]=ga,_t++}},X.F.revCodes=function(i,e){for(var o=X.F.U.rev15,c=15-e,_=0;_<i.length;_+=2)i[_]=o[i[_]<<e-i[_+1]]>>>c},X.F._putsE=function(i,e,o){o<<=7&e,i[e>>>=3]|=o,i[e+1]|=o>>>8},X.F._putsF=function(i,e,o){o<<=7&e,i[e>>>=3]|=o,i[e+1]|=o>>>8,i[e+2]|=o>>>16},X.F._bitsE=function(i,e,o){return(i[e>>>3]|i[1+(e>>>3)]<<8)>>>(7&e)&(1<<o)-1},X.F._bitsF=function(i,e,o){return(i[e>>>3]|i[1+(e>>>3)]<<8|i[2+(e>>>3)]<<16)>>>(7&e)&(1<<o)-1},X.F._get17=function(i,e){return(i[e>>>3]|i[1+(e>>>3)]<<8|i[2+(e>>>3)]<<16)>>>(7&e)},X.F._get25=function(i,e){return(i[e>>>3]|i[1+(e>>>3)]<<8|i[2+(e>>>3)]<<16|i[3+(e>>>3)]<<24)>>>(7&e)},X.F.U=function(){var i=Uint16Array,e=Uint32Array;return{next_code:new i(16),bl_count:new i(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new i(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new e(32),flmap:new i(512),fltree:[],fdmap:new i(32),fdtree:[],lmap:new i(32768),ltree:[],ttree:[],dmap:new i(32768),dtree:[],imap:new i(512),itree:[],rev15:new i(32768),lhst:new e(286),dhst:new e(30),ihst:new e(19),lits:new e(15e3),strt:new i(65536),prev:new i(32768)}}(),function(){function i(_,$,_t){for(;$--!=0;)_.push(0,_t)}for(var e=X.F.U,o=0;32768>o;o++){var c=o;c=(4278255360&(c=(4042322160&(c=(3435973836&(c=(2863311530&c)>>>1|(1431655765&c)<<1))>>>2|(858993459&c)<<2))>>>4|(252645135&c)<<4))>>>8|(16711935&c)<<8,e.rev15[o]=(c>>>16|c<<16)>>>17}for(o=0;32>o;o++)e.ldef[o]=e.of0[o]<<3|e.exb[o],e.ddef[o]=e.df0[o]<<4|e.dxb[o];i(e.fltree,144,8),i(e.fltree,112,9),i(e.fltree,24,7),i(e.fltree,8,8),X.F.makeCodes(e.fltree,9),X.F.codes2map(e.fltree,9,e.flmap),X.F.revCodes(e.fltree,9),i(e.fdtree,32,5),X.F.makeCodes(e.fdtree,5),X.F.codes2map(e.fdtree,5,e.fdmap),X.F.revCodes(e.fdtree,5),i(e.itree,19,0),i(e.ltree,286,0),i(e.dtree,30,0),i(e.ttree,320,0)}();var RO=Array.isArray||function(i){return i&&typeof i.length=="number"},SO=Object.defineProperty({isArray:RO},"__esModule",{value:!0}),TO=Object.defineProperty({isObject:function(i){return i!==null&&Ia(i)==="object"}},"__esModule",{value:!0}),UO=Object.defineProperty({isFunction:function(i){return typeof i=="function"}},"__esModule",{value:!0}),VO=function(){function i(e){return Error.call(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(o,c){return c+1+") "+o.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e,this}return i.prototype=Object.create(Error.prototype),i}(),bk=Object.defineProperty({UnsubscriptionError:VO},"__esModule",{value:!0}),WO=function(){function i(o){this.closed=!1,this._subscriptions=this._parentOrParents=null,o&&(this._ctorUnsubscribe=!0,this._unsubscribe=o)}var e;return i.prototype.unsubscribe=function(){if(!this.closed){var o=this._parentOrParents,c=this._ctorUnsubscribe,_=this._unsubscribe,$=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,o instanceof i)o.remove(this);else if(o!==null)for(var _t=0;_t<o.length;++_t)o[_t].remove(this);if(UO.isFunction(_)){c&&(this._unsubscribe=void 0);try{_.call(this)}catch(_s){var ga=_s instanceof bk.UnsubscriptionError?Gs(_s.errors):[_s]}}if(SO.isArray($)){for(_t=-1,o=$.length;++_t<o;)if(c=$[_t],TO.isObject(c))try{c.unsubscribe()}catch(_s){ga=ga||[],_s instanceof bk.UnsubscriptionError?ga=ga.concat(Gs(_s.errors)):ga.push(_s)}}if(ga)throw new bk.UnsubscriptionError(ga)}},i.prototype.add=function(o){var c=o;if(!o)return i.EMPTY;switch(Ia(o)){case"function":c=new i(o);case"object":if(c===this||c.closed||typeof c.unsubscribe!="function")return c;if(this.closed)return c.unsubscribe(),c;c instanceof i||(o=c,(c=new i)._subscriptions=[o]);break;default:throw Error("unrecognized teardown "+o+" added to Subscription.")}if((o=c._parentOrParents)===null)c._parentOrParents=this;else if(o instanceof i){if(o===this)return c;c._parentOrParents=[o,this]}else{if(o.indexOf(this)!==-1)return c;o.push(this)}return(o=this._subscriptions)===null?this._subscriptions=[c]:o.push(c),c},i.prototype.remove=function(o){var c=this._subscriptions;c&&(o=c.indexOf(o))!==-1&&c.splice(o,1)},i.EMPTY=((e=new i).closed=!0,e),i}(),XO=Object.defineProperty({Subscription:WO},"__esModule",{value:!0}),YO=qb&&qb.__extends||function(){var i=function(e,o){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,_){c.__proto__=_}||function(c,_){for(var $ in _)_.hasOwnProperty($)&&(c[$]=_[$])})(e,o)};return function(e,o){function c(){this.constructor=e}i(e,o),e.prototype=o===null?Object.create(o):(c.prototype=o.prototype,new c)}}(),ZO=function(i){function e(o,c){return i.call(this)||this}return YO(e,i),e.prototype.schedule=function(o,c){return this},e}(XO.Subscription),$O=Object.defineProperty({Action:ZO},"__esModule",{value:!0}),aP=qb&&qb.__extends||function(){var i=function(e,o){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,_){c.__proto__=_}||function(c,_){for(var $ in _)_.hasOwnProperty($)&&(c[$]=_[$])})(e,o)};return function(e,o){function c(){this.constructor=e}i(e,o),e.prototype=o===null?Object.create(o):(c.prototype=o.prototype,new c)}}(),Sz=function(i){function e(o,c){var _=i.call(this,o,c)||this;return _.scheduler=o,_.work=c,_.pending=!1,_}return aP(e,i),e.prototype.schedule=function(o,c){if(c===void 0&&(c=0),this.closed)return this;this.state=o,o=this.id;var _=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(_,o,c)),this.pending=!0,this.delay=c,this.id=this.id||this.requestAsyncId(_,this.id,c),this},e.prototype.requestAsyncId=function(o,c,_){return _===void 0&&(_=0),setInterval(o.flush.bind(o,this),_)},e.prototype.recycleAsyncId=function(o,c,_){if(_===void 0&&(_=0),_!==null&&this.delay===_&&this.pending===!1)return c;clearInterval(c)},e.prototype.execute=function(o,c){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(o=this._execute(o,c))?o:void(this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},e.prototype._execute=function(o,c){c=!1;var _=void 0;try{this.work(o)}catch($){c=!0,_=!!$&&$||Error($)}if(c)return this.unsubscribe(),_},e.prototype._unsubscribe=function(){var o=this.id,c=this.scheduler,_=c.actions,$=_.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,$!==-1&&_.splice($,1),o!=null&&(this.id=this.recycleAsyncId(c,o,null)),this.delay=null},e}($O.Action),bP=function(){function i(e,o){o===void 0&&(o=i.now),this.SchedulerAction=e,this.now=o}return i.prototype.schedule=function(e,o,c){return o===void 0&&(o=0),new this.SchedulerAction(this,e).schedule(c,o)},i.now=function(){return Date.now()},i}(),Tz=Object.defineProperty({Scheduler:bP},"__esModule",{value:!0}),cP=qb&&qb.__extends||function(){var i=function(e,o){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,_){c.__proto__=_}||function(c,_){for(var $ in _)_.hasOwnProperty($)&&(c[$]=_[$])})(e,o)};return function(e,o){function c(){this.constructor=e}i(e,o),e.prototype=o===null?Object.create(o):(c.prototype=o.prototype,new c)}}(),Uz=function(i){function e(o,c){c===void 0&&(c=Tz.Scheduler.now);var _=i.call(this,o,function(){return e.delegate&&e.delegate!==_?e.delegate.now():c()})||this;return _.actions=[],_.active=!1,_.scheduled=void 0,_}return cP(e,i),e.prototype.schedule=function(o,c,_){return c===void 0&&(c=0),e.delegate&&e.delegate!==this?e.delegate.schedule(o,c,_):i.prototype.schedule.call(this,o,c,_)},e.prototype.flush=function(o){var c=this.actions;if(this.active)c.push(o);else{var _;this.active=!0;do if(_=o.execute(o.state,o.delay))break;while(o=c.shift());if(this.active=!1,_){for(;o=c.shift();)o.unsubscribe();throw _}}},e}(Tz.Scheduler),dP=mb("iterator"),xq=!Ga(function(){var i=new URL("b?a=1&b=2&c=3","http://a"),e=i.searchParams,o="";return i.pathname="c%20d",e.forEach(function(c,_){e.delete("b"),o+=_+c}),!e.sort||i.href!=="http://a/c%20d?a=1&c=3"||e.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!e[dP]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://").host!=="xn--e1aybc"||new URL("http://a#").hash!=="#%D0%B1"||o!=="a1c3"||new URL("http://x",void 0).host!=="x"}),eP=/[^\0-\u007E]/,fP=/[.\u3002\uFF0E\uFF61]/g,Zh=Math.floor,yq=String.fromCharCode,Vz=function(i){var e=Gi(i);if(typeof e!="function")throw TypeError(String(i)+" is not iterable");return ub(e.call(i))},Wz=me("fetch"),zq=me("Headers"),gP=mb("iterator"),Xz=Sb.set,od=Sb.getterFor("URLSearchParams"),hP=Sb.getterFor("URLSearchParamsIterator"),iP=/\+/g,Yz=Array(4),jP=function(i){try{return decodeURIComponent(i)}catch{return i}},Zz=function(i){var e=i.replace(iP," ");i=4;try{return decodeURIComponent(e)}catch{for(;i;){var o=e.replace,c=i--;c=Yz[c-1]||(Yz[c-1]=RegExp("((?:%[\\da-f]{2}){"+c+"})","gi")),e=o.call(e,c,jP)}return e}},$z=/[!'()~]|%20/g,kP={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},aA=function(i){return kP[i]},bA=function(i,e){if(e){e=e.split("&");for(var o,c=0;c<e.length;)(o=e[c++]).length&&(o=o.split("="),i.push({key:Zz(o.shift()),value:Zz(o.join("="))}))}},lP=function(i){this.entries.length=0,bA(this.entries,i)},$h=function(i,e){if(i<e)throw TypeError("Not enough arguments")},Aq=yt(function(i,e){Xz(this,{type:"URLSearchParamsIterator",iterator:Vz(od(i).entries),kind:e})},"Iterator",function(){var i=hP(this),e=i.kind,o=(i=i.iterator.next()).value;return i.done||(i.value=e==="keys"?o.key:e==="values"?o.value:[o.key,o.value]),i}),xj=function(){Ud(this,xj,"URLSearchParams");var i,e,o,c=0<arguments.length?arguments[0]:void 0,_=[];if(Xz(this,{type:"URLSearchParams",entries:_,updateURL:function(){},updateSearchParams:lP}),c!==void 0)if(fb(c)){var $=Gi(c);if(typeof $=="function")for(c=$.call(c),$=c.next;!(i=$.call(c)).done;){var _t=(i=Vz(ub(i.value))).next;if((e=_t.call(i)).done||(o=_t.call(i)).done||!_t.call(i).done)throw TypeError("Expected sequence with length 2");_.push({key:e.value+"",value:o.value+""})}else for(i in c)Fa(c,i)&&_.push({key:i,value:c[i]+""})}else bA(_,typeof c=="string"?c.charAt(0)==="?"?c.slice(1):c:c+"")},Xl=xj.prototype;qh(Xl,{append:function(i,e){$h(arguments.length,2);var o=od(this);o.entries.push({key:i+"",value:e+""}),o.updateURL()},delete:function(i){$h(arguments.length,1);for(var e=od(this),o=e.entries,c=i+"",_=0;_<o.length;)o[_].key===c?o.splice(_,1):_++;e.updateURL()},get:function(i){$h(arguments.length,1);for(var e=od(this).entries,o=i+"",c=0;c<e.length;c++)if(e[c].key===o)return e[c].value;return null},getAll:function(i){$h(arguments.length,1);for(var e=od(this).entries,o=i+"",c=[],_=0;_<e.length;_++)e[_].key===o&&c.push(e[_].value);return c},has:function(i){$h(arguments.length,1);for(var e=od(this).entries,o=i+"",c=0;c<e.length;)if(e[c++].key===o)return!0;return!1},set:function(i,e){$h(arguments.length,1);for(var o,c=od(this),_=c.entries,$=!1,_t=i+"",ga=e+"",_s=0;_s<_.length;_s++)(o=_[_s]).key===_t&&($?_.splice(_s--,1):($=!0,o.value=ga));$||_.push({key:_t,value:ga}),c.updateURL()},sort:function(){var i,e,o=od(this),c=o.entries,_=c.slice();for(e=c.length=0;e<_.length;e++){var $=_[e];for(i=0;i<e;i++)if(c[i].key>$.key){c.splice(i,0,$);break}i===e&&c.push($)}o.updateURL()},forEach:function(i){for(var e,o=od(this).entries,c=tf(i,1<arguments.length?arguments[1]:void 0,3),_=0;_<o.length;)c((e=o[_++]).value,e.key,this)},keys:function(){return new Aq(this,"keys")},values:function(){return new Aq(this,"values")},entries:function(){return new Aq(this,"entries")}},{enumerable:!0}),Ob(Xl,gP,Xl.entries),Ob(Xl,"toString",function(){for(var i,e=od(this).entries,o=[],c=0;c<e.length;)i=e[c++],o.push(encodeURIComponent(i.key).replace($z,aA)+"="+encodeURIComponent(i.value).replace($z,aA));return o.join("&")},{enumerable:!0}),Td(xj,"URLSearchParams"),wa({global:!0,forced:!xq},{URLSearchParams:xj}),xq||typeof Wz!="function"||typeof zq!="function"||wa({global:!0,enumerable:!0,forced:!0},{fetch:function(i){var e=[i];if(1<arguments.length){var o=arguments[1];if(fb(o)){var c=o.body;if(ph(c)==="URLSearchParams"){var _=o.headers?new zq(o.headers):new zq;_.has("content-type")||_.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),o=vd(o,{body:ke(0,String(c)),headers:ke(0,_)})}}e.push(o)}return Wz.apply(this,e)}});var yj=na.URL,mP=xj,nP=Sb.set,Tb=Sb.getterFor("URL"),oP=Math.floor,cA=Math.pow,dA=/[A-Za-z]/,pP=/[\d+-.A-Za-z]/,Bq=/\d/,qP=/^(0x|0X)/,rP=/^[0-7]+$/,sP=/^\d+$/,eA=/^[\dA-Fa-f]+$/,tP=/[\0\t\n\r #%/:?@[\\]]/,uP=/[\0\t\n\r #/:?@[\\]]/,vP=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,wP=/[\t\n\r]/g,Cq=function(i,e){var o;if(e.charAt(0)=="["){if(e.charAt(e.length-1)!="]")return"Invalid host";var c=xP(e.slice(1,-1));if(!c)return"Invalid host"}else if(rc(i)){for(c=[],e=e.toLowerCase().replace(fP,".").split("."),o=0;o<e.length;o++){var _=e[o],$=c,_t=$.push;if(eP.test(_)){var ga=_;_=[];var _s=ga;ga=[];for(var _c=0,_l=_s.length;_c<_l;){var Tl=_s.charCodeAt(_c++);if(55296<=Tl&&56319>=Tl&&_c<_l){var Cl=_s.charCodeAt(_c++);(64512&Cl)==56320?ga.push(((1023&Tl)<<10)+(1023&Cl)+65536):(ga.push(Tl),_c--)}else ga.push(Tl)}_c=ga.length,_l=128;var Pl=0,Dl=72;for(_s=0;_s<ga.length;_s++){var Jl=ga[_s];128>Jl&&_.push(yq(Jl))}for((Cl=Tl=_.length)&&_.push("-");Cl<_c;){var zl=2147483647;for(_s=0;_s<ga.length;_s++)(Jl=ga[_s])>=_l&&Jl<zl&&(zl=Jl);var Bl=Cl+1;if(zl-_l>Zh((2147483647-Pl)/Bl))throw RangeError("Overflow: input needs wider integers to process");for(Pl+=(zl-_l)*Bl,_l=zl,_s=0;_s<ga.length;_s++){if((Jl=ga[_s])<_l&&2147483647<++Pl)throw RangeError("Overflow: input needs wider integers to process");if(Jl==_l){var Vl=Pl;for(Jl=36;!(Vl<(zl=Jl<=Dl?1:Jl>=Dl+26?26:Jl-Dl));Jl+=36){var _d=36-zl,Sp=_;zl+=(Vl-=zl)%_d,Sp.push.call(Sp,yq(zl+22+75*(26>zl))),Vl=Zh(Vl/_d)}for(_.push(yq(Vl+22+75*(26>Vl))),Dl=Bl,Jl=0,Pl=Cl==Tl?Zh(Pl/700):Pl>>1,Pl+=Zh(Pl/Dl);455<Pl;Jl+=36)Pl=Zh(Pl/35);Dl=Zh(Jl+36*Pl/(Pl+38)),Pl=0,++Cl}}++Pl,++_l}_="xn--"+_.join("")}_t.call($,_)}if(e=c.join("."),tP.test(e)||(c=yP(e))===null)return"Invalid host"}else{if(uP.test(e))return"Invalid host";for(c="",e=hg(e),o=0;o<e.length;o++)c+=Qf(e[o],Yl)}i.host=c},yP=function(i){var e,o=i.split(".");o.length&&o[o.length-1]==""&&o.pop();var c=o.length;if(4<c)return i;var _=[];for(e=0;e<c;e++){var $=o[e];if($=="")return i;var _t=10;if(1<$.length&&$.charAt(0)=="0"&&(_t=qP.test($)?16:8,$=$.slice(_t==8?1:2)),$==="")$=0;else{if(!(_t==10?sP:_t==8?rP:eA).test($))return i;$=parseInt($,_t)}_.push($)}for(e=0;e<c;e++)if($=_[e],e==c-1){if($>=cA(256,5-c))return null}else if(255<$)return null;for(i=_.pop(),e=0;e<_.length;e++)i+=_[e]*cA(256,3-e);return i},xP=function(i){var e,o,c=[0,0,0,0,0,0,0,0],_=0,$=null,_t=0,ga=function(){return i.charAt(_t)};if(ga()==":"){if(i.charAt(1)!=":")return;_t+=2,$=++_}for(;ga();){if(_==8)return;if(ga()==":"){if($!==null)return;_t++,$=++_}else{for(e=o=0;4>o&&eA.test(ga());)e=16*e+parseInt(ga(),16),_t++,o++;if(ga()=="."){if(o==0||(_t-=o,6<_))return;for(e=0;ga();){if(o=null,0<e){if(!(ga()=="."&&4>e))return;_t++}if(!Bq.test(ga()))return;for(;Bq.test(ga());){var _s=parseInt(ga(),10);if(o===null)o=_s;else{if(o==0)return;o=10*o+_s}if(255<o)return;_t++}c[_]=256*c[_]+o,++e!=2&&e!=4||_++}if(e!=4)return;break}if(ga()==":"){if(_t++,!ga())return}else if(ga())return;c[_++]=e}}if($!==null)for(ga=_-$,_=7;_!=0&&0<ga;)e=c[_],c[_--]=c[$+ga-1],c[$+--ga]=e;else if(_!=8)return;return c},zj=function(i){var e,o;if(typeof i=="number"){var c=[];for(e=0;4>e;e++)c.unshift(i%256),i=oP(i/256);return c.join(".")}if(typeof i=="object"){c="",e=null;for(var _=1,$=null,_t=0,ga=0;8>ga;ga++)i[ga]!==0?(_t>_&&(e=$,_=_t),$=null,_t=0):($===null&&($=ga),++_t);for(_t>_&&(e=$),_=e,e=0;8>e;e++)o&&i[e]===0||(o&&(o=!1),_===e?(c+=e?":":"::",o=!0):(c+=i[e].toString(16),7>e&&(c+=":")));return"["+c+"]"}return i},Yl={},fA=Vi({},Yl,{" ":1,'"':1,"<":1,">":1,"`":1}),gA=Vi({},fA,{"#":1,"?":1,"{":1,"}":1}),Dq=Vi({},gA,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Qf=function(i,e){var o=fD(i,0);return 32<o&&127>o&&!Fa(e,i)?i:encodeURIComponent(i)},Zl={ftp:21,file:null,http:80,https:443,ws:80,wss:443},rc=function(i){return Fa(Zl,i.scheme)},Eq=function(i){return!i.host||i.cannotBeABaseURL||i.scheme=="file"},Aj=function(i,e){var o;return i.length==2&&dA.test(i.charAt(0))&&((o=i.charAt(1))==":"||!e&&o=="|")},hA=function(i){var e;return 1<i.length&&Aj(i.slice(0,2))&&(i.length==2||(e=i.charAt(2))==="/"||e==="\\"||e==="?"||e==="#")},iA=function(i){var e=i.path,o=e.length;!o||i.scheme=="file"&&o==1&&Aj(e[0],!0)||e.pop()},Fq={},jA={},Gq={},kA={},lA={},Hq={},mA={},nA={},$l={},am={},Iq={},Jq={},Kq={},Lq={},oA={},Mq={},Bj={},ze={},pA={},Gg={},hf={},Ae=function(i,e,o,c){var _=o||Fq,$=0,_t="",ga=!1,_s=!1,_c=!1;for(o||(i.scheme="",i.username="",i.password="",i.host=null,i.port=null,i.path=[],i.query=null,i.fragment=null,i.cannotBeABaseURL=!1,e=e.replace(vP,"")),e=e.replace(wP,""),e=hg(e);$<=e.length;){var _l=e[$];switch(_){case Fq:if(!_l||!dA.test(_l)){if(o)return"Invalid scheme";_=Gq;continue}_t+=_l.toLowerCase(),_=jA;break;case jA:if(_l&&(pP.test(_l)||_l=="+"||_l=="-"||_l=="."))_t+=_l.toLowerCase();else{if(_l!=":"){if(o)return"Invalid scheme";_t="",_=Gq,$=0;continue}if(o&&(rc(i)!=Fa(Zl,_t)||_t=="file"&&(i.username!=""||i.password!=""||i.port!==null)||i.scheme=="file"&&!i.host))return;if(i.scheme=_t,o)return void(rc(i)&&Zl[i.scheme]==i.port&&(i.port=null));_t="",i.scheme=="file"?_=Lq:rc(i)&&c&&c.scheme==i.scheme?_=kA:rc(i)?_=nA:e[$+1]=="/"?(_=lA,$++):(i.cannotBeABaseURL=!0,i.path.push(""),_=pA)}break;case Gq:if(!c||c.cannotBeABaseURL&&_l!="#")return"Invalid scheme";if(c.cannotBeABaseURL&&_l=="#"){i.scheme=c.scheme,i.path=c.path.slice(),i.query=c.query,i.fragment="",i.cannotBeABaseURL=!0,_=hf;break}_=c.scheme=="file"?Lq:Hq;continue;case kA:if(_l!="/"||e[$+1]!="/"){_=Hq;continue}_=$l,$++;break;case lA:if(_l=="/"){_=am;break}_=ze;continue;case Hq:if(i.scheme=c.scheme,_l==null)i.username=c.username,i.password=c.password,i.host=c.host,i.port=c.port,i.path=c.path.slice(),i.query=c.query;else if(_l=="/"||_l=="\\"&&rc(i))_=mA;else if(_l=="?")i.username=c.username,i.password=c.password,i.host=c.host,i.port=c.port,i.path=c.path.slice(),i.query="",_=Gg;else{if(_l!="#"){i.username=c.username,i.password=c.password,i.host=c.host,i.port=c.port,i.path=c.path.slice(),i.path.pop(),_=ze;continue}i.username=c.username,i.password=c.password,i.host=c.host,i.port=c.port,i.path=c.path.slice(),i.query=c.query,i.fragment="",_=hf}break;case mA:if(!rc(i)||_l!="/"&&_l!="\\"){if(_l!="/"){i.username=c.username,i.password=c.password,i.host=c.host,i.port=c.port,_=ze;continue}_=am}else _=$l;break;case nA:if(_=$l,_l!="/"||_t.charAt($+1)!="/")continue;$++;break;case $l:if(_l!="/"&&_l!="\\"){_=am;continue}break;case am:if(_l=="@"){for(ga&&(_t="%40"+_t),ga=!0,_t=hg(_t),_l=0;_l<_t.length;_l++){var Tl=_t[_l];Tl!=":"||_c?(Tl=Qf(Tl,Dq),_c?i.password+=Tl:i.username+=Tl):_c=!0}_t=""}else if(_l==null||_l=="/"||_l=="?"||_l=="#"||_l=="\\"&&rc(i)){if(ga&&_t=="")return"Invalid authority";$-=hg(_t).length+1,_t="",_=Iq}else _t+=_l;break;case Iq:case Jq:if(o&&i.scheme=="file"){_=Mq;continue}if(_l!=":"||_s){if(_l==null||_l=="/"||_l=="?"||_l=="#"||_l=="\\"&&rc(i)){if(rc(i)&&_t=="")return"Invalid host";if(o&&_t==""&&(i.username!=""||i.password!=""||i.port!==null))return;if(_=Cq(i,_t))return _;if(_t="",_=Bj,o)return;continue}_l=="["?_s=!0:_l=="]"&&(_s=!1),_t+=_l}else{if(_t=="")return"Invalid host";if(_=Cq(i,_t))return _;if(_t="",_=Kq,o==Jq)return}break;case Kq:if(!Bq.test(_l)){if(_l==null||_l=="/"||_l=="?"||_l=="#"||_l=="\\"&&rc(i)||o){if(_t!=""){if(65535<(_=parseInt(_t,10)))return"Invalid port";i.port=rc(i)&&_===Zl[i.scheme]?null:_,_t=""}if(o)return;_=Bj;continue}return"Invalid port"}_t+=_l;break;case Lq:if(i.scheme="file",_l=="/"||_l=="\\")_=oA;else{if(!c||c.scheme!="file"){_=ze;continue}if(_l==null)i.host=c.host,i.path=c.path.slice(),i.query=c.query;else if(_l=="?")i.host=c.host,i.path=c.path.slice(),i.query="",_=Gg;else{if(_l!="#"){hA(e.slice($).join(""))||(i.host=c.host,i.path=c.path.slice(),iA(i)),_=ze;continue}i.host=c.host,i.path=c.path.slice(),i.query=c.query,i.fragment="",_=hf}}break;case oA:if(_l=="/"||_l=="\\"){_=Mq;break}c&&c.scheme=="file"&&!hA(e.slice($).join(""))&&(Aj(c.path[0],!0)?i.path.push(c.path[0]):i.host=c.host),_=ze;continue;case Mq:if(_l==null||_l=="/"||_l=="\\"||_l=="?"||_l=="#"){if(!o&&Aj(_t))_=ze;else{if(_t==""){if(i.host="",o)return}else{if(_=Cq(i,_t))return _;if(i.host=="localhost"&&(i.host=""),o)return;_t=""}_=Bj}continue}_t+=_l;break;case Bj:if(rc(i)){if(_=ze,_l!="/"&&_l!="\\")continue}else if(o||_l!="?")if(o||_l!="#"){if(_l!=null&&(_=ze,_l!="/"))continue}else i.fragment="",_=hf;else i.query="",_=Gg;break;case ze:if(_l==null||_l=="/"||_l=="\\"&&rc(i)||!o&&(_l=="?"||_l=="#")){if((Tl=(Tl=_t).toLowerCase())===".."||Tl==="%2e."||Tl===".%2e"||Tl==="%2e%2e"?(iA(i),_l=="/"||_l=="\\"&&rc(i)||i.path.push("")):_t==="."||_t.toLowerCase()==="%2e"?_l=="/"||_l=="\\"&&rc(i)||i.path.push(""):(i.scheme=="file"&&!i.path.length&&Aj(_t)&&(i.host&&(i.host=""),_t=_t.charAt(0)+":"),i.path.push(_t)),_t="",i.scheme=="file"&&(_l==null||_l=="?"||_l=="#"))for(;1<i.path.length&&i.path[0]==="";)i.path.shift();_l=="?"?(i.query="",_=Gg):_l=="#"&&(i.fragment="",_=hf)}else _t+=Qf(_l,gA);break;case pA:_l=="?"?(i.query="",_=Gg):_l=="#"?(i.fragment="",_=hf):_l!=null&&(i.path[0]+=Qf(_l,Yl));break;case Gg:o||_l!="#"?_l!=null&&(_l=="'"&&rc(i)?i.query+="%27":i.query=_l=="#"?i.query+"%23":i.query+Qf(_l,Yl)):(i.fragment="",_=hf);break;case hf:_l!=null&&(i.fragment+=Qf(_l,fA))}$++}},Rf=function(i){var e=Ud(this,Rf,"URL"),o=1<arguments.length?arguments[1]:void 0,c=String(i),_=nP(e,{type:"URL"});if(o!==void 0){if(o instanceof Rf)var $=Tb(o);else if(o=Ae($={},String(o)))throw TypeError(o)}if(o=Ae(_,c,null,$))throw TypeError(o);var _t=_.searchParams=new mP;(c=od(_t)).updateSearchParams(_.query),c.updateURL=function(){_.query=String(_t)||null},cb||(e.href=bm.call(e),e.origin=qA.call(e),e.protocol=rA.call(e),e.username=sA.call(e),e.password=tA.call(e),e.host=uA.call(e),e.hostname=vA.call(e),e.port=wA.call(e),e.pathname=xA.call(e),e.search=yA.call(e),e.searchParams=zA.call(e),e.hash=AA.call(e))},Nq=Rf.prototype,bm=function(){var i=Tb(this),e=i.scheme,o=i.username,c=i.password,_=i.host,$=i.port,_t=i.path,ga=i.query,_s=i.fragment,_c=e+":";return _!==null?(_c+="//",i.username==""&&i.password==""||(_c+=o+(c?":"+c:"")+"@"),_c+=zj(_),$!==null&&(_c+=":"+$)):e=="file"&&(_c+="//"),_c+=i.cannotBeABaseURL?_t[0]:_t.length?"/"+_t.join("/"):"",ga!==null&&(_c+="?"+ga),_s!==null&&(_c+="#"+_s),_c},qA=function(){var i=Tb(this),e=i.scheme,o=i.port;if(e=="blob")try{return new Rf(e.path[0]).origin}catch{return"null"}return e!="file"&&rc(i)?e+"://"+zj(i.host)+(o!==null?":"+o:""):"null"},rA=function(){return Tb(this).scheme+":"},sA=function(){return Tb(this).username},tA=function(){return Tb(this).password},uA=function(){var i=Tb(this),e=i.host;return i=i.port,e===null?"":i===null?zj(e):zj(e)+":"+i},vA=function(){var i=Tb(this).host;return i===null?"":zj(i)},wA=function(){var i=Tb(this).port;return i===null?"":String(i)},xA=function(){var i=Tb(this),e=i.path;return i.cannotBeABaseURL?e[0]:e.length?"/"+e.join("/"):""},yA=function(){var i=Tb(this).query;return i?"?"+i:""},zA=function(){return Tb(this).searchParams},AA=function(){var i=Tb(this).fragment;return i?"#"+i:""},Kd=function(i,e){return{get:i,set:e,configurable:!0,enumerable:!0}};if(cb&&vt(Nq,{href:Kd(bm,function(i){var e=Tb(this);if(i=Ae(e,String(i)))throw TypeError(i);od(e.searchParams).updateSearchParams(e.query)}),origin:Kd(qA),protocol:Kd(rA,function(i){var e=Tb(this);Ae(e,String(i)+":",Fq)}),username:Kd(sA,function(i){var e=Tb(this);if(i=hg(String(i)),!Eq(e)){e.username="";for(var o=0;o<i.length;o++)e.username+=Qf(i[o],Dq)}}),password:Kd(tA,function(i){var e=Tb(this);if(i=hg(String(i)),!Eq(e)){e.password="";for(var o=0;o<i.length;o++)e.password+=Qf(i[o],Dq)}}),host:Kd(uA,function(i){var e=Tb(this);e.cannotBeABaseURL||Ae(e,String(i),Iq)}),hostname:Kd(vA,function(i){var e=Tb(this);e.cannotBeABaseURL||Ae(e,String(i),Jq)}),port:Kd(wA,function(i){var e=Tb(this);Eq(e)||((i=String(i))==""?e.port=null:Ae(e,i,Kq))}),pathname:Kd(xA,function(i){var e=Tb(this);e.cannotBeABaseURL||(e.path=[],Ae(e,i+"",Bj))}),search:Kd(yA,function(i){var e=Tb(this);(i=String(i))==""?e.query=null:(i.charAt(0)=="?"&&(i=i.slice(1)),e.query="",Ae(e,i,Gg)),od(e.searchParams).updateSearchParams(e.query)}),searchParams:Kd(zA),hash:Kd(AA,function(i){var e=Tb(this);(i=String(i))==""?e.fragment=null:(i.charAt(0)=="#"&&(i=i.slice(1)),e.fragment="",Ae(e,i,hf))})}),Ob(Nq,"toJSON",function(){return bm.call(this)},{enumerable:!0}),Ob(Nq,"toString",function(){return bm.call(this)},{enumerable:!0}),yj){var BA=yj.createObjectURL,CA=yj.revokeObjectURL;BA&&Ob(Rf,"createObjectURL",function(i){return BA.apply(yj,arguments)}),CA&&Ob(Rf,"revokeObjectURL",function(i){return CA.apply(yj,arguments)})}Td(Rf,"URL"),wa({global:!0,forced:!xq,sham:!cb},{URL:Rf});var zP=new Blob(["var fakeIdToId = {};onmessage = function (event) {	var data = event.data,		name = data.name,		fakeId = data.fakeId,		time;	if(data.hasOwnProperty('time')) {		time = data.time;	}	switch (name) {		case 'setInterval':			fakeIdToId[fakeId] = setInterval(function () {				postMessage({fakeId: fakeId});			}, time);			break;		case 'clearInterval':			if (fakeIdToId.hasOwnProperty (fakeId)) {				clearInterval(fakeIdToId[fakeId]);				delete fakeIdToId[fakeId];			}			break;	}}"]),AP=window.URL.createObjectURL(zP),gh={},xi=0,Xm=new Worker(AP);Xm.onmessage=function(i){if(i=i.data.fakeId,gh.hasOwnProperty(i)){var e=gh[i];i=e.callback,e=e.parameters,i.apply(window,e)}};var BP=function(i){function e(){return ab(this,e),o.apply(this,arguments)}nb(e,i);var o=ob(e);return Qb(e,[{key:"requestAsyncId",value:function(c,_){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;return BC(c.flush.bind(c,this),$)}},{key:"recycleAsyncId",value:function(c,_){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;if($!==null&&this.delay===$&&this.pending===!1)return _;gh.hasOwnProperty(_)&&(delete gh[_],Xm.postMessage({name:"clearInterval",fakeId:_}))}}]),e}(Sz),CP=new Uz(BP),DP=["group"],Oq=X.inflate,DA=X.deflate,Pq=function(i){function e(_,$,_t,ga){ab(this,e);var _s=c.call(this,ga,"Session");return E(L(_s),"lastNoticeTicket",""),E(L(_s),"chatManager",void 0),E(L(_s),"usedChannelIds",[]),E(L(_s),"lastUserMeteUpdateRecord",{}),E(L(_s),"lastChannelMetaUpdateRecord",{}),E(L(_s),"msgDedupLru",new ue(void 0,{maxlen:200})),E(L(_s),"startTime",Date.now()),E(L(_s),"seq",D.fromNumber(1,!0)),E(L(_s),"userJoinOptions",new Pz(!1)),E(L(_s),"seqSentStatuses",[!1,!1]),E(L(_s),"dialogueSequenceLru",new ue(void 0,{maxlen:1e4})),E(L(_s),"loggedOut",!1),E(L(_s),"messageSentTimes",[]),E(L(_s),"curLoginSockets",[void 0,void 0]),E(L(_s),"loginSocketSubs",[{channels:new Map,receivers:[]},{channels:new Map,receivers:[]}]),E(L(_s),"lastLoginSockets",[new ah(1),new ah(1)]),E(L(_s),"dialPendingMsgSubjectMap",new Map),E(L(_s),"context",void 0),E(L(_s),"connection",void 0),E(L(_s),"instanceId",void 0),E(L(_s),"lastPingTime",void 0),E(L(_s),"chanelStringMessageReport",void 0),E(L(_s),"chanelRawMessageReport",void 0),E(L(_s),"p2pSMsgNoOfflineReport",void 0),E(L(_s),"p2pRMsgNoOfflineReport",void 0),E(L(_s),"registerSocketsFailureListener",function(){_s.connection.once("socketsFailure",function(){_s.log("socketsFailure, creating a new connection"),lf(function(){return _s.connection.removeAllListeners(),_s.connection=new Gx(_s.context,_s.logger,!0),_s.loginHandler(15e3,!0)}).pipe(Zg(function(_c){return _c.pipe(mf(wg.getParameter("RECONNECTING_AP_INTERVAL")))}),he(_s.connection.apClient.apFinish$)).subscribe(function(){_s.log("new connection connected")})}),_s.connection.listenerCount("tokenExpired")===0&&_s.connection.on("tokenExpired",function(){_s.emit("tokenExpired")})}),_s.context=_,_s.context.startTime=_s.startTime,_s.connection=$,_s.instanceId=_t,_s.chatManager=new QO(ga),_s.lastPingTime=[0,0],_s.setMaxListeners(512),_s.log("The instanceId is %s",_s.instanceId.toString()),_s.chanelStringMessageReport=new Wl(_,ga,vb.ChannelSMsg),_s.chanelRawMessageReport=new Wl(_,ga,vb.ChannelRMsg),_s.p2pSMsgNoOfflineReport=new Wl(_,ga,vb.P2pSMsgNoOfflineFlag),_s.p2pRMsgNoOfflineReport=new Wl(_,ga,vb.P2pRMsgNoOfflineFlag),_s}nb(e,i);var o,c=ob(e);return Qb(e,[{key:"loginHandler",value:function(){var _=this,$=0<arguments.length&&arguments[0]!==void 0?arguments[0]:12e3,_t=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(this.loggedOut&&_t)throw new ia("Already logged out, request ignored");_t&&this.registerSocketsFailureListener(),this.connection.initConnection();var ga=this.getSocketLoginObservables(this.connection.lastOpenSockets,this.seq),_s=Date.now();return ga.forEach(function(_c,_l){var Tl=_.loginSocketSubs[_l].login;Tl!==void 0&&Tl.unsubscribe(),_.loginSocketSubs[_l].login=_c.pipe(Ka(function(Cl){var Pl;_.curLoginSockets[_l]=Cl;var Dl=Date.now();$a("Link",{ackedServerIp:Cl.address,destServerIp:Cl.ip,ec:0,sc:0,elapse:Nb(_.startTime),lts:D.fromNumber(Dl),responseTime:Dl-_s,sid:fc(_.instanceId),userId:_.context.uid},(Pl=_.context.config.enableCloudProxy)!==null&&Pl!==void 0&&Pl),_.emit("userJoined",Cl.env),_t&&_.connection.apClient.apFinish$.next(void 0)})).subscribe(_.lastLoginSockets[_l])}),this.initKeepAliveSender(),this.initKeepAliveReconnector(),this.initLoginReceiver(),Nc.apply(void 0,ra(ga).concat([Bc(this.connection,"connectionInitFailure").pipe(Ka(function(_c){throw Sa(_c)||uc(_c)?_c:new Pa("Login failure",{code:Ew,originalError:_c})}))])).pipe(Xb(1),Oc($),Rb(function(_c){return _c instanceof ad&&_.warn("Client login timeout"),_c&&_c.code===bl&&(_.connection.emit("tokenExpired"),_.connection.apClient.apFinish$.next(void 0)),_.clearSockets(0,_t),Va(_c)}),Ka(function(){_t||_.registerSocketsFailureListener()}),Mj(function(){_t||_.connection.apClient.apFinish$.next(void 0)}))}},{key:"logoutHandler",value:(o=za(W.mark(function _(){var $,_t,ga,_s,_c=this;return W.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:return this.loggedOut=!0,this.connection.apClient.apFinish$.next(void 0),$=this.incGetSeq(),_t=this.getLoginSockets(),ga=_t.map(function(Tl){var Cl,Pl;return Tl.sendPacket("StateUnsubscribe",{sequence:$,target:_c.context.uid,subTarget:"",flags:D.fromNumber(0)}),delete _c.lastUserMeteUpdateRecord[_c.context.sid],$a("SyncSubscribeEvent",{lts:D.fromNumber(Date.now()),userid:_c.context.uid,vid:(Cl=_c.context)!==null&&Cl!==void 0&&Cl.vid?D.fromString(_c.context.vid):D.fromNumber(0),sid:"",usersid:_c.context.sid,target:_c.context.uid,requestts:D.fromNumber(Date.now()),replyts:D.fromNumber(Date.now()),eventtype:"UnSubscribe",sdktype:3,flags:D.fromNumber(0),code:0,seq:$,index:{index1:_c.context.uid,index2:_c.context.appId,index3:"enableLogUpload=".concat(_c.context.config.enableLogUpload)},subtarget:_c.context.uid},(Pl=_c.context.config.enableCloudProxy)!==null&&Pl!==void 0&&Pl),Tl.sendPacket("UserQuit",{}),_c.connection.waitClosing(Tl)}),this.clearSockets(5e3),_s=_t.map(function(Tl){return Tl.env}),[0,1].filter(function(Tl){return!_s.includes(Tl)}).forEach(function(Tl){_c.connection.closeSocket(Tl,0)}),_l.abrupt("return",Nc.apply(void 0,ra(ga)).toPromise());case 10:case"end":return _l.stop()}},_,this)})),function(){return o.apply(this,arguments)})},{key:"requestChannelJoin",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c,_l=this;return W.wrap(function(Tl){for(;;)switch(Tl.prev=Tl.next){case 0:if(this.getLoginSockets().length!==0){Tl.next=2;break}throw new ia("Client is not logged in. Cannot join the channel",Aw);case 2:return ga=Bc(this,"channelLeft").pipe(sc(function(Cl){return _t===Cl}),Xb(1)),_s=this.incGetSeq(),(_c=this.lastLoginSockets.map(function(Cl){return Cl.pipe(Cc(function(Pl,Dl){Dl!==0&&_l.incSeqIfNeeded(Pl.env);var Jl=Dl===0?_s:_l.seq;return Pl.sendPacket("GroupEnter",{account:_t,seq:Jl}),Pl.fromReceived("GroupReply").pipe(La(function(zl){return Jl.eq(zl.seq)}),Ka(function(zl){if((zl=zl.code)!==0)throw new Pa(["Channel join failure. The response code is %d",zl],ww)}))}),he(ga),$g())})).forEach(function(Cl,Pl){var Dl=function(){return _l.loginSocketSubs[Pl].channels.delete(_t)};_l.loginSocketSubs[Pl].channels.set(_t,Cl.subscribe({error:Dl,complete:Dl}))}),Tl.next=8,Nc.apply(void 0,ra(_c)).pipe(Xb(1),Oc(1e4),Rb(function(Cl){return Cl instanceof ad&&_l.warn("Channel join timeout"),Va(Cl)})).toPromise();case 8:case"end":return Tl.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"requestChannelLeave",value:function(_){this.getLoginSockets().forEach(function($){$.sendPacket("GroupLeave",{account:_})})}},{key:"requestUpdateEdgeTicket",value:function(_){var $=this,_t=this.getLoginSockets();if(_t.length===0)throw new ia("Client is not logged in. Cannot renew token",Mw);var ga=this.incGetSeq();return _t.forEach(function(_s){_s.sendPacket("UserRenewTokenReq",{instance:$.instanceId,seq:ga,account:$.context.uid,ticket:_})}),bb.apply(void 0,[e.genTimeoutError(jp)].concat(ra(_t.map(function(_s){return _s.fromReceived("UserRenewTokenResp").pipe(La(function(_c){var _l=_c.code;return ga.eq(_c.seq)&&_l===0}))}))))}},{key:"requestChannelMemberList",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new ia("Client is not logged in. Cannot get the channel members",wI);var _t=this.incGetSeq();return $.forEach(function(ga){ga.sendPacket("GroupAllUsersList",{group:_,pageNumber:0,pageSize:200,seq:_t})}),bb.apply(void 0,[e.genTimeoutError(uw)].concat(ra($.map(function(ga){return ga.fromReceived("GroupAllUsersResult").pipe(La(function(_s){var _c=_s.seq;return _s.group===_&&_t.eq(_c)}))}))))}},{key:"requestPeersOnlineStatus",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new ia("Client is not logged in");var _t=this.incGetSeq();return $.forEach(function(ga){ga.sendPacket("UserStatusList",{users:_,seq:_t})}),bb.apply(void 0,[e.genTimeoutError(II)].concat(ra($.map(function(ga){return ga.fromReceived("UserStatusResult").pipe(La(function(_s){return _t.eq(_s.seq)}))}))))}},{key:"requestSetLocalUserAttributes",value:function(_,$){var _t=this,ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");var _s=this.incGetSeq();return ga.forEach(function(_c,_l){$!==void 0&&_l!==$||_c.sendPacket("UserAttributeSet",{account:_t.context.uid,attributeInfos:Object.entries(_).map(function(Tl){return{key:(Tl=Lb(Tl,2))[0],value:Tl[1]}}),seq:_s})}),bb.apply(void 0,ra(ga.map(function(_c){return _c.fromReceived("UserAttributeErr").pipe(La(function(_l){return _s.eq(_l.seq)}),Wa(function(_l){throw new Pa(["The user attributes set failure, code %d",_l.code],Ad)}))})).concat([e.genTimeoutError(Bd)],ra(ga.map(function(_c){return _c.fromReceived("UserAttributeRsp").pipe(La(function(_l){return _s.eq(_l.seq)}))}))))}},{key:"requestSetChannelAttributes",value:function(_,$,_t){var ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");var _s=this.incGetSeq();return ga.forEach(function(_c){_c.sendPacket("GroupAttributeSet",{broadcast:_t,group:_,attributeInfos:Object.entries($).map(function(_l){return{key:(_l=Lb(_l,2))[0],value:_l[1]}}),seq:_s})}),bb.apply(void 0,ra(ga.map(function(_c){return _c.fromReceived("GroupAttributeErr").pipe(La(function(_l){return _s.eq(_l.seq)}),Wa(function(_l){throw new Pa(["The group attributes set failure, code %d",_l.code],Ad)}))})).concat([e.genTimeoutError(Bd)],ra(ga.map(function(_c){return _c.fromReceived("GroupAttributeRsp").pipe(La(function(_l){return _s.eq(_l.seq)}))}))))}},{key:"requestAddOrUpdateLocalUserAttributes",value:function(_){var $=this,_t=this.getLoginSockets();if(_t.length===0)throw new ia("Client is not logged in");var ga=this.incGetSeq();return _t.forEach(function(_s){_s.sendPacket("UserAttributeMod",{account:$.context.uid,attributeInfos:Object.entries(_).map(function(_c){return{key:(_c=Lb(_c,2))[0],value:_c[1]}}),seq:ga})}),bb.apply(void 0,ra(_t.map(function(_s){return _s.fromReceived("UserAttributeErr").pipe(La(function(_c){return ga.eq(_c.seq)}),Wa(function(_c){throw new Pa(["The user attributes add or update failure, code %d",_c.code],Ad)}))})).concat([e.genTimeoutError(Bd)],ra(_t.map(function(_s){return _s.fromReceived("UserAttributeRsp").pipe(La(function(_c){return ga.eq(_c.seq)}))}))))}},{key:"requestAddOrUpdateChannelAttributes",value:function(_,$,_t){var ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");var _s=this.incGetSeq();return ga.forEach(function(_c){_c.sendPacket("GroupAttributeMod",{broadcast:_t,group:_,attributeInfos:Object.entries($).map(function(_l){return{key:(_l=Lb(_l,2))[0],value:_l[1]}}),seq:_s})}),bb.apply(void 0,ra(ga.map(function(_c){return _c.fromReceived("GroupAttributeErr").pipe(La(function(_l){return _s.eq(_l.seq)}),Wa(function(_l){throw new Pa(["The group attributes add or update failure, code %d",_l.code],Ad)}))})).concat([e.genTimeoutError(Bd)],ra(ga.map(function(_c){return _c.fromReceived("GroupAttributeRsp").pipe(La(function(_l){return _s.eq(_l.seq)}))}))))}},{key:"requestDeleteLocalUserAttributesByKeys",value:function(_){var $=this,_t=this.getLoginSockets();if(_t.length===0)throw new ia("Client is not logged in");var ga=this.incGetSeq();return _t.forEach(function(_s){_s.sendPacket("UserAttributeDel",{account:$.context.uid,attributes:_,seq:ga})}),bb.apply(void 0,ra(_t.map(function(_s){return _s.fromReceived("UserAttributeErr").pipe(La(function(_c){return ga.eq(_c.seq)}),Wa(function(_c){throw new Pa(["The user attributes delete failure, code %d",_c.code],Ad)}))})).concat([e.genTimeoutError(Bd)],ra(_t.map(function(_s){return _s.fromReceived("UserAttributeRsp").pipe(La(function(_c){return ga.eq(_c.seq)}))}))))}},{key:"requestGetChannelMetaData",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new ia("Client is not logged in. Cannot get the channel metadata",oc);if(this.context.lastGetMetaDataTime!==void 0&&250>Date.now()-this.context.lastGetMetaDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastGetMetaDataTime=Date.now();var _t=this.incGetSeq();return $.forEach(function(ga){ga.sendPacket("StateGet",{target:_,subTarget:"",lock:"",sequence:_t,flags:new D(1,0,!0),lockRev:D.fromNumber(0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra($.map(function(ga){return ga.fromReceived("StateGetResult").pipe(La(function(_s){return _t.eq(_s.sequence)}),Wa(function(_s){var _c=_s.code;if(_s=_s.allStates,ud(_c)!==bd)throw new Pa(["Get metaData failure. The response code from the RTM service is %d",_c],He);return _s}))}))))}},{key:"requestGetLocalMetaData",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new ia("Client is not logged in. Cannot get the local metaData",oc);if(this.context.lastGetMetaDataTime!==void 0&&250>Date.now()-this.context.lastGetMetaDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastGetMetaDataTime=Date.now();var _t=this.incGetSeq();return $.forEach(function(ga){ga.sendPacket("StateGet",{target:_,subTarget:"",lock:"",sequence:_t,flags:D.fromNumber(0),lockRev:D.fromNumber(0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra($.map(function(ga){return ga.fromReceived("StateGetResult").pipe(La(function(_s){return _t.eq(_s.sequence)}),Wa(function(_s){var _c=_s.code;if(_s=_s.allStates,ud(_c)!==bd)throw new Pa(["Get metaData failure. The response code from the RTM service is %d",_c],He);return _s}))}))))}},{key:"requestDeleteChannelAttributesByKeys",value:function(_,$,_t){var ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");var _s=this.incGetSeq();return ga.forEach(function(_c){_c.sendPacket("GroupAttributeDel",{group:_,broadcast:_t,attributes:$,seq:_s})}),bb.apply(void 0,ra(ga.map(function(_c){return _c.fromReceived("GroupAttributeErr").pipe(La(function(_l){return _s.eq(_l.seq)}),Wa(function(_l){throw new Pa(["The channel attributes delete failure, code %d",_l.code],Ad)}))})).concat([e.genTimeoutError(Bd)],ra(ga.map(function(_c){return _c.fromReceived("GroupAttributeRsp").pipe(La(function(_l){return _s.eq(_l.seq)}))}))))}},{key:"requestClearLocalUserAttributes",value:function(){var _=this,$=this.getLoginSockets();if($.length===0)throw new ia("Client is not logged in");var _t=this.incGetSeq();return $.forEach(function(ga){ga.sendPacket("UserAttributeSet",{account:_.context.uid,seq:_t,attributeInfos:[]})}),bb.apply(void 0,ra($.map(function(ga){return ga.fromReceived("UserAttributeErr").pipe(La(function(_s){return _t.eq(_s.seq)}),Wa(function(_s){throw new Pa(["The user attributes clear failure, code %d",_s.code],Ad)}))})).concat([e.genTimeoutError(Bd)],ra($.map(function(ga){return ga.fromReceived("UserAttributeRsp").pipe(La(function(_s){return _t.eq(_s.seq)}))}))))}},{key:"requestClearChannelAttributes",value:function(_,$){var _t=this.getLoginSockets();if(_t.length===0)throw new ia("Client is not logged in");var ga=this.incGetSeq();return _t.forEach(function(_s){_s.sendPacket("GroupAttributeSet",{group:_,seq:ga,attributeInfos:[],broadcast:$})}),bb.apply(void 0,ra(_t.map(function(_s){return _s.fromReceived("GroupAttributeErr").pipe(La(function(_c){return ga.eq(_c.seq)}),Wa(function(_c){throw new Pa(["The channel attributes clear failure, code %d",_c.code],Ad)}))})).concat([e.genTimeoutError(Bd)],ra(_t.map(function(_s){return _s.fromReceived("GroupAttributeRsp").pipe(La(function(_c){return ga.eq(_c.seq)}))}))))}},{key:"requestAddChannelMetadata",value:function(_){var $=this,_t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{majorRevision:-1,enableRecordTs:!1,enableRecordUserId:!1},ga=2<arguments.length?arguments[2]:void 0,_s=this.getLoginSockets();if(_s.length===0)throw new ia("Client is not logged in");if(_t.majorRevision&&(-1>_t.majorRevision||_t.majorRevision%1!=0))throw new ja("MajorRevision should be set to a value greater than  -1",Mb);if(nf({items:_,maxMetaDataCount:32,maxMetaValueSize:16384,type:"Add"}),this.context.lastModifyMeteDataTime!==void 0&&250>Date.now()-this.context.lastModifyMeteDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastModifyMeteDataTime=Date.now();var _c=this.incGetSeq(),_l=JSON.stringify(pf(Pd.cloneDeep(_).map(function(Cl){return Cl.setRevision(0),Cl}),_t.majorRevision)),Tl=Date.now();return _s.forEach(function(Cl){Cl.sendPacket("StateModify",{sequence:_c,target:ga,requestUuid:"".concat(_c,"_").concat($.instanceId),lock:"",lockRev:D.fromNumber(0),value:_l,baseRevision:D.fromNumber(0),author:_t.enableRecordUserId?$.context.uid:"",flags:_t.enableRecordTs?new D(524289,0,!0):new D(1,0,!0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra(_s.map(function(Cl){return Cl.fromReceived("StateRequestResult").pipe(La(function(Pl){return _c.eq(Pl.sequence)}),Wa(function(Pl){var Dl,Jl,zl=ud(Pl=Pl.code);if($a("SyncOperateEvent",{lts:D.fromNumber(Date.now()),userid:$.context.uid,vid:D.fromString((Dl=$.context.vid)!==null&&Dl!==void 0?Dl:"0"),sid:"",usersid:$.context.sid,requestts:D.fromNumber(Tl),replyts:D.fromNumber(Date.now()),target:ga,eventtype:"Add",revision:D.fromNumber(0),uuid:"".concat(_c,"_").concat($.instanceId),sdktype:3,flags:_t.enableRecordTs?new D(524289,0,!0):new D(1,0,!0),code:zl,seq:_c,index:{index1:ga,index2:$.context.appId,index3:"enableLogUpload=".concat($.context.config.enableLogUpload)},lock:"",lockrev:D.fromNumber(0),subtarget:$.context.uid},(Jl=$.context.config.enableCloudProxy)!==null&&Jl!==void 0&&Jl),zl!==bd)throw new Pa(["MetaData modify failure. The response code from the RTM service is %d",Pl],zl)}))}))))}},{key:"requestUpdateChannelMetadata",value:function(_){var $=this,_t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{majorRevision:-1,enableRecordTs:!1,enableRecordUserId:!1},ga=2<arguments.length?arguments[2]:void 0,_s=this.getLoginSockets();if(_s.length===0)throw new ia("Client is not logged in");if(_t.majorRevision&&(-1>_t.majorRevision||_t.majorRevision%1!=0))throw new ja("MajorRevision should be set to a value greater than  -1",Mb);if(_t.majorRevision===0)throw new ja("MajorRevision can not be set to 0",of);if(nf({items:_,maxMetaDataCount:32,maxMetaValueSize:16384,type:"Update"}),this.context.lastModifyMeteDataTime!==void 0&&250>Date.now()-this.context.lastModifyMeteDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastModifyMeteDataTime=Date.now();var _c=this.incGetSeq(),_l=JSON.stringify(pf(Pd.cloneDeep(_).map(function(Cl){return Cl.getRevision()===-1&&Cl.setRevision(-2),Cl}),_t.majorRevision)),Tl=Date.now();return _s.forEach(function(Cl){Cl.sendPacket("StateModify",{sequence:_c,target:ga,requestUuid:"".concat(_c,"_").concat($.instanceId),lock:"",lockRev:D.fromNumber(0),value:_l,baseRevision:D.fromNumber(0),author:_t.enableRecordUserId?$.context.uid:"",flags:_t.enableRecordTs?new D(524289,0,!0):new D(1,0,!0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra(_s.map(function(Cl){return Cl.fromReceived("StateRequestResult").pipe(La(function(Pl){return _c.eq(Pl.sequence)}),Wa(function(Pl){var Dl,Jl,zl=ud(Pl=Pl.code);if($a("SyncOperateEvent",{lts:D.fromNumber(Date.now()),userid:$.context.uid,vid:D.fromString((Dl=$.context.vid)!==null&&Dl!==void 0?Dl:"0"),sid:"",usersid:$.context.sid,requestts:D.fromNumber(Tl),replyts:D.fromNumber(Date.now()),target:ga,eventtype:"Update",revision:D.fromNumber(0),uuid:"".concat(_c,"_").concat($.instanceId),sdktype:3,flags:_t.enableRecordTs?new D(524289,0,!0):new D(1,0,!0),code:zl,seq:_c,index:{index1:$.context.uid,index2:$.context.appId,index3:"enableLogUpload=".concat($.context.config.enableLogUpload)},lock:"",lockrev:D.fromNumber(0),subtarget:$.context.uid},(Jl=$.context.config.enableCloudProxy)!==null&&Jl!==void 0&&Jl),zl!==bd)throw new Pa(["MetaData modify failure. The response code from the RTM service is %d",Pl],zl)}))}))))}},{key:"requestDeleteChannelMetadata",value:function(_){var $=this,_t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{majorRevision:-1,enableRecordTs:!1,enableRecordUserId:!1},ga=2<arguments.length?arguments[2]:void 0,_s=this.getLoginSockets();if(_s.length===0)throw new ia("Client is not logged in");if(_t.majorRevision&&(-1>_t.majorRevision||_t.majorRevision%1!=0))throw new ja("MajorRevision should be set to a value greater than  -1",Mb);if(_t.majorRevision===0)throw new ja("MajorRevision can not be set to 0",of);if(nf({items:_,maxMetaDataCount:32,maxMetaValueSize:16384,type:"Delete"}),this.context.lastModifyMeteDataTime!==void 0&&250>Date.now()-this.context.lastModifyMeteDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastModifyMeteDataTime=Date.now();var _c=this.incGetSeq(),_l=JSON.stringify(pf(Pd.cloneDeep(_).map(function(Cl){return Cl.setValue(null),Cl}),_t.majorRevision)),Tl=Date.now();return _s.forEach(function(Cl){Cl.sendPacket("StateModify",{sequence:_c,target:ga,requestUuid:"".concat(_c,"_").concat($.instanceId),lock:"",lockRev:D.fromNumber(0),value:_l,baseRevision:D.fromNumber(0),author:_t.enableRecordUserId?$.context.uid:"",flags:_t.enableRecordTs?new D(524289,0,!0):new D(1,0,!0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra(_s.map(function(Cl){return Cl.fromReceived("StateRequestResult").pipe(La(function(Pl){return _c.eq(Pl.sequence)}),Wa(function(Pl){var Dl,Jl,zl=ud(Pl=Pl.code);if($a("SyncOperateEvent",{lts:D.fromNumber(Date.now()),userid:$.context.uid,vid:D.fromString((Dl=$.context.vid)!==null&&Dl!==void 0?Dl:"0"),sid:"",usersid:$.context.sid,requestts:D.fromNumber(Tl),replyts:D.fromNumber(Date.now()),target:ga,eventtype:"Delete",revision:D.fromNumber(0),uuid:"".concat(_c,"_").concat($.instanceId),sdktype:3,flags:_t.enableRecordTs?new D(524289,0,!0):new D(1,0,!0),code:zl,seq:_c,index:{index1:$.context.uid,index2:$.context.appId,index3:"enableLogUpload=".concat($.context.config.enableLogUpload)},lock:"",lockrev:D.fromNumber(0),subtarget:$.context.uid},(Jl=$.context.config.enableCloudProxy)!==null&&Jl!==void 0&&Jl),zl!==bd)throw new Pa(["MetaData modify failure. The response code from the RTM service is %d",Pl],He)}))}))))}},{key:"requestSetChannelMetadata",value:function(_){var $=this,_t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{majorRevision:-1,enableRecordTs:!1,enableRecordUserId:!1},ga=2<arguments.length?arguments[2]:void 0,_s=this.getLoginSockets();if(_s.length===0)throw new ia("Client is not logged in");if(_t.majorRevision&&(-1>_t.majorRevision||_t.majorRevision%1!=0))throw new ja("MajorRevision should be set to a value greater than  -1",Mb);if(nf({items:_,maxMetaDataCount:32,maxMetaValueSize:16384,type:"Set"}),this.context.lastModifyMeteDataTime!==void 0&&250>Date.now()-this.context.lastModifyMeteDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastModifyMeteDataTime=Date.now();var _c=this.incGetSeq(),_l=Date.now();return _s.forEach(function(Tl){Tl.sendPacket("StateSet",{sequence:_c,target:ga,requestUuid:"".concat(_c,"_").concat($.instanceId),value:JSON.stringify(pf(_,_t.majorRevision)),lock:"",lockRev:D.fromNumber(0),baseRevision:D.fromNumber(0),author:_t.enableRecordUserId?$.context.uid:"",flags:_t.enableRecordTs?new D(524289,0,!0):new D(1,0,!0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra(_s.map(function(Tl){return Tl.fromReceived("StateRequestResult").pipe(La(function(Cl){return _c.eq(Cl.sequence)}),Wa(function(Cl){var Pl,Dl,Jl=ud(Cl=Cl.code);if($a("SyncOperateEvent",{lts:D.fromNumber(Date.now()),userid:$.context.uid,vid:D.fromString((Pl=$.context.vid)!==null&&Pl!==void 0?Pl:"0"),sid:"",usersid:$.context.sid,requestts:D.fromNumber(_l),replyts:D.fromNumber(Date.now()),target:ga,eventtype:"Set",revision:D.fromNumber(0),uuid:"".concat(_c,"_").concat($.instanceId),sdktype:3,flags:_t.enableRecordTs?new D(524289,0,!0):new D(1,0,!0),code:Jl,seq:_c,index:{index1:$.context.uid,index2:$.context.appId,index3:"enableLogUpload=".concat($.context.config.enableLogUpload)},lock:"",lockrev:D.fromNumber(0),subtarget:$.context.uid},(Dl=$.context.config.enableCloudProxy)!==null&&Dl!==void 0&&Dl),Jl!==bd)throw new Pa(["MetaData modify failure. The response code from the RTM service is %d",Cl],Jl)}))}))))}},{key:"requestClearChannelMetadata",value:function(){var _=this,$=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{majorRevision:-1,enableRecordTs:!1,enableRecordUserId:!1},_t=1<arguments.length?arguments[1]:void 0,ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");if($.majorRevision&&-1>$.majorRevision&&$.majorRevision%1==0)throw new ja("MajorRevision should be set to a value greater than  -1",Mb);if($.majorRevision===0)throw new ja("MajorRevision can not be set to 0",of);if(this.context.lastModifyMeteDataTime!==void 0&&250>Date.now()-this.context.lastModifyMeteDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastModifyMeteDataTime=Date.now();var _s=this.incGetSeq(),_c=Date.now();return ga.forEach(function(_l){_l.sendPacket("StateSet",{sequence:_s,target:_t,requestUuid:"".concat(_s,"_").concat(_.instanceId),lock:"",lockRev:D.fromNumber(0),value:JSON.stringify({}),baseRevision:D.fromNumber(0),author:$.enableRecordUserId?_.context.uid:"",flags:$.enableRecordTs?new D(589825,0,!0):new D(65537,0,!0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra(ga.map(function(_l){return _l.fromReceived("StateRequestResult").pipe(La(function(Tl){return _s.eq(Tl.sequence)}),Wa(function(Tl){var Cl,Pl,Dl=ud(Tl=Tl.code);if($a("SyncOperateEvent",{lts:D.fromNumber(Date.now()),userid:_.context.uid,vid:D.fromString((Cl=_.context.vid)!==null&&Cl!==void 0?Cl:"0"),sid:"",usersid:_.context.sid,requestts:D.fromNumber(_c),replyts:D.fromNumber(Date.now()),target:_t,eventtype:"Clear",revision:D.fromNumber(0),uuid:"".concat(_s,"_").concat(_.instanceId),sdktype:3,flags:$.enableRecordTs?new D(589825,0,!0):new D(65537,0,!0),code:Dl,seq:_s,index:{index1:_.context.uid,index2:_.context.appId,index3:"enableLogUpload=".concat(_.context.config.enableLogUpload)},lock:"",lockrev:D.fromNumber(0),subtarget:_.context.uid},(Pl=_.context.config.enableCloudProxy)!==null&&Pl!==void 0&&Pl),Dl!==bd)throw new Pa(["MetaData modify failure. The response code from the RTM service is %d",Tl],Dl)}))}))))}},{key:"requestAddLocalMetadata",value:function(_){var $=this,_t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{majorRevision:-1,enableRecordTs:!1,enableRecordUserId:!1},ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");if(_t.majorRevision&&(-1>_t.majorRevision||_t.majorRevision%1!=0))throw new ja("MajorRevision should be set to a value greater than  -1",Mb);if(nf({items:_,maxMetaDataCount:32,maxMetaValueSize:16384,type:"Add"}),this.context.lastModifyMeteDataTime!==void 0&&250>Date.now()-this.context.lastModifyMeteDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastModifyMeteDataTime=Date.now();var _s=this.incGetSeq(),_c=JSON.stringify(pf(Pd.cloneDeep(_).map(function(Tl){return Tl.setRevision(0),Tl}),_t.majorRevision)),_l=Date.now();return ga.forEach(function(Tl){Tl.sendPacket("StateModify",{sequence:_s,target:$.context.uid,requestUuid:"".concat(_s,"_").concat($.instanceId),lock:"",lockRev:D.fromNumber(0),value:_c,baseRevision:D.fromNumber(0),author:_t.enableRecordUserId?$.context.uid:"",flags:_t.enableRecordTs?new D(524288,0,!0):D.fromNumber(0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra(ga.map(function(Tl){return Tl.fromReceived("StateRequestResult").pipe(La(function(Cl){return _s.eq(Cl.sequence)}),Ka(function(Cl){var Pl,Dl,Jl=ud(Cl=Cl.code);if($a("SyncOperateEvent",{lts:D.fromNumber(Date.now()),userid:$.context.uid,vid:D.fromString((Pl=$.context.vid)!==null&&Pl!==void 0?Pl:"0"),sid:"",usersid:$.context.sid,requestts:D.fromNumber(_l),replyts:D.fromNumber(Date.now()),target:$.context.uid,eventtype:"Add",revision:D.fromNumber(0),uuid:"".concat(_s,"_").concat($.instanceId),sdktype:3,flags:_t.enableRecordTs?new D(524288,0,!0):D.fromNumber(0),code:Jl,seq:_s,index:{index1:$.context.uid,index2:$.context.appId,index3:"enableLogUpload=".concat($.context.config.enableLogUpload)},lock:"",lockrev:D.fromNumber(0),subtarget:$.context.uid},(Dl=$.context.config.enableCloudProxy)!==null&&Dl!==void 0&&Dl),Jl!==bd)throw new Pa(["MetaData modify failure. The response code from the RTM service is %d",Cl],Jl)}))}))))}},{key:"requestUpdateLocalMetadata",value:function(_){var $=this,_t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{majorRevision:-1,enableRecordTs:!1,enableRecordUserId:!1},ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");if(_t.majorRevision&&(-1>_t.majorRevision||_t.majorRevision%1!=0))throw new ja("MajorRevision should be set to a value greater than  -1",Mb);if(_t.majorRevision===0)throw new ja("MajorRevision can not be set to 0",of);if(nf({items:_,maxMetaDataCount:32,maxMetaValueSize:16384,type:"Update"}),this.context.lastModifyMeteDataTime!==void 0&&250>Date.now()-this.context.lastModifyMeteDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastModifyMeteDataTime=Date.now();var _s=this.incGetSeq(),_c=JSON.stringify(pf(Pd.cloneDeep(_).map(function(Tl){return Tl.getRevision()===-1&&Tl.setRevision(-2),Tl}),_t.majorRevision)),_l=Date.now();return ga.forEach(function(Tl){Tl.sendPacket("StateModify",{sequence:_s,target:$.context.uid,requestUuid:"".concat(_s,"_").concat($.instanceId),lock:"",lockRev:D.fromNumber(0),value:_c,baseRevision:D.fromNumber(0),author:_t.enableRecordUserId?$.context.uid:"",flags:_t.enableRecordTs?new D(524288,0,!0):D.fromNumber(0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra(ga.map(function(Tl){return Tl.fromReceived("StateRequestResult").pipe(La(function(Cl){return _s.eq(Cl.sequence)}),Ka(function(Cl){var Pl,Dl,Jl=ud(Cl=Cl.code);if($a("SyncOperateEvent",{lts:D.fromNumber(Date.now()),userid:$.context.uid,vid:D.fromString((Pl=$.context.vid)!==null&&Pl!==void 0?Pl:"0"),sid:"",usersid:$.context.sid,requestts:D.fromNumber(_l),replyts:D.fromNumber(Date.now()),target:$.context.uid,eventtype:"Update",revision:D.fromNumber(0),uuid:"".concat(_s,"_").concat($.instanceId),sdktype:3,flags:_t.enableRecordTs?new D(524288,0,!0):D.fromNumber(0),code:Jl,seq:_s,index:{index1:$.context.uid,index2:$.context.appId,index3:"enableLogUpload=".concat($.context.config.enableLogUpload)},lock:"",lockrev:D.fromNumber(0),subtarget:$.context.uid},(Dl=$.context.config.enableCloudProxy)!==null&&Dl!==void 0&&Dl),Jl!==bd)throw new Pa(["MetaData modify failure. The response code from the RTM service is %d",Cl],Jl)}))}))))}},{key:"requestDeleteLocalMetadata",value:function(_){var $=this,_t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{majorRevision:-1,enableRecordTs:!1,enableRecordUserId:!1},ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");if(_t.majorRevision&&(-1>_t.majorRevision||_t.majorRevision%1!=0))throw new ja("MajorRevision should be set to a value greater than  -1",Mb);if(_t.majorRevision===0)throw new ja("MajorRevision can not be set to 0",of);if(nf({items:_,maxMetaDataCount:32,maxMetaValueSize:16384,type:"Delete"}),this.context.lastModifyMeteDataTime!==void 0&&250>Date.now()-this.context.lastModifyMeteDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastModifyMeteDataTime=Date.now();var _s=this.incGetSeq(),_c=JSON.stringify(pf(Pd.cloneDeep(_).map(function(Tl){return Tl.setValue(null),Tl}),_t.majorRevision)),_l=Date.now();return ga.forEach(function(Tl){Tl.sendPacket("StateModify",{sequence:_s,target:$.context.uid,requestUuid:"".concat(_s,"_").concat($.instanceId),lock:"",lockRev:D.fromNumber(0),value:_c,baseRevision:D.fromNumber(0),author:_t.enableRecordUserId?$.context.uid:"",flags:_t.enableRecordTs?new D(524288,0,!0):D.fromNumber(0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra(ga.map(function(Tl){return Tl.fromReceived("StateRequestResult").pipe(La(function(Cl){return _s.eq(Cl.sequence)}),Ka(function(Cl){var Pl,Dl,Jl=ud(Cl=Cl.code);if($a("SyncOperateEvent",{lts:D.fromNumber(Date.now()),userid:$.context.uid,vid:D.fromString((Pl=$.context.vid)!==null&&Pl!==void 0?Pl:"0"),sid:"",usersid:$.context.sid,requestts:D.fromNumber(_l),replyts:D.fromNumber(Date.now()),target:$.context.uid,eventtype:"Delete",revision:D.fromNumber(0),uuid:"".concat(_s,"_").concat($.instanceId),sdktype:3,flags:_t.enableRecordTs?new D(524288,0,!0):D.fromNumber(0),code:Jl,seq:_s,index:{index1:$.context.uid,index2:$.context.appId,index3:"enableLogUpload=".concat($.context.config.enableLogUpload)},lock:"",lockrev:D.fromNumber(0),subtarget:$.context.uid},(Dl=$.context.config.enableCloudProxy)!==null&&Dl!==void 0&&Dl),Jl!==bd)throw new Pa(["MetaData modify failure. The response code from the RTM service is %d",Cl],Jl)}))}))))}},{key:"requestSetLocalMetadata",value:function(_){var $=this,_t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{majorRevision:-1,enableRecordTs:!1,enableRecordUserId:!1},ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");if(_t.majorRevision&&(-1>_t.majorRevision||_t.majorRevision%1!=0))throw new ja("MajorRevision should be set to a value greater than  -1",Mb);if(nf({items:_,maxMetaDataCount:32,maxMetaValueSize:16384,type:"Set"}),this.context.lastModifyMeteDataTime!==void 0&&250>Date.now()-this.context.lastModifyMeteDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastModifyMeteDataTime=Date.now();var _s=this.incGetSeq(),_c=Date.now();return ga.forEach(function(_l){_l.sendPacket("StateSet",{sequence:_s,target:$.context.uid,requestUuid:"".concat(_s,"_").concat($.instanceId),value:JSON.stringify(pf(_,_t.majorRevision)),lock:"",lockRev:D.fromNumber(0),baseRevision:D.fromNumber(0),author:_t.enableRecordUserId?$.context.uid:"",flags:_t.enableRecordTs?new D(524288,0,!0):new D(0,0,!0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra(ga.map(function(_l){return _l.fromReceived("StateRequestResult").pipe(La(function(Tl){return _s.eq(Tl.sequence)}),Ka(function(Tl){var Cl,Pl,Dl=ud(Tl=Tl.code);if($a("SyncOperateEvent",{lts:D.fromNumber(Date.now()),userid:$.context.uid,vid:D.fromString((Cl=$.context.vid)!==null&&Cl!==void 0?Cl:"0"),sid:"",usersid:$.context.sid,requestts:D.fromNumber(_c),replyts:D.fromNumber(Date.now()),target:$.context.uid,eventtype:"Set",revision:D.fromNumber(0),uuid:"".concat(_s,"_").concat($.instanceId),sdktype:3,flags:_t.enableRecordTs?new D(524288,0,!0):D.fromNumber(0),code:Dl,seq:_s,index:{index1:$.context.uid,index2:$.context.appId,index3:"enableLogUpload=".concat($.context.config.enableLogUpload)},lock:"",lockrev:D.fromNumber(0),subtarget:$.context.uid},(Pl=$.context.config.enableCloudProxy)!==null&&Pl!==void 0&&Pl),Dl!==bd)throw new Pa(["MetaData modify failure. The response code from the RTM service is %d",Tl],Dl)}))}))))}},{key:"requestClearLocalMetadata",value:function(){var _=this,$=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{majorRevision:-1,enableRecordTs:!1,enableRecordUserId:!1},_t=this.getLoginSockets();if(_t.length===0)throw new ia("Client is not logged in");if($.majorRevision&&(-1>$.majorRevision||$.majorRevision%1!=0))throw new ja("MajorRevision should be set to a value greater than  -1",Mb);if($.majorRevision===0)throw new ja("MajorRevision can not be set to 0",of);if(this.context.lastModifyMeteDataTime!==void 0&&250>Date.now()-this.context.lastModifyMeteDataTime)throw new Fc(["The frequency of metedata operation exceeded the limit of %d queries per %d second",20,5e3],Vc);this.context.lastModifyMeteDataTime=Date.now();var ga=this.incGetSeq(),_s=Date.now();return _t.forEach(function(_c){_c.sendPacket("StateSet",{sequence:ga,target:_.context.uid,requestUuid:"".concat(ga,"_").concat(_.instanceId),lock:"",lockRev:D.fromNumber(0),value:JSON.stringify({}),baseRevision:D.fromNumber(0),author:$.enableRecordUserId?_.context.uid:"",flags:$.enableRecordTs?new D(589824,0,!0):new D(65536,0,!0)})}),bb.apply(void 0,[e.genTimeoutError(cd)].concat(ra(_t.map(function(_c){return _c.fromReceived("StateRequestResult").pipe(La(function(_l){return ga.eq(_l.sequence)}),Ka(function(_l){var Tl,Cl,Pl=ud(_l=_l.code);if($a("SyncOperateEvent",{lts:D.fromNumber(Date.now()),userid:_.context.uid,vid:D.fromString((Tl=_.context.vid)!==null&&Tl!==void 0?Tl:"0"),sid:"",usersid:_.context.sid,requestts:D.fromNumber(_s),replyts:D.fromNumber(Date.now()),target:_.context.uid,eventtype:"Clear",revision:D.fromNumber(0),uuid:"".concat(ga,"_").concat(_.instanceId),sdktype:3,flags:$.enableRecordTs?new D(524288,0,!0):D.fromNumber(0),code:Pl,seq:ga,index:{index1:_.context.uid,index2:_.context.appId,index3:"enableLogUpload=".concat(_.context.config.enableLogUpload)},lock:"",lockrev:D.fromNumber(0),subtarget:_.context.uid},(Cl=_.context.config.enableCloudProxy)!==null&&Cl!==void 0&&Cl),Pl!==bd)throw new Pa(["MetaData modify failure. The response code from the RTM service is %d",_l],Pl)}))}))))}},{key:"requestSubscribeUserMetadata",value:function(_,$){var _t=this,ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");if(this.context.lastSubscribeMetaDataTime!==void 0&&500>Date.now()-this.context.lastSubscribeMetaDataTime)throw new Fc(["The frequency of subscription metedata exceeded the limit of %d queries per %d second",10,5e3],Vc);this.context.lastSubscribeMetaDataTime=Date.now();var _s=this.incGetSeq(),_c=Date.now();return ga.forEach(function(_l){_l.sendPacket("StateSubscribe",{sequence:_s,target:_,subTarget:"",flags:D.fromNumber(0)})}),bb.apply(void 0,[e.genTimeoutErrorWithoutNotice(cl,void 0,$)].concat(ra(ga.map(function(_l){return _l.fromReceived("StateSubscribeResult").pipe(La(function(Tl){return _s.eq(Tl.sequence)}),Ka(function(Tl){var Cl,Pl;Tl=Tl.code;var Dl=Pw;if(Tl!==0&&Tl!==1&&(Dl=Tl===100?cl:lp),Dl!==Pw)throw new Pa(["User metaData Subscribe failure. The response code from the RTM service is %d",Tl],Dl);$!=="RECONNECTED"&&_t.lastUserMeteUpdateRecord[_]===void 0&&(_t.lastUserMeteUpdateRecord[_]=-1),$a("SyncSubscribeEvent",{lts:D.fromNumber(Date.now()),userid:_t.context.uid,vid:D.fromString((Cl=_t.context.vid)!==null&&Cl!==void 0?Cl:"0"),sid:"",usersid:_t.context.sid,target:_,requestts:D.fromNumber(_c),replyts:D.fromNumber(Date.now()),eventtype:"Subscribe",sdktype:3,flags:D.fromNumber(0),code:0,seq:_s,index:{index1:_t.context.uid,index2:_t.context.appId,index3:"enableLogUpload=".concat(_t.context.config.enableLogUpload)},subtarget:_t.context.uid},(Pl=_t.context.config.enableCloudProxy)!==null&&Pl!==void 0&&Pl)}))}))))}},{key:"requestUnsubscribeUserMetadata",value:function(_){var $,_t,ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");var _s=this.incGetSeq(),_c=Date.now();ga.forEach(function(_l){_l.sendPacket("StateUnsubscribe",{sequence:_s,target:_,subTarget:"",flags:D.fromNumber(0)})}),delete this.lastUserMeteUpdateRecord[_],$a("SyncSubscribeEvent",{lts:D.fromNumber(Date.now()),userid:this.context.uid,vid:D.fromString(($=this.context.vid)!==null&&$!==void 0?$:"0"),sid:"",usersid:this.context.sid,target:_,requestts:D.fromNumber(_c),replyts:D.fromNumber(Date.now()),eventtype:"UnSubscribe",sdktype:3,flags:D.fromNumber(0),code:0,seq:_s,index:{index1:this.context.uid,index2:this.context.appId,index3:"enableLogUpload=".concat(this.context.config.enableLogUpload)},subtarget:this.context.uid},(_t=this.context.config.enableCloudProxy)!==null&&_t!==void 0&&_t)}},{key:"requestUnsubscribeChannelMetadata",value:function(_){var $,_t,ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");var _s=this.incGetSeq();ga.forEach(function(_c){_c.sendPacket("StateUnsubscribe",{sequence:_s,target:_,subTarget:"",flags:new D(1,0,!0)})}),delete this.lastChannelMetaUpdateRecord[_],$a("SyncSubscribeEvent",{lts:D.fromNumber(Date.now()),userid:this.context.uid,vid:D.fromString(($=this.context.vid)!==null&&$!==void 0?$:"0"),sid:"",usersid:this.context.sid,target:_,requestts:D.fromNumber(Date.now()),replyts:D.fromNumber(Date.now()),eventtype:"UnSubscribe",sdktype:3,flags:new D(1,0,!0),code:0,seq:_s,index:{index1:this.context.uid,index2:this.context.appId,index3:"enableLogUpload=".concat(this.context.config.enableLogUpload)},subtarget:this.context.uid},(_t=this.context.config.enableCloudProxy)!==null&&_t!==void 0&&_t)}},{key:"requestSubscribeChannelMetadata",value:function(_,$){var _t=this,ga=this.getLoginSockets();if(ga.length===0)throw new ia("Client is not logged in");if(this.context.lastSubscribeMetaDataTime!==void 0&&500>Date.now()-this.context.lastSubscribeMetaDataTime)throw new Fc(["The frequency of subscription metedata exceeded the limit of %d queries per %d second",10,5e3],Vc);var _s=this.incGetSeq(),_c=Date.now();return ga.forEach(function(_l){_l.sendPacket("StateSubscribe",{sequence:_s,target:_,subTarget:"",flags:new D(1,0,!0)})}),bb.apply(void 0,[e.genTimeoutError(cl)].concat(ra(ga.map(function(_l){return _l.fromReceived("StateSubscribeResult").pipe(La(function(Tl){return _s.eq(Tl.sequence)}),Ka(function(Tl){var Cl,Pl;if((Tl=Tl.code)!==0&&Tl!==1)throw Tl===100?new Pa(["MetaData Subscribe failure. The response code from the RTM service is %d",Tl],cl):new Pa(["MetaData Subscribe failure. The response code from the RTM service is %d",Tl],lp);$==="JOIN"&&(_t.lastChannelMetaUpdateRecord[_]=-1),$a("SyncSubscribeEvent",{lts:D.fromNumber(Date.now()),userid:_t.context.uid,vid:D.fromString((Cl=_t.context.vid)!==null&&Cl!==void 0?Cl:"0"),sid:"",usersid:_t.context.sid,target:_,requestts:D.fromNumber(_c),replyts:D.fromNumber(Date.now()),eventtype:"Subscribe",sdktype:3,flags:D.fromNumber(0),code:Tl,seq:_s,index:{index1:_t.context.uid,index2:_t.context.appId,index3:"enableLogUpload=".concat(_t.context.config.enableLogUpload)},subtarget:_t.context.uid},(Pl=_t.context.config.enableCloudProxy)!==null&&Pl!==void 0&&Pl)}))}))))}},{key:"requestGetUserAttributesByKeys",value:function(_,$){var _t=this.getLoginSockets();if(_t.length===0)throw new ia("Client is not logged in");var ga=this.incGetSeq();return _t.forEach(function(_s){_s.sendPacket("UserAttributeGet",{account:_,seq:ga,attributes:$})}),bb.apply(void 0,[e.genTimeoutError(Bd)].concat(ra(_t.map(function(_s){return _s.fromReceived("UserAttributeErr").pipe(La(function(_c){return ga.eq(_c.seq)}),Wa(function(_c){throw(_c=_c.code)===10008?new Pa("The user requested is not online",qw):new id(["User attribute operation unknown error code: %d",_c],Ad)}))})),ra(_t.map(function(_s){return _s.fromReceived("UserAttributeRet").pipe(La(function(_c){return ga.eq(_c.seq)}))}))))}},{key:"requestGetChannelAttributesByKeys",value:function(_,$){var _t=this.getLoginSockets();if(_t.length===0)throw new ia("Client is not logged in");var ga=this.incGetSeq();return _t.forEach(function(_s){_s.sendPacket("GroupAttributeGet",{group:_,seq:ga,attributes:$})}),bb.apply(void 0,[e.genTimeoutError(Bd)].concat(ra(_t.map(function(_s){return _s.fromReceived("GroupAttributeErr").pipe(La(function(_c){return ga.eq(_c.seq)}),Wa(function(_c){throw new Pa(["The channel attributes get failure, code %d",_c.code],Ad)}))})),ra(_t.map(function(_s){return _s.fromReceived("GroupAttributeRet").pipe(La(function(_c){return ga.eq(_c.seq)}))}))))}},{key:"requestGetUserAttributeKeys",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new ia("Client is not logged in");var _t=this.incGetSeq();return $.forEach(function(ga){ga.sendPacket("UserAttributeKeysGet",{account:_,seq:_t})}),bb.apply(void 0,[e.genTimeoutError(Bd)].concat(ra($.map(function(ga){return ga.fromReceived("UserAttributeErr").pipe(La(function(_s){return _t.eq(_s.seq)}),Wa(function(_s){throw(_s=_s.code)===10008?new Pa("The user requested is not online",qw):new id(["User attribute operation unknown error code: %d",_s],Ad)}))})),ra($.map(function(ga){return ga.fromReceived("UserAttributeKeysRet").pipe(La(function(_s){return _t.eq(_s.seq)}))}))))}},{key:"requestGetChannelAttributesKeys",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new ia("Client is not logged in");var _t=this.incGetSeq();return $.forEach(function(ga){ga.sendPacket("GroupAttributeKeysGet",{group:_,seq:_t})}),bb.apply(void 0,[e.genTimeoutError(Bd)].concat(ra($.map(function(ga){return ga.fromReceived("GroupAttributeErr").pipe(La(function(_s){return _t.eq(_s.seq)}),Wa(function(_s){throw new id(["Channel attribute operation unknown error code: %d",_s.code],Ad)}))})),ra($.map(function(ga){return ga.fromReceived("GroupAttributeKeysRet").pipe(La(function(_s){return _t.eq(_s.seq)}))}))))}},{key:"requestGetChannelMemberCount",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new ia("Client is not logged in");var _t=this.incGetSeq();return $.forEach(function(ga){ga.sendPacket("GroupStatusList",{groups:_,seq:_t})}),bb.apply(void 0,[e.genTimeoutError(uw)].concat(ra($.map(function(ga){return ga.fromReceived("GroupStatusResult").pipe(La(function(_s){return _t.eq(_s.seq)}))}))))}},{key:"requestSubscribePeersOnlineStatus",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new ia("Client is not logged in");var _t=this.incGetSeq();return $.forEach(function(ga){ga.sendPacket("SubscribeUserStatus",{seq:_t,users:_})}),bb.apply(void 0,[e.genTimeoutError(NI)].concat(ra($.map(function(ga){return ga.fromReceived("SubscribeResponse").pipe(La(function(_s){return _t.eq(_s.seq)}))}))))}},{key:"requestUnsubscribePeersOnlineStatus",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new ia("Client is not logged in");var _t=this.incGetSeq();$.forEach(function(ga){ga.sendPacket("UnsubscribeUserStatus",{seq:_t,users:_})})}},{key:"sendInvitationMessage",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c,_l,Tl,Cl,Pl,Dl,Jl,zl,Bl,Vl,_d=this;return W.wrap(function(Sp){for(;;)switch(Sp.prev=Sp.next){case 0:if(ga=_t.peerId,_s=_t.callId,_c=_t.extra,_l=_t.isAcceptAck,Tl=_t.channelId,Cl=_t.type,Pl={callId:_s},_l===void 0){Sp.next=6;break}if(Cl==="CallAccept"){Sp.next=5;break}throw Error("invalid invitation type");case 5:Pl.type=_l?"ack":"request";case 6:return Pl.channel=Tl,(Cl==="CallInvite"||Cl==="CallCancel"||Cl==="CallReject"||Cl==="CallAccept"&&_l===!1)&&_c!==void 0&&(Pl.extra=_c),Dl=Rj(),this.log("The sent invitation body is %o",Pl),Jl=function(Up){return{MiscMap:{},sequence:D.fromNumber(1),dialogue:Dl,instance:_d.instanceId,dst:ga,ms:D.fromNumber(Date.now(),!0),options:new Yh({IterationNumber:Up,MessageType:Cl}).toLong(),payload:new TextEncoder().encode(JSON.stringify(Pl)),src:_d.context.uid}},Sp.next=14,ge(this.sendMessageToRetry(Jl,!0)).pipe(Oc(1e4),Rb(function(Up){return Up instanceof ad&&_d.warn("Send invitation timeout"),Va(Up)})).toPromise();case 14:return zl=Sp.sent,Bl=zl.code,Vl=zl.retryTimes,Sp.abrupt("return",{hasPeerReceived:Bl===0,hasReSent:Vl!==0});case 18:case"end":return Sp.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"sendRawMessage",value:function(){var _=za(W.mark(function $(_t,ga,_s,_c,_l){var Tl,Cl,Pl,Dl,Jl,zl,Bl,Vl,_d,Sp,Up,Kp=this;return W.wrap(function(Hp){for(;;)switch(Hp.prev=Hp.next){case 0:if(Tl=Date.now(),Cl=_c?vb.P2pRMsgNoOfflineFlag:vb.ChannelRMsg,yb(_s)&&_t instanceof Uint8Array&&typeof ga=="string"){Hp.next=4;break}throw new ja("The send message arguments are not valid",_c?Kw:Zk);case 4:if(!(32768<_t.byteLength+new Blob([ga]).size)){Hp.next=8;break}throw this.emit("messageCount",{messageCategory:Cl,type:"common",key:"sentcount"}),this.emit("messageCount",{messageCategory:Cl,type:"common",key:"invalidmessagecount"}),new Dc("The message size is over the 32KB limit",_c?si:fp);case 8:return Pl=!wg.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=_t.byteLength,Dl=this.chatManager.getChatInfo(_s),Jl=Dl.dialogue,zl=Dl.sequence,Bl=this.instanceId,this.log('A%s %s raw message is sending to %s: "'.concat(Bl,"-").concat(Jl,"#").concat(zl,'"'),Pl?" compressed":"",_c?"peer":"channel",wb(_s)),Vl=function(_m){return{MiscMap:{description:new TextEncoder().encode(ga)},sequence:zl,dialogue:Jl,instance:Bl,dst:_s,ms:D.fromNumber(Date.now(),!0),options:new Yh({IterationNumber:_m,CompressionMethod:Pl?"Zlib":"Uncompressed",MessageType:_c?"PeerRawMessage":"ChannelRawMessage",ToCache:!1,ToArchive:!1}).toLong(),payload:Pl?DA(_t):_t,src:Kp.context.uid}},Hp.next=15,ge(this.sendMessageToRetry(Vl,!0)).pipe(Oc(_l===void 0?1e4:_l),Rb(function(_m){return _m instanceof ad&&Kp.warn("Send message timeout"),Va(_m)})).toPromise();case 15:return _d=Hp.sent,Sp=_d.code,Up=Sp===0,this.emit("messageCount",{messageCategory:Cl,type:"common",key:"sentcount"}),Up&&(this.emit("messageCount",{messageCategory:Cl,type:"common",key:"successcount"}),this.emit("messageCount",{messageCategory:Cl,type:_c?"peer":"recipient",delay:Nb(Tl).toNumber()})),Hp.abrupt("return",{hasPeerReceived:Up});case 21:case"end":return Hp.stop()}},$,this)}));return function($,_t,ga,_s,_c){return _.apply(this,arguments)}}()},{key:"sendTextMessage",value:function(){var _=za(W.mark(function $(_t,ga,_s,_c){var _l,Tl,Cl,Pl,Dl,Jl,zl,Bl,Vl,_d,Sp,Up,Kp=this;return W.wrap(function(Hp){for(;;)switch(Hp.prev=Hp.next){case 0:if(_l=Date.now(),Tl=_s?vb.P2pSMsgNoOfflineFlag:vb.ChannelSMsg,yb(ga)){Hp.next=4;break}throw new ja("The send message arguments are not valid",_s?Kw:Zk);case 4:if(!(32768<new Blob([_t]).size)){Hp.next=8;break}throw this.emit("messageCount",{messageCategory:Tl,type:"common",key:"sentcount"}),this.emit("messageCount",{messageCategory:Tl,type:"common",key:"invalidmessagecount"}),new Dc("The message size is over the 32KB limit",_s?si:fp);case 8:return Cl=!wg.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=new Blob([_t]).size,Pl=this.chatManager.getChatInfo(ga),Dl=Pl.dialogue,Jl=Pl.sequence,zl=this.instanceId,this.log('A%s %s message is sending to %s: "'.concat(zl,"-").concat(Dl,"#").concat(Jl,'"'),Cl?" compressed":"",_s?"peer":"channel",wb(ga)),Bl=new TextEncoder().encode(_t),Vl=function(_m){return{MiscMap:{},sequence:Jl,dialogue:Dl,instance:zl,dst:ga,ms:D.fromNumber(Date.now(),!0),options:new Yh({IterationNumber:_m,CompressionMethod:Cl?"Zlib":"Uncompressed",MessageType:_s?"PeerTextMessage":"ChannelTextMessage",ToCache:!1,ToArchive:!1}).toLong(),payload:Cl?DA(Bl):Bl,src:Kp.context.uid}},Hp.next=16,ge(this.sendMessageToRetry(Vl,!0)).pipe(Oc(_c===void 0?1e4:_c),Rb(function(_m){return _m instanceof ad&&(Kp.emit("messageCount",{messageCategory:Tl,type:"common",key:"sentcount"}),Kp.emit("messageCount",{messageCategory:Tl,type:"common",key:"timeoutcount"}),Kp.warn("Send message timeout")),Va(_m)})).toPromise();case 16:return _d=Hp.sent,Sp=_d.code,Up=Sp===0,this.emit("messageCount",{messageCategory:Tl,type:"common",key:"sentcount"}),Up&&(this.emit("messageCount",{messageCategory:Tl,type:"common",key:"successcount"}),this.emit("messageCount",{messageCategory:Tl,type:_s?"peer":"recipient",delay:Nb(_l).toNumber()})),Hp.abrupt("return",{hasPeerReceived:Up});case 22:case"end":return Hp.stop()}},$,this)}));return function($,_t,ga,_s){return _.apply(this,arguments)}}()},{key:"cleanLoginSubs",value:function(_,$){Object.entries(this.loginSocketSubs[_]).forEach(function(_t){var ga=(_t=Lb(_t,2))[1];_t[0]==="channels"&&$||(Array.isArray(ga)||ga instanceof Map?ga.forEach(function(_s){return _s.unsubscribe()}):ga&&ga.unsubscribe())}),this.loginSocketSubs[_]={channels:$?this.loginSocketSubs[_].channels:new Map,receivers:[]}}},{key:"sendMessageToRetry",value:function(){var _=za(W.mark(function $(_t,ga){var _s,_c,_l,Tl,Cl,Pl,Dl,Jl,zl,Bl=this,Vl=arguments;return W.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:if(_s=2<Vl.length&&Vl[2]!==void 0?Vl[2]:0,this.log("Attempt to send the message ".concat(ga?" with retrying, %o":"without retrying"),{retryTimes:_s}),(_c=this.getLoginSockets()).length!==0){_d.next=5;break}throw Error("no logged-in sockets");case 5:return _l=_t(_s),_c.forEach(function(Sp){Sp.sendPacket("Message",_l)}),Tl=_l.dialogue,Cl=_l.sequence,Pl=_l.instance,Dl=_c.map(function(Sp){return Sp.fromReceived("Ack").pipe(sc(function(Up){return Tl.eq(Up.dialogue)&&Cl.eq(Up.sequence)&&Pl.eq(Up.instance)}))}),_d.prev=9,_d.next=12,Nc.apply(void 0,ra(Dl)).pipe(Oc(6e3),Rb(function(Sp){return uc(Sp)&&Bl.warn("Message send timeout, retry times %d",_s),Va(Sp)}),Xb(1)).toPromise();case 12:return Jl=_d.sent,zl=Jl.code,this.log("The message has been acked, %o",{code:zl}),_d.abrupt("return",{code:zl,retryTimes:_s});case 18:if(_d.prev=18,_d.t0=_d.catch(9),!(_d.t0 instanceof ad&&ga)){_d.next=22;break}return _d.abrupt("return",this.sendMessageToRetry(_t,!1,_s+1));case 22:throw _d.t0;case 23:case"end":return _d.stop()}},$,this,[[9,18]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"initKeepAliveSender",value:function(){var _=this;this.lastLoginSockets.map(function($){return $.pipe(Cc(function(_t){return Fe(0,2500,Kg()?void 0:CP).pipe(Ka(function(){_.sendPing(_t)}))}))}).forEach(function($,_t){var ga=_.loginSocketSubs[_t].keepAlive;ga!==void 0&&ga.unsubscribe(),_.loginSocketSubs[_t].keepAlive=$.subscribe({error:function(){}})})}},{key:"initKeepAliveReconnector",value:function(){var _=this;this.lastLoginSockets.map(function($){return $.pipe(Cc(function(_t){var ga,_s=!1,_c=_t.userJoin$.pipe(Ka(function(){_s=!0})),_l=_t.input$.pipe(Ka(function(Tl){Tm[Tl.uri].slice(0,-3)!=="Ping"&&(_s=!1)}));return Nc(Fe(6e3,1e4).pipe(iC(_t.receivedPacket),Ka(function(Tl){Tl=Lb(Tl,2),Tl=Lb(Tl[1],2)[1],ga!==Tl||_s||_t.forceReconnect(),ga=Tl})),_c,_l)}))}).forEach(function($,_t){var ga=_.loginSocketSubs[_t].keepAliveReconnector;ga!==void 0&&ga.unsubscribe(),_.loginSocketSubs[_t].keepAliveReconnector=$.subscribe({error:function(){}})})}},{key:"initLoginReceiver",value:function(){var _=this;bb.apply(void 0,ra(this.lastLoginSockets.map(function(ga){return ga.pipe(Cc(function(_s){return _s.fromReceived("UserTicketNearlyExpire").pipe(cC(5e3),Ka(_.onUserTicketNearlyExpire(_s)))}))}))).subscribe(),bb.apply(void 0,ra(this.lastLoginSockets.map(function(ga){return ga.pipe(Cc(function(_s){return _s.fromReceived("StateUpdate").pipe(Ka(_.onStateUpdate()))}))}))).subscribe();var $=Bc(this,"messageCount"),_t=$.pipe(sc(function(ga){return ga.messageCategory===vb.ChannelSMsg}));_t.subscribe(function(ga){return _.updateMessageCount(ga)}),_t.pipe(Kj(6e3)).subscribe(function(ga){ga.length&&_.chanelStringMessageReport.report()}),Nc(Wb(void 0),_t).pipe(Cc(function(){return Yg(36e5)})).subscribe(function(){_.chanelStringMessageReport.report()}),(_t=$.pipe(sc(function(ga){return ga.messageCategory===vb.ChannelRMsg}))).subscribe(function(ga){return _.updateMessageCount(ga)}),_t.pipe(Kj(6e3)).subscribe(function(ga){ga.length&&_.chanelRawMessageReport.report()}),Nc(Wb(void 0),_t).pipe(Cc(function(){return Yg(36e5)})).subscribe(function(){_.chanelRawMessageReport.report()}),(_t=$.pipe(sc(function(ga){return ga.messageCategory===vb.P2pSMsgNoOfflineFlag}))).subscribe(function(ga){return _.updateMessageCount(ga)}),_t.pipe(Kj(6e3)).subscribe(function(ga){ga.length&&_.p2pSMsgNoOfflineReport.report()}),Nc(Wb(void 0),_t).pipe(Cc(function(){return Yg(36e5)})).subscribe(function(){_.p2pSMsgNoOfflineReport.report()}),($=$.pipe(sc(function(ga){return ga.messageCategory===vb.P2pRMsgNoOfflineFlag}))).subscribe(function(ga){return _.updateMessageCount(ga)}),$.pipe(Kj(6e3)).subscribe(function(ga){ga.length&&_.p2pRMsgNoOfflineReport.report()}),Nc(Wb(void 0),$).pipe(Cc(function(){return Yg(36e5)})).subscribe(function(){_.p2pSMsgNoOfflineReport.report()}),this.lastLoginSockets.map(function(ga){return ga.pipe(Cc(function(_s){return Nc(Bc(_s,"reconnect").pipe(Ka(_.onSocketReconnect(_s))),_s.fromReceived("Message").pipe(Ka(_.onMessage(_s))),_s.fromReceived("GroupEnterNotice").pipe(Ka(_.onGroupEnterNotice())),_s.fromReceived("GroupLeaveNotice").pipe(Ka(_.onGroupLeaveNotice())),_s.fromReceived("GroupCountNotice").pipe(Ka(_.onGroupCountNotice())),_s.fromReceived("GroupAttributeAlt").pipe(Ka(_.onGroupAttributeAlt())),_s.fromReceived("UserJoinNotice").pipe(Ka(_.onUserNotice(Oa.PeerOnlineState.ONLINE))),_s.fromReceived("UserQuitNotice").pipe(Ka(_.onUserNotice(Oa.PeerOnlineState.OFFLINE))),_s.fromReceived("UserWaitNotice").pipe(Ka(_.onUserNotice(Oa.PeerOnlineState.UNREACHABLE))),_s.fromReceived("Pong").pipe(Ka(_.onPong())),_s.fromReceived("UserDrop").pipe(Ka(_.onUserDrop(_s))),_s.fromReceived("GroupDrop").pipe(Ka(_.onGroupDrop()))).pipe(ni(void 0))}))}).forEach(function(ga,_s){_.loginSocketSubs[_s].receivers.push(ga.subscribe({error:function(){}}))})}},{key:"requestSocketLogin",value:function(_,$,_t){var ga=this;return Pr(lf(function(){ga.userJoinOptions=new Pz($),_.sendPacket("UserJoin",{account:ga.context.uid,instance:ga.instanceId,opt:ga.userJoinOptions.toLong(),seq:_t,ticket:_.ticket})}),_.fromReceived("UserResp").pipe(La(function(_s){return _t.eq(_s.seq)}),Ka(function(_s){if((_s=_s.code)!==0)throw ga.clearSockets(),ga.logError("Connected to gateway success but the Rtm server rejected login"),new Pa(["Login failure. The response code from the RTM service is %d",_s],ij);_.attemptsSinceLastError=0,_.loggedIn=!0,ga.log("ENV_%d logged in",_.env)}),ni(_),Oc(6e3))).pipe(sc(function(_s){return _s!==void 0}),Rb(function(_s){_s instanceof ad&&ga.warn("Login response timeout, rejoin: %s",$);var _c=ga.getLoginSockets();if(0<_c.length){var _l=_c.map(function(Tl){return Tl.env});[0,1].filter(function(Tl){return!_l.includes(Tl)}).forEach(function(Tl){ga.cleanLoginSubs(Tl,!1),ga.connection.closeSocket(Tl,0)})}return _s.name="loginRespTimeout",ga.emit("banEdgeIP",_.ip),Va(_s)}))}},{key:"getSocketLoginObservables",value:function(_,$){var _t=this;return _.map(function(ga){return ga.pipe(Cc(function(_s,_c){return _t.incSeqIfNeeded(_s.env),_t.requestSocketLogin(_s,_c!==0,_c===0?$:_t.seq)}),$g())})}},{key:"incSeqIfNeeded",value:function(_){if(![0,1].includes(_))throw new rb({INVALID_ENV:"The env argument is not 0 or 1"});this.seqSentStatuses[_]&&(this.seq=this.seq.add(1),this.seqSentStatuses=[!1,!1]),this.seqSentStatuses[_]=!0}},{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1),this.seqSentStatuses=[!0,!0],this.seq}},{key:"getLoginSockets",value:function(){for(var _=this.curLoginSockets,$=-1,_t=_==null?0:_.length,ga=0,_s=[];++$<_t;){var _c=_[$];_c&&(_s[ga++]=_c)}return _s}},{key:"emitMessage",value:function(_,$){var _t,ga=_.options,_s=_.payload,_c=_.src,_l=_.dst,Tl=_.instance,Cl=_.dialogue,Pl=_.sequence,Dl=_.ms,Jl=_.MiscMap;this.dialogueSequenceLru.set(Cl.toString(),Pl),Tl="".concat(Tl,"-").concat(Cl,"#").concat(Pl),this.msgDedupLru.has(Tl)?this.warn("Env_%d: Messages out-of-order or not start with 1: %s",$,Tl):(this.msgDedupLru.set(Tl,void 0),ga=new Yh(ga),this.lastLoginSockets.forEach((_t=za(W.mark(function zl(Bl){var Vl;return W.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:return _d.next=2,Bl.pipe(Xb(1)).toPromise();case 2:Vl=_d.sent,e.sendMessageAck(_,Vl);case 4:case"end":return _d.stop()}},zl)})),function(zl){return _t.apply(this,arguments)})),$=ga.isZlibCompressed(),ga.isInvitation()?(_l=ti($?Oq(zs(_s,Uint8Array.of(0,0,0,0))):_s),_l=JSON.parse(_l),this.log("The received invitation body is %o",_l),this.emit("invitationMessage",{body:_l,type:ga.getInvitationType(),peerId:_c,serverReceivedTs:Dl.toNumber()})):ga.isTextMessage()?(Jl=ga.isPeerTextMessage(),_s=ti($?Oq(zs(_s,Uint8Array.of(0,0,0,0))):_s),this.info("Received a %s %s text message from %s to %s, %s",$?" compressed":"",Jl?"peer":"channel",wb(_c),wb(_l),Tl),Jl?(_c={text:_s,peerId:_c,properties:{serverReceivedTs:Dl.toNumber()}},this.emit("peerTextMessage",_c),this.emit("messageCount",{messageCategory:vb.P2pSMsgNoOfflineFlag,type:"common",key:"receivedcount"})):(this.emit("channelTextMessage",{channelId:_l,memberId:_c,text:_s,properties:{serverReceivedTs:Dl.toNumber()}}),this.emit("messageCount",{messageCategory:vb.ChannelSMsg,type:"common",key:"receivedcount"}))):ga.isRawMessage()&&(ga=ga.isRawPeerMessage(),Jl=(Jl=Jl.description)===void 0?"":ti(Jl),_s=$?Oq(_s):_s,this.info("Received a %s %s raw message from %s to %s, %s",$?" compressed":"",ga?"peer":"channel",wb(_c),wb(_l),Tl),ga?(_c={desc:Jl,raw:_s,peerId:_c,properties:{serverReceivedTs:Dl.toNumber()}},this.emit("peerRawMessage",_c),this.emit("messageCount",{messageCategory:vb.P2pRMsgNoOfflineFlag,type:"common",key:"receivedcount"})):(this.emit("channelRawMessage",{desc:Jl,raw:_s,channelId:_l,memberId:_c,properties:{serverReceivedTs:Dl.toNumber()}}),this.emit("messageCount",{messageCategory:vb.ChannelRMsg,type:"common",key:"receivedcount"}))))}},{key:"onSocketReconnect",value:function(_){var $=this;return function(){var _t=[0,1].filter(function(ga){return ga!==_.env})[0];(_t=$.connection.curOpenSockets[_t])&&!_t.loggedIn&&$.emit("connectionLost")}}},{key:"onUserTicketNearlyExpire",value:function(_){var $=this;return function(_t){(_t=_t.ticket)!==$.lastNoticeTicket&&_t===_.ticket?($.lastNoticeTicket=_t,$.emit("tokenPrivilegeWillExpire")):$.requestUpdateEdgeTicket(_.ticket).toPromise()}}},{key:"onGroupDrop",value:function(){var _=this;return function($){var _t,ga=$.account;$a("ChnLeave",{cname:ga,lts:D.fromNumber(Date.now()),elapse:Nb(_.startTime),errCode:EI,sid:fc(_.instanceId),userId:_.context.uid},(_t=_.context.config.enableCloudProxy)!==null&&_t!==void 0&&_t),[0,1].forEach(function(_s){return _.loginSocketSubs[_s].channels.delete(ga)}),_.logError("the user is kicked out of the current channel")}}},{key:"onStateUpdate",value:function(){var _=this;return function($){var _t=$.flags,ga=$.target;$=Wm($.allStates),_t.and(new D(1,0,!0)).isZero()?_.lastUserMeteUpdateRecord[ga]!==void 0&&$.majorRevision>_.lastUserMeteUpdateRecord[ga]&&(_.emit("userMetaDataUpdated",{uid:ga,data:_t.and(new D(0,2,!0)).isZero()?$:tb(tb({},$),{},{majorRevision:0})}),_.lastUserMeteUpdateRecord[ga]=$.majorRevision):_.lastChannelMetaUpdateRecord[ga]!==void 0&&$.majorRevision>_.lastChannelMetaUpdateRecord[ga]&&(_.emit("channelMetaDataUpdated",{channelId:ga,data:_t.and(new D(0,2,!0)).isZero()?$:tb(tb({},$),{},{majorRevision:0})}),_.lastChannelMetaUpdateRecord[ga]=$.majorRevision)}}},{key:"onUserDrop",value:function(_){var $=this;return function(_t){var ga;_t=_t.code,$a("KickedOff",{code:0,elapse:Nb($.startTime),linkId:parseInt(_.name.split("-")[1],10),lts:D.fromNumber(Date.now()),server:_.address,serverCode:_t,sid:fc($.instanceId),userId:$.context.uid},(ga=$.context.config.enableCloudProxy)!==null&&ga!==void 0&&ga),_t===10006||_t===10001?$.warn("Login too often and kicked off, reconnect and login"):_t===10009?($.warn("The instance ID conflicts, reconnecting"),$.instanceId=Rj(),$.context.sid=fc($.instanceId),$.emit("instanceChanged",$.instanceId)):[2,11,14,15,16,10019].includes(_t)&&($.emit("userDrop",_t),$.clearSockets())}}},{key:"clearSockets",value:function(){var _=this,$=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,_t=1<arguments.length&&arguments[1]!==void 0&&arguments[1];[0,1].forEach(function(ga){_.cleanLoginSubs(ga,_t),_.connection.closeSocket(ga,$)})}},{key:"onMessage",value:function(_){var $=this;return function(_t){var ga=_t.dialogue,_s=_t.instance,_c=_t.sequence,_l=_t.options;if(_t.src===$.context.uid)$.log("The message is from the local account, ignored");else{var Tl=ga.toString(),Cl=$.dialPendingMsgSubjectMap.get(Tl);if(ga="".concat(_s,"-").concat(ga,"#").concat(_c),Cl)Cl.next(_t),$.log("Env_%d: The dialogue has pending messages, next: %s",_.env,ga);else{var Pl=$.dialogueSequenceLru.get(Tl);if(Cl=!Pl&&_c.eq(1),_s=Pl!==void 0&&_c.sub(Pl).eq(1),Cl||_s)$.emitMessage(_t,_.env);else{if(Pl){if(_c.lte(Pl))return;$.log("Env_%d: The message pended, the sequence is not continuous with the last: %s",_.env,ga)}else $.log("Env_%d: The message pended, the first sequence is not equal to 1: %s",_.env,ga);_c=new ec,$.dialPendingMsgSubjectMap.set(Tl,_c);var Dl=_c.pipe(kB(Xo),Nj(function(Jl,zl){return[].concat(ra(Jl),[zl])},[]),Wa(function(Jl){return ra(Jl).sort(function(zl,Bl){return zl=zl.sequence,Bl=Bl.sequence,zl.eq(Bl)?0:zl.gt(Bl)?1:-1})}),Yr(1));_l=!(_l=new Yh(_l)).isFromCache()&&!_l.isBufferedMessage(),Dl.pipe(he(Fe(_l?750:1500)),La(function(Jl){if(2>Jl.length)return!1;for(var zl=Pl===void 0?D.fromNumber(1,!0):Pl.add(1),Bl=0;Bl<Jl.length;zl=zl.add(1),Bl++)if(!Jl[Bl].sequence.eq(zl))return!1;return!0}),Mj(function(){$.dialPendingMsgSubjectMap.delete(Tl)})).subscribe(function(Jl){Jl.forEach(function(zl){$.emitMessage(zl,_.env),$.log("Env_%d: The message queue has fully ordered, emitting: %s",_.env,"".concat(zl.instance,"-").concat(zl.dialogue,"#").concat(zl.sequence))})},function(Jl){Jl instanceof Lj&&Dl.pipe(Xb(1)).subscribe(function(zl){return zl.forEach(function(Bl){$.log("Env_%d: The message pending queue expired, emitting: %s",_.env,"".concat(Bl.instance,"-").concat(Bl.dialogue,"#").concat(Bl.sequence)),$.emitMessage(Bl,_.env)})})}),_c.next(_t)}}}}}},{key:"onPong",value:function(){var _=this;return function(){document.hidden&&_.getLoginSockets().forEach(function($){_.sendPing($)})}}},{key:"onGroupEnterNotice",value:function(){var _=this;return function($){_.emit("memberNotice",{channelId:$.group,seq:$.seq,instance:$.instance,memberId:$.user,type:"MemberJoined",size:$.size})}}},{key:"onGroupLeaveNotice",value:function(){var _=this;return function($){_.emit("memberNotice",{channelId:$.group,seq:$.seq,instance:$.instance,memberId:$.user,type:"MemberLeft",size:$.size})}}},{key:"onGroupCountNotice",value:function(){var _=this;return function($){_.emit("memberNotice",{channelId:$.group,seq:$.seq,instance:$.instance,type:"MemberCountUpdated",size:$.size})}}},{key:"onGroupAttributeAlt",value:function(){var _=this;return function($){var _t=$.group;$=em($,DP),_.emit("channelAttributesUpdated",tb({channelId:_t},$))}}},{key:"onUserNotice",value:function(_){var $=this;return function(_t){$.emit("peerOnlineStatusChanged",{peerId:_t.user,instance:_t.instance,seq:_t.seq,state:_})}}},{key:"sendPing",value:function(_){2500>=Date.now()-this.lastPingTime[_.env]||(this.incSeqIfNeeded(_.env),_.sendPacket("Ping",{ms:D.fromNumber(Date.now(),!0),seq:this.seq}),this.lastPingTime[_.env]=Date.now())}},{key:"updateMessageCount",value:function(_){var $,_t=($={},E($,vb.ChannelRMsg,this.chanelRawMessageReport),E($,vb.ChannelSMsg,this.chanelStringMessageReport),E($,vb.P2pRMsgNoOfflineFlag,this.p2pRMsgNoOfflineReport),E($,vb.P2pSMsgNoOfflineFlag,this.p2pSMsgNoOfflineReport),E($,3,void 0),E($,4,void 0),E($,7,void 0),E($,8,void 0),E($,9,void 0),E($,10,void 0),$)[_.messageCategory];_.type==="common"?_t==null||_t.updateCommonCount(_.key):_.type==="peer"?_t==null||_t.updatePeerAckCount(_.delay):_t==null||_t.updateNorecipientackCount(_.delay)}}],[{key:"sendMessageAck",value:function(_,$){var _t=new Yh(_.options);(_t.isInvitation()||_t.isPeerMessage())&&$.sendPacket("Ack",{code:0,dialogue:_.dialogue,instance:_.instance,sequence:_.sequence})}}]),e}(Dd());E(Pq,"genTimeoutErrorWithoutNotice",function(i,e,o){return Wb(void 0).pipe(mf(e===void 0?1e4:e),Wa(function(){if(o!=="JOIN")throw new Pc(["Request timed out after %ds",(e===void 0?1e4:e)/1e3],i)}))}),E(Pq,"genTimeoutError",function(i,e){return Wb(void 0).pipe(mf(e===void 0?1e4:e),Wa(function(){throw new Pc(["Request timed out after %ds",(e===void 0?1e4:e)/1e3],i)}))});var EA,Qq,Rq=0,Sq=0;gj.v1=function(i,e,o){o=e&&o||0;var c=e||[],_=(i=i||{}).node||EA,$=i.clockseq!==void 0?i.clockseq:Qq;if(_==null||$==null){var _t=ow();_==null&&(_=EA=[1|_t[0],_t[1],_t[2],_t[3],_t[4],_t[5]]),$==null&&($=Qq=16383&(_t[6]<<8|_t[7]))}_t=i.msecs!==void 0?i.msecs:new Date().getTime();var ga=i.nsecs!==void 0?i.nsecs:Sq+1,_s=_t-Rq+(ga-Sq)/1e4;if(0>_s&&i.clockseq===void 0&&($=$+1&16383),(0>_s||_t>Rq)&&i.nsecs===void 0&&(ga=0),1e4<=ga)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");for(Rq=_t,Sq=ga,Qq=$,i=(1e4*(268435455&(_t+=122192928e5))+ga)%4294967296,c[o++]=i>>>24&255,c[o++]=i>>>16&255,c[o++]=i>>>8&255,c[o++]=255&i,i=_t/4294967296*1e4&268435455,c[o++]=i>>>8&255,c[o++]=255&i,c[o++]=i>>>24&15|16,c[o++]=i>>>16&255,c[o++]=$>>>8|128,c[o++]=255&$,$=0;6>$;++$)c[o+$]=_[$];return e||pw(c)},gj.v4=gj;var Tq=il(),Sf,ai=Oa.LocalInvitationFailureReason,Fb=Oa.LocalInvitationState,EP=(Sf=function(i){function e(c,_,$){ab(this,e);var _t=o.call(this,$,"RtmLocalInvitation",!0);return E(L(_t),"state",Fb.IDLE),E(L(_t),"localInvitationEnd$",bb(Bc(L(_t),"LocalInvitationAccepted"),Bc(L(_t),"LocalInvitationRefused"),Bc(L(_t),"LocalInvitationFailure"),Bc(L(_t),"LocalInvitationCanceled")).pipe(Xb(1))),E(L(_t),"callId",gj.v4()),E(L(_t),"_content",""),E(L(_t),"_channelId",""),E(L(_t),"_response",""),E(L(_t),"calleeId",void 0),E(L(_t),"logger",void 0),E(L(_t),"getSession",void 0),_t.calleeId=c,_t.getSession=_,_t.logger=$,_t}nb(e,i);var o=ob(e);return Qb(e,[{key:"channelId",get:function(){return this._channelId},set:function(c){this.state!==Fb.IDLE?this.info("set channelId only allow before invitation sent to remote"):(this.log("set channelId for %s",this.callId),this._channelId=c)}},{key:"content",get:function(){return this._content},set:function(c){this.log("set content for %s",this.callId),this._content=c}},{key:"response",get:function(){return this._response},set:function(c){throw new ja('Cannot set the "response" of the LocalInvitation instance.',ve)}},{key:"send",value:function(){var c,_=this;if(this.state===Fb.SENT_TO_REMOTE||this.state===Fb.RECEIVED_BY_REMOTE)throw new ia("The local invitation send failure. The call invitation has already been sent.",AI);if(this.isLocalInvitationEnd())throw new ia("The local invitation send failure. The call invitation has ended.",$k);if(0<this._channelId.length&&!yb(this._channelId))throw new ja("Illegal invitation channel ID",ve);if(!yb(this.calleeId))throw new ja("Illegal invitation callee user ID",ve);if(8192<Wj(this._content))throw new ja('The length of the "content" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',ve);this.state=Fb.SENT_TO_REMOTE,lf(za(W.mark(function $(){var _t,ga,_s;return W.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:return _c.next=2,_.getSession().sendInvitationMessage({peerId:_.calleeId,callId:_.callId,extra:_._content,type:"CallInvite",channelId:_._channelId});case 2:if(_t=_c.sent,ga=_t.hasPeerReceived,_s=_t.hasReSent,!_.isLocalInvitationEnd()){_c.next=7;break}throw new Pc("send invitation timeout");case 7:if(_.log("The local invitation has sent to the callee"),ga||_s){_c.next=11;break}throw c=new Tq({PEER_NOT_ONLINE:"The peer of the invitation is not online"});case 11:if(ga){_c.next=14;break}throw c=new Tq({RESENT_AND_OFFLINE:"Resent and the peer of the invitation is not online"});case 14:case"end":return _c.stop()}},$)}))).pipe(Zg(function($){return $.pipe(Ka(function(_t){if(!(_t instanceof Tq))throw _t}),mf(2e3))}),Oc(3e4),Rb(function($){return uc($)&&_.warn("local invitation ack timed out"),Va($)}),he(this.localInvitationEnd$)).subscribe({next:function(){_.state===Fb.RECEIVED_BY_REMOTE?_.log('The local invitation state is already "RECEIVED_BY_REMOTE", skipped emitting "LocalInvitationReceivedByPeer"'):_.state!==Fb.SENT_TO_REMOTE?_.log("The invitation has ended, skipped emitting the %s event","LocalInvitationReceivedByPeer"):(_.info("The peer received the local invitation %s.",_.callId),_.state=Fb.RECEIVED_BY_REMOTE,_.emit("LocalInvitationReceivedByPeer"),_.localInvitationEnd$.pipe(Oc(6e4),Rb(function($){return uc($)&&_.warn("local invitation expired"),Va($)})).subscribe({error:function(){_.state=Fb.FAILURE,_.emit("LocalInvitationFailure",ai.INVITATION_EXPIRE)}}))},error:function($){_.isLocalInvitationEnd()?_.log("The invitation has ended, skipped emitting the %s event","LocalInvitationFailure"):(_.state=Fb.FAILURE,uc($)&&c?c.code==="PEER_NOT_ONLINE"?_.emit("LocalInvitationFailure",ai.PEER_OFFLINE):c.code==="RESENT_AND_OFFLINE"&&_.emit("LocalInvitationFailure",ai.PEER_NO_RESPONSE):uc($)?_.emit("LocalInvitationFailure",ai.PEER_NO_RESPONSE):$.name==="RtmInvalidStatusError"?_.emit("LocalInvitationFailure",ai.NOT_LOGGEDIN):_.emit("LocalInvitationFailure",ai.UNKNOWN))}})}},{key:"cancel",value:function(){if(this.isLocalInvitationEnd())throw new ia("The local invitation cancel failure",$k);if(this.state===Fb.IDLE)throw new ia("The local invitation has not been sent",zI);if(8192<Wj(this._content))throw new ja('The length of the "content" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',ve);this.getSession().sendInvitationMessage({callId:this.callId,peerId:this.calleeId,type:"CallCancel",channelId:this._channelId,extra:this._content}),this.state=Fb.CANCELED,this.emit("LocalInvitationCanceled")}},{key:"onAcceptReceived",value:function(c){if(this.isLocalInvitationEnd()&&this.state!==Fb.ACCEPTED_BY_REMOTE)this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationAccepted");else{if(this.state===Fb.IDLE)throw new ia("the local have not sent the invitation, how can remote accept it?");this.getSession().sendInvitationMessage({callId:this.callId,isAcceptAck:!0,type:"CallAccept",peerId:this.calleeId,channelId:this.channelId}),this.state===Fb.ACCEPTED_BY_REMOTE?this.log("already in ACCEPTED_BY_REMOTE state, ignore emit ACCEPTED_BY_REMOTE"):(this.state===Fb.SENT_TO_REMOTE&&(this.log("receive LocalInvitationAccepted before remote response to the invitation"),this.state=Fb.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this.state=Fb.ACCEPTED_BY_REMOTE,this._response=c,this.emit("LocalInvitationAccepted",c))}}},{key:"onRefuseReceived",value:function(c){if(this.isLocalInvitationEnd())this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationRefused");else{if(this.state===Fb.IDLE)throw new ia("the local have not sent the invitation, how can remote refuse it?");this.state===Fb.SENT_TO_REMOTE&&(this.log("receive LocalInvitationRefused before remote response to the invitation"),this.state=Fb.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this._response=c,this.state=Fb.REFUSED_BY_REMOTE,this.emit("LocalInvitationRefused",c)}}},{key:"isLocalInvitationEnd",value:function(){return[Fb.CANCELED,Fb.FAILURE,Fb.ACCEPTED_BY_REMOTE,Fb.REFUSED_BY_REMOTE].includes(this.state)}}]),e}(Dd()),Na(Sf.prototype,"send",[je],Object.getOwnPropertyDescriptor(Sf.prototype,"send"),Sf.prototype),Na(Sf.prototype,"cancel",[je],Object.getOwnPropertyDescriptor(Sf.prototype,"cancel"),Sf.prototype),Sf),cm=Oa.RemoteInvitationFailureReason,Ic=Oa.RemoteInvitationState,FP=function(i){function e(c){var _=c.invitationChannel,$=c.extraContent,_t=c.callId,ga=c.callerId,_s=c.logger;c=c.getSession,ab(this,e);var _c=o.call(this,_s,"RtmRemoteInvitation",!0);return E(L(_c),"state",Ic.INVITATION_RECEIVED),E(L(_c),"remoteInvitationEnd$",bb(Bc(L(_c),"RemoteInvitationCanceled"),Bc(L(_c),"RemoteInvitationRefused"),Bc(L(_c),"RemoteInvitationAccepted"),Bc(L(_c),"RemoteInvitationFailure")).pipe(Xb(1))),E(L(_c),"callerId",void 0),E(L(_c),"callId",void 0),E(L(_c),"_getSession",void 0),E(L(_c),"logger",void 0),E(L(_c),"_content",void 0),E(L(_c),"_channelId",void 0),E(L(_c),"_response",""),_c._channelId=_,_c._content=$,_c.callId=_t,_c.callerId=ga,_c._getSession=c,_c.logger=_s,_c.remoteInvitationEnd$.pipe(Oc(6e4),Rb(function(_l){return uc(_l)&&_c.warn("Remote invitation expired"),Va(_l)})).subscribe({error:function(){_c.state=Ic.FAILURE,_c.emit("RemoteInvitationFailure",cm.INVITATION_EXPIRE)}}),_c}nb(e,i);var o=ob(e);return Qb(e,[{key:"channelId",get:function(){return this._channelId},set:function(c){throw new ja('Cannot set the "response" of the RemoteInvitation instance.',ve)}},{key:"content",get:function(){return this._content},set:function(c){throw new ja('Cannot set the "content" of the RemoteInvitation instance.',ve)}},{key:"response",get:function(){return this._response},set:function(c){this._response=c}},{key:"accept",value:function(){var c,_=this;if(this.isRemoteInvitationEnd())throw new ia("The local invitation has ended. Cannot accept.",$k);if(this.state===Ic.ACCEPT_SENT_TO_LOCAL)throw new ia("The remote invitation is accepting. Cannot do the operation.",vw);if(8192<Wj(this._response))throw new ja('The length of the "response" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',ve);this.state=Ic.ACCEPT_SENT_TO_LOCAL,Nc(Yg(1e3).pipe(Ac(function(){return lf(za(W.mark(function $(){return W.wrap(function(_t){for(;;)switch(_t.prev=_t.next){case 0:return _t.abrupt("return",_._getSession().sendInvitationMessage({peerId:_.callerId,callId:_.callId,extra:_.response,type:"CallAccept",isAcceptAck:!1,channelId:_.channelId}));case 1:case"end":return _t.stop()}},$)})))}),sc(function($){return c=$.hasPeerReceived}),Xb(1)),Bc(this,"RemoteInvitationAccepted")).pipe(Oc(5e3),he(this.remoteInvitationEnd$)).subscribe({error:function($){if(_.logError($),_.state=Ic.FAILURE,uc($))switch(c){case void 0:case!0:return void _.emit("RemoteInvitationFailure",cm.ACCEPT_FAILURE);case!1:return void _.emit("RemoteInvitationFailure",cm.PEER_OFFLINE)}_.emit("RemoteInvitationFailure",cm.UNKNOWN)}})}},{key:"refuse",value:function(){if(this.state===Ic.ACCEPT_SENT_TO_LOCAL)throw new ia("The remote invitation is accepting. Cannot do the operation.",vw);if(this.isRemoteInvitationEnd())throw new ia("The invitation is end. Cannot refuse",$k);if(8192<Wj(this._response))throw new ja('The length of the "response" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',ve);this._getSession().sendInvitationMessage({peerId:this.callerId,callId:this.callId,extra:this.response,type:"CallReject",channelId:this.channelId}),this.state=Ic.REFUSED,this.emit("RemoteInvitationRefused")}},{key:"onCancelReceived",value:function(c){this.isRemoteInvitationEnd()?this.log("The invitation has ended, skipped emitting the %s event","RemoteInvitationCanceled"):(this.state===Ic.ACCEPT_SENT_TO_LOCAL&&this.log("caller canceled before receive accept"),this._content=c,this.state=Ic.CANCELED,this.emit("RemoteInvitationCanceled",c))}},{key:"onAcceptAckReceived",value:function(){this.state!==Ic.ACCEPT_SENT_TO_LOCAL?this.log("The invitation has ended, skipped emitting the %s event","ori:".concat(this.state,", to: RemoteInvitationAccepted")):(this.state=Ic.ACCEPTED,this.emit("RemoteInvitationAccepted"))}},{key:"isRemoteInvitationEnd",value:function(){return[Ic.ACCEPTED,Ic.REFUSED,Ic.CANCELED,Ic.FAILURE].includes(this.state)}}]),e}(Dd()),GP=function(i){function e(c,_){ab(this,e);var $=o.call(this,_,"InvitationManager");return E(L($),"getSession",void 0),E(L($),"invitationDispatcher",new kb.EventEmitter),E(L($),"outgoingLocalInvitations",new Map),E(L($),"receivedRemoteInvitations",new ue(void 0,{maxlen:1e4})),E(L($),"logger",void 0),$.getSession=Hs(c),$.logger=_,$.invitationDispatcher.on("remoteInvitationToManager",function(_t){var ga=_t.callId,_s=_t.extra,_c=_t.callerId;_t=_t.channelId,$.receivedRemoteInvitations.has(ga)||((_s=new FP({callerId:_c,callId:ga,getSession:$.getSession,logger:_,extraContent:_s,invitationChannel:_t})).remoteInvitationEnd$.subscribe(function(){$.receivedRemoteInvitations.delete(ga)}),$.receivedRemoteInvitations.set(ga,_s),$.emit("remoteInvitationInstance",_s))}),$.invitationDispatcher.on("acceptAckToRemoteInvitation",function(_t){(_t=$.receivedRemoteInvitations.get(_t.callId))&&_t.onAcceptAckReceived()}),$.invitationDispatcher.on("cancelToRemoteInvitation",function(_t){var ga=_t.extra;(_t=$.receivedRemoteInvitations.get(_t.callId))&&_t.onCancelReceived(ga)}),$.invitationDispatcher.on("acceptToLocalInvitation",function(_t){var ga=_t.extra;(_t=$.outgoingLocalInvitations.get(_t.callId))&&_t.onAcceptReceived(ga)}),$.invitationDispatcher.on("refuseToLocalInvitation",function(_t){var ga=_t.extra;(_t=$.outgoingLocalInvitations.get(_t.callId))&&_t.onRefuseReceived(ga)}),$}nb(e,i);var o=ob(e);return Qb(e,[{key:"invitationMessageHandler",value:function(c){var _=c.body,$=_.callId,_t=_.extra;_t=_t===void 0?"":_t;var ga=_.type,_s=(_=_.channel)===void 0?"":_,_c=c.type;switch(_=c.peerId,c=c.serverReceivedTs,_c){case"CallAccept":ga==="ack"?this.invitationDispatcher.emit("acceptAckToRemoteInvitation",{callId:$}):ga==="request"&&this.invitationDispatcher.emit("acceptToLocalInvitation",{callId:$,extra:_t});break;case"CallInvite":this.invitationDispatcher.emit("remoteInvitationToManager",{callId:$,callerId:_,extra:_t,channelId:_s});break;case"CallCancel":if($==="0"){$="".concat("AgoraRTMLegacyEndcallCompatibleMessagePrefix","_").concat(_s,"_").concat(_t),this.getSession().emit("peerTextMessage",{peerId:_,properties:{serverReceivedTs:c},text:$});break}this.invitationDispatcher.emit("cancelToRemoteInvitation",{callId:$,extra:_t});break;case"CallReject":this.invitationDispatcher.emit("refuseToLocalInvitation",{callId:$,extra:_t});break;default:throw ps("invitationType",_c)}}},{key:"genLocalInvitation",value:function(c){var _=this,$=new EP(c,this.getSession,this.logger);return $.localInvitationEnd$.subscribe(function(){_.outgoingLocalInvitations.delete($.callId)}),this.outgoingLocalInvitations.set($.callId,$),$}}]),e}(Dd()),HP=function(i,e,o){var c=!0,_=!0;if(typeof i!="function")throw new TypeError("Expected a function");return Kc(o)&&(c="leading"in o?!!o.leading:c,_="trailing"in o?!!o.trailing:_),LK(i,e,{leading:c,maxWait:e,trailing:_})},lb,bi;(function(i){i[i.JOINED=0]="JOINED",i[i.LEFT=1]="LEFT"})(bi||(bi={}));var Ld=Oa.ConnectionState,IP=(lb=function(i){function e(_,$,_t,ga){ab(this,e);var _s=c.call(this,ga,"RtmChannel",!0);return E(L(_s),"onMemberCountUpdated",HP(function(_c){_c!==_s.memberCount&&(_s.memberCount=_c,_s.emit("MemberCountUpdated",_c))},1e3)),E(L(_s),"onMetadataUpdated",function(_c){_s.emit("MetaDataUpdated",_c)}),E(L(_s),"getSession",void 0),E(L(_s),"memberCount",0),E(L(_s),"joinState","LEFT"),E(L(_s),"joinPromise",void 0),E(L(_s),"memberJoinedLru",new ue(void 0,{maxlen:1e4})),E(L(_s),"memberLeftLru",new ue(void 0,{maxlen:1e4})),E(L(_s),"memberJoinStateLru",new ue(void 0,{maxlen:1e4})),E(L(_s),"attributesSeqLru",new ue(void 0,{maxlen:1e4})),E(L(_s),"channelId",void 0),E(L(_s),"client",void 0),E(L(_s),"onChannelMetaDataUpdated",function(_c){var _l=_c.data;_s.channelId===_c.channelId&&_s.onMetadataUpdated(_l)}),E(L(_s),"onChannelMemberCountUpdated",function(_c,_l){_s.channelId===_c&&_s.onMemberCountUpdated(_l)}),E(L(_s),"onLogout",function(){try{_s.clearChannel(_s.getSession())}catch{}}),E(L(_s),"onAttributesUpdated",function(_c){var _l=_c.channelId,Tl=_c.attributeMaps,Cl=_c.seq;_c=_c.instance.toString();var Pl=_s.attributesSeqLru.get(_c);if((!Pl||Cl.greaterThan(Pl))&&(_s.attributesSeqLru.set(_c,Cl),_l===_s.channelId)){for(_l={},Cl=0;Cl<Tl.length;Cl++){var Dl=Tl[Cl];_c=Dl.key,Pl=Dl.ms;var Jl=Dl.value;if(Dl=Dl.origin,typeof _c!="string"||!D.isLong(Pl)||typeof Jl!="string"||!yb(Dl))break;_l[_c]={value:Jl,lastUpdateUserId:Dl,lastUpdateTs:Pl.toNumber()}}_s.emit("AttributesUpdated",_l)}}),E(L(_s),"onChannelTextMessage",function(_c){var _l=_c.memberId,Tl=_c.text,Cl=_c.properties;_c.channelId===_s.channelId&&_s.emit("ChannelMessage",{text:Tl,messageType:Oa.MessageType.TEXT},_l,Cl)}),E(L(_s),"onChannelRawMessage",function(_c){var _l=_c.desc,Tl=_c.raw,Cl=_c.memberId,Pl=_c.properties;_c.channelId===_s.channelId&&_s.emit("ChannelMessage",{messageType:Oa.MessageType.RAW,rawMessage:Tl,description:_l},Cl,Pl)}),E(L(_s),"onMemberNotice",function(_c){var _l=_c.memberId,Tl=_c.type,Cl=_c.size;if(_c.channelId===_s.channelId){var Pl=_c.instance.toString();_c=_c.seq.toString();var Dl={MemberLeft:_s.memberLeftLru,MemberJoined:_s.memberJoinedLru,MemberCountUpdated:void 0}[Tl];if(Dl){if(Dl.has(Pl+_c))return void _s.log("received duplicated %s notice (seq: %s), channel '%s', member '%s'",Tl,_c,wb(_s.channelId),wb(_l||""));if(Dl.set(Pl+_c,void 0),typeof _l!="string")return;if(_l!==_s.getSession().context.uid&&((Pl=_s.memberJoinStateLru.get(_l))===bi.JOINED&&Tl==="MemberJoined"||Pl===bi.LEFT&&Tl==="MemberLeft"))return void _s.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",Tl,_c,wb(_s.channelId),wb(_l||""));_s.memberJoinStateLru.set(_l,Tl==="MemberJoined"?bi.JOINED:bi.LEFT)}_s.info("Channel %s - %s, memberId: %s",Tl,wb(_s.channelId),Tl==="MemberCountUpdated"?"[unknown]":wb(_l||"")),Pl=_l===_s.getSession().context.uid,Tl==="MemberLeft"&&yb(_l)||Tl==="MemberJoined"&&yb(_l)?(Pl||_s.emit(Tl,_l),_s.onMemberCountUpdated(Cl)):Tl==="MemberCountUpdated"&&typeof Cl=="number"&&_s.onMemberCountUpdated(Cl)}}),_s.getSession=Hs($),_s.channelId=_,_s.client=_t,_s.info("A channel created, id %s",wb(_)),_s}nb(e,i);var o,c=ob(e);return Qb(e,[{key:"join",value:(o=za(W.mark(function _(){var $,_t,ga,_s,_c,_l,Tl,Cl=this;return W.wrap(function(Pl){for(;;)switch(Pl.prev=Pl.next){case 0:if(this.client.connectionState===Ld.CONNECTED){Pl.next=2;break}throw new ia("The client is not logged in. Cannot do the operation",oc);case 2:Pl.prev=2,$=this.getSession(),Pl.next=9;break;case 6:throw Pl.prev=6,Pl.t0=Pl.catch(2),new ia("The client is not logged in. Cannot do the operation",Aw);case 9:if(Pl.prev=9,yb(this.channelId)){Pl.next=12;break}throw new ja(["The %s in the arguments is invalid","channelId"],BI);case 12:if(this.joinState==="LEFT"){Pl.next=15;break}throw $a("ChnJoin",{cname:this.channelId,lts:D.fromNumber(Date.now()),userId:$.context.uid,elapse:Nb($.startTime),errCode:zw,sid:fc($.instanceId)},(_s=this.client.context.config.enableCloudProxy)!==null&&_s!==void 0&&_s),new ia("The channel has joined. Cannot rejoin",zw);case 15:if(!$.usedChannelIds.includes(this.channelId)){Pl.next=18;break}throw $a("ChnJoin",{cname:this.channelId,lts:D.fromNumber(Date.now()),userId:$.context.uid,elapse:Nb($.startTime),errCode:Bw,sid:fc($.instanceId)},(_c=this.client.context.config.enableCloudProxy)!==null&&_c!==void 0&&_c),new ia("A channel of the same channel ID has already joined. Cannot rejoin",Bw);case 18:if(!(20<=$.usedChannelIds.length)){Pl.next=21;break}throw $a("ChnJoin",{cname:this.channelId,lts:D.fromNumber(Date.now()),userId:$.context.uid,elapse:Nb($.startTime),errCode:yw,sid:fc($.instanceId)},(_l=this.client.context.config.enableCloudProxy)!==null&&_l!==void 0&&_l),new Dc("The joined channels has exceeded the limit of 20",yw);case 21:return $a("ChnJoin",{cname:this.channelId,lts:D.fromNumber(Date.now()),userId:$.context.uid,elapse:Nb($.startTime),errCode:0,sid:fc($.instanceId)},(_t=this.client.context.config.enableCloudProxy)!==null&&_t!==void 0&&_t),this.log("Joining the channel %s",wb(this.channelId)),this.joinState="JOINING",$.usedChannelIds.push(this.channelId),this.joinPromise=$.requestChannelJoin(this.channelId).then(function(){Cl.joinState="JOINED",$.requestSubscribeChannelMetadata(Cl.channelId,"JOIN").toPromise()}),Pl.next=28,this.joinPromise;case 28:$a("ChnJoinRes",{cname:this.channelId,lts:D.fromNumber(Date.now()),elapse:Nb($.startTime),errCode:0,sid:fc($.instanceId),serverErrCode:0,userId:$.context.uid},(ga=this.client.context.config.enableCloudProxy)!==null&&ga!==void 0&&ga),this.info("The channel %s joined successfully",wb(this.channelId)),$.on("channelTextMessage",this.onChannelTextMessage),$.on("channelRawMessage",this.onChannelRawMessage),$.on("memberNotice",this.onMemberNotice),$.on("channelAttributesUpdated",this.onAttributesUpdated),$.on("channelMetaDataUpdated",this.onChannelMetaDataUpdated),this.client.internalEmitter.on("channelMemberCountUpdated",this.onChannelMemberCountUpdated),this.client.internalEmitter.once("LOGOUT",this.onLogout),Pl.next=49;break;case 39:if(Pl.prev=39,Pl.t1=Pl.catch(9),this.joinState==="JOINING"&&(this.joinState="LEFT"),this.logError(Pl.t1),!Sa(Pl.t1)){Pl.next=45;break}throw Pl.t1;case 45:if(!uc(Pl.t1)){Pl.next=48;break}throw $a("ChnJoinRes",{cname:this.channelId,lts:D.fromNumber(Date.now()),elapse:Nb($.startTime),errCode:xw,sid:fc($.instanceId),serverErrCode:0,userId:$.context.uid},(Tl=this.client.context.config.enableCloudProxy)!==null&&Tl!==void 0&&Tl),new Pc(["Join channel %s timed out",wb(this.channelId)],xw);case 48:throw new id(["The channel %s join failure",wb(this.channelId)],{code:ww,originalError:Pl.t1});case 49:case"end":return Pl.stop()}},_,this,[[2,6],[9,39]])})),function(){return o.apply(this,arguments)})},{key:"leave",value:function(){var _=za(W.mark(function $(){var _t,ga,_s,_c;return W.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(this.client.connectionState===Ld.CONNECTED){_l.next=2;break}throw new ia("The client is not logged in. Cannot do the operation",oc);case 2:_l.prev=2,ga=this.getSession(),_l.next=9;break;case 6:throw _l.prev=6,_l.t0=_l.catch(2),new ia("The client is not logged in. Cannot do the operation",DI);case 9:if(this.joinState!=="LEFT"){_l.next=11;break}throw new ia("The channel does not join. Cannot do the operation",CI);case 11:return _l.prev=11,ga.requestChannelLeave(this.channelId),_l.next=15,ga.requestUnsubscribeChannelMetadata(this.channelId);case 15:return _l.next=17,this.clearChannel(ga);case 17:_l.next=28;break;case 19:if(_l.prev=19,_l.t1=_l.catch(11),this.logError(_l.t1),!Sa(_l.t1)){_l.next=26;break}throw _l.t1.code===void 0&&(_l.t1.code=Dw),$a("ChnLeave",{cname:this.channelId,lts:D.fromNumber(Date.now()),elapse:Nb(ga.startTime),errCode:Dw,sid:fc(ga.instanceId),userId:ga.context.uid},(_c=this.client.context.config.enableCloudProxy)!==null&&_c!==void 0&&_c),_l.t1;case 26:throw $a("ChnLeave",{cname:this.channelId,lts:D.fromNumber(Date.now()),elapse:Nb(ga.startTime),errCode:Cw,sid:fc(ga.instanceId),userId:ga.context.uid},(_s=this.client.context.config.enableCloudProxy)!==null&&_s!==void 0&&_s),new id("The channel leave failure",{code:Cw,originalError:_l.t1});case 28:$a("ChnLeave",{cname:this.channelId,lts:D.fromNumber(Date.now()),elapse:Nb(ga.startTime),errCode:0,sid:fc(ga.instanceId),userId:ga.context.uid},(_t=this.client.context.config.enableCloudProxy)!==null&&_t!==void 0&&_t);case 29:case"end":return _l.stop()}},$,this,[[2,6],[11,19]])}));return function(){return _.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var _=za(W.mark(function $(_t){var ga,_s=this;return W.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:if(vs(_t,fp),this.client.connectionState!==Ld.CONNECTED||this.joinState==="JOINED"){_c.next=3;break}throw new ia("The channel does not join. Cannot do the operation",rI);case 3:if(this.client.connectionState!==Ld.RECONNECTING){_c.next=8;break}return ga=Date.now(),_c.next=7,new Promise(function(_l,Tl){var Cl,Pl=(Cl=za(W.mark(function Jl(){var zl;return W.wrap(function(Bl){for(;;)switch(Bl.prev=Bl.next){case 0:return zl=Date.now()-ga,Bl.prev=1,Bl.next=4,Uj({message:_t,peerId:_s.channelId,toPeer:!1,session:_s.getSession(),errorCodes:{NOT_LOGGED_IN:gp,TOO_OFTEN:rw},diff:zl,logger:_s.logger});case 4:_l(),Bl.next=12;break;case 7:Bl.prev=7,Bl.t0=Bl.catch(1),uc(Bl.t0)&&Tl(new Pc(vg(_s.name,"sendMessageToPeer",1e4),ep)),Sa(Bl.t0)&&Tl(Bl.t0),Tl(new Pa("Channel message send failure",{code:Zk,originalError:Bl.t0}));case 12:return Bl.prev=12,clearTimeout(Dl),Bl.finish(12);case 15:case"end":return Bl.stop()}},Jl,null,[[1,7,12,15]])})),function(){return Cl.apply(this,arguments)});_s.client.internalEmitter.once("RECONNECTED",Pl);var Dl=setTimeout(function(){_s.client.internalEmitter.off("RECONNECTED",Pl),Tl(new Pc(vg(_s.name,"sendMessageToPeer",1e4),ep))},9e3)});case 7:return _c.abrupt("return");case 8:if(this.client.connectionState===Ld.CONNECTED){_c.next=10;break}throw new ia("The client is not logged in. Cannot do the operation",gp);case 10:return _c.prev=10,_c.next=13,Uj({message:_t,peerId:this.channelId,toPeer:!1,session:this.getSession(),errorCodes:{NOT_LOGGED_IN:gp,TOO_OFTEN:rw},diff:0,logger:this.logger});case 13:_c.next=23;break;case 15:if(_c.prev=15,_c.t0=_c.catch(10),!uc(_c.t0)){_c.next=19;break}throw new Pc(vg(this.name,"sendMessage",1e4),ep);case 19:if(!Sa(_c.t0)){_c.next=22;break}throw this.logError(_c.t0),_c.t0;case 22:throw new id("The channel message send failure",Zk);case 23:case"end":return _c.stop()}},$,this,[[10,15]])}));return function($){return _.apply(this,arguments)}}()},{key:"getChannelMetadata",value:function(){var _=za(W.mark(function $(){var _t,ga;return W.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(this.client.connectionState===Ld.CONNECTED){_s.next=2;break}throw new ia("The client is not logged in. Cannot do the operation",oc);case 2:return _s.prev=2,_t=this.getSession().requestGetChannelMetaData(this.channelId),_s.next=6,_t.pipe(Wa(function(_c){return Wm(_c)})).toPromise();case 6:return ga=_s.sent,_s.abrupt("return",ga);case 10:if(_s.prev=10,_s.t0=_s.catch(2),!Sa(_s.t0)){_s.next=15;break}throw this.logError(_s.t0),_s.t0;case 15:throw new id("The channel metadata get failure",lp);case 16:case"end":return _s.stop()}},$,this,[[2,10]])}));return function(){return _.apply(this,arguments)}}()},{key:"setChannelMetadata",value:function(){var _=za(W.mark(function $(_t,ga){var _s;return W.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:if(this.client.connectionState===Ld.CONNECTED){_c.next=2;break}throw new ia("The client is not logged in. Cannot do the operation",oc);case 2:if(this.joinState==="JOINED"){_c.next=4;break}throw new ia("The channel does not join. Cannot do the operation",kj);case 4:return _c.prev=4,_s=this.getSession().requestSetChannelMetadata(_t,ga,this.channelId).toPromise(),_c.next=8,_s;case 8:_c.next=16;break;case 10:if(_c.prev=10,_c.t0=_c.catch(4),!Sa(_c.t0)){_c.next=15;break}throw this.logError(_c.t0),_c.t0;case 15:throw new id("The channel metadata set failure",He);case 16:case"end":return _c.stop()}},$,this,[[4,10]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"clearChannelMetadata",value:function(){var _=za(W.mark(function $(_t){var ga;return W.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(this.client.connectionState===Ld.CONNECTED){_s.next=2;break}throw new ia("The client is not logged in. Cannot do the operation",oc);case 2:if(this.joinState==="JOINED"){_s.next=4;break}throw new ia("The channel does not join. Cannot do the operation",kj);case 4:return _s.prev=4,ga=this.getSession().requestClearChannelMetadata(_t,this.channelId).toPromise(),_s.next=8,ga;case 8:_s.next=16;break;case 10:if(_s.prev=10,_s.t0=_s.catch(4),!Sa(_s.t0)){_s.next=15;break}throw this.logError(_s.t0),_s.t0;case 15:throw new id("The channel metadata clear failure",He);case 16:case"end":return _s.stop()}},$,this,[[4,10]])}));return function($){return _.apply(this,arguments)}}()},{key:"addChannelMetadata",value:function(){var _=za(W.mark(function $(_t,ga){var _s;return W.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:if(this.client.connectionState===Ld.CONNECTED){_c.next=2;break}throw new ia("The client is not logged in. Cannot do the operation",oc);case 2:if(this.joinState==="JOINED"){_c.next=4;break}throw new ia("The channel does not join. Cannot do the operation",kj);case 4:return _c.prev=4,_s=this.getSession().requestAddChannelMetadata(_t,ga,this.channelId).toPromise(),_c.next=8,_s;case 8:_c.next=16;break;case 10:if(_c.prev=10,_c.t0=_c.catch(4),!Sa(_c.t0)){_c.next=15;break}throw this.logError(_c.t0),_c.t0;case 15:throw new id("The channel metadata clear failure",He);case 16:case"end":return _c.stop()}},$,this,[[4,10]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"updateChannelMetadata",value:function(){var _=za(W.mark(function $(_t,ga){var _s;return W.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:if(this.client.connectionState===Ld.CONNECTED){_c.next=2;break}throw new ia("The client is not logged in. Cannot do the operation",oc);case 2:if(this.joinState==="JOINED"){_c.next=4;break}throw new ia("The channel does not join. Cannot do the operation",kj);case 4:return _c.prev=4,_s=this.getSession().requestUpdateChannelMetadata(_t,ga,this.channelId).toPromise(),_c.next=8,_s;case 8:_c.next=16;break;case 10:if(_c.prev=10,_c.t0=_c.catch(4),!Sa(_c.t0)){_c.next=15;break}throw this.logError(_c.t0),_c.t0;case 15:throw new id("The channel metadata clear failure",He);case 16:case"end":return _c.stop()}},$,this,[[4,10]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"deleteChannelMetadata",value:function(){var _=za(W.mark(function $(_t,ga){var _s;return W.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:if(this.client.connectionState===Ld.CONNECTED){_c.next=2;break}throw new ia("The client is not logged in. Cannot do the operation",oc);case 2:if(this.joinState==="JOINED"){_c.next=4;break}throw new ia("The channel does not join. Cannot do the operation",kj);case 4:return _c.prev=4,_s=this.getSession().requestDeleteChannelMetadata(_t,ga,this.channelId).toPromise(),_c.next=8,_s;case 8:_c.next=16;break;case 10:if(_c.prev=10,_c.t0=_c.catch(4),!Sa(_c.t0)){_c.next=15;break}throw this.logError(_c.t0),_c.t0;case 15:throw new id("The channel metadata clear failure",He);case 16:case"end":return _c.stop()}},$,this,[[4,10]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"getMembers",value:function(){var _=za(W.mark(function $(){var _t,ga;return W.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(_s.prev=0,this.client.connectionState===Ld.CONNECTED){_s.next=3;break}throw new ia("The client is not logged in. Cannot do the operation",yI);case 3:if(this.joinState==="JOINED"){_s.next=5;break}throw new ia("The channel does not join. Cannot do the operation",xI);case 5:return _t=this.getSession().requestChannelMemberList(this.channelId),_s.next=8,_t.pipe(Wa(function(_c){return _c.memberInfos.map(function(_l){return _l.account})})).toPromise();case 8:return ga=_s.sent,this.info("Channel %s - get members success, %o",wb(this.channelId),ga.map(wb)),_s.abrupt("return",ga);case 13:if(_s.prev=13,_s.t0=_s.catch(0),!Sa(_s.t0)){_s.next=18;break}throw this.logError(_s.t0),_s.t0;case 18:throw new id("The channel members get failure",vI);case 19:case"end":return _s.stop()}},$,this,[[0,13]])}));return function(){return _.apply(this,arguments)}}()},{key:"clearChannel",value:function(){var _=za(W.mark(function $(_t){var ga=this;return W.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(_t.emit("channelLeft",this.channelId),this.joinState!=="JOINING"){_s.next=4;break}return _s.next=4,this.joinPromise;case 4:this.joinState="LEFT",this.memberLeftLru.empty(),this.memberJoinedLru.empty(),this.attributesSeqLru.empty(),this.memberJoinStateLru.empty(),this.memberCount=0,_t.removeListener("channelTextMessage",this.onChannelTextMessage),_t.removeListener("channelRawMessage",this.onChannelRawMessage),_t.removeListener("memberNotice",this.onMemberNotice),_t.removeListener("channelAttributesUpdated",this.onAttributesUpdated),_t.removeListener("channelMetaDataUpdated",this.onChannelMetaDataUpdated),this.client.internalEmitter.removeListener("channelMemberCountUpdated",this.onChannelMemberCountUpdated),this.client.internalEmitter.removeListener("LOGOUT",this.onLogout),_t.usedChannelIds=_t.usedChannelIds.filter(function(_c){return _c!==ga.channelId});case 18:case"end":return _s.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()}]),e}(Dd()),Na(lb.prototype,"join",[je],Object.getOwnPropertyDescriptor(lb.prototype,"join"),lb.prototype),Na(lb.prototype,"leave",[je],Object.getOwnPropertyDescriptor(lb.prototype,"leave"),lb.prototype),Na(lb.prototype,"sendMessage",[je],Object.getOwnPropertyDescriptor(lb.prototype,"sendMessage"),lb.prototype),Na(lb.prototype,"getChannelMetadata",[gb],Object.getOwnPropertyDescriptor(lb.prototype,"getChannelMetadata"),lb.prototype),Na(lb.prototype,"setChannelMetadata",[gb],Object.getOwnPropertyDescriptor(lb.prototype,"setChannelMetadata"),lb.prototype),Na(lb.prototype,"clearChannelMetadata",[gb],Object.getOwnPropertyDescriptor(lb.prototype,"clearChannelMetadata"),lb.prototype),Na(lb.prototype,"addChannelMetadata",[gb],Object.getOwnPropertyDescriptor(lb.prototype,"addChannelMetadata"),lb.prototype),Na(lb.prototype,"updateChannelMetadata",[gb],Object.getOwnPropertyDescriptor(lb.prototype,"updateChannelMetadata"),lb.prototype),Na(lb.prototype,"deleteChannelMetadata",[gb],Object.getOwnPropertyDescriptor(lb.prototype,"deleteChannelMetadata"),lb.prototype),Na(lb.prototype,"getMembers",[gb],Object.getOwnPropertyDescriptor(lb.prototype,"getMembers"),lb.prototype),lb),ka,Jc=Oa.ConnectionChangeReason,Ea=Oa.ConnectionState,FA={DISCONNECTED:1,CONNECTING:2,CONNECTED:3,RECONNECTING:4,ABORTED:5},JP={LOGIN:1,LOGIN_SUCCESS:2,LOGIN_FAILURE:3,LOGIN_TIMEOUT:4,INTERRUPTED:5,LOGOUT:6,BANNED_BY_SERVER:7,REMOTE_LOGIN:8,TOKEN_EXPIRED:9},KP=(ka=function(i){function e(_,$,_t,ga){ab(this,e);var _s=c.call(this,$,"RtmClient",!0);return E(L(_s),"connectionState",Ea.DISCONNECTED),E(L(_s),"internalEmitter",new kb),E(L(_s),"context",void 0),E(L(_s),"attributes",{}),E(L(_s),"loginPromise",void 0),E(L(_s),"attributeDrafts",new Set),E(L(_s),"session",void 0),E(L(_s),"lastLoginTime",void 0),E(L(_s),"reconnId",0),E(L(_s),"channelAttributesCacheLru",new ue(void 0,{maxlen:1e4})),E(L(_s),"invitationManager",void 0),E(L(_s),"subscribedPeerStatusCache",{}),E(L(_s),"subscribedUserMetaCache",{}),E(L(_s),"pendingPeerStatusSubCount",0),E(L(_s),"peerStatusSeqLru",new ue(void 0,{maxlen:1e4})),E(L(_s),"peerUnreachableTimers",{}),E(L(_s),"setParameters",void 0),E(L(_s),"updateConfig",void 0),E(L(_s),"blacklistedIP",{}),E(L(_s),"TokenPrivilegeWillExpireHandler",function(){_s.emit("TokenPrivilegeWillExpire")}),E(L(_s),"userMetaDataUpdatedHandler",function(_c){var _l=_c.uid;_c=_c.data,_s.subscribedUserMetaCache[_l]&&_s.emit("UserMetaDataUpdated",_l,_c)}),E(L(_s),"userDropHandler",function(_c){if(_s.connectionState!==Ea.ABORTED)switch(_c){case 2:_s.logError("Server banned because of token is expired"),_s.onConnectionStateChanged(Ea.ABORTED,Jc.TOKEN_EXPIRED),_s.emit("TokenExpired");break;case 11:_s.logError("Kicked off by remote session"),_s.onConnectionStateChanged(Ea.ABORTED,Jc.REMOTE_LOGIN);break;case 14:case 15:case 16:_s.logError("Server banned because of illegal ".concat({14:"User ID",15:"IP",16:"Channel Name"}[_c])),_s.onConnectionStateChanged(Ea.ABORTED,Jc.BANNED_BY_SERVER);break;case 10019:_s.logError("Kicked off by authorization"),_s.onConnectionStateChanged(Ea.ABORTED,Jc.BANNED_BY_SERVER);break;default:_s.logError("User kicked off for unknown code: ".concat(_c)),_s.onConnectionStateChanged(Ea.ABORTED,Jc.INTERRUPTED)}}),_s.context=new yL(_,_t,$),_s.context.config=_t,_s.setParameters=ga.bind(L(_s)),_s.updateConfig=ga.bind(L(_s)),_s.invitationManager=new GP(function(){return _s.session},$),_s.invitationManager.on("remoteInvitationInstance",function(_c){_s.emit("RemoteInvitationReceived",_c)}),_s.setMaxListeners(512),_s.internalEmitter.setMaxListeners(512),_s}nb(e,i);var o,c=ob(e);return Qb(e,[{key:"renewToken",value:(o=za(W.mark(function _($){var _t,ga,_s,_c,_l=this;return W.wrap(function(Tl){for(;;)switch(Tl.prev=Tl.next){case 0:if(typeof $=="string"&&$.length!==0){Tl.next=2;break}throw new ja("Invalid argument",KI);case 2:if(this.connectionState!==Ea.ABORTED){Tl.next=5;break}return Tl.next=5,new Promise(function(){});case 5:if(this.connectionState===Ea.CONNECTED||this.connectionState===Ea.RECONNECTING){Tl.next=7;break}throw new ia("The client is not logged in",Mw);case 7:if(this.session!==void 0){Tl.next=9;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return Tl.prev=9,_t=this.context.token,this.context.token=$,Tl.next=14,this.session.connection.apClient.getApEdgeInfo$(!1).pipe(Zf(function(){return Error("No available edge address to connect")}),Zg(function(Cl){return Cl.pipe(Ka(function(Pl){if(Sa(Pl))throw Pl}),mf(2500),Xb(4))}),Xb(1),Oc(2e4),Rb(function(Cl){return uc(Cl)&&_l.warn("renewToken timed out"),Va(Cl)})).toPromise();case 14:ga=Tl.sent,_s=ga.ticket,Tl.next=27;break;case 18:if(Tl.prev=18,Tl.t0=Tl.catch(9),this.context.token=_t,Tl.t0.code!==Fw&&Tl.t0.code!==Gw){Tl.next=23;break}throw new Gh("Invalid token",MI);case 23:if(Tl.t0.code!==bl){Tl.next=25;break}throw new Gh("The token expired",LI);case 25:if(!uc(Tl.t0)){Tl.next=27;break}throw new Pc("Renew token timed out",jp);case 27:_c=this.session,this.session.requestUpdateEdgeTicket(_s).toPromise().then(function(Cl){if(Cl.code!==0)throw new Pa(["RenewToken failure. The response code is %d",Cl.code],jp);_c.curLoginSockets.filter(function(Pl){return Pl!==void 0}).forEach(function(Pl){return Pl.ticket=_s})});case 29:case"end":return Tl.stop()}},_,this,[[9,18]])})),function(_){return o.apply(this,arguments)})},{key:"queryPeersOnlineStatus",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c=this;return W.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(this.connectionState===Ea.CONNECTED){_l.next=2;break}throw new ia("The client is not logged in",JI);case 2:if(this.session!==void 0){_l.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(!(!Array.isArray(_t)||_t.length===0||_t.some(function(Tl){return!yb(Tl)})||256<_t.length)){_l.next=6;break}throw new ja("invalid arguments",Lw);case 6:return _l.next=8,this.session.requestPeersOnlineStatus(_t).toPromise();case 8:return ga=_l.sent,_s=Pe(Ro(ga.userInfos,"account"),function(Tl){return!!Tl.ts}),Object.keys(_s).forEach(function(Tl){if(Tl in _c.subscribedPeerStatusCache&&_c.subscribedPeerStatusCache[Tl]!==Oa.PeerOnlineState.UNREACHABLE){var Cl=_s[Tl]?Oa.PeerOnlineState.ONLINE:Oa.PeerOnlineState.OFFLINE;_c.emit("PeersOnlineStatusChanged",E({},Tl,Cl)),_c.subscribedPeerStatusCache[Tl]=Cl}}),_l.abrupt("return",_s);case 12:case"end":return _l.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"getChannelMemberCount",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c,_l,Tl,Cl,Pl,Dl,Jl;return W.wrap(function(zl){for(;;)switch(zl.prev=zl.next){case 0:if(this.connectionState===Ea.CONNECTED){zl.next=2;break}throw new ia("The client is not logged in",uI);case 2:if(this.session!==void 0){zl.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_t)&&_t.every(function(Bl){return typeof Bl=="string"})&&_t.length!==0){zl.next=6;break}throw new ja("Invalid arguments: channelIds",tw);case 6:if(!(32<_t.length)){zl.next=8;break}throw new ja("getChannelMemberCount exceed limit of 32 channelIds",tI);case 8:ga=0;case 9:if(!(ga<_t.length)){zl.next=16;break}if(yb(_s=_t[ga])){zl.next=13;break}throw new ja(["getChannelMemberCount channel id %s is invalid",_s],tw);case 13:ga++,zl.next=9;break;case 16:return zl.next=18,this.session.requestGetChannelMemberCount(_t).toPromise();case 18:for(_c=zl.sent,_l=_c.groupInfos,Tl={},Cl=0;Cl<_l.length;Cl++)Pl=_l[Cl],Dl=Pl.group,Jl=Pl.memberCount,yb(Dl)&&typeof Jl=="number"&&(this.internalEmitter.emit("channelMemberCountUpdated",Dl,Jl),Tl[Dl]=Jl);return zl.abrupt("return",Tl);case 23:case"end":return zl.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"setLocalUserAttributes",value:function(){var _=za(W.mark(function $(_t){var ga,_s;return W.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:if(ri({attributes:_t,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===Ea.CONNECTED){_c.next=3;break}throw new ia("The client is not logged in",Cd);case 3:if(this.session!==void 0){_c.next=5;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return ga=this.session.requestSetLocalUserAttributes(_t).toPromise(),_s={attribute:_t,promise:ga},this.attributeDrafts.add(_s),_c.prev=8,_c.next=11,ga;case 11:this.attributes=_t,_c.next=19;break;case 14:if(_c.prev=14,_c.t0=_c.catch(8),!Sa(_c.t0)){_c.next=18;break}throw _c.t0;case 18:throw new ja("arguments is not valid",Ub);case 19:return _c.prev=19,this.attributeDrafts.delete(_s),_c.finish(19);case 22:case"end":return _c.stop()}},$,this,[[8,14,19,22]])}));return function($){return _.apply(this,arguments)}}()},{key:"setChannelAttributes",value:function(){var _=za(W.mark(function $(_t,ga){var _s,_c,_l,Tl,Cl,Pl=arguments;return W.wrap(function(Dl){for(;;)switch(Dl.prev=Dl.next){case 0:if(_s=2<Pl.length&&Pl[2]!==void 0?Pl[2]:{},_c=_s.enableNotificationToChannelMembers,_l=_c!==void 0&&_c,ri({attributes:ga,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===Ea.CONNECTED){Dl.next=4;break}throw new ia("The client is not logged in",Cd);case 4:if(this.session!==void 0){Dl.next=6;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return Tl=this.session.requestSetChannelAttributes(_t,ga,_l).toPromise(),Dl.prev=7,Dl.next=10,Tl;case 10:Cl=Pe(ga,function(Jl){return new Blob([Jl]).size}),this.channelAttributesCacheLru.set(_t,Cl),Dl.next=19;break;case 14:if(Dl.prev=14,Dl.t0=Dl.catch(7),!Sa(Dl.t0)){Dl.next=18;break}throw Dl.t0;case 18:throw new ja("arguments is not valid",Ub);case 19:case"end":return Dl.stop()}},$,this,[[7,14]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"addOrUpdateLocalUserAttributes",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c;return W.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(ga=tb(tb({},this.attributes),_t),ri({attributes:_t,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),ri({attributes:ga,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===Ea.CONNECTED){_l.next=5;break}throw new ia("The client is not logged in",Cd);case 5:if(this.session!==void 0){_l.next=7;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return _s=this.session.requestAddOrUpdateLocalUserAttributes(_t).toPromise(),_c={attribute:ga,promise:_s},this.attributeDrafts.add(_c),_l.prev=10,_l.next=13,_s;case 13:this.attributes=ga,_l.next=21;break;case 16:if(_l.prev=16,_l.t0=_l.catch(10),!Sa(_l.t0)){_l.next=20;break}throw _l.t0;case 20:throw new ja("arguments is not valid",Lw);case 21:return _l.prev=21,this.attributeDrafts.delete(_c),_l.finish(21);case 24:case"end":return _l.stop()}},$,this,[[10,16,21,24]])}));return function($){return _.apply(this,arguments)}}()},{key:"addOrUpdateChannelAttributes",value:function(){var _=za(W.mark(function $(_t,ga){var _s,_c,_l,Tl,Cl,Pl,Dl,Jl=arguments;return W.wrap(function(zl){for(;;)switch(zl.prev=zl.next){case 0:if(_s=2<Jl.length&&Jl[2]!==void 0?Jl[2]:{},_c=_s.enableNotificationToChannelMembers,_l=_c!==void 0&&_c,Tl=this.channelAttributesCacheLru.get(_t,{}),Cl=Pe(ga,function(Bl){return new Blob([Bl]).size}),Pl=tb(tb({},Tl),Cl),ri({attributes:ga,attrSizeMap:Pl,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===Ea.CONNECTED){zl.next=7;break}throw new ia("The client is not logged in",Cd);case 7:if(this.session!==void 0){zl.next=9;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return Dl=this.session.requestAddOrUpdateChannelAttributes(_t,ga,_l).toPromise(),zl.prev=10,zl.next=13,Dl;case 13:this.channelAttributesCacheLru.set(_t,Pl),zl.next=21;break;case 16:if(zl.prev=16,zl.t0=zl.catch(10),!Sa(zl.t0)){zl.next=20;break}throw zl.t0;case 20:throw new ja("arguments is not valid",Ub);case 21:case"end":return zl.stop()}},$,this,[[10,16]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"deleteLocalUserAttributesByKeys",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c,_l;return W.wrap(function(Tl){for(;;)switch(Tl.prev=Tl.next){case 0:if(Array.isArray(_t)&&_t.length!==0&&!_t.some(function(Cl){return Cl.length===0})){Tl.next=2;break}throw new ia("arguments is not valid",Ub);case 2:if(this.connectionState===Ea.CONNECTED){Tl.next=4;break}throw new ia("The client is not logged in",Cd);case 4:if(this.session!==void 0){Tl.next=6;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return ga=this.session.requestDeleteLocalUserAttributesByKeys(_t).toPromise(),_s={attribute:Oo(this.attributes,_t),promise:ga},this.attributeDrafts.add(_s),Tl.prev=9,Tl.next=12,ga;case 12:for(_c=0;_c<_t.length;_c++)_l=_t[_c],delete this.attributes[_l];Tl.next=20;break;case 15:if(Tl.prev=15,Tl.t0=Tl.catch(9),!Sa(Tl.t0)){Tl.next=19;break}throw Tl.t0;case 19:throw new ja("arguments is not valid",Ub);case 20:return Tl.prev=20,this.attributeDrafts.delete(_s),Tl.finish(20);case 23:case"end":return Tl.stop()}},$,this,[[9,15,20,23]])}));return function($){return _.apply(this,arguments)}}()},{key:"deleteChannelAttributesByKeys",value:function(){var _=za(W.mark(function $(_t,ga){var _s,_c,_l,Tl,Cl,Pl,Dl,Jl=arguments;return W.wrap(function(zl){for(;;)switch(zl.prev=zl.next){case 0:if(_s=2<Jl.length&&Jl[2]!==void 0?Jl[2]:{},_c=_s.enableNotificationToChannelMembers,_l=_c!==void 0&&_c,Array.isArray(ga)&&ga.length!==0&&yb(_t)&&!ga.some(function(Bl){return Bl.length===0||512<Bl.length})){zl.next=3;break}throw new ia("arguments is not valid",Ub);case 3:if(this.connectionState===Ea.CONNECTED){zl.next=5;break}throw new ia("The client is not logged in",Cd);case 5:if(this.session!==void 0){zl.next=7;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return Tl=this.session.requestDeleteChannelAttributesByKeys(_t,ga,_l).toPromise(),zl.prev=8,zl.next=11,Tl;case 11:if(Cl=this.channelAttributesCacheLru.get(_t))for(Pl=0;Pl<ga.length;Pl++)Dl=ga[Pl],delete Cl[Dl];zl.next=20;break;case 15:if(zl.prev=15,zl.t0=zl.catch(8),!Sa(zl.t0)){zl.next=19;break}throw zl.t0;case 19:throw new ja("arguments is not valid",Ub);case 20:case"end":return zl.stop()}},$,this,[[8,15]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"clearLocalUserAttributes",value:function(){var _=za(W.mark(function $(){var _t,ga;return W.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(this.connectionState===Ea.CONNECTED){_s.next=2;break}throw new ia("The client is not logged in",Cd);case 2:if(this.session!==void 0){_s.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return _t=this.session.requestClearLocalUserAttributes().toPromise(),ga={attribute:{},promise:_t},this.attributeDrafts.add(ga),_s.prev=7,_s.next=10,_t;case 10:this.attributes={},_s.next=18;break;case 13:if(_s.prev=13,_s.t0=_s.catch(7),!Sa(_s.t0)){_s.next=17;break}throw _s.t0;case 17:throw new ja("arguments is not valid",Ub);case 18:return _s.prev=18,this.attributeDrafts.delete(ga),_s.finish(18);case 21:case"end":return _s.stop()}},$,this,[[7,13,18,21]])}));return function(){return _.apply(this,arguments)}}()},{key:"clearChannelAttributes",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c,_l,Tl=arguments;return W.wrap(function(Cl){for(;;)switch(Cl.prev=Cl.next){case 0:if(ga=1<Tl.length&&Tl[1]!==void 0?Tl[1]:{},_s=ga.enableNotificationToChannelMembers,_c=_s!==void 0&&_s,this.connectionState===Ea.CONNECTED){Cl.next=3;break}throw new ia("The client is not logged in",Cd);case 3:if(this.session!==void 0){Cl.next=5;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return _l=this.session.requestClearChannelAttributes(_t,_c).toPromise(),Cl.prev=6,Cl.next=9,_l;case 9:this.channelAttributesCacheLru.delete(_t),Cl.next=17;break;case 12:if(Cl.prev=12,Cl.t0=Cl.catch(6),!Sa(Cl.t0)){Cl.next=16;break}throw Cl.t0;case 16:throw new ja("arguments is not valid",Ub);case 17:case"end":return Cl.stop()}},$,this,[[6,12]])}));return function($){return _.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c;return W.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(yb(_t)){_l.next=2;break}throw new ja("Not a valid user ID",Ub);case 2:if(this.connectionState===Ea.CONNECTED){_l.next=4;break}throw new ia("The client is not logged in",Cd);case 4:if(this.session!==void 0){_l.next=6;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return _l.prev=6,_l.next=9,this.session.requestGetUserAttributeKeys(_t).toPromise();case 9:return ga=_l.sent,_s=ga.keys,_l.next=13,this.session.requestGetUserAttributesByKeys(_t,_s.slice(0,512)).toPromise();case 13:_c=_l.sent,_l.next=21;break;case 16:if(_l.prev=16,_l.t0=_l.catch(6),!Sa(_l.t0)){_l.next=20;break}throw _l.t0;case 20:throw new ja("arguments is not valid",Ub);case 21:return _l.abrupt("return",Dv(_c.attributeInfos.map(function(Tl){return[Tl.key,Tl.value]})));case 22:case"end":return _l.stop()}},$,this,[[6,16]])}));return function($){return _.apply(this,arguments)}}()},{key:"getChannelAttributes",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c,_l,Tl,Cl,Pl,Dl,Jl,zl,Bl;return W.wrap(function(Vl){for(;;)switch(Vl.prev=Vl.next){case 0:if(yb(_t)){Vl.next=2;break}throw new ja("Not a valid channel ID",Ub);case 2:if(this.connectionState===Ea.CONNECTED){Vl.next=4;break}throw new ia("The client is not logged in",Cd);case 4:if(this.session!==void 0){Vl.next=6;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return Vl.prev=6,Vl.next=9,this.session.requestGetChannelAttributesKeys(_t).toPromise();case 9:return ga=Vl.sent,_s=ga.keys,Vl.next=13,this.session.requestGetChannelAttributesByKeys(_t,_s).toPromise();case 13:_c=Vl.sent,_l=_c.attributeMaps,Vl.next=22;break;case 17:if(Vl.prev=17,Vl.t0=Vl.catch(6),!Sa(Vl.t0)){Vl.next=21;break}throw Vl.t0;case 21:throw new ja("arguments is not valid",Ub);case 22:Tl={},Cl=0;case 24:if(!(Cl<_l.length)){Vl.next=32;break}if(Pl=_l[Cl],Dl=Pl.key,Jl=Pl.ms,zl=Pl.value,Bl=Pl.origin,typeof Dl=="string"&&D.isLong(Jl)&&typeof zl=="string"&&yb(Bl)){Vl.next=28;break}return Vl.abrupt("break",32);case 28:Tl[Dl]={value:zl,lastUpdateUserId:Bl,lastUpdateTs:Jl.toNumber()};case 29:Cl++,Vl.next=24;break;case 32:return this.channelAttributesCacheLru.set(_t,Pe(Tl,function(_d){return new Blob([_d.value]).size})),Vl.abrupt("return",Tl);case 34:case"end":return Vl.stop()}},$,this,[[6,17]])}));return function($){return _.apply(this,arguments)}}()},{key:"getChannelAttributesByKeys",value:function(){var _=za(W.mark(function $(_t,ga){var _s,_c,_l,Tl,Cl,Pl,Dl,Jl,zl,Bl;return W.wrap(function(Vl){for(;;)switch(Vl.prev=Vl.next){case 0:if(this.connectionState===Ea.CONNECTED){Vl.next=2;break}throw new ia("The client is not logged in",Cd);case 2:if(this.session!==void 0){Vl.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return os(_t,ga),Vl.prev=5,Vl.next=8,this.session.requestGetChannelAttributesByKeys(_t,ga).toPromise();case 8:_s=Vl.sent,_c=_s.attributeMaps,Vl.next=17;break;case 12:if(Vl.prev=12,Vl.t0=Vl.catch(5),!Sa(Vl.t0)){Vl.next=16;break}throw Vl.t0;case 16:throw new ja("arguments is not valid",Ub);case 17:_l={},Tl=this.channelAttributesCacheLru.get(_t,{}),Cl=0;case 20:if(!(Cl<_c.length)){Vl.next=29;break}if(Pl=_c[Cl],Dl=Pl.key,Jl=Pl.ms,zl=Pl.value,Bl=Pl.origin,typeof Dl=="string"&&D.isLong(Jl)&&typeof zl=="string"&&yb(Bl)){Vl.next=24;break}return Vl.abrupt("break",29);case 24:Tl[Dl]=new Blob([zl]).size,_l[Dl]={value:zl,lastUpdateUserId:Bl,lastUpdateTs:Jl.toNumber()};case 26:Cl++,Vl.next=20;break;case 29:return this.channelAttributesCacheLru.set(_t,Tl),Vl.abrupt("return",_l);case 31:case"end":return Vl.stop()}},$,this,[[5,12]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"getUserAttributesByKeys",value:function(){var _=za(W.mark(function $(_t,ga){var _s;return W.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:if(this.connectionState===Ea.CONNECTED){_c.next=2;break}throw new ia("The client is not logged in",Cd);case 2:if(this.session!==void 0){_c.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return os(_t,ga),_c.prev=5,_c.next=8,this.session.requestGetUserAttributesByKeys(_t,ga).toPromise();case 8:_s=_c.sent,_c.next=16;break;case 11:if(_c.prev=11,_c.t0=_c.catch(5),!Sa(_c.t0)){_c.next=15;break}throw _c.t0;case 15:throw new ja("arguments is not valid",Ub);case 16:return _c.abrupt("return",Dv(_s.attributeInfos.map(function(_l){return[_l.key,_l.value]})));case 17:case"end":return _c.stop()}},$,this,[[5,11]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"getUserMetadata",value:function(){var _=za(W.mark(function $(_t){var ga,_s;return W.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:if(this.connectionState===Ea.CONNECTED){_c.next=2;break}throw new ia("The client is not logged in",oc);case 2:if(this.session!==void 0){_c.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(!_t.split("").includes(".")){_c.next=6;break}throw new ja("The uid cannot contain the character .",Mb);case 6:return _c.prev=6,_c.next=9,this.session.requestGetLocalMetaData(_t).toPromise();case 9:return ga=_c.sent,_s=Wm(ga),_c.abrupt("return",_s);case 14:if(_c.prev=14,_c.t0=_c.catch(6),!Sa(_c.t0)){_c.next=18;break}throw _c.t0;case 18:throw new ja("arguments is not valid",Mb);case 19:case"end":return _c.stop()}},$,this,[[6,14]])}));return function($){return _.apply(this,arguments)}}()},{key:"setLocalUserMetadata",value:function(){var _=za(W.mark(function $(_t,ga){return W.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(this.connectionState===Ea.CONNECTED){_s.next=2;break}throw new ia("The client is not logged in",oc);case 2:if(this.session!==void 0){_s.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return _s.prev=4,_s.next=7,this.session.requestSetLocalMetadata(_t,ga).toPromise();case 7:_s.next=14;break;case 9:if(_s.prev=9,_s.t0=_s.catch(4),!Sa(_s.t0)){_s.next=13;break}throw _s.t0;case 13:throw new ja("arguments is not valid",Mb);case 14:case"end":return _s.stop()}},$,this,[[4,9]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"clearLocalUserMetadata",value:function(){var _=za(W.mark(function $(_t){return W.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:if(this.connectionState===Ea.CONNECTED){ga.next=2;break}throw new ia("The client is not logged in",oc);case 2:if(this.session!==void 0){ga.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return ga.prev=4,ga.next=7,this.session.requestClearLocalMetadata(_t).toPromise();case 7:ga.next=14;break;case 9:if(ga.prev=9,ga.t0=ga.catch(4),!Sa(ga.t0)){ga.next=13;break}throw ga.t0;case 13:throw new ja("arguments is not valid",Mb);case 14:case"end":return ga.stop()}},$,this,[[4,9]])}));return function($){return _.apply(this,arguments)}}()},{key:"addLocalUserMetadata",value:function(){var _=za(W.mark(function $(_t,ga){return W.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(this.connectionState===Ea.CONNECTED){_s.next=2;break}throw new ia("The client is not logged in",oc);case 2:if(this.session!==void 0){_s.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return _s.prev=4,_s.next=7,this.session.requestAddLocalMetadata(_t,ga).toPromise();case 7:_s.next=14;break;case 9:if(_s.prev=9,_s.t0=_s.catch(4),!Sa(_s.t0)){_s.next=13;break}throw _s.t0;case 13:throw new ja("arguments is not valid",Mb);case 14:case"end":return _s.stop()}},$,this,[[4,9]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"updateLocalUserMetadata",value:function(){var _=za(W.mark(function $(_t,ga){return W.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(this.connectionState===Ea.CONNECTED){_s.next=2;break}throw new ia("The client is not logged in",oc);case 2:if(this.session!==void 0){_s.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return _s.prev=4,_s.next=7,this.session.requestUpdateLocalMetadata(_t,ga).toPromise();case 7:_s.next=14;break;case 9:if(_s.prev=9,_s.t0=_s.catch(4),!Sa(_s.t0)){_s.next=13;break}throw _s.t0;case 13:throw new ja("arguments is not valid",Mb);case 14:case"end":return _s.stop()}},$,this,[[4,9]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"deleteLocalUserMetadata",value:function(){var _=za(W.mark(function $(_t,ga){return W.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(this.connectionState===Ea.CONNECTED){_s.next=2;break}throw new ia("The client is not logged in",oc);case 2:if(this.session!==void 0){_s.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return _s.prev=4,_s.next=7,this.session.requestDeleteLocalMetadata(_t,ga).toPromise();case 7:_s.next=14;break;case 9:if(_s.prev=9,_s.t0=_s.catch(4),!Sa(_s.t0)){_s.next=13;break}throw _s.t0;case 13:throw new ja("arguments is not valid",Mb);case 14:case"end":return _s.stop()}},$,this,[[4,9]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"subscribeUserMetadata",value:function(){var _=za(W.mark(function $(_t){return W.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:if(this.connectionState===Ea.CONNECTED){ga.next=2;break}throw new ia("The client is not logged in",oc);case 2:if(this.session!==void 0){ga.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(yb(_t)){ga.next=6;break}throw new ja("Not a valid user ID",dl);case 6:if(!_t.split("").includes(".")){ga.next=8;break}throw new ja("The uid cannot contain the character .",dl);case 8:if(!(51<=Object.values(this.subscribedUserMetaCache).filter(function(_s){return _s===Oa.subscribedState.SUBSCRIBED}).length)){ga.next=10;break}throw new Dc("Subscribed user metadata overflows",OI);case 10:return ga.prev=10,ga.next=13,this.session.requestSubscribeUserMetadata(_t,"NORMAL").toPromise();case 13:this.subscribedUserMetaCache[_t]=Oa.subscribedState.SUBSCRIBED,ga.next=21;break;case 16:if(ga.prev=16,ga.t0=ga.catch(10),!Sa(ga.t0)){ga.next=20;break}throw ga.t0;case 20:throw new ja("arguments is not valid",Mb);case 21:case"end":return ga.stop()}},$,this,[[10,16]])}));return function($){return _.apply(this,arguments)}}()},{key:"unsubscribeUserMetadata",value:function(){var _=za(W.mark(function $(_t){return W.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:if(this.connectionState===Ea.CONNECTED){ga.next=2;break}throw new ia("The client is not logged in",oc);case 2:if(this.session!==void 0){ga.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(yb(_t)){ga.next=6;break}throw new ja("Not a valid user ID",dl);case 6:if(!_t.split("").includes(".")){ga.next=8;break}throw new ja("The uid cannot contain the character .",dl);case 8:if(this.subscribedUserMetaCache[_t]&&this.subscribedUserMetaCache[_t]!==Oa.subscribedState.UNSUBSCRIBED){ga.next=10;break}throw new ia("The user can not be unsubscribed",PI);case 10:return ga.prev=10,ga.next=13,this.session.requestUnsubscribeUserMetadata(_t);case 13:this.subscribedUserMetaCache[_t]=Oa.subscribedState.UNSUBSCRIBED,ga.next=21;break;case 16:if(ga.prev=16,ga.t0=ga.catch(10),!Sa(ga.t0)){ga.next=20;break}throw ga.t0;case 20:throw new ja("arguments is not valid",Mb);case 21:case"end":return ga.stop()}},$,this,[[10,16]])}));return function($){return _.apply(this,arguments)}}()},{key:"login",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c,_l,Tl,Cl;return W.wrap(function(Pl){for(;;)switch(Pl.prev=Pl.next){case 0:if(Zr(!0),_s=Rj(),_c=_t.token,_t.token===this.context.appId&&(_c=void 0),$a("Session",{appId:this.context.appId,did:navigator.userAgent,elapse:Nb(this.session&&this.session.startTime),index:{index1:_t.uid,index2:this.context.appId,index3:"enableLogUpload=".concat(this.context.config.enableLogUpload)},installId:hj,lts:D.fromNumber(Date.now()),os:7,sid:fc(_s),token:_c||"",userId:_t.uid,ver:"1.6.0-205",buildno:928,subVersion:228,version:7},(ga=this.context.config.enableCloudProxy)!==null&&ga!==void 0&&ga,!0),Lg(_t)&&yb(_t.uid)){Pl.next=7;break}throw new ja("not a valid user id",al);case 7:if(typeof _c!="string"||!_c){Pl.next=11;break}this.context.token=_c,Pl.next=13;break;case 11:if(typeof _c=="string"||_c==null){Pl.next=13;break}throw new ja('The "token" is not a valid string.',al);case 13:return _l=Date.now(),this.context.sid=fc(_s),this.loginPromise=this.loginImpl({uid:_t.uid,instanceId:_s}),this.info("RTM Client logging in as ".concat(wb(_t.uid))),Pl.prev=17,Pl.next=20,this.loginPromise;case 20:return Pl.next=22,(Tl=this.session)===null||Tl===void 0?void 0:Tl.requestSubscribeUserMetadata(_t.uid,"JOIN").toPromise();case 22:this.subscribedUserMetaCache[_t.uid]=Oa.subscribedState.SUBSCRIBED,Pl.next=31;break;case 25:throw Pl.prev=25,Pl.t0=Pl.catch(17),Sa(Pl.t0)&&$a("Link",{ackedServerIp:"",destServerIp:"",ec:Pl.t0.code||1,sc:Pl.t0.serverCode,elapse:Nb(this.session&&this.session.startTime),lts:D.fromNumber(Date.now()),responseTime:Date.now()-_l,sid:fc(_s),userId:_t.uid},(Cl=this.context.config.enableCloudProxy)!==null&&Cl!==void 0&&Cl),this.context.token=void 0,this.context.socketUseProxy=!1,Pl.t0;case 31:return Pl.prev=31,this.loginPromise=void 0,Pl.finish(31);case 34:this.context.socketUseProxy&&this.emit("FallbackProxyConnected"),Zr(!1);case 36:case"end":return Pl.stop()}},$,this,[[17,25,31,34]])}));return function($){return _.apply(this,arguments)}}()},{key:"logout",value:function(){var _=za(W.mark(function $(){var _t;return W.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:if(!this.loginPromise){ga.next=3;break}return ga.next=3,this.loginPromise;case 3:if(this.connectionState!==Ea.DISCONNECTED){ga.next=6;break}throw this.logError("Already in logout state"),new ia("Logout failure. The client has already been logged out",Hw);case 6:if(this.internalEmitter.emit("LOGOUT"),this.connectionState!==Ea.ABORTED){ga.next=11;break}return this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'),this.onConnectionStateChanged(Ea.DISCONNECTED,Jc.LOGOUT),ga.abrupt("return");case 11:if(this.session!==void 0){ga.next=14;break}return this.onConnectionStateChanged(Ea.DISCONNECTED,Jc.LOGOUT),ga.abrupt("return");case 14:return $a("Logout",{elapse:Nb(this.session.startTime),lts:D.fromNumber(Date.now()),sid:fc(this.session.instanceId),userId:this.context.uid},(_t=this.context.config.enableCloudProxy)!==null&&_t!==void 0&&_t),ga.next=17,this.session.logoutHandler();case 17:this.onConnectionStateChanged(Ea.DISCONNECTED,Jc.LOGOUT),this.log("Log out success");case 19:case"end":return ga.stop()}},$,this)}));return function(){return _.apply(this,arguments)}}()},{key:"logoutSync",value:function(){var _,$=this;if(this.connectionState===Ea.DISCONNECTED)throw this.logError("Already in logout state"),new ia("Logout failure. The client has already been logged out",Hw);this.connectionState===Ea.ABORTED?this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'):this.session!==void 0&&($a("Logout",{elapse:Nb(this.session.startTime),lts:D.fromNumber(Date.now()),sid:fc(this.session.instanceId),userId:this.context.uid},(_=this.context.config.enableCloudProxy)!==null&&_!==void 0&&_),this.session.logoutHandler().then(function(){$.log("Log out success")})),this.onConnectionStateChanged(Ea.DISCONNECTED,Jc.LOGOUT)}},{key:"sendMessageToPeer",value:function(){var _=za(W.mark(function $(_t,ga){var _s,_c,_l=this;return W.wrap(function(Tl){for(;;)switch(Tl.prev=Tl.next){case 0:if(vs(_t,si),_s=_t.messageType==="TEXT"?vb.P2pSMsgNoOfflineFlag:vb.P2pRMsgNoOfflineFlag,this.connectionState!==Ea.RECONNECTING){Tl.next=5;break}return _c=Date.now(),Tl.abrupt("return",new Promise(function(Cl,Pl){var Dl,Jl=(Dl=za(W.mark(function Bl(){var Vl;return W.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:if(_l.session!==void 0){_d.next=2;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 2:return Vl=Date.now()-_c,_d.prev=3,_d.t0=Cl,_d.next=7,Uj({message:_t,peerId:ga,toPeer:!0,session:_l.session,errorCodes:{NOT_LOGGED_IN:ip,TOO_OFTEN:Jw},diff:Vl,logger:_l.logger});case 7:_d.t1=_d.sent,(0,_d.t0)(_d.t1),_d.next=18;break;case 11:_d.prev=11,_d.t2=_d.catch(3),uc(_d.t2)&&(_l.session.emit("messageCount",{messageCategory:_s,type:"common",key:"sentcount"}),_l.session.emit("messageCount",{messageCategory:_s,type:"common",key:"timeoutcount"}),Pl(new Pc(vg(_l.name,"sendMessageToPeer",1e4),hp))),Sa(_d.t2)&&Pl(_d.t2),_l.session.emit("messageCount",{messageCategory:_s,type:"common",key:"sentcount"}),_l.session.emit("messageCount",{messageCategory:_s,type:"common",key:"unknowerrorcount"}),Pl(new Pa("Peer-to-peer message send failure",{code:Iw,originalError:_d.t2}));case 18:return _d.prev=18,clearTimeout(zl),_d.finish(18);case 21:case"end":return _d.stop()}},Bl,null,[[3,11,18,21]])})),function(){return Dl.apply(this,arguments)});_l.internalEmitter.once("RECONNECTED",Jl);var zl=setTimeout(function(){_l.internalEmitter.off("RECONNECTED",Jl),Pl(new Pc(vg(_l.name,"sendMessageToPeer",1e4),hp))},9e3)}));case 5:if(this.connectionState===Ea.CONNECTED){Tl.next=7;break}throw new ia("Failed to send the peer-to-peer message. The client is not logged in",ip);case 7:if(this.session!==void 0){Tl.next=9;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return Tl.prev=9,Tl.next=12,Uj({message:_t,peerId:ga,toPeer:!0,session:this.session,errorCodes:{NOT_LOGGED_IN:ip,TOO_OFTEN:Jw},diff:0,logger:this.logger});case 12:return Tl.abrupt("return",Tl.sent);case 15:if(Tl.prev=15,Tl.t0=Tl.catch(9),!uc(Tl.t0)){Tl.next=21;break}throw this.session.emit("messageCount",{messageCategory:_s,type:"common",key:"sentcount"}),this.session.emit("messageCount",{messageCategory:_s,type:"common",key:"timeoutcount"}),new Pc(vg(this.name,"sendMessageToPeer",1e4),hp);case 21:if(!Sa(Tl.t0)){Tl.next=23;break}throw Tl.t0;case 23:throw this.session.emit("messageCount",{messageCategory:_s,type:"common",key:"sentcount"}),this.session.emit("messageCount",{messageCategory:_s,type:"common",key:"unknowerrorcount"}),new Pa("Peer-to-peer message send failure",{code:Iw,originalError:Tl.t0});case 26:case"end":return Tl.stop()}},$,this,[[9,15]])}));return function($,_t){return _.apply(this,arguments)}}()},{key:"createChannel",value:function(_){var $=this;if(!yb(_))throw new ja(["The %s in the arguments is invalid",Object.keys({channelId:_})[0]],sI);return new IP(_,function(){return $.session},this,this.logger)}},{key:"createMetadataItem",value:function(){return new Fs}},{key:"createLocalInvitation",value:function(_){if(!yb(_))throw new ja(["The %s in the arguments is invalid",Object.keys({calleeId:_})[0]],ve);return this.invitationManager.genLocalInvitation(_)}},{key:"subscribePeersOnlineStatus",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c,_l,Tl,Cl,Pl,Dl,Jl,zl,Bl,Vl,_d,Sp=this;return W.wrap(function(Up){for(;;)switch(Up.prev=Up.next){case 0:if(this.connectionState===Ea.CONNECTED){Up.next=2;break}throw new ia("The client is not logged in",kp);case 2:if(this.session!==void 0){Up.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_t)&&_t.length!==0){Up.next=6;break}throw new ja("Invalid arguments: peerIds",jj);case 6:ga=0;case 7:if(!(ga<_t.length)){Up.next=14;break}if(yb(_s=_t[ga])){Up.next=11;break}throw new ja(["subscribePeersOnlineStatus peer id %s is invalid",_s],jj);case 11:ga++,Up.next=7;break;case 14:if(!(512<(_c=_t&&_t.length?Do(_t):[]).length+Object.keys(this.subscribedPeerStatusCache).length+this.pendingPeerStatusSubCount)){Up.next=17;break}throw new Dc("Subscribed peers overflows",Ow);case 17:return this.pendingPeerStatusSubCount+=_c.length,Up.next=20,this.session.requestSubscribePeersOnlineStatus(_c).toPromise();case 20:_l=Up.sent,Tl=_l.errors,this.pendingPeerStatusSubCount-=_c.length,Cl=[],Pl=[],Dl=0;case 26:if(!(Dl<Tl.length)){Up.next=34;break}if(Jl=Tl[Dl],zl=Jl.code,typeof(Bl=Jl.account)=="string"){Up.next=30;break}throw new Pa("Returned account is invalid",Nw);case 30:zl!==0&&Cl.push(Bl);case 31:Dl++,Up.next=26;break;case 34:for(Vl=0;Vl<_c.length;Vl++)_d=_c[Vl],Cl.includes(_d)||(Pl.push(_d),this.subscribedPeerStatusCache[_d]=void 0);if(this.session.requestPeersOnlineStatus(Pl).pipe(Wa(function(Kp){return Pe(Ro(Kp.userInfos,"account"),function(Hp){return!!Hp.ts})})).subscribe(function(Kp){Kp=Pe(Kp,function(Hp,_m){return Hp=Hp?Oa.PeerOnlineState.ONLINE:Oa.PeerOnlineState.OFFLINE,Sp.subscribedPeerStatusCache[_m]=Hp}),Sp.emit("PeersOnlineStatusChanged",Kp)}),Cl.length===0){Up.next=38;break}throw new Pa("Subscription failed",Nw);case 38:case"end":return Up.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"unsubscribePeersOnlineStatus",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c,_l,Tl;return W.wrap(function(Cl){for(;;)switch(Cl.prev=Cl.next){case 0:if(this.connectionState===Ea.CONNECTED){Cl.next=2;break}throw new ia("The client is not logged in",kp);case 2:if(this.session!==void 0){Cl.next=4;break}throw new rb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_t)&&_t.length!==0){Cl.next=6;break}throw new ja("Invalid arguments: peerIds",jj);case 6:ga=0;case 7:if(!(ga<_t.length)){Cl.next=14;break}if(yb(_s=_t[ga])){Cl.next=11;break}throw new ja(["subscribePeersOnlineStatus peer id %s is invalid",_s],jj);case 11:ga++,Cl.next=7;break;case 14:if(!(512<_t.length)){Cl.next=16;break}throw new Dc("Unsubscribed peers overflows",Ow);case 16:for(_c=_t&&_t.length?Do(_t):[],this.session.requestUnsubscribePeersOnlineStatus(_c),_l=0;_l<_c.length;_l++)Tl=_c[_l],delete this.subscribedPeerStatusCache[Tl];case 19:case"end":return Cl.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"queryPeersBySubscriptionOption",value:function(){var _=za(W.mark(function $(_t){return W.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:if(this.connectionState===Ea.CONNECTED){ga.next=2;break}throw new ia("The client is not logged in",kp);case 2:if(_t!==Oa.PeerSubscriptionOption.ONLINE_STATUS){ga.next=4;break}return ga.abrupt("return",Object.keys(this.subscribedPeerStatusCache));case 4:throw new ja("Subscription option not supported",jj);case 5:case"end":return ga.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"createMessage",value:function(_){return _}},{key:"loginImpl",value:function(){var _=za(W.mark(function $(_t){var ga,_s,_c,_l,Tl,Cl,Pl,Dl,Jl=this;return W.wrap(function(zl){for(;;)switch(zl.prev=zl.next){case 0:if(ga=_t.uid,_s=_t.instanceId,_c=_t.forceLoginTime,_l=_c===void 0?0:_c,Tl=_s,!(this.lastLoginTime!==void 0&&500>Date.now()-this.lastLoginTime)){zl.next=4;break}throw new Fc(["The frequency of login exceeded the limit of %d queries per second",2],HI);case 4:if(this.connectionState===Ea.DISCONNECTED||_l!==0){zl.next=6;break}throw new ia("The SDK is either logging in or has logged in the Agora RTM system",FI);case 6:zl.prev=6,this.context.uid=ga,zl.next=13;break;case 10:throw zl.prev=10,zl.t0=zl.catch(6),new ja(["The %s in the arguments is invalid",Object.keys({uid:ga})[0]],al);case 13:return _l===0&&this.onConnectionStateChanged(Ea.CONNECTING,Jc.LOGIN),(Cl=new Gx(this.context,this.logger,!1)).blacklistedIP=this.blacklistedIP,this.session=Pl=new Pq(this.context,Cl,Tl,this.logger),Dl=function(){Jl.connectionState===Ea.CONNECTED&&(Jl.onConnectionStateChanged(Ea.RECONNECTING,Jc.INTERRUPTED),Jl.session)&&Jl.session.once("userJoined",function(){Jl.onConnectionStateChanged(Ea.CONNECTED,Jc.LOGIN_SUCCESS)})},Pl.on("connectionLost",Dl),Pl.on("tokenExpired",function(){Jl.emit("TokenExpired")}),Pl.on("tokenPrivilegeWillExpire",this.TokenPrivilegeWillExpireHandler),Pl.once("userDrop",this.userDropHandler),this.session.on("peerTextMessage",function(Bl){Jl.emit("MessageFromPeer",{text:Bl.text,messageType:Oa.MessageType.TEXT},Bl.peerId,Bl.properties)}),this.session.on("peerRawMessage",function(Bl){Jl.emit("MessageFromPeer",{rawMessage:Bl.raw,description:Bl.desc,messageType:Oa.MessageType.RAW},Bl.peerId,Bl.properties)}),Pl.on("instanceChanged",function(Bl){return Tl=Bl}),Pl.on("peerOnlineStatusChanged",function(Bl){var Vl=Bl.instance.toString()+Bl.state,_d=Jl.peerStatusSeqLru.get(Vl);!_d||Bl.seq.greaterThan(_d)?(Jl.peerStatusSeqLru.set(Vl,Bl.seq),Bl.state!==Jl.subscribedPeerStatusCache[Bl.peerId]&&Jl.emit("PeersOnlineStatusChanged",E({},Bl.peerId,Bl.state)),Jl.subscribedPeerStatusCache[Bl.peerId]=Bl.state,clearTimeout(Jl.peerUnreachableTimers[Vl]),Bl.state===Oa.PeerOnlineState.UNREACHABLE&&(Jl.peerUnreachableTimers[Vl]=setTimeout(function(){Jl.subscribedPeerStatusCache[Bl.peerId]===Oa.PeerOnlineState.UNREACHABLE&&(Jl.subscribedPeerStatusCache[Bl.peerId]=Oa.PeerOnlineState.ONLINE,Jl.emit("PeersOnlineStatusChanged",E({},Bl.peerId,Oa.PeerOnlineState.ONLINE)))},3e4))):Jl.log("peerOnlineStatusChanged dedup for %s, %d",Vl,Bl.seq.toNumber())}),Pl.on("invitationMessage",this.invitationManager.invitationMessageHandler.bind(this.invitationManager)),Pl.on("channelAttributesUpdated",function(Bl){var Vl=Bl.channelId;Bl=Bl.attributeMaps;for(var _d={},Sp=0;Sp<Bl.length;Sp++){var Up=Bl[Sp],Kp=Up.key,Hp=Up.ms,_m=Up.value;if(Up=Up.origin,typeof Kp!="string"||!D.isLong(Hp)||typeof _m!="string"||!yb(Up))break;_d[Kp]=new Blob([_m]).size}Jl.channelAttributesCacheLru.set(Vl,_d)}),Pl.on("userJoined",function(Bl){if(Object.keys(Jl.attributes).length!==0){if(Jl.session===void 0)return;Jl.session.requestSetLocalUserAttributes(Jl.attributes,Bl).toPromise()}if(Jl.attributeDrafts.size!==0)for(var Vl=function(Up,Kp){var Hp=(Up=Kp[Up]).attribute;Up.promise.then(function(){Jl.session!==void 0&&Jl.session.requestSetLocalUserAttributes(Hp,Bl).toPromise()})},_d=0,Sp=Array.from(Jl.attributeDrafts);_d<Sp.length;_d++)Vl(_d,Sp);Object.keys(Jl.subscribedPeerStatusCache).length!==0&&Pl.requestSubscribePeersOnlineStatus(Object.keys(Jl.subscribedPeerStatusCache))}),Pl.on("banEdgeIP",function(Bl){Jl.banIP(Bl)}),Pl.on("userMetaDataUpdated",this.userMetaDataUpdatedHandler),this.lastLoginTime=Date.now(),zl.prev=33,zl.next=36,Pl.loginHandler().toPromise();case 36:zl.next=54;break;case 38:if(zl.prev=38,zl.t1=zl.catch(33),!(zl.t1.name==="loginRespTimeout"&&2>_l)){zl.next=47;break}return Pl.removeAllListeners(),zl.next=44,this.loginImpl({uid:ga,instanceId:_s,forceLoginTime:_l+1});case 44:return zl.abrupt("return");case 47:if(!uc(zl.t1)){zl.next=50;break}throw this.onConnectionStateChanged(Ea.DISCONNECTED,Jc.LOGIN_TIMEOUT),new Pc(vg(this.name,"login",12e3),GI);case 50:if(this.onConnectionStateChanged(Ea.DISCONNECTED,Jc.LOGIN_FAILURE),!Sa(zl.t1)){zl.next=53;break}throw zl.t1;case 53:throw new Pa("Login failure",{code:Ew,originalError:zl.t1});case 54:this.onConnectionStateChanged(Ea.CONNECTED,Jc.LOGIN_SUCCESS);case 55:case"end":return zl.stop()}},$,this,[[6,10],[33,38]])}));return function($){return _.apply(this,arguments)}}()},{key:"rennectSubscribeduserMetadata",value:function(){var _=za(W.mark(function $(_t){var ga,_s;return W.wrap(function(_c){for(;;)switch(_c.prev=_c.next){case 0:ga=0;case 1:if(!(ga<_t.length)){_c.next=10;break}if(_s=_t[ga],!this.session){_c.next=7;break}return _c.next=6,this.session.requestSubscribeUserMetadata(_s,"RECONNECTED").toPromise();case 6:this.subscribedUserMetaCache[_s]=Oa.subscribedState.SUBSCRIBED;case 7:ga++,_c.next=1;break;case 10:case"end":return _c.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"onConnectionStateChanged",value:function(_,$){var _t,ga,_s,_c=this;_===Ea.RECONNECTING&&(this.reconnId+=1),$a("ConnectionStateChange",{elapse:Nb(this.session&&this.session.startTime),lts:D.fromNumber(Date.now()),newState:FA[_],oldState:FA[this.connectionState],reason:JP[$],sid:fc(this.session&&this.session.instanceId||D.fromNumber(0)),userId:this.context.uid,reconnId:this.reconnId},(_t=this.context.config.enableCloudProxy)!==null&&_t!==void 0&&_t),this.connectionState===Ea.RECONNECTING&&_===Ea.CONNECTED&&(Object.keys(this.subscribedPeerStatusCache).length!==0&&this.session!==void 0&&this.session.requestPeersOnlineStatus(Object.keys(this.subscribedPeerStatusCache)).pipe(Wa(function(_l){return Pe(Ro(_l.userInfos,"account"),function(Tl){return!!Tl.ts})})).subscribe(function(_l){_l=Pe(_l,function(Tl,Cl){return Tl=Tl?Oa.PeerOnlineState.ONLINE:Oa.PeerOnlineState.OFFLINE,_c.subscribedPeerStatusCache[Cl]=Tl}),_c.emit("PeersOnlineStatusChanged",_l)}),Object.keys(this.subscribedUserMetaCache).length!==0&&this.session!==void 0&&this.rennectSubscribeduserMetadata(Object.keys(this.subscribedUserMetaCache)),(ga=this.session)!==null&&ga!==void 0&&ga.usedChannelIds&&0<((_s=this.session)===null||_s===void 0?void 0:_s.usedChannelIds.length)&&this.session.usedChannelIds.map(function(_l){var Tl;return(Tl=_c.session)===null||Tl===void 0?void 0:Tl.requestSubscribeChannelMetadata(_l,"RECONNECTED")}),this.internalEmitter.emit("RECONNECTED")),this.connectionState=_,_!==Ea.ABORTED&&_!==Ea.DISCONNECTED||(this.pendingPeerStatusSubCount=this.reconnId=0,this.attributes={},this.session&&(this.session.removeAllListeners(),this.session.msgDedupLru.empty(),this.session.dialogueSequenceLru.empty(),this.session.dialPendingMsgSubjectMap.clear()),this.channelAttributesCacheLru.empty(),this.peerStatusSeqLru.empty(),this.peerUnreachableTimers={},this.subscribedPeerStatusCache={},this.subscribedUserMetaCache={},this.attributeDrafts.clear(),this.context.token=void 0),this.emit("ConnectionStateChanged",_,$)}},{key:"banIP",value:function(_){var $;this.log("ip banned",_);var _t=($=this.blacklistedIP[_])!==null&&$!==void 0?$:0;this.blacklistedIP[_]=_t+1}}]),e}(Dd()),Na(ka.prototype,"renewToken",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"renewToken"),ka.prototype),Na(ka.prototype,"queryPeersOnlineStatus",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"queryPeersOnlineStatus"),ka.prototype),Na(ka.prototype,"getChannelMemberCount",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"getChannelMemberCount"),ka.prototype),Na(ka.prototype,"setLocalUserAttributes",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"setLocalUserAttributes"),ka.prototype),Na(ka.prototype,"setChannelAttributes",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"setChannelAttributes"),ka.prototype),Na(ka.prototype,"addOrUpdateLocalUserAttributes",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"addOrUpdateLocalUserAttributes"),ka.prototype),Na(ka.prototype,"addOrUpdateChannelAttributes",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"addOrUpdateChannelAttributes"),ka.prototype),Na(ka.prototype,"deleteLocalUserAttributesByKeys",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"deleteLocalUserAttributesByKeys"),ka.prototype),Na(ka.prototype,"deleteChannelAttributesByKeys",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"deleteChannelAttributesByKeys"),ka.prototype),Na(ka.prototype,"clearLocalUserAttributes",[je],Object.getOwnPropertyDescriptor(ka.prototype,"clearLocalUserAttributes"),ka.prototype),Na(ka.prototype,"clearChannelAttributes",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"clearChannelAttributes"),ka.prototype),Na(ka.prototype,"getUserAttributes",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"getUserAttributes"),ka.prototype),Na(ka.prototype,"getChannelAttributes",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"getChannelAttributes"),ka.prototype),Na(ka.prototype,"getChannelAttributesByKeys",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"getChannelAttributesByKeys"),ka.prototype),Na(ka.prototype,"getUserAttributesByKeys",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"getUserAttributesByKeys"),ka.prototype),Na(ka.prototype,"getUserMetadata",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"getUserMetadata"),ka.prototype),Na(ka.prototype,"setLocalUserMetadata",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"setLocalUserMetadata"),ka.prototype),Na(ka.prototype,"clearLocalUserMetadata",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"clearLocalUserMetadata"),ka.prototype),Na(ka.prototype,"addLocalUserMetadata",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"addLocalUserMetadata"),ka.prototype),Na(ka.prototype,"updateLocalUserMetadata",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"updateLocalUserMetadata"),ka.prototype),Na(ka.prototype,"deleteLocalUserMetadata",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"deleteLocalUserMetadata"),ka.prototype),Na(ka.prototype,"subscribeUserMetadata",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"subscribeUserMetadata"),ka.prototype),Na(ka.prototype,"login",[je],Object.getOwnPropertyDescriptor(ka.prototype,"login"),ka.prototype),Na(ka.prototype,"logout",[je],Object.getOwnPropertyDescriptor(ka.prototype,"logout"),ka.prototype),Na(ka.prototype,"logoutSync",[je],Object.getOwnPropertyDescriptor(ka.prototype,"logoutSync"),ka.prototype),Na(ka.prototype,"sendMessageToPeer",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"sendMessageToPeer"),ka.prototype),Na(ka.prototype,"createChannel",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"createChannel"),ka.prototype),Na(ka.prototype,"createMetadataItem",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"createMetadataItem"),ka.prototype),Na(ka.prototype,"createLocalInvitation",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"createLocalInvitation"),ka.prototype),Na(ka.prototype,"subscribePeersOnlineStatus",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"subscribePeersOnlineStatus"),ka.prototype),Na(ka.prototype,"unsubscribePeersOnlineStatus",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"unsubscribePeersOnlineStatus"),ka.prototype),Na(ka.prototype,"queryPeersBySubscriptionOption",[gb],Object.getOwnPropertyDescriptor(ka.prototype,"queryPeersBySubscriptionOption"),ka.prototype),Na(ka.prototype,"createMessage",[je],Object.getOwnPropertyDescriptor(ka.prototype,"createMessage"),ka.prototype),ka),Uq,Vq,Wq,Xq,GA=(Uq=/Chrome\/([0-9.]+)/.exec((Wq=window)===null||Wq===void 0||(Xq=Wq.navigator)===null||Xq===void 0?void 0:Xq.userAgent))===null||Uq===void 0||(Vq=Uq[1])===null||Vq===void 0?void 0:Vq.split(".")[0];if(GA&&88<=parseInt(GA,10)&&!Kg()){var Yq,Hg=document.createElement("video"),Ig=document.createElement("canvas");Hg.setAttribute("style","display:none"),Hg.setAttribute("muted",""),Hg.muted=!0,Hg.setAttribute("autoplay",""),Hg.autoplay=!0,Hg.setAttribute("playsinline",""),Ig.setAttribute("style","display:none"),Ig.setAttribute("width","2"),Ig.setAttribute("height","2"),(Yq=Ig.getContext("2d"))===null||Yq===void 0||Yq.fillRect(0,0,1,1),Hg.srcObject=Ig==null?void 0:Ig.captureStream()}var HA={LOG_FILTER_OFF:{error:!1,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_ERROR:{error:!0,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_WARNING:{error:!0,warn:!0,info:!1,track:!1,debug:!1},LOG_FILTER_INFO:{error:!0,warn:!0,info:!0,track:!1,debug:!1},LOG_FILTER_DEBUG:{error:!0,warn:!0,info:!0,track:!0,debug:!0}},IA={enableLogUpload:!1,logFilter:HA.LOG_FILTER_INFO,enableCloudProxy:!1},wg=tb(tb({createInstance:function(i){var e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},o=2<arguments.length?arguments[2]:void 0;if(!/^[\dA-Za-z]{32}$/.test(i))throw new ja(["The %s in the arguments is invalid",Object.keys({appId:i})[0]],sw);var c=Object.keys(e).filter(function(_l){return!(_l in IA)});if(c.length!==0)throw new ja("Invalid RTM config: ".concat(c.join(", ")),sw);var _=tb(tb({},IA),e);if(o!==void 0&&(!Array.isArray(o)||o.length===0))throw new ja("Invalid area config");if(o!=null){if(!o.every(function(_l){return _l in Oa.LegacyAreaCode}))throw new ja("Invalid area codes: ".concat(o.filter(function(_l){return!(_l in Oa)}).join(", ")));Ba=eh(o.map(function(_l){return SK[_l]}))}o=qp=qb.__global_unique_id__=(qb.__global_unique_id__||0)+1;var $=WK(_);c=XK(_);var _t=YK(_),ga=ZK(o,_),_s=zx(o,_),_c=_s("RTM:DEBUG","<Entry> ");return sx.rtmConfig=_,$("The Agora RTM Web SDK version is %s","1.6.0-205"),e.enableCloudProxy&&$("RTM cloud proxy enabled"),e.enableLogUpload&&$("Log upload enabled"),Ba&&_c("Area is set to %s",Array.from(Ba.CODES).map(function(_l){return vi(oa).find(function(Tl){return oa[Tl]===_l})}).join(", ")),_c("Creating an RtmClient instance"),_c('The Git commit ID is "'.concat("v1.5.1-67-g0f6d3600",'"')),_c("The App ID is %s",ws(i,4,10,"*".repeat(6))),$("The process ID is %s",hj),_c("The build is %s","v1.5.1-67-g0f6d3600"),_c("NODE_ENV is %s","production"),new KP(i,{genLogger:_s,genTracker:ga,info:$,warn:c,logError:_t,loggerId:o},_,function(_l){for(var Tl=0,Cl=vi(_l);Tl<Cl.length;Tl++){var Pl=Cl[Tl];try{var Dl=_l[Pl];Dl!=null&&(_l.enableCloudProxy&&$("RTM cloud proxy enabled"),_l.enableLogUpload&&$("Log upload enabled"),_[Pl]=Dl)}catch{throw new ja(["The %s in the arguments is invalid",Pl],void 0)}}})},BUILD:"v1.5.1-67-g0f6d3600",VERSION:"1.6.0-205",END_CALL_PREFIX:"AgoraRTMLegacyEndcallCompatibleMessagePrefix",processId:hj,ConnectionChangeReason:Oa.ConnectionChangeReason,ConnectionState:Oa.ConnectionState,LocalInvitationFailureReason:Oa.LocalInvitationFailureReason,LocalInvitationState:Oa.LocalInvitationState,RemoteInvitationFailureReason:Oa.RemoteInvitationFailureReason,RemoteInvitationState:Oa.RemoteInvitationState,MessageType:Oa.MessageType,PeerOnlineState:Oa.PeerOnlineState,PeerSubscriptionOption:Oa.PeerSubscriptionOption},HA),{},{setParameter:function(i,e){Object.keys(Yd).includes(i)&&(Yd[i]=e)},getParameter:function(i){return Yd[i]},setArea:function(i){var e=i.areaCodes;if(i=i.excludedArea,!Array.isArray(e)||e.length===0||!e.every(function(o){return o in Oa.AreaCode}))throw new ja("Invalid area config");if(i!==void 0&&i===Oa.AreaCode.GLOBAL)throw new ja("Excluded area cannot be global");if(i===void 0)Ba=eh(e.map(function(o){return oa[o]}));else{if(e.includes(i))throw new ja("Excluded area cannot be in areaCodes");if(!(i in oa))throw new ja("Invalid excludedArea:",i);Ba=tC({areas:e.map(function(o){return oa[o]}),excludedArea:oa[i]})}}});return wg})})(agoraRtmSdk);const AgoraRTM=getDefaultExportFromCjs(agoraRtmSdkExports);var AgoraRTC_NProductionExports={},AgoraRTC_NProduction={get exports(){return AgoraRTC_NProductionExports},set exports(i){AgoraRTC_NProductionExports=i}};(function(i,e){(function(o,c){i.exports=c()})(commonjsGlobal,function(){function o(s,a){return a.forEach(function(h){h&&typeof h!="string"&&!Array.isArray(h)&&Object.keys(h).forEach(function(g){if(g!=="default"&&!(g in s)){var j=Object.getOwnPropertyDescriptor(h,g);Object.defineProperty(s,g,j.get?j:{enumerable:!0,get:function(){return h[g]}})}})}),Object.freeze(s)}var c=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{},_=function(s){try{return!!s()}catch{return!0}},$=!_(function(){var s=function(){}.bind();return typeof s!="function"||s.hasOwnProperty("prototype")}),_t=$,ga=Function.prototype,_s=ga.bind,_c=ga.call,_l=_t&&_s.bind(_c,_c),Tl=_t?function(s){return s&&_l(s)}:function(s){return s&&function(){return _c.apply(s,arguments)}},Cl=Tl({}.isPrototypeOf),Pl=function(s){return s&&s.Math==Math&&s},Dl=Pl(typeof globalThis=="object"&&globalThis)||Pl(typeof window=="object"&&window)||Pl(typeof self=="object"&&self)||Pl(typeof c=="object"&&c)||function(){return this}()||Function("return this")(),Jl=$,zl=Function.prototype,Bl=zl.apply,Vl=zl.call,_d=typeof Reflect=="object"&&Reflect.apply||(Jl?Vl.bind(Bl):function(){return Vl.apply(Bl,arguments)}),Sp=function(s){return typeof s=="function"},Up={},Kp=!_(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Hp=$,_m=Function.prototype.call,I0=Hp?_m.bind(_m):function(){return _m.apply(_m,arguments)},Cp={},Jp={}.propertyIsEnumerable,Zp=Object.getOwnPropertyDescriptor,i0=Zp&&!Jp.call({1:2},1);Cp.f=i0?function(s){var a=Zp(this,s);return!!a&&a.enumerable}:Jp;var Np,Dp,Qp=function(s,a){return{enumerable:!(1&s),configurable:!(2&s),writable:!(4&s),value:a}},n0=Tl,Bp=n0({}.toString),c0=n0("".slice),_f=function(s){return c0(Bp(s),8,-1)},O0=Tl,_0=_,__=_f,yp=Dl.Object,dy=O0("".split),L1=_0(function(){return!yp("z").propertyIsEnumerable(0)})?function(s){return __(s)=="String"?dy(s,""):yp(s)}:yp,o0=Dl.TypeError,H0=function(s){if(s==null)throw o0("Can't call method on "+s);return s},z_=L1,VS=H0,iS=function(s){return z_(VS(s))},gO=Sp,hy=function(s){return typeof s=="object"?s!==null:gO(s)},IS={},gN=IS,mN=Dl,h3=Sp,p3=function(s){return h3(s)?s:void 0},xy=function(s,a){return arguments.length<2?p3(gN[s])||p3(mN[s]):gN[s]&&gN[s][a]||mN[s]&&mN[s][a]},sT=xy("navigator","userAgent")||"",mO=Dl,vN=sT,vO=mO.process,f3=mO.Deno,g3=vO&&vO.versions||f3&&f3.version,m3=g3&&g3.v8;m3&&(Dp=(Np=m3.split("."))[0]>0&&Np[0]<4?1:+(Np[0]+Np[1])),!Dp&&vN&&(!(Np=vN.match(/Edge\/(\d+)/))||Np[1]>=74)&&(Np=vN.match(/Chrome\/(\d+)/))&&(Dp=+Np[1]);var BT=Dp,v3=BT,fU=_,EN=!!Object.getOwnPropertySymbols&&!fU(function(){var s=Symbol();return!String(s)||!(Object(s)instanceof Symbol)||!Symbol.sham&&v3&&v3<41}),E3=EN&&!Symbol.sham&&typeof Symbol.iterator=="symbol",_3=xy,gU=Sp,mU=Cl,vU=E3,EU=Dl.Object,_N=vU?function(s){return typeof s=="symbol"}:function(s){var a=_3("Symbol");return gU(a)&&mU(a.prototype,EU(s))},_U=Dl.String,aT=function(s){try{return _U(s)}catch{return"Object"}},yU=Sp,bU=aT,SU=Dl.TypeError,My=function(s){if(yU(s))return s;throw SU(bU(s)+" is not a function")},TU=My,BS=function(s,a){var h=s[a];return h==null?void 0:TU(h)},yN=I0,bN=Sp,SN=hy,F_=Dl.TypeError,O_={exports:{}},y3=Dl,RU=Object.defineProperty,wU=function(s,a){try{RU(y3,s,{value:a,configurable:!0,writable:!0})}catch{y3[s]=a}return a},TN="__core-js_shared__",RN=Dl[TN]||wU(TN,{}),v1=RN;(O_.exports=function(s,a){return v1[s]||(v1[s]=a!==void 0?a:{})})("versions",[]).push({version:"3.20.3",mode:"pure",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var wN=H0,cT=Dl.Object,Uy=function(s){return cT(wN(s))},IN=Uy,yy=Tl({}.hasOwnProperty),E1=Object.hasOwn||function(s,a){return yy(IN(s),a)},b3=Tl,S3=0,T3=Math.random(),R3=b3(1 .toString),EO=function(s){return"Symbol("+(s===void 0?"":s)+")_"+R3(++S3+T3,36)},IU=Dl,OU=O_.exports,w3=E1,CU=EO,uT=EN,Gp=E3,r0=OU("wks"),Ul=IU.Symbol,P0=Ul&&Ul.for,j0=Gp?Ul:Ul&&Ul.withoutSetter||CU,y0=function(s){if(!w3(r0,s)||!uT&&typeof r0[s]!="string"){var a="Symbol."+s;uT&&w3(Ul,s)?r0[s]=Ul[s]:r0[s]=Gp&&P0?P0(a):j0(a)}return r0[s]},s1=I0,by=hy,oS=_N,lT=BS,jy=function(s,a){var h,g;if(a==="string"&&bN(h=s.toString)&&!SN(g=yN(h,s))||bN(h=s.valueOf)&&!SN(g=yN(h,s))||a!=="string"&&bN(h=s.toString)&&!SN(g=yN(h,s)))return g;throw F_("Can't convert object to primitive value")},I3=y0,O3=Dl.TypeError,AU=I3("toPrimitive"),NU=function(s,a){if(!by(s)||oS(s))return s;var h,g=lT(s,AU);if(g){if(a===void 0&&(a="default"),h=s1(g,s,a),!by(h)||oS(h))return h;throw O3("Can't convert object to primitive value")}return a===void 0&&(a="number"),jy(s,a)},ON=_N,GS=function(s){var a=NU(s,"string");return ON(a)?a:a+""},AR=hy,CN=Dl.document,C3=AR(CN)&&AR(CN.createElement),Fy=function(s){return C3?CN.createElement(s):{}},AN=Fy,qS=!Kp&&!_(function(){return Object.defineProperty(AN("div"),"a",{get:function(){return 7}}).a!=7}),Sy=Kp,A3=I0,N3=Cp,NR=Qp,kU=iS,_O=GS,k3=E1,P1=qS,Vy=Object.getOwnPropertyDescriptor;Up.f=Sy?Vy:function(s,a){if(s=kU(s),a=_O(a),P1)try{return Vy(s,a)}catch{}if(k3(s,a))return NR(!A3(N3.f,s,a),s[a])};var NN=_,yO=Sp,OS=/#|\.prototype\./,GT=function(s,a){var h=kN[G1(s)];return h==PU||h!=LU&&(yO(a)?NN(a):!!a)},G1=GT.normalize=function(s){return String(s).replace(OS,".").toLowerCase()},kN=GT.data={},LU=GT.NATIVE="N",PU=GT.POLYFILL="P",bO=GT,kR=My,L3=$,WS=Tl(Tl.bind),sS=function(s,a){return kR(s),a===void 0?s:L3?WS(s,a):function(){return s.apply(a,arguments)}},Ty={},LN=Kp&&_(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),wO=Dl,PN=hy,P3=wO.String,D3=wO.TypeError,$1=function(s){if(PN(s))return s;throw D3(P3(s)+" is not an object")},IO=Kp,x3=qS,M3=LN,LR=$1,CO=GS,U3=Dl.TypeError,PR=Object.defineProperty,DN=Object.getOwnPropertyDescriptor,s_="enumerable",DU="configurable",xU="writable";Ty.f=IO?M3?function(s,a,h){if(LR(s),a=CO(a),LR(h),typeof s=="function"&&a==="prototype"&&"value"in h&&xU in h&&!h.writable){var g=DN(s,a);g&&g.writable&&(s[a]=h.value,h={configurable:DU in h?h.configurable:g.configurable,enumerable:s_ in h?h.enumerable:g.enumerable,writable:!1})}return PR(s,a,h)}:PR:function(s,a,h){if(LR(s),a=CO(a),LR(h),x3)try{return PR(s,a,h)}catch{}if("get"in h||"set"in h)throw U3("Accessors not supported");return"value"in h&&(s[a]=h.value),s};var qT=Ty,MU=Qp,u1=Kp?function(s,a,h){return qT.f(s,a,MU(1,h))}:function(s,a,h){return s[a]=h,s},AO=Dl,kO=_d,xN=Tl,j3=Sp,F3=Up.f,py=bO,fy=IS,MN=sS,CS=u1,UN=E1,jN=function(s){var a=function(h,g,j){if(this instanceof a){switch(arguments.length){case 0:return new s;case 1:return new s(h);case 2:return new s(h,g)}return new s(h,g,j)}return kO(s,this,arguments)};return a.prototype=s.prototype,a},a1=function(s,a){var h,g,j,_e,_n,_o,_a,_r,ba=s.target,xa=s.global,El=s.stat,yl=s.proto,Ol=xa?AO:El?AO[ba]:(AO[ba]||{}).prototype,Al=xa?fy:fy[ba]||CS(fy,ba,{})[ba],Nl=Al.prototype;for(j in a)h=!py(xa?j:ba+(El?".":"#")+j,s.forced)&&Ol&&UN(Ol,j),_n=Al[j],h&&(_o=s.noTargetGet?(_r=F3(Ol,j))&&_r.value:Ol[j]),_e=h&&_o?_o:a[j],h&&typeof _n==typeof _e||(_a=s.bind&&h?MN(_e,AO):s.wrap&&h?jN(_e):yl&&j3(_e)?xN(_e):_e,(s.sham||_e&&_e.sham||_n&&_n.sham)&&CS(_a,"sham",!0),CS(Al,j,_a),yl&&(UN(fy,g=ba+"Prototype")||CS(fy,g,{}),CS(fy[g],j,_e),s.real&&Nl&&!Nl[j]&&CS(Nl,j,_e)))},FN=Math.ceil,VN=Math.floor,aS=function(s){var a=+s;return a!=a||a===0?0:(a>0?VN:FN)(a)},HS=aS,V3=Math.min,BN=function(s){return s>0?V3(HS(s),9007199254740991):0},cS=function(s){return BN(s.length)},B3=My,G3=Uy,q3=L1,Z1=cS,uS=Dl.TypeError,DR=function(s){return function(a,h,g,j){B3(h);var _e=G3(a),_n=q3(_e),_o=Z1(_e),_a=s?_o-1:0,_r=s?-1:1;if(g<2)for(;;){if(_a in _n){j=_n[_a],_a+=_r;break}if(_a+=_r,s?_a<0:_o<=_a)throw uS("Reduce of empty array with no initial value")}for(;s?_a>=0:_o>_a;_a+=_r)_a in _n&&(j=h(j,_n[_a],_a,_e));return j}},WT={left:DR(!1),right:DR(!0)},W3=_,DO=function(s,a){var h=[][s];return!!h&&W3(function(){h.call(null,a||function(){throw 1},1)})},xR=_f(Dl.process)=="process",HT=WT.left,KT=BT,H3=xR;a1({target:"Array",proto:!0,forced:!DO("reduce")||!H3&&KT>79&&KT<83},{reduce:function(s){var a=arguments.length;return HT(this,s,a,a>1?arguments[1]:void 0)}});var K3=IS,By=function(s){return K3[s+"Prototype"]},z3=By("Array").reduce,xO=Cl,GN=z3,zT=Array.prototype,qN=function(s){var a=s.reduce;return s===zT||xO(zT,s)&&a===zT.reduce?GN:a},Gy=qN;let WN=!0,jO=!0;function MR(s,a,h){const g=s.match(a);return g&&g.length>=h&&parseInt(g[h],10)}function q1(s,a,h){if(!s.RTCPeerConnection)return;const g=s.RTCPeerConnection.prototype,j=g.addEventListener;g.addEventListener=function(_n,_o){if(_n!==a)return j.apply(this,arguments);const _a=_r=>{const ba=h(_r);ba&&(_o.handleEvent?_o.handleEvent(ba):_o(ba))};return this._eventMap=this._eventMap||{},this._eventMap[a]||(this._eventMap[a]=new Map),this._eventMap[a].set(_o,_a),j.apply(this,[_n,_a])};const _e=g.removeEventListener;g.removeEventListener=function(_n,_o){if(_n!==a||!this._eventMap||!this._eventMap[a])return _e.apply(this,arguments);if(!this._eventMap[a].has(_o))return _e.apply(this,arguments);const _a=this._eventMap[a].get(_o);return this._eventMap[a].delete(_o),this._eventMap[a].size===0&&delete this._eventMap[a],Object.keys(this._eventMap).length===0&&delete this._eventMap,_e.apply(this,[_n,_a])},Object.defineProperty(g,"on"+a,{get(){return this["_on"+a]},set(_n){this["_on"+a]&&(this.removeEventListener(a,this["_on"+a]),delete this["_on"+a]),_n&&this.addEventListener(a,this["_on"+a]=_n)},enumerable:!0,configurable:!0})}function Y3(s){return typeof s!="boolean"?new Error("Argument type: "+typeof s+". Please use a boolean."):(WN=s,s?"adapter.js logging disabled":"adapter.js logging enabled")}function J3(s){return typeof s!="boolean"?new Error("Argument type: "+typeof s+". Please use a boolean."):(jO=!s,"adapter.js deprecation warnings "+(s?"disabled":"enabled"))}function X3(){if(typeof window=="object"){if(WN)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function FO(s,a){jO&&console.warn(s+" is deprecated, please use "+a+" instead.")}function AS(s){const a={browser:null,version:null};if(s===void 0||!s.navigator)return a.browser="Not a browser.",a;const{navigator:h}=s;if(h.mozGetUserMedia)a.browser="firefox",a.version=MR(h.userAgent,/Firefox\/(\d+)\./,1);else if(h.webkitGetUserMedia||s.isSecureContext===!1&&s.webkitRTCPeerConnection)a.browser="chrome",a.version=MR(h.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!s.RTCPeerConnection||!h.userAgent.match(/AppleWebKit\/(\d+)\./))return a.browser="Not a supported browser.",a;a.browser="safari",a.version=MR(h.userAgent,/AppleWebKit\/(\d+)\./,1),a.supportsUnifiedPlan=s.RTCRtpTransceiver&&"currentDirection"in s.RTCRtpTransceiver.prototype}return a}function BO(s){return Object.prototype.toString.call(s)==="[object Object]"}function GO(s){var a;return BO(s)?Gy(a=Object.keys(s)).call(a,function(h,g){const j=BO(s[g]),_e=j?GO(s[g]):s[g],_n=j&&!Object.keys(_e).length;return _e===void 0||_n?h:Object.assign(h,{[g]:_e})},{}):s}function UR(s,a,h){const g=h?"outbound-rtp":"inbound-rtp",j=new Map;if(a===null)return j;const _e=[];return s.forEach(_n=>{_n.type==="track"&&_n.trackIdentifier===a.id&&_e.push(_n)}),_e.forEach(_n=>{s.forEach(_o=>{_o.type===g&&_o.trackId===_n.id&&function _a(_r,ba,xa){ba&&!xa.has(ba.id)&&(xa.set(ba.id,ba),Object.keys(ba).forEach(El=>{El.endsWith("Id")?_a(_r,_r.get(ba[El]),xa):El.endsWith("Ids")&&ba[El].forEach(yl=>{_a(_r,_r.get(yl),xa)})}))}(s,_o,j)})}),j}var YT=O_.exports,U0=EO,jR=YT("keys"),JT=function(s){return jR[s]||(jR[s]=U0(s))},dT=!_(function(){function s(){}return s.prototype.constructor=null,Object.getPrototypeOf(new s)!==s.prototype}),Q3=Dl,$3=E1,UU=Sp,NS=Uy,W1=dT,qO=JT("IE_PROTO"),FR=Q3.Object,VR=FR.prototype,HO=W1?FR.getPrototypeOf:function(s){var a=NS(s);if($3(a,qO))return a[qO];var h=a.constructor;return UU(h)&&a instanceof h?h.prototype:a instanceof FR?VR:null},HN=Dl,KN=Sp,Z3=HN.String,_x=HN.TypeError,zO=Tl,lS=$1,hT=function(s){if(typeof s=="object"||KN(s))return s;throw _x("Can't set "+Z3(s)+" as a prototype")},jU=Object.setPrototypeOf||("__proto__"in{}?function(){var s,a=!1,h={};try{(s=zO(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(h,[]),a=h instanceof Array}catch{}return function(g,j){return lS(g),hT(j),a?s(g,j):g.__proto__=j,g}}():void 0),BR={},Sx=aS,Tx=Math.max,Rx=Math.min,JO=function(s,a){var h=Sx(s);return h<0?Tx(h+a,0):Rx(h,a)},Ry=iS,Ox=JO,zN=cS,t2=function(s){return function(a,h,g){var j,_e=Ry(a),_n=zN(_e),_o=Ox(g,_n);if(s&&h!=h){for(;_n>_o;)if((j=_e[_o++])!=j)return!0}else for(;_n>_o;_o++)if((s||_o in _e)&&_e[_o]===h)return s||_o||0;return!s&&-1}},Nx={includes:t2(!0),indexOf:t2(!1)},GR={},XT=E1,Lx=iS,Px=Nx.indexOf,e2=GR,YN=Tl([].push),JN=function(s,a){var h,g=Lx(s),j=0,_e=[];for(h in g)!XT(e2,h)&&XT(g,h)&&YN(_e,h);for(;a.length>j;)XT(g,h=a[j++])&&(~Px(_e,h)||YN(_e,h));return _e},n2=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],r2=JN,i2=n2.concat("length","prototype");BR.f=Object.getOwnPropertyNames||function(s){return r2(s,i2)};var ty={};ty.f=Object.getOwnPropertySymbols;var ey=xy,i1=BR,XN=ty,kS=$1,Mx=Tl([].concat),o2=ey("Reflect","ownKeys")||function(s){var a=i1.f(kS(s)),h=XN.f;return h?Mx(a,h(s)):a},V_=E1,e1=o2,Ux=Up,qR=Ty,pT={},gy=JN,Vx=n2,wy=Object.keys||function(s){return gy(s,Vx)},n_=Kp,Wx=LN,Iy=Ty,Yx=$1,R_=iS,QN=wy;pT.f=n_&&!Wx?Object.defineProperties:function(s,a){Yx(s);for(var h,g=R_(a),j=QN(a),_e=j.length,_n=0;_e>_n;)Iy.f(s,h=j[_n++],g[h]);return s};var QT,l1=xy("document","documentElement"),ny=$1,Xx=pT,fT=n2,Qx=GR,$x=l1,Zx=Fy,s2=JT("IE_PROTO"),j1=function(){},a2=function(s){return"<script>"+s+"<\/script>"},c2=function(s){s.write(a2("")),s.close();var a=s.parentWindow.Object;return s=null,a},$T=function(){try{QT=new ActiveXObject("htmlfile")}catch{}var s,a;$T=typeof document<"u"?document.domain&&QT?c2(QT):((a=Zx("iframe")).style.display="none",$x.appendChild(a),a.src=String("javascript:"),(s=a.contentWindow.document).open(),s.write(a2("document.F=Object")),s.close(),s.F):c2(QT);for(var h=fT.length;h--;)delete $T.prototype[fT[h]];return $T()};Qx[s2]=!0;var ZT=Object.create||function(s,a){var h;return s!==null?(j1.prototype=ny(s),h=new j1,j1.prototype=null,h[s2]=s):h=$T(),a===void 0?h:Xx.f(h,a)},$N=Tl("".replace),ZN=String(Error("zxcasd").stack),_k=/\n\s*at [^:]*:[^\n]*/,d1=_k.test(ZN),u2=hy,EL=u1,gT={},tR=gT,B_=y0("iterator"),_L=Array.prototype,tM=function(s){return s!==void 0&&(tR.Array===s||_L[B_]===s)},my={};my[y0("toStringTag")]="z";var eR=String(my)==="[object z]",nR=Dl,l2=eR,d2=Sp,y_=_f,FU=y0("toStringTag"),eM=nR.Object,h2=y_(function(){return arguments}())=="Arguments",LS=l2?y_:function(s){var a,h,g;return s===void 0?"Undefined":s===null?"Null":typeof(h=function(j,_e){try{return j[_e]}catch{}}(a=eM(s),FU))=="string"?h:h2?y_(a):(g=y_(a))=="Object"&&d2(a.callee)?"Arguments":g},VU=LS,nM=BS,p2=gT,KS=y0("iterator"),mT=function(s){if(s!=null)return nM(s,KS)||nM(s,"@@iterator")||p2[VU(s)]},rM=I0,f2=My,iM=$1,oM=aT,g2=mT,sM=Dl.TypeError,vT=function(s,a){var h=arguments.length<2?g2(s):a;if(f2(h))return iM(rM(h,s));throw sM(oM(s)+" is not iterable")},ET=I0,WR=$1,BU=BS,aM=function(s,a,h){var g,j;WR(s);try{if(!(g=BU(s,"return"))){if(a==="throw")throw h;return h}g=ET(g,s)}catch(_e){j=!0,g=_e}if(a==="throw")throw h;if(j)throw g;return WR(g),h},GU=sS,m2=I0,v2=$1,SL=aT,qU=tM,cM=cS,uM=Cl,WU=vT,h1=mT,D1=aM,HU=Dl.TypeError,E2=function(s,a){this.stopped=s,this.result=a},TL=E2.prototype,_2=function(s,a,h){var g,j,_e,_n,_o,_a,_r,ba=h&&h.that,xa=!(!h||!h.AS_ENTRIES),El=!(!h||!h.IS_ITERATOR),yl=!(!h||!h.INTERRUPTED),Ol=GU(a,ba),Al=function(Ml){return g&&D1(g,"normal",Ml),new E2(!0,Ml)},Nl=function(Ml){return xa?(v2(Ml),yl?Ol(Ml[0],Ml[1],Al):Ol(Ml[0],Ml[1])):yl?Ol(Ml,Al):Ol(Ml)};if(El)g=s;else{if(!(j=h1(s)))throw HU(SL(s)+" is not iterable");if(qU(j)){for(_e=0,_n=cM(s);_n>_e;_e++)if((_o=Nl(s[_e]))&&uM(TL,_o))return _o;return new E2(!1)}g=WU(s,j)}for(_a=g.next;!(_r=m2(_a,g)).done;){try{_o=Nl(_r.value)}catch(Ml){D1(g,"throw",Ml)}if(typeof _o=="object"&&_o&&uM(TL,_o))return _o}return new E2(!1)},RL=LS,HR=Dl.String,dS=function(s){if(RL(s)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return HR(s)},rR=dS,KR=Qp,zR=!_(function(){var s=Error("a");return!("stack"in s)||(Object.defineProperty(s,"stack",KR(1,7)),s.stack!==7)}),y2=a1,iR=Dl,KU=Cl,zU=HO,b2=jU,YU=function(s,a,h){for(var g=e1(a),j=qR.f,_e=Ux.f,_n=0;_n<g.length;_n++){var _o=g[_n];V_(s,_o)||h&&V_(h,_o)||j(s,_o,_e(a,_o))}},lM=ZT,_T=u1,yT=Qp,dM=function(s,a){if(d1&&typeof s=="string")for(;a--;)s=$N(s,_k,"");return s},oR=function(s,a){u2(a)&&"cause"in a&&EL(s,"cause",a.cause)},zS=_2,hM=function(s,a){return s===void 0?arguments.length<2?"":a:rR(s)},IL=zR,pM=y0("toStringTag"),YR=iR.Error,JU=[].push,sR=function(s,a){var h,g=arguments.length>2?arguments[2]:void 0,j=KU(OL,this);b2?h=b2(new YR,j?zU(this):OL):(h=j?this:lM(OL),_T(h,pM,"Error")),a!==void 0&&_T(h,"message",hM(a)),IL&&_T(h,"stack",dM(h.stack,1)),oR(h,g);var _e=[];return zS(s,JU,{that:_e}),_T(h,"errors",_e),h};b2?b2(sR,YR):YU(sR,YR,{name:!0});var OL=sR.prototype=lM(YR.prototype,{constructor:yT(1,sR),message:yT(1,""),name:yT(1,"AggregateError")});y2({global:!0},{AggregateError:sR});var CL=Sp,JR=RN,fM=Tl(Function.toString);CL(JR.inspectSource)||(JR.inspectSource=function(s){return fM(s)});var p1,XR,QR,bT=JR.inspectSource,NL=Sp,gM=bT,mM=Dl.WeakMap,XU=NL(mM)&&/native code/.test(gM(mM)),vM=Dl,LL=Tl,QU=hy,$U=u1,PL=E1,DL=RN,ZU=JT,t5=GR,EM="Object already initialized",ML=vM.TypeError,e5=vM.WeakMap;if(XU||DL.state){var ST=DL.state||(DL.state=new e5),n5=LL(ST.get),_M=LL(ST.has),r5=LL(ST.set);p1=function(s,a){if(_M(ST,s))throw new ML(EM);return a.facade=s,r5(ST,s,a),a},XR=function(s){return n5(ST,s)||{}},QR=function(s){return _M(ST,s)}}else{var aR=ZU("state");t5[aR]=!0,p1=function(s,a){if(PL(s,aR))throw new ML(EM);return a.facade=s,$U(s,aR,a),a},XR=function(s){return PL(s,aR)?s[aR]:{}},QR=function(s){return PL(s,aR)}}var TT,yM,bM,cR={set:p1,get:XR,has:QR,enforce:function(s){return QR(s)?XR(s):p1(s,{})},getterFor:function(s){return function(a){var h;if(!QU(a)||(h=XR(a)).type!==s)throw ML("Incompatible receiver, "+s+" required");return h}}},UL=Kp,i5=E1,SM=Function.prototype,o5=UL&&Object.getOwnPropertyDescriptor,uR=i5(SM,"name"),S2={EXISTS:uR,PROPER:uR&&function(){}.name==="something",CONFIGURABLE:uR&&(!UL||UL&&o5(SM,"name").configurable)},TM=u1,lR=function(s,a,h,g){g&&g.enumerable?s[a]=h:TM(s,a,h)},s5=_,a5=Sp,FL=ZT,VL=HO,c5=lR,BL=y0("iterator"),RM=!1;[].keys&&("next"in(bM=[].keys())?(yM=VL(VL(bM)))!==Object.prototype&&(TT=yM):RM=!0);var RT=TT==null||s5(function(){var s={};return TT[BL].call(s)!==s});a5((TT=RT?{}:FL(TT))[BL])||c5(TT,BL,function(){return this});var K0={IteratorPrototype:TT,BUGGY_SAFARI_ITERATORS:RM},u5=LS,YS=eR?{}.toString:function(){return"[object "+u5(this)+"]"},l5=eR,wM=Ty.f,GL=u1,IM=E1,dR=YS,OM=y0("toStringTag"),wT=function(s,a,h,g){if(s){var j=h?s:s.prototype;IM(j,OM)||wM(j,OM,{configurable:!0,value:a}),g&&!l5&&GL(j,"toString",dR)}},d5=K0.IteratorPrototype,CM=ZT,T2=Qp,h5=wT,p5=gT,f5=function(){return this},AM=function(s,a,h,g){var j=a+" Iterator";return s.prototype=CM(d5,{next:T2(+!g,h)}),h5(s,j,!1,!0),p5[j]=f5,s},g5=a1,m5=I0,v5=AM,E5=HO,NM=wT,kM=lR,LM=gT,PM=S2.PROPER,$R=K0.BUGGY_SAFARI_ITERATORS,WL=y0("iterator"),DM="keys",R2="values",xM="entries",_5=function(){return this},MM=function(s,a,h,g,j,_e,_n){v5(h,a,g);var _o,_a,_r,ba=function(Ml){if(Ml===j&&Al)return Al;if(!$R&&Ml in yl)return yl[Ml];switch(Ml){case DM:case R2:case xM:return function(){return new h(this,Ml)}}return function(){return new h(this)}},xa=a+" Iterator",El=!1,yl=s.prototype,Ol=yl[WL]||yl["@@iterator"]||j&&yl[j],Al=!$R&&Ol||ba(j),Nl=a=="Array"&&yl.entries||Ol;if(Nl&&(_o=E5(Nl.call(new s)))!==Object.prototype&&_o.next&&(NM(_o,xa,!0,!0),LM[xa]=_5),PM&&j==R2&&Ol&&Ol.name!==R2&&(El=!0,Al=function(){return m5(Ol,this)}),j)if(_a={values:ba(R2),keys:_e?Al:ba(DM),entries:ba(xM)},_n)for(_r in _a)($R||El||!(_r in yl))&&kM(yl,_r,_a[_r]);else g5({target:a,proto:!0,forced:$R||El},_a);return _n&&yl[WL]!==Al&&kM(yl,WL,Al,{name:j}),LM[a]=Al,_a},y5=iS,w2=gT,HL=cR;Ty.f;var b5=MM,UM="Array Iterator",S5=HL.set,T5=HL.getterFor(UM);b5(Array,"Array",function(s,a){S5(this,{type:UM,target:y5(s),index:0,kind:a})},function(){var s=T5(this),a=s.target,h=s.kind,g=s.index++;return!a||g>=a.length?(s.target=void 0,{value:void 0,done:!0}):h=="keys"?{value:g,done:!1}:h=="values"?{value:a[g],done:!1}:{value:[g,a[g]],done:!1}},"values"),w2.Arguments=w2.Array;var jM=Dl.Promise,R5=lR,FM=function(s,a,h){for(var g in a)h&&h.unsafe&&s[g]?s[g]=a[g]:R5(s,g,a[g],h);return s},w5=xy,I5=Ty,O5=Kp,VM=y0("species"),C5=Cl,A5=Dl.TypeError,KL=function(s,a){if(C5(a,s))return s;throw A5("Incorrect invocation")},BM=y0("iterator"),GM=!1;try{var N5=0,_i={next:function(){return{done:!!N5++}},return:function(){GM=!0}};_i[BM]=function(){return this},Array.from(_i,function(){throw 2})}catch{}var _u=Tl,Sl=_,xl=Sp,Kl=LS,vp=bT,Op=function(){},xp=[],Mp=xy("Reflect","construct"),$p=/^\s*(?:class|function)\b/,t0=_u($p.exec),g0=!$p.exec(Op),S0=function(s){if(!xl(s))return!1;try{return Mp(Op,xp,s),!0}catch{return!1}},u0=function(s){if(!xl(s))return!1;switch(Kl(s)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return g0||!!t0($p,vp(s))}catch{return!0}};u0.sham=!0;var C0,x0,r_,x_,D0=!Mp||Sl(function(){var s;return S0(S0.call)||!S0(Object)||!S0(function(){s=!0})||s})?u0:S0,w_=D0,Z_=aT,f1=Dl.TypeError,ry=$1,I2=function(s){if(w_(s))return s;throw f1(Z_(s)+" is not a constructor")},hR=y0("species"),qM=function(s,a){var h,g=ry(s).constructor;return g===void 0||(h=ry(g)[hR])==null?a:I2(h)},k5=Tl([].slice),H9=/(?:ipad|iphone|ipod).*applewebkit/i.test(sT),qy=Dl,EZ=_d,_Z=sS,K9=Sp,yZ=E1,bZ=_,z9=l1,SZ=k5,Y9=Fy,TZ=H9,RZ=xR,L5=qy.setImmediate,P5=qy.clearImmediate,wZ=qy.process,D5=qy.Dispatch,IZ=qy.Function,J9=qy.MessageChannel,OZ=qy.String,x5=0,YL={},CZ="onreadystatechange";try{C0=qy.location}catch{}var M5=function(s){if(yZ(YL,s)){var a=YL[s];delete YL[s],a()}},U5=function(s){return function(){M5(s)}},X9=function(s){M5(s.data)},Q9=function(s){qy.postMessage(OZ(s),C0.protocol+"//"+C0.host)};L5&&P5||(L5=function(s){var a=SZ(arguments,1);return YL[++x5]=function(){EZ(K9(s)?s:IZ(s),void 0,a)},x0(x5),x5},P5=function(s){delete YL[s]},RZ?x0=function(s){wZ.nextTick(U5(s))}:D5&&D5.now?x0=function(s){D5.now(U5(s))}:J9&&!TZ?(x_=(r_=new J9).port2,r_.port1.onmessage=X9,x0=_Z(x_.postMessage,x_)):qy.addEventListener&&K9(qy.postMessage)&&!qy.importScripts&&C0&&C0.protocol!=="file:"&&!bZ(Q9)?(x0=Q9,qy.addEventListener("message",X9,!1)):x0=CZ in Y9("script")?function(s){z9.appendChild(Y9("script")).onreadystatechange=function(){z9.removeChild(this),M5(s)}}:function(s){setTimeout(U5(s),0)});var JL,ZR,XL,O2,j5,F5,V5,$9,Z9={set:L5,clear:P5},AZ=Dl,NZ=/ipad|iphone|ipod/i.test(sT)&&AZ.Pebble!==void 0,kZ=/web0s(?!.*chrome)/i.test(sT),_w=Dl,t7=sS,LZ=Up.f,B5=Z9.set,PZ=H9,DZ=NZ,xZ=kZ,G5=xR,e7=_w.MutationObserver||_w.WebKitMutationObserver,n7=_w.document,r7=_w.process,WM=_w.Promise,i7=LZ(_w,"queueMicrotask"),o7=i7&&i7.value;o7||(JL=function(){var s,a;for(G5&&(s=r7.domain)&&s.exit();ZR;){a=ZR.fn,ZR=ZR.next;try{a()}catch(h){throw ZR?O2():XL=void 0,h}}XL=void 0,s&&s.enter()},PZ||G5||xZ||!e7||!n7?!DZ&&WM&&WM.resolve?((V5=WM.resolve(void 0)).constructor=WM,$9=t7(V5.then,V5),O2=function(){$9(JL)}):G5?O2=function(){r7.nextTick(JL)}:(B5=t7(B5,_w),O2=function(){B5(JL)}):(j5=!0,F5=n7.createTextNode(""),new e7(JL).observe(F5,{characterData:!0}),O2=function(){F5.data=j5=!j5}));var MZ=o7||function(s){var a={fn:s,next:void 0};XL&&(XL.next=a),ZR||(ZR=a,O2()),XL=a},C2={},s7=My,UZ=function(s){var a,h;this.promise=new s(function(g,j){if(a!==void 0||h!==void 0)throw TypeError("Bad Promise constructor");a=g,h=j}),this.resolve=s7(a),this.reject=s7(h)};C2.f=function(s){return new UZ(s)};var jZ=$1,FZ=hy,VZ=C2,a7=function(s,a){if(jZ(s),FZ(a)&&a.constructor===s)return a;var h=VZ.f(s);return(0,h.resolve)(a),h.promise},BZ=Dl,HM=function(s){try{return{error:!1,value:s()}}catch(a){return{error:!0,value:a}}},c7=function(){this.head=null,this.tail=null};c7.prototype={add:function(s){var a={item:s,next:null};this.head?this.tail.next=a:this.head=a,this.tail=a},get:function(){var s=this.head;if(s)return this.head=s.next,this.tail===s&&(this.tail=null),s.item}};var q5,u7,W5,GZ=typeof window=="object",KM=a1,IT=Dl,qZ=xy,pR=I0,H5=jM,WZ=FM,HZ=wT,KZ=function(s){var a=w5(s),h=I5.f;O5&&a&&!a[VM]&&h(a,VM,{configurable:!0,get:function(){return this}})},K5=My,zM=Sp,zZ=hy,YZ=KL,JZ=bT,l7=_2,XZ=function(s,a){if(!a&&!GM)return!1;var h=!1;try{var g={};g[BM]=function(){return{next:function(){return{done:h=!0}}}},s(g)}catch{}return h},QZ=qM,d7=Z9.set,z5=MZ,$Z=a7,ZZ=function(s,a){var h=BZ.console;h&&h.error&&(arguments.length==1?h.error(s):h.error(s,a))},h7=C2,Y5=HM,ttt=c7,J5=cR,ett=bO,ntt=GZ,YM=xR,p7=BT,rtt=y0("species"),JS="Promise",f7=J5.getterFor(JS),itt=J5.set,ott=J5.getterFor(JS),stt=H5&&H5.prototype,XS=H5,JM=stt,g7=IT.TypeError,X5=IT.document,Q5=IT.process,A2=h7.f,att=A2,ctt=!!(X5&&X5.createEvent&&IT.dispatchEvent),m7=zM(IT.PromiseRejectionEvent),v7="unhandledrejection",XM=ett(JS,function(){var s=JZ(XS),a=s!==String(XS);if(!a&&p7===66||!JM.finally)return!0;if(p7>=51&&/native code/.test(s))return!1;var h=new XS(function(j){j(1)}),g=function(j){j(function(){},function(){})};return(h.constructor={})[rtt]=g,!(h.then(function(){})instanceof g)||!a&&ntt&&!m7}),utt=XM||!XZ(function(s){XS.all(s).catch(function(){})}),E7=function(s){var a;return!(!zZ(s)||!zM(a=s.then))&&a},_7=function(s,a){var h,g,j,_e=a.value,_n=a.state==1,_o=_n?s.ok:s.fail,_a=s.resolve,_r=s.reject,ba=s.domain;try{_o?(_n||(a.rejection===2&&dtt(a),a.rejection=1),_o===!0?h=_e:(ba&&ba.enter(),h=_o(_e),ba&&(ba.exit(),j=!0)),h===s.promise?_r(g7("Promise-chain cycle")):(g=E7(h))?pR(g,h,_a,_r):_a(h)):_r(_e)}catch(xa){ba&&!j&&ba.exit(),_r(xa)}},y7=function(s,a){s.notified||(s.notified=!0,z5(function(){for(var h,g=s.reactions;h=g.get();)_7(h,s);s.notified=!1,a&&!s.rejection&&ltt(s)}))},b7=function(s,a,h){var g,j;ctt?((g=X5.createEvent("Event")).promise=a,g.reason=h,g.initEvent(s,!1,!0),IT.dispatchEvent(g)):g={promise:a,reason:h},!m7&&(j=IT["on"+s])?j(g):s===v7&&ZZ("Unhandled promise rejection",h)},ltt=function(s){pR(d7,IT,function(){var a,h=s.facade,g=s.value;if(S7(s)&&(a=Y5(function(){YM?Q5.emit("unhandledRejection",g,h):b7(v7,h,g)}),s.rejection=YM||S7(s)?2:1,a.error))throw a.value})},S7=function(s){return s.rejection!==1&&!s.parent},dtt=function(s){pR(d7,IT,function(){var a=s.facade;YM?Q5.emit("rejectionHandled",a):b7("rejectionhandled",a,s.value)})},N2=function(s,a,h){return function(g){s(a,g,h)}},k2=function(s,a,h){s.done||(s.done=!0,h&&(s=h),s.value=a,s.state=2,y7(s,!0))},$5=function(s,a,h){if(!s.done){s.done=!0,h&&(s=h);try{if(s.facade===a)throw g7("Promise can't be resolved itself");var g=E7(a);g?z5(function(){var j={done:!1};try{pR(g,a,N2($5,j,s),N2(k2,j,s))}catch(_e){k2(j,_e,s)}}):(s.value=a,s.state=1,y7(s,!1))}catch(j){k2({done:!1},j,s)}}};XM&&(JM=(XS=function(s){YZ(this,JM),K5(s),pR(q5,this);var a=f7(this);try{s(N2($5,a),N2(k2,a))}catch(h){k2(a,h)}}).prototype,(q5=function(s){itt(this,{type:JS,done:!1,notified:!1,parent:!1,reactions:new ttt,rejection:!1,state:0,value:void 0})}).prototype=WZ(JM,{then:function(s,a){var h=ott(this),g=A2(QZ(this,XS));return h.parent=!0,g.ok=!zM(s)||s,g.fail=zM(a)&&a,g.domain=YM?Q5.domain:void 0,h.state==0?h.reactions.add(g):z5(function(){_7(g,h)}),g.promise},catch:function(s){return this.then(void 0,s)}}),u7=function(){var s=new q5,a=f7(s);this.promise=s,this.resolve=N2($5,a),this.reject=N2(k2,a)},h7.f=A2=function(s){return s===XS||s===W5?new u7(s):att(s)}),KM({global:!0,wrap:!0,forced:XM},{Promise:XS}),HZ(XS,JS,!1,!0),KZ(JS),W5=qZ(JS),KM({target:JS,stat:!0,forced:XM},{reject:function(s){var a=A2(this);return pR(a.reject,void 0,s),a.promise}}),KM({target:JS,stat:!0,forced:!0},{resolve:function(s){return $Z(this===W5?XS:this,s)}}),KM({target:JS,stat:!0,forced:utt},{all:function(s){var a=this,h=A2(a),g=h.resolve,j=h.reject,_e=Y5(function(){var _n=K5(a.resolve),_o=[],_a=0,_r=1;l7(s,function(ba){var xa=_a++,El=!1;_r++,pR(_n,a,ba).then(function(yl){El||(El=!0,_o[xa]=yl,--_r||g(_o))},j)}),--_r||g(_o)});return _e.error&&j(_e.value),h.promise},race:function(s){var a=this,h=A2(a),g=h.reject,j=Y5(function(){var _e=K5(a.resolve);l7(s,function(_n){pR(_e,a,_n).then(h.resolve,g)})});return j.error&&g(j.value),h.promise}});var htt=I0,ptt=My,ftt=C2,gtt=HM,mtt=_2;a1({target:"Promise",stat:!0},{allSettled:function(s){var a=this,h=ftt.f(a),g=h.resolve,j=h.reject,_e=gtt(function(){var _n=ptt(a.resolve),_o=[],_a=0,_r=1;mtt(s,function(ba){var xa=_a++,El=!1;_r++,htt(_n,a,ba).then(function(yl){El||(El=!0,_o[xa]={status:"fulfilled",value:yl},--_r||g(_o))},function(yl){El||(El=!0,_o[xa]={status:"rejected",reason:yl},--_r||g(_o))})}),--_r||g(_o)});return _e.error&&j(_e.value),h.promise}});var vtt=My,Ett=xy,_tt=I0,ytt=C2,btt=HM,Stt=_2,T7="No one promise resolved";a1({target:"Promise",stat:!0},{any:function(s){var a=this,h=Ett("AggregateError"),g=ytt.f(a),j=g.resolve,_e=g.reject,_n=btt(function(){var _o=vtt(a.resolve),_a=[],_r=0,ba=1,xa=!1;Stt(s,function(El){var yl=_r++,Ol=!1;ba++,_tt(_o,a,El).then(function(Al){Ol||xa||(xa=!0,j(Al))},function(Al){Ol||xa||(Ol=!0,_a[yl]=Al,--ba||_e(new h(_a,T7)))})}),--ba||_e(new h(_a,T7))});return _n.error&&_e(_n.value),g.promise}});var R7=jM,Ttt=xy,Rtt=Sp,wtt=qM,w7=a7;a1({target:"Promise",proto:!0,real:!0,forced:!!R7&&_(function(){R7.prototype.finally.call({then:function(){}},function(){})})},{finally:function(s){var a=wtt(this,Ttt("Promise")),h=Rtt(s);return this.then(h?function(g){return w7(a,s()).then(function(){return g})}:s,h?function(g){return w7(a,s()).then(function(){throw g})}:s)}});var Z5=Tl,Itt=aS,Ott=dS,Ctt=H0,Att=Z5("".charAt),I7=Z5("".charCodeAt),Ntt=Z5("".slice),O7=function(s){return function(a,h){var g,j,_e=Ott(Ctt(a)),_n=Itt(h),_o=_e.length;return _n<0||_n>=_o?s?"":void 0:(g=I7(_e,_n))<55296||g>56319||_n+1===_o||(j=I7(_e,_n+1))<56320||j>57343?s?Att(_e,_n):g:s?Ntt(_e,_n,_n+2):j-56320+(g-55296<<10)+65536}},C7={codeAt:O7(!1),charAt:O7(!0)},ktt=C7.charAt,Ltt=dS,A7=cR,Ptt=MM,N7="String Iterator",Dtt=A7.set,xtt=A7.getterFor(N7);Ptt(String,"String",function(s){Dtt(this,{type:N7,string:Ltt(s),index:0})},function(){var s,a=xtt(this),h=a.string,g=a.index;return g>=h.length?{value:void 0,done:!0}:(s=ktt(h,g),a.index+=s.length,{value:s,done:!1})});var Mtt=IS.Promise,Utt={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},jtt=Dl,Ftt=LS,Vtt=u1,k7=gT,L7=y0("toStringTag");for(var t6 in Utt){var P7=jtt[t6],e6=P7&&P7.prototype;e6&&Ftt(e6)!==L7&&Vtt(e6,L7,t6),k7[t6]=k7.Array}var D7=Mtt,s0=D7;const x7=X3;function M7(s,a){const h=s&&s.navigator;if(!h.mediaDevices)return;const g=function(_n){if(typeof _n!="object"||_n.mandatory||_n.optional)return _n;const _o={};return Object.keys(_n).forEach(_a=>{if(_a==="require"||_a==="advanced"||_a==="mediaSource")return;const _r=typeof _n[_a]=="object"?_n[_a]:{ideal:_n[_a]};_r.exact!==void 0&&typeof _r.exact=="number"&&(_r.min=_r.max=_r.exact);const ba=function(xa,El){return xa?xa+El.charAt(0).toUpperCase()+El.slice(1):El==="deviceId"?"sourceId":El};if(_r.ideal!==void 0){_o.optional=_o.optional||[];let xa={};typeof _r.ideal=="number"?(xa[ba("min",_a)]=_r.ideal,_o.optional.push(xa),xa={},xa[ba("max",_a)]=_r.ideal,_o.optional.push(xa)):(xa[ba("",_a)]=_r.ideal,_o.optional.push(xa))}_r.exact!==void 0&&typeof _r.exact!="number"?(_o.mandatory=_o.mandatory||{},_o.mandatory[ba("",_a)]=_r.exact):["min","max"].forEach(xa=>{_r[xa]!==void 0&&(_o.mandatory=_o.mandatory||{},_o.mandatory[ba(xa,_a)]=_r[xa])})}),_n.advanced&&(_o.optional=(_o.optional||[]).concat(_n.advanced)),_o},j=function(_n,_o){if(a.version>=61)return _o(_n);if((_n=JSON.parse(JSON.stringify(_n)))&&typeof _n.audio=="object"){const _a=function(_r,ba,xa){ba in _r&&!(xa in _r)&&(_r[xa]=_r[ba],delete _r[ba])};_a((_n=JSON.parse(JSON.stringify(_n))).audio,"autoGainControl","googAutoGainControl"),_a(_n.audio,"noiseSuppression","googNoiseSuppression"),_n.audio=g(_n.audio)}if(_n&&typeof _n.video=="object"){let _a=_n.video.facingMode;_a=_a&&(typeof _a=="object"?_a:{ideal:_a});const _r=a.version<66;if(_a&&(_a.exact==="user"||_a.exact==="environment"||_a.ideal==="user"||_a.ideal==="environment")&&(!h.mediaDevices.getSupportedConstraints||!h.mediaDevices.getSupportedConstraints().facingMode||_r)){let ba;if(delete _n.video.facingMode,_a.exact==="environment"||_a.ideal==="environment"?ba=["back","rear"]:_a.exact!=="user"&&_a.ideal!=="user"||(ba=["front"]),ba)return h.mediaDevices.enumerateDevices().then(xa=>{let El=(xa=xa.filter(yl=>yl.kind==="videoinput")).find(yl=>ba.some(Ol=>yl.label.toLowerCase().includes(Ol)));return!El&&xa.length&&ba.includes("back")&&(El=xa[xa.length-1]),El&&(_n.video.deviceId=_a.exact?{exact:El.deviceId}:{ideal:El.deviceId}),_n.video=g(_n.video),x7("chrome: "+JSON.stringify(_n)),_o(_n)})}_n.video=g(_n.video)}return x7("chrome: "+JSON.stringify(_n)),_o(_n)},_e=function(_n){return a.version>=64?_n:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[_n.name]||_n.name,message:_n.message,constraint:_n.constraint||_n.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(h.getUserMedia=function(_n,_o,_a){j(_n,_r=>{h.webkitGetUserMedia(_r,_o,ba=>{_a&&_a(_e(ba))})})}.bind(h),h.mediaDevices.getUserMedia){const _n=h.mediaDevices.getUserMedia.bind(h.mediaDevices);h.mediaDevices.getUserMedia=function(_o){return j(_o,_a=>_n(_a).then(_r=>{if(_a.audio&&!_r.getAudioTracks().length||_a.video&&!_r.getVideoTracks().length)throw _r.getTracks().forEach(ba=>{ba.stop()}),new DOMException("","NotFoundError");return _r},_r=>s0.reject(_e(_r))))}}}function U7(s){s.MediaStream=s.MediaStream||s.webkitMediaStream}function j7(s){if(typeof s=="object"&&s.RTCPeerConnection&&!("ontrack"in s.RTCPeerConnection.prototype)){Object.defineProperty(s.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(h){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=h)},enumerable:!0,configurable:!0});const a=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=h=>{h.stream.addEventListener("addtrack",g=>{let j;j=s.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(_n=>_n.track&&_n.track.id===g.track.id):{track:g.track};const _e=new Event("track");_e.track=g.track,_e.receiver=j,_e.transceiver={receiver:j},_e.streams=[h.stream],this.dispatchEvent(_e)}),h.stream.getTracks().forEach(g=>{let j;j=s.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(_n=>_n.track&&_n.track.id===g.id):{track:g};const _e=new Event("track");_e.track=g,_e.receiver=j,_e.transceiver={receiver:j},_e.streams=[h.stream],this.dispatchEvent(_e)})},this.addEventListener("addstream",this._ontrackpoly)),a.apply(this,arguments)}}else q1(s,"track",a=>(a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}}),a))}function F7(s){if(typeof s=="object"&&s.RTCPeerConnection&&!("getSenders"in s.RTCPeerConnection.prototype)&&"createDTMFSender"in s.RTCPeerConnection.prototype){const a=function(j,_e){return{track:_e,get dtmf(){return this._dtmf===void 0&&(_e.kind==="audio"?this._dtmf=j.createDTMFSender(_e):this._dtmf=null),this._dtmf},_pc:j}};if(!s.RTCPeerConnection.prototype.getSenders){s.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const j=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addTrack=function(_n,_o){let _a=j.apply(this,arguments);return _a||(_a=a(this,_n),this._senders.push(_a)),_a};const _e=s.RTCPeerConnection.prototype.removeTrack;s.RTCPeerConnection.prototype.removeTrack=function(_n){_e.apply(this,arguments);const _o=this._senders.indexOf(_n);_o!==-1&&this._senders.splice(_o,1)}}const h=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(j){this._senders=this._senders||[],h.apply(this,[j]),j.getTracks().forEach(_e=>{this._senders.push(a(this,_e))})};const g=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function(j){this._senders=this._senders||[],g.apply(this,[j]),j.getTracks().forEach(_e=>{const _n=this._senders.find(_o=>_o.track===_e);_n&&this._senders.splice(this._senders.indexOf(_n),1)})}}else if(typeof s=="object"&&s.RTCPeerConnection&&"getSenders"in s.RTCPeerConnection.prototype&&"createDTMFSender"in s.RTCPeerConnection.prototype&&s.RTCRtpSender&&!("dtmf"in s.RTCRtpSender.prototype)){const a=s.RTCPeerConnection.prototype.getSenders;s.RTCPeerConnection.prototype.getSenders=function(){const h=a.apply(this,[]);return h.forEach(g=>g._pc=this),h},Object.defineProperty(s.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function V7(s){if(!s.RTCPeerConnection)return;const a=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(){const[h,g,j]=arguments;if(arguments.length>0&&typeof h=="function")return a.apply(this,arguments);if(a.length===0&&(arguments.length===0||typeof h!="function"))return a.apply(this,[]);const _e=function(_o){const _a={};return _o.result().forEach(_r=>{const ba={id:_r.id,timestamp:_r.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[_r.type]||_r.type};_r.names().forEach(xa=>{ba[xa]=_r.stat(xa)}),_a[ba.id]=ba}),_a},_n=function(_o){return new Map(Object.keys(_o).map(_a=>[_a,_o[_a]]))};if(arguments.length>=2){const _o=function(_a){g(_n(_e(_a)))};return a.apply(this,[_o,h])}return new s0((_o,_a)=>{a.apply(this,[function(_r){_o(_n(_e(_r)))},_a])}).then(g,j)}}function B7(s){if(!(typeof s=="object"&&s.RTCPeerConnection&&s.RTCRtpSender&&s.RTCRtpReceiver))return;if(!("getStats"in s.RTCRtpSender.prototype)){const h=s.RTCPeerConnection.prototype.getSenders;h&&(s.RTCPeerConnection.prototype.getSenders=function(){const j=h.apply(this,[]);return j.forEach(_e=>_e._pc=this),j});const g=s.RTCPeerConnection.prototype.addTrack;g&&(s.RTCPeerConnection.prototype.addTrack=function(){const j=g.apply(this,arguments);return j._pc=this,j}),s.RTCRtpSender.prototype.getStats=function(){const j=this;return this._pc.getStats().then(_e=>UR(_e,j.track,!0))}}if(!("getStats"in s.RTCRtpReceiver.prototype)){const h=s.RTCPeerConnection.prototype.getReceivers;h&&(s.RTCPeerConnection.prototype.getReceivers=function(){const g=h.apply(this,[]);return g.forEach(j=>j._pc=this),g}),q1(s,"track",g=>(g.receiver._pc=g.srcElement,g)),s.RTCRtpReceiver.prototype.getStats=function(){const g=this;return this._pc.getStats().then(j=>UR(j,g.track,!1))}}if(!("getStats"in s.RTCRtpSender.prototype)||!("getStats"in s.RTCRtpReceiver.prototype))return;const a=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof s.MediaStreamTrack){const h=arguments[0];let g,j,_e;return this.getSenders().forEach(_n=>{_n.track===h&&(g?_e=!0:g=_n)}),this.getReceivers().forEach(_n=>(_n.track===h&&(j?_e=!0:j=_n),_n.track===h)),_e||g&&j?s0.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):g?g.getStats():j?j.getStats():s0.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}}function G7(s){s.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(_e=>this._shimmedLocalStreams[_e][0])};const a=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addTrack=function(_e,_n){if(!_n)return a.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const _o=a.apply(this,arguments);return this._shimmedLocalStreams[_n.id]?this._shimmedLocalStreams[_n.id].indexOf(_o)===-1&&this._shimmedLocalStreams[_n.id].push(_o):this._shimmedLocalStreams[_n.id]=[_n,_o],_o};const h=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(_e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},_e.getTracks().forEach(_a=>{if(this.getSenders().find(_r=>_r.track===_a))throw new DOMException("Track already exists.","InvalidAccessError")});const _n=this.getSenders();h.apply(this,arguments);const _o=this.getSenders().filter(_a=>_n.indexOf(_a)===-1);this._shimmedLocalStreams[_e.id]=[_e].concat(_o)};const g=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function(_e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[_e.id],g.apply(this,arguments)};const j=s.RTCPeerConnection.prototype.removeTrack;s.RTCPeerConnection.prototype.removeTrack=function(_e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},_e&&Object.keys(this._shimmedLocalStreams).forEach(_n=>{const _o=this._shimmedLocalStreams[_n].indexOf(_e);_o!==-1&&this._shimmedLocalStreams[_n].splice(_o,1),this._shimmedLocalStreams[_n].length===1&&delete this._shimmedLocalStreams[_n]}),j.apply(this,arguments)}}function q7(s,a){if(!s.RTCPeerConnection)return;if(s.RTCPeerConnection.prototype.addTrack&&a.version>=65)return G7(s);const h=s.RTCPeerConnection.prototype.getLocalStreams;s.RTCPeerConnection.prototype.getLocalStreams=function(){const _r=h.apply(this);return this._reverseStreams=this._reverseStreams||{},_r.map(ba=>this._reverseStreams[ba.id])};const g=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(_r){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},_r.getTracks().forEach(ba=>{if(this.getSenders().find(xa=>xa.track===ba))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[_r.id]){const ba=new s.MediaStream(_r.getTracks());this._streams[_r.id]=ba,this._reverseStreams[ba.id]=_r,_r=ba}g.apply(this,[_r])};const j=s.RTCPeerConnection.prototype.removeStream;function _e(_r,ba){let xa=ba.sdp;return Object.keys(_r._reverseStreams||[]).forEach(El=>{const yl=_r._reverseStreams[El],Ol=_r._streams[yl.id];xa=xa.replace(new RegExp(Ol.id,"g"),yl.id)}),new RTCSessionDescription({type:ba.type,sdp:xa})}function _n(_r,ba){let xa=ba.sdp;return Object.keys(_r._reverseStreams||[]).forEach(El=>{const yl=_r._reverseStreams[El],Ol=_r._streams[yl.id];xa=xa.replace(new RegExp(yl.id,"g"),Ol.id)}),new RTCSessionDescription({type:ba.type,sdp:xa})}s.RTCPeerConnection.prototype.removeStream=function(_r){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},j.apply(this,[this._streams[_r.id]||_r]),delete this._reverseStreams[this._streams[_r.id]?this._streams[_r.id].id:_r.id],delete this._streams[_r.id]},s.RTCPeerConnection.prototype.addTrack=function(_r,ba){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const xa=[].slice.call(arguments,1);if(xa.length!==1||!xa[0].getTracks().find(Ol=>Ol===_r))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(Ol=>Ol.track===_r))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const yl=this._streams[ba.id];if(yl)yl.addTrack(_r),s0.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const Ol=new s.MediaStream([_r]);this._streams[ba.id]=Ol,this._reverseStreams[Ol.id]=ba,this.addStream(Ol)}return this.getSenders().find(Ol=>Ol.track===_r)},["createOffer","createAnswer"].forEach(function(_r){const ba=s.RTCPeerConnection.prototype[_r],xa={[_r](){const El=arguments;return arguments.length&&typeof arguments[0]=="function"?ba.apply(this,[yl=>{const Ol=_e(this,yl);El[0].apply(null,[Ol])},yl=>{El[1]&&El[1].apply(null,yl)},arguments[2]]):ba.apply(this,arguments).then(yl=>_e(this,yl))}};s.RTCPeerConnection.prototype[_r]=xa[_r]});const _o=s.RTCPeerConnection.prototype.setLocalDescription;s.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=_n(this,arguments[0]),_o.apply(this,arguments)):_o.apply(this,arguments)};const _a=Object.getOwnPropertyDescriptor(s.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(s.RTCPeerConnection.prototype,"localDescription",{get(){const _r=_a.get.apply(this);return _r.type===""?_r:_e(this,_r)}}),s.RTCPeerConnection.prototype.removeTrack=function(_r){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!_r._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(_r._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let ba;this._streams=this._streams||{},Object.keys(this._streams).forEach(xa=>{this._streams[xa].getTracks().find(El=>_r.track===El)&&(ba=this._streams[xa])}),ba&&(ba.getTracks().length===1?this.removeStream(this._reverseStreams[ba.id]):ba.removeTrack(_r.track),this.dispatchEvent(new Event("negotiationneeded")))}}function n6(s,a){!s.RTCPeerConnection&&s.webkitRTCPeerConnection&&(s.RTCPeerConnection=s.webkitRTCPeerConnection),s.RTCPeerConnection&&a.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(h){const g=s.RTCPeerConnection.prototype[h],j={[h](){return arguments[0]=new(h==="addIceCandidate"?s.RTCIceCandidate:s.RTCSessionDescription)(arguments[0]),g.apply(this,arguments)}};s.RTCPeerConnection.prototype[h]=j[h]})}function W7(s,a){q1(s,"negotiationneeded",h=>{const g=h.target;if(!(a.version<72||g.getConfiguration&&g.getConfiguration().sdpSemantics==="plan-b")||g.signalingState==="stable")return h})}var H7=Object.freeze({__proto__:null,shimMediaStream:U7,shimOnTrack:j7,shimGetSendersWithDtmf:F7,shimGetStats:V7,shimSenderReceiverGetStats:B7,shimAddTrackRemoveTrackWithNative:G7,shimAddTrackRemoveTrack:q7,shimPeerConnection:n6,fixNegotiationNeeded:W7,shimGetUserMedia:M7,shimGetDisplayMedia:function(s,a){s.navigator.mediaDevices&&"getDisplayMedia"in s.navigator.mediaDevices||s.navigator.mediaDevices&&(typeof a=="function"?s.navigator.mediaDevices.getDisplayMedia=function(h){return a(h).then(g=>{const j=h.video&&h.video.width,_e=h.video&&h.video.height,_n=h.video&&h.video.frameRate;return h.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:g,maxFrameRate:_n||3}},j&&(h.video.mandatory.maxWidth=j),_e&&(h.video.mandatory.maxHeight=_e),s.navigator.mediaDevices.getUserMedia(h)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});function K7(s,a){const h=s&&s.navigator,g=s&&s.MediaStreamTrack;if(h.getUserMedia=function(j,_e,_n){FO("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),h.mediaDevices.getUserMedia(j).then(_e,_n)},!(a.version>55&&"autoGainControl"in h.mediaDevices.getSupportedConstraints())){const j=function(_n,_o,_a){_o in _n&&!(_a in _n)&&(_n[_a]=_n[_o],delete _n[_o])},_e=h.mediaDevices.getUserMedia.bind(h.mediaDevices);if(h.mediaDevices.getUserMedia=function(_n){return typeof _n=="object"&&typeof _n.audio=="object"&&(_n=JSON.parse(JSON.stringify(_n)),j(_n.audio,"autoGainControl","mozAutoGainControl"),j(_n.audio,"noiseSuppression","mozNoiseSuppression")),_e(_n)},g&&g.prototype.getSettings){const _n=g.prototype.getSettings;g.prototype.getSettings=function(){const _o=_n.apply(this,arguments);return j(_o,"mozAutoGainControl","autoGainControl"),j(_o,"mozNoiseSuppression","noiseSuppression"),_o}}if(g&&g.prototype.applyConstraints){const _n=g.prototype.applyConstraints;g.prototype.applyConstraints=function(_o){return this.kind==="audio"&&typeof _o=="object"&&(_o=JSON.parse(JSON.stringify(_o)),j(_o,"autoGainControl","mozAutoGainControl"),j(_o,"noiseSuppression","mozNoiseSuppression")),_n.apply(this,[_o])}}}}function z7(s){typeof s=="object"&&s.RTCTrackEvent&&"receiver"in s.RTCTrackEvent.prototype&&!("transceiver"in s.RTCTrackEvent.prototype)&&Object.defineProperty(s.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function r6(s,a){if(typeof s!="object"||!s.RTCPeerConnection&&!s.mozRTCPeerConnection)return;!s.RTCPeerConnection&&s.mozRTCPeerConnection&&(s.RTCPeerConnection=s.mozRTCPeerConnection),a.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(j){const _e=s.RTCPeerConnection.prototype[j],_n={[j](){return arguments[0]=new(j==="addIceCandidate"?s.RTCIceCandidate:s.RTCSessionDescription)(arguments[0]),_e.apply(this,arguments)}};s.RTCPeerConnection.prototype[j]=_n[j]});const h={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},g=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(){const[j,_e,_n]=arguments;return g.apply(this,[j||null]).then(_o=>{if(a.version<53&&!_e)try{_o.forEach(_a=>{_a.type=h[_a.type]||_a.type})}catch(_a){if(_a.name!=="TypeError")throw _a;_o.forEach((_r,ba)=>{_o.set(ba,Object.assign({},_r,{type:h[_r.type]||_r.type}))})}return _o}).then(_e,_n)}}function Y7(s){if(typeof s!="object"||!s.RTCPeerConnection||!s.RTCRtpSender||s.RTCRtpSender&&"getStats"in s.RTCRtpSender.prototype)return;const a=s.RTCPeerConnection.prototype.getSenders;a&&(s.RTCPeerConnection.prototype.getSenders=function(){const g=a.apply(this,[]);return g.forEach(j=>j._pc=this),g});const h=s.RTCPeerConnection.prototype.addTrack;h&&(s.RTCPeerConnection.prototype.addTrack=function(){const g=h.apply(this,arguments);return g._pc=this,g}),s.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):s0.resolve(new Map)}}function J7(s){if(typeof s!="object"||!s.RTCPeerConnection||!s.RTCRtpSender||s.RTCRtpSender&&"getStats"in s.RTCRtpReceiver.prototype)return;const a=s.RTCPeerConnection.prototype.getReceivers;a&&(s.RTCPeerConnection.prototype.getReceivers=function(){const h=a.apply(this,[]);return h.forEach(g=>g._pc=this),h}),q1(s,"track",h=>(h.receiver._pc=h.srcElement,h)),s.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function X7(s){s.RTCPeerConnection&&!("removeStream"in s.RTCPeerConnection.prototype)&&(s.RTCPeerConnection.prototype.removeStream=function(a){FO("removeStream","removeTrack"),this.getSenders().forEach(h=>{h.track&&a.getTracks().includes(h.track)&&this.removeTrack(h)})})}function Q7(s){s.DataChannel&&!s.RTCDataChannel&&(s.RTCDataChannel=s.DataChannel)}function $7(s){if(typeof s!="object"||!s.RTCPeerConnection)return;const a=s.RTCPeerConnection.prototype.addTransceiver;a&&(s.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let h=arguments[1]&&arguments[1].sendEncodings;h===void 0&&(h=[]),h=[...h];const g=h.length>0;g&&h.forEach(_e=>{if("rid"in _e&&!/^[a-z0-9]{0,16}$/i.test(_e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in _e&&!(parseFloat(_e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in _e&&!(parseFloat(_e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const j=a.apply(this,arguments);if(g){const{sender:_e}=j,_n=_e.getParameters();(!("encodings"in _n)||_n.encodings.length===1&&Object.keys(_n.encodings[0]).length===0)&&(_n.encodings=h,_e.sendEncodings=h,this.setParametersPromises.push(_e.setParameters(_n).then(()=>{delete _e.sendEncodings}).catch(()=>{delete _e.sendEncodings})))}return j})}function Z7(s){if(typeof s!="object"||!s.RTCRtpSender)return;const a=s.RTCRtpSender.prototype.getParameters;a&&(s.RTCRtpSender.prototype.getParameters=function(){const h=a.apply(this,arguments);return"encodings"in h||(h.encodings=[].concat(this.sendEncodings||[{}])),h})}function _F(s){if(typeof s!="object"||!s.RTCPeerConnection)return;const a=s.RTCPeerConnection.prototype.createOffer;s.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?s0.all(this.setParametersPromises).then(()=>a.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):a.apply(this,arguments)}}function tV(s){if(typeof s!="object"||!s.RTCPeerConnection)return;const a=s.RTCPeerConnection.prototype.createAnswer;s.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?s0.all(this.setParametersPromises).then(()=>a.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):a.apply(this,arguments)}}var eV=Object.freeze({__proto__:null,shimOnTrack:z7,shimPeerConnection:r6,shimSenderGetStats:Y7,shimReceiverGetStats:J7,shimRemoveStream:X7,shimRTCDataChannel:Q7,shimAddTransceiver:$7,shimGetParameters:Z7,shimCreateOffer:_F,shimCreateAnswer:tV,shimGetUserMedia:K7,shimGetDisplayMedia:function(s,a){s.navigator.mediaDevices&&"getDisplayMedia"in s.navigator.mediaDevices||s.navigator.mediaDevices&&(s.navigator.mediaDevices.getDisplayMedia=function(h){if(!h||!h.video){const g=new DOMException("getDisplayMedia without video constraints is undefined");return g.name="NotFoundError",g.code=8,s0.reject(g)}return h.video===!0?h.video={mediaSource:a}:h.video.mediaSource=a,s.navigator.mediaDevices.getUserMedia(h)})}});function nV(s){if(typeof s=="object"&&s.RTCPeerConnection){if("getLocalStreams"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in s.RTCPeerConnection.prototype)){const a=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addStream=function(h){this._localStreams||(this._localStreams=[]),this._localStreams.includes(h)||this._localStreams.push(h),h.getAudioTracks().forEach(g=>a.call(this,g,h)),h.getVideoTracks().forEach(g=>a.call(this,g,h))},s.RTCPeerConnection.prototype.addTrack=function(h){for(var g=arguments.length,j=new Array(g>1?g-1:0),_e=1;_e<g;_e++)j[_e-1]=arguments[_e];return j&&j.forEach(_n=>{this._localStreams?this._localStreams.includes(_n)||this._localStreams.push(_n):this._localStreams=[_n]}),a.apply(this,arguments)}}"removeStream"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);const h=this._localStreams.indexOf(a);if(h===-1)return;this._localStreams.splice(h,1);const g=a.getTracks();this.getSenders().forEach(j=>{g.includes(j.track)&&this.removeTrack(j)})})}}function rV(s){if(typeof s=="object"&&s.RTCPeerConnection&&("getRemoteStreams"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in s.RTCPeerConnection.prototype))){Object.defineProperty(s.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(h){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=h),this.addEventListener("track",this._onaddstreampoly=g=>{g.streams.forEach(j=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(j))return;this._remoteStreams.push(j);const _e=new Event("addstream");_e.stream=j,this.dispatchEvent(_e)})})}});const a=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){const h=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(g){g.streams.forEach(j=>{if(h._remoteStreams||(h._remoteStreams=[]),h._remoteStreams.indexOf(j)>=0)return;h._remoteStreams.push(j);const _e=new Event("addstream");_e.stream=j,h.dispatchEvent(_e)})}),a.apply(h,arguments)}}}function iV(s){if(typeof s!="object"||!s.RTCPeerConnection)return;const a=s.RTCPeerConnection.prototype,h=a.createOffer,g=a.createAnswer,j=a.setLocalDescription,_e=a.setRemoteDescription,_n=a.addIceCandidate;a.createOffer=function(_a,_r){const ba=arguments.length>=2?arguments[2]:arguments[0],xa=h.apply(this,[ba]);return _r?(xa.then(_a,_r),s0.resolve()):xa},a.createAnswer=function(_a,_r){const ba=arguments.length>=2?arguments[2]:arguments[0],xa=g.apply(this,[ba]);return _r?(xa.then(_a,_r),s0.resolve()):xa};let _o=function(_a,_r,ba){const xa=j.apply(this,[_a]);return ba?(xa.then(_r,ba),s0.resolve()):xa};a.setLocalDescription=_o,_o=function(_a,_r,ba){const xa=_e.apply(this,[_a]);return ba?(xa.then(_r,ba),s0.resolve()):xa},a.setRemoteDescription=_o,_o=function(_a,_r,ba){const xa=_n.apply(this,[_a]);return ba?(xa.then(_r,ba),s0.resolve()):xa},a.addIceCandidate=_o}function oV(s){const a=s&&s.navigator;if(a.mediaDevices&&a.mediaDevices.getUserMedia){const h=a.mediaDevices,g=h.getUserMedia.bind(h);a.mediaDevices.getUserMedia=j=>g(sV(j))}!a.getUserMedia&&a.mediaDevices&&a.mediaDevices.getUserMedia&&(a.getUserMedia=function(h,g,j){a.mediaDevices.getUserMedia(h).then(g,j)}.bind(a))}function sV(s){return s&&s.video!==void 0?Object.assign({},s,{video:GO(s.video)}):s}function aV(s){if(!s.RTCPeerConnection)return;const a=s.RTCPeerConnection;s.RTCPeerConnection=function(h,g){if(h&&h.iceServers){const j=[];for(let _e=0;_e<h.iceServers.length;_e++){let _n=h.iceServers[_e];!_n.hasOwnProperty("urls")&&_n.hasOwnProperty("url")?(FO("RTCIceServer.url","RTCIceServer.urls"),_n=JSON.parse(JSON.stringify(_n)),_n.urls=_n.url,delete _n.url,j.push(_n)):j.push(h.iceServers[_e])}h.iceServers=j}return new a(h,g)},s.RTCPeerConnection.prototype=a.prototype,"generateCertificate"in a&&Object.defineProperty(s.RTCPeerConnection,"generateCertificate",{get:()=>a.generateCertificate})}function cV(s){typeof s=="object"&&s.RTCTrackEvent&&"receiver"in s.RTCTrackEvent.prototype&&!("transceiver"in s.RTCTrackEvent.prototype)&&Object.defineProperty(s.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function uV(s){const a=s.RTCPeerConnection.prototype.createOffer;s.RTCPeerConnection.prototype.createOffer=function(h){if(h){h.offerToReceiveAudio!==void 0&&(h.offerToReceiveAudio=!!h.offerToReceiveAudio);const g=this.getTransceivers().find(_e=>_e.receiver.track.kind==="audio");h.offerToReceiveAudio===!1&&g?g.direction==="sendrecv"?g.setDirection?g.setDirection("sendonly"):g.direction="sendonly":g.direction==="recvonly"&&(g.setDirection?g.setDirection("inactive"):g.direction="inactive"):h.offerToReceiveAudio!==!0||g||this.addTransceiver("audio",{direction:"recvonly"}),h.offerToReceiveVideo!==void 0&&(h.offerToReceiveVideo=!!h.offerToReceiveVideo);const j=this.getTransceivers().find(_e=>_e.receiver.track.kind==="video");h.offerToReceiveVideo===!1&&j?j.direction==="sendrecv"?j.setDirection?j.setDirection("sendonly"):j.direction="sendonly":j.direction==="recvonly"&&(j.setDirection?j.setDirection("inactive"):j.direction="inactive"):h.offerToReceiveVideo!==!0||j||this.addTransceiver("video",{direction:"recvonly"})}return a.apply(this,arguments)}}function lV(s){typeof s!="object"||s.AudioContext||(s.AudioContext=s.webkitAudioContext)}var dV=Object.freeze({__proto__:null,shimLocalStreamsAPI:nV,shimRemoteStreamsAPI:rV,shimCallbacksAPI:iV,shimGetUserMedia:oV,shimConstraints:sV,shimRTCIceServerUrls:aV,shimTrackEventTransceiver:cV,shimCreateOfferLegacy:uV,shimAudioContext:lV}),Btt=`	
\v\f\r \u2028\u2029\uFEFF`,Gtt=H0,qtt=dS,hV=Tl("".replace),QM=`[	
\v\f\r \u2028\u2029\uFEFF]`,Wtt=RegExp("^"+QM+QM+"*"),Htt=RegExp(QM+QM+"*$"),i6=function(s){return function(a){var h=qtt(Gtt(a));return 1&s&&(h=hV(h,Wtt,"")),2&s&&(h=hV(h,Htt,"")),h}},Ktt={start:i6(1),end:i6(2),trim:i6(3)},ztt=S2.PROPER,Ytt=_,pV=Btt,Jtt=Ktt.trim;a1({target:"String",proto:!0,forced:function(s){return Ytt(function(){return!!pV[s]()||""[s]()!==""||ztt&&pV[s].name!==s})}("trim")},{trim:function(){return Jtt(this)}});var Xtt=By("String").trim,Qtt=Cl,$tt=Xtt,o6=String.prototype,OT=function(s){var a=s.trim;return typeof s=="string"||s===o6||Qtt(o6,s)&&a===o6.trim?$tt:a},s6={exports:{}};(function(s){const a={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};a.localCName=a.generateIdentifier(),a.splitLines=function(h){return OT(h).call(h).split(`
`).map(g=>OT(g).call(g))},a.splitSections=function(h){return h.split(`
m=`).map((g,j)=>{var _e;return OT(_e=j>0?"m="+g:g).call(_e)+`\r
`})},a.getDescription=function(h){const g=a.splitSections(h);return g&&g[0]},a.getMediaSections=function(h){const g=a.splitSections(h);return g.shift(),g},a.matchPrefix=function(h,g){return a.splitLines(h).filter(j=>j.indexOf(g)===0)},a.parseCandidate=function(h){let g;g=h.indexOf("a=candidate:")===0?h.substring(12).split(" "):h.substring(10).split(" ");const j={foundation:g[0],component:{1:"rtp",2:"rtcp"}[g[1]]||g[1],protocol:g[2].toLowerCase(),priority:parseInt(g[3],10),ip:g[4],address:g[4],port:parseInt(g[5],10),type:g[7]};for(let _e=8;_e<g.length;_e+=2)switch(g[_e]){case"raddr":j.relatedAddress=g[_e+1];break;case"rport":j.relatedPort=parseInt(g[_e+1],10);break;case"tcptype":j.tcpType=g[_e+1];break;case"ufrag":j.ufrag=g[_e+1],j.usernameFragment=g[_e+1];break;default:j[g[_e]]===void 0&&(j[g[_e]]=g[_e+1])}return j},a.writeCandidate=function(h){const g=[];g.push(h.foundation);const j=h.component;j==="rtp"?g.push(1):j==="rtcp"?g.push(2):g.push(j),g.push(h.protocol.toUpperCase()),g.push(h.priority),g.push(h.address||h.ip),g.push(h.port);const _e=h.type;return g.push("typ"),g.push(_e),_e!=="host"&&h.relatedAddress&&h.relatedPort&&(g.push("raddr"),g.push(h.relatedAddress),g.push("rport"),g.push(h.relatedPort)),h.tcpType&&h.protocol.toLowerCase()==="tcp"&&(g.push("tcptype"),g.push(h.tcpType)),(h.usernameFragment||h.ufrag)&&(g.push("ufrag"),g.push(h.usernameFragment||h.ufrag)),"candidate:"+g.join(" ")},a.parseIceOptions=function(h){return h.substr(14).split(" ")},a.parseRtpMap=function(h){let g=h.substr(9).split(" ");const j={payloadType:parseInt(g.shift(),10)};return g=g[0].split("/"),j.name=g[0],j.clockRate=parseInt(g[1],10),j.channels=g.length===3?parseInt(g[2],10):1,j.numChannels=j.channels,j},a.writeRtpMap=function(h){let g=h.payloadType;h.preferredPayloadType!==void 0&&(g=h.preferredPayloadType);const j=h.channels||h.numChannels||1;return"a=rtpmap:"+g+" "+h.name+"/"+h.clockRate+(j!==1?"/"+j:"")+`\r
`},a.parseExtmap=function(h){const g=h.substr(9).split(" ");return{id:parseInt(g[0],10),direction:g[0].indexOf("/")>0?g[0].split("/")[1]:"sendrecv",uri:g[1]}},a.writeExtmap=function(h){return"a=extmap:"+(h.id||h.preferredId)+(h.direction&&h.direction!=="sendrecv"?"/"+h.direction:"")+" "+h.uri+`\r
`},a.parseFmtp=function(h){const g={};let j;const _e=h.substr(h.indexOf(" ")+1).split(";");for(let _a=0;_a<_e.length;_a++){var _n,_o;j=OT(_n=_e[_a]).call(_n).split("="),g[OT(_o=j[0]).call(_o)]=j[1]}return g},a.writeFmtp=function(h){let g="",j=h.payloadType;if(h.preferredPayloadType!==void 0&&(j=h.preferredPayloadType),h.parameters&&Object.keys(h.parameters).length){const _e=[];Object.keys(h.parameters).forEach(_n=>{h.parameters[_n]!==void 0?_e.push(_n+"="+h.parameters[_n]):_e.push(_n)}),g+="a=fmtp:"+j+" "+_e.join(";")+`\r
`}return g},a.parseRtcpFb=function(h){const g=h.substr(h.indexOf(" ")+1).split(" ");return{type:g.shift(),parameter:g.join(" ")}},a.writeRtcpFb=function(h){let g="",j=h.payloadType;return h.preferredPayloadType!==void 0&&(j=h.preferredPayloadType),h.rtcpFeedback&&h.rtcpFeedback.length&&h.rtcpFeedback.forEach(_e=>{g+="a=rtcp-fb:"+j+" "+_e.type+(_e.parameter&&_e.parameter.length?" "+_e.parameter:"")+`\r
`}),g},a.parseSsrcMedia=function(h){const g=h.indexOf(" "),j={ssrc:parseInt(h.substr(7,g-7),10)},_e=h.indexOf(":",g);return _e>-1?(j.attribute=h.substr(g+1,_e-g-1),j.value=h.substr(_e+1)):j.attribute=h.substr(g+1),j},a.parseSsrcGroup=function(h){const g=h.substr(13).split(" ");return{semantics:g.shift(),ssrcs:g.map(j=>parseInt(j,10))}},a.getMid=function(h){const g=a.matchPrefix(h,"a=mid:")[0];if(g)return g.substr(6)},a.parseFingerprint=function(h){const g=h.substr(14).split(" ");return{algorithm:g[0].toLowerCase(),value:g[1].toUpperCase()}},a.getDtlsParameters=function(h,g){return{role:"auto",fingerprints:a.matchPrefix(h+g,"a=fingerprint:").map(a.parseFingerprint)}},a.writeDtlsParameters=function(h,g){let j="a=setup:"+g+`\r
`;return h.fingerprints.forEach(_e=>{j+="a=fingerprint:"+_e.algorithm+" "+_e.value+`\r
`}),j},a.parseCryptoLine=function(h){const g=h.substr(9).split(" ");return{tag:parseInt(g[0],10),cryptoSuite:g[1],keyParams:g[2],sessionParams:g.slice(3)}},a.writeCryptoLine=function(h){return"a=crypto:"+h.tag+" "+h.cryptoSuite+" "+(typeof h.keyParams=="object"?a.writeCryptoKeyParams(h.keyParams):h.keyParams)+(h.sessionParams?" "+h.sessionParams.join(" "):"")+`\r
`},a.parseCryptoKeyParams=function(h){if(h.indexOf("inline:")!==0)return null;const g=h.substr(7).split("|");return{keyMethod:"inline",keySalt:g[0],lifeTime:g[1],mkiValue:g[2]?g[2].split(":")[0]:void 0,mkiLength:g[2]?g[2].split(":")[1]:void 0}},a.writeCryptoKeyParams=function(h){return h.keyMethod+":"+h.keySalt+(h.lifeTime?"|"+h.lifeTime:"")+(h.mkiValue&&h.mkiLength?"|"+h.mkiValue+":"+h.mkiLength:"")},a.getCryptoParameters=function(h,g){return a.matchPrefix(h+g,"a=crypto:").map(a.parseCryptoLine)},a.getIceParameters=function(h,g){const j=a.matchPrefix(h+g,"a=ice-ufrag:")[0],_e=a.matchPrefix(h+g,"a=ice-pwd:")[0];return j&&_e?{usernameFragment:j.substr(12),password:_e.substr(10)}:null},a.writeIceParameters=function(h){let g="a=ice-ufrag:"+h.usernameFragment+`\r
a=ice-pwd:`+h.password+`\r
`;return h.iceLite&&(g+=`a=ice-lite\r
`),g},a.parseRtpParameters=function(h){const g={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},j=a.splitLines(h)[0].split(" ");for(let _e=3;_e<j.length;_e++){const _n=j[_e],_o=a.matchPrefix(h,"a=rtpmap:"+_n+" ")[0];if(_o){const _a=a.parseRtpMap(_o),_r=a.matchPrefix(h,"a=fmtp:"+_n+" ");switch(_a.parameters=_r.length?a.parseFmtp(_r[0]):{},_a.rtcpFeedback=a.matchPrefix(h,"a=rtcp-fb:"+_n+" ").map(a.parseRtcpFb),g.codecs.push(_a),_a.name.toUpperCase()){case"RED":case"ULPFEC":g.fecMechanisms.push(_a.name.toUpperCase())}}}return a.matchPrefix(h,"a=extmap:").forEach(_e=>{g.headerExtensions.push(a.parseExtmap(_e))}),g},a.writeRtpDescription=function(h,g){let j="";j+="m="+h+" ",j+=g.codecs.length>0?"9":"0",j+=" UDP/TLS/RTP/SAVPF ",j+=g.codecs.map(_n=>_n.preferredPayloadType!==void 0?_n.preferredPayloadType:_n.payloadType).join(" ")+`\r
`,j+=`c=IN IP4 0.0.0.0\r
`,j+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,g.codecs.forEach(_n=>{j+=a.writeRtpMap(_n),j+=a.writeFmtp(_n),j+=a.writeRtcpFb(_n)});let _e=0;return g.codecs.forEach(_n=>{_n.maxptime>_e&&(_e=_n.maxptime)}),_e>0&&(j+="a=maxptime:"+_e+`\r
`),g.headerExtensions&&g.headerExtensions.forEach(_n=>{j+=a.writeExtmap(_n)}),j},a.parseRtpEncodingParameters=function(h){const g=[],j=a.parseRtpParameters(h),_e=j.fecMechanisms.indexOf("RED")!==-1,_n=j.fecMechanisms.indexOf("ULPFEC")!==-1,_o=a.matchPrefix(h,"a=ssrc:").map(El=>a.parseSsrcMedia(El)).filter(El=>El.attribute==="cname"),_a=_o.length>0&&_o[0].ssrc;let _r;const ba=a.matchPrefix(h,"a=ssrc-group:FID").map(El=>El.substr(17).split(" ").map(yl=>parseInt(yl,10)));ba.length>0&&ba[0].length>1&&ba[0][0]===_a&&(_r=ba[0][1]),j.codecs.forEach(El=>{if(El.name.toUpperCase()==="RTX"&&El.parameters.apt){let yl={ssrc:_a,codecPayloadType:parseInt(El.parameters.apt,10)};_a&&_r&&(yl.rtx={ssrc:_r}),g.push(yl),_e&&(yl=JSON.parse(JSON.stringify(yl)),yl.fec={ssrc:_a,mechanism:_n?"red+ulpfec":"red"},g.push(yl))}}),g.length===0&&_a&&g.push({ssrc:_a});let xa=a.matchPrefix(h,"b=");return xa.length&&(xa=xa[0].indexOf("b=TIAS:")===0?parseInt(xa[0].substr(7),10):xa[0].indexOf("b=AS:")===0?1e3*parseInt(xa[0].substr(5),10)*.95-16e3:void 0,g.forEach(El=>{El.maxBitrate=xa})),g},a.parseRtcpParameters=function(h){const g={},j=a.matchPrefix(h,"a=ssrc:").map(_o=>a.parseSsrcMedia(_o)).filter(_o=>_o.attribute==="cname")[0];j&&(g.cname=j.value,g.ssrc=j.ssrc);const _e=a.matchPrefix(h,"a=rtcp-rsize");g.reducedSize=_e.length>0,g.compound=_e.length===0;const _n=a.matchPrefix(h,"a=rtcp-mux");return g.mux=_n.length>0,g},a.writeRtcpParameters=function(h){let g="";return h.reducedSize&&(g+=`a=rtcp-rsize\r
`),h.mux&&(g+=`a=rtcp-mux\r
`),h.ssrc!==void 0&&h.cname&&(g+="a=ssrc:"+h.ssrc+" cname:"+h.cname+`\r
`),g},a.parseMsid=function(h){let g;const j=a.matchPrefix(h,"a=msid:");if(j.length===1)return g=j[0].substr(7).split(" "),{stream:g[0],track:g[1]};const _e=a.matchPrefix(h,"a=ssrc:").map(_n=>a.parseSsrcMedia(_n)).filter(_n=>_n.attribute==="msid");return _e.length>0?(g=_e[0].value.split(" "),{stream:g[0],track:g[1]}):void 0},a.parseSctpDescription=function(h){const g=a.parseMLine(h),j=a.matchPrefix(h,"a=max-message-size:");let _e;j.length>0&&(_e=parseInt(j[0].substr(19),10)),isNaN(_e)&&(_e=65536);const _n=a.matchPrefix(h,"a=sctp-port:");if(_n.length>0)return{port:parseInt(_n[0].substr(12),10),protocol:g.fmt,maxMessageSize:_e};const _o=a.matchPrefix(h,"a=sctpmap:");if(_o.length>0){const _a=_o[0].substr(10).split(" ");return{port:parseInt(_a[0],10),protocol:_a[1],maxMessageSize:_e}}},a.writeSctpDescription=function(h,g){let j=[];return j=h.protocol!=="DTLS/SCTP"?["m="+h.kind+" 9 "+h.protocol+" "+g.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+g.port+`\r
`]:["m="+h.kind+" 9 "+h.protocol+" "+g.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+g.port+" "+g.protocol+` 65535\r
`],g.maxMessageSize!==void 0&&j.push("a=max-message-size:"+g.maxMessageSize+`\r
`),j.join("")},a.generateSessionId=function(){return Math.random().toString().substr(2,21)},a.writeSessionBoilerplate=function(h,g,j){let _e;const _n=g!==void 0?g:2;return _e=h||a.generateSessionId(),`v=0\r
o=`+(j||"thisisadapterortc")+" "+_e+" "+_n+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},a.getDirection=function(h,g){const j=a.splitLines(h);for(let _e=0;_e<j.length;_e++)switch(j[_e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return j[_e].substr(2)}return g?a.getDirection(g):"sendrecv"},a.getKind=function(h){return a.splitLines(h)[0].split(" ")[0].substr(2)},a.isRejected=function(h){return h.split(" ",2)[1]==="0"},a.parseMLine=function(h){const g=a.splitLines(h)[0].substr(2).split(" ");return{kind:g[0],port:parseInt(g[1],10),protocol:g[2],fmt:g.slice(3).join(" ")}},a.parseOLine=function(h){const g=a.matchPrefix(h,"o=")[0].substr(2).split(" ");return{username:g[0],sessionId:g[1],sessionVersion:parseInt(g[2],10),netType:g[3],addressType:g[4],address:g[5]}},a.isValidSDP=function(h){if(typeof h!="string"||h.length===0)return!1;const g=a.splitLines(h);for(let j=0;j<g.length;j++)if(g[j].length<2||g[j].charAt(1)!=="=")return!1;return!0},s.exports=a})(s6);var L2=s6.exports,Ztt=Object.freeze(o({__proto__:null,default:L2},[s6.exports]));function $M(s){if(!s.RTCIceCandidate||s.RTCIceCandidate&&"foundation"in s.RTCIceCandidate.prototype)return;const a=s.RTCIceCandidate;s.RTCIceCandidate=function(h){if(typeof h=="object"&&h.candidate&&h.candidate.indexOf("a=")===0&&((h=JSON.parse(JSON.stringify(h))).candidate=h.candidate.substr(2)),h.candidate&&h.candidate.length){const g=new a(h),j=L2.parseCandidate(h.candidate),_e=Object.assign(g,j);return _e.toJSON=function(){return{candidate:_e.candidate,sdpMid:_e.sdpMid,sdpMLineIndex:_e.sdpMLineIndex,usernameFragment:_e.usernameFragment}},_e}return new a(h)},s.RTCIceCandidate.prototype=a.prototype,q1(s,"icecandidate",h=>(h.candidate&&Object.defineProperty(h,"candidate",{value:new s.RTCIceCandidate(h.candidate),writable:"false"}),h))}function a6(s){!s.RTCIceCandidate||s.RTCIceCandidate&&"relayProtocol"in s.RTCIceCandidate.prototype||q1(s,"icecandidate",a=>{if(a.candidate){const h=L2.parseCandidate(a.candidate.candidate);h.type==="relay"&&(a.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[h.priority>>24])}return a})}function ZM(s,a){if(!s.RTCPeerConnection)return;"sctp"in s.RTCPeerConnection.prototype||Object.defineProperty(s.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const h=function(_o){if(!_o||!_o.sdp)return!1;const _a=L2.splitSections(_o.sdp);return _a.shift(),_a.some(_r=>{const ba=L2.parseMLine(_r);return ba&&ba.kind==="application"&&ba.protocol.indexOf("SCTP")!==-1})},g=function(_o){const _a=_o.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(_a===null||_a.length<2)return-1;const _r=parseInt(_a[1],10);return _r!=_r?-1:_r},j=function(_o){let _a=65536;return a.browser==="firefox"&&(_a=a.version<57?_o===-1?16384:2147483637:a.version<60?a.version===57?65535:65536:2147483637),_a},_e=function(_o,_a){let _r=65536;a.browser==="firefox"&&a.version===57&&(_r=65535);const ba=L2.matchPrefix(_o.sdp,"a=max-message-size:");return ba.length>0?_r=parseInt(ba[0].substr(19),10):a.browser==="firefox"&&_a!==-1&&(_r=2147483637),_r},_n=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,a.browser==="chrome"&&a.version>=76){const{sdpSemantics:_o}=this.getConfiguration();_o==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(h(arguments[0])){const _o=g(arguments[0]),_a=j(_o),_r=_e(arguments[0],_o);let ba;ba=_a===0&&_r===0?Number.POSITIVE_INFINITY:_a===0||_r===0?Math.max(_a,_r):Math.min(_a,_r);const xa={};Object.defineProperty(xa,"maxMessageSize",{get:()=>ba}),this._sctp=xa}return _n.apply(this,arguments)}}function t4(s){if(!s.RTCPeerConnection||!("createDataChannel"in s.RTCPeerConnection.prototype))return;function a(g,j){const _e=g.send;g.send=function(){const _n=arguments[0],_o=_n.length||_n.size||_n.byteLength;if(g.readyState==="open"&&j.sctp&&_o>j.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+j.sctp.maxMessageSize+" bytes)");return _e.apply(g,arguments)}}const h=s.RTCPeerConnection.prototype.createDataChannel;s.RTCPeerConnection.prototype.createDataChannel=function(){const g=h.apply(this,arguments);return a(g,this),g},q1(s,"datachannel",g=>(a(g.channel,g.target),g))}function c6(s){if(!s.RTCPeerConnection||"connectionState"in s.RTCPeerConnection.prototype)return;const a=s.RTCPeerConnection.prototype;Object.defineProperty(a,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(a,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(h){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),h&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=h)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(h=>{const g=a[h];a[h]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=j=>{const _e=j.target;if(_e._lastConnectionState!==_e.connectionState){_e._lastConnectionState=_e.connectionState;const _n=new Event("connectionstatechange",j);_e.dispatchEvent(_n)}return j},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),g.apply(this,arguments)}})}function u6(s,a){if(!s.RTCPeerConnection||a.browser==="chrome"&&a.version>=71||a.browser==="safari"&&a.version>=605)return;const h=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(g){if(g&&g.sdp&&g.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const j=g.sdp.split(`
`).filter(_e=>OT(_e).call(_e)!=="a=extmap-allow-mixed").join(`
`);s.RTCSessionDescription&&g instanceof s.RTCSessionDescription?arguments[0]=new s.RTCSessionDescription({type:g.type,sdp:j}):g.sdp=j}return h.apply(this,arguments)}}function e4(s,a){if(!s.RTCPeerConnection||!s.RTCPeerConnection.prototype)return;const h=s.RTCPeerConnection.prototype.addIceCandidate;h&&h.length!==0&&(s.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(a.browser==="chrome"&&a.version<78||a.browser==="firefox"&&a.version<68||a.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?s0.resolve():h.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),s0.resolve())})}function n4(s,a){if(!s.RTCPeerConnection||!s.RTCPeerConnection.prototype)return;const h=s.RTCPeerConnection.prototype.setLocalDescription;h&&h.length!==0&&(s.RTCPeerConnection.prototype.setLocalDescription=function(){let g=arguments[0]||{};if(typeof g!="object"||g.type&&g.sdp)return h.apply(this,arguments);if(g={type:g.type,sdp:g.sdp},!g.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":g.type="offer";break;default:g.type="answer"}return g.sdp||g.type!=="offer"&&g.type!=="answer"?h.apply(this,[g]):(g.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(_e=>h.apply(this,[_e]))})}var tet=Object.freeze({__proto__:null,shimRTCIceCandidate:$M,shimRTCIceCandidateRelayProtocol:a6,shimMaxMessageSize:ZM,shimSendThrowTypeError:t4,shimConnectionState:c6,removeExtmapAllowMixed:u6,shimAddIceCandidateNullOrEmpty:e4,shimParameterlessSetLocalDescription:n4});let _1,u_;(function(){let{window:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const h=X3,g=AS(s),j={browserDetails:g,commonShim:tet,extractVersion:MR,disableLog:Y3,disableWarnings:J3,sdp:Ztt};switch(g.browser){case"chrome":if(!H7||!n6||!a.shimChrome)return h("Chrome shim is not included in this adapter release."),j;if(g.version===null)return h("Chrome shim can not determine version, not shimming."),j;h("adapter.js shimming chrome."),j.browserShim=H7,e4(s,g),n4(s),M7(s,g),U7(s),n6(s,g),j7(s),q7(s,g),F7(s),V7(s),B7(s),W7(s,g),$M(s),a6(s),c6(s),ZM(s,g),t4(s),u6(s,g);break;case"firefox":if(!eV||!r6||!a.shimFirefox)return h("Firefox shim is not included in this adapter release."),j;h("adapter.js shimming firefox."),j.browserShim=eV,e4(s,g),n4(s),K7(s,g),r6(s,g),z7(s),X7(s),Y7(s),J7(s),Q7(s),$7(s),Z7(s),_F(s),tV(s),$M(s),c6(s),ZM(s,g),t4(s);break;case"safari":if(!dV||!a.shimSafari)return h("Safari shim is not included in this adapter release."),j;h("adapter.js shimming safari."),j.browserShim=dV,e4(s,g),n4(s),aV(s),uV(s),iV(s),nV(s),rV(s),cV(s),oV(s),lV(s),$M(s),a6(s),ZM(s,g),t4(s),u6(s,g);break;default:h("Unsupported browser!")}})({window:typeof window>"u"?void 0:window}),function(s){s.WIN_10="Windows 10",s.WIN_81="Windows 8.1",s.WIN_8="Windows 8",s.WIN_7="Windows 7",s.WIN_VISTA="Windows Vista",s.WIN_SERVER_2003="Windows Server 2003",s.WIN_XP="Windows XP",s.WIN_2000="Windows 2000",s.ANDROID="Android",s.OPEN_BSD="Open BSD",s.SUN_OS="Sun OS",s.LINUX="Linux",s.IOS="iOS",s.MAC_OS="Mac OS",s.QNX="QNX",s.UNIX="UNIX",s.BEOS="BeOS",s.OS_2="OS/2",s.SEARCH_BOT="Search Bot"}(_1||(_1={})),function(s){s.CHROME="Chrome",s.SAFARI="Safari",s.EDGE="Edge",s.FIREFOX="Firefox",s.OPERA="OPR",s.QQ="QQBrowser",s.WECHAT="MicroMessenger"}(u_||(u_={}));var l6={exports:{}};(function(s,a){(function(h,g){var j="function",_e="undefined",_n="object",_o="string",_a="model",_r="name",ba="type",xa="vendor",El="version",yl="architecture",Ol="console",Al="mobile",Nl="tablet",Ml="smarttv",Fl="wearable",up="embedded",_p="Amazon",Tp="Apple",Fp="ASUS",Ap="BlackBerry",Xp="Firefox",_g="Google",Yp="Huawei",h0="LG",E0="Microsoft",A0="Motorola",_E="Opera",Rp="Samsung",Lp="Sharp",Ep="Sony",Ip="Xiaomi",Vp="Zebra",_v="Facebook",f0=function(q0){for(var E_={},X0=0;X0<q0.length;X0++)E_[q0[X0].toUpperCase()]=q0[X0];return E_},zp=function(q0,E_){return typeof q0===_o&&Il(E_).indexOf(Il(q0))!==-1},Il=function(q0){return q0.toLowerCase()},Gl=function(q0,E_){if(typeof q0===_o)return q0=q0.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof E_===_e?q0:q0.substring(0,350)},_h=function(q0,E_){for(var X0,Q1,$0,v_,nS,k1,dN=0;dN<E_.length&&!nS;){var l3=E_[dN],uU=E_[dN+1];for(X0=Q1=0;X0<l3.length&&!nS;)if(nS=l3[X0++].exec(q0))for($0=0;$0<uU.length;$0++)k1=nS[++Q1],typeof(v_=uU[$0])===_n&&v_.length>0?v_.length===2?typeof v_[1]==j?this[v_[0]]=v_[1].call(this,k1):this[v_[0]]=v_[1]:v_.length===3?typeof v_[1]!==j||v_[1].exec&&v_[1].test?this[v_[0]]=k1?k1.replace(v_[1],v_[2]):g:this[v_[0]]=k1?v_[1].call(this,k1,v_[2]):g:v_.length===4&&(this[v_[0]]=k1?v_[3].call(this,k1.replace(v_[1],v_[2])):g):this[v_]=k1||g;dN+=2}},Pp=function(q0,E_){for(var X0 in E_)if(typeof E_[X0]===_n&&E_[X0].length>0){for(var Q1=0;Q1<E_[X0].length;Q1++)if(zp(E_[X0][Q1],q0))return X0==="?"?g:X0}else if(zp(E_[X0],q0))return X0==="?"?g:X0;return q0},m0={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Q0={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[El,[_r,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[El,[_r,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[_r,El],[/opios[\/ ]+([\w\.]+)/i],[El,[_r,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[El,[_r,_E]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[_r,El],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[El,[_r,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[El,[_r,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[El,[_r,"WeChat"]],[/konqueror\/([\w\.]+)/i],[El,[_r,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[El,[_r,"IE"]],[/yabrowser\/([\w\.]+)/i],[El,[_r,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[_r,/(.+)/,"$1 Secure Browser"],El],[/\bfocus\/([\w\.]+)/i],[El,[_r,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[El,[_r,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[El,[_r,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[El,[_r,"Dolphin"]],[/coast\/([\w\.]+)/i],[El,[_r,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[El,[_r,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[El,[_r,Xp]],[/\bqihu|(qi?ho?o?|360)browser/i],[[_r,"360 Browser"]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[_r,/(.+)/,"$1 Browser"],El],[/(comodo_dragon)\/([\w\.]+)/i],[[_r,/_/g," "],El],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[_r,El],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[_r],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[_r,_v],El],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[_r,El],[/\bgsa\/([\w\.]+) .*safari\//i],[El,[_r,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[El,[_r,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[_r,"Chrome WebView"],El],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[El,[_r,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[_r,El],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[El,[_r,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[El,_r],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[_r,[El,Pp,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[_r,El],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[_r,"Netscape"],El],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[El,[_r,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[_r,El]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[yl,"amd64"]],[/(ia32(?=;))/i],[[yl,Il]],[/((?:i[346]|x)86)[;\)]/i],[[yl,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[yl,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[yl,"armhf"]],[/windows (ce|mobile); ppc;/i],[[yl,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[yl,/ower/,"",Il]],[/(sun4\w)[;\)]/i],[[yl,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[yl,Il]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[_a,[xa,Rp],[ba,Nl]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[_a,[xa,Rp],[ba,Al]],[/\((ip(?:hone|od)[\w ]*);/i],[_a,[xa,Tp],[ba,Al]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[_a,[xa,Tp],[ba,Nl]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[_a,[xa,Yp],[ba,Nl]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[_a,[xa,Yp],[ba,Al]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[_a,/_/g," "],[xa,Ip],[ba,Al]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[_a,/_/g," "],[xa,Ip],[ba,Nl]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[_a,[xa,"OPPO"],[ba,Al]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[_a,[xa,"Vivo"],[ba,Al]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[_a,[xa,"Realme"],[ba,Al]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[_a,[xa,A0],[ba,Al]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[_a,[xa,A0],[ba,Nl]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[_a,[xa,h0],[ba,Nl]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[_a,[xa,h0],[ba,Al]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[_a,[xa,"Lenovo"],[ba,Nl]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[_a,/_/g," "],[xa,"Nokia"],[ba,Al]],[/(pixel c)\b/i],[_a,[xa,_g],[ba,Nl]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[_a,[xa,_g],[ba,Al]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[_a,[xa,Ep],[ba,Al]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[_a,"Xperia Tablet"],[xa,Ep],[ba,Nl]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[_a,[xa,"OnePlus"],[ba,Al]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[_a,[xa,_p],[ba,Nl]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[_a,/(.+)/g,"Fire Phone $1"],[xa,_p],[ba,Al]],[/(playbook);[-\w\),; ]+(rim)/i],[_a,xa,[ba,Nl]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[_a,[xa,Ap],[ba,Al]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[_a,[xa,Fp],[ba,Nl]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[_a,[xa,Fp],[ba,Al]],[/(nexus 9)/i],[_a,[xa,"HTC"],[ba,Nl]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[xa,[_a,/_/g," "],[ba,Al]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[_a,[xa,"Acer"],[ba,Nl]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[_a,[xa,"Meizu"],[ba,Al]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[_a,[xa,Lp],[ba,Al]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[xa,_a,[ba,Al]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[xa,_a,[ba,Nl]],[/(surface duo)/i],[_a,[xa,E0],[ba,Nl]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[_a,[xa,"Fairphone"],[ba,Al]],[/(u304aa)/i],[_a,[xa,"AT&T"],[ba,Al]],[/\bsie-(\w*)/i],[_a,[xa,"Siemens"],[ba,Al]],[/\b(rct\w+) b/i],[_a,[xa,"RCA"],[ba,Nl]],[/\b(venue[\d ]{2,7}) b/i],[_a,[xa,"Dell"],[ba,Nl]],[/\b(q(?:mv|ta)\w+) b/i],[_a,[xa,"Verizon"],[ba,Nl]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[_a,[xa,"Barnes & Noble"],[ba,Nl]],[/\b(tm\d{3}\w+) b/i],[_a,[xa,"NuVision"],[ba,Nl]],[/\b(k88) b/i],[_a,[xa,"ZTE"],[ba,Nl]],[/\b(nx\d{3}j) b/i],[_a,[xa,"ZTE"],[ba,Al]],[/\b(gen\d{3}) b.+49h/i],[_a,[xa,"Swiss"],[ba,Al]],[/\b(zur\d{3}) b/i],[_a,[xa,"Swiss"],[ba,Nl]],[/\b((zeki)?tb.*\b) b/i],[_a,[xa,"Zeki"],[ba,Nl]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[xa,"Dragon Touch"],_a,[ba,Nl]],[/\b(ns-?\w{0,9}) b/i],[_a,[xa,"Insignia"],[ba,Nl]],[/\b((nxa|next)-?\w{0,9}) b/i],[_a,[xa,"NextBook"],[ba,Nl]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[xa,"Voice"],_a,[ba,Al]],[/\b(lvtel\-)?(v1[12]) b/i],[[xa,"LvTel"],_a,[ba,Al]],[/\b(ph-1) /i],[_a,[xa,"Essential"],[ba,Al]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[_a,[xa,"Envizen"],[ba,Nl]],[/\b(trio[-\w\. ]+) b/i],[_a,[xa,"MachSpeed"],[ba,Nl]],[/\btu_(1491) b/i],[_a,[xa,"Rotor"],[ba,Nl]],[/(shield[\w ]+) b/i],[_a,[xa,"Nvidia"],[ba,Nl]],[/(sprint) (\w+)/i],[xa,_a,[ba,Al]],[/(kin\.[onetw]{3})/i],[[_a,/\./g," "],[xa,E0],[ba,Al]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[_a,[xa,Vp],[ba,Nl]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[_a,[xa,Vp],[ba,Al]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[xa,_a,[ba,Ol]],[/droid.+; (shield) bui/i],[_a,[xa,"Nvidia"],[ba,Ol]],[/(playstation [345portablevi]+)/i],[_a,[xa,Ep],[ba,Ol]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[_a,[xa,E0],[ba,Ol]],[/smart-tv.+(samsung)/i],[xa,[ba,Ml]],[/hbbtv.+maple;(\d+)/i],[[_a,/^/,"SmartTV"],[xa,Rp],[ba,Ml]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[xa,h0],[ba,Ml]],[/(apple) ?tv/i],[xa,[_a,"Apple TV"],[ba,Ml]],[/crkey/i],[[_a,"Chromecast"],[xa,_g],[ba,Ml]],[/droid.+aft(\w)( bui|\))/i],[_a,[xa,_p],[ba,Ml]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[_a,[xa,Lp],[ba,Ml]],[/(bravia[\w ]+)( bui|\))/i],[_a,[xa,Ep],[ba,Ml]],[/(mitv-\w{5}) bui/i],[_a,[xa,Ip],[ba,Ml]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[xa,Gl],[_a,Gl],[ba,Ml]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[ba,Ml]],[/((pebble))app/i],[xa,_a,[ba,Fl]],[/droid.+; (glass) \d/i],[_a,[xa,_g],[ba,Fl]],[/droid.+; (wt63?0{2,3})\)/i],[_a,[xa,Vp],[ba,Fl]],[/(quest( 2)?)/i],[_a,[xa,_v],[ba,Fl]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[xa,[ba,up]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[_a,[ba,Al]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[_a,[ba,Nl]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[ba,Nl]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[ba,Al]],[/(android[-\w\. ]{0,9});.+buil/i],[_a,[xa,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[El,[_r,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[El,[_r,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[_r,El],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[El,_r]],os:[[/microsoft (windows) (vista|xp)/i],[_r,El],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[_r,[El,Pp,m0]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[_r,"Windows"],[El,Pp,m0]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[El,/_/g,"."],[_r,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[_r,"Mac OS"],[El,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[El,_r],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[_r,El],[/\(bb(10);/i],[El,[_r,Ap]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[El,[_r,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[El,[_r,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[El,[_r,"webOS"]],[/crkey\/([\d\.]+)/i],[El,[_r,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[_r,"Chromium OS"],El],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[_r,El],[/(sunos) ?([\w\.\d]*)/i],[[_r,"Solaris"],El],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[_r,El]]},h_=function(q0,E_){if(typeof q0===_n&&(E_=q0,q0=g),!(this instanceof h_))return new h_(q0,E_).getResult();var X0=q0||(typeof h!==_e&&h.navigator&&h.navigator.userAgent?h.navigator.userAgent:""),Q1=E_?function($0,v_){var nS={};for(var k1 in $0)v_[k1]&&v_[k1].length%2==0?nS[k1]=v_[k1].concat($0[k1]):nS[k1]=$0[k1];return nS}(Q0,E_):Q0;return this.getBrowser=function(){var $0={};return $0.name=g,$0.version=g,_h.call($0,X0,Q1.browser),$0.major=function(v_){return typeof v_===_o?v_.replace(/[^\d\.]/g,"").split(".")[0]:g}($0.version),$0},this.getCPU=function(){var $0={};return $0.architecture=g,_h.call($0,X0,Q1.cpu),$0},this.getDevice=function(){var $0={};return $0.vendor=g,$0.model=g,$0.type=g,_h.call($0,X0,Q1.device),$0},this.getEngine=function(){var $0={};return $0.name=g,$0.version=g,_h.call($0,X0,Q1.engine),$0},this.getOS=function(){var $0={};return $0.name=g,$0.version=g,_h.call($0,X0,Q1.os),$0},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return X0},this.setUA=function($0){return X0=typeof $0===_o&&$0.length>350?Gl($0,350):$0,this},this.setUA(X0),this};h_.VERSION="0.7.32",h_.BROWSER=f0([_r,El,"major"]),h_.CPU=f0([yl]),h_.DEVICE=f0([_a,xa,ba,Ol,Al,Ml,Nl,Fl,up]),h_.ENGINE=h_.OS=f0([_r,El]),s.exports&&(a=s.exports=h_),a.UAParser=h_;var e_=typeof h!==_e&&(h.jQuery||h.Zepto);if(e_&&!e_.ua){var $_=new h_;e_.ua=$_.getResult(),e_.ua.get=function(){return $_.getUA()},e_.ua.set=function(q0){$_.setUA(q0);var E_=$_.getResult();for(var X0 in E_)e_.ua[X0]=E_[X0]}}})(typeof window=="object"?window:c)})(l6,l6.exports);const d6=new l6.exports;let CT=d6.getResult();function p_(s){return s&&d6.setUA(s),CT=d6.getResult(),{name:eet(CT),version:net(CT),os:ret(CT),osVersion:CT.os.version}}function eet(s){if(s.engine.name==="Blink"&&s.browser.name!=="WeChat")return u_.CHROME;switch(s.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return u_.CHROME;case"Safari":case"Mobile Safari":return u_.SAFARI;case"Edge":return u_.EDGE;case"Firefox":return u_.FIREFOX;case"QQBrowser":return u_.QQ;case"Opera":return u_.OPERA;case"WeChat":return u_.WECHAT;default:return s.browser.name||""}}function net(s){let a;return a=s.engine.name==="Blink"?s.engine.version||"":s.browser.version||"",a.split(".")[0]}function ret(s){switch(s.os.name){case"Windows":return s.os.version?s.os.name+" "+s.os.version:s.os.name;default:return s.os.name||""}}function fV(){return p_().os}function r4(){const s=p_();return!!(CT.engine.name==="WebKit"&&s.os===_1.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&s.name!==u_.SAFARI||x1()&&s.name!==u_.SAFARI)}function iet(){const s=p_();if(r4()){if(s.os===_1.MAC_OS)return!0;if(s.os===_1.IOS){const a=CT.os.version&&CT.os.version.split(".");if(a&&Number(a[0])===14&&a[1]&&Number(a[1])>=3||a&&Number(a[0])>14)return!0}}return!1}function oet(){return CT.engine.name==="WebKit"}function h6(){return p_().name===u_.CHROME}function iy(){return p_().name===u_.SAFARI}function M_(){return p_().name===u_.FIREFOX}function x1(){return p_().os===_1.IOS}function gV(){const s=p_();return!(s.name!==u_.CHROME||!s.osVersion)&&Number(s.version)<=90}function P2(){const s=p_();if(s.os!==_1.IOS||!s.osVersion)return!1;const a=s.osVersion.split(".");return Number(a[0])===15}function mV(){const s=p_();if(s.os!==_1.IOS||!s.osVersion)return!1;const a=s.osVersion.split(".");return Number(a[0])===15&&Number(a[1])===0}function vV(){const s=p_();if(s.os!==_1.IOS||!s.osVersion)return!1;const a=s.osVersion.split(".");return Number(a[0])===15&&Number(a[1])>=1}function p6(){const s=p_();if(s.os!==_1.IOS||!s.osVersion)return!1;const a=s.osVersion.split(".");return Number(a[0])===15&&Number(a[1])>=2}function AT(){return iy()&&navigator.maxTouchPoints>0}function EV(){return p_().name===u_.WECHAT}function _V(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function _I(){const s=p_();return s.name===u_.EDGE||s.name===u_.SAFARI?!1:!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function f6(){return p_().os===_1.ANDROID}function QL(){const s=p_();return s.os==="Android"&&(s.name==="Chrome"||s.name===u_.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}var yV={exports:{}},set=a1,aet=Kp,bV=Ty.f;set({target:"Object",stat:!0,forced:Object.defineProperty!==bV,sham:!aet},{defineProperty:bV});var SV=IS.Object,cet=yV.exports=function(s,a,h){return SV.defineProperty(s,a,h)};SV.defineProperty.sham&&(cet.sham=!0);var TV=yV.exports;function Rl(s,a,h){return a in s?TV(s,a,{value:h,enumerable:!0,configurable:!0,writable:!0}):s[a]=h,s}var g6,m6={exports:{}},RV=function(s,a){return function(){for(var h=new Array(arguments.length),g=0;g<h.length;g++)h[g]=arguments[g];return s.apply(a,h)}},uet=RV,v6=Object.prototype.toString,E6=(g6=Object.create(null),function(s){var a=v6.call(s);return g6[a]||(g6[a]=a.slice(8,-1).toLowerCase())});function tO(s){return s=s.toLowerCase(),function(a){return E6(a)===s}}function _6(s){return Array.isArray(s)}function i4(s){return s===void 0}var wV=tO("ArrayBuffer");function IV(s){return s!==null&&typeof s=="object"}function o4(s){if(E6(s)!=="object")return!1;var a=Object.getPrototypeOf(s);return a===null||a===Object.prototype}var det=tO("Date"),het=tO("File"),pet=tO("Blob"),fet=tO("FileList");function y6(s){return v6.call(s)==="[object Function]"}var get=tO("URLSearchParams");function b6(s,a){if(s!=null)if(typeof s!="object"&&(s=[s]),_6(s))for(var h=0,g=s.length;h<g;h++)a.call(null,s[h],h,s);else for(var j in s)Object.prototype.hasOwnProperty.call(s,j)&&a.call(null,s[j],j,s)}var S6,met=(S6=typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array),function(s){return S6&&s instanceof S6}),H1={isArray:_6,isArrayBuffer:wV,isBuffer:function(s){return s!==null&&!i4(s)&&s.constructor!==null&&!i4(s.constructor)&&typeof s.constructor.isBuffer=="function"&&s.constructor.isBuffer(s)},isFormData:function(s){var a="[object FormData]";return s&&(typeof FormData=="function"&&s instanceof FormData||v6.call(s)===a||y6(s.toString)&&s.toString()===a)},isArrayBufferView:function(s){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(s):s&&s.buffer&&wV(s.buffer)},isString:function(s){return typeof s=="string"},isNumber:function(s){return typeof s=="number"},isObject:IV,isPlainObject:o4,isUndefined:i4,isDate:det,isFile:het,isBlob:pet,isFunction:y6,isStream:function(s){return IV(s)&&y6(s.pipe)},isURLSearchParams:get,isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:b6,merge:function s(){var a={};function h(_e,_n){o4(a[_n])&&o4(_e)?a[_n]=s(a[_n],_e):o4(_e)?a[_n]=s({},_e):_6(_e)?a[_n]=_e.slice():a[_n]=_e}for(var g=0,j=arguments.length;g<j;g++)b6(arguments[g],h);return a},extend:function(s,a,h){return b6(a,function(g,j){s[j]=h&&typeof g=="function"?uet(g,h):g}),s},trim:function(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")},stripBOM:function(s){return s.charCodeAt(0)===65279&&(s=s.slice(1)),s},inherits:function(s,a,h,g){s.prototype=Object.create(a.prototype,g),s.prototype.constructor=s,h&&Object.assign(s.prototype,h)},toFlatObject:function(s,a,h){var g,j,_e,_n={};a=a||{};do{for(j=(g=Object.getOwnPropertyNames(s)).length;j-- >0;)_n[_e=g[j]]||(a[_e]=s[_e],_n[_e]=!0);s=Object.getPrototypeOf(s)}while(s&&(!h||h(s,a))&&s!==Object.prototype);return a},kindOf:E6,kindOfTest:tO,endsWith:function(s,a,h){s=String(s),(h===void 0||h>s.length)&&(h=s.length),h-=a.length;var g=s.indexOf(a,h);return g!==-1&&g===h},toArray:function(s){if(!s)return null;var a=s.length;if(i4(a))return null;for(var h=new Array(a);a-- >0;)h[a]=s[a];return h},isTypedArray:met,isFileList:fet},D2=H1;function OV(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var CV=function(s,a,h){if(!a)return s;var g;if(h)g=h(a);else if(D2.isURLSearchParams(a))g=a.toString();else{var j=[];D2.forEach(a,function(_n,_o){_n!=null&&(D2.isArray(_n)?_o+="[]":_n=[_n],D2.forEach(_n,function(_a){D2.isDate(_a)?_a=_a.toISOString():D2.isObject(_a)&&(_a=JSON.stringify(_a)),j.push(OV(_o)+"="+OV(_a))}))}),g=j.join("&")}if(g){var _e=s.indexOf("#");_e!==-1&&(s=s.slice(0,_e)),s+=(s.indexOf("?")===-1?"?":"&")+g}return s},vet=H1;function s4(){this.handlers=[]}s4.prototype.use=function(s,a,h){return this.handlers.push({fulfilled:s,rejected:a,synchronous:!!h&&h.synchronous,runWhen:h?h.runWhen:null}),this.handlers.length-1},s4.prototype.eject=function(s){this.handlers[s]&&(this.handlers[s]=null)},s4.prototype.forEach=function(s){vet.forEach(this.handlers,function(a){a!==null&&s(a)})};var Eet=s4,_et=H1,AV=H1;function x2(s,a,h,g,j){Error.call(this),this.message=s,this.name="AxiosError",a&&(this.code=a),h&&(this.config=h),g&&(this.request=g),j&&(this.response=j)}AV.inherits(x2,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var NV=x2.prototype,kV={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(s){kV[s]={value:s}}),Object.defineProperties(x2,kV),Object.defineProperty(NV,"isAxiosError",{value:!0}),x2.from=function(s,a,h,g,j,_e){var _n=Object.create(NV);return AV.toFlatObject(s,_n,function(_o){return _o!==Error.prototype}),x2.call(_n,s.message,a,h,g,j),_n.name=s.name,_e&&Object.assign(_n,_e),_n};var M2=x2,LV={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},PS=H1,PV=function(s,a){a=a||new FormData;var h=[];function g(j){return j===null?"":PS.isDate(j)?j.toISOString():PS.isArrayBuffer(j)||PS.isTypedArray(j)?typeof Blob=="function"?new Blob([j]):Buffer.from(j):j}return function j(_e,_n){if(PS.isPlainObject(_e)||PS.isArray(_e)){if(h.indexOf(_e)!==-1)throw Error("Circular reference detected in "+_n);h.push(_e),PS.forEach(_e,function(_o,_a){if(!PS.isUndefined(_o)){var _r,ba=_n?_n+"."+_a:_a;if(_o&&!_n&&typeof _o=="object"){if(PS.endsWith(_a,"{}"))_o=JSON.stringify(_o);else if(PS.endsWith(_a,"[]")&&(_r=PS.toArray(_o)))return void _r.forEach(function(xa){!PS.isUndefined(xa)&&a.append(ba,g(xa))})}j(_o,ba)}}),h.pop()}else a.append(_n,g(_e))}(s),a},T6=M2,a4=H1,yet=a4.isStandardBrowserEnv()?{write:function(s,a,h,g,j,_e){var _n=[];_n.push(s+"="+encodeURIComponent(a)),a4.isNumber(h)&&_n.push("expires="+new Date(h).toGMTString()),a4.isString(g)&&_n.push("path="+g),a4.isString(j)&&_n.push("domain="+j),_e===!0&&_n.push("secure"),document.cookie=_n.join("; ")},read:function(s){var a=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return a?decodeURIComponent(a[3]):null},remove:function(s){this.write(s,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},bet=function(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)},Tet=function(s,a){return a?s.replace(/\/+$/,"")+"/"+a.replace(/^\/+/,""):s},DV=function(s,a){return s&&!bet(a)?Tet(s,a):a},R6=H1,Ret=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],xV=H1,wet=xV.isStandardBrowserEnv()?function(){var s,a=/(msie|trident)/i.test(navigator.userAgent),h=document.createElement("a");function g(j){var _e=j;return a&&(h.setAttribute("href",_e),_e=h.href),h.setAttribute("href",_e),{href:h.href,protocol:h.protocol?h.protocol.replace(/:$/,""):"",host:h.host,search:h.search?h.search.replace(/^\?/,""):"",hash:h.hash?h.hash.replace(/^#/,""):"",hostname:h.hostname,port:h.port,pathname:h.pathname.charAt(0)==="/"?h.pathname:"/"+h.pathname}}return s=g(window.location.href),function(j){var _e=xV.isString(j)?g(j):j;return _e.protocol===s.protocol&&_e.host===s.host}}():function(){return!0},w6=M2;function MV(s){w6.call(this,s??"canceled",w6.ERR_CANCELED),this.name="CanceledError"}H1.inherits(MV,w6,{__CANCEL__:!0});var c4=MV,$L=H1,Iet=function(s,a,h){var g=h.config.validateStatus;h.status&&g&&!g(h.status)?a(new T6("Request failed with status code "+h.status,[T6.ERR_BAD_REQUEST,T6.ERR_BAD_RESPONSE][Math.floor(h.status/100)-4],h.config,h.request,h)):s(h)},Oet=yet,Cet=CV,Aet=DV,Net=function(s){var a,h,g,j={};return s&&R6.forEach(s.split(`
`),function(_e){if(g=_e.indexOf(":"),a=R6.trim(_e.substr(0,g)).toLowerCase(),h=R6.trim(_e.substr(g+1)),a){if(j[a]&&Ret.indexOf(a)>=0)return;j[a]=a==="set-cookie"?(j[a]?j[a]:[]).concat([h]):j[a]?j[a]+", "+h:h}}),j},ket=wet,Let=LV,NT=M2,Pet=c4,Det=function(s){var a=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return a&&a[1]||""},xet=function(s){return new Promise(function(a,h){var g,j=s.data,_e=s.headers,_n=s.responseType;function _o(){s.cancelToken&&s.cancelToken.unsubscribe(g),s.signal&&s.signal.removeEventListener("abort",g)}$L.isFormData(j)&&$L.isStandardBrowserEnv()&&delete _e["Content-Type"];var _a=new XMLHttpRequest;if(s.auth){var _r=s.auth.username||"",ba=s.auth.password?unescape(encodeURIComponent(s.auth.password)):"";_e.Authorization="Basic "+btoa(_r+":"+ba)}var xa=Aet(s.baseURL,s.url);function El(){if(_a){var Al="getAllResponseHeaders"in _a?Net(_a.getAllResponseHeaders()):null,Nl={data:_n&&_n!=="text"&&_n!=="json"?_a.response:_a.responseText,status:_a.status,statusText:_a.statusText,headers:Al,config:s,request:_a};Iet(function(Ml){a(Ml),_o()},function(Ml){h(Ml),_o()},Nl),_a=null}}if(_a.open(s.method.toUpperCase(),Cet(xa,s.params,s.paramsSerializer),!0),_a.timeout=s.timeout,"onloadend"in _a?_a.onloadend=El:_a.onreadystatechange=function(){_a&&_a.readyState===4&&(_a.status!==0||_a.responseURL&&_a.responseURL.indexOf("file:")===0)&&setTimeout(El)},_a.onabort=function(){_a&&(h(new NT("Request aborted",NT.ECONNABORTED,s,_a)),_a=null)},_a.onerror=function(){h(new NT("Network Error",NT.ERR_NETWORK,s,_a,_a)),_a=null},_a.ontimeout=function(){var Al=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded",Nl=s.transitional||Let;s.timeoutErrorMessage&&(Al=s.timeoutErrorMessage),h(new NT(Al,Nl.clarifyTimeoutError?NT.ETIMEDOUT:NT.ECONNABORTED,s,_a)),_a=null},$L.isStandardBrowserEnv()){var yl=(s.withCredentials||ket(xa))&&s.xsrfCookieName?Oet.read(s.xsrfCookieName):void 0;yl&&(_e[s.xsrfHeaderName]=yl)}"setRequestHeader"in _a&&$L.forEach(_e,function(Al,Nl){j===void 0&&Nl.toLowerCase()==="content-type"?delete _e[Nl]:_a.setRequestHeader(Nl,Al)}),$L.isUndefined(s.withCredentials)||(_a.withCredentials=!!s.withCredentials),_n&&_n!=="json"&&(_a.responseType=s.responseType),typeof s.onDownloadProgress=="function"&&_a.addEventListener("progress",s.onDownloadProgress),typeof s.onUploadProgress=="function"&&_a.upload&&_a.upload.addEventListener("progress",s.onUploadProgress),(s.cancelToken||s.signal)&&(g=function(Al){_a&&(h(!Al||Al&&Al.type?new Pet:Al),_a.abort(),_a=null)},s.cancelToken&&s.cancelToken.subscribe(g),s.signal&&(s.signal.aborted?g():s.signal.addEventListener("abort",g))),j||(j=null);var Ol=Det(xa);Ol&&["http","https","file"].indexOf(Ol)===-1?h(new NT("Unsupported protocol "+Ol+":",NT.ERR_BAD_REQUEST,s)):_a.send(j)})},F1=H1,UV=function(s,a){_et.forEach(s,function(h,g){g!==a&&g.toUpperCase()===a.toUpperCase()&&(s[a]=h,delete s[g])})},jV=M2,Met=PV,Uet={"Content-Type":"application/x-www-form-urlencoded"};function FV(s,a){!F1.isUndefined(s)&&F1.isUndefined(s["Content-Type"])&&(s["Content-Type"]=a)}var VV,u4={transitional:LV,adapter:((typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(VV=xet),VV),transformRequest:[function(s,a){if(UV(a,"Accept"),UV(a,"Content-Type"),F1.isFormData(s)||F1.isArrayBuffer(s)||F1.isBuffer(s)||F1.isStream(s)||F1.isFile(s)||F1.isBlob(s))return s;if(F1.isArrayBufferView(s))return s.buffer;if(F1.isURLSearchParams(s))return FV(a,"application/x-www-form-urlencoded;charset=utf-8"),s.toString();var h,g=F1.isObject(s),j=a&&a["Content-Type"];if((h=F1.isFileList(s))||g&&j==="multipart/form-data"){var _e=this.env&&this.env.FormData;return Met(h?{"files[]":s}:s,_e&&new _e)}return g||j==="application/json"?(FV(a,"application/json"),function(_n,_o,_a){if(F1.isString(_n))try{return(_o||JSON.parse)(_n),F1.trim(_n)}catch(_r){if(_r.name!=="SyntaxError")throw _r}return(_a||JSON.stringify)(_n)}(s)):s}],transformResponse:[function(s){var a=this.transitional||u4.transitional,h=a&&a.silentJSONParsing,g=a&&a.forcedJSONParsing,j=!h&&this.responseType==="json";if(j||g&&F1.isString(s)&&s.length)try{return JSON.parse(s)}catch(_e){if(j)throw _e.name==="SyntaxError"?jV.from(_e,jV.ERR_BAD_RESPONSE,this,null,this.response):_e}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:null},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};F1.forEach(["delete","get","head"],function(s){u4.headers[s]={}}),F1.forEach(["post","put","patch"],function(s){u4.headers[s]=F1.merge(Uet)});var I6=u4,jet=H1,Fet=I6,BV=function(s){return!(!s||!s.__CANCEL__)},GV=H1,O6=function(s,a,h){var g=this||Fet;return jet.forEach(h,function(j){s=j.call(g,s,a)}),s},Vet=BV,Bet=I6,Get=c4;function C6(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new Get}var Wy=H1,qV=function(s,a){a=a||{};var h={};function g(_r,ba){return Wy.isPlainObject(_r)&&Wy.isPlainObject(ba)?Wy.merge(_r,ba):Wy.isPlainObject(ba)?Wy.merge({},ba):Wy.isArray(ba)?ba.slice():ba}function j(_r){return Wy.isUndefined(a[_r])?Wy.isUndefined(s[_r])?void 0:g(void 0,s[_r]):g(s[_r],a[_r])}function _e(_r){if(!Wy.isUndefined(a[_r]))return g(void 0,a[_r])}function _n(_r){return Wy.isUndefined(a[_r])?Wy.isUndefined(s[_r])?void 0:g(void 0,s[_r]):g(void 0,a[_r])}function _o(_r){return _r in a?g(s[_r],a[_r]):_r in s?g(void 0,s[_r]):void 0}var _a={url:_e,method:_e,data:_e,baseURL:_n,transformRequest:_n,transformResponse:_n,paramsSerializer:_n,timeout:_n,timeoutMessage:_n,withCredentials:_n,adapter:_n,responseType:_n,xsrfCookieName:_n,xsrfHeaderName:_n,onUploadProgress:_n,onDownloadProgress:_n,decompress:_n,maxContentLength:_n,maxBodyLength:_n,beforeRedirect:_n,transport:_n,httpAgent:_n,httpsAgent:_n,cancelToken:_n,socketPath:_n,responseEncoding:_n,validateStatus:_o};return Wy.forEach(Object.keys(s).concat(Object.keys(a)),function(_r){var ba=_a[_r]||j,xa=ba(_r);Wy.isUndefined(xa)&&ba!==_o||(h[_r]=xa)}),h},WV="0.27.2",qet=WV,fR=M2,A6={};["object","boolean","number","function","string","symbol"].forEach(function(s,a){A6[s]=function(h){return typeof h===s||"a"+(a<1?"n ":" ")+s}});var HV={};A6.transitional=function(s,a,h){function g(j,_e){return"[Axios v"+qet+"] Transitional option '"+j+"'"+_e+(h?". "+h:"")}return function(j,_e,_n){if(s===!1)throw new fR(g(_e," has been removed"+(a?" in "+a:"")),fR.ERR_DEPRECATED);return a&&!HV[_e]&&(HV[_e]=!0,console.warn(g(_e," has been deprecated since v"+a+" and will be removed in the near future"))),!s||s(j,_e,_n)}};var KV=H1,Wet=CV,zV=Eet,YV=function(s){return C6(s),s.headers=s.headers||{},s.data=O6.call(s,s.data,s.headers,s.transformRequest),s.headers=GV.merge(s.headers.common||{},s.headers[s.method]||{},s.headers),GV.forEach(["delete","get","head","post","put","patch","common"],function(a){delete s.headers[a]}),(s.adapter||Bet.adapter)(s).then(function(a){return C6(s),a.data=O6.call(s,a.data,a.headers,s.transformResponse),a},function(a){return Vet(a)||(C6(s),a&&a.response&&(a.response.data=O6.call(s,a.response.data,a.response.headers,s.transformResponse))),Promise.reject(a)})},l4=qV,Het=DV,JV={assertOptions:function(s,a,h){if(typeof s!="object")throw new fR("options must be an object",fR.ERR_BAD_OPTION_VALUE);for(var g=Object.keys(s),j=g.length;j-- >0;){var _e=g[j],_n=a[_e];if(_n){var _o=s[_e],_a=_o===void 0||_n(_o,_e,s);if(_a!==!0)throw new fR("option "+_e+" must be "+_a,fR.ERR_BAD_OPTION_VALUE)}else if(h!==!0)throw new fR("Unknown option "+_e,fR.ERR_BAD_OPTION)}},validators:A6},U2=JV.validators;function j2(s){this.defaults=s,this.interceptors={request:new zV,response:new zV}}j2.prototype.request=function(s,a){typeof s=="string"?(a=a||{}).url=s:a=s||{},(a=l4(this.defaults,a)).method?a.method=a.method.toLowerCase():this.defaults.method?a.method=this.defaults.method.toLowerCase():a.method="get";var h=a.transitional;h!==void 0&&JV.assertOptions(h,{silentJSONParsing:U2.transitional(U2.boolean),forcedJSONParsing:U2.transitional(U2.boolean),clarifyTimeoutError:U2.transitional(U2.boolean)},!1);var g=[],j=!0;this.interceptors.request.forEach(function(xa){typeof xa.runWhen=="function"&&xa.runWhen(a)===!1||(j=j&&xa.synchronous,g.unshift(xa.fulfilled,xa.rejected))});var _e,_n=[];if(this.interceptors.response.forEach(function(xa){_n.push(xa.fulfilled,xa.rejected)}),!j){var _o=[YV,void 0];for(Array.prototype.unshift.apply(_o,g),_o=_o.concat(_n),_e=Promise.resolve(a);_o.length;)_e=_e.then(_o.shift(),_o.shift());return _e}for(var _a=a;g.length;){var _r=g.shift(),ba=g.shift();try{_a=_r(_a)}catch(xa){ba(xa);break}}try{_e=YV(_a)}catch(xa){return Promise.reject(xa)}for(;_n.length;)_e=_e.then(_n.shift(),_n.shift());return _e},j2.prototype.getUri=function(s){s=l4(this.defaults,s);var a=Het(s.baseURL,s.url);return Wet(a,s.params,s.paramsSerializer)},KV.forEach(["delete","get","head","options"],function(s){j2.prototype[s]=function(a,h){return this.request(l4(h||{},{method:s,url:a,data:(h||{}).data}))}}),KV.forEach(["post","put","patch"],function(s){function a(h){return function(g,j,_e){return this.request(l4(_e||{},{method:s,headers:h?{"Content-Type":"multipart/form-data"}:{},url:g,data:j}))}}j2.prototype[s]=a(),j2.prototype[s+"Form"]=a(!0)});var Ket=j2,zet=c4;function F2(s){if(typeof s!="function")throw new TypeError("executor must be a function.");var a;this.promise=new Promise(function(g){a=g});var h=this;this.promise.then(function(g){if(h._listeners){var j,_e=h._listeners.length;for(j=0;j<_e;j++)h._listeners[j](g);h._listeners=null}}),this.promise.then=function(g){var j,_e=new Promise(function(_n){h.subscribe(_n),j=_n}).then(g);return _e.cancel=function(){h.unsubscribe(j)},_e},s(function(g){h.reason||(h.reason=new zet(g),a(h.reason))})}F2.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},F2.prototype.subscribe=function(s){this.reason?s(this.reason):this._listeners?this._listeners.push(s):this._listeners=[s]},F2.prototype.unsubscribe=function(s){if(this._listeners){var a=this._listeners.indexOf(s);a!==-1&&this._listeners.splice(a,1)}},F2.source=function(){var s;return{token:new F2(function(a){s=a}),cancel:s}};var Yet=F2,Jet=H1,XV=H1,Xet=RV,d4=Ket,Qet=qV,Oy=function s(a){var h=new d4(a),g=Xet(d4.prototype.request,h);return XV.extend(g,d4.prototype,h),XV.extend(g,h),g.create=function(j){return s(Qet(a,j))},g}(I6);Oy.Axios=d4,Oy.CanceledError=c4,Oy.CancelToken=Yet,Oy.isCancel=BV,Oy.VERSION=WV,Oy.toFormData=PV,Oy.AxiosError=M2,Oy.Cancel=Oy.CanceledError,Oy.all=function(s){return Promise.all(s)},Oy.spread=function(s){return function(a){return s.apply(null,a)}},Oy.isAxiosError=function(s){return Jet.isObject(s)&&s.isAxiosError===!0},m6.exports=Oy,m6.exports.default=Oy;var hS=m6.exports;class $et{constructor(a){Rl(this,"logger",void 0),Rl(this,"prefixLists",[]),this.logger=a}debug(){for(var a=arguments.length,h=new Array(a),g=0;g<a;g++)h[g]=arguments[g];this.logger.debug(...this.prefixLists,...h)}info(){for(var a=arguments.length,h=new Array(a),g=0;g<a;g++)h[g]=arguments[g];this.logger.info(...this.prefixLists,...h)}warning(){for(var a=arguments.length,h=new Array(a),g=0;g<a;g++)h[g]=arguments[g];this.logger.warning(...this.prefixLists,...h)}error(){for(var a=arguments.length,h=new Array(a),g=0;g<a;g++)h[g]=arguments[g];this.logger.error(...this.prefixLists,...h)}prefix(a){return this.prefixLists.push(a),this}popPrefix(){return this.prefixLists.pop(),this}}class C_{constructor(){Rl(this,"_events",{}),Rl(this,"addListener",this.on)}getListeners(a){return this._events[a]?this._events[a].map(h=>h.listener):[]}on(a,h){this._events[a]||(this._events[a]=[]);const g=this._events[a];this._indexOfListener(g,h)===-1&&g.push({listener:h,once:!1})}once(a,h){this._events[a]||(this._events[a]=[]);const g=this._events[a];this._indexOfListener(g,h)===-1&&g.push({listener:h,once:!0})}off(a,h){if(!this._events[a])return;const g=this._events[a],j=this._indexOfListener(g,h);j!==-1&&g.splice(j,1),this._events[a].length===0&&delete this._events[a]}removeAllListeners(a){a?delete this._events[a]:this._events={}}emit(a){this._events[a]||(this._events[a]=[]);const h=this._events[a].map(_n=>_n);for(var g=arguments.length,j=new Array(g>1?g-1:0),_e=1;_e<g;_e++)j[_e-1]=arguments[_e];for(let _n=0;_n<h.length;_n+=1){const _o=h[_n];_o.once&&this.off(a,_o.listener),_o.listener.apply(this,j||[])}}_indexOfListener(a,h){let g=a.length;for(;g--;)if(a[g].listener===h)return g;return-1}}const h4=new class extends C_{reportLogUploadError(s){this.emit("REPORT_LOG_UPLOAD",s)}};let Hl;(function(s){s.UNEXPECTED_ERROR="UNEXPECTED_ERROR",s.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",s.TIMEOUT="TIMEOUT",s.INVALID_PARAMS="INVALID_PARAMS",s.NOT_READABLE="NOT_READABLE",s.NOT_SUPPORTED="NOT_SUPPORTED",s.INVALID_OPERATION="INVALID_OPERATION",s.OPERATION_ABORTED="OPERATION_ABORTED",s.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",s.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",s.NETWORK_ERROR="NETWORK_ERROR",s.NETWORK_TIMEOUT="NETWORK_TIMEOUT",s.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",s.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",s.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",s.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",s.ELECTRON_IS_NULL="ELECTRON_IS_NULL",s.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",s.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",s.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",s.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",s.PERMISSION_DENIED="PERMISSION_DENIED",s.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",s.TRACK_IS_DISABLED="TRACK_IS_DISABLED",s.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",s.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",s.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",s.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",s.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",s.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",s.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",s.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",s.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",s.UID_CONFLICT="UID_CONFLICT",s.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",s.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",s.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",s.INVALID_TRACK="INVALID_TRACK",s.SENDER_NOT_FOUND="SENDER_NOT_FOUND",s.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",s.SET_ANSWER_FAILED="SET_ANSWER_FAILED",s.ICE_FAILED="ICE_FAILED",s.PC_CLOSED="PC_CLOSED",s.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",s.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",s.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",s.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",s.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",s.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",s.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",s.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",s.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",s.INVALID_REMOTE_USER="INVALID_REMOTE_USER",s.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",s.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",s.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",s.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",s.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",s.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",s.WS_ABORT="WS_ABORT",s.WS_DISCONNECT="WS_DISCONNECT",s.WS_ERR="WS_ERR",s.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",s.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",s.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",s.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",s.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",s.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",s.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",s.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",s.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",s.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",s.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",s.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",s.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",s.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",s.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",s.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",s.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",s.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",s.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",s.INVALID_PLUGIN="INVALID_PLUGIN",s.DISCONNECT_P2P="DISCONNECT_P2P",s.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT",s.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",s.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",s.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",s.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT"})(Hl||(Hl={}));class Ql extends Error{constructor(a){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",g=arguments.length>2?arguments[2]:void 0;super(h),Rl(this,"code",void 0),Rl(this,"message",void 0),Rl(this,"data",void 0),Rl(this,"name","AgoraRTCException"),this.code=a,this.message="AgoraRTCError ".concat(this.code,": ").concat(h),this.data=g}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),`
`).concat(this.stack):"".concat(this.stack)}print(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return a==="error"&&Ll.error(this.toString()),a==="warning"&&Ll.warning(this.toString()),this}throw(){throw this.print(),this}}const t1={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function N6(s,a){const h=Math.floor(a.timeout*Math.pow(a.timeoutFactor,s));return Math.min(a.maxRetryTimeout,h)}function QS(s,a,h,g){const j=Object.assign({},t1,g);let _e=j.timeout;const _n=async()=>{await function(_r){return new s0(ba=>{window.setTimeout(ba,_r)})}(_e),_e*=j.timeoutFactor,_e=Math.min(j.maxRetryTimeout,_e)};let _o=!1;const _a=new s0(async(_r,ba)=>{a=a||(()=>!1),h=h||(()=>!0);for(let xa=0;xa<j.maxRetryCount;xa+=1){if(_o)return ba(new Ql(Hl.OPERATION_ABORTED));try{const El=await s();if(!a(El,xa)||xa+1===j.maxRetryCount)return _r(El);await _n()}catch(El){if(!h(El,xa)||xa+1===j.maxRetryCount)return ba(El);await _n()}}});return _a.cancel=()=>_o=!0,_a}function k6(){const s=new Date;return s.toTimeString().split(" ")[0]+":"+s.getMilliseconds()}function QV(){const s=new Date,a=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return a?(a==null?void 0:a[0])+":"+s.getUTCMilliseconds():s.toTimeString().split(" ")[0]+":"+s.getMilliseconds()}const Hy={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},p4=Date.now(),ZL=s=>{for(const a in Hy)if(Object.prototype.hasOwnProperty.call(Hy,a)&&Hy[a]===s)return a;return"DEFAULT"},Ll=new class{constructor(){Rl(this,"proxyServerURL",void 0),Rl(this,"logLevel",Hy.DEBUG),Rl(this,"uploadState","collecting"),Rl(this,"uploadLogWaitingList",[]),Rl(this,"uploadLogUploadingList",[]),Rl(this,"uploadErrorCount",0),Rl(this,"currentLogID",0),Rl(this,"url",void 0),Rl(this,"extLog",(s,a)=>{this.appendLogToWaitingList(s,...a)})}debug(){for(var s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];const g=[Hy.DEBUG].concat(a);this.log.apply(this,g)}info(){for(var s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];const g=[Hy.INFO].concat(a);this.log.apply(this,g)}warning(){for(var s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];const g=[Hy.WARNING].concat(a);this.log.apply(this,g)}error(){for(var s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];const g=[Hy.ERROR].concat(a);this.log.apply(this,g)}upload(){for(var s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];const g=[Hy.DEBUG].concat(a);this.uploadLog.apply(this,g)}setLogLevel(s){s=Math.min(Math.max(0,s),4),this.logLevel=s}enableLogUpload(){m_("UPLOAD_LOG",!0)}disableLogUpload(){m_("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(s){this.proxyServerURL=s}prefix(s){return new $et(this).prefix(s)}log(){for(var s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];if(Date.now()-p4<100)return void setTimeout(()=>{this.log(...a)},Date.now()-p4);const g=Math.max(0,Math.min(4,a[0]));if(a[0]=k6()+" Agora-SDK [".concat(ZL(g),"]:"),this.appendLogToWaitingList(g,...a),g<this.logLevel)return;const j=k6()+" %cAgora-SDK [".concat(ZL(g),"]:");let _e=[];if(!wp("USE_NEW_LOG"))switch(g){case Hy.DEBUG:_e=[j,"color: #64B5F6;"].concat(a.slice(1)),console.log.apply(console,_e);break;case Hy.INFO:_e=[j,"color: #1E88E5; font-weight: bold;"].concat(a.slice(1)),console.log.apply(console,_e);break;case Hy.WARNING:_e=[j,"color: #FB8C00; font-weight: bold;"].concat(a.slice(1)),console.warn.apply(console,_e);break;case Hy.ERROR:_e=[j,"color: #B00020; font-weight: bold;"].concat(a.slice(1)),console.error.apply(console,_e)}}uploadLog(){for(var s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];if(Date.now()-p4<100)return void setTimeout(()=>{this.uploadLog(...a)},Date.now()-p4);const g=Math.max(0,Math.min(4,a[0]));a[0]=k6()+" Agora-SDK [".concat(ZL(g),"]:"),this.appendLogToWaitingList(g,...a)}appendLogToWaitingList(s){if(!wp("UPLOAD_LOG"))return;for(var a=arguments.length,h=new Array(a>1?a-1:0),g=1;g<a;g++)h[g-1]=arguments[g];Array.isArray(h[0])?h[0][0]=QV()+" Agora-SDK [".concat(ZL(s),"]:"):h[0]=QV()+" Agora-SDK [".concat(ZL(s),"]:");let j="";h.forEach(_e=>{typeof _e=="object"&&(_e=JSON.stringify(_e)),j+="".concat(_e," ")}),this.uploadLogWaitingList.push({payload_str:j,log_level:s,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const s=this.uploadLogUploadingList,a={sdk_version:Ky,process_id:wp("PROCESS_ID"),payload:JSON.stringify(s)};return QS(async()=>{const h=await hS.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(wp("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(wp("LOG_UPLOAD_SERVER"),"/upload/v1")),a,{responseType:"text"});if(h.data!=="OK"){const g=new Error("unexpected upload log response");throw g.response=h,g}},()=>(this.uploadLogUploadingList=[],!1),h=>(h.response?h4.reportLogUploadError({status:h.response.status,data:h.response.data,headers:h.response.headers,message:h.message}):h.request?h4.reportLogUploadError({status:h.request.status,message:h.message}):h4.reportLogUploadError({status:-1,message:h.message}),!0),{timeout:wp("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:wp("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,wp("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),wp("UPLOAD_LOG_INTERVAL"))}).catch(s=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),wp("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),wp("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}},L6="v4.16.1-0-gb268655f-dirty(2/8/2023, 2:53:13 PM)",Ky=function(s){if(s.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return s;const a=s.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(a&&a[1]&&a[2]){const g=a[1],j=a[2];return"".concat(g,".").concat(j)}const h=s.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(h&&h[1]&&h[2]){const g=h[1],j=h[2];return"".concat(g,".").concat(100*(Number(j)+1))}return"4.0.0.999"}("4.16.1"),P6=function(){try{return JSON.parse("true")===!0}catch{return!0}}(),Cy=function(){const s="us".concat("erna","me"),a="pa".concat("sswo","rd"),h=["t","s","t"];h.splice(1,0,"e");const g=h.join(""),j=[];for(let _o=0;_o<6;_o++)j.push("1");const _e=j.join(""),_n={};return _n[s]=g,_n[a]=_e,Object.assign(_n,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=Cy;const Zet={"90p":B0(160,90),"90p_1":B0(160,90),"120p":B0(160,120,15,30,65),"120p_1":B0(160,120,15,30,65),"120p_3":B0(120,120,15,30,50),"120p_4":B0(212,120),"180p":B0(320,180,15,30,140),"180p_1":B0(320,180,15,30,140),"180p_3":B0(180,180,15,30,100),"180p_4":B0(240,180,15,30,120),"240p":B0(320,240,15,40,200),"240p_1":B0(320,240,15,40,200),"240p_3":B0(240,240,15,40,140),"240p_4":B0(424,240,15,40,220),"360p":B0(640,360,15,80,400),"360p_1":B0(640,360,15,80,400),"360p_3":B0(360,360,15,80,260),"360p_4":B0(640,360,30,80,600),"360p_6":B0(360,360,30,80,400),"360p_7":B0(480,360,15,80,320),"360p_8":B0(480,360,30,80,490),"360p_9":B0(640,360,15,80,800),"360p_10":B0(640,360,24,80,800),"360p_11":B0(640,360,24,80,1e3),"480p":B0(640,480,15,100,500),"480p_1":B0(640,480,15,100,500),"480p_2":B0(640,480,30,100,1e3),"480p_3":B0(480,480,15,100,400),"480p_4":B0(640,480,30,100,750),"480p_6":B0(480,480,30,100,600),"480p_8":B0(848,480,15,100,610),"480p_9":B0(848,480,30,100,930),"480p_10":B0(640,480,10,100,400),"720p":B0(1280,720,15,120,1130),"720p_1":B0(1280,720,15,120,1130),"720p_2":B0(1280,720,30,120,2e3),"720p_3":B0(1280,720,30,120,1710),"720p_5":B0(960,720,15,120,910),"720p_6":B0(960,720,30,120,1380),"1080p":B0(1920,1080,15,120,2080),"1080p_1":B0(1920,1080,15,120,2080),"1080p_2":B0(1920,1080,30,120,3e3),"1080p_3":B0(1920,1080,30,120,3150),"1080p_5":B0(1920,1080,60,120,4780),"1440p":B0(2560,1440,30,120,4850),"1440p_1":B0(2560,1440,30,120,4850),"1440p_2":B0(2560,1440,60,120,7350),"4k":B0(3840,2160,30,120,8910),"4k_1":B0(3840,2160,30,120,8910),"4k_3":B0(3840,2160,60,120,13500)},tnt={"480p":pS(640,480,5),"480p_1":pS(640,480,5),"480p_2":pS(640,480,30),"480p_3":pS(640,480,15),"720p":pS(1280,720,5),"720p_1":pS(1280,720,5),"720p_2":pS(1280,720,30),"720p_3":pS(1280,720,15),"1080p":pS(1920,1080,5),"1080p_1":pS(1920,1080,5),"1080p_2":pS(1920,1080,30),"1080p_3":pS(1920,1080,15)},ent={"1SL1TL":M6(1,1),"3SL3TL":M6(3,3),"2SL3TL":M6(2,3)};function V2(s){return typeof s=="string"?Object.assign({},Zet[s]):s}function D6(s){return typeof s=="string"?Object.assign({},tnt[s]):s}function f4(s){return typeof s=="string"?Object.assign({},ent[s]):s}const nnt={speech_low_quality:B2(16e3,!1),speech_standard:B2(32e3,!1,18),music_standard:B2(48e3,!1),standard_stereo:B2(48e3,!0,56),high_quality:B2(48e3,!1,128),high_quality_stereo:B2(48e3,!0,192)};function g4(s){return typeof s=="string"?Object.assign({},nnt[s]):s}function m_(s,a,h){Object.keys(oy).includes(s)&&(!h&&Object.keys(x6).includes(s)||(oy[s]=a))}function wp(s){return oy[s]}const oy={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TCC:!0,PUBLISH_TCC:!1,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION:2e3,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!0,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ENABLE_USER_LICENSE_CHECK:!0,SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0}},x6={};function B2(s,a,h){return{sampleRate:s,stereo:a,bitrate:h}}function B0(s,a,h,g,j){return{width:s,height:a,frameRate:h,bitrateMin:g,bitrateMax:j}}function pS(s,a,h,g,j){return{width:{max:s},height:{max:a},frameRate:h,bitrateMin:g,bitrateMax:j}}function M6(s,a){return{numSpatialLayers:s,numTemporalLayers:a}}P6||(oy.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],oy.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],oy.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],oy.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],oy.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],oy.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],oy.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",oy.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",oy.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",oy.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",oy.AREAS=["NORTH_AMERICA","OVERSEA"]);const rnt=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],G2=[],_P=[];var int=GS,ont=Ty,snt=Qp,m4=function(s,a,h){var g=int(a);g in s?ont.f(s,g,snt(0,h)):s[g]=h},$V=JO,ant=cS,cnt=m4,unt=Dl.Array,lnt=Math.max,U6=function(s,a,h){for(var g=ant(s),j=$V(a,g),_e=$V(h===void 0?g:h,g),_n=unt(lnt(_e-j,0)),_o=0;j<_e;j++,_o++)cnt(_n,_o,s[j]);return _n.length=_o,_n},ZV=U6,dnt=Math.floor,j6=function(s,a){var h=s.length,g=dnt(h/2);return h<8?hnt(s,a):pnt(s,j6(ZV(s,0,g),a),j6(ZV(s,g),a),a)},hnt=function(s,a){for(var h,g,j=s.length,_e=1;_e<j;){for(g=_e,h=s[_e];g&&a(s[g-1],h)>0;)s[g]=s[--g];g!==_e++&&(s[g]=h)}return s},pnt=function(s,a,h,g){for(var j=a.length,_e=h.length,_n=0,_o=0;_n<j||_o<_e;)s[_n+_o]=_n<j&&_o<_e?g(a[_n],h[_o])<=0?a[_n++]:h[_o++]:_n<j?a[_n++]:h[_o++];return s},_B=j6,_G=sT.match(/firefox\/(\d+)/i),fnt=!!_G&&+_G[1],gnt=/MSIE|Trident/.test(sT),tq=sT.match(/AppleWebKit\/(\d+)\./),mnt=!!tq&&+tq[1],vnt=a1,eq=Tl,Ent=My,_nt=Uy,ynt=cS,nq=dS,F6=_,bnt=_B,Snt=DO,rq=fnt,Tnt=gnt,iq=BT,oq=mnt,gR=[],sq=eq(gR.sort),Rnt=eq(gR.push),wnt=F6(function(){gR.sort(void 0)}),Int=F6(function(){gR.sort(null)}),Ont=Snt("sort"),aq=!F6(function(){if(iq)return iq<70;if(!(rq&&rq>3)){if(Tnt)return!0;if(oq)return oq<603;var s,a,h,g,j="";for(s=65;s<76;s++){switch(a=String.fromCharCode(s),s){case 66:case 69:case 70:case 72:h=3;break;case 68:case 71:h=4;break;default:h=2}for(g=0;g<47;g++)gR.push({k:a+g,v:h})}for(gR.sort(function(_e,_n){return _n.v-_e.v}),g=0;g<gR.length;g++)a=gR[g].k.charAt(0),j.charAt(j.length-1)!==a&&(j+=a);return j!=="DGBEFHACIJK"}});vnt({target:"Array",proto:!0,forced:wnt||!Int||!Ont||!aq},{sort:function(s){s!==void 0&&Ent(s);var a=_nt(this);if(aq)return s===void 0?sq(a):sq(a,s);var h,g,j=[],_e=ynt(a);for(g=0;g<_e;g++)g in a&&Rnt(j,a[g]);for(bnt(j,function(_n){return function(_o,_a){return _a===void 0?-1:_o===void 0?1:_n!==void 0?+_n(_o,_a)||0:nq(_o)>nq(_a)?1:-1}}(s)),h=j.length,g=0;g<h;)a[g]=j[g++];for(;g<_e;)delete a[g++];return a}});var Cnt=By("Array").sort,Ant=Cl,Nnt=Cnt,V6=Array.prototype,B6=function(s){var a=s.sort;return s===V6||Ant(V6,s)&&a===V6.sort?Nnt:a};function SP(s,a){if(typeof s!="boolean")throw new Ql(Hl.INVALID_PARAMS,"Invalid ".concat(a,": The value is of the boolean type."))}function y1(s,a,h){if(!h.includes(s))throw new Ql(Hl.INVALID_PARAMS,"".concat(a," can only be set as ").concat(JSON.stringify(h)))}function f_(s,a){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4,j=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(s<h||s>g||j&&!knt(s))throw new Ql(Hl.INVALID_PARAMS,"invalid ".concat(a,": the value range is [").concat(h,", ").concat(g,"]. integer only"))}function G6(s,a){if(typeof s!="number"){if(!(s.min||s.max||s.ideal||s.exact))throw new Ql(Hl.INVALID_PARAMS,"".concat(a," is not a valid ConstrainLong"));s.min!==void 0&&f_(s.min,"".concat(a,".min"),0,1/0),s.max!==void 0&&f_(s.max,"".concat(a,".max"),1,1/0),s.exact!==void 0&&f_(s.exact,"".concat(a,".exact"),1,1/0),s.ideal!==void 0&&f_(s.ideal,"".concat(a,".ideal"),1,1/0)}else f_(s,a,1,1/0)}function b1(s,a){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,j=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(s==null)throw new Ql(Hl.INVALID_PARAMS,"".concat(a||"param"," cannot be empty"));if(!cq(s,h,g,j))throw new Ql(Hl.INVALID_PARAMS,"Invalid ".concat(a||"string param",": Length of the string: [").concat(h,",").concat(g,"].").concat(j?" ASCII characters only.":""))}function kT(s,a){if(!Array.isArray(s))throw new Ql(Hl.INVALID_PARAMS,"".concat(a," should be an array"))}function q6(s){if(typeof s!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(s))throw Ll.error("Invalid Channel Name ".concat(s)),new Ql(Hl.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function W6(s){if(a=s,!(typeof a=="number"&&Math.floor(a)===a&&0<=a&&a<=4294967295||cq(s,1,255)))throw Ll.error("Invalid UID ".concat(s," ").concat(typeof s)),new Ql(Hl.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var a;typeof s=="string"&&Ll.warning("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}function S_(s){return s==null}function cq(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,g=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof s=="string"&&s.length<=h&&s.length>=a&&(!g||Lnt(s))}function knt(s){return typeof s=="number"&&s%1==0}function Lnt(s){if(typeof s!="string")return!1;for(let a=0;a<s.length;a+=1){const h=s.charCodeAt(a);if(h<0||h>255)return!1}return!0}let uq,lq,S1;(function(s){s.FREE="free",s.UPLOADING="uploading"})(uq||(uq={})),function(s){s[s.MISC=0]="MISC",s[s.INTERNAL_EVENT=1]="INTERNAL_EVENT",s[s.PUBLIC_EVENT=2]="PUBLIC_EVENT",s[s.WEB_EVENT=3]="WEB_EVENT",s[s.INTERNAL_API=4]="INTERNAL_API",s[s.WEB_API=5]="WEB_API",s[s.PUBLIC_API=6]="PUBLIC_API"}(lq||(lq={})),function(s){s.NONE="none",s.INIT="init",s.CANPLAY="canplay",s.PLAYING="playing",s.PAUSED="paused",s.SUSPEND="suspend",s.STALLED="stalled",s.WAITING="waiting",s.ERROR="error",s.DESTROYED="destroyed",s.ABORT="abort",s.ENDED="ended",s.EMPTIED="emptied",s.LOADEDDATA="loadeddata"}(S1||(S1={}));const H6={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};function Pnt(s){return b1(s.reportId,"params.reportId",0,100,!1),b1(s.category,"params.category",0,100,!1),b1(s.event,"params.event",0,100,!1),b1(s.label,"params.label",0,100,!1),f_(s.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}const Dnt={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let T1,k_,dq,K6,Y_,A_,eO,LT,q2,TP,Ay,R1,v0,z6,i_,F0,K1,a_,l0,T0,sy,M0,hq,ay;function pq(s){return f_(s.timeout,"config.timeout",0,1e5),f_(s.timeoutFactor,"config.timeoutFactor",0,100,!1),f_(s.maxRetryCount,"config.maxRetryConfig",0,1/0),f_(s.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function xnt(s){return y1(s.codec,"config.codec",["vp8","vp9","av1","h264"]),y1(s.mode,"config.mode",["rtc","live"]),s.audioCodec!==void 0&&y1(s.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),s.proxyServer!==void 0&&b1(s.proxyServer,"config.proxyServer",1,1e4),s.turnServer!==void 0&&fq(s.turnServer),s.httpRetryConfig!==void 0&&pq(s.httpRetryConfig),s.websocketRetryConfig!==void 0&&pq(s.websocketRetryConfig),!0}function RP(s){if(!Array.isArray(s)||s.length<1)return!1;try{s.forEach(a=>{if(!a.urls)throw Error()})}catch{return!1}return!0}function fq(s){return b1(s.turnServerURL,"turnServerURL"),b1(s.username,"username"),b1(s.password,"password"),s.udpport&&f_(s.udpport,"udpport",1,99999,!0),s.forceturn&&SP(s.forceturn,"forceturn"),s.security&&SP(s.security,"security"),s.tcpport&&f_(s.tcpport,"tcpport",1,99999,!0),!0}function gq(s){return s.level!==void 0&&y1(s.level,"level",[1,2,3]),!0}(function(s){s.PUBLISH="publish",s.SUBSCRIBE="subscribe",s.WS_COMPRESSOR_INIT="ws_compressor_init",s.SESSION_INIT="session_init",s.JOIN_CHOOSE_SERVER="join_choose_server",s.REQ_USER_ACCOUNT="req_user_account",s.JOIN_GATEWAY="join_gateway",s.REJOIN_GATEWAY="rejoin_gateway",s.STREAM_SWITCH="stream_switch",s.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",s.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",s.FIRST_VIDEO_RECEIVED="first_video_received",s.FIRST_AUDIO_RECEIVED="first_audio_received",s.FIRST_VIDEO_DECODE="first_video_decode",s.FIRST_AUDIO_DECODE="first_audio_decode",s.ON_ADD_AUDIO_STREAM="on_add_audio_stream",s.ON_ADD_VIDEO_STREAM="on_add_video_stream",s.ON_UPDATE_STREAM="on_update_stream",s.ON_REMOVE_STREAM="on_remove_stream",s.USER_ANALYTICS="req_user_analytics"})(T1||(T1={})),function(s){s.SESSION="io.agora.pb.Wrtc.Session",s.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",s.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",s.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",s.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",s.PUBLISH="io.agora.pb.Wrtc.Publish",s.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",s.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",s.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",s.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",s.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",s.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",s.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",s.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",s.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",s.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",s.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",s.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",s.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",s.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",s.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",s.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",s.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",s.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",s.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",s.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",s.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",s.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",s.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",s.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed"}(k_||(k_={})),function(s){s[s.WORKER_EVENT=156]="WORKER_EVENT",s[s.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(dq||(dq={})),function(s){s[s.SESSION=26]="SESSION",s[s.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",s[s.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",s[s.JOIN_GATEWAY=28]="JOIN_GATEWAY",s[s.PUBLISH=30]="PUBLISH",s[s.SUBSCRIBE=29]="SUBSCRIBE",s[s.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",s[s.STREAM_SWITCH=32]="STREAM_SWITCH",s[s.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",s[s.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",s[s.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",s[s.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",s[s.API_INVOKE=41]="API_INVOKE",s[s.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",s[s.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",s[s.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",s[s.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",s[s.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",s[s.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",s[s.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",s[s.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",s[s.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",s[s.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",s[s.WORKER_EVENT=156]="WORKER_EVENT",s[s.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",s[s.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",s[s.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",s[s.USER_ANALYTICS=1e4]="USER_ANALYTICS",s[s.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(K6||(K6={})),function(s){s.CREATE_CLIENT="createClient",s.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",s.SET_AREA="setArea",s.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",s.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",s.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",s.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",s.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",s.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",s.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",s.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",s.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",s.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",s.START_PROXY_SERVER="Client.startProxyServer",s.STOP_PROXY_SERVER="Client.stopProxyServer",s.SET_PROXY_SERVER="Client.setProxyServer",s.SET_TURN_SERVER="Client.setTurnServer",s.SET_CLIENT_ROLE="Client.setClientRole",s.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",s.ENABLE_DUAL_STREAM="Client.enableDualStream",s.DISABLE_DUAL_STREAM="Client.disableDualStream",s.JOIN="Client.join",s.LEAVE="Client.leave",s.PUBLISH="Client.publish",s.UNPUBLISH="Client.unpublish",s.SUBSCRIBE="Client.subscribe",s.MASS_SUBSCRIBE="Client.massSubscribe",s.MASS_UNSUBSCRIBE="Client.massUnsubscribe",s.UNSUBSCRIBE="Client.unsubscribe",s.RENEW_TOKEN="Client.renewToken",s.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",s.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",s.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",s.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",s.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",s.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",s.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",s.DATACHANNEL_FAILBACK="Client._datachannelFailback",s.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",s.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",s.START_LIVE_STREAMING="Client.startLiveStreaming",s.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",s.STOP_LIVE_STREAMING="Client.stopLiveStreaming",s.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",s.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",s.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",s.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",s.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",s.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",s.SET_CONFIG_DISTRIBUTE="_configDistribute",s.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",s.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",s.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",s.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",s.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",s.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",s.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",s.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",s.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",s.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",s.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",s.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",s.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",s.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",s.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",s.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",s.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",s.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",s.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",s.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",s.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",s.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",s.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",s.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",s.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",s.STREAM_TYPE_CHANGE="streamTypeChange",s.CONNECTION_STATE_CHANGE="connectionStateChange",s.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage"}(Y_||(Y_={})),function(s){s.TRACER="tracer"}(A_||(A_={})),function(s){s.IDLE="IDLE",s.INITING="INITING",s.INITEND="INITEND"}(eO||(eO={})),function(s){s.STATE_CHANGE="state_change",s.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",s.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",s.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(LT||(LT={})),function(s){s[s.ACCESS_POINT=101]="ACCESS_POINT",s[s.UNILBS=201]="UNILBS",s[s.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(q2||(q2={})),function(s){s[s.IIIEGAL_APPID=1]="IIIEGAL_APPID",s[s.IIIEGAL_UID=2]="IIIEGAL_UID",s[s.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(TP||(TP={})),function(s){s[s.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",s[s.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",s[s.INTERNAL_ERROR=8]="INTERNAL_ERROR",s[s.NO_AUTHORIZED=9]="NO_AUTHORIZED",s[s.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",s[s.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",s[s.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",s[s.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",s[s.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",s[s.USER_OVERLOAD=16]="USER_OVERLOAD",s[s.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",s[s.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(Ay||(Ay={})),function(s){s[s.NO_FLAG_SET=100]="NO_FLAG_SET",s[s.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",s[s.INVALID_FALG_SET=102]="INVALID_FALG_SET",s[s.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",s[s.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",s[s.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",s[s.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",s[s.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",s[s.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",s[s.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",s[s.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",s[s.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",s[s.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",s[s.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",s[s.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",s[s.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",s[s.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",s[s.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",s[s.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(R1||(R1={})),function(s){s[s.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",s[s.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",s[s.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",s[s.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",s[s.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",s[s.K_TICKET_INVALID=7]="K_TICKET_INVALID",s[s.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",s[s.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",s[s.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",s[s.K_UID_BANNED=14]="K_UID_BANNED",s[s.K_IP_BANNED=15]="K_IP_BANNED",s[s.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",s[s.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",s[s.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",s[s.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",s[s.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",s[s.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",s[s.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",s[s.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",s[s.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",s[s.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",s[s.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",s[s.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",s[s.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",s[s.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",s[s.ERR_INVALID_UID=117]="ERR_INVALID_UID",s[s.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",s[s.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",s[s.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",s[s.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",s[s.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",s[s.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",s[s.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",s[s.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",s[s.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",s[s.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",s[s.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",s[s.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",s[s.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",s[s.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",s[s.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",s[s.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",s[s.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",s[s.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",s[s.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",s[s.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",s[s.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",s[s.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",s[s.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",s[s.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",s[s.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",s[s.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",s[s.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",s[s.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",s[s.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",s[s.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",s[s.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",s[s.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",s[s.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",s[s.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",s[s.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",s[s.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",s[s.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(v0||(v0={})),function(s){s[s.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",s[s.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",s[s.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(z6||(z6={})),function(s){s.LEAVE="LEAVE",s.NETWORK_ERROR="NETWORK_ERROR",s.SERVER_ERROR="SERVER_ERROR",s.UID_BANNED="UID_BANNED",s.IP_BANNED="IP_BANNED",s.CHANNEL_BANNED="CHANNEL_BANNED",s.FALLBACK="FALLBACK",s.LICENSE_MISSING="LICENSE_MISSING",s.LICENSE_EXPIRED="LICENSE_EXPIRED",s.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",s.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",s.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",s.LICENSE_ILLEGAL="LICENSE_ILLEGAL"}(i_||(i_={})),function(s){s.CONNECTION_STATE_CHANGE="connection-state-change",s.MEDIA_RECONNECT_START="media-reconnect-start",s.MEDIA_RECONNECT_END="media-reconnect-end",s.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",s.USER_JOINED="user-joined",s.USER_LEAVED="user-left",s.USER_PUBLISHED="user-published",s.USER_UNPUBLISHED="user-unpublished",s.USER_INFO_UPDATED="user-info-updated",s.CLIENT_BANNED="client-banned",s.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",s.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",s.VOLUME_INDICATOR="volume-indicator",s.CRYPT_ERROR="crypt-error",s.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",s.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",s.NETWORK_QUALITY="network-quality",s.STREAM_TYPE_CHANGED="stream-type-changed",s.STREAM_FALLBACK="stream-fallback",s.RECEIVE_METADATA="receive-metadata",s.STREAM_MESSAGE="stream-message",s.LIVE_STREAMING_ERROR="live-streaming-error",s.LIVE_STREAMING_WARNING="live-streaming-warning",s.INJECT_STREAM_STATUS="stream-inject-status",s.EXCEPTION="exception",s.ERROR="error",s.P2P_LOST="p2p_lost",s.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",s.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",s.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",s.PUBLISHED_USER_LIST="published-user-list",s.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",s.CONTENT_INSPECT_ERROR="content-inspect-error",s.CONTENT_INSPECT_RESULT="content-inspect-result"}(F0||(F0={})),function(s){s.NETWORK_ERROR="NETWORK_ERROR",s.SERVER_ERROR="SERVER_ERROR",s.MULTI_IP="MULTI_IP",s.TIMEOUT="TIMEOUT",s.OFFLINE="OFFLINE",s.LEAVE="LEAVE",s.P2P_FAILED="P2P_FAILED",s.FALLBACK="FALLBACK"}(K1||(K1={})),function(s){s.CONNECTING="connecting",s.CONNECTED="connected",s.RECONNECTING="reconnecting",s.CLOSED="closed"}(a_||(a_={})),function(s){s.WS_CONNECTED="ws_connected",s.WS_RECONNECTING="ws_reconnecting",s.WS_CLOSED="ws_closed",s.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",s.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",s.ON_BINARY_DATA="on_binary_data",s.REQUEST_RECOVER="request_recover",s.REQUEST_JOIN_INFO="request_join_info",s.REQUEST_REJOIN_INFO="req_rejoin_info",s.IS_P2P_DISCONNECTED="is_p2p_dis",s.DISCONNECT_P2P="dis_p2p",s.ABORT_P2P_EXECUTION="abort_p2p_execution",s.NEED_RENEW_SESSION="need-sid",s.REPORT_JOIN_GATEWAY="report_join_gateway",s.REQUEST_TIMEOUT="request_timeout",s.REQUEST_SUCCESS="request_success",s.JOIN_RESPONSE="join_response",s.DATACHANNEL_PRECONNECT="datachannel_preconnect",s.DATACHANNEL_CONNECTING="datachannel_connecting",s.DATACHANNEL_FAILBACK="datachannel_failback"}(l0||(l0={})),function(s){s.PING="ping",s.PING_BACK="ping_back",s.JOIN="join_v3",s.REJOIN="rejoin_v3",s.LEAVE="leave",s.SET_CLIENT_ROLE="set_client_role",s.PUBLISH="publish",s.UNPUBLISH="unpublish",s.SUBSCRIBE="subscribe",s.SUBSCRIBE_STREAMS="subscribe_streams",s.UNSUBSCRIBE="unsubscribe",s.UNSUBSCRIBE_STREAMS="unsubscribe_streams",s.SUBSCRIBE_CHANGE="subscribe_change",s.TRAFFIC_STATS="traffic_stats",s.RENEW_TOKEN="renew_token",s.SWITCH_VIDEO_STREAM="switch_video_stream",s.DEFAULT_VIDEO_STREAM="default_video_stream",s.SET_FALLBACK_OPTION="set_fallback_option",s.GATEWAY_INFO="gateway_info",s.CONTROL="control",s.SEND_METADATA="send_metadata",s.DATA_STREAM="data_stream",s.PICK_SVC_LAYER="pick_svc_layer",s.RESTART_ICE="restart_ice",s.CONNECT_PC="connect_pc",s.SET_VIDEO_PROFILE="set_video_profile",s.SET_PARAMETER="set_parameter"}(T0||(T0={})),function(s){s.PUBLISH_STATS="publish_stats",s.PUBLISH_RELATED_STATS="publish_related_stats",s.SUBSCRIBE_STATS="subscribe_stats",s.SUBSCRIBE_RELATED_STATS="subscribe_related_stats",s.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",s.DENOISER_STATS="denoiser_stats",s.TRANSPORT_STATS="transport_stats",s.EXTENSION_USAGE_STATS="extension_usage_stats"}(sy||(sy={})),function(s){s.ON_USER_ONLINE="on_user_online",s.ON_USER_OFFLINE="on_user_offline",s.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",s.ON_PUBLISH_STREAM="on_publish_stream",s.ON_UPLINK_STATS="on_uplink_stats",s.ON_P2P_LOST="on_p2p_lost",s.ON_REMOVE_STREAM="on_remove_stream",s.ON_ADD_AUDIO_STREAM="on_add_audio_stream",s.ON_ADD_VIDEO_STREAM="on_add_video_stream",s.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",s.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",s.ON_USER_BANNED="on_user_banned",s.ON_USER_LICENSE_BANNED="on_user_license_banned",s.ON_NOTIFICATION="on_notification",s.ON_CRYPT_ERROR="on_crypt_error",s.MUTE_AUDIO="mute_audio",s.MUTE_VIDEO="mute_video",s.UNMUTE_AUDIO="unmute_audio",s.UNMUTE_VIDEO="unmute_video",s.ON_P2P_OK="on_p2p_ok",s.RECEIVE_METADATA="receive_metadata",s.ON_DATA_STREAM="on_data_stream",s.ENABLE_LOCAL_VIDEO="enable_local_video",s.DISABLE_LOCAL_VIDEO="disable_local_video",s.ENABLE_LOCAL_AUDIO="enable_local_audio",s.DISABLE_LOCAL_AUDIO="disable_local_audio",s.ON_PUBLISHED_USER_LIST="on_published_user_list"}(M0||(M0={})),function(s){s.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",s.NEED_ANSWER="NEED_ANSWER",s.NEED_RENEGOTIATE="NEED_RENEGOTIATE",s.P2P_LOST="P2P_LOST",s.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",s.NEED_UNPUB="NEED_UNPUB",s.NEED_UNSUB="NEED_UNSUB",s.NEED_UPLOAD="NEED_UPLOAD",s.NEED_CONTROL="NEED_CONTROL",s.START_RECONNECT="START_RECONNECT",s.END_RECONNECT="END_RECONNECT",s.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(hq||(hq={})),function(s){s.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",s.RECEIVE_TRACK_BUFFER="receive_track_buffer",s.ON_AUDIO_BUFFER="on_audio_buffer",s.UPDATE_SOURCE="update_source"}(ay||(ay={}));const Y6={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,currentPacketLossRate:0},J6={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},mq={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},Mnt={uplinkNetworkQuality:0,downlinkNetworkQuality:0},vq={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let k0,J_,mR;(function(s){s.CONNECTED="websocket:connected",s.RECONNECTING="websocket:reconnecting",s.WILL_RECONNECT="websocket:will_reconnect",s.CLOSED="websocket:closed",s.FAILED="websocket:failed",s.ON_MESSAGE="websocket:on_message",s.REQUEST_NEW_URLS="websocket:request_new_urls",s.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",s.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",s.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire"})(k0||(k0={})),function(s){s.TRANSCODE="mix_streaming",s.RAW="raw_streaming",s.INJECT="inject_streaming"}(J_||(J_={})),function(s){s[s.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",s[s.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",s[s.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",s[s.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",s[s.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",s[s.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",s[s.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",s[s.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",s[s.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",s[s.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",s[s.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(mR||(mR={}));const Unt={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},X6={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function Q6(s,a){b1(s.url,"".concat(a,".url"),1,1e3,!1),S_(s.x)||f_(s.x,"".concat(a,".x"),0,1e4),S_(s.y)||f_(s.y,"".concat(a,".y"),0,1e4),S_(s.width)||f_(s.width,"".concat(a,".width"),0,1e4),S_(s.height)||f_(s.height,"".concat(a,".height"),0,1e4),S_(s.zOrder)||f_(s.zOrder,"".concat(a,".zOrder"),0,255),S_(s.alpha)||f_(s.alpha,"".concat(a,".alpha"),0,1,!1)}const jnt={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},Fnt={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};let fS,W2,P_,_q,V1,DS,z1,vR,X_,I_,G_,w0,c1,$6,Z6,ER,H2,Z0;function bq(s){if(!s.channelName)throw new Ql(Hl.INVALID_PARAMS,"invalid channelName in info");if(typeof s.uid!="number")throw new Ql(Hl.INVALID_PARAMS,"invalid uid in info, uid must be a number");return s.token&&b1(s.token,"info.token",1,2047),W6(s.uid),q6(s.channelName),!0}function kq(s){return y1(s,"mediaSource",["screen","window","application"]),!0}(function(s){s.WARNING="@live_uap-warning",s.ERROR="@line_uap-error",s.PUBLISH_STREAM_STATUS="@live_uap-publish-status",s.INJECT_STREAM_STATUS="@live_uap-inject-status",s.WORKER_STATUS="@live_uap-worker-status",s.REQUEST_NEW_ADDRESS="@live_uap-request-address"})(fS||(fS={})),function(s){s.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(W2||(W2={})),function(s){s[s.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",s[s.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",s[s.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",s[s.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",s[s.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",s[s.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",s[s.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",s[s.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",s[s.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",s[s.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",s[s.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",s[s.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",s[s.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",s[s.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",s[s.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",s[s.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",s[s.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",s[s.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",s[s.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",s[s.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",s[s.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(P_||(P_={})),function(s){s.CONNECT_FAILED="connect failed",s.CONNECT_TIMEOUT="connect timeout",s.WS_DISCONNECTED="websocket disconnected",s.REQUEST_TIMEOUT="request timeout",s.REQUEST_FAILED="request failed",s.WAIT_STATUS_TIMEOUT="wait status timeout",s.WAIT_STATUS_ERROR="wait status error",s.BAD_STATE="bad state",s.WS_ABORT="ws abort",s.AP_REQUEST_TIMEOUT="AP request timeout",s.AP_JSON_PARSE_ERROR="AP json parse error",s.AP_REQUEST_ERROR="AP request error",s.AP_REQUEST_ABORT="AP request abort"}(_q||(_q={})),function(s){s[s.SetSdkProfile=0]="SetSdkProfile",s[s.SetSourceChannel=1]="SetSourceChannel",s[s.SetSourceUserId=2]="SetSourceUserId",s[s.SetDestChannel=3]="SetDestChannel",s[s.StartPacketTransfer=4]="StartPacketTransfer",s[s.StopPacketTransfer=5]="StopPacketTransfer",s[s.UpdateDestChannel=6]="UpdateDestChannel",s[s.Reconnect=7]="Reconnect",s[s.SetVideoProfile=8]="SetVideoProfile"}(V1||(V1={})),function(s){s.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",s.NETWORK_CONNECTED="NETWORK_CONNECTED",s.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",s.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",s.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",s.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",s.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",s.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",s.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",s.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(DS||(DS={})),function(s){s.RELAY_STATE_IDLE="RELAY_STATE_IDLE",s.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",s.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",s.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(z1||(z1={})),function(s){s.RELAY_OK="RELAY_OK",s.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",s.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",s.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(vR||(vR={})),function(s){s.High="high",s.Low="low",s.Audio="audio",s.Screen="screen",s.ScreenLow="screen_low"}(X_||(X_={})),function(s){s.DISCONNECT="disconnect",s.CONNECTION_STATE_CHANGE="connection-state-change",s.NETWORK_QUALITY="network-quality",s.STREAM_TYPE_CHANGE="stream-type-change",s.IS_P2P_DISCONNECTED="is-p2p-dis",s.DISCONNECT_P2P="dis-p2p",s.REQUEST_NEW_GATEWAY_LIST="req-gate-url",s.NEED_RENEW_SESSION="need-sid",s.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",s.JOIN_RESPONSE="join-response",s.REQUEST_DC_CONNECTION_PARAMS="request-dc-connection-params",s.RESET_CONNECTION_EVENTS="reset-connection-events",s.DATACHANNEL_PRECONNECT="datachannel_preconnect",s.DATACHANNEL_FAILBACK="datachannel_failback"}(I_||(I_={})),function(s){s[s.Nothing=0]="Nothing",s[s.Audio=1]="Audio",s[s.LwoVideo=2]="LwoVideo",s[s.Video=4]="Video",s[s.Data=8]="Data"}(G_||(G_={})),function(s){s.NEED_RENEGOTIATE="@need_renegotiate",s.NEED_REPLACE_TRACK="@need_replace_track",s.NEED_CLOSE="@need_close",s.NEED_ENABLE_TRACK="@need_enable_track",s.NEED_DISABLE_TRACK="@need_disable_track",s.NEED_SESSION_ID="@need_sid",s.SET_OPTIMIZATION_MODE="@set_optimization_mode",s.GET_STATS="@get_stats",s.GET_LOW_VIDEO_TRACK="@get_low_video_track",s.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",s.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",s.NEED_MUTE_TRACK="@need_mute_track",s.NEED_UNMUTE_TRACK="@need_unmute_track"}(w0||(w0={})),function(s){s.SCREEN_TRACK="screen_track",s.LOW_STREAM="low_stream"}(c1||(c1={})),function(s){s[s.HIGH_STREAM=0]="HIGH_STREAM",s[s.LOW_STREAM=1]="LOW_STREAM"}($6||($6={})),function(s){s[s.DISABLE=0]="DISABLE",s[s.LOW_STREAM=1]="LOW_STREAM",s[s.AUDIO_ONLY=2]="AUDIO_ONLY"}(Z6||(Z6={})),function(s){s.SOURCE_STATE_CHANGE="source-state-change",s.TRACK_ENDED="track-ended",s.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",s.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",s.CLOSED="closed"}(ER||(ER={})),function(s){s.FIRST_FRAME_DECODED="first-frame-decoded",s.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(H2||(H2={})),function(s){s.CHINA="CHINA",s.ASIA="ASIA",s.NORTH_AMERICA="NORTH_AMERICA",s.EUROPE="EUROPE",s.JAPAN="JAPAN",s.INDIA="INDIA",s.KOREA="KOREA",s.HKMC="HKMC",s.US="US",s.OCEANIA="OCEANIA",s.SOUTH_AMERICA="SOUTH_AMERICA",s.AFRICA="AFRICA",s.OVERSEA="OVERSEA",s.GLOBAL="GLOBAL"}(Z0||(Z0={}));const Vnt=[Z0.AFRICA,Z0.ASIA,Z0.CHINA,Z0.EUROPE,Z0.GLOBAL,Z0.INDIA,Z0.JAPAN,Z0.NORTH_AMERICA,Z0.OCEANIA,Z0.OVERSEA,Z0.SOUTH_AMERICA];let o1;(function(s){s.CHINA="CN",s.ASIA="AS",s.NORTH_AMERICA="NA",s.EUROPE="EU",s.JAPAN="JP",s.INDIA="IN",s.KOREA="KR",s.HKMC="HK",s.US="US",s.OCEANIA="OC",s.SOUTH_AMERICA="SA",s.AFRICA="AF",s.OVERSEA="OVERSEA",s.GLOBAL="GLOBAL"})(o1||(o1={}));const _j={CHINA:{},ASIA:{CODE:o1.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:o1.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:o1.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:o1.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","	uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:o1.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:o1.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:o1.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:o1.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:o1.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:o1.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:o1.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:o1.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:o1.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};let OP,jq,N0,a0,w1,z0,M1,_R,I1,cy,Ny,ky,Q_,$S,L_;P6&&(_j.CHINA={CODE:o1.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(s){s.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(OP||(OP={}));class E4 extends C_{constructor(a,h){super(),Rl(this,"onICEConnectionStateChange",void 0),Rl(this,"onConnectionStateChange",void 0),Rl(this,"onDTLSTransportStateChange",void 0),Rl(this,"onDTLSTransportError",void 0),Rl(this,"onICETransportStateChange",void 0),Rl(this,"onFirstAudioReceived",void 0),Rl(this,"onFirstVideoReceived",void 0),Rl(this,"onFirstAudioDecoded",void 0),Rl(this,"onFirstVideoDecoded",void 0),Rl(this,"onFirstVideoDecodedTimeout",void 0),Rl(this,"onSelectedLocalCandidateChanged",void 0),Rl(this,"onSelectedRemoteCandidateChanged",void 0)}}(function(s){s.SEND="sendonly",s.RECV="recvonly",s.SENDRECV="sendrecv",s.INACTIVE="inactive"})(jq||(jq={})),function(s){s.VIDEO="video",s.AUDIO="audio"}(N0||(N0={})),function(s){s.LocalVideoTrack="videoTrack",s.LocalAudioTrack="audioTrack",s.LocalVideoLowTrack="videoLowTrack"}(a0||(a0={})),function(s){s.New="new",s.Connected="connected",s.Reconnecting="reconnecting",s.Disconnected="disconnected"}(w1||(w1={})),function(s){s.StateChange="stateChange",s.IceConnectionStateChange="iceConnectionStateChange",s.RequestMuteLocal="requestMuteLocal",s.RequestUnmuteLocal="requestUnmuteLocal",s.RequestRePublish="requestRePublish",s.RequestReSubscribe="requestReSubscribe",s.RequestUploadStats="requestUploadStats",s.MediaReconnectStart="MediaReconnectStart",s.MediaReconnectEnd="MediaReconnectEnd",s.NeedSignalRTT="NeedSignalRTT",s.RequestRestartICE="RequestRestartIce",s.PeerConnectionStateChange="PeerConnectionStateChange",s.RequestReconnect="RequestReconnect",s.RequestReconnectPC="RequestReconnectPC",s.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",s.P2PLost="P2PLost",s.UpdateVideoEncoder="UpdateVideoEncoder",s.ConnectionTypeChange="ConnectionTypeChange",s.RequestLowStreamParameter="RequestLowStreamParameter",s.QueryClientConnectionState="QueryClientConnectionState"}(z0||(z0={})),function(s){s.ONLINE="ONLINE",s.OFFLINE="OFFLINE"}(M1||(M1={})),function(s){s.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",s.ONLINE="ONLINE",s.OFFLINE="OFFLINE"}(_R||(_R={})),function(s){s.ON_TRACK="on_track",s.ON_NODE="on_node"}(I1||(I1={})),function(s){s.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",s.REQUEST_CONSTRAINTS="request_constraints"}(cy||(cy={})),function(s){s.CONNECTING="CONNECTING",s.RECONNECTING="RECONNECTING",s.CONNECTED="CONNECTED",s.CLOSED="CLOSED"}(Ny||(Ny={})),function(s){s[s.CONNECT_AP=0]="CONNECT_AP",s[s.AP_CONNECTED=1]="AP_CONNECTED",s[s.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",s[s.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",s[s.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",s[s.CONNECT_WORKER=5]="CONNECT_WORKER",s[s.WORKER_CONNECTED=6]="WORKER_CONNECTED",s[s.CLOSED=7]="CLOSED"}(ky||(ky={})),function(s){s.CONNECTION_STATE_CHANGE="connection-state-change",s.STATE_CHANGE="state-change",s.INSPECT_RESULT="inspect-result",s.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",s.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(Q_||(Q_={})),function(s){s.NETWORK_ERROR="NETWORK_ERROR",s.SERVER_ERROR="SERVER_ERROR",s.MULTI_IP="MULTI_IP",s.TIMEOUT="TIMEOUT",s.OFFLINE="OFFLINE",s.LEAVE="LEAVE",s.P2P_FAILED="P2P_FAILED",s.FALLBACK="FALLBACK"}($S||($S={})),function(s){s.CONNECTED="transmitter:connected",s.RECONNECTING="transmitter:reconnecting",s.WILL_RECONNECT="transmitter:will_reconnect",s.CLOSED="transmitter:closed",s.FAILED="transmitter:failed",s.ON_MESSAGE="transmitter:on_message",s.REQUEST_NEW_URLS="transmitter:request_new_urls",s.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",s.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",s.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",s.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",s.FAILBACK="transmitter:failback"}(L_||(L_={}));const Y1={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1};function O1(){return Y1}let n1;(function(s){s[s.CHOOSE_SERVER=11]="CHOOSE_SERVER",s[s.CLOUD_PROXY=18]="CLOUD_PROXY",s[s.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",s[s.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"})(n1||(n1={}));var Bnt=_f,NP=Array.isArray||function(s){return Bnt(s)=="Array"},Gnt=Dl,qq=NP,qnt=D0,Wnt=hy,Hnt=y0("species"),tW=Gnt.Array,Knt=function(s){var a;return qq(s)&&(a=s.constructor,(qnt(a)&&(a===tW||qq(a.prototype))||Wnt(a)&&(a=a[Hnt])===null)&&(a=void 0)),a===void 0?tW:a},eW=function(s,a){return new(Knt(s))(a===0?0:a)},znt=sS,Ynt=L1,Jnt=Uy,Xnt=cS,Qnt=eW,nW=Tl([].push),yR=function(s){var a=s==1,h=s==2,g=s==3,j=s==4,_e=s==6,_n=s==7,_o=s==5||_e;return function(_a,_r,ba,xa){for(var El,yl,Ol=Jnt(_a),Al=Ynt(Ol),Nl=znt(_r,ba),Ml=Xnt(Al),Fl=0,up=xa||Qnt,_p=a?up(_a,Ml):h||_n?up(_a,0):void 0;Ml>Fl;Fl++)if((_o||Fl in Al)&&(yl=Nl(El=Al[Fl],Fl,Ol),s))if(a)_p[Fl]=yl;else if(yl)switch(s){case 3:return!0;case 5:return El;case 6:return Fl;case 2:nW(_p,El)}else switch(s){case 4:return!1;case 7:nW(_p,El)}return _e?-1:g||j?j:_p}},rW={forEach:yR(0),map:yR(1),filter:yR(2),some:yR(3),every:yR(4),find:yR(5),findIndex:yR(6),filterReject:yR(7)},$nt=rW.forEach,iW=DO("forEach")?[].forEach:function(s){return $nt(this,s,arguments.length>1?arguments[1]:void 0)};a1({target:"Array",proto:!0,forced:[].forEach!=iW},{forEach:iW});var Znt=By("Array").forEach,trt=LS,ert=E1,nrt=Cl,rrt=Znt,$j=Array.prototype,irt={DOMTokenList:!0,NodeList:!0},ort=function(s){var a=s.forEach;return s===$j||nrt($j,s)&&a===$j.forEach||ert(irt,trt(s))?rrt:a},srt=Uy,oW=wy;a1({target:"Object",stat:!0,forced:_(function(){oW(1)})},{keys:function(s){return oW(srt(s))}});var art=IS.Object.keys,crt=qN,urt=a1,lrt=NP,drt=Tl([].reverse),sW=[1,2];urt({target:"Array",proto:!0,forced:String(sW)===String(sW.reverse())},{reverse:function(){return lrt(this)&&(this.length=this.length),drt(this)}});var hrt=By("Array").reverse,prt=Cl,frt=hrt,t8=Array.prototype,grt=function(s){var a=s.reverse;return s===t8||prt(t8,s)&&a===t8.reverse?frt:a},mrt=_,vrt=BT,Ert=y0("species"),aW=function(s){return vrt>=51||!mrt(function(){var a=[];return(a.constructor={})[Ert]=function(){return{foo:1}},a[s](Boolean).foo!==1})},_rt=a1,yrt=Dl,cW=NP,brt=D0,Srt=hy,uW=JO,Trt=cS,Rrt=iS,wrt=m4,Irt=y0,Ort=k5,Crt=aW("slice"),Art=Irt("species"),e8=yrt.Array,Nrt=Math.max;_rt({target:"Array",proto:!0,forced:!Crt},{slice:function(s,a){var h,g,j,_e=Rrt(this),_n=Trt(_e),_o=uW(s,_n),_a=uW(a===void 0?_n:a,_n);if(cW(_e)&&(h=_e.constructor,(brt(h)&&(h===e8||cW(h.prototype))||Srt(h)&&(h=h[Art])===null)&&(h=void 0),h===e8||h===void 0))return Ort(_e,_o,_a);for(g=new(h===void 0?e8:h)(Nrt(_a-_o,0)),j=0;_o<_a;_o++,j++)_o in _e&&wrt(g,j,_e[_o]);return g.length=j,g}});var krt=By("Array").slice,Lrt=Cl,Prt=krt,n8=Array.prototype,Drt=function(s){var a=s.slice;return s===n8||Lrt(n8,s)&&a===n8.slice?Prt:a};function Wp(s,a,h,g,j){var _e,_n,_o,_a={};return ort(_e=art(g)).call(_e,function(_r){_a[_r]=g[_r]}),_a.enumerable=!!_a.enumerable,_a.configurable=!!_a.configurable,("value"in _a||_a.initializer)&&(_a.writable=!0),_a=crt(_n=grt(_o=Drt(h).call(h)).call(_o)).call(_n,function(_r,ba){return ba(s,a,_r)||_r},_a),j&&_a.initializer!==void 0&&(_a.value=_a.initializer?_a.initializer.call(j):void 0,_a.initializer=void 0),_a.initializer===void 0&&(TV(s,a,_a),_a=null),_a}var xrt=By("Array").keys,Mrt=LS,Urt=E1,jrt=Cl,Frt=xrt,r8=Array.prototype,Vrt={DOMTokenList:!0,NodeList:!0},nO=function(s){var a=s.keys;return s===r8||jrt(r8,s)&&a===r8.keys||Urt(Vrt,Mrt(s))?Frt:a};function lW(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function dW(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?lW(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):lW(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}let _4=0,i8=0;function xS(s,a,h,g){return new s0((j,_e)=>{a.timeout=a.timeout||wp("HTTP_CONNECT_TIMEOUT"),a.responseType=a.responseType||"json",a.data&&!h?(a.data=JSON.stringify(a.data),_4+=X2(a.data)):h&&(a.data.size?_4+=a.data.size:a.data instanceof FormData?_4+=function(_n){let _o=0;return/DingTalk/i.test(navigator.userAgent)&&_n.realFormData&&(_n=_n.realFormData),_n.forEach(_a=>{_o+=typeof _a=="string"?X2(_a):_a.size}),_o+138}(a.data):_4+=X2(JSON.stringify(a.data))),a.headers=a.headers||{},a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json",a.method="POST",a.url=s,hS.request(a).then(_n=>{typeof _n.data=="string"?i8+=X2(_n.data):_n.data instanceof ArrayBuffer||_n.data instanceof Uint8Array?i8+=_n.data.byteLength:i8+=X2(JSON.stringify(_n.data)),g&&j({data:_n.data,headers:_n.headers}),j(_n.data)}).catch(_n=>{hS.isCancel(_n)?_e(new Ql(Hl.OPERATION_ABORTED,"cancel token canceled")):_n.code==="ECONNABORTED"?_e(new Ql(Hl.NETWORK_TIMEOUT,_n.message)):_n.response?_e(new Ql(Hl.NETWORK_RESPONSE_ERROR,_n.response.status)):_e(new Ql(Hl.NETWORK_ERROR,_n.message))})})}async function Brt(s,a){const h=new Blob([a.data],{type:"buffer"});return await xS(s,dW(dW({},a),{},{data:h,headers:{"Content-Type":"application/octet-stream"}}),!0)}const q_=new class extends C_{set networkState(s){Ll.info("[".concat(this._moduleName,"]")+"network state changed, "+this._networkState+" -> "+s),this.emit(_R.NETWORK_STATE_CHANGE,s,this._networkState),s===M1.ONLINE?this.emit(_R.ONLINE):s===M1.OFFLINE&&(this.onlineWaiter=new s0(a=>{this.once(_R.ONLINE,()=>{this.onlineWaiter=void 0,a(M1.ONLINE)})}),this.emit(_R.OFFLINE)),this._networkState=s}get networkState(){return this._networkState}constructor(){super(),Rl(this,"_moduleName","network-indicator"),Rl(this,"_networkState",M1.ONLINE),Rl(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=M1.ONLINE}),window.addEventListener("offline",()=>{this.networkState=M1.OFFLINE})}};let o8=!1;const Ly=new class extends C_{constructor(){super(...arguments),Rl(this,"onAutoplayFailed",void 0),Rl(this,"onAudioAutoplayFailed",void 0)}};function hW(){if(p_(),!o8){const s=a=>{a.preventDefault(),o8=!1,QL()?document.body.removeEventListener("click",s,!0):(document.body.removeEventListener("touchstart",s,!0),document.body.removeEventListener("mousedown",s,!0))};o8=!0,QL()?document.body.addEventListener("click",s,!0):(document.body.addEventListener("touchstart",s,!0),document.body.addEventListener("mousedown",s,!0)),Ll.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),Ly.onAutoplayFailed?Ly.onAutoplayFailed():Ly.onAudioAutoplayFailed?Ll.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):Ll.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),Ly.emit("autoplay-failed")}}function s8(s){return new TextEncoder().encode(s)}const pW=function(s,a){const h=new Uint8Array(s.byteLength+a.byteLength);return h.set(new Uint8Array(s),0),h.set(new Uint8Array(a),s.byteLength),h},Grt=async s=>function(a,h){let g="";return new Uint8Array(a).forEach(j=>{g+=j.toString(h).padStart(2,"0")}),g}(await crypto.subtle.digest("SHA-256",s8(s)),16);function fW(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function L0(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?fW(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):fW(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}function b0(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(a,h,g){const j=g.value;if(typeof j=="function"){const _e=s.className||a.__className__||(a.constructor.name==="AgoraRTCClient"?"Client":a.constructor.name);g.value=function(){for(var _n=arguments.length,_o=new Array(_n),_a=0;_a<_n;_a++)_o[_a]=arguments[_a];let _r=_o;if(s.argsMap)try{_r=s.argsMap(this,..._o)}catch(xa){Ll.warning(xa),_r=[]}try{JSON.stringify(_r)}catch{Ll.warning("arguments for method ".concat(_e,".").concat(h," not serializable for apiInvoke.")),_r=[]}const ba=(s.report||d0).reportApiInvoke(this._sessionId||null,{name:"".concat(_e,".").concat(h),options:_r,tag:A_.TRACER,reportResult:s.reportResult},s.throttleTime);try{const xa=j.apply(this,_o);return xa instanceof s0?xa.then(El=>(ba.onSuccess(s.reportResult&&El),El)).catch(El=>{throw ba.onError(El),El}):(ba.onSuccess(s.reportResult&&xa),xa)}catch(xa){throw ba.onError(xa),xa}}}return g}}const d0=new class{constructor(){Rl(this,"baseInfoMap",new Map),Rl(this,"proxyServer",void 0),Rl(this,"clientList",G2),Rl(this,"eventUploadTimer",void 0),Rl(this,"setSessionIdTimer",void 0),Rl(this,"url",void 0),Rl(this,"backupUrl",void 0),Rl(this,"_appId",void 0),Rl(this,"keyEventUploadPendingItems",[]),Rl(this,"normalEventUploadPendingItems",[]),Rl(this,"apiInvokeUploadPendingItems",[]),Rl(this,"apiInvokeCount",0),Rl(this,"ltsList",[]),Rl(this,"lastSendNormalEventTime",Date.now()),Rl(this,"customReportCounterTimer",void 0),Rl(this,"customReportCount",0),Rl(this,"extApiInvoke",async s=>{for(const a of s){const h=L0(L0({},a),{},{sid:null,invokeId:++this.apiInvokeCount,tag:A_.TRACER});this.sendApiInvoke(h)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),wp("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),wp("EVENT_REPORT_SEND_INTERVAL"))}adjustSessionStartTime(s){if(!this.baseInfoMap.has(s)&&!this.baseInfoMap.get(s))return void Ll.error("adjust session ".concat(s," start time, sid is not exist or info is undefined"));const a=this.baseInfoMap.get(s),h=Date.now(),g=a.startTime;a.startTime=h,Ll.debug("rewrite session ".concat(s," startTime: ").concat(h," , ").concat(h-g,"ms")),this.baseInfoMap.set(s,a)}setAppId(s){this._appId=s}reportApiInvoke(s,a,h){a.timeout=a.timeout||6e4,a.reportResult=a.reportResult===void 0||a.reportResult;const g=Date.now();this.apiInvokeCount+=1;const j=this.apiInvokeCount,_e=()=>({tag:a.tag,invokeId:j,sid:s,name:a.name,apiInvokeTime:g,options:a.options,states:a.states||null}),_n=!!wp("SHOW_REPORT_INVOKER_LOG");_n&&Ll.info("".concat(a.name," start"),a.options);let _o=!1;g1(a.timeout).then(()=>{_o||(this.sendApiInvoke(L0(L0({},_e()),{},{error:Hl.API_INVOKE_TIMEOUT,success:!1})),Ll.debug("".concat(a.name," timeout")))});const _a=new Ql(Hl.UNEXPECTED_ERROR,"".concat(a.name,": this api invoke is end"));return{onSuccess:_r=>{const ba=()=>{if(_o)throw _a;return _o=!0,this.sendApiInvoke(L0(L0({},_e()),{},{success:!0},a.reportResult&&{result:_r})),_n&&Ll.info("".concat(a.name," onSuccess")),_r};return h?Iz(ba,a.name+"Success",h,()=>_o=!0):ba()},onError:_r=>{const ba=()=>{if(_o)throw _r;_o=!0,this.sendApiInvoke(L0(L0({},_e()),{},{success:!1,error:_r})),_n&&Ll.info("".concat(a.name," onFailure"),_r.toString())};return h?Iz(ba,a.name+"Error",h,()=>_o=!0):ba()}}}sessionInit(s,a){if(this.baseInfoMap.has(s))return;const h=Date.now(),g=this.createBaseInfo(s,h);g.cname=a.cname;const j=Object.assign({},{willUploadConsoleLog:wp("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:P6?"global":"oversea",areas:wp("AREAS")&&wp("AREAS").join(",")},a.extend),_e=Date.now(),_n=L0(L0({},g),{},{eventType:T1.SESSION_INIT,appid:a.appid,browser:navigator.userAgent,build:L6,lts:_e,elapse:_e-h,extend:JSON.stringify(j),mode:a.mode,process:wp("PROCESS_ID"),appType:wp("APP_TYPE"),success:!0,version:Ky});this.send({type:k_.SESSION,data:_n},!0)}joinChooseServer(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info,j=Date.now(),_e=L0(L0({},g),{},{eventType:T1.JOIN_CHOOSE_SERVER,lts:j,eventElapse:j-a.lts,chooseServerAddr:a.csAddr,errorCode:a.ec,elapse:j-h.startTime,success:a.succ,chooseServerAddrList:JSON.stringify(a.serverList),uid:a.uid?parseInt(a.uid):null,cid:a.cid?parseInt(a.cid):null,chooseServerIp:a.csIp||"",opid:a.opid,unilbsServerIds:a.unilbsServerIds,extend:a.extend||void 0,isHttp3:a.isHttp3});this.send({type:k_.JOIN_CHOOSE_SERVER,data:_e},!0)}reqUserAccount(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info,j=Date.now(),_e=L0(L0({},g),{},{eventType:T1.REQ_USER_ACCOUNT,lts:j,success:a.success,serverAddress:a.serverAddr,stringUid:a.stringUid,uid:a.uid,errorCode:a.errorCode,elapse:j-h.startTime,eventElapse:j-a.lts,extend:JSON.stringify(a.extend)});this.send({type:k_.REQ_USER_ACCOUNT,data:_e},!0)}joinGateway(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info;a.vid&&(g.vid=a.vid),g.uid=a.uid,g.cid=a.cid;const j=Date.now(),{firstSuccess:_e,avoidJoinStartTime:_n,isProxy:_o,addr:_a}=a,_r=j-(_e&&_n?_n:h.startTime),ba=L0(L0({},g),{},{eventType:T1.JOIN_GATEWAY,lts:j,gatewayAddr:a.addr,success:a.succ,errorCode:a.ec,elapse:_r,eventElapse:j-a.lts,firstSuccess:_e,signalChannel:a.signalChannel}),xa=ba.success?1:0;if(a.succ&&(h.lastJoinSuccessTime=j),_e)this.send({type:k_.JOIN_GATEWAY,data:ba},!0);else{let El;if(_a)if(_o){const Ol=_a.match(/h=(\d{1,3}-){3}\d{1,3}/g),Al=_a.match(/p=[0-9]{1,6}/g);El={isSuccess:xa,gatewayIp:Ol&&Ol.length?Ol[0].split("=")[1].replace(/-/g,"."):"",port:Al&&Al.length?Al[0].split("=")[1]:"",isProxy:_o?1:0}}else{const Ol=_a.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),Al=_a.match(/:[0-9]{1,6}/g);El={isSuccess:xa,gatewayIp:Ol&&Ol.length?Ol[0].split("//")[1].replace(/-/g,"."):"",port:Al&&Al.length?Al[0].split(":")[1]:"",isProxy:_o?1:0}}else El={isSuccess:xa,gatewayIp:"",port:"",isProxy:_o?1:0};delete ba.success,delete ba.eventType,delete ba.firstSuccess,ba.vid=Number(ba.vid);const yl=Object.assign({},ba,El,{eventType:T1.REJOIN_GATEWAY});this.send({type:k_.RE_JOIN_GATEWAY,data:yl},!0)}}joinChannelTimeout(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=Date.now(),j=L0(L0({},h.info),{},{lts:g,timeout:a,elapse:g-h.startTime});this.send({type:k_.JOIN_CHANNEL_TIMEOUT,data:j},!0)}publish(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info,j=Date.now(),_e=L0(L0({},g),{},{eventType:T1.PUBLISH,lts:j,eventElapse:a.eventElapse,elapse:j-h.startTime,success:a.succ,errorCode:a.ec,videoName:a.videoName,audioName:a.audioName,screenName:a.screenName,screenshare:a.screenshare,audio:a.audio,video:a.video,p2pid:a.p2pid,publishRequestid:a.publishRequestid});this.send({type:k_.PUBLISH,data:_e},!0)}subscribe(s,a,h){const g=this.baseInfoMap.get(s);if(!g)return;const j=g.info,_e=Date.now(),_n=L0(L0({},j),{},{eventType:T1.SUBSCRIBE,lts:_e,eventElapse:a.eventElapse,elapse:_e-g.startTime,success:a.succ,errorCode:a.ec,video:a.video,audio:a.audio,subscribeRequestid:a.subscribeRequestid,p2pid:a.p2pid},h&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof a.peerid=="string"?_n.peerSuid=a.peerid:_n.peer=a.peerid,this.send({type:k_.SUBSCRIBE,data:_n},!0)}wsCompressorInit(s){var a;const h=[...nO(a=this.baseInfoMap).call(a)],g=h.length?h[0]:"UnableToGetSid",j=this.baseInfoMap.get(g);if(!j)return;const _e=j.info,_n=Date.now(),_o=L0(L0({},_e),{},{eventType:T1.WS_COMPRESSOR_INIT,lts:_n,eventElapse:s.eventElapse,elapse:_n-j.startTime,status:s.status?1:2});this.send({type:k_.WS_COMPRESSOR_INIT,data:_o},!0)}firstRemoteVideoDecode(s,a,h,g){const j=this.baseInfoMap.get(s);if(!j)return;const _e=j.info,_n=Date.now(),_o=L0(L0(L0({},_e),g),{},{elapse:_n-j.startTime,eventType:a,lts:_n,firstDecodeFrame:Math.max(_n-j.startTime,0),apEnd:Math.max(g.apEnd-j.startTime,0),apStart:Math.max(g.apStart-j.startTime,0),joinGwEnd:Math.max(g.joinGwEnd-j.startTime,0),joinGwStart:Math.max(g.joinGwStart-j.startTime,0),pcEnd:Math.max(g.pcEnd-j.startTime,0),pcStart:Math.max(g.pcStart-j.startTime,0),subscriberEnd:Math.max(g.subscriberEnd-j.startTime,0),subscriberStart:Math.max(g.subscriberStart-j.startTime,0),videoAddNotify:Math.max(g.videoAddNotify-j.startTime,0)});this.send({type:h,data:_o},!0)}firstRemoteFrame(s,a,h,g){const j=this.baseInfoMap.get(s);if(!j)return;const _e=j.info,_n=Date.now(),_o=L0(L0(L0({},_e),g),{},{elapse:_n-j.startTime,eventType:a,lts:_n});this.send({type:h,data:_o},!0)}onGatewayStream(s,a,h,g){const j=this.baseInfoMap.get(s);if(!j)return;const _e=j.info,_n=Date.now(),_o=L0(L0(L0({},_e),g),{},{eventType:a,lts:_n});this.send({type:h,data:_o},!0)}streamSwitch(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info,j=Date.now(),_e=L0(L0({},g),{},{eventType:T1.STREAM_SWITCH,lts:j,isDual:a.isdual,elapse:j-h.startTime,success:a.succ});this.send({type:k_.STREAM_SWITCH,data:_e},!0)}requestProxyAppCenter(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info,j=Date.now(),_e=L0(L0({},g),{},{eventType:T1.REQUEST_PROXY_APPCENTER,lts:j,eventElapse:j-a.lts,elapse:j-h.startTime,APAddr:a.APAddr,workerManagerList:a.workerManagerList,response:a.response,errorCode:a.ec,success:a.succ});this.send({type:k_.REQUEST_PROXY_APPCENTER,data:_e},!0)}requestProxyWorkerManager(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info,j=Date.now(),_e=L0(L0({},g),{},{eventType:T1.REQUEST_PROXY_WORKER_MANAGER,lts:j,eventElapse:j-a.lts,elapse:j-h.startTime,workerManagerAddr:a.workerManagerAddr,response:a.response,errorCode:a.ec,success:a.succ});this.send({type:k_.REQUEST_PROXY_WORKER_MANAGER,data:_e},!0)}setProxyServer(s){this.proxyServer=s,s?Ll.debug("reportProxyServerurl: ".concat(s)):Ll.debug("disable reportProxyServerurl: ".concat(s))}peerPublishStatus(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info,j=Date.now(),_e=L0(L0({},g),{},{subscribeElapse:a.subscribeElapse,peer:a.peer,peerPublishDuration:Math.max(a.audioPublishDuration,a.videoPublishDuration),audiotag:a.audioPublishDuration>0?1:-1,videotag:a.videoPublishDuration>0?1:-1,lts:j,elapse:j-h.startTime,joinChannelSuccessElapse:j-(h.lastJoinSuccessTime||j),peerPublishDurationVideo:a.videoPublishDuration,peerPublishDurationAudio:a.audioPublishDuration});this.send({type:k_.PEER_PUBLISH_STATUS,data:_e},!0)}workerEvent(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info,j=Date.now();(function(_e,_n,_o){const _a=_e[_n];if(!_a||typeof _a!="string")return[_e];_e[_n]="";const _r=X2(JSON.stringify(_e));let ba=0;const xa=[];let El=0;for(let yl=0;yl<_a.length;yl++)El+=_a.charCodeAt(yl)<=127?1:3,El<=_o-_r||(xa[xa.length]=oO(oO({},_e),{},{[_n]:_a.substring(ba,yl)}),ba=yl,El=_a.charCodeAt(yl)<=127?1:3);return ba!==_a.length-1&&(xa[xa.length]=oO(oO({},_e),{},{[_n]:_a.substring(ba)})),xa})(L0(L0(L0({},g),a),{},{elapse:j-h.startTime,lts:j,productType:"WebRTC"}),"payload",1300).forEach(_e=>this.send({type:k_.WORKER_EVENT,data:_e},!0))}apworkerEvent(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info,j=Date.now(),_e=L0(L0(L0({},g),a),{},{elapse:j-h.startTime,lts:j});this.send({type:k_.AP_WORKER_EVENT,data:_e},!0)}joinWebProxyAP(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info,j=Date.now(),_e=L0(L0(L0({},g),a),{},{elapse:j-h.startTime,lts:j,extend:a.extend||void 0});this.send({type:k_.JOIN_WEB_PROXY_AP,data:_e},!0)}WebSocketQuit(s,a){const h=this.baseInfoMap.get(s);if(!h)return;const g=h.info,j=Date.now(),_e=L0(L0(L0({},g),a),{},{elapse:j-h.startTime,lts:j});this.send({type:k_.WEBSOCKET_QUIT,data:_e},!0)}async sendCustomReportMessage(s,a){if(this.customReportCount+=a.length,this.customReportCount>wp("CUSTOM_REPORT_LIMIT"))throw new Ql(Hl.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const h=a.map(g=>({type:k_.USER_ANALYTICS,data:L0({sid:s},g)}));try{wp("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(h):await this.postDataToStatsCollector(h)}catch(g){throw Ll.error("send custom report message failed",g.toString()),new Ql(Hl.CUSTOM_REPORT_SEND_FAILED,g.message)}}autoplayFailed(s,a,h,g){if(!s)return;const j=this.baseInfoMap.get(s);if(!j)return;const _e=j.info,_n=Date.now(),_o=L0(L0({},_e),{},{vid:_e.vid===void 0?0:Number(_e.vid),lts:_n,elapse:_n-j.startTime,cbRegistered:Ly.onAutoplayFailed||Ly.onAudioAutoplayFailed?1:-1,errorMsg:h,mediaType:a,trackId:g,extend:void 0});this.send({type:k_.AUTOPLAY_FAILED,data:_o},!0)}sendApiInvoke(s){const a=wp("NOT_REPORT_EVENT");if(s.tag&&a.includes&&a.includes(s.tag))return!1;if(s.sid===null)return this.apiInvokeUploadPendingItems.push(s),!1;const h=this.baseInfoMap.get(s.sid);if(!h)return this.apiInvokeUploadPendingItems.push(s),!1;const{cname:g,uid:j,cid:_e}=h.info;s.lts=s.lts||Date.now();let _n;if(s.error)if(s.error instanceof Ql){const{code:_a,message:_r}=s.error;_n=_a||_r||s.error.toString()}else _n=s.error.toString();const _o={invokeId:s.invokeId,sid:s.sid,cname:g,cid:_e,uid:j,lts:s.lts,success:s.success,elapse:s.lts-h.startTime,execElapse:s.lts-s.apiInvokeTime,apiName:s.name,options:s.options?JSON.stringify(s.options):void 0,execStates:s.states?JSON.stringify(s.states):void 0,execResult:s.result?JSON.stringify(s.result):void 0,errorCode:s.error?_n:void 0,errorMsg:s.error?JSON.stringify(s.error):void 0};return this.send({type:k_.API_INVOKE,data:_o},!1),!0}appendSessionId(){this.clientList.forEach(s=>{if(s._sessionId){const a=this.apiInvokeUploadPendingItems.length;for(let h=0;h<a;h++){const g=this.apiInvokeUploadPendingItems.shift();g&&(g.sid=s._sessionId,this.sendApiInvoke(Object.assign({},g)))}}})}send(s,a){if(a)return this.keyEventUploadPendingItems.push(s),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(s),this.normalEventUploadPendingItems.length>wp("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(s,a){const h=[],g=[];for(;s.length;){const _e=s.shift();h.length<20?h.push(_e):g.push(_e)}s.push(...g);for(const _e of[...h]){var j;this.ltsList.indexOf(_e.data.lts)!==-1?(_e.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(_e.data.lts)):(this.ltsList.push(_e.data.lts),B6(j=this.ltsList).call(j,(_n,_o)=>_n-_o))}return a||(this.lastSendNormalEventTime=Date.now()),wp("ENABLE_EVENT_REPORT")&&h.length&&(wp("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(h):this.postDataToStatsCollector(h)).catch((_e=>_n=>{wp("EVENT_REPORT_RETRY")&&(a?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(_e):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(_e),this.normalEventUploadPendingItems.length>wp("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-wp("NORMAL_EVENT_QUEUE_CAPACITY")),Ll.warning("report: drop normal events"))))})(h)),s}async postDataToStatsCollector2(s){q_.networkState===M1.OFFLINE&&await s0.race([q_.onlineWaiter,g1(2*t1.maxRetryTimeout)]);const a=j=>{let _e=new Uint8Array;return j.forEach(_n=>{const _o=s8(JSON.stringify(_n.data)),_a=new ArrayBuffer(5),_r=(xa=>{let El=0;return Object.entries(k_).forEach(yl=>{let[Ol,Al]=yl;Al===xa.type&&(El=K6[Ol])}),El})(_n),ba=new DataView(_a);ba.setUint16(0,_o.byteLength,!0),ba.setUint8(2,255&_r),ba.setUint8(3,_r>>>8&255),ba.setUint8(4,_r>>>16&255),_e=pW(_e,new Uint8Array(_a)),_e=pW(_e,_o)}),_e},h="event";let g=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(wp("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(h):"https://".concat(wp("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(h);for(let j=0;j<2;j+=1){j===1&&(g=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(wp("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(h):"https://".concat(wp("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(h));try{await xS(g,{timeout:1e4,data:a(s),headers:L0(L0({token:"32f24ab2ddb74f508aa9286c356cec84",biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(_e){if(j===1)throw _e;continue}return}}async postDataToStatsCollector(s){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const h={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:s.map(_e=>JSON.stringify(_e)),vid:(_e=>{const _n=_e&&_e.data.sid&&this.baseInfoMap.get(_e.data.sid);return _n&&_n.info.vid&&+_n.info.vid||0})(s[0])};q_.networkState===M1.OFFLINE&&await s0.race([q_.onlineWaiter,g1(2*t1.maxRetryTimeout)]);const g=a?"/events/proto-raws":"/events/messages";let j=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(wp("EVENT_REPORT_DOMAIN"),"&p=").concat(wp("STATS_COLLECTOR_PORT"),"&d=").concat(g):"https://".concat(wp("EVENT_REPORT_DOMAIN"),":").concat(wp("STATS_COLLECTOR_PORT")).concat(g));for(let _e=0;_e<2;_e+=1){_e===1&&(j=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(wp("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(wp("STATS_COLLECTOR_PORT"),"&d=").concat(g):"https://".concat(wp("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(wp("STATS_COLLECTOR_PORT")).concat(g)));try{a?await Brt(j,{timeout:1e4,data:h}):await xS(j,{timeout:1e4,data:h})}catch(_n){if(_e===1)throw _n;continue}return}}createBaseInfo(s,a){const h=Object.assign({},Dnt);return h.sid=s,this.baseInfoMap.set(s,{info:h,startTime:a}),h}reportResourceTiming(s,a){const h=performance.getEntriesByName(s),g=h[h.length-1];g&&this.reportApiInvoke(a,{name:"Client.resourceTiming",options:g,tag:A_.TRACER}).onSuccess()}};h4.on("REPORT_LOG_UPLOAD",s=>{s.networkState=q_.networkState,d0.reportApiInvoke(null,{name:"logUploadError",options:s,tag:A_.TRACER})});class gW extends C_{constructor(a,h){super(),Rl(this,"trackMediaType",void 0),Rl(this,"_ID",void 0),Rl(this,"_hints",[]),Rl(this,"_isClosed",!1),Rl(this,"_originMediaStreamTrack",void 0),Rl(this,"_mediaStreamTrack",void 0),Rl(this,"_external",{}),this._ID=h||N_(8,"track-"),this._originMediaStreamTrack=a,this._mediaStreamTrack=a,function(g){_P.includes(g)||_P.push(g)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(a){if(!a){const h=d0.reportApiInvoke(null,{name:Y_.GET_MEDIA_STREAM_TRACK,options:[],tag:A_.TRACER});this._mediaStreamTrack&&typeof this._mediaStreamTrack.label=="string"?h.onSuccess(this._mediaStreamTrack.label):h.onSuccess("")}return this._mediaStreamTrack}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,function(a){const h=_P.indexOf(a);h!==-1&&_P.splice(h,1)}(this),this.emit(ER.CLOSED)}}let r1,qrt=1;class B1{constructor(a){Rl(this,"lockingPromise",s0.resolve()),Rl(this,"locks",0),Rl(this,"name",""),Rl(this,"lockId",void 0),this.lockId=qrt++,a&&(this.name=a),Ll.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(a){let h;this.locks+=1,Ll.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat(typeof a=="string"?a:""));const g=new s0(_e=>{h=()=>{this.locks-=1,Ll.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat(typeof a=="string"?a:"")),_e()}}),j=this.lockingPromise.then(()=>h);return this.lockingPromise=this.lockingPromise.then(()=>g),j}}function K2(s,a){return function(h,g,j){const _e=j.value;if(typeof _e!="function")throw new Error("Cannot use mutex on object property.");return j.value=async function(){const _n=this[a];if(!_n)throw new Error("mutex property key ".concat(a," doesn't exist on ").concat(s));const _o=await _n.lock("From ".concat(s,".").concat(g));try{for(var _a=arguments.length,_r=new Array(_a),ba=0;ba<_a;ba++)_r[ba]=arguments[ba];return await _e.apply(this,_r)}finally{_o()}},j}}class a8 extends gW{get muted(){return this._muted}get enabled(){return this._enabled}constructor(a,h){super(a,h),Rl(this,"_enabled",!0),Rl(this,"_muted",!1),Rl(this,"_isClosed",!1),Rl(this,"_enabledMutex",void 0),Rl(this,"processor",void 0),Rl(this,"processorContext",void 0),Rl(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new B1("".concat(h)),a.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){return this._originMediaStreamTrack.label}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,Ll.debug("[".concat(this.getTrackId(),"] close")),this.emit(w0.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(a,h){a!==this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),h&&this._originMediaStreamTrack.stop(),a.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=a,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await D_(this,w0.NEED_REPLACE_TRACK,this),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){Ll.debug("[".concat(this.getTrackId(),"] track ended")),this.emit(ER.TRACK_ENDED)}stateCheck(a,h){if(Ll.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(a,": ").concat(h,"]")),SP(h,a),this._enabled&&this._muted&&a==="enabled"&&h===!1)throw new Ql(Hl.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print();if(!this._enabled&&!this._muted&&a==="muted"&&h===!0)throw new Ql(Hl.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}function mW(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}(function(s){s.IOS_15_INTERRUPTION_START="ios15-interruption-start",s.IOS_15_INTERRUPTION_END="ios15-interruption-end",s.IOS_INTERRUPTION_START="ios-interruption-start",s.IOS_INTERRUPTION_END="ios-interruption-end",s.STATE_CHANGE="state-change"})(r1||(r1={}));const vW=window.AudioContext||window.webkitAudioContext;let zy=null;const G0=new class extends C_{constructor(){super(...arguments),Rl(this,"prevState",void 0),Rl(this,"curState",void 0),Rl(this,"currentTime",void 0),Rl(this,"currentTimeStuckAt",void 0),Rl(this,"interruptDetectorTrack",void 0),Rl(this,"onLocalAudioTrackMute",()=>{Ll.info("ios15-interruption-start"),this.emit(r1.IOS_15_INTERRUPTION_START)}),Rl(this,"onLocalAudioTrackUnmute",async()=>{Ll.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?Ll.info("ios15-interruption-end-canceled"):(zy&&await zy.suspend(),this.emit(r1.IOS_15_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(s){Ll.debug("webaudio bindInterruptDetectorTrack ".concat(s.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=s,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(s){Ll.debug("webaudio unbindInterruptDetectorTrack ".concat(s.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===s&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function Wrt(){if(!vW)return void Ll.error("your browser is not support web audio");Ll.info("create audio context");const s=function(a){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?mW(Object(g),!0).forEach(function(j){Rl(a,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(g)):mW(Object(g)).forEach(function(j){Object.defineProperty(a,j,Object.getOwnPropertyDescriptor(g,j))})}return a}({},wp("WEBAUDIO_INIT_OPTIONS"));Ll.debug("audio context init option:",JSON.stringify(s)),zy=new vW(s),G0.curState=zy.state,zy.onstatechange=()=>{G0.prevState=G0.curState,G0.curState=zy?zy.state:void 0,(x1()||AT())&&G0.prevState==="running"&&G0.curState==="interrupted"&&(Ll.info("ios-interruption-start"),G0.emit(r1.IOS_INTERRUPTION_START)),(x1()||AT())&&G0.prevState==="interrupted"&&G0.curState==="running"&&(Ll.info("ios-interruption-end"),G0.emit(r1.IOS_INTERRUPTION_END)),G0.prevState!==G0.curState&&(Ll.debug("AudioContext State Change","".concat(G0.prevState,"=>").concat(G0.curState)),G0.emit(r1.STATE_CHANGE))},setInterval(()=>{var a;const h=(a=zy)===null||a===void 0?void 0:a.currentTime;G0.currentTime!==h?(G0.currentTimeStuckAt&&(Ll.debug("AudioContext current time resume at ".concat(h)),G0.currentTimeStuckAt=void 0),G0.currentTime=h):(h!==G0.currentTimeStuckAt&&(d0.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:h},tag:A_.TRACER}).onSuccess(),Ll.warning("AudioContext current time stuck at ".concat(h))),G0.currentTimeStuckAt=h)},5e3),async function(a){const h=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let g,j=!1,_e=!1,_n=!1;function _o(Nl){a.state==="running"?_a(!1):x1()||AT()?a.state==="suspended"&&(_a(!0),Nl&&a.resume().then(ba,ba)):a.state!=="closed"&&(_a(!0),Nl&&a.resume().then(ba,ba))}function _a(Nl){if(j!==Nl){j=Nl;for(let Ml=0,Fl=h;Ml<Fl.length;Ml+=1){const up=Fl[Ml];Nl?window.addEventListener(up,xa,{capture:!0,passive:!0}):window.removeEventListener(up,xa,{capture:!0,passive:!0})}}}function _r(){_o(!0)}function ba(){_o(!1)}function xa(){_o(!0)}function El(Nl){if(!_n)if(g.paused)if(Nl){yl(!1),_n=!0;let Ml;try{Ml=g.play(),Ml?Ml.then(Ol,Ol):(g.addEventListener("playing",Ol),g.addEventListener("abort",Ol),g.addEventListener("error",Ol))}catch{Ol()}}else yl(!0);else yl(!1)}function yl(Nl){if(_e!==Nl){_e=Nl;for(let Ml=0,Fl=h;Ml<Fl.length;Ml++){const up=Fl[Ml];Nl?window.addEventListener(up,Al,{capture:!0,passive:!0}):window.removeEventListener(up,Al,{capture:!0,passive:!0})}}}function Ol(){g.removeEventListener("playing",Ol),g.removeEventListener("abort",Ol),g.removeEventListener("error",Ol),_n=!1,El(!1)}function Al(){El(!0)}if(x1()){const Nl=a.createMediaStreamDestination(),Ml=document.createElement("div");Ml.innerHTML="<audio x-webkit-airplay='deny'></audio>",g=Ml.children.item(0),g.controls=!1,g.disableRemotePlayback=!0,g.preload="auto",g.srcObject=Nl.stream,El(!0)}G0.on(r1.STATE_CHANGE,_r),_o(!1)}(zy)}function z2(){if(!zy){if(Wrt(),!zy)throw new Ql(Hl.NOT_SUPPORTED,"can not create audio context");return zy}return zy}function rO(s){if(function(){if(c8!==null)return c8;const g=z2(),j=g.createBufferSource(),_e=g.createGain(),_n=g.createGain();j.connect(_e),j.connect(_n),j.disconnect(_e);let _o=!1;try{j.disconnect(_e)}catch{_o=!0}return j.disconnect(),c8=_o,_o}())return;const a=s.connect,h=s.disconnect;s.connect=(g,j,_e)=>(s._inputNodes||(s._inputNodes=[]),s._inputNodes.includes(g)||(g instanceof AudioNode?(s._inputNodes.push(g),a.call(s,g,j,_e)):a.call(s,g,j)),s),s.disconnect=(g,j,_e)=>{h.call(s),g?g8(s._inputNodes,g):s._inputNodes=[];for(const _n of s._inputNodes)a.call(s,_n)}}let c8=null;function u8(s,a){let h=!1;const g=1/a;if(wp("DISABLE_WEBAUDIO")){const j=window.setInterval(()=>{h?window.clearInterval(j):s(performance.now()/1e3)},1e3*g)}else{const j=z2();let _e=j.createGain();_e.gain.value=0,_e.connect(j.destination);const _n=()=>{if(h)return void(_e=null);const _o=j.createOscillator();_o.onended=_n,_o.connect(_e),_o.start(0),_o.stop(j.currentTime+g),s(j.currentTime)};_n()}return()=>{h=!0}}const bR=Ll.prefix("[inject-node]");class Hrt{constructor(){Rl(this,"nodeLists",[]),Rl(this,"prevNode",void 0),Rl(this,"nextNode",void 0)}get firstNode(){return this.nodeLists[0]}get lastNode(){return this.nodeLists[this.nodeLists.length-1]}get isActive(){return!!this.nodeLists.length}get isConnected(){return!(!this.prevNode||!this.nextNode)}connect(a,h){bR.debug("connect audio node, current list:"+this.nodeLists.length),this.nodeLists.length?(this.prevNode&&this.prevNode.disconnect(),a.connect(this.firstNode),this.nextNode&&this.lastNode&&this.lastNode.disconnect(),this.lastNode.connect(h),this.nodeLists.forEach((g,j)=>{const _e=this.nodeLists[j+1];_e&&g.connect(_e)})):a.connect(h),this.nextNode=h,this.prevNode=a}disconnect(){var a;bR.debug("disconnect audio node, current list:"+this.nodeLists.length),this.nodeLists.forEach(h=>{h.disconnect()}),(a=this.prevNode)===null||a===void 0||a.disconnect(),this.prevNode=void 0,this.nextNode=void 0}addNode(a){bR.debug("add node in inject node, current list:",this.nodeLists.length),this.prevNode&&this.nextNode?(this.firstNode||(bR.debug("new node is the first node"),this.prevNode.disconnect(),this.prevNode.connect(a),a.connect(this.nextNode)),this.nextNode&&this.lastNode&&(this.lastNode.disconnect(this.nextNode),this.lastNode.connect(a),a.connect(this.nextNode)),this.nodeLists.push(a)):bR.debug("add node is called before inject node connected")}removeNode(a){bR.debug("remove node in inject node, current list:",this.nodeLists.length);const h=this.nodeLists.indexOf(a);if(h===-1)return void bR.debug("$[inject-node] cannot find the node to be removed");const g=this.nodeLists[h+1],j=this.nodeLists[h-1];h===0&&this.prevNode&&this.nextNode&&(this.prevNode.disconnect(a),g?this.prevNode.connect(g):this.prevNode.connect(this.nextNode)),h===this.nodeLists.length-1&&this.nextNode&&j&&(j.disconnect(a),j.connect(this.nextNode)),h!==0&&h!==this.nodeLists.length-1&&(j.disconnect(a),j.connect(g)),bR.debug("remove node in inject node success, current list:",this.nodeLists.length)}}class EW{constructor(){Rl(this,"context",void 0),Rl(this,"analyserNode",void 0),Rl(this,"sourceNode",void 0),this.context=z2(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(a){if(a!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=a,a==null||a.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||x1()||AT()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const a=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(a);else{const g=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(g);for(let j=0;j<a.length;++j)a[j]=g[j]/128-1}const h=Gy(a).call(a,(g,j)=>g+j*j,0)/a.length;return Math.max(10*Math.log10(h)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var a,h;(a=this.sourceNode)===null||a===void 0||a.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(h=this.sourceNode)===null||h===void 0||h.connect(this.analyserNode)}catch{Ll.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class _W extends C_{get processSourceNode(){return this.sourceNode}set processedNode(a){var h;if(!this.isDestroyed&&this._processedNode!==a){try{var g;(g=this.sourceNode)===null||g===void 0||g.disconnect(this.outputNode)}catch{}(h=this._processedNode)===null||h===void 0||h.disconnect(),this._processedNode=a,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),Rl(this,"outputNode",void 0),Rl(this,"outputTrack",void 0),Rl(this,"isPlayed",!1),Rl(this,"sourceNode",void 0),Rl(this,"context",void 0),Rl(this,"audioBufferNode",void 0),Rl(this,"destNode",void 0),Rl(this,"injectNode",void 0),Rl(this,"audioOutputLevel",0),Rl(this,"volumeLevelAnalyser",void 0),Rl(this,"_processedNode",void 0),Rl(this,"playNode",void 0),Rl(this,"isDestroyed",!1),Rl(this,"onNoAudioInput",void 0),Rl(this,"isNoAudioInput",!1),Rl(this,"_noAudioInputCount",0),this.context=z2(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),rO(this.outputNode),this.injectNode=new Hrt,this.volumeLevelAnalyser=new EW}startGetAudioBuffer(a){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(a),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=h=>{this.emit(ay.ON_AUDIO_BUFFER,function(g){for(let j=0;j<g.outputBuffer.numberOfChannels;j+=1){const _e=g.outputBuffer.getChannelData(j);for(let _n=0;_n<_e.length;_n+=1)_e[_n]=0}return g.inputBuffer}(h))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!O1().webAudioMediaStreamDest)throw new Ql(Hl.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(a){this.context.state!=="running"&&mS(()=>{G0.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=a||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(a>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;x1()||AT()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const h=this.volumeLevelAnalyser.getAnalyserNode();let g;h.getFloatTimeDomainData?(g=new Float32Array(h.fftSize),h.getFloatTimeDomainData(g)):(g=new Uint8Array(h.fftSize),h.getByteTimeDomainData(g));let j=!1;for(let _e=0;_e<g.length;_e++)g[_e]!==0&&(j=!0);return j?(this.isNoAudioInput=!1,!0):(await g1(200),await this.checkHasAudioInput(a?a+1:1)&&j)}getAudioVolume(){return this.outputNode.gain.value}setVolume(a){this.outputNode.gain.setValueAtTime(a,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}injectAudioNode(a){this.injectNode.addNode(a)}removeAudioNode(a){this.injectNode.removeNode(a)}disconnect(){var a,h;(a=this.processedNode)===null||a===void 0||a.disconnect(),(h=this.sourceNode)===null||h===void 0||h.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var a;this.processedNode?(a=this.processedNode)===null||a===void 0||a.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class yW extends _W{get isFreeze(){return!1}constructor(a,h,g){var j;if(super(),Rl(this,"sourceNode",void 0),Rl(this,"track",void 0),Rl(this,"clonedTrack",void 0),Rl(this,"audioElement",void 0),Rl(this,"isCurrentTrackCloned",!1),Rl(this,"isRemoteTrack",!1),Rl(this,"originVolumeLevelAnalyser",void 0),Rl(this,"rebuildWebAudio",async()=>{if(Ll.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void Ll.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>Ll.info("resume success")),Ll.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const _o=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?_o.stop():this.isCurrentTrackCloned=!0;const _a=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(_a),rO(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const _r=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(_r,this.context.currentTime),rO(this.outputNode),this.emit(ay.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=_a,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),a.kind!=="audio")throw new Ql(Hl.UNEXPECTED_ERROR);this.track=a;const _e=new MediaStream([this.track]);if(this.isRemoteTrack=!!h,this.sourceNode=this.context.createMediaStreamSource(_e),rO(this.sourceNode),g){const _o=g.clone();_o.enabled=!0,this.clonedTrack=_o,Ll.debug("create an unmuted track ".concat(_o.id," from the original track ").concat(g.id," to get the volume"));const _a=this.context.createMediaStreamSource(new MediaStream([_o]));rO(_a),this.originVolumeLevelAnalyser=new EW,this.originVolumeLevelAnalyser.updateSource(_a)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=_e;const _n=p_();h&&_n.os===_1.IOS&&Number((j=_n.osVersion)===null||j===void 0?void 0:j.split(".")[0])<15&&(G0.on(r1.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(_o=>{_o||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(a){this.sourceNode.disconnect(),this.track=a,this.isCurrentTrackCloned=!1;const h=new MediaStream([a]);this.sourceNode=this.context.createMediaStreamSource(h),rO(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(ay.UPDATE_SOURCE),this.audioElement.srcObject=h}destroy(){var a;this.audioElement.srcObject=null,this.audioElement.remove(),G0.off("state-change",this.rebuildWebAudio),(a=this.originVolumeLevelAnalyser)===null||a===void 0||a.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(a){return this.context.createMediaStreamSource(new MediaStream([a]))}updateOriginTrack(a){const h=a.clone();h.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=h),Ll.debug("create an unmuted track ".concat(h.id," from the original track ").concat(a.id," to get the volume"));const g=this.context.createMediaStreamSource(new MediaStream([h]));rO(g),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(g)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function bW(s,a){const h=(j,_e)=>j?typeof j!="number"?j.max||j.exact||j.ideal||j.min||_e:j:_e,g={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s,maxHeight:h(a.height,1080),maxWidth:h(a.width,1920)}}};return a.frameRate&&typeof a.frameRate!="number"?(g.video.mandatory.maxFrameRate=a.frameRate.max,g.video.mandatory.minFrameRate=a.frameRate.min):typeof a.frameRate=="number"&&(g.video.mandatory.maxFrameRate=a.frameRate),await navigator.mediaDevices.getUserMedia(g)}async function Krt(s){const a=await SW(s.mediaSource),h=await function(g){return new s0((j,_e)=>{const _n=document.createElement("div");_n.innerText="share screen",_n.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const _o=document.createElement("div");_o.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const _a=document.createElement("div");_a.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",_a.setAttribute("style","height: 12%;");const _r=document.createElement("div");_r.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const ba=document.createElement("div");ba.setAttribute("style","text-align: right; padding: 16px 0;");const xa=document.createElement("button");xa.innerHTML="cancel",xa.setAttribute("style","width: 85px;"),xa.onclick=()=>{document.body.removeChild(El);const yl=new Error("NotAllowedError");yl.name="NotAllowedError",_e(yl)},ba.appendChild(xa),_o.appendChild(_a),_o.appendChild(_r),_o.appendChild(ba);const El=document.createElement("div");El.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),El.appendChild(_n),El.appendChild(_o),document.body.appendChild(El),g.map(yl=>{if(yl.id){const Ol=document.createElement("div");Ol.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let Al=yl.thumbnail;const{width:Nl}=Al.getSize();Nl>1920&&(Al=Al.resize({width:1920})),Ol.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+Al.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+(yl.name.replace(/[\u00A0-\u9999<>\&]/g,function(Ml){return"&#"+Ml.charCodeAt(0)+";"})+"</span>"),Ol.onclick=()=>{document.body.removeChild(El),j(yl.id)},_r.appendChild(Ol)}})})}(a);return await bW(h,s)}async function SW(s){let a=["window","screen"];s!=="application"&&s!=="window"||(a=["window"]),s==="screen"&&(a=["screen"]);const h=TW();if(!h)throw new Ql(Hl.ELECTRON_IS_NULL);let g=null;try{var j;g=((j=h.desktopCapturer)===null||j===void 0?void 0:j.getSources({types:a}))||h.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:a})}catch{g=null}g&&g.then||(g=new s0((_e,_n)=>{h.desktopCapturer.getSources({types:a},(_o,_a)=>{_o?_n(_o):_e(_a)})}));try{return await g}catch(_e){throw new Ql(Hl.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,_e.toString())}}let y4=null;function TW(){if(y4)return y4;try{return y4=window.require("electron"),y4}catch{return null}}const l8=new B1("safari");let RW=!1,wW=!1;async function gS(s,a){let h=0,g=null;for(;h<2;)try{g=await zrt(s,a,h>0);break}catch(j){if(j instanceof Ql)throw Ll.error("[".concat(a,"] ").concat(j.toString())),j;const _e=b4(j.name||j.code||j,j.message);if(_e.code===Hl.MEDIA_OPTION_INVALID){Ll.debug("[".concat(a,"] detect media option invalid, retry")),h+=1,await g1(500);continue}throw Ll.error("[".concat(a,"] ").concat(_e.toString())),_e}if(!g)throw new Ql(Hl.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return g}async function zrt(s,a,h){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Ql(Hl.NOT_SUPPORTED,"can not find getUserMedia");h&&(s.video&&(delete s.video.width,delete s.video.height),s.screen&&(delete s.screen.width,delete s.screen.height));const g=O1(),j=new MediaStream;if(s.audioSource&&j.addTrack(s.audioSource),s.videoSource&&j.addTrack(s.videoSource),!s.audio&&!s.video&&!s.screen)return Ll.debug("Using Video Source/ Audio Source"),j;if(s.screen)if(TW())s.screen.sourceId?Y2(j,await bW(s.screen.sourceId,s.screen)):Y2(j,await Krt(s.screen));else if(h6()&&s.screen.extensionId&&s.screen.mandatory){if(!g.getStreamFromExtension)throw new Ql(Hl.NOT_SUPPORTED,"This browser does not support screen sharing");Ll.debug("[".concat(a,'] Screen access on chrome stable, looking for extension"'));const xa=await(_e=s.screen.extensionId,_n=a,new s0((El,yl)=>{try{chrome.runtime.sendMessage(_e,{getStream:!0},Ol=>{if(!Ol||!Ol.streamId)return Ll.error("[".concat(_n,"] No response from Chrome Plugin. Plugin not installed properly"),Ol),void yl(new Ql(Hl.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));El(Ol.streamId)})}catch(Ol){Ll.error("[".concat(_n,"] AgoraRTC screensharing plugin is not accessible(").concat(_e,")"),Ol.toString()),yl(new Ql(Hl.CHROME_PLUGIN_NOT_INSTALL))}}));s.screen.mandatory.chromeMediaSourceId=xa,Y2(j,await navigator.mediaDevices.getUserMedia({video:{mandatory:s.screen.mandatory}}))}else if(g.getDisplayMedia){s.screen.mediaSource&&kq(s.screen.mediaSource);const xa={width:s.screen.width,height:s.screen.height,frameRate:s.screen.frameRate,displaySurface:s.screen.mediaSource==="screen"?"monitor":s.screen.mediaSource};Ll.debug("[".concat(a,"] getDisplayMedia:"),JSON.stringify({video:xa,audio:!!s.screenAudio})),Y2(j,await navigator.mediaDevices.getDisplayMedia({video:xa,audio:!!s.screenAudio}))}else{if(!M_())throw Ll.error("[".concat(a,"] This browser does not support screenSharing")),new Ql(Hl.NOT_SUPPORTED,"This browser does not support screen sharing");{s.screen.mediaSource&&kq(s.screen.mediaSource);const xa={video:{mediaSource:s.screen.mediaSource,width:s.screen.width,height:s.screen.height,frameRate:s.screen.frameRate}};Ll.debug("[".concat(a,"] getUserMedia: ").concat(JSON.stringify(xa))),Y2(j,await navigator.mediaDevices.getUserMedia(xa))}}var _e,_n;if(!s.video&&!s.audio)return j;let _o={video:s.video,audio:s.audio},_a=wp("MEDIA_DEVICE_CONSTRAINTS");if(_a)try{typeof _a=="string"&&(_a=JSON.parse(_a)),_o=function xa(El,yl){if(!Cz(El)||!Cz(yl)||Array.isArray(El)&&!Array.isArray(yl)||!Array.isArray(El)&&Array.isArray(yl))return yl;if(Array.isArray(yl)&&Array.isArray(El)){const Ol=[...El];for(let Al=0;Al<yl.length;Al++)Ol[Al]=xa(El[Al],yl[Al]);return Ol}{const Ol=oO({},El);for(const Al in yl)Object.prototype.hasOwnProperty.call(yl,Al)&&(Object.prototype.hasOwnProperty.call(El,Al)?Ol[Al]=xa(El[Al],yl[Al]):Ol[Al]=yl[Al]);return Ol}}(_o,_a)}catch{}Ll.debug("[".concat(a,"] GetUserMedia"),JSON.stringify(_o)),p_();let _r,ba=null;(iy()||x1()||r4())&&(ba=await l8.lock());try{_r=await navigator.mediaDevices.getUserMedia(_o)}catch(xa){throw ba&&ba(),xa}return _o.audio&&(RW=!0),_o.video&&(wW=!0),Y2(j,_r),ba&&ba(),j}function b4(s,a){switch(s){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new Ql(Hl.MEDIA_OPTION_INVALID,"".concat(s,": ").concat(a));case"NotFoundError":case"DevicesNotFoundError":return new Ql(Hl.DEVICE_NOT_FOUND,"".concat(s,": ").concat(a));case"NotSupportedError":return new Ql(Hl.NOT_SUPPORTED,"".concat(s,": ").concat(a));case"NotReadableError":return new Ql(Hl.NOT_READABLE,"".concat(s,": ").concat(a));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new Ql(Hl.PERMISSION_DENIED,"".concat(s,": ").concat(a));case"ConstraintNotSatisfiedError":return new Ql(Hl.CONSTRAINT_NOT_SATISFIED,"".concat(s,": ").concat(a));default:return Ll.error("getUserMedia unexpected error",s),new Ql(Hl.UNEXPECTED_ERROR,"".concat(s,": ").concat(a))}}function Y2(s,a){const h=s.getVideoTracks()[0],g=s.getAudioTracks()[0],j=a.getVideoTracks()[0],_e=a.getAudioTracks()[0];_e&&(g&&s.removeTrack(g),s.addTrack(_e)),j&&(h&&s.removeTrack(h),s.addTrack(j))}const vy=new class extends C_{get state(){return this._state}set state(s){s!==this._state&&(this.emit(LT.STATE_CHANGE,s),this._state=s)}constructor(){super(),Rl(this,"_state",eO.IDLE),Rl(this,"isAccessMicrophonePermission",!1),Rl(this,"isAccessCameraPermission",!1),Rl(this,"lastAccessMicrophonePermission",!1),Rl(this,"lastAccessCameraPermission",!1),Rl(this,"checkdeviceMatched",!1),Rl(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(wp("ENUMERATE_DEVICES_INTERVAL")||f6()&&_I())&&this.updateDevicesInfo()},wp("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(s=>Ll.error(s.toString()))}async enumerateDevices(s,a){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new Ql(Hl.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const g=await navigator.mediaDevices.enumerateDevices(),j=this.checkMediaDeviceInfoIsOk(g);let _e=!this.isAccessMicrophonePermission&&s,_n=!this.isAccessCameraPermission&&a;j.audio&&(_e=!1),j.video&&(_n=!1);let _o=null,_a=null,_r=null;if(!h&&(_e||_n)){if(l8.isLocked&&(Ll.debug("[device manager] wait GUM lock"),(await l8.lock())(),Ll.debug("[device manager] GUM unlock")),RW&&(_e=!1,this.isAccessMicrophonePermission=!0),wW&&(_n=!1,this.isAccessCameraPermission=!0),Ll.debug("[device manager] check media device permissions",s,a,_e,_n),_e&&_n){try{_r=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(ba){const xa=b4(ba.name||ba.code||ba,ba.message);if(xa.code===Hl.PERMISSION_DENIED)throw xa;Ll.warning("getUserMedia failed in getDevices",xa)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(_e){try{_o=await navigator.mediaDevices.getUserMedia({audio:s})}catch(ba){const xa=b4(ba.name||ba.code||ba,ba.message);if(xa.code===Hl.PERMISSION_DENIED)throw xa;Ll.warning("getUserMedia failed in getDevices",xa)}this.isAccessMicrophonePermission=!0}else if(_n){try{_a=await navigator.mediaDevices.getUserMedia({video:a})}catch(ba){const xa=b4(ba.name||ba.code||ba,ba.message);if(xa.code===Hl.PERMISSION_DENIED)throw xa;Ll.warning("getUserMedia failed in getDevices",xa)}this.isAccessCameraPermission=!0}Ll.debug("[device manager] mic permission",s,"cam permission",a)}try{const ba=await navigator.mediaDevices.enumerateDevices();return _o&&_o.getTracks().forEach(xa=>xa.stop()),_a&&_a.getTracks().forEach(xa=>xa.stop()),_r&&_r.getTracks().forEach(xa=>xa.stop()),_o=null,_a=null,_r=null,ba}catch(ba){return _o&&_o.getTracks().forEach(xa=>xa.stop()),_a&&_a.getTracks().forEach(xa=>xa.stop()),_r&&_r.getTracks().forEach(xa=>xa.stop()),_o=null,_a=null,_r=null,new Ql(Hl.ENUMERATE_DEVICES_FAILED,ba.toString()).throw()}}async getRecordingDevices(){let s=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,s)).filter(a=>a.kind==="audioinput")}async getCamerasDevices(){let s=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,s)).filter(a=>a.kind==="videoinput")}async getSpeakers(){let s=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,s)).filter(a=>a.kind==="audiooutput")}searchDeviceIdByName(s){let a=null;return this.deviceInfoMap.forEach(h=>{h.device.label===s&&(a=h.device.deviceId)}),a}async getDeviceById(s){const a=(await this.enumerateDevices(!0,!0,!0)).find(h=>h.deviceId===s);if(!a)throw new Ql(Hl.DEVICE_NOT_FOUND,"deviceId: ".concat(s));return a}async init(){this.state=eO.INITING;try{await this.updateDevicesInfo(),this.state=eO.INITEND}catch(s){throw Ll.warning("Device Detection functionality cannot start properly.",s.toString()),this.state=eO.IDLE,!function(){return typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1"}()&&new Ql(Hl.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),s}}async updateDevicesInfo(){const s=await this.enumerateDevices(!0,!0,!0),a=Date.now(),h=[];if(s[0]&&s[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const j=s.find(_n=>_n.kind==="audioinput"&&_n.deviceId==="default"),_e=s.find(_n=>_n.kind==="audiooutput"&&_n.deviceId==="default");j&&_e?_e.groupId===j.groupId?Ll.debug("[device-check] default input ".concat(j.label," and output ").concat(_e.label," is the same group")):Ll.warning("[device-check] default input ".concat(j.label," and output ").concat(_e.label," is not the same group")):Ll.debug("[device-check] default input or output not found")}const g=this.checkMediaDeviceInfoIsOk(s);if(s.forEach(j=>{if(!j.deviceId)return;const _e=this.deviceInfoMap.get("".concat(j.kind,"_").concat(j.deviceId));if((_e?_e.state:"INACTIVE")!=="ACTIVE"){const _n={initAt:a,updateAt:a,device:j,state:"ACTIVE"};this.deviceInfoMap.set("".concat(j.kind,"_").concat(j.deviceId),_n),h.push(_n)}_e&&(_e.updateAt=a)}),this.deviceInfoMap.forEach((j,_e)=>{j.state==="ACTIVE"&&j.updateAt!==a&&(j.state="INACTIVE",h.push(j))}),this.state!==eO.INITEND)return g.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(g.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));h.forEach(j=>{switch(j.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(LT.RECORDING_DEVICE_CHANGED,j);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(LT.CAMERA_DEVICE_CHANGED,j);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(LT.PLAYOUT_DEVICE_CHANGED,j)}}),g.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),g.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(s){const a=s.filter(j=>j.kind==="audioinput"),h=s.filter(j=>j.kind==="videoinput"),g={audio:!1,video:!1};for(const j of a)if(j.label&&j.deviceId){g.audio=!0;break}for(const j of h)if(j.label&&j.deviceId){g.video=!0;break}return g}},Yrt=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],Ey=new class{constructor(){Rl(this,"onAutoplayFailed",void 0),Rl(this,"elementMap",new Map),Rl(this,"elementStateMap",new Map),Rl(this,"elementsNeedToResume",[]),Rl(this,"sinkIdMap",new Map),Rl(this,"autoResumeAfterInterruption",()=>{Array.from(this.elementMap.entries()).forEach(s=>{let[a,h]=s;const g=this.elementStateMap.get(a),j=h.srcObject.getAudioTracks()[0];P2()?j&&j.readyState==="live"&&G0.curState==="running"&&(Ll.debug("auto resume after interruption for iOS 15"),h.pause(),h.play()):g&&g==="paused"&&j&&j.readyState==="live"&&G0.curState==="running"&&(Ll.debug("auto resume after interruption for iOS"),h.play())})}),Rl(this,"autoResumeAfterInterruptionOnIOS15",()=>{Array.from(this.elementMap.entries()).forEach(s=>{let[a,h]=s;const g=h.srcObject.getAudioTracks()[0];g&&g.readyState==="live"&&(Ll.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),h.pause(),h.play())})}),this.autoResumeAudioElement(),G0.on(r1.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),G0.on(r1.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),G0.on(r1.STATE_CHANGE,()=>{x1()&&G0.prevState==="suspended"&&G0.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(s,a){const h=this.elementMap.get(s);if(this.sinkIdMap.set(s,a),h)try{await h.setSinkId(a)}catch(g){throw new Ql(Hl.PERMISSION_DENIED,"can not set sink id: "+g.toString())}}play(s,a,h,g){if(this.elementMap.has(a))return;const j=document.createElement("audio");j.autoplay=!0,j.srcObject=new MediaStream([s]),this.bindAudioElementEvents(a,j),this.elementMap.set(a,j),this.elementStateMap.set(a,S1.INIT),this.setVolume(a,h);const _e=this.sinkIdMap.get(a);if(_e)try{j.setSinkId(_e).catch(_o=>{Ll.warning("[".concat(a,"] set sink id failed"),_o.toString())})}catch(_o){Ll.warning("[".concat(a,"] set sink id failed"),_o.toString())}const _n=j.play();_n&&_n.then&&_n.catch(_o=>{g&&d0.autoplayFailed(g,"audio",_o.message,a),Ll.warning("audio element play warning",_o.toString()),this.elementMap.has(a)&&_o.name==="NotAllowedError"&&(Ll.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(j),mS(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),hW()}))})}updateTrack(s,a){const h=this.elementMap.get(s);h&&(h.srcObject=new MediaStream([a]))}isPlaying(s){return this.elementMap.has(s)}setVolume(s,a){const h=this.elementMap.get(s);h&&(a=Math.max(0,Math.min(100,a)),h.volume=a/100)}stop(s){const a=this.elementMap.get(s);if(this.sinkIdMap.delete(s),!a)return;const h=this.elementsNeedToResume.indexOf(a);this.elementsNeedToResume.splice(h,1),a.srcObject=null,a.remove(),this.elementMap.delete(s),this.elementStateMap.delete(s)}bindAudioElementEvents(s,a){Yrt.forEach(h=>{a.addEventListener(h,g=>{const j=this.elementStateMap.get(s),_e=g.type==="pause"?"paused":g.type;if(Ll.debug("[".concat(s,"] audio-element-status change ").concat(j," => ").concat(_e)),g.type==="error"){const _n=a==null?void 0:a.error;_n&&Ll.error("[".concat(s,"] media error, code: ").concat(_n.code,", message: ").concat(_n.message))}this.elementStateMap.set(s,_e)})})}getPlayerState(s){return this.elementStateMap.get(s)||"uninit"}autoResumeAudioElement(){const s=()=>{this.elementsNeedToResume.forEach(a=>{a.play().then(h=>{Ll.debug("Auto resume audio element success")}).catch(h=>{Ll.warning("Auto resume audio element failed!",h)})}),this.elementsNeedToResume=[]};new s0(a=>{document.body?a():window.addEventListener("load",()=>a())}).then(()=>{QL()?document.body.addEventListener("click",s,!0):(document.body.addEventListener("touchstart",s,!0),document.body.addEventListener("mousedown",s,!0))})}};function U_(){return function(s,a,h){const g=h.value;return typeof g=="function"&&(h.value=function(){this._isClosed&&new Ql(Hl.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning");for(var j=arguments.length,_e=new Array(j),_n=0;_n<j;_n++)_e[_n]=arguments[_n];const _o=g.apply(this,_e);return _o instanceof s0?new s0((_a,_r)=>{_o.then(_a).catch(_r)}):_o}),h}}var IW,OW,CW,AW,NW,kW,LW,PW,DW,xW,MW,UW,jW,FW,VW,BW,GW,qW,b_,WW,HW,KW,zW,YW,JW,ZS,XW,QW,$W,ZW,_H,_K,tz,ez,nz,rz,uy,Jrt=By("Array").values,Xrt=LS,Qrt=E1,$rt=Cl,Zrt=Jrt,d8=Array.prototype,tit={DOMTokenList:!0,NodeList:!0},PT=function(s){var a=s.values;return s===d8||$rt(d8,s)&&a===d8.values||Qrt(tit,Xrt(s))?Zrt:a};function iz(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function S4(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?iz(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):iz(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}class oz extends C_{constructor(a){super(),Rl(this,"name","VideoProcessorDestination"),Rl(this,"ID","0"),Rl(this,"_source",void 0),Rl(this,"videoContext",void 0),Rl(this,"inputTrack",void 0),this.videoContext=a}get kind(){return"video"}get enabled(){return!0}pipe(){throw new Ql(Hl.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new Ql(Hl.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(a){if(a.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);a.track&&a.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=a.track,this.emit(I1.ON_TRACK,a.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(I1.ON_TRACK,void 0)}}class sz extends C_{set chained(a){this._chained=a}get chained(){return this._chained}constructor(a,h){super(),Rl(this,"constraintsMap",new Map),Rl(this,"statsRegistry",[]),Rl(this,"usageRegistry",[]),Rl(this,"trackId",void 0),Rl(this,"direction",void 0),Rl(this,"_chained",!1),this.trackId=a,this.direction=h}async getConstraints(){return await A1(this,cy.REQUEST_CONSTRAINTS)}async requestApplyConstraints(a,h){var g;return Ll.info("processor ".concat(h.name," requestApplyConstraints for ").concat(this.trackId)),a&&this.constraintsMap.set(h,a),D_(this,cy.REQUEST_UPDATE_CONSTRAINTS,Array.from(PT(g=this.constraintsMap).call(g)))}async requestRevertConstraints(a){var h;if(this.constraintsMap.has(a))return Ll.info("processor ".concat(a.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(a),D_(this,cy.REQUEST_UPDATE_CONSTRAINTS,Array.from(PT(h=this.constraintsMap).call(h)))}registerStats(a,h,g){this.statsRegistry.find(j=>j.processorID===a.ID&&j.processorName===a.name&&j.type===h)||this.statsRegistry.push({processorName:a.name,processorID:a.ID,type:h,cb:g})}unregisterStats(a,h){const g=this.statsRegistry.findIndex(j=>j.processorID===a.ID&&j.processorName===a.name&&j.type===h);g!==-1&&this.statsRegistry.splice(g,1)}gatherStats(){const a=[];for(const{processorID:h,processorName:g,type:j,cb:_e}of this.statsRegistry)try{const _n=_e();a.push({processorID:h,processorName:g,type:j,stats:_n})}catch(_n){Ll.error(new Ql(Hl.UNEXPECTED_ERROR,_n.message))}return a}registerUsage(a,h){this.usageRegistry.find(g=>g.processorID===a.ID&&g.processorName===a.name)||this.usageRegistry.push({processorID:a.ID,processorName:a.name,cb:h})}unregisterUsage(a){const h=this.usageRegistry.findIndex(g=>g.processorID===a.ID&&g.processorName===a.name);h!==-1&&this.usageRegistry.splice(h,1)}async gatherUsage(){const a=[];if(!this.chained)return[];for(const{cb:h}of this.usageRegistry)try{let g=h();g instanceof s0&&(g=await g),a.push(S4(S4({},g),{},{direction:this.direction}))}catch(g){Ll.error("gather extension usage error",g)}return a}getDirection(){return this.direction}}class az extends C_{constructor(a){super(),Rl(this,"name","AudioProcessorDestination"),Rl(this,"ID","0"),Rl(this,"inputTrack",void 0),Rl(this,"inputNode",void 0),Rl(this,"audioProcessorContext",void 0),Rl(this,"_source",void 0),this.audioProcessorContext=a}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new Ql(Hl.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new Ql(Hl.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(I1.ON_TRACK,void 0),this.emit(I1.ON_NODE,void 0)}updateInput(a){if(a.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);a.track&&this.inputTrack!==a.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=a.track,this.emit(I1.ON_TRACK,this.inputTrack)),a.node&&this.inputNode!==a.node&&(this.audioProcessorContext.chained=!0,this.inputNode=a.node,this.emit(I1.ON_NODE,this.inputNode))}}class cz extends C_{set chained(a){this._chained=a}get chained(){return this._chained}constructor(a,h,g){super(),Rl(this,"constraintsMap",new Map),Rl(this,"statsRegistry",[]),Rl(this,"audioContext",void 0),Rl(this,"trackId",void 0),Rl(this,"direction",void 0),Rl(this,"usageRegistry",[]),Rl(this,"_chained",!1),this.audioContext=a,this.trackId=h,this.direction=g}async getConstraints(){return A1(this,cy.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(a,h){var g;return Ll.info("processor ".concat(h.name," requestApplyConstraints for ").concat(this.trackId)),a&&this.constraintsMap.set(h,a),D_(this,cy.REQUEST_UPDATE_CONSTRAINTS,Array.from(PT(g=this.constraintsMap).call(g)))}async requestRevertConstraints(a){var h;if(this.constraintsMap.has(a))return this.constraintsMap.delete(a),D_(this,cy.REQUEST_UPDATE_CONSTRAINTS,Array.from(PT(h=this.constraintsMap).call(h)))}registerStats(a,h,g){this.statsRegistry.find(j=>j.processorID===a.ID&&j.processorName===a.name&&j.type===h)||this.statsRegistry.push({processorName:a.name,processorID:a.ID,type:h,cb:g})}unregisterStats(a,h){const g=this.statsRegistry.findIndex(j=>j.processorID===a.ID&&j.processorName===a.name&&j.type===h);g!==-1&&this.statsRegistry.splice(g,1)}gatherStats(){const a=[];for(const{processorID:h,processorName:g,type:j,cb:_e}of this.statsRegistry)try{const _n=_e();a.push({processorID:h,processorName:g,type:j,stats:_n})}catch(_n){Ll.error(new Ql(Hl.UNEXPECTED_ERROR,_n.message))}return a}registerUsage(a,h){this.usageRegistry.find(g=>g.processorID===a.ID&&g.processorName===a.name)||this.usageRegistry.push({processorID:a.ID,processorName:a.name,cb:h})}unregisterUsage(a){const h=this.usageRegistry.findIndex(g=>g.processorID===a.ID&&g.processorName===a.name);h!==-1&&this.usageRegistry.splice(h,1)}async gatherUsage(){const a=[];if(!this.chained)return[];for(const{cb:h}of this.usageRegistry)try{let g=h();g instanceof s0&&(g=await g),a.push(S4(S4({},g),{},{direction:this.direction}))}catch(g){Ll.error("gather extension usage error",g)}return a}getDirection(){return this.direction}}class uz extends C_{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),Rl(this,"context",void 0),Rl(this,"processSourceNode",void 0),Rl(this,"outputTrack",void 0),Rl(this,"processedNode",void 0),Rl(this,"clonedTrack",void 0),Rl(this,"outputNode",void 0),this.outputNode=new eit}setVolume(){}createOutputTrack(){throw new Ql(Hl.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class eit{disconnect(){}connect(){}}function lz(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function h8(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?lz(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):lz(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}let C1=(IW=b0({argsMap:(s,a)=>[s.getTrackId(),a],throttleTime:300}),OW=b0({argsMap:(s,a)=>[s.getTrackId(),a]}),CW=U_(),AW=K2("LocalAudioTrack","_enabledMutex"),NW=b0({argsMap:(s,a)=>[s.getTrackId(),a]}),kW=U_(),LW=K2("LocalAudioTrack","_enabledMutex"),PW=b0({argsMap:(s,a)=>[s.getTrackId(),a]}),DW=U_(),xW=U_(),MW=U_(),UW=b0({argsMap:s=>[s.getTrackId()]}),jW=U_(),FW=b0({argsMap:s=>[s.getTrackId()]}),VW=U_(),BW=b0({argsMap:s=>[s.getTrackId()]}),GW=b0({argsMap:(s,a)=>[s.getTrackId(),a.name]}),qW=b0({argsMap:s=>[s.getTrackId()]}),Wp((b_=class extends a8{get isPlaying(){return this._useAudioElement?Ey.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(s,a,h,g){super(s,h),Rl(this,"trackMediaType","audio"),Rl(this,"_encoderConfig",void 0),Rl(this,"_source",void 0),Rl(this,"_enabled",!0),Rl(this,"_volume",100),Rl(this,"_useAudioElement",!1),Rl(this,"_bypassWebAudio",!1),Rl(this,"processor",void 0),Rl(this,"processorContext",void 0),Rl(this,"processorDestination",void 0),Rl(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=a,this._getOriginVolumeLevel=!!g,wp("DISABLE_WEBAUDIO")?(this._source=new uz,this._useAudioElement=!0,this._bypassWebAudio=!0):(this._source=new yW(s,!1,this._getOriginVolumeLevel?s:void 0),wp("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0)),this.processorContext=new cz(this._source.context,this.getTrackId(),"local"),this.processorDestination=new az(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(ay.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setVolume(s){f_(s,"volume",0,1e3),this._volume=s,this._source.setVolume(s/100),this._useAudioElement&&Ey.setVolume(this.getTrackId(),s);try{if(this._bypassWebAudio)return void Ll.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const a=this._source.createOutputTrack();this._mediaStreamTrack!==a&&(this._mediaStreamTrack=a,D_(this,w0.NEED_REPLACE_TRACK,this).then(()=>{Ll.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(h=>{Ll.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),h)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(s){if(!this._useAudioElement)throw new Ql(Hl.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Ey.setSinkID(this.getTrackId(),s)}async setEnabled(s,a,h){return this._setEnabled(s,a,h)}async _setEnabled(s,a,h){if(!h){if(s===this._enabled)return;this.stateCheck("enabled",s)}if(Ll.info("[".concat(this.getTrackId(),"] start setEnabled"),s),s){this._originMediaStreamTrack.enabled=!0;try{h||(this._enabled=!0),await D_(this,w0.NEED_ENABLE_TRACK,this),Ll.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(s," success"))}catch(g){throw h||(this._enabled=!1),Ll.error("[".concat(this.getTrackId(),"] setEnabled to true error"),g.toString()),g}}else{this._originMediaStreamTrack.enabled=!1,h||(this._enabled=!1);try{await D_(this,w0.NEED_DISABLE_TRACK,this)}catch(g){throw h||(this._enabled=!0),Ll.error("[".concat(this.getTrackId(),"] setEnabled to false error"),g.toString()),g}}}async setMuted(s){s!==this._muted&&(this.stateCheck("muted",s),this._muted=s,this._originMediaStreamTrack.enabled=!s,Ll.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(s)),s?await D_(this,w0.NEED_MUTE_TRACK,this):await D_(this,w0.NEED_UNMUTE_TRACK,this))}getStats(){return LP(()=>{Ll.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),tT(this,w0.GET_STATS)||h8({},Y6)}setAudioFrameCallback(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!s)return this._source.removeAllListeners(ay.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(a),this._source.removeAllListeners(ay.ON_AUDIO_BUFFER),this._source.on(ay.ON_AUDIO_BUFFER,h=>s(h))}play(){Ll.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(Ll.debug("[".concat(this.getTrackId(),"] start audio playback in element")),Ey.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){Ll.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Ey.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let s=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];Ll.debug("[".concat(this.getTrackId(),"] update player source track")),s&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Ey.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(s,a){this._originMediaStreamTrack!==s&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),s.addEventListener("ended",this._handleTrackEnded),a&&this._originMediaStreamTrack.stop(),this._originMediaStreamTrack=s,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this.processor.updateInput({track:s,context:this.processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await D_(this,w0.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(s))}renewMediaStreamTrack(s){return s0.resolve(void 0)}pipe(s){if(this._bypassWebAudio)throw new Ql(Hl.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===s)return s;if(s._source)throw new Ql(Hl.INVALID_OPERATION,"Processor ".concat(s.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=s,this.processor._source=this,s.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),s}unpipe(){var s;if(!this.processor)return;const a=this.processor;(s=this._source.processSourceNode)===null||s===void 0||s.disconnect(),this.processor._source=!1,this.processor=void 0,a.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(I1.ON_TRACK,async s=>{s?s!==this._mediaStreamTrack&&(this._mediaStreamTrack=s,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(s),await D_(this,w0.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await D_(this,w0.NEED_REPLACE_TRACK,this))}),this.processorDestination.on(I1.ON_NODE,s=>{this._source.processedNode=s})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(I1.ON_TRACK),this.processorDestination.removeAllListeners(I1.ON_NODE)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(cy.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(cy.REQUEST_CONSTRAINTS)}}).prototype,"setVolume",[IW],Object.getOwnPropertyDescriptor(b_.prototype,"setVolume"),b_.prototype),Wp(b_.prototype,"setPlaybackDevice",[OW,CW],Object.getOwnPropertyDescriptor(b_.prototype,"setPlaybackDevice"),b_.prototype),Wp(b_.prototype,"setEnabled",[AW,NW,kW],Object.getOwnPropertyDescriptor(b_.prototype,"setEnabled"),b_.prototype),Wp(b_.prototype,"setMuted",[LW,PW,DW],Object.getOwnPropertyDescriptor(b_.prototype,"setMuted"),b_.prototype),Wp(b_.prototype,"getStats",[xW],Object.getOwnPropertyDescriptor(b_.prototype,"getStats"),b_.prototype),Wp(b_.prototype,"setAudioFrameCallback",[MW],Object.getOwnPropertyDescriptor(b_.prototype,"setAudioFrameCallback"),b_.prototype),Wp(b_.prototype,"play",[UW,jW],Object.getOwnPropertyDescriptor(b_.prototype,"play"),b_.prototype),Wp(b_.prototype,"stop",[FW,VW],Object.getOwnPropertyDescriptor(b_.prototype,"stop"),b_.prototype),Wp(b_.prototype,"close",[BW],Object.getOwnPropertyDescriptor(b_.prototype,"close"),b_.prototype),Wp(b_.prototype,"pipe",[GW],Object.getOwnPropertyDescriptor(b_.prototype,"pipe"),b_.prototype),Wp(b_.prototype,"unpipe",[qW],Object.getOwnPropertyDescriptor(b_.prototype,"unpipe"),b_.prototype),b_),T4=(WW=b0({argsMap:(s,a)=>[s.getTrackId(),a]}),HW=U_(),KW=K2("MicrophoneAudioTrack","_enabledMutex"),zW=b0({argsMap:(s,a,h)=>[s.getTrackId(),a,h]}),YW=U_(),JW=b0({argsMap:s=>[s.getTrackId()]}),Wp((ZS=class extends C1{get __className__(){return"MicrophoneAudioTrack"}constructor(s,a,h,g){super(s,a.encoderConfig?g4(a.encoderConfig):{},g,wp("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),Rl(this,"_config",void 0),Rl(this,"_deviceName","default"),Rl(this,"_constraints",void 0),Rl(this,"_originalConstraints",void 0),Rl(this,"_enabled",!0),this._config=a,this._constraints=h,this._originalConstraints=h,this._deviceName=s.label,typeof a.bypassWebAudio=="boolean"&&(this._bypassWebAudio=a.bypassWebAudio),P2()&&G0.bindInterruptDetectorTrack(this),this.bindProcessorContextEvents()}async setDevice(s){if(Ll.info("[".concat(this.getTrackId(),"] start set device to ").concat(s)),this._enabled)try{const a=await vy.getDeviceById(s),h={};h.audio=h8({},this._constraints),h.audio.deviceId={exact:s},this._originMediaStreamTrack.stop();let g=null;try{g=await gS(h,this.getTrackId())}catch(j){throw Ll.error("[".concat(this.getTrackId(),"] setDevice failed"),j.toString()),g=await gS({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(g.getAudioTracks()[0],!1),j}await this._updateOriginMediaStreamTrack(g.getAudioTracks()[0],!1),this._deviceName=a.label,this._config.microphoneId=s,this._constraints.deviceId={exact:s}}catch(a){throw Ll.error("[".concat(this.getTrackId(),"] setDevice error"),a.toString()),a}else try{const a=await vy.getDeviceById(s);this._deviceName=a.label,this._config.microphoneId=s,this._constraints.deviceId={exact:s}}catch(a){throw Ll.error("[".concat(this.getTrackId(),"] setDevice error"),a.toString()),a}Ll.info("[".concat(this.getTrackId(),"] set device to ").concat(s," success"))}async setEnabled(s,a,h){if(a)return Ll.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(s);if(!h){if(s===this._enabled)return;this.stateCheck("enabled",s)}if(Ll.info("[".concat(this.getTrackId(),"] start setEnabled"),s),!s){var g;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(g=this._source.clonedTrack)===null||g===void 0||g.stop(),h||(this._enabled=!1);try{await D_(this,w0.NEED_DISABLE_TRACK,this)}catch(_n){throw Ll.error("[".concat(this.getTrackId(),"] setEnabled false failed"),_n.toString()),_n}return}const j=h8({},this._constraints),_e=vy.searchDeviceIdByName(this._deviceName);_e&&!j.deviceId&&(j.deviceId=_e);try{h||(this._enabled=!0);const _n=await gS({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(_n.getAudioTracks()[0],!1),await D_(this,w0.NEED_ENABLE_TRACK,this)}catch(_n){throw h||(this._enabled=!1),Ll.error("[".concat(this.getTrackId(),"] setEnabled true failed"),_n.toString()),_n}Ll.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),P2()&&G0.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((x1()||AT())&&this._enabled&&!this._isClosed&&G0.duringInterruption){const s=async()=>{G0.off(r1.IOS_INTERRUPTION_END,s),this._enabled&&!this._isClosed&&(Ll.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};G0.on(r1.IOS_INTERRUPTION_END,s)}else Ll.debug("[".concat(this.getTrackId(),"] track ended")),this.emit(ER.TRACK_ENDED)}async renewMediaStreamTrack(s){const a=s||this._constraints,h=vy.searchDeviceIdByName(this._deviceName);if(h&&!a.deviceId&&(a.deviceId=h),this._constraints=a,this._enabled){this._originMediaStreamTrack.stop();const g=await gS({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(g.getAudioTracks()[0],!0)}}bindProcessorContextEvents(){this.processorContext.on(cy.REQUEST_UPDATE_CONSTRAINTS,async(s,a,h)=>{try{const g=Object.assign({},this._originalConstraints,...s);await this.renewMediaStreamTrack(g),a()}catch(g){h(g)}}),this.processorContext.on(cy.REQUEST_CONSTRAINTS,async s=>{s(this._originMediaStreamTrack.getSettings())})}}).prototype,"setDevice",[WW,HW],Object.getOwnPropertyDescriptor(ZS.prototype,"setDevice"),ZS.prototype),Wp(ZS.prototype,"setEnabled",[KW,zW,YW],Object.getOwnPropertyDescriptor(ZS.prototype,"setEnabled"),ZS.prototype),Wp(ZS.prototype,"close",[JW],Object.getOwnPropertyDescriptor(ZS.prototype,"close"),ZS.prototype),ZS),nit=(XW=b0({argsMap:(s,a)=>[s.getTrackId(),a,s.duration]}),QW=U_(),$W=b0({argsMap:s=>[s.getTrackId()]}),ZW=U_(),_H=b0({argsMap:s=>[s.getTrackId()]}),_K=U_(),tz=b0({argsMap:s=>[s.getTrackId()]}),ez=U_(),nz=b0({argsMap:s=>[s.getTrackId()]}),rz=U_(),Wp((uy=class extends C1{get __className__(){return"BufferSourceAudioTrack"}constructor(s,a,h,g){super(a.createOutputTrack(),h,g),Rl(this,"source",void 0),Rl(this,"_bufferSource",void 0),this.source=s,this._bufferSource=a,this._bufferSource.on(ay.AUDIO_SOURCE_STATE_CHANGE,j=>{this.emit(ER.SOURCE_STATE_CHANGE,j)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(s){s&&this._bufferSource.updateOptions(s),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(s){this._bufferSource.seekAudioBuffer(s)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}}).prototype,"startProcessAudioBuffer",[XW,QW],Object.getOwnPropertyDescriptor(uy.prototype,"startProcessAudioBuffer"),uy.prototype),Wp(uy.prototype,"pauseProcessAudioBuffer",[$W,ZW],Object.getOwnPropertyDescriptor(uy.prototype,"pauseProcessAudioBuffer"),uy.prototype),Wp(uy.prototype,"seekAudioBuffer",[_H,_K],Object.getOwnPropertyDescriptor(uy.prototype,"seekAudioBuffer"),uy.prototype),Wp(uy.prototype,"resumeProcessAudioBuffer",[tz,ez],Object.getOwnPropertyDescriptor(uy.prototype,"resumeProcessAudioBuffer"),uy.prototype),Wp(uy.prototype,"stopProcessAudioBuffer",[nz,rz],Object.getOwnPropertyDescriptor(uy.prototype,"stopProcessAudioBuffer"),uy.prototype),uy);class Yy extends C1{get __className__(){return"MixingAudioTrack"}get isActive(){for(const a of this.trackList)if(a._enabled&&!a._isClosed&&!a.muted)return!0;return!1}constructor(){const a=z2().createMediaStreamDestination();super(a.stream.getAudioTracks()[0],void 0,N_(8,"track-mix-")),Rl(this,"trackList",void 0),Rl(this,"destNode",void 0);try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=a,this.trackList=[]}hasAudioTrack(a){return this.trackList.indexOf(a)!==-1}addAudioTrack(a){this.trackList.indexOf(a)===-1?(Ll.debug("add ".concat(a.getTrackId()," to mixing track")),a._source.outputNode.connect(this.destNode),this.trackList.push(a),this.updateEncoderConfig()):Ll.debug("track ".concat(a.getTrackId()," is already added"))}removeAudioTrack(a){if(this.trackList.indexOf(a)!==-1){Ll.debug("remove ".concat(a.getTrackId()," from mixing track"));try{a._source.outputNode.disconnect(this.destNode)}catch{}g8(this.trackList,a),this.updateEncoderConfig()}}updateEncoderConfig(){const a={};this.trackList.forEach(h=>{h._encoderConfig&&((h._encoderConfig.bitrate||0)>(a.bitrate||0)&&(a.bitrate=h._encoderConfig.bitrate),(h._encoderConfig.sampleRate||0)>(a.sampleRate||0)&&(a.sampleRate=h._encoderConfig.sampleRate),(h._encoderConfig.sampleSize||0)>(a.sampleSize||0)&&(a.sampleSize=h._encoderConfig.sampleSize),h._encoderConfig.stereo&&(a.stereo=!0))}),this._encoderConfig=a}}class rit extends C_{constructor(){super(...arguments),Rl(this,"resultStorage",new Map)}setLocalAudioStats(a,h,g){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",a,this.checkAudioInputLevel(g,h)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",a,this.checkSendAudioBitrate(g,h))}setLocalVideoStats(a,h,g){this.record("SEND_VIDEO_BITRATE_TOO_LOW",a,this.checkSendVideoBitrate(g,h)),this.record("FRAMERATE_INPUT_TOO_LOW",a,this.checkFramerateInput(g,h)),this.record("FRAMERATE_SENT_TOO_LOW",a,this.checkFramerateSent(g))}setRemoteAudioStats(a,h){const g=a.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",g,this.checkAudioOutputLevel(h))}setRemoteVideoStats(a,h){const g=a.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",g,this.checkVideoDecode(h))}record(a,h,g){this.resultStorage.has(a)||this.resultStorage.set(a,{result:[],isPrevNormal:!0});const j=this.resultStorage.get(a);if(j&&(j.result.push(g),j.result.length>=5)){const _e=j.result.includes(!0);j.isPrevNormal&&!_e&&this.emit("exception",dz[a],a,h),!j.isPrevNormal&&_e&&this.emit("exception",dz[a]+2e3,a+"_RECOVER",h),j.isPrevNormal=_e,j.result=[]}}checkAudioOutputLevel(a){return!(a.receiveBitrate>0&&a.receiveLevel===0)}checkAudioInputLevel(a,h){return h instanceof Yy&&!h.isActive||!!h.muted||a.sendVolumeLevel!==0}checkFramerateInput(a,h){let g=null;h._encoderConfig&&h._encoderConfig.frameRate&&(g=xT(h._encoderConfig.frameRate));const j=a.captureFrameRate;return!g||!j||!(g>10&&j<5||g<10&&g>=5&&j<=1)}checkFramerateSent(a){return!(a.captureFrameRate&&a.sendFrameRate&&a.captureFrameRate>5&&a.sendFrameRate<=1)}checkSendVideoBitrate(a,h){return!!h.muted||a.sendBitrate!==0}checkSendAudioBitrate(a,h){return h instanceof Yy&&!h.isActive||!!h.muted||a.sendBitrate!==0}checkVideoDecode(a){return a.receiveBitrate===0||a.decodeFrameRate!==0}}const dz={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},Jy=new class{markSubscribeStart(s,a){performance.mark("agora-web-sdk/".concat(s,"/subscribe-").concat(a))}markPublishStart(s,a){performance.mark("agora-web-sdk/".concat(s,"/publish-").concat(a))}measureFromSubscribeStart(s,a){const h=performance.getEntriesByName("agora-web-sdk/".concat(s,"/subscribe-").concat(a));if(h.length>0){const g=h[h.length-1];return Math.round(performance.now()-g.startTime)}return 0}measureFromPublishStart(s,a){const h=performance.getEntriesByName("agora-web-sdk/".concat(s,"/publish-").concat(a));if(h.length>0){const g=h[h.length-1];return Math.round(performance.now()-g.startTime)}return 0}};function hz(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function iO(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?hz(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):hz(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}class J2{constructor(a){Rl(this,"store",void 0),Rl(this,"onStatsException",void 0),Rl(this,"onUploadPublishDuration",void 0),Rl(this,"localStats",new Map),Rl(this,"remoteStats",new Map),Rl(this,"updateStatsInterval",void 0),Rl(this,"trafficStats",void 0),Rl(this,"trafficStatsPeerList",[]),Rl(this,"uplinkStats",void 0),Rl(this,"exceptionMonitor",void 0),Rl(this,"p2pChannel",void 0),Rl(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=a,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new rit,this.exceptionMonitor.on("exception",(h,g,j)=>{this.onStatsException&&this.onStatsException(h,g,j)})}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(a0.LocalAudioTrack)||iO({},Y6)}getLocalVideoTrackStats(){return this.localStats.get(a0.LocalVideoTrack)||iO({},J6)}getRemoteAudioTrackStats(a){const h=(_e,_n)=>{if(!this.trafficStats)return _n;const _o=this.trafficStats.peer_delay.find(_a=>_a.peer_uid===_e);return _o&&(_n.publishDuration=_o.B_ppad+(Date.now()-this.trafficStats.timestamp)),_n},g={};if(a){var j;const _e=(j=this.remoteStats.get(a))===null||j===void 0?void 0:j.audioStats;_e&&(g[a]=h(a,_e))}else Array.from(this.remoteStats.entries()).forEach(_e=>{let[_n,{audioStats:_o}]=_e;_o&&(g[_n]=h(_n,_o))});return g}getRemoteNetworkQualityStats(a){const h={};if(a){var g;const j=(g=this.remoteStats.get(a))===null||g===void 0?void 0:g.networkStats;j&&(h[a]=j)}else Array.from(this.remoteStats.entries()).forEach(j=>{let[_e,{networkStats:_n}]=j;_n&&(h[_e]=_n)});return h}getRemoteVideoTrackStats(a){const h=(_e,_n)=>{if(!this.trafficStats)return _n;const _o=this.trafficStats.peer_delay.find(_a=>_a.peer_uid===_e);return _o&&(_n.publishDuration=_o.B_ppvd+(Date.now()-this.trafficStats.timestamp)),_n},g={};if(a){var j;const _e=(j=this.remoteStats.get(a))===null||j===void 0?void 0:j.videoStats;_e&&(g[a]=h(a,_e))}else Array.from(this.remoteStats.entries()).forEach(_e=>{let[_n,{videoStats:_o}]=_e;_o&&(g[_n]=h(_n,_o))});return g}getRTCStats(){let a=0,h=0,g=0,j=0;const _e=this.localStats.get(a0.LocalAudioTrack);_e&&(a+=_e.sendBytes,h+=_e.sendBitrate);const _n=this.localStats.get(a0.LocalVideoTrack);_n&&(a+=_n.sendBytes,h+=_n.sendBitrate);const _o=this.localStats.get(a0.LocalVideoLowTrack);_o&&(a+=_o.sendBytes,h+=_o.sendBitrate),this.remoteStats.forEach(_r=>{let{audioStats:ba,videoStats:xa}=_r;ba&&(g+=ba.receiveBytes,j+=ba.receiveBitrate),xa&&(g+=xa.receiveBytes,j+=xa.receiveBitrate)});let _a=1;return this.trafficStats&&(_a+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:_a,SendBitrate:h,SendBytes:a,RecvBytes:g,RecvBitrate:j,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(a){this.localStats.set(a,void 0)}removeLocalStats(a){a?this.localStats.delete(a):this.localStats.clear()}addRemoteStats(a){this.remoteStats.set(a,{})}removeRemoteStats(a){a?this.remoteStats.delete(a):this.remoteStats.clear()}addP2PChannel(a){this.p2pChannel=a}updateTrafficStats(a){a.peer_delay=a.peer_delay.filter(h=>h.B_ppad!==void 0||h.B_ppvd!==void 0),a.peer_delay.filter(h=>this.trafficStatsPeerList.indexOf(h.peer_uid)===-1).forEach(h=>{var g;const j=(g=this.p2pChannel)===null||g===void 0?void 0:g.getRemoteMedia(h.peer_uid),_e=j!=null&&j.videoSSRC?Jy.measureFromSubscribeStart(this.store.clientId,j.videoSSRC):0,_n=j!=null&&j.audioSSRC?Jy.measureFromSubscribeStart(this.store.clientId,j.audioSSRC):0;h.B_ppad!==void 0&&h.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(h.peer_uid,h.B_ppad,h.B_ppvd,_e>_n?_e:_n),this.trafficStatsPeerList.push(h.peer_uid))}),this.trafficStats=a}updateUplinkStats(a){this.uplinkStats&&this.uplinkStats.B_fir!==a.B_fir&&Ll.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(a.B_fir)),this.uplinkStats=a}static isRemoteVideoFreeze(a,h,g){if(!a)return!1;const j=!!g&&h.framesDecodeFreezeTime>g.framesDecodeFreezeTime,_e=!g||h.framesDecodeCount>g.framesDecodeCount;return j||!_e}static isRemoteAudioFreeze(a){return!!a&&a._isFreeze()}isLocalVideoFreeze(a){return!(!a.inputFrame||!a.sentFrame)&&a.inputFrame.frameRate>5&&a.sentFrame.frameRate<3}updateLocalStats(a){Array.from(this.localStats.entries()).forEach(h=>{let[g,j]=h;switch(g){case a0.LocalVideoTrack:case a0.LocalVideoLowTrack:{const _e=j,_n=iO({},J6),_o=a.getStats(),_a=a.getLocalMedia(g);if(_o){const _r=_o.videoSend.find(ba=>ba.ssrc===(_a==null?void 0:_a.ssrcs[0].ssrcId));if(_r){const ba=a.getLocalVideoSize(),xa=a.getEncoderConfig(a0.LocalVideoTrack);_r.codec!=="H264"&&_r.codec!=="VP8"&&_r.codec!=="VP9"&&_r.codec!=="AV1X"&&_r.codec!=="AV1"||(_n.codecType=_r.codec),_n.sendBytes=_r.bytes,_n.sendBitrate=_e?8*Math.max(0,_n.sendBytes-_e.sendBytes):0,_r.inputFrame?(_n.captureFrameRate=_r.inputFrame.frameRate,_n.captureResolutionHeight=_r.inputFrame.height,_n.captureResolutionWidth=_r.inputFrame.width):ba&&(_n.captureResolutionWidth=ba.width,_n.captureResolutionHeight=ba.height),_r.sentFrame?(_n.sendFrameRate=_r.sentFrame.frameRate,_n.sendResolutionHeight=_r.sentFrame.height,_n.sendResolutionWidth=_r.sentFrame.width):ba&&(_n.sendResolutionWidth=ba.width,_n.sendResolutionHeight=ba.height),_r.avgEncodeMs&&(_n.encodeDelay=_r.avgEncodeMs),xa&&xa.bitrateMax&&(_n.targetSendBitrate=1e3*xa.bitrateMax),_n.sendPackets=_r.packets,_n.sendPacketsLost=_r.packetsLost,_n.totalDuration=_e?_e.totalDuration+1:1,_n.totalFreezeTime=_e?_e.totalFreezeTime:0,this.isLocalVideoFreeze(_r)&&(_n.totalFreezeTime+=1)}this.trafficStats&&(_n.sendPacketsLost=this.trafficStats.B_pvlr4/100)}this.localStats.set(g,_n),_n&&_a&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,_a.track,_n);break}case a0.LocalAudioTrack:{const _e=j,_n=iO({},Y6),_o=a.getStats(),_a=a.getLocalMedia(g);if(_o){const _r=_o.audioSend.find(ba=>ba.ssrc===(_a==null?void 0:_a.ssrcs[0].ssrcId));if(_r){if(_r.codec!=="opus"&&_r.codec!=="aac"&&_r.codec!=="PCMU"&&_r.codec!=="PCMA"&&_r.codec!=="G722"||(_n.codecType=_r.codec),_r.inputLevel)_n.sendVolumeLevel=Math.round(32767*_r.inputLevel);else{const ba=a.getLocalAudioVolume();ba&&(_n.sendVolumeLevel=Math.round(32767*ba))}_n.sendBytes=_r.bytes,_n.sendPackets=_r.packets,_n.sendPacketsLost=_r.packetsLost,_n.sendBitrate=_e?8*Math.max(0,_n.sendBytes-_e.sendBytes):0}}this.trafficStats&&(_n.sendPacketsLost=this.trafficStats.B_pvlr4/100),this.localStats.set(a0.LocalAudioTrack,_n),_n&&_a&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,_a.track,_n);break}}})}updateRemoteStats(a){Array.from(this.remoteStats.entries()).forEach(h=>{let[g,{videoStats:j,audioStats:_e,videoPcStats:_n}]=h;const _o=_e,_a=j,_r=_n,ba=iO({},mq),xa=iO({},vq),El=iO({},Mnt),{audioTrack:yl,videoTrack:Ol,audioSSRC:Al,videoSSRC:Nl}=a.getRemoteMedia(g),Ml=a.getStats(),Fl=Ml==null?void 0:Ml.audioRecv.find(Tp=>Tp.ssrc===Al),up=Ml==null?void 0:Ml.videoRecv.find(Tp=>Tp.ssrc===Nl),_p=this.trafficStats&&this.trafficStats.peer_delay.find(Tp=>Tp.peer_uid===g);if(Fl&&(Fl.codec!=="opus"&&Fl.codec!=="aac"&&Fl.codec!=="PCMU"&&Fl.codec!=="PCMA"&&Fl.codec!=="G722"||(ba.codecType=Fl.codec),Fl.outputLevel?ba.receiveLevel=Math.round(32767*Fl.outputLevel):yl&&(ba.receiveLevel=Math.round(32767*yl.getVolumeLevel())),ba.receiveBytes=Fl.bytes,ba.receivePackets=Fl.packets,ba.receivePacketsLost=Fl.packetsLost,ba.packetLossRate=ba.receivePacketsLost/(ba.receivePackets+ba.receivePacketsLost),ba.receiveBitrate=_o?8*Math.max(0,ba.receiveBytes-_o.receiveBytes):0,ba.totalDuration=_o?_o.totalDuration+1:1,ba.totalFreezeTime=_o?_o.totalFreezeTime:0,ba.freezeRate=ba.totalFreezeTime/ba.totalDuration,ba.receiveDelay=Fl.jitterBufferMs,ba.totalDuration>10&&J2.isRemoteAudioFreeze(yl)&&(ba.totalFreezeTime+=1)),up){up.codec!=="H264"&&up.codec!=="VP8"&&up.codec!=="VP9"&&up.codec!=="AV1X"&&up.codec!=="AV1"||(xa.codecType=up.codec),xa.receiveBytes=up.bytes,xa.receiveBitrate=_a?8*Math.max(0,xa.receiveBytes-_a.receiveBytes):0,xa.decodeFrameRate=up.decodeFrameRate<0?0:up.decodeFrameRate,xa.renderFrameRate=up.decodeFrameRate<0?0:up.decodeFrameRate,up.outputFrame&&(xa.renderFrameRate=up.outputFrame.frameRate),up.receivedFrame?(xa.receiveFrameRate=up.receivedFrame.frameRate,xa.receiveResolutionHeight=up.receivedFrame.height,xa.receiveResolutionWidth=up.receivedFrame.width):Ol&&(xa.receiveResolutionHeight=Ol._videoHeight||0,xa.receiveResolutionWidth=Ol._videoWidth||0),up.framesRateFirefox!==void 0&&(xa.receiveFrameRate=Math.round(up.framesRateFirefox)),xa.receivePackets=up.packets,xa.receivePacketsLost=up.packetsLost,xa.packetLossRate=xa.receivePacketsLost/(xa.receivePackets+xa.receivePacketsLost),xa.totalDuration=_a?_a.totalDuration+1:1,xa.totalFreezeTime=_a?_a.totalFreezeTime:0,xa.receiveDelay=up.jitterBufferMs||0;const Tp=!!Nl&&a.getRemoteVideoIsReady(Nl);Ol&&Tp&&J2.isRemoteVideoFreeze(Ol,up,_r)&&(xa.totalFreezeTime+=1),xa.freezeRate=xa.totalFreezeTime/xa.totalDuration}_p&&(ba.end2EndDelay=_p.B_ad,xa.end2EndDelay=_p.B_vd,ba.transportDelay=_p.B_ed,xa.transportDelay=_p.B_ed,ba.currentPacketLossRate=_p.B_ealr4/100,xa.currentPacketLossRate=_p.B_evlr4/100,El.uplinkNetworkQuality=_p.B_punq?_p.B_punq:0,El.downlinkNetworkQuality=_p.B_pdnq?_p.B_pdnq:0),this.remoteStats.set(g,{audioStats:ba,videoStats:xa,videoPcStats:up,networkStats:El}),yl&&this.exceptionMonitor.setRemoteAudioStats(yl,ba),Ol&&this.exceptionMonitor.setRemoteVideoStats(Ol,xa)})}}const DT=new class extends C_{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),Rl(this,"_lastHiddenTime",0),Rl(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),Ll.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};function pz(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function R4(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?pz(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):pz(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}function w4(s){return s.match(/^[\.\:\d]+$/)?"".concat(s.replace(/[^\d]/g,"-"),".").concat(wp("TURN_DOMAIN")):(Ll.info("Cannot recognized as IP address ".concat(s,". Used As Host instead")),s)}function fz(s,a){var h,g;const j=wp("GATEWAY_DOMAINS");let _e=j[1]&&a.indexOf(j[1])!==-1?1:0;s.addresses=s.addresses||[];const _n=s.addresses.map(_a=>_a.domain_prefix?{address:"".concat(_a.domain_prefix,".").concat(j[_e++%j.length],":").concat(_a.port)}:_a.ip.match(/^[\.\:\d]+$/)?{ip:_a.ip,port:_a.port,address:"".concat(_a.ip.replace(/[^\d]/g,"-"),".").concat(j[_e++%j.length],":").concat(_a.port)}:(Ll.info("Cannot recognized as IP address ".concat(_a.ip,". Used As Host instead")),{ip:_a.ip,port:_a.port,address:"".concat(_a.ip,":").concat(_a.port)}));if((h=s.detail)!==null&&h!==void 0&&h[18]&&typeof((g=s.detail)===null||g===void 0?void 0:g[18])=="string"){const _a=s.detail[18],_r=_a==null?void 0:_a.split(";");for(let ba=0;ba<_r.length;ba++){var _o;const xa=OT(_o=_r[ba]).call(_o);_n[ba]&&xa&&(_n[ba].ip6=xa)}}return{gatewayAddrs:_n,uid:s.uid,cid:s.cid,cert:s.cert,vid:s.detail&&s.detail[8],uni_lbs_ip:s.detail&&s.detail[1],res:s,csIp:s.detail&&s.detail[502]}}function xT(s){return typeof s=="number"?s:s.exact||s.ideal||s.max||s.min||0}function gz(s){const a=s._encoderConfig;if(!a)return{};const h={resolution:a.width&&a.height?"".concat(xT(a.width),"x").concat(xT(a.height)):void 0,maxVideoBW:a.bitrateMax,minVideoBW:a.bitrateMin};return typeof a.frameRate=="number"?(h.maxFrameRate=a.frameRate,h.minFrameRate=a.frameRate):a.frameRate&&(h.maxFrameRate=a.frameRate.max||a.frameRate.ideal||a.frameRate.exact||a.frameRate.min,h.minFrameRate=a.frameRate.min||a.frameRate.ideal||a.frameRate.exact||a.frameRate.max),h}function mz(s,a,h){var g;const j=a.videoSend.find(_o=>_o.ssrc===s);if(!j)return null;const _e=h==null||(g=h.videoSend.find(_o=>_o.ssrc===s))===null||g===void 0?void 0:g.inputFrame,_n={id:N_(10,""),timestamp:new Date(a.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:j.ssrc.toString()};return j.inputFrame&&(_e&&j.inputFrame.height===_e.height||(_n.A_fhi=j.inputFrame.height?j.inputFrame.height.toString():"0"),_e&&j.inputFrame.width===_e.width||(_n.A_fwi=j.inputFrame.width?j.inputFrame.width.toString():"0"),_e&&j.inputFrame.frameRate===_e.frameRate||(_n.A_fri=j.inputFrame.frameRate?j.inputFrame.frameRate.toString():"0")),_n}function vz(s){return s>=0&&s<.17?1:s>=.17&&s<.36?2:s>=.36&&s<.59?3:s>=.59&&s<=1?4:s>1?5:0}function p8(s,a){let h,g,j;switch(a){case n1.CHOOSE_SERVER:h=4096,g="choose server";break;case n1.CLOUD_PROXY:h=1048576,g="proxy";break;case n1.CLOUD_PROXY_5:h=4194304,g="proxy5";break;case n1.CLOUD_PROXY_FALLBACK:h=4194310,g="proxy fallback";break;default:throw new Ql(Hl.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:s.detail&&s.detail[502],retry:!1})}if(s.response_body.forEach(_e=>{_e.buffer&&_e.buffer.flag===h&&(j={code:_e.buffer.code,addresses:(_e.buffer.edges_services||[]).map(_n=>R4(R4({},_n),{},{ticket:_e.buffer.cert})),server_ts:s.enter_ts,uid:_e.buffer.uid,cid:_e.buffer.cid,cname:_e.buffer.cname,detail:R4(R4({},_e.buffer.detail),s.detail),flag:_e.buffer.flag,opid:s.opid,cert:_e.buffer.cert})}),!j)throw new Ql(Hl.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(g," from multi unilbs response"),{csIp:s.detail&&s.detail[502]});return j}async function iit(s,a){return await s0.all(s.addresses.map(async h=>({address:w4(h.ip),tcpport:h.port,udpport:h.port,username:a&&wp("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?a.toString():Cy.username,password:a&&wp("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await Grt(a.toString()):Cy.password})))}function oit(s,a){const h=a._videoWidth||a.getMediaStreamTrack(!0).getSettings().width;return h||Ll.warning("cannot get original video track's width, default scale down 4 times for low stream"),h?h/xT(s.width):4}function I4(s){let{candidateType:a,relayProtocol:h,type:g,address:j,port:_e,protocol:_n}=s;return g==="local-candidate"?{candidateType:a,relayProtocol:h,protocol:_n}:{candidateType:a,relayProtocol:h,address:j,port:_e,protocol:_n}}function Ez(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function oO(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?Ez(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):Ez(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}function X2(s){return window.TextEncoder?new TextEncoder().encode(s).length:s.length}function g1(s){return new s0(a=>{window.setTimeout(a,s)})}function sit(s){const a=new Ql(Hl.TIMEOUT,"timeout");return new s0((h,g)=>{window.setTimeout(()=>g(a),s)})}function N_(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,a=arguments.length>1?arguments[1]:void 0;const h=Math.random().toString(16).substr(2,s).toLowerCase();return h.length===s?"".concat(a).concat(h):"".concat(a).concat(h)+N_(s-h.length,"")}function f8(){return N_(32,"").toUpperCase()}const O4=()=>{};function _z(s){return new s0((a,h)=>{let g=!1;const j=document.createElement("video");j.setAttribute("autoplay",""),j.setAttribute("muted",""),j.muted=!0,j.autoplay=!0,j.setAttribute("playsinline",""),j.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(j);const _e=x1()?"canplay":"playing";j.addEventListener(_e,()=>{const _n=j.videoWidth,_o=j.videoHeight;!_n&&M_()||(g=!0,j.srcObject=null,j.remove(),a([_n,_o]))}),j.srcObject=new MediaStream([s]),j.play().catch(O4),setTimeout(()=>{g||(j.srcObject=null,j.remove(),a([j.videoWidth,j.videoHeight]))},4e3)})}function Q2(s){return s0.all(s.map(a=>a.then(h=>{throw h},h=>h))).then(a=>{throw a},a=>a)}function A1(s,a){for(var h=arguments.length,g=new Array(h>2?h-2:0),j=2;j<h;j++)g[j-2]=arguments[j];return s.getListeners(a).length===0?s0.reject(new Ql(Hl.UNEXPECTED_ERROR,"can not emit promise")):new s0((_e,_n)=>{s.emit(a,...g,_e,_n)})}function D_(s,a){if(s.getListeners(a).length===0)return s0.resolve();for(var h=arguments.length,g=new Array(h>2?h-2:0),j=2;j<h;j++)g[j-2]=arguments[j];return A1(s,a,...g)}function tT(s,a){if(s.getListeners(a).length===0)return null;for(var h=arguments.length,g=new Array(h>2?h-2:0),j=2;j<h;j++)g[j-2]=arguments[j];return sO(s,a,...g)}function sO(s,a){let h=null,g=null;for(var j=arguments.length,_e=new Array(j>2?j-2:0),_n=2;_n<j;_n++)_e[_n-2]=arguments[_n];if(s.emit(a,..._e,_o=>{h=_o},_o=>{g=_o}),g!==null)throw g;if(h===null)throw new Ql(Hl.UNEXPECTED_ERROR,"handler is not sync");return h}function g8(s,a){const h=s.indexOf(a);h!==-1&&s.splice(h,1)}function yz(s){const a=[];return s.forEach(h=>{a.indexOf(h)===-1&&a.push(h)}),a}function mS(s){s0.resolve().then(s)}function W_(s){return JSON.parse(JSON.stringify(s))}const bz={};function LP(s,a){bz[a]||(bz[a]=!0,s())}function m8(s){const a=window.atob(s),h=new Uint8Array(new ArrayBuffer(a.length));for(let g=0;g<a.length;g+=1)h[g]=a.charCodeAt(g);return h}function C4(s){let a="";for(let h=0;h<s.length;h+=1)a+=String.fromCharCode(s[h]);return window.btoa(a)}const wz=new class{constructor(){Rl(this,"fnMap",new Map)}throttleByKey(s,a,h,g){for(var j=arguments.length,_e=new Array(j>4?j-4:0),_n=4;_n<j;_n++)_e[_n-4]=arguments[_n];if(this.fnMap.has(a)){const _o=this.fnMap.get(a);if(_o.threshold!==h){_o.fn(..._o.args),clearTimeout(_o.timer);const _a=window.setTimeout(()=>{const _r=this.fnMap.get(a);_r&&_r.fn(..._r.args),this.fnMap.delete(a)},h);this.fnMap.set(a,{fn:s,threshold:h,timer:_a,args:_e,skipFn:g})}else _o.skipFn&&_o.skipFn(..._o.args),this.fnMap.set(a,oO(oO({},_o),{},{fn:s,args:_e,skipFn:g}))}else{const _o=window.setTimeout(()=>{const _a=this.fnMap.get(a);_a&&_a.fn(..._a.args),this.fnMap.delete(a)},h);this.fnMap.set(a,{fn:s,threshold:h,timer:_o,args:_e,skipFn:g})}}},Iz=wz.throttleByKey.bind(wz),PP=async s=>{let{fragementLength:a,referenceList:h,asyncMapHandler:g,allFailedhandler:j,promisesCollector:_e}=s,_n=0;const _o=a;let _a,_r=0;const ba=async()=>{const xa=(()=>{const El=_n*_o,yl=El+_o;return h.slice(El,yl).map(g)})();_e&&_e.push(...xa);try{_a=await Q2(xa)}catch(El){if(_r+=_o,_n++,!(_r>=h.length))return void await ba();j(El)}xa.forEach(El=>El.cancel())};return await ba(),_a};function Cz(s){return typeof s=="object"&&s!==null&&!(s instanceof RegExp)}var ait=_,cit=y0("iterator"),Az=!ait(function(){var s=new URL("b?a=1&b=2&c=3","http://a"),a=s.searchParams,h="";return s.pathname="c%20d",a.forEach(function(g,j){a.delete("b"),h+=j+g}),!s.toJSON||!a.sort||s.href!=="http://a/c%20d?a=1&c=3"||a.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!a[cit]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://").host!=="xn--e1aybc"||new URL("http://a#").hash!=="#%D0%B1"||h!=="a1c3"||new URL("http://x",void 0).host!=="x"}),kz=Kp,uit=Tl,lit=I0,dit=_,v8=wy,hit=ty,pit=Cp,fit=Uy,git=L1,$2=Object.assign,Lz=Object.defineProperty,mit=uit([].concat),vit=!$2||dit(function(){if(kz&&$2({b:1},$2(Lz({},"a",{enumerable:!0,get:function(){Lz(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var s={},a={},h=Symbol(),g="abcdefghijklmnopqrst";return s[h]=7,g.split("").forEach(function(j){a[j]=j}),$2({},s)[h]!=7||v8($2({},a)).join("")!=g})?function(s,a){for(var h=fit(s),g=arguments.length,j=1,_e=hit.f,_n=pit.f;g>j;)for(var _o,_a=git(arguments[j++]),_r=_e?mit(v8(_a),_e(_a)):v8(_a),ba=_r.length,xa=0;ba>xa;)_o=_r[xa++],kz&&!lit(_n,_a,_o)||(h[_o]=_a[_o]);return h}:$2,Eit=$1,_it=aM,yit=sS,bit=I0,Sit=Uy,Tit=function(s,a,h,g){try{return g?a(Eit(h)[0],h[1]):a(h)}catch(j){_it(s,"throw",j)}},Rit=tM,wit=D0,Iit=cS,Dz=m4,Oit=vT,Cit=mT,xz=Dl.Array,aO=Tl,E8=2147483647,Ait=/[^\0-\u007E]/,Mz=/[.\u3002\uFF0E\uFF61]/g,jz="Overflow: input needs wider integers to process",Fz=Dl.RangeError,Nit=aO(Mz.exec),Z2=Math.floor,_8=String.fromCharCode,Bz=aO("".charCodeAt),Gz=aO([].join),SR=aO([].push),kit=aO("".replace),Lit=aO("".split),Pit=aO("".toLowerCase),qz=function(s){return s+22+75*(s<26)},Dit=function(s,a,h){var g=0;for(s=h?Z2(s/700):s>>1,s+=Z2(s/a);s>455;)s=Z2(s/35),g+=36;return Z2(g+36*s/(s+38))},xit=function(s){var a,h,g=[],j=(s=function(Ml){for(var Fl=[],up=0,_p=Ml.length;up<_p;){var Tp=Bz(Ml,up++);if(Tp>=55296&&Tp<=56319&&up<_p){var Fp=Bz(Ml,up++);(64512&Fp)==56320?SR(Fl,((1023&Tp)<<10)+(1023&Fp)+65536):(SR(Fl,Tp),up--)}else SR(Fl,Tp)}return Fl}(s)).length,_e=128,_n=0,_o=72;for(a=0;a<s.length;a++)(h=s[a])<128&&SR(g,_8(h));var _a=g.length,_r=_a;for(_a&&SR(g,"-");_r<j;){var ba=E8;for(a=0;a<s.length;a++)(h=s[a])>=_e&&h<ba&&(ba=h);var xa=_r+1;if(ba-_e>Z2((E8-_n)/xa))throw Fz(jz);for(_n+=(ba-_e)*xa,_e=ba,a=0;a<s.length;a++){if((h=s[a])<_e&&++_n>E8)throw Fz(jz);if(h==_e){for(var El=_n,yl=36;;){var Ol=yl<=_o?1:yl>=_o+26?26:yl-_o;if(El<Ol)break;var Al=El-Ol,Nl=36-Ol;SR(g,_8(qz(Ol+Al%Nl))),El=Z2(Al/Nl),yl+=36}SR(g,_8(qz(El))),_o=Dit(_n,xa,_r==_a),_n=0,_r++}}_n++,_e++}return Gz(g,"")},Mit=Dl.TypeError,y8=a1,A4=Dl,b8=xy,N4=I0,eT=Tl,Hz=Az,Kz=lR,Uit=FM,jit=wT,Fit=AM,S8=cR,zz=KL,T8=Sp,Vit=E1,Bit=sS,Git=LS,qit=$1,Jz=hy,Xy=dS,Wit=ZT,tY=Qp,R8=vT,Hit=mT,_C=function(s,a){if(s<a)throw Mit("Not enough arguments");return s},Kit=_B,zit=y0("iterator"),k4="URLSearchParams",eY="URLSearchParamsIterator",nY=S8.set,MS=S8.getterFor(k4),Yit=S8.getterFor(eY),rY=b8("fetch"),L4=b8("Request"),MP=b8("Headers"),w8=L4&&L4.prototype,iY=MP&&MP.prototype,Jit=A4.RegExp,Xit=A4.TypeError,oY=A4.decodeURIComponent,Qit=A4.encodeURIComponent,$it=eT("".charAt),sY=eT([].join),cO=eT([].push),I8=eT("".replace),Zit=eT([].shift),aY=eT([].splice),cY=eT("".split),tot=eT("".slice),eot=/\+/g,uY=Array(4),not=function(s){return uY[s-1]||(uY[s-1]=Jit("((?:%[\\da-f]{2}){"+s+"})","gi"))},rot=function(s){try{return oY(s)}catch{return s}},lY=function(s){var a=I8(s,eot," "),h=4;try{return oY(a)}catch{for(;h;)a=I8(a,not(h--),rot);return a}},iot=/[!'()~]|%20/g,oot={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},sot=function(s){return oot[s]},dY=function(s){return I8(Qit(s),iot,sot)},O8=Fit(function(s,a){nY(this,{type:eY,iterator:R8(MS(s).entries),kind:a})},"Iterator",function(){var s=Yit(this),a=s.kind,h=s.iterator.next(),g=h.value;return h.done||(h.value=a==="keys"?g.key:a==="values"?g.value:[g.key,g.value]),h},!0),hY=function(s){this.entries=[],this.url=null,s!==void 0&&(Jz(s)?this.parseObject(s):this.parseQuery(typeof s=="string"?$it(s,0)==="?"?tot(s,1):s:Xy(s)))};hY.prototype={type:k4,bindURL:function(s){this.url=s,this.update()},parseObject:function(s){var a,h,g,j,_e,_n,_o,_a=Hit(s);if(_a)for(h=(a=R8(s,_a)).next;!(g=N4(h,a)).done;){if(_e=(j=R8(qit(g.value))).next,(_n=N4(_e,j)).done||(_o=N4(_e,j)).done||!N4(_e,j).done)throw Xit("Expected sequence with length 2");cO(this.entries,{key:Xy(_n.value),value:Xy(_o.value)})}else for(var _r in s)Vit(s,_r)&&cO(this.entries,{key:_r,value:Xy(s[_r])})},parseQuery:function(s){if(s)for(var a,h,g=cY(s,"&"),j=0;j<g.length;)(a=g[j++]).length&&(h=cY(a,"="),cO(this.entries,{key:lY(Zit(h)),value:lY(sY(h,"="))}))},serialize:function(){for(var s,a=this.entries,h=[],g=0;g<a.length;)s=a[g++],cO(h,dY(s.key)+"="+dY(s.value));return sY(h,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var P4=function(){zz(this,UP);var s=arguments.length>0?arguments[0]:void 0;nY(this,new hY(s))},UP=P4.prototype;if(Uit(UP,{append:function(s,a){_C(arguments.length,2);var h=MS(this);cO(h.entries,{key:Xy(s),value:Xy(a)}),h.updateURL()},delete:function(s){_C(arguments.length,1);for(var a=MS(this),h=a.entries,g=Xy(s),j=0;j<h.length;)h[j].key===g?aY(h,j,1):j++;a.updateURL()},get:function(s){_C(arguments.length,1);for(var a=MS(this).entries,h=Xy(s),g=0;g<a.length;g++)if(a[g].key===h)return a[g].value;return null},getAll:function(s){_C(arguments.length,1);for(var a=MS(this).entries,h=Xy(s),g=[],j=0;j<a.length;j++)a[j].key===h&&cO(g,a[j].value);return g},has:function(s){_C(arguments.length,1);for(var a=MS(this).entries,h=Xy(s),g=0;g<a.length;)if(a[g++].key===h)return!0;return!1},set:function(s,a){_C(arguments.length,1);for(var h,g=MS(this),j=g.entries,_e=!1,_n=Xy(s),_o=Xy(a),_a=0;_a<j.length;_a++)(h=j[_a]).key===_n&&(_e?aY(j,_a--,1):(_e=!0,h.value=_o));_e||cO(j,{key:_n,value:_o}),g.updateURL()},sort:function(){var s=MS(this);Kit(s.entries,function(a,h){return a.key>h.key?1:-1}),s.updateURL()},forEach:function(s){for(var a,h=MS(this).entries,g=Bit(s,arguments.length>1?arguments[1]:void 0),j=0;j<h.length;)g((a=h[j++]).value,a.key,this)},keys:function(){return new O8(this,"keys")},values:function(){return new O8(this,"values")},entries:function(){return new O8(this,"entries")}},{enumerable:!0}),Kz(UP,zit,UP.entries,{name:"entries"}),Kz(UP,"toString",function(){return MS(this).serialize()},{enumerable:!0}),jit(P4,k4),y8({global:!0,forced:!Hz},{URLSearchParams:P4}),!Hz&&T8(MP)){var aot=eT(iY.has),cot=eT(iY.set),pY=function(s){if(Jz(s)){var a,h=s.body;if(Git(h)===k4)return a=s.headers?new MP(s.headers):new MP,aot(a,"content-type")||cot(a,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Wit(s,{body:tY(0,Xy(h)),headers:tY(0,a)})}return s};if(T8(rY)&&y8({global:!0,enumerable:!0,forced:!0},{fetch:function(s){return rY(s,arguments.length>1?pY(arguments[1]):{})}}),T8(L4)){var C8=function(s){return zz(this,w8),new L4(s,arguments.length>1?pY(arguments[1]):{})};w8.constructor=C8,C8.prototype=w8,y8({global:!0,forced:!0},{Request:C8})}}var vS,uot={URLSearchParams:P4,getState:MS},lot=a1,A8=Kp,dot=Az,N8=Dl,fY=sS,ES=Tl,hot=pT.f,D4=lR,pot=KL,k8=E1,L8=vit,_A=function(s){var a=Sit(s),h=wit(this),g=arguments.length,j=g>1?arguments[1]:void 0,_e=j!==void 0;_e&&(j=yit(j,g>2?arguments[2]:void 0));var _n,_o,_a,_r,ba,xa,El=Cit(a),yl=0;if(!El||this==xz&&Rit(El))for(_n=Iit(a),_o=h?new this(_n):xz(_n);_n>yl;yl++)xa=_e?j(a[yl],yl):a[yl],Dz(_o,yl,xa);else for(ba=(_r=Oit(a,El)).next,_o=h?new this:[];!(_a=bit(ba,_r)).done;yl++)xa=_e?Tit(_r,j,[_a.value,yl],!0):_a.value,Dz(_o,yl,xa);return _o.length=yl,_o},US=U6,fot=C7.codeAt,got=function(s){var a,h,g=[],j=Lit(kit(Pit(s),Mz,"."),".");for(a=0;a<j.length;a++)h=j[a],SR(g,Nit(Ait,h)?"xn--"+xit(h):h);return Gz(g,".")},MT=dS,mot=wT,gY=uot,mY=cR,vot=mY.set,x4=mY.getterFor("URL"),Eot=gY.URLSearchParams,_ot=gY.getState,VP=N8.URL,P8=N8.TypeError,M4=N8.parseInt,yot=Math.floor,vY=Math.pow,_S=ES("".charAt),jS=ES(/./.exec),WP=ES([].join),bot=ES(1 .toString),Sot=ES([].pop),tN=ES([].push),EY=ES("".replace),Tot=ES([].shift),Rot=ES("".split),YP=ES("".slice),U4=ES("".toLowerCase),wot=ES([].unshift),D8="Invalid scheme",uO="Invalid host",_Y="Invalid port",yY=/[a-z]/i,Iot=/[\d+-.a-z]/i,x8=/\d/,Oot=/^0x/i,Cot=/^[0-7]+$/,Aot=/^\d+$/,bY=/^[\da-f]+$/i,Not=/[\0\t\n\r #%/:<>?@[\\\]^|]/,kot=/[\0\t\n\r #/:<>?@[\\\]^|]/,Lot=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,Pot=/[\t\n\r]/g,XP=function(s){var a,h,g,j;if(typeof s=="number"){for(a=[],h=0;h<4;h++)wot(a,s%256),s=yot(s/256);return WP(a,".")}if(typeof s=="object"){for(a="",g=function(_e){for(var _n=null,_o=1,_a=null,_r=0,ba=0;ba<8;ba++)_e[ba]!==0?(_r>_o&&(_n=_a,_o=_r),_a=null,_r=0):(_a===null&&(_a=ba),++_r);return _r>_o&&(_n=_a,_o=_r),_n}(s),h=0;h<8;h++)j&&s[h]===0||(j&&(j=!1),g===h?(a+=h?":":"::",j=!0):(a+=bot(s[h],16),h<7&&(a+=":")));return"["+a+"]"}return s},j4={},SY=L8({},j4,{" ":1,'"':1,"<":1,">":1,"`":1}),TY=L8({},SY,{"#":1,"?":1,"{":1,"}":1}),M8=L8({},TY,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),TR=function(s,a){var h=fot(s,0);return h>32&&h<127&&!k8(a,s)?s:encodeURIComponent(s)},F4={ftp:21,file:null,http:80,https:443,ws:80,wss:443},QP=function(s,a){var h;return s.length==2&&jS(yY,_S(s,0))&&((h=_S(s,1))==":"||!a&&h=="|")},RY=function(s){var a;return s.length>1&&QP(YP(s,0,2))&&(s.length==2||(a=_S(s,2))==="/"||a==="\\"||a==="?"||a==="#")},Dot=function(s){return s==="."||U4(s)==="%2e"},U8={},wY={},j8={},IY={},OY={},F8={},CY={},AY={},V4={},B4={},V8={},B8={},G8={},q8={},NY={},W8={},eN={},nT={},kY={},lO={},UT={},H8=function(s,a,h){var g,j,_e,_n=MT(s);if(a){if(j=this.parse(_n))throw P8(j);this.searchParams=null}else{if(h!==void 0&&(g=new H8(h,!0)),j=this.parse(_n,null,g))throw P8(j);(_e=_ot(new Eot)).bindURL(this),this.searchParams=_e}};H8.prototype={type:"URL",parse:function(s,a,h){var g,j,_e,_n,_o,_a=this,_r=a||U8,ba=0,xa="",El=!1,yl=!1,Ol=!1;for(s=MT(s),a||(_a.scheme="",_a.username="",_a.password="",_a.host=null,_a.port=null,_a.path=[],_a.query=null,_a.fragment=null,_a.cannotBeABaseURL=!1,s=EY(s,Lot,"")),s=EY(s,Pot,""),g=_A(s);ba<=g.length;){switch(j=g[ba],_r){case U8:if(!j||!jS(yY,j)){if(a)return D8;_r=j8;continue}xa+=U4(j),_r=wY;break;case wY:if(j&&(jS(Iot,j)||j=="+"||j=="-"||j=="."))xa+=U4(j);else{if(j!=":"){if(a)return D8;xa="",_r=j8,ba=0;continue}if(a&&(_a.isSpecial()!=k8(F4,xa)||xa=="file"&&(_a.includesCredentials()||_a.port!==null)||_a.scheme=="file"&&!_a.host))return;if(_a.scheme=xa,a)return void(_a.isSpecial()&&F4[_a.scheme]==_a.port&&(_a.port=null));xa="",_a.scheme=="file"?_r=q8:_a.isSpecial()&&h&&h.scheme==_a.scheme?_r=IY:_a.isSpecial()?_r=AY:g[ba+1]=="/"?(_r=OY,ba++):(_a.cannotBeABaseURL=!0,tN(_a.path,""),_r=kY)}break;case j8:if(!h||h.cannotBeABaseURL&&j!="#")return D8;if(h.cannotBeABaseURL&&j=="#"){_a.scheme=h.scheme,_a.path=US(h.path),_a.query=h.query,_a.fragment="",_a.cannotBeABaseURL=!0,_r=UT;break}_r=h.scheme=="file"?q8:F8;continue;case IY:if(j!="/"||g[ba+1]!="/"){_r=F8;continue}_r=V4,ba++;break;case OY:if(j=="/"){_r=B4;break}_r=nT;continue;case F8:if(_a.scheme=h.scheme,j==vS)_a.username=h.username,_a.password=h.password,_a.host=h.host,_a.port=h.port,_a.path=US(h.path),_a.query=h.query;else if(j=="/"||j=="\\"&&_a.isSpecial())_r=CY;else if(j=="?")_a.username=h.username,_a.password=h.password,_a.host=h.host,_a.port=h.port,_a.path=US(h.path),_a.query="",_r=lO;else{if(j!="#"){_a.username=h.username,_a.password=h.password,_a.host=h.host,_a.port=h.port,_a.path=US(h.path),_a.path.length--,_r=nT;continue}_a.username=h.username,_a.password=h.password,_a.host=h.host,_a.port=h.port,_a.path=US(h.path),_a.query=h.query,_a.fragment="",_r=UT}break;case CY:if(!_a.isSpecial()||j!="/"&&j!="\\"){if(j!="/"){_a.username=h.username,_a.password=h.password,_a.host=h.host,_a.port=h.port,_r=nT;continue}_r=B4}else _r=V4;break;case AY:if(_r=V4,j!="/"||_S(xa,ba+1)!="/")continue;ba++;break;case V4:if(j!="/"&&j!="\\"){_r=B4;continue}break;case B4:if(j=="@"){El&&(xa="%40"+xa),El=!0,_e=_A(xa);for(var Al=0;Al<_e.length;Al++){var Nl=_e[Al];if(Nl!=":"||Ol){var Ml=TR(Nl,M8);Ol?_a.password+=Ml:_a.username+=Ml}else Ol=!0}xa=""}else if(j==vS||j=="/"||j=="?"||j=="#"||j=="\\"&&_a.isSpecial()){if(El&&xa=="")return"Invalid authority";ba-=_A(xa).length+1,xa="",_r=V8}else xa+=j;break;case V8:case B8:if(a&&_a.scheme=="file"){_r=W8;continue}if(j!=":"||yl){if(j==vS||j=="/"||j=="?"||j=="#"||j=="\\"&&_a.isSpecial()){if(_a.isSpecial()&&xa=="")return uO;if(a&&xa==""&&(_a.includesCredentials()||_a.port!==null))return;if(_n=_a.parseHost(xa))return _n;if(xa="",_r=eN,a)return;continue}j=="["?yl=!0:j=="]"&&(yl=!1),xa+=j}else{if(xa=="")return uO;if(_n=_a.parseHost(xa))return _n;if(xa="",_r=G8,a==B8)return}break;case G8:if(!jS(x8,j)){if(j==vS||j=="/"||j=="?"||j=="#"||j=="\\"&&_a.isSpecial()||a){if(xa!=""){var Fl=M4(xa,10);if(Fl>65535)return _Y;_a.port=_a.isSpecial()&&Fl===F4[_a.scheme]?null:Fl,xa=""}if(a)return;_r=eN;continue}return _Y}xa+=j;break;case q8:if(_a.scheme="file",j=="/"||j=="\\")_r=NY;else{if(!h||h.scheme!="file"){_r=nT;continue}if(j==vS)_a.host=h.host,_a.path=US(h.path),_a.query=h.query;else if(j=="?")_a.host=h.host,_a.path=US(h.path),_a.query="",_r=lO;else{if(j!="#"){RY(WP(US(g,ba),""))||(_a.host=h.host,_a.path=US(h.path),_a.shortenPath()),_r=nT;continue}_a.host=h.host,_a.path=US(h.path),_a.query=h.query,_a.fragment="",_r=UT}}break;case NY:if(j=="/"||j=="\\"){_r=W8;break}h&&h.scheme=="file"&&!RY(WP(US(g,ba),""))&&(QP(h.path[0],!0)?tN(_a.path,h.path[0]):_a.host=h.host),_r=nT;continue;case W8:if(j==vS||j=="/"||j=="\\"||j=="?"||j=="#"){if(!a&&QP(xa))_r=nT;else if(xa==""){if(_a.host="",a)return;_r=eN}else{if(_n=_a.parseHost(xa))return _n;if(_a.host=="localhost"&&(_a.host=""),a)return;xa="",_r=eN}continue}xa+=j;break;case eN:if(_a.isSpecial()){if(_r=nT,j!="/"&&j!="\\")continue}else if(a||j!="?")if(a||j!="#"){if(j!=vS&&(_r=nT,j!="/"))continue}else _a.fragment="",_r=UT;else _a.query="",_r=lO;break;case nT:if(j==vS||j=="/"||j=="\\"&&_a.isSpecial()||!a&&(j=="?"||j=="#")){if((_o=U4(_o=xa))===".."||_o==="%2e."||_o===".%2e"||_o==="%2e%2e"?(_a.shortenPath(),j=="/"||j=="\\"&&_a.isSpecial()||tN(_a.path,"")):Dot(xa)?j=="/"||j=="\\"&&_a.isSpecial()||tN(_a.path,""):(_a.scheme=="file"&&!_a.path.length&&QP(xa)&&(_a.host&&(_a.host=""),xa=_S(xa,0)+":"),tN(_a.path,xa)),xa="",_a.scheme=="file"&&(j==vS||j=="?"||j=="#"))for(;_a.path.length>1&&_a.path[0]==="";)Tot(_a.path);j=="?"?(_a.query="",_r=lO):j=="#"&&(_a.fragment="",_r=UT)}else xa+=TR(j,TY);break;case kY:j=="?"?(_a.query="",_r=lO):j=="#"?(_a.fragment="",_r=UT):j!=vS&&(_a.path[0]+=TR(j,j4));break;case lO:a||j!="#"?j!=vS&&(j=="'"&&_a.isSpecial()?_a.query+="%27":_a.query+=j=="#"?"%23":TR(j,j4)):(_a.fragment="",_r=UT);break;case UT:j!=vS&&(_a.fragment+=TR(j,SY))}ba++}},parseHost:function(s){var a,h,g;if(_S(s,0)=="["){if(_S(s,s.length-1)!="]"||!(a=function(j){var _e,_n,_o,_a,_r,ba,xa,El=[0,0,0,0,0,0,0,0],yl=0,Ol=null,Al=0,Nl=function(){return _S(j,Al)};if(Nl()==":"){if(_S(j,1)!=":")return;Al+=2,Ol=++yl}for(;Nl();){if(yl==8)return;if(Nl()!=":"){for(_e=_n=0;_n<4&&jS(bY,Nl());)_e=16*_e+M4(Nl(),16),Al++,_n++;if(Nl()=="."){if(_n==0||(Al-=_n,yl>6))return;for(_o=0;Nl();){if(_a=null,_o>0){if(!(Nl()=="."&&_o<4))return;Al++}if(!jS(x8,Nl()))return;for(;jS(x8,Nl());){if(_r=M4(Nl(),10),_a===null)_a=_r;else{if(_a==0)return;_a=10*_a+_r}if(_a>255)return;Al++}El[yl]=256*El[yl]+_a,++_o!=2&&_o!=4||yl++}if(_o!=4)return;break}if(Nl()==":"){if(Al++,!Nl())return}else if(Nl())return;El[yl++]=_e}else{if(Ol!==null)return;Al++,Ol=++yl}}if(Ol!==null)for(ba=yl-Ol,yl=7;yl!=0&&ba>0;)xa=El[yl],El[yl--]=El[Ol+ba-1],El[Ol+--ba]=xa;else if(yl!=8)return;return El}(YP(s,1,-1))))return uO;this.host=a}else if(this.isSpecial()){if(s=got(s),jS(Not,s)||(a=function(j){var _e,_n,_o,_a,_r,ba,xa,El=Rot(j,".");if(El.length&&El[El.length-1]==""&&El.length--,(_e=El.length)>4)return j;for(_n=[],_o=0;_o<_e;_o++){if((_a=El[_o])=="")return j;if(_r=10,_a.length>1&&_S(_a,0)=="0"&&(_r=jS(Oot,_a)?16:8,_a=YP(_a,_r==8?1:2)),_a==="")ba=0;else{if(!jS(_r==10?Aot:_r==8?Cot:bY,_a))return j;ba=M4(_a,_r)}tN(_n,ba)}for(_o=0;_o<_e;_o++)if(ba=_n[_o],_o==_e-1){if(ba>=vY(256,5-_e))return null}else if(ba>255)return null;for(xa=Sot(_n),_o=0;_o<_n.length;_o++)xa+=_n[_o]*vY(256,3-_o);return xa}(s))===null)return uO;this.host=a}else{if(jS(kot,s))return uO;for(a="",h=_A(s),g=0;g<h.length;g++)a+=TR(h[g],j4);this.host=a}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return k8(F4,this.scheme)},shortenPath:function(){var s=this.path,a=s.length;!a||this.scheme=="file"&&a==1&&QP(s[0],!0)||s.length--},serialize:function(){var s=this,a=s.scheme,h=s.username,g=s.password,j=s.host,_e=s.port,_n=s.path,_o=s.query,_a=s.fragment,_r=a+":";return j!==null?(_r+="//",s.includesCredentials()&&(_r+=h+(g?":"+g:"")+"@"),_r+=XP(j),_e!==null&&(_r+=":"+_e)):a=="file"&&(_r+="//"),_r+=s.cannotBeABaseURL?_n[0]:_n.length?"/"+WP(_n,"/"):"",_o!==null&&(_r+="?"+_o),_a!==null&&(_r+="#"+_a),_r},setHref:function(s){var a=this.parse(s);if(a)throw P8(a);this.searchParams.update()},getOrigin:function(){var s=this.scheme,a=this.port;if(s=="blob")try{return new nN(s.path[0]).origin}catch{return"null"}return s!="file"&&this.isSpecial()?s+"://"+XP(this.host)+(a!==null?":"+a:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(s){this.parse(MT(s)+":",U8)},getUsername:function(){return this.username},setUsername:function(s){var a=_A(MT(s));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var h=0;h<a.length;h++)this.username+=TR(a[h],M8)}},getPassword:function(){return this.password},setPassword:function(s){var a=_A(MT(s));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var h=0;h<a.length;h++)this.password+=TR(a[h],M8)}},getHost:function(){var s=this.host,a=this.port;return s===null?"":a===null?XP(s):XP(s)+":"+a},setHost:function(s){this.cannotBeABaseURL||this.parse(s,V8)},getHostname:function(){var s=this.host;return s===null?"":XP(s)},setHostname:function(s){this.cannotBeABaseURL||this.parse(s,B8)},getPort:function(){var s=this.port;return s===null?"":MT(s)},setPort:function(s){this.cannotHaveUsernamePasswordPort()||((s=MT(s))==""?this.port=null:this.parse(s,G8))},getPathname:function(){var s=this.path;return this.cannotBeABaseURL?s[0]:s.length?"/"+WP(s,"/"):""},setPathname:function(s){this.cannotBeABaseURL||(this.path=[],this.parse(s,eN))},getSearch:function(){var s=this.query;return s?"?"+s:""},setSearch:function(s){(s=MT(s))==""?this.query=null:(_S(s,0)=="?"&&(s=YP(s,1)),this.query="",this.parse(s,lO)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var s=this.fragment;return s?"#"+s:""},setHash:function(s){(s=MT(s))!=""?(_S(s,0)=="#"&&(s=YP(s,1)),this.fragment="",this.parse(s,UT)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var nN=function(s){var a=pot(this,G4),h=arguments.length>1?arguments[1]:void 0,g=vot(a,new H8(s,!1,h));A8||(a.href=g.serialize(),a.origin=g.getOrigin(),a.protocol=g.getProtocol(),a.username=g.getUsername(),a.password=g.getPassword(),a.host=g.getHost(),a.hostname=g.getHostname(),a.port=g.getPort(),a.pathname=g.getPathname(),a.search=g.getSearch(),a.searchParams=g.getSearchParams(),a.hash=g.getHash())},G4=nN.prototype,yS=function(s,a){return{get:function(){return x4(this)[s]()},set:a&&function(h){return x4(this)[a](h)},configurable:!0,enumerable:!0}};if(A8&&hot(G4,{href:yS("serialize","setHref"),origin:yS("getOrigin"),protocol:yS("getProtocol","setProtocol"),username:yS("getUsername","setUsername"),password:yS("getPassword","setPassword"),host:yS("getHost","setHost"),hostname:yS("getHostname","setHostname"),port:yS("getPort","setPort"),pathname:yS("getPathname","setPathname"),search:yS("getSearch","setSearch"),searchParams:yS("getSearchParams"),hash:yS("getHash","setHash")}),D4(G4,"toJSON",function(){return x4(this).serialize()},{enumerable:!0}),D4(G4,"toString",function(){return x4(this).serialize()},{enumerable:!0}),VP){var LY=VP.createObjectURL,PY=VP.revokeObjectURL;LY&&D4(nN,"createObjectURL",fY(LY,VP)),PY&&D4(nN,"revokeObjectURL",fY(PY,VP))}mot(nN,"URL"),lot({global:!0,forced:!dot,sham:!A8},{URL:nN});var DY=IS.URL;const xot={[q2.ACCESS_POINT]:{[R1.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[R1.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[R1.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[R1.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[R1.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[R1.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voice service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[R1.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[q2.UNILBS]:{[Ay.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[Ay.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[Ay.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[Ay.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[Ay.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[Ay.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[Ay.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[Ay.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[Ay.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[Ay.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[Ay.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[Ay.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[q2.STRING_UID_ALLOCATOR]:{[TP.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[TP.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[TP.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function q4(s){const a=xot[Math.floor(s/1e4)];if(!a)return{desc:"unkonw error",retry:!1};const h=a[s%1e4];if(!h){if(Math.floor(s/1e4)===q2.ACCESS_POINT){const g=s%1e4;if(g.toString()[0]==="1")return{desc:s.toString(),retry:!1};if(g.toString()[0]==="2")return{desc:s.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return h}const Mot={[v0.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[v0.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[v0.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[v0.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[v0.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[v0.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[v0.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[v0.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[v0.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[v0.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[v0.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[v0.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[v0.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[v0.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[v0.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[v0.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[v0.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[v0.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[v0.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[v0.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[v0.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[v0.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[v0.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[v0.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[v0.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[v0.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[v0.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[v0.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[v0.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[v0.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[v0.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[v0.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[v0.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[v0.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[v0.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[v0.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[v0.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[v0.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[v0.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[v0.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[v0.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[v0.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[v0.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[v0.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[v0.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[v0.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[v0.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[v0.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[v0.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[v0.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[v0.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[v0.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[v0.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[v0.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[v0.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[v0.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[v0.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[v0.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[v0.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[v0.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[v0.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[v0.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[v0.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[v0.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function $P(s){return Mot[s]||{desc:"UNKNOW_ERROR_".concat(s),action:"failed"}}class Uot extends C_{get queue(){return[...this.highPriorityQueue,...this.lowPriorityQueue]}constructor(a){super(),Rl(this,"lowPriorityQueue",[]),Rl(this,"highPriorityQueue",[]),Rl(this,"AgoraWebSocketManager",void 0),this.AgoraWebSocketManager=a}reset(){this.lowPriorityQueue=[],this.highPriorityQueue=[]}pushMessage(a){arguments.length>1&&arguments[1]!==void 0&&arguments[1]?this.highPriorityQueue.push(a):this.lowPriorityQueue.push(a),this.sendMessage()}sendMessage(){const a=this.queue.length;let h=0;h=a<5?15*a:60+3*(a-4),setTimeout(()=>{this._sendMessage()},h)}_sendMessage(){if(!this.queue.length)return;const a=this.AgoraWebSocketManager.getConnection();if(!a||a.readyState!==1)return;const h=this.queue.shift();return this.lowPriorityQueue.includes(h)?this.lowPriorityQueue.shift():this.highPriorityQueue.shift(),a.send(h.compressed),h}}function xY(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}class rN extends C_{get url(){return this.websocket?this.websocket.url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(a){["tryNext","recover"].includes(a)&&this.resetReconnectCount(a),this._reconnectMode=a}get state(){return this._state}set state(a){a!==this._state&&(this._state=a,this._state==="reconnecting"?this.emit(k0.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(k0.CONNECTED):this._state==="closed"?this.emit(k0.CLOSED):this._state==="failed"&&this.emit(k0.FAILED))}resetReconnectCount(a){Ll.debug("websocket reset reconnect count, reason: "+a),this.reconnectCount=0}constructor(a,h){let g=arguments.length>2&&arguments[2]!==void 0&&arguments[2],j=arguments.length>3&&arguments[3]!==void 0&&arguments[3],_e=arguments.length>4?arguments[4]:void 0;super(),Rl(this,"connectionID",0),Rl(this,"currentURLIndex",0),Rl(this,"urls",void 0),Rl(this,"_reconnectMode","tryNext"),Rl(this,"reconnectReason",void 0),Rl(this,"_initMutex",new B1("websocket")),Rl(this,"name",void 0),Rl(this,"_state","closed"),Rl(this,"reconnectInterrupter",void 0),Rl(this,"websocket",void 0),Rl(this,"retryConfig",void 0),Rl(this,"reconnectCount",0),Rl(this,"forceCloseTimeout",5e3),Rl(this,"onlineReconnectListener",void 0),Rl(this,"messageSender",void 0),Rl(this,"useCompress",void 0),Rl(this,"tryDoubleDomain",!1),Rl(this,"wsInflateLength",0),Rl(this,"wsDeflateLength",0),Rl(this,"closeEstablishingWs",()=>{}),Rl(this,"store",void 0),Rl(this,"joinChannelServiceRecordIndex",void 0),this.store=_e,this.name=a,this.retryConfig=function(ba){for(var xa=1;xa<arguments.length;xa++){var El=arguments[xa]!=null?arguments[xa]:{};xa%2?xY(Object(El),!0).forEach(function(yl){Rl(ba,yl,El[yl])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ba,Object.getOwnPropertyDescriptors(El)):xY(Object(El)).forEach(function(yl){Object.defineProperty(ba,yl,Object.getOwnPropertyDescriptor(El,yl))})}return ba}({},h),this.useCompress=g,this.tryDoubleDomain=j;const{timeout:_n,timeoutFactor:_o}=h,_a=Math.max(300,Math.floor(3*_n/5)),_r=Math.max(1.2,Math.floor(8*_o)/10);M1.ONLINE&&(this.retryConfig.timeout=_a,this.retryConfig.timeoutFactor=_r),q_.on(_R.NETWORK_STATE_CHANGE,(ba,xa)=>{ba!==xa&&(this.resetReconnectCount("network state change: ".concat(xa," -> ").concat(ba)),ba===M1.ONLINE?(this.retryConfig.timeout=_a,this.retryConfig.timeoutFactor=_r):(this.retryConfig.timeout=_n,this.retryConfig.timeoutFactor=_o))})}getConnection(){return this.websocket||void 0}init(a){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;this.forceCloseTimeout=h;const g=(j,_e)=>{this.urls=a;const _n=this.urls[this.currentURLIndex];this.state="connecting",this.messageSender=new Uot(this),this.createWebSocketConnection(_n).then(j).catch(_e),this.once(k0.CLOSED,()=>_e(new Ql(Hl.WS_DISCONNECT))),this.once(k0.CONNECTED,()=>j())};return this._initMutex.lock().then(j=>new s0((_e,_n)=>{g(_e,_n)}).then(()=>{j()}).catch(()=>{j()}))}close(a,h){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const g=this.websocket;h?setTimeout(()=>g.close(),500):g.close(),this.websocket=void 0}this.state=a?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(a,h){if(!this.websocket)return void Ll.warning("[".concat(this.name,"] can not reconnect, no websocket"));var g;a!==void 0&&(this.reconnectMode=a),Ll.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinChannelServiceRecordIndex=="number"&&((g=this.store)===null||g===void 0||g.recordJoinChannelService({status:"error",errors:[new Error(h)]},this.joinChannelServiceRecordIndex));const j=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),j&&j.bind(this.websocket)({code:9999,reason:h})}sendMessageWithJSON(a){const h=JSON.stringify(a);return{compressed:h,compressedLength:h.length,origin:a}}sendMessageWithUint8Array(a){return{compressed:a,compressedLength:a.byteLength,origin:a}}sendMessage(a){let h=arguments.length>1&&arguments[1]!==void 0&&arguments[1],g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new Ql(Hl.WS_ABORT,"websocket is not ready");try{let j=null;j=g?this.sendMessageWithUint8Array(a):this.sendMessageWithJSON(a),h?this.websocket.send(j.compressed):this.messageSender.pushMessage(j)}catch(j){throw new Ql(Hl.WS_ERR,"send websocket message error"+j.toString())}}setWsInflateData(a){this.wsDeflateLength=this.wsDeflateLength+a.originLength,this.wsInflateLength=this.wsInflateLength+a.compressedLength}getWsInflateData(){const a=this.wsInflateLength,h=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:a,wsDeflateLength:h}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(a,h){return this.connectionID+=1,this.connectionID,this.joinChannelServiceRecordIndex=void 0,new s0((g,j)=>{var _e;const _n=ba=>{var xa;(xa=this.store)===null||xa===void 0||xa.signalChannelOpen(),Ll.debug("[".concat(this.name,"] websocket opened:"),ba),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),g()},_o=async ba=>{if(Ll.debug("[".concat(this.name,"] websocket close ").concat(this.websocket&&this.websocket.url,", code: ").concat(ba.code,", reason: ").concat(ba.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount<this.retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=ba.reason,this.state="reconnecting");const xa=tT(this,k0.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,El=await this.reconnectWithAction(xa);if(this.state==="closed")return void Ll.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!El)return j(new Ql(Hl.WS_DISCONNECT,"websocket reconnect failed: ".concat(ba.code))),void this.close(!0);g()}else j(new Ql(Hl.WS_DISCONNECT,"websocket close: ".concat(ba.code))),this.close()},_a=ba=>{this.emit(k0.ON_MESSAGE,ba)};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),wp("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(a=wp("GATEWAY_WSS_ADDRESS")),Ll.debug("[".concat(this.name,"] start connect, url: ").concat(a));const _r=(_e=this.store)===null||_e===void 0?void 0:_e.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});this.chooseBestWebsocketConnection(a,!!h,_r).then(ba=>{var xa;this.websocket=ba,_n&&_n(ba.url),ba.onclose=_o,ba.onmessage=_a,(xa=this.store)===null||xa===void 0||xa.recordJoinChannelService({endTs:Date.now(),status:"success"},_r),this.joinChannelServiceRecordIndex=_r}).catch(ba=>{var xa;if((xa=this.store)===null||xa===void 0||xa.recordJoinChannelService({endTs:Date.now(),status:ba instanceof Ql&&ba.code===Hl.WS_ABORT?"aborted":"error",errors:[ba]},_r),this.state!=="closed"){if(ba instanceof Ql&&ba.code===Hl.WS_ERR){const El=new Ql(Hl.WS_ERR,"init websocket failed! Error: ".concat(ba.toString()));return Ll.error("[".concat(this.name,"]").concat(El)),void j(El)}_o&&_o(ba)}else j(new Ql(Hl.WS_DISCONNECT,"websocket is closed: ".concat(ba.toString())))})})}async reconnectWithAction(a){let h=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||!this.urls||this.state==="closed")return!1;this.onlineReconnectListener||q_.networkState!==M1.OFFLINE||(this.onlineReconnectListener=q_.onlineWaiter&&q_.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let g=!0;if(this.reconnectInterrupter=()=>{g=!1},h){const _n=N6(this.reconnectCount,this.retryConfig);Ll.debug("[".concat(this.name,"] wait ").concat(_n,"ms to reconnect websocket, mode: ").concat(a)),await s0.race([g1(_n),this.onlineReconnectListener||new s0(()=>{})])}if(this.state==="closed"||!g)return!1;this.reconnectCount+=1;const j=async(_n,_o)=>{this.emit(k0.RECONNECT_CREATE_CONNECTION,_o),await this.createWebSocketConnection(_n)};try{if(a==="retry"){const _n=this.urls[this.currentURLIndex];this.emit(k0.RECONNECT_WAITTING_FINISH,a),await j(_n,a)}else if(a==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return await this.reconnectWithAction("recover",!1);Ll.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex));const _n=this.urls[this.currentURLIndex];this.emit(k0.RECONNECT_WAITTING_FINISH,a),await j(_n,a)}else if(a==="recover"){Ll.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.emit(k0.RECONNECT_WAITTING_FINISH,a),this.urls=await A1(this,k0.REQUEST_NEW_URLS),this.currentURLIndex=0;const _n=this.urls[this.currentURLIndex];await j(_n,a)}return!0}catch(_n){var _e;return Ll.error("[".concat(this.name,"] reconnect failed"),_n.toString()),_n!=null&&(_e=_n.data)!==null&&_e!==void 0&&_e.desc&&Array.isArray(_n.data.desc)&&_n.data.desc.length&&_n.data.desc.includes("dynamic key expired")?(this.emit(k0.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(a,h)}}async chooseBestWebsocketConnection(a,h,g){return new s0((j,_e)=>{let _n=!1;const _o=[];this.closeEstablishingWs=()=>{Ll.debug("[choose-best-ws] close establishing websockets"),_o.forEach(Al=>{Al.onclose=null,Al.onopen=null,Al.onmessage=null,Al.close()}),_e(new Ql(Hl.WS_ABORT,"choose best websocket aborted"))};const _a=wp("GATEWAY_DOMAINS");let _r;const ba=a.indexOf("?h="),xa=_a.find(Al=>ba!==-1?a.includes(Al,ba):a.includes(Al));Ll.debug("[choose-best-ws] currentDomain: ",xa,", domains: ",_a);let El=!this.tryDoubleDomain||h||!xa;if(!El&&xa){var yl;const Al=Date.now();try{_a.forEach(Nl=>{const Ml=ba===-1?a.replace(xa,Nl):a.substr(0,ba)+a.substr(ba).replace(xa,Nl),Fl=new WebSocket(Ml);Fl.binaryType="arraybuffer",_o.push(Fl),Ll.debug("[choose-best-ws] ws is connecting:",Fl.url)})}catch{for(Ll.debug("[choose-best-ws] ws create failed, fallback to single url"),_o.forEach(Ml=>Ml.close());_o.length;)_o.pop();El=!0}(yl=this.store)===null||yl===void 0||yl.recordJoinChannelService({urls:_o.map(Nl=>Nl.url),service:"gateway"},g),_o.forEach(Nl=>{Nl.onopen=()=>{if(_n)return;const Ml=Date.now()-Al;Ll.debug("[choose-best-ws] ws open cost ".concat(Ml,"ms")),_o.filter(Fl=>Fl!==Nl).forEach(Fl=>{Ll.debug("[choose-best-ws]close backup websocket: ".concat(Fl.url)),Fl.close()}),_n=!0,j(Nl)},Nl.onclose=Ml=>{_r=Ml,!_n&&(_o.find(Fl=>!(Fl.readyState===WebSocket.CLOSED||Fl.readyState===WebSocket.CLOSING))||(Ll.debug("[choose-best-ws] all websocket is closed"),_n=!0,_e(_r)))},Nl.onmessage=Ml=>{Ll.debug("[choose-best-ws]".concat(Nl.url," onmessage: ").concat(Ml.data))}}),g1(this.forceCloseTimeout).then(()=>{_o.forEach(Nl=>{Nl.readyState!==WebSocket.OPEN&&Nl.close()})})}if(El){var Ol;let Al;Ll.debug("[choose-best-ws] use single url: ",a),(Ol=this.store)===null||Ol===void 0||Ol.recordJoinChannelService({urls:[a],service:"gateway"},g);try{Al=new WebSocket(a),_o.push(Al),Al.binaryType="arraybuffer"}catch(Nl){const Ml=new Ql(Hl.WS_ERR,"init websocket failed! Error: ".concat(Nl.toString()));return Ll.error("[".concat(this.name,"]").concat(Ml)),void _e(Ml)}Al.onopen=()=>{j(Al)},Al.onclose=Nl=>{_e(Nl)},Al.onmessage=Nl=>{Ll.debug("[choose-best-ws]".concat(Al.url," onmessage: ").concat(Nl.data))},g1(this.forceCloseTimeout).then(()=>{Al&&Al.readyState!==WebSocket.OPEN&&Al.close()})}}).then(j=>(this.closeEstablishingWs=void 0,j)).catch(j=>{throw this.closeEstablishingWs=void 0,j})}}class MY{constructor(a){Rl(this,"input",[]),Rl(this,"size",void 0),this.size=a}add(a){this.input.push(a),this.input.length>this.size&&this.input.splice(0,1)}mean(){var a;return this.input.length===0?0:Gy(a=this.input).call(a,(h,g)=>h+g)/this.input.length}}class UY extends C_{get connectionState(){return this._connectionState}set connectionState(a){a!==this._connectionState&&(this._connectionState=a,a===a_.CONNECTED?this.emit(l0.WS_CONNECTED):a===a_.RECONNECTING?this.emit(l0.WS_RECONNECTING,this._websocketReconnectReason):a===a_.CLOSED&&this.emit(l0.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(a,h){super(),Rl(this,"_disconnectedReason",void 0),Rl(this,"_websocketReconnectReason",void 0),Rl(this,"_connectionState",a_.CLOSED),Rl(this,"reconnectToken",void 0),Rl(this,"websocket",void 0),Rl(this,"openConnectionTime",void 0),Rl(this,"clientId",void 0),Rl(this,"lastMsgTime",Date.now()),Rl(this,"uploadCache",[]),Rl(this,"uploadCacheInterval",void 0),Rl(this,"rttRolling",new MY(5)),Rl(this,"pingpongTimer",void 0),Rl(this,"wsInflateDataTimer",void 0),Rl(this,"pingpongTimeoutCount",0),Rl(this,"joinResponse",void 0),Rl(this,"multiIpOption",void 0),Rl(this,"initError",void 0),Rl(this,"spec",void 0),Rl(this,"store",void 0),Rl(this,"onWebsocketMessage",g=>{if(g.data instanceof ArrayBuffer)return void this.emit(l0.ON_BINARY_DATA,g.data);const j=JSON.parse(g.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(j,"_id")){const _e="res-@".concat(j._id);this.emit(_e,j._result,j._message)}else if(Object.prototype.hasOwnProperty.call(j,"_type")){if(this.emit(j._type,j._message),j._type===M0.ON_NOTIFICATION&&this.handleNotification(j._message),j._type===M0.ON_USER_BANNED)switch(j._message.error_code){case 14:this.close(i_.UID_BANNED);break;case 15:this.close(i_.IP_BANNED);break;case 16:this.close(i_.CHANNEL_BANNED)}if(j._type===M0.ON_USER_LICENSE_BANNED)switch(j._message.error_code){case v0.ERR_LICENSE_MISSING:this.close(i_.LICENSE_MISSING);break;case v0.ERR_LICENSE_EXPIRED:this.close(i_.LICENSE_EXPIRED);break;case v0.ERR_LICENSE_MINUTES_EXCEEDED:this.close(i_.LICENSE_MINUTES_EXCEEDED);break;case v0.ERR_LICENSE_PERIOD_INVALID:this.close(i_.LICENSE_PERIOD_INVALID);break;case v0.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(i_.LICENSE_MULTIPLE_SDK_SERVICE);break;case v0.ERR_LICENSE_ILLEGAL:this.close(i_.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=a.clientId,this.spec=a,this.store=h,this.websocket=new rN("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,h),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===a_.CONNECTED&&this.reconnect("retry",K1.OFFLINE)})}async request(a,h,g,j){const _e=N_(6,""),_n={_id:_e,_type:a,_message:h},_o=this.websocket.connectionID,_a=()=>new s0((Ol,Al)=>{if(this.connectionState===a_.CONNECTED)return Ol();const Nl=()=>{this.off(l0.WS_CLOSED,Ml),Ol()},Ml=()=>{this.off(l0.WS_CONNECTED,Nl),Al(new Ql(Hl.WS_ABORT))};this.once(l0.WS_CONNECTED,Nl),this.once(l0.WS_CLOSED,Ml),a!==T0.PUBLISH&&a!==T0.SUBSCRIBE&&a!==T0.UNSUBSCRIBE&&a!==T0.UNPUBLISH&&a!==T0.CONTROL&&a!==T0.RESTART_ICE||this.once(l0.DISCONNECT_P2P,()=>{Al(new Ql(Hl.DISCONNECT_P2P))}),a!==T0.PUBLISH&&a!==T0.RESTART_ICE||this.once(l0.ABORT_P2P_EXECUTION,()=>{Al(new Ql(Hl.DISCONNECT_P2P))})});if(this.connectionState!==a_.CONNECTING&&this.connectionState!==a_.RECONNECTING||a===T0.JOIN||a===T0.REJOIN||await _a(),this.websocket.sendMessage(_n,!0),j)return;const _r=new s0((Ol,Al)=>{let Nl=!1;const Ml=(up,_p)=>{Nl=!0,Ol({isSuccess:up==="success",message:_p||{}}),this.off(l0.WS_CLOSED,Fl),this.off(l0.WS_RECONNECTING,Fl),this.emit(l0.REQUEST_SUCCESS,a,h)};this.once("res-@".concat(_e),Ml);const Fl=()=>{Al(new Ql(Hl.WS_ABORT,"type: ".concat(a))),this.off(l0.WS_CLOSED,Fl),this.off(l0.WS_RECONNECTING,Fl),this.off("res-@".concat(_e),Ml)};this.once(l0.WS_CLOSED,Fl),this.once(l0.WS_RECONNECTING,Fl),g1(wp("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==_o||Nl||(Ll.warning("ws request timeout, type: ".concat(a)),this.emit(l0.REQUEST_TIMEOUT,a,h))})});let ba=null;try{ba=await _r}catch(Ol){if(this.connectionState===a_.CLOSED||a===T0.LEAVE)throw new Ql(Hl.WS_ABORT);return!this.spec.forceWaitGatewayResponse||g?Ol.throw():a===T0.JOIN||a===T0.REJOIN?null:(await _a(),await this.request(a,h))}if(ba.isSuccess)return ba.message;const xa=Number(ba.message.error_code||ba.message.code),El=$P(xa),yl=new Ql(Hl.UNEXPECTED_RESPONSE,"".concat(El.desc,": ").concat(ba.message.error_str),{code:xa,data:ba.message});return El.action==="success"?ba.message:(Ll.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(a,", error_code: ").concat(xa,", message: ").concat(El.desc,", action: ").concat(El.action)),xa===v0.ERR_TOO_MANY_BROADCASTERS?((a===T0.JOIN||a===T0.REJOIN)&&(this.initError=yl,this.close()),yl.throw()):El.action==="failed"?yl.throw():El.action==="quit"?(this.initError=yl,this.close(),yl.throw()):(xa===v0.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=ba.message.option,Ll.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",K1.MULTI_IP)):this.reconnect(El.action,K1.SERVER_ERROR),a===T0.JOIN||a===T0.REJOIN?null:await this.request(a,h)))}waitMessage(a,h){return new s0(g=>{const j=_e=>{(!h||h(_e))&&(this.off(a,j),g(_e))};this.on(a,j)})}upload(a,h){const g={_type:a,_message:h};try{this.websocket.sendMessage(g)}catch{const _e=wp("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(g),this.uploadCache.length>_e&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==a_.CONNECTED)return;const _n=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(_n._type,_n._message)},wp("UPLOAD_CACHE_INTERVAL")||2e3))}}send(a,h){const g={_type:a,_message:h};this.websocket.sendMessage(g)}init(a,h){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new s0((g,j)=>{this.once(l0.WS_CONNECTED,()=>g(this.joinResponse)),this.once(l0.WS_CLOSED,()=>j(this.initError||new Ql(Hl.WS_ABORT))),this.connectionState=a_.CONNECTING,this.websocket.init(a).catch(j),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4),setTimeout(()=>{h&&this.openConnectionTime===void 0&&(Ll.debug("[".concat(this.clientId,"] init websocket timeout while join with fallback to proxy")),j(new Ql(Hl.INIT_WEBSOCKET_TIMEOUT)))},wp("JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION"))})}close(a){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=a||i_.LEAVE,this.connectionState=a_.CLOSED,Ll.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),a===i_.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new rN("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(l0.ABORT_P2P_EXECUTION);const a=await A1(this,l0.REQUEST_JOIN_INFO),h=await this.request(T0.JOIN,a);if(!h)return this.emit(l0.REPORT_JOIN_GATEWAY,Hl.TIMEOUT,this.url||""),!1;this.joinResponse=h,this.emit(l0.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=a_.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new Ql(Hl.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const a=sO(this,l0.REQUEST_REJOIN_INFO);a.token=this.reconnectToken;const h=await this.request(T0.REJOIN,a);return!!h&&(this.connectionState=a_.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),h.peers&&h.peers.forEach(g=>{this.emit(M0.ON_USER_ONLINE,{uid:g.uid}),g.audio&&this.emit(M0.ON_ADD_AUDIO_STREAM,{uid:g.uid,uint_id:g.uint_id,audio:!0,ssrcId:g.audio_ssrc}),g.video&&this.emit(M0.ON_ADD_VIDEO_STREAM,{uid:g.uid,uint_id:g.uint_id,video:!0,ssrcId:g.video_ssrc}),g.audio_mute?this.emit(M0.MUTE_AUDIO,{uid:g.uid}):this.emit(M0.UNMUTE_AUDIO,{uid:g.uid}),g.video_mute?this.emit(M0.MUTE_VIDEO,{uid:g.uid}):this.emit(M0.UNMUTE_VIDEO,{uid:g.uid}),g.audio_enable_local?this.emit(M0.ENABLE_LOCAL_AUDIO,{uid:g.uid}):this.emit(M0.DISABLE_LOCAL_AUDIO,{uid:g.uid}),g.video_enable_local?this.emit(M0.ENABLE_LOCAL_VIDEO,{uid:g.uid}):this.emit(M0.DISABLE_LOCAL_VIDEO,{uid:g.uid}),g.audio||g.video||this.emit(M0.ON_REMOVE_STREAM,{uid:g.uid,uint_id:g.uint_id})}),!0)}reconnect(a,h){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(a,h)}handleNotification(a){Ll.debug("[".concat(this.clientId,"] receive notification: "),a);const h=$P(a.code);if(h.action!=="success"){if(h.action!=="failed")return h.action==="quit"?(h.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(i_.UID_BANNED),void this.close()):void this.reconnect(h.action,K1.SERVER_ERROR);Ll.error("[".concat(this.clientId,"] ignore error: "),h.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const a=wp("PING_PONG_TIME_OUT"),h=Date.now();this.pingpongTimeoutCount>=a&&(Ll.warning("PINGPONG Timeout. Last Socket Message: ".concat(h-this.lastMsgTime,"ms")),h-this.lastMsgTime>wp("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",K1.TIMEOUT):this.request(T0.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const g=Date.now()-h;this.rttRolling.add(g),wp("REPORT_STATS")&&this.send(T0.PING_BACK,{pingpongElapse:g})}).catch(g=>{})}handleWsInflateData(){const{wsInflateLength:a,wsDeflateLength:h}=this.websocket.getWsInflateData();a!==0&&h!==0&&this.upload(sy.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:h,ws_inflate_length:a})}handleWebsocketEvents(){this.websocket.on(k0.RECONNECT_WAITTING_FINISH,a=>{this.emit(l0.WS_RECONNECT_WAITTING_FINISH,a)}),this.websocket.on(k0.RECONNECT_CREATE_CONNECTION,a=>{this.emit(l0.WS_RECONNECT_CREATE_CONNECTION,a)}),this.websocket.on(k0.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(k0.CLOSED,()=>{this.connectionState=a_.CLOSED}),this.websocket.on(k0.FAILED,()=>{this._disconnectedReason=i_.NETWORK_ERROR,this.connectionState=a_.CLOSED}),this.websocket.on(k0.RECONNECTING,a=>{this._websocketReconnectReason=a,this.joinResponse=void 0,this.connectionState===a_.CONNECTED?this.connectionState=a_.RECONNECTING:this.connectionState=a_.CONNECTING}),this.websocket.on(k0.WILL_RECONNECT,(a,h)=>{if(sO(this,l0.IS_P2P_DISCONNECTED)&&a==="retry")return Ll.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(l0.NEED_RENEW_SESSION),this.emit(l0.DISCONNECT_P2P),h("tryNext");a!=="retry"&&(Ll.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(a)),this.reconnectToken=void 0,this.emit(l0.NEED_RENEW_SESSION),this.emit(l0.DISCONNECT_P2P)),h(a)}),this.websocket.on(k0.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(a=>{Ll.warning("[".concat(this.clientId,"] rejoin failed ").concat(a)),this.reconnect("tryNext",K1.SERVER_ERROR)}):this.join().catch(a=>{if(this.emit(l0.REPORT_JOIN_GATEWAY,a.message||a.code,this.url||""),a instanceof Ql&&a.code===Hl.UNEXPECTED_RESPONSE&&a.data.code===v0.ERR_NO_AUTHORIZED)return Ll.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",K1.SERVER_ERROR);Ll.error("[".concat(this.clientId,"] join gateway request failed"),a.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",K1.SERVER_ERROR):(this.initError=a,this.close())})}),this.websocket.on(k0.REQUEST_NEW_URLS,(a,h)=>{A1(this,l0.REQUEST_RECOVER,this.multiIpOption).then(a).catch(h)}),this.websocket.on(k0.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(M0.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}function jY(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}class jot extends C_{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(a){["tryNext","recover"].includes(a)&&this.resetReconnectCount(a),this._reconnectMode=a}get state(){return this._state}set state(a){a!==this._state&&(this._state=a,this._state==="reconnecting"?this.emit(L_.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(L_.CONNECTED):this._state==="closed"?this.emit(L_.CLOSED):this._state==="failed"&&this.emit(L_.FAILED))}constructor(a,h,g,j){super(),Rl(this,"connectionID",0),Rl(this,"currentURLIndex",0),Rl(this,"reconnectReason",void 0),Rl(this,"_reconnectMode","tryNext"),Rl(this,"_initMutex",void 0),Rl(this,"_name",void 0),Rl(this,"_state","closed"),Rl(this,"_reconnectInterrupter",void 0),Rl(this,"_url",void 0),Rl(this,"_retryConfig",void 0),Rl(this,"_reconnectCount",0),Rl(this,"_forceCloseTimeout",5e3),Rl(this,"_onlineReconnectListener",void 0),Rl(this,"_messageSender",void 0),Rl(this,"_closeEstablishingTransmitter",()=>{}),Rl(this,"_store",void 0),Rl(this,"_joinChannelServiceRecordIndex",void 0),Rl(this,"_transmitter",void 0),Rl(this,"_useCompress",void 0),Rl(this,"_inflateLength",0),Rl(this,"_deflateLength",0),this._store=j,this._name=a,this._retryConfig=function(_e){for(var _n=1;_n<arguments.length;_n++){var _o=arguments[_n]!=null?arguments[_n]:{};_n%2?jY(Object(_o),!0).forEach(function(_a){Rl(_e,_a,_o[_a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_e,Object.getOwnPropertyDescriptors(_o)):jY(Object(_o)).forEach(function(_a){Object.defineProperty(_e,_a,Object.getOwnPropertyDescriptor(_o,_a))})}return _e}({},h),this._useCompress=g}resetReconnectCount(a){Ll.debug("".concat(this._name," reset reconnect count, reason: ").concat(a)),this._reconnectCount=0}close(a,h){var g;if(this.currentURLIndex=0,this.resetReconnectCount("close"),(g=this._messageSender)===null||g===void 0||g.reset(),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const j=this._transmitter;h?setTimeout(()=>j.close(),500):j.close(),this._transmitter=void 0}this.state=a?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(a,h){if(!this._transmitter)return void Ll.warning("[".concat(this._name,"] can not reconnect, no websocket"));var g;a!==void 0&&(this.reconnectMode=a),Ll.debug("[".concat(this._name,"] reconnect is triggered initiative")),typeof this._joinChannelServiceRecordIndex=="number"&&((g=this._store)===null||g===void 0||g.recordJoinChannelService({status:"error",errors:[new Error(h)]},this._joinChannelServiceRecordIndex));const j=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),j&&j.bind(this._transmitter)({code:9999,reason:h})}getInflateData(){const a=this._inflateLength,h=this._deflateLength;return this.clearInflateData(),{inflateLength:a,deflateLength:h}}setInflateData(a){this._deflateLength=this._deflateLength+a.originLength,this._inflateLength=this._inflateLength+a.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}function FY(s,a,h){if("getBigUint64"in DataView.prototype)return s.getBigUint64(a,h);const g=s.getUint32(a,h),j=s.getUint32(a+4,h),_e=Number(!!h),_n=Number(!h);return BigInt(g*_n+j*_e)<<BigInt(32)|BigInt(g*_e+j*_n)}function VY(s,a,h,g){if("setBigUint64"in DataView.prototype)return s.setBigUint64(a,h,g);const j=Number(h>>BigInt(32)),_e=Number(h&BigInt(4294967295));g?(s.setUint32(a+4,j,g),s.setUint32(a,_e,g)):(s.setUint32(a,j,g),s.setUint32(a+4,_e,g))}let Qy;(function(s){s[s.Default=0]="Default",s[s.Ack=1]="Ack"})(Qy||(Qy={}));class Fot{constructor(a,h,g){Rl(this,"version",1),Rl(this,"initialRTO",void 0),Rl(this,"maxBatchAckCount",void 0),Rl(this,"maxRTO",void 0),Rl(this,"initialRTT",void 0),Rl(this,"ID",void 0),Rl(this,"rtt",void 0),Rl(this,"packetNumber",1),Rl(this,"rtoRatioMap",new Map),Rl(this,"timeoutMap",new Map),Rl(this,"unorderedPacketQueue",[]),Rl(this,"batchAckPacketQueue",[]),Rl(this,"lastOrderedPacketNumber",0),Rl(this,"batchAckTimer",void 0),Rl(this,"sendImpl",void 0),Rl(this,"receiveImpl",void 0),this.sendImpl=a,this.receiveImpl=h,this.ID=N_(7,"transmitter-"),this.initialRTO=(g==null?void 0:g.initialRTO)!==void 0?g.initialRTO:wp("TRANSMITTER_INITIAL_RTO"),this.initialRTT=(g==null?void 0:g.initialRTT)!==void 0?g.initialRTT:wp("TRANSMITTER_INITIAL_RTT"),this.rtt=(g==null?void 0:g.initialRTT)!==void 0?g.initialRTT:wp("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=(g==null?void 0:g.maxBatchAckCount)!==void 0?g.maxBatchAckCount:wp("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=(g==null?void 0:g.maxRTO)!==void 0?g.maxRTO:wp("TRANSMITTER_MAX_RTO")}packetize(a,h){return{type:Qy.Default,version:this.version,packetNumber:h,payload:a}}serialize(a){switch(a.type){case Qy.Default:{let h;typeof a.payload=="string"?h=new TextEncoder().encode(a.payload):h=a.payload;const g=new ArrayBuffer(h.length+15),j=new DataView(g);return j.setUint16(0,a.version),j.setUint8(2,a.type),j.setUint32(3,a.packetNumber),VY(j,7,BigInt(a.sendTs)),new Uint8Array(j.buffer).set(h,15),g}case Qy.Ack:{const h=new ArrayBuffer(16),g=new DataView(h);return g.setUint16(0,a.version),g.setUint8(2,a.type),g.setUint32(3,a.maxAckPacketNumber),g.setUint8(7,a.shift),VY(g,8,BigInt(a.ackSendTs)),h}}}deserialize(a){const h=new DataView(a),g=h.getUint16(0),j=h.getUint8(2);switch(j){case Qy.Default:{const _e=h.getUint32(3),_n=FY(h,7),_o=a.slice(15),_a=new TextDecoder().decode(_o);return{version:g,type:j,packetNumber:_e,sendTs:Number(_n),payload:_a}}case Qy.Ack:{const _e=h.getUint32(3),_n=h.getUint8(7),_o=FY(h,8);return{version:g,type:j,maxAckPacketNumber:_e,shift:_n,ackSendTs:Number(_o)}}default:throw Ll.error("[".concat(this.ID,"] Unrecognized packet type ").concat(j)),new Error("Unrecognized packet type ".concat(j))}}sendMessage(a){const h=this.packetize(a,this.packetNumber);this.packetNumber=this.packetNumber===4294967295?1:this.packetNumber+1;const g=this.calculateRTO(h),j=window.setTimeout(()=>{this.resendMessage(h)},g);this.timeoutMap.set(h.packetNumber,j),this.sendPacket(h)}onData(a){const h=this.deserialize(a);h.type===Qy.Default?this.ack(h):h.type===Qy.Ack&&(this.updateRTT(h,Math.round(performance.now())),this.clearRTO(h))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach(a=>{let[h,g]=a;window.clearTimeout(g)}),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,this.batchAckTimer!==void 0&&window.clearTimeout(this.batchAckTimer)}resendMessage(a){const h=this.calculateRTO(a),g=window.setTimeout(()=>{this.resendMessage(a)},h);this.timeoutMap.set(a.packetNumber,g),this.sendPacket(a)}calculateRTO(a){const h=this.rtoRatioMap.get(a.packetNumber);if(h===void 0)return this.rtoRatioMap.set(a.packetNumber,1),this.initialRTO;{const g=9*this.rtt/8*h;return this.rtoRatioMap.set(a.packetNumber,h+1),g>this.maxRTO?this.maxRTO:g}}updateRTT(a,h){const g=a.ackSendTs;this.rtt=this.rtt*(7/8)+(h-g-this.rtt)/8}ack(a){if(a.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(a):(this.batchAckPacketQueue.push(a),this.batchAckTimer=window.setTimeout(()=>{this.batchAck()},this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(a.payload);;){const h=this.unorderedPacketQueue[0];if(!h){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(h.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else if(a.packetNumber<=this.lastOrderedPacketNumber){const h={ackSendTs:a.sendTs,maxAckPacketNumber:a.packetNumber,shift:0,type:Qy.Ack,version:this.version};this.sendPacket(h)}else if(a.packetNumber>this.lastOrderedPacketNumber){this.unorderedPacketQueue[a.packetNumber-this.lastOrderedPacketNumber-2]=a;const h={ackSendTs:a.sendTs,maxAckPacketNumber:a.packetNumber,shift:0,type:Qy.Ack,version:this.version};this.sendPacket(h)}}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0;const a={ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:Qy.Ack,version:this.version};this.sendPacket(a),this.batchAckPacketQueue=[]}sendPacket(a){a.type===Qy.Default&&(a.sendTs=Math.round(performance.now()));const h=this.serialize(a);this.sendImpl(h)}clearRTO(a){for(let h=a.maxAckPacketNumber-a.shift;h<=a.maxAckPacketNumber;h++){const g=this.timeoutMap.get(h);g!==void 0&&window.clearTimeout(g),this.timeoutMap.delete(h),this.rtoRatioMap.delete(h)}}}class Vot extends C_{get queue(){return[...this.highPriorityQueue,...this.lowPriorityQueue]}constructor(a){super(),Rl(this,"lowPriorityQueue",[]),Rl(this,"highPriorityQueue",[]),Rl(this,"AgoraTransmissionManager",void 0),this.AgoraTransmissionManager=a}reset(){this.lowPriorityQueue=[],this.highPriorityQueue=[]}pushMessage(a){arguments.length>1&&arguments[1]!==void 0&&arguments[1]?this.highPriorityQueue.push(a):this.lowPriorityQueue.push(a),this.sendMessage()}sendMessage(){const a=this.queue.length;let h=0;h=a<5?15*a:60+3*(a-4),setTimeout(()=>{this._sendMessage()},h)}_sendMessage(){if(!this.queue.length)return;const a=this.AgoraTransmissionManager.getConnection();if(!a)return;const h=this.queue.shift();return this.lowPriorityQueue.includes(h)?this.lowPriorityQueue.shift():this.highPriorityQueue.shift(),a.sendMessage(h.compressed),h}}class BY extends jot{constructor(a,h){super(a,h,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3?arguments[3]:void 0),Rl(this,"_initMutex",void 0),Rl(this,"_reconnectInterrupter",void 0),Rl(this,"_url",void 0),Rl(this,"_transmitter",void 0),Rl(this,"_addresses",void 0),Rl(this,"_reliableTransmission",void 0),this._initMutex=new B1("datachannel");const{timeout:g,timeoutFactor:j}=h,_e=Math.max(300,Math.floor(3*g/5)),_n=Math.max(1.2,Math.floor(8*j)/10);M1.ONLINE&&(this._retryConfig.timeout=_e,this._retryConfig.timeoutFactor=_n),q_.on(_R.NETWORK_STATE_CHANGE,(_o,_a)=>{_o!==_a&&(this.resetReconnectCount("network state change: ".concat(_a," -> ").concat(_o)),_o===M1.ONLINE?(this._retryConfig.timeout=_e,this._retryConfig.timeoutFactor=_n):(this._retryConfig.timeout=g,this._retryConfig.timeoutFactor=j))})}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}async init(a){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;this._forceCloseTimeout=h;const g=(j,_e)=>{this._addresses=a,this.currentURLIndex=this._addresses.findIndex(_o=>_o.fingerprint||wp("FINGERPRINT"));const _n=this._addresses[this.currentURLIndex];this.state="connecting",this._messageSender=new Vot(this),this.createTransmitterConnection(_n).then(j).catch(_e),this.once(L_.CLOSED,()=>_e(new Ql(Hl.WS_DISCONNECT))),this.once(L_.CONNECTED,()=>j())};return this._initMutex.lock().then(j=>new s0((_e,_n)=>{g(_e,_n)}).then(()=>{j()}).catch(()=>{j()}))}sendMessage(a){let h=arguments.length>1&&arguments[1]!==void 0&&arguments[1],g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new Ql(Hl.WS_ABORT,"datachannel is not ready");try{let j=null;j=g?this.sendMessageWithUint8Array(a):this.sendMessageWithJSON(a),h?this._reliableTransmission.sendMessage(j.compressed):this._messageSender.pushMessage(j)}catch(j){throw new Ql(Hl.WS_ERR,"send datachannel signal message error"+j.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(a){const h=JSON.stringify(a);return{compressed:h,compressedLength:h.length,origin:a}}sendMessageWithUint8Array(a){return{compressed:a,compressedLength:a.byteLength,origin:a}}createTransmitterConnection(a){return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(a.ip,":").concat(a.port),new s0((h,g)=>{var j;const _e=()=>{Ll.debug("[".concat(this._name,"] datachannel opened:"),this._url),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),h()},_n=async ba=>{var xa;if((xa=this._closeEstablishingTransmitter)===null||xa===void 0||xa.call(this),Ll.debug("[".concat(this._name,"] datachannel close ").concat(this._url,", code: ").concat(ba.code,", reason: ").concat(ba.reason,", current mode: ").concat(this.reconnectMode)),this._reconnectCount<this._retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=ba.reason,this.state="reconnecting");const El=tT(this,L_.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,yl=await this.reconnectWithAction(El);if(this.state==="closed")return void Ll.debug("[".concat(this.connectionID,"] dc is closed, no need to reconnect"));if(!yl)return g(new Ql(Hl.WS_DISCONNECT,"datachannel reconnect failed: ".concat(ba.code))),void this.close(!0);h()}else g(new Ql(Hl.WS_DISCONNECT,"datachannel close: ".concat(ba.code))),this.close()},_o=ba=>{var xa;(xa=this._reliableTransmission)===null||xa===void 0||xa.onData(ba.data)};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),Ll.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(a)));const _a=(j=this._store)===null||j===void 0?void 0:j.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),_r=Date.now();A1(this,L_.TO_CONNECT_DATACHANNEL,a).then(ba=>{var xa,El;if(!ba)throw new Error("transmissonInfo not exist yet");const{transmitter:yl,close:Ol}=ba;this._transmitter=yl,(xa=this._store)===null||xa===void 0||xa.signalChannelOpen();const Al=Date.now()-_r;Ll.debug("[choose dc] dc open cost ".concat(Al,"ms")),this._reliableTransmission=new Fot(Nl=>{var Ml;this._transmitter&&this._transmitter.readyState==="open"&&((Ml=this._transmitter)===null||Ml===void 0||Ml.send(Nl))},Nl=>{typeof Nl=="string"&&this.emit(L_.ON_MESSAGE,Nl)}),this._closeEstablishingTransmitter=()=>{var Nl;(Nl=this._reliableTransmission)===null||Nl===void 0||Nl.close(),this._reliableTransmission=void 0,Ol()},_e&&_e(),yl.onclose=_n,yl.onmessage=_o,(El=this._store)===null||El===void 0||El.recordJoinChannelService({endTs:Date.now(),status:"success"},_a),this._joinChannelServiceRecordIndex=_a}).catch(ba=>{var xa;if((xa=this._store)===null||xa===void 0||xa.recordJoinChannelService({endTs:Date.now(),status:ba instanceof Ql&&ba.code===Hl.WS_ABORT?"aborted":"error",errors:[ba]},_a),this.state!=="closed"){if(ba instanceof Ql&&ba.code===Hl.WS_ERR){const El=new Ql(Hl.WS_ERR,"init datachannel failed! Error: ".concat(ba.toString()));return Ll.error("[".concat(this._name,"]").concat(El)),void g(El)}_n&&_n(ba)}else g(new Ql(Hl.WS_DISCONNECT,"datachannel is closed: ".concat(ba.toString())))})})}async reconnectWithAction(a){let h=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this._reconnectCount>=this._retryConfig.maxRetryCount||!this._addresses||this.state==="closed")return!1;this._onlineReconnectListener||q_.networkState!==M1.OFFLINE||(this._onlineReconnectListener=q_.onlineWaiter&&q_.onlineWaiter.then(()=>{this._onlineReconnectListener=void 0}));let g=!0;if(this._reconnectInterrupter=()=>{g=!1},h){const _n=N6(this._reconnectCount,this._retryConfig);Ll.debug("[".concat(this._name,"] wait ").concat(_n,"ms to reconnect datachannel, mode: ").concat(a)),await s0.race([g1(_n),this._onlineReconnectListener||new s0(()=>{})])}if(this.state==="closed"||!g)return!1;this._reconnectCount+=1;const j=async(_n,_o)=>{this.emit(L_.RECONNECT_CREATE_CONNECTION,_o),await this.createTransmitterConnection(_n)};try{if(a==="retry"){const _n=this._addresses[this.currentURLIndex];this.emit(L_.RECONNECT_WAITTING_FINISH,a),await j(_n,a)}else if(a==="tryNext"){this.currentURLIndex+=1;for(let _o=this.currentURLIndex;_o<this._addresses.length;_o++){if(this._addresses[_o].fingerprint||wp("FINGERPRINT")){this.currentURLIndex=_o;break}this.currentURLIndex+=1}if(this.currentURLIndex>=this._addresses.length)return Ll.debug("[".concat(this._name,"] the available addresses are exhausted, change to recover")),await this.reconnectWithAction("recover",!1);Ll.debug("[".concat(this._name,"] datachannel url length: ").concat(this._addresses.length," current index: ").concat(this.currentURLIndex));const _n=this._addresses[this.currentURLIndex];this.emit(L_.RECONNECT_WAITTING_FINISH,a),await j(_n,a)}else a==="recover"&&(Ll.debug("[".concat(this._name,"] start to failback to websocket")),this.resetReconnectCount("recover mode"),this.emit(L_.RECONNECT_WAITTING_FINISH,a),this.emit(L_.FAILBACK));return!0}catch(_n){var _e;return Ll.error("[".concat(this._name,"] reconnect failed"),_n.toString()),_n!=null&&(_e=_n.data)!==null&&_e!==void 0&&_e.desc&&Array.isArray(_n.data.desc)&&_n.data.desc.length&&_n.data.desc.includes("dynamic key expired")?(this.emit(L_.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(a,h)}}}class jT extends C_{get connectionState(){return this._connectionState}set connectionState(a){a!==this._connectionState&&(this._connectionState=a,a===a_.CONNECTED?this.emit(l0.WS_CONNECTED):a===a_.RECONNECTING?this.emit(l0.WS_RECONNECTING,this._websocketReconnectReason):a===a_.CLOSED&&this.emit(l0.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(a,h){super(),Rl(this,"_disconnectedReason",void 0),Rl(this,"_websocketReconnectReason",void 0),Rl(this,"_connectionState",a_.CLOSED),Rl(this,"reconnectToken",void 0),Rl(this,"websocket",void 0),Rl(this,"openConnectionTime",void 0),Rl(this,"clientId",void 0),Rl(this,"lastMsgTime",Date.now()),Rl(this,"uploadCache",[]),Rl(this,"uploadCacheInterval",void 0),Rl(this,"rttRolling",new MY(5)),Rl(this,"pingpongTimer",void 0),Rl(this,"inflateDataTimer",void 0),Rl(this,"pingpongTimeoutCount",0),Rl(this,"joinResponse",void 0),Rl(this,"multiIpOption",void 0),Rl(this,"initError",void 0),Rl(this,"spec",void 0),Rl(this,"store",void 0),Rl(this,"onWebsocketMessage",g=>{if(g instanceof ArrayBuffer)return void this.emit(l0.ON_BINARY_DATA,g);const j=JSON.parse(g);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(j,"_id")){const _e="res-@".concat(j._id);this.emit(_e,j._result,j._message)}else if(Object.prototype.hasOwnProperty.call(j,"_type")&&(this.emit(j._type,j._message),j._type===M0.ON_NOTIFICATION&&this.handleNotification(j._message),j._type===M0.ON_USER_BANNED))switch(j._message.error_code){case 14:this.close(i_.UID_BANNED);break;case 15:this.close(i_.IP_BANNED);break;case 16:this.close(i_.CHANNEL_BANNED)}}),this.clientId=a.clientId,this.spec=a,this.store=h,this.websocket=new BY("gateway-".concat(this.clientId),this.spec.retryConfig,!0,h),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===a_.CONNECTED&&this.reconnect("retry",$S.OFFLINE)})}async request(a,h,g,j){const _e=N_(6,""),_n={_id:_e,_type:a,_message:h},_o=this.websocket.connectionID,_a=()=>new s0((Ol,Al)=>{if(this.connectionState===a_.CONNECTED)return Ol();const Nl=()=>{this.off(l0.WS_CLOSED,Ml),Ol()},Ml=()=>{this.off(l0.WS_CONNECTED,Nl),Al(new Ql(Hl.WS_ABORT))};this.once(l0.WS_CONNECTED,Nl),this.once(l0.WS_CLOSED,Ml),a!==T0.PUBLISH&&a!==T0.SUBSCRIBE&&a!==T0.UNSUBSCRIBE&&a!==T0.UNPUBLISH&&a!==T0.CONTROL&&a!==T0.RESTART_ICE||this.once(l0.DISCONNECT_P2P,()=>{Al(new Ql(Hl.DISCONNECT_P2P))}),a!==T0.PUBLISH&&a!==T0.RESTART_ICE||this.once(l0.ABORT_P2P_EXECUTION,()=>{Al(new Ql(Hl.DISCONNECT_P2P))})});if(this.connectionState!==a_.CONNECTING&&this.connectionState!==a_.RECONNECTING||a===T0.JOIN||a===T0.REJOIN||await _a(),a===T0.LEAVE&&(this.websocket.unbindDcCloseEventListener(),j=!0),this.websocket.sendMessage(_n,!0,!1),j)return;const _r=new s0((Ol,Al)=>{let Nl=!1;const Ml=(up,_p)=>{Nl=!0,Ol({isSuccess:up==="success",message:_p||{}}),this.off(l0.WS_CLOSED,Fl),this.off(l0.WS_RECONNECTING,Fl),this.emit(l0.REQUEST_SUCCESS,a,h)};this.once("res-@".concat(_e),Ml);const Fl=()=>{Al(new Ql(Hl.WS_ABORT,"type: ".concat(a))),this.off(l0.WS_CLOSED,Fl),this.off(l0.WS_RECONNECTING,Fl),this.off("res-@".concat(_e),Ml)};this.once(l0.WS_CLOSED,Fl),this.once(l0.WS_RECONNECTING,Fl),g1(wp("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==_o||Nl||(Ll.warning("dc request timeout, type: ".concat(a)),this.emit(l0.REQUEST_TIMEOUT,a,h))})});let ba=null;try{ba=await _r}catch(Ol){if(this.connectionState===a_.CLOSED||a===T0.LEAVE)throw new Ql(Hl.WS_ABORT);return!this.spec.forceWaitGatewayResponse||g?Ol.throw():a===T0.JOIN||a===T0.REJOIN?null:(await _a(),await this.request(a,h))}if(ba.isSuccess)return ba.message;const xa=Number(ba.message.error_code||ba.message.code),El=$P(xa),yl=new Ql(Hl.UNEXPECTED_RESPONSE,"".concat(El.desc,": ").concat(ba.message.error_str),{code:xa,data:ba.message});return El.action==="success"?ba.message:(Ll.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(a,", error_code: ").concat(xa,", message: ").concat(El.desc,", action: ").concat(El.action)),xa===v0.ERR_TOO_MANY_BROADCASTERS?((a===T0.JOIN||a===T0.REJOIN)&&(this.initError=yl,this.close()),yl.throw()):El.action==="failed"?yl.throw():El.action==="quit"?(this.initError=yl,this.close(),yl.throw()):(xa===v0.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=ba.message.option,Ll.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",$S.MULTI_IP)):this.reconnect(El.action,$S.SERVER_ERROR),a===T0.JOIN||a===T0.REJOIN?null:await this.request(a,h)))}waitMessage(a,h){return new s0(g=>{const j=_e=>{(!h||h(_e))&&(this.off(a,j),g(_e))};this.on(a,j)})}upload(a,h){const g={_type:a,_message:h};try{this.websocket.sendMessage(g)}catch{const _e=wp("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(g),this.uploadCache.length>_e&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==a_.CONNECTED)return;const _n=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(_n._type,_n._message)},wp("UPLOAD_CACHE_INTERVAL")||2e3))}}send(a,h){const g={_type:a,_message:h};this.websocket.sendMessage(g)}init(a,h){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new s0((g,j)=>{this.once(l0.WS_CONNECTED,()=>g(this.joinResponse)),this.once(l0.WS_CLOSED,()=>j(this.initError||new Ql(Hl.WS_ABORT))),this.connectionState=a_.CONNECTING,this.websocket.init(a).catch(j),this.websocket.once(L_.FAILBACK,()=>{this.openConnectionTime===void 0&&j(new Ql(Hl.INIT_DATACHANNEL_TIMEOUT))}),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval(()=>{this.handleInflateData()},2e4),setTimeout(()=>{h&&this.openConnectionTime===void 0&&(Ll.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),j(new Ql(Hl.INIT_DATACHANNEL_TIMEOUT)))},wp("DC_JOIN_WITH_FAILBACK"))})}close(a){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=a||i_.LEAVE,this.connectionState=a_.CLOSED,Ll.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),a===i_.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new BY("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(l0.ABORT_P2P_EXECUTION);const a=await A1(this,l0.DATACHANNEL_CONNECTING),h=await this.request(T0.JOIN,a);if(!h)return this.emit(l0.REPORT_JOIN_GATEWAY,Hl.TIMEOUT,this.url||""),!1;this.joinResponse=h,this.emit(l0.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=a_.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new Ql(Hl.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const a=sO(this,l0.REQUEST_REJOIN_INFO);a.token=this.reconnectToken;const h=await this.request(T0.REJOIN,a);return!!h&&(this.connectionState=a_.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),h.peers&&h.peers.forEach(g=>{this.emit(M0.ON_USER_ONLINE,{uid:g.uid}),g.audio&&this.emit(M0.ON_ADD_AUDIO_STREAM,{uid:g.uid,uint_id:g.uint_id,audio:!0,ssrcId:g.audio_ssrc}),g.video&&this.emit(M0.ON_ADD_VIDEO_STREAM,{uid:g.uid,uint_id:g.uint_id,video:!0,ssrcId:g.video_ssrc}),g.audio_mute?this.emit(M0.MUTE_AUDIO,{uid:g.uid}):this.emit(M0.UNMUTE_AUDIO,{uid:g.uid}),g.video_mute?this.emit(M0.MUTE_VIDEO,{uid:g.uid}):this.emit(M0.UNMUTE_VIDEO,{uid:g.uid}),g.audio_enable_local?this.emit(M0.ENABLE_LOCAL_AUDIO,{uid:g.uid}):this.emit(M0.DISABLE_LOCAL_AUDIO,{uid:g.uid}),g.video_enable_local?this.emit(M0.ENABLE_LOCAL_VIDEO,{uid:g.uid}):this.emit(M0.DISABLE_LOCAL_VIDEO,{uid:g.uid}),g.audio||g.video||this.emit(M0.ON_REMOVE_STREAM,{uid:g.uid,uint_id:g.uint_id})}),!0)}reconnect(a,h){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(a,h)}handleNotification(a){Ll.debug("[".concat(this.clientId,"] receive notification: "),a);const h=$P(a.code);if(h.action!=="success"){if(h.action!=="failed")return h.action==="quit"?(h.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(i_.UID_BANNED),void this.close()):void this.reconnect(h.action,$S.SERVER_ERROR);Ll.error("[".concat(this.clientId,"] ignore error: "),h.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const a=wp("PING_PONG_TIME_OUT"),h=Date.now();this.pingpongTimeoutCount>=a&&(Ll.warning("PINGPONG Timeout. Last Socket Message: ".concat(h-this.lastMsgTime,"ms")),h-this.lastMsgTime>wp("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",$S.TIMEOUT):this.request(T0.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const g=Date.now()-h;this.rttRolling.add(g),wp("REPORT_STATS")&&this.send(T0.PING_BACK,{pingpongElapse:g})}).catch(g=>{})}handleInflateData(){const{inflateLength:a,deflateLength:h}=this.websocket.getInflateData();a!==0&&h!==0&&this.upload(sy.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:h,ws_inflate_length:a})}handleWebsocketEvents(){this.websocket.on(L_.RECONNECT_WAITTING_FINISH,a=>{this.emit(l0.WS_RECONNECT_WAITTING_FINISH,a)}),this.websocket.on(L_.RECONNECT_CREATE_CONNECTION,a=>{this.emit(l0.WS_RECONNECT_CREATE_CONNECTION,a)}),this.websocket.on(L_.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(L_.CLOSED,()=>{this.connectionState=a_.CLOSED}),this.websocket.on(L_.FAILED,()=>{this._disconnectedReason=i_.NETWORK_ERROR,this.connectionState=a_.CLOSED}),this.websocket.on(L_.RECONNECTING,a=>{this._websocketReconnectReason=a,this.joinResponse=void 0,this.connectionState===a_.CONNECTED?this.connectionState=a_.RECONNECTING:this.connectionState=a_.CONNECTING}),this.websocket.on(L_.WILL_RECONNECT,(a,h)=>{if(sO(this,l0.IS_P2P_DISCONNECTED)&&a==="retry")return Ll.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(l0.NEED_RENEW_SESSION),this.emit(l0.DISCONNECT_P2P),h("tryNext");a!=="retry"&&(Ll.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(a)),this.reconnectToken=void 0,this.emit(l0.NEED_RENEW_SESSION),this.emit(l0.DISCONNECT_P2P)),h(a)}),this.websocket.on(L_.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(a=>{Ll.warning("[".concat(this.clientId,"] rejoin failed ").concat(a)),this.reconnect("tryNext",$S.SERVER_ERROR)}):this.join().catch(a=>{if(this.emit(l0.REPORT_JOIN_GATEWAY,a.message||a.code,this.url||""),a instanceof Ql&&a.code===Hl.UNEXPECTED_RESPONSE&&a.data.code===v0.ERR_NO_AUTHORIZED)return Ll.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",$S.SERVER_ERROR);Ll.error("[".concat(this.clientId,"] join gateway request failed"),a.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",$S.SERVER_ERROR):(this.initError=a,this.close())})}),this.websocket.on(L_.REQUEST_NEW_URLS,(a,h)=>{A1(this,l0.REQUEST_RECOVER,this.multiIpOption).then(a).catch(h)}),this.websocket.on(L_.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(M0.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(L_.TO_CONNECT_DATACHANNEL,async(a,h,g)=>A1(this,l0.DATACHANNEL_PRECONNECT,a).then(h).catch(g)),this.websocket.on(L_.FAILBACK,()=>{this.openConnectionTime!==void 0&&this.emit(l0.DATACHANNEL_FAILBACK)})}}function GY(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function rT(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?GY(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):GY(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}const K8=new Map;class Bot extends C_{get state(){return this._state}set state(a){if(a===this._state)return;const h=this._state;this._state=a,a==="DISCONNECTED"&&this._disconnectedReason?this.emit(I_.CONNECTION_STATE_CHANGE,a,h,this._disconnectedReason):this.emit(I_.CONNECTION_STATE_CHANGE,a,h)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(a){Ll.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(a)),this._joinGatewayStartTime=a}constructor(a,h){super(),Rl(this,"store",void 0),Rl(this,"joinInfo",void 0),Rl(this,"key",void 0),Rl(this,"signal",void 0),Rl(this,"role",void 0),Rl(this,"inChannelInfo",{joinAt:null,duration:0}),Rl(this,"spec",void 0),Rl(this,"_state","DISCONNECTED"),Rl(this,"_statsCollector",void 0),Rl(this,"_disconnectedReason",void 0),Rl(this,"isSignalRecover",!1),Rl(this,"hasChangeBGPAddress",!1),Rl(this,"trafficStatsInterval",void 0),Rl(this,"networkQualityInterval",void 0),Rl(this,"_joinGatewayStartTime",0),Rl(this,"_signalTimeout",!1),Rl(this,"_clientRoleOptions",void 0),Rl(this,"_isProactiveJoin",!1),this.store=a,this.spec=h;const g=O1().supportDataChannel&&wp("SIGNAL_CHANNEL");this.signal=g?new jT(rT(rT({},h),{},{retryConfig:h.websocketRetryConfig}),a):new UY(rT(rT({},h),{},{retryConfig:h.websocketRetryConfig}),a),this._statsCollector=h.statsCollector,this.role=h.role||"audience",this._clientRoleOptions=h.clientRoleOptions,this.handleSignalEvents()}async join(a,h,g){if(this.signal instanceof jT){let _a=!1;a.cloudProxyServer!=="disabled"?(Ll.debug("[".concat(this.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(a.cloudProxyServer,")")),_a=!0):"".concat(a.apResponse.cid,"_").concat(a.apResponse.cert).length>255||"".concat(a.apResponse.cid,"_").concat(a.apResponse.cert).length<22?(Ll.debug("[".concat(this.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),_a=!0):a.apResponse.addresses.some(_r=>_r.fingerprint)||wp("FINGERPRINT")||(Ll.debug("[".concat(this.store.clientId,"] Dc is not supported, because fingerprint does not exist")),_a=!0),_a&&this.resetSignal()}this.store.joinGatewayStart(),a.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const j=Date.now();let _e=K8.get(a.cname);if(_e||(_e=new Map,K8.set(a.cname,_e)),this._isProactiveJoin=!0,_e.has(a.uid)){const _a=new Ql(Hl.UID_CONFLICT);throw d0.joinGateway(a.sid,{lts:j,succ:!1,ec:_a.message,addr:null,uid:a.uid,cid:a.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!a.proxyServer,signalChannel:this.signal instanceof jT?"1":"0"}),this._isProactiveJoin=!1,_a}_e.set(a.uid,!0),this.joinInfo=a,this.key=h;let _n=0;this.joinGatewayStartTime=j;const _o=a.proxyServer;try{let _a;if(Ll.debug("[".concat(this.store.clientId,"] use ").concat(this.signal instanceof jT?"datachannel":"websocket"," join uid ").concat(_n)),this.signal instanceof jT)_a=await this.signal.init(a.apResponse.addresses,g);else{const _r=a.proxyServer,ba=_r?a.gatewayAddrs.map(xa=>{const El=xa.address.split(":");return"wss://".concat(_r,"/ws/?h=").concat(El[0],"&p=").concat(El[1])}):a.gatewayAddrs.map(xa=>"wss://".concat(xa.address));_a=await this.signal.init(ba,g)}_n=_a.uid,Ll.debug("[".concat(this.store.clientId,"] ").concat(this.signal instanceof jT?"datachannel":"websocket"," join uid ").concat(_n," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(_a){throw _a&&_a.code===Hl.INIT_WEBSOCKET_TIMEOUT?(Ll.warning("[".concat(this.store.clientId,"] User join failed"),_a.toString()),_a):_a&&_a.code===Hl.INIT_DATACHANNEL_TIMEOUT?(Ll.warning("[".concat(this.store.clientId,"] User join datachannel failed"),_a.toString()),this.resetSignal(),_a):(Ll.error("[".concat(this.store.clientId,"] User join failed"),_a.toString()),d0.joinGateway(a.sid,{lts:j,succ:!1,ec:_a.message,addr:this.signal.url,uid:a.uid,cid:a.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!_o,signalChannel:this.signal instanceof jT?"1":"0"}),this._isProactiveJoin=!1,_e.delete(a.uid),this.signal.close(),_a)}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),Ll.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(_a=>{Ll.warning("[".concat(this.store.clientId,"] get traffic stats error"),_a.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(I_.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(I_.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(I_.NETWORK_QUALITY,{uplinkNetworkQuality:vz(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:vz(this._statsCollector.trafficStats.B_dnq)}):this.emit(I_.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),_n}async leave(){let a=arguments.length>0&&arguments[0]!==void 0&&arguments[0],h=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){h!==i_.FALLBACK&&(this.state="DISCONNECTING");try{a||this.signal.connectionState!==a_.CONNECTED||await function(g,j){return j===1/0?g:s0.race([g,sit(j)])}(this.signal.request(T0.LEAVE,void 0,!0),3e3)}catch(g){Ll.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),g)}this.signal.close(h),h!==i_.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(a,h,g){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ql(Hl.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const j={state:"offer",p2p_id:this.store.p2pId,ortc:h,mode:this.spec.mode,extend:wp("PUB_EXTEND"),tcc:!!wp("PUBLISH_TCC")};try{return(await this.signal.request(T0.PUBLISH,j,!0))._message}catch(_e){if(g&&_e.data&&_e.data.code===v0.ERR_PUBLISH_REQUEST_INVALID)return Ll.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),_e.toString()),await this.tryUnpubBeforeRepub(a,h),this.publish(a,h,!1);throw _e}}async unpublish(a,h){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ql(Hl.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(T0.UNPUBLISH,{stream_id:h,ortc:a},!0)}catch(g){Ll.warning("unpublish warning: ",g)}}async subscribe(a,h,g){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ql(Hl.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const j={stream_id:a,stream_type:h.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,tcc:!!wp("SUBSCRIBE_TCC"),extend:wp("SUB_EXTEND"),ssrcId:h.ssrcId};try{return(await this.signal.request(T0.SUBSCRIBE,j,!0))._message}catch(_e){if(g&&_e.data&&_e.data.code===v0.ERR_SUBSCRIBE_REQUEST_INVALID)return Ll.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),_e.toString()),await this.tryUnsubBeforeResub(a,h),await this.subscribe(a,h,!1);throw _e}}async subscribeAll(a,h){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ql(Hl.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const g={p2p_id:this.store.p2pId,users:a,dtx:!1};try{return await this.signal.request(T0.SUBSCRIBE_STREAMS,g,!0)}catch(j){if(h&&j.data&&j.data.code===v0.ERR_SUBSCRIBE_REQUEST_INVALID)return Ll.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),j.toString()),await this.tryMassUnsubBeforeResub(a),await this.subscribeAll(a,!1);throw j}}async setVideoProfile(a){const h=function(g){if(!(g.bitrateMax&&g.bitrateMin&&g.frameRate&&g.height&&g.width))return;let j=g.frameRate,_e=g.width,_n=g.height,_o=!0;return typeof j!="number"&&(j=j.exact||j.ideal||j.max||j.min||0,j||(_o=!1)),typeof _e!="number"&&(_e=_e.exact||_e.ideal||_e.max||_e.min||0,_e||(_o=!1)),typeof _n!="number"&&(_n=_n.exact||_n.ideal||_n.max||_n.min||0,j||(_o=!1)),_o?{stream_type:0,width:_e,height:_n,fps:j,start_bps:1e3*g.bitrateMax,min_bps:1e3*g.bitrateMin,target_bps:1e3*g.bitrateMax}:void 0}(a);if(h)return this.signal.request(T0.SET_VIDEO_PROFILE,h);Ll.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(a,h){try{await this.signal.request(T0.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:a,stream_id:h},!0)}catch(g){Ll.warning("unsubscribe warning: ",g)}}async massUnsubscribe(a){try{await this.signal.request(T0.UNSUBSCRIBE_STREAMS,a,!0)}catch(h){Ll.warning("unsubscribeAll warning: ",h)}}async reconnectPC(a){const{iceParameters:h,dtlsParameters:g,rtpCapabilities:j}=a;return{gatewayEstablishParams:await this.signal.request(T0.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:h,dtlsParameters:g,rtpCapabilities:j}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(T0.GATEWAY_INFO)}renewToken(a){return this.signal.request(T0.RENEW_TOKEN,a)}async setClientRole(a,h){if(h&&(this._clientRoleOptions=Object.assign({},h)),this.state!=="CONNECTED")return void(this.role=a);let g;g=a==="audience"?this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:0,await this.signal.request(T0.SET_CLIENT_ROLE,{role:a,level:g,client_ts:Date.now()}),this.role=a}async setRemoteVideoStreamType(a,h){await this.signal.request(T0.SWITCH_VIDEO_STREAM,{stream_id:a,stream_type:h})}async setDefaultRemoteVideoStreamType(a){await this.signal.request(T0.DEFAULT_VIDEO_STREAM,{stream_type:a})}async setStreamFallbackOption(a,h){await this.signal.request(T0.SET_FALLBACK_OPTION,{stream_id:a,fallback_type:h})}async pickSVCLayer(a,h){await this.signal.request(T0.PICK_SVC_LAYER,{stream_id:a,spatial_layer:h.spatialLayer,temporal_layer:h.temporalLayer})}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),rT({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(T0.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const a=K8.get(this.joinInfo.cname);a&&a.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const a=function(h){let g;return g=h.startsWith("dc")?h.match(/(dc\:\/\/)?([^:]+):(\d+)/):h.match(/(wss\:\/\/)?([^:]+):(\d+)/),g?{username:Cy.username,password:Cy.password,turnServerURL:g[2],tcpport:parseInt(g[3])+30,udpport:parseInt(g[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],a&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(rT(rT({},Cy),{},{turnServerURL:a.turnServerURL,tcpport:a.tcpport,udpport:a.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const a=await this.signal.request(T0.TRAFFIC_STATS,void 0,!0);a.timestamp=Date.now(),a.peer_delay.forEach(h=>{const g=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(j=>j.peer_uid===h.peer_uid);g&&g.B_st!==h.B_st&&mS(()=>{this.emit(I_.STREAM_TYPE_CHANGE,h.peer_uid,h.B_st)})}),this._statsCollector.updateTrafficStats(a)}getJoinMessage(a){if(!this.joinInfo||!this.key)throw new Ql(Hl.UNEXPECTED_ERROR,"can not generate join message, no join info");const h=Object.assign({},this.joinInfo.apResponse);let g=wp("REPORT_APP_SCENARIO");if(typeof g!="string")try{g=JSON.stringify(g)}catch{g=void 0}g&&g.length>128&&(g=void 0);const j=rT({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:Ky,browser:navigator.userAgent,process_id:wp("PROCESS_ID"),mode:this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:h,extend:wp("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:g,attributes:{userAttributes:{enablePublishedUserList:wp("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:wp("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:typeof wp("SUBSCRIBE_AUDIO_FILTER_TOPN")=="number"?wp("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:typeof wp("ENABLE_PUBLISH_AUDIO_FILTER")=="boolean"?wp("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:typeof wp("ENABLE_USER_LICENSE_CHECK")=="boolean"?wp("ENABLE_USER_LICENSE_CHECK"):void 0}},join_ts:this.joinGatewayStartTime},a);return this.joinInfo.stringUid&&(j.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(j.aes_mode=this.joinInfo.aesmode,wp("ENCRYPT_AES")?(j.aes_secret=this.joinInfo.aespassword,j.aes_encrypt=!0):j.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(j.aes_salt=this.joinInfo.aessalt)),h.addresses[this.signal.websocket.currentURLIndex]&&(j.ap_response.ticket=h.addresses[this.signal.websocket.currentURLIndex].ticket,delete h.addresses),this.joinInfo.defaultVideoStream!==void 0&&(j.default_video_stream=this.joinInfo.defaultVideoStream),j}getRejoinMessage(){if(!this.joinInfo)throw new Ql(Hl.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(l0.WS_RECONNECT_WAITTING_FINISH,a=>{["tryNext","recover"].includes(a)&&this.joinInfo&&d0.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(l0.WS_RECONNECT_CREATE_CONNECTION,a=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(l0.WS_RECONNECTING,a=>{this.joinInfo&&d0.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:a||K1.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",d0.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(l0.WS_CLOSED,a=>{let h;switch(a){case i_.LEAVE:h=K1.LEAVE;break;case i_.UID_BANNED:case i_.IP_BANNED:case i_.CHANNEL_BANNED:case i_.SERVER_ERROR:h=K1.SERVER_ERROR;break;case i_.FALLBACK:h=K1.FALLBACK;break;case i_.LICENSE_MISSING:case i_.LICENSE_EXPIRED:case i_.LICENSE_MINUTES_EXCEEDED:case i_.LICENSE_PERIOD_INVALID:case i_.LICENSE_MULTIPLE_SDK_SERVICE:case i_.LICENSE_ILLEGAL:h=a;break;default:h=K1.NETWORK_ERROR}Ll.debug("[signal] websocket closed, reason: ".concat(h||"undefined -> "+K1.NETWORK_ERROR)),this.joinInfo&&d0.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:a===i_.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:h}),this._disconnectedReason=a,a!==i_.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(l0.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&(this.role==="audience"&&this._clientRoleOptions&&this._clientRoleOptions.level&&(Ll.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),this.setClientRole(this.role,this._clientRoleOptions)),d0.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof jT?"1":"0"}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1)){const a=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!a)return void Ll.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(a));m_("EVENT_REPORT_DOMAIN",a[1]),m_("EVENT_REPORT_BACKUP_DOMAIN",a[1]),m_("LOG_UPLOAD_SERVER","".concat(a[1],":6444"))}}),this.signal.on(M0.ON_UPLINK_STATS,a=>{this._statsCollector.updateUplinkStats(a)}),this.signal.on(l0.REQUEST_RECOVER,(a,h,g)=>{if(!this.joinInfo)return g(new Ql(Hl.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));a&&(this.joinInfo.multiIP=a,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,A1(this,I_.REQUEST_NEW_GATEWAY_LIST).then(h).catch(g)}),this.signal.on(l0.REQUEST_JOIN_INFO,async a=>{var h;this.updateTurnConfigFromSignal();const{iceParameters:g,dtlsParameters:j,rtpCapabilities:_e}=await A1(this,I_.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(h=this.joinInfo)===null||h===void 0?void 0:h.turnServer});a(this.getJoinMessage({ortc:{iceParameters:g,dtlsParameters:j,rtpCapabilities:_e,version:"2"}}))}),this.signal.on(l0.REQUEST_REJOIN_INFO,a=>{a(this.getRejoinMessage())}),this.signal.on(l0.REPORT_JOIN_GATEWAY,(a,h)=>{this.joinInfo&&(d0.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:a,addr:h,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof jT?"1":"0"}),this._isProactiveJoin=!1)}),this.signal.on(l0.IS_P2P_DISCONNECTED,a=>{a(sO(this,I_.IS_P2P_DISCONNECTED))}),this.signal.on(l0.DISCONNECT_P2P,()=>{this.emit(I_.DISCONNECT_P2P)}),this.signal.on(l0.NEED_RENEW_SESSION,()=>{this.emit(I_.NEED_RENEW_SESSION)}),this.signal.on(l0.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(l0.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(l0.JOIN_RESPONSE,a=>{const h=this.getCurrentGatewayAddress();this.emit(I_.JOIN_RESPONSE,a,h)}),this.signal.on(l0.DATACHANNEL_PRECONNECT,async(a,h,g)=>{this.updateTurnConfigFromSignal();const j=this.getCurrentGatewayAddress();return A1(this,I_.DATACHANNEL_PRECONNECT,a,j).then(h).catch(g)}),this.signal.on(l0.DATACHANNEL_CONNECTING,async a=>{const{iceParameters:h,dtlsParameters:g,rtpCapabilities:j}=await A1(this,I_.REQUEST_DC_CONNECTION_PARAMS);a(this.getJoinMessage({ortc:{iceParameters:h,dtlsParameters:g,rtpCapabilities:j,version:"2"}}))}),this.signal.on(l0.DATACHANNEL_FAILBACK,()=>{Ll.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(I_.DATACHANNEL_FAILBACK)})}async tryUnsubBeforeResub(a,h){try{await this.signal.request(T0.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:a,ortc:[h]},!0)}catch(g){throw Ll.warning("unsubscribe warning",g),g}}async tryUnpubBeforeRepub(a,h){try{await this.signal.request(T0.UNPUBLISH,{stream_id:a,ortc:h},!0)}catch(g){throw Ll.warning("unpublish warning: ",g),g}}async tryMassUnsubBeforeResub(a){const h={users:a.map(g=>({stream_id:g.stream_id,stream_type:g.stream_type}))};try{await this.signal.request(T0.UNSUBSCRIBE_STREAMS,h,!0)}catch(g){throw Ll.warning("massUnsubscribe warning",g),g}}async muteLocal(a,h){const g={action:a.find(j=>j.stream_type===X_.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:a,stream_id:h};try{await this.signal.request(T0.CONTROL,g,!0,!0)}catch(j){throw Ll.warning("gateway unmuteLocal warning: ",j),j}}async unmuteLocal(a,h){const g={action:a.find(j=>j.stream_type===X_.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:a,stream_id:h};try{await this.signal.request(T0.CONTROL,g,!0,!0)}catch(j){throw Ll.warning("gateway muteLocal warning: ",j),j}}uploadStats(a,h){this.signal.upload(a,h)}getSignalRTT(){return this.signal.rtt}async restartICE(a){const h={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:a};try{return await this.signal.request(T0.RESTART_ICE,h,!0)}catch(g){throw Ll.warning("P2PChannel.restartICE warning: ",g),g}}reconnect(){this.state==="CONNECTED"&&this.signal.reconnect(void 0,K1.P2P_FAILED)}getCurrentGatewayAddress(){var a;if(!wp("GATEWAY_WSS_ADDRESS"))return(a=this.joinInfo)!==null&&a!==void 0&&a.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(a){await this.signal.request(T0.SET_PARAMETER,{enablePublishAudioFilter:a})}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(i_.FALLBACK)),this.signal=new UY(rT(rT({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(I_.RESET_CONNECTION_EVENTS)}}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */function qY(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function WY(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?qY(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):qY(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}(function(){var s;function a(Ep){var Ip=0;return function(){return Ip<Ep.length?{done:!1,value:Ep[Ip++]}:{done:!0}}}var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(Ep,Ip,Vp){return Ep==Array.prototype||Ep==Object.prototype||(Ep[Ip]=Vp.value),Ep},g,j=function(Ep){Ep=[typeof globalThis=="object"&&globalThis,Ep,typeof window=="object"&&window,typeof self=="object"&&self,typeof c=="object"&&c];for(var Ip=0;Ip<Ep.length;++Ip){var Vp=Ep[Ip];if(Vp&&Vp.Math==Math)return Vp}throw Error("Cannot find global object")}(this);function _e(Ep,Ip){if(Ip)t:{var Vp=j;Ep=Ep.split(".");for(var _v=0;_v<Ep.length-1;_v++){var f0=Ep[_v];if(!(f0 in Vp))break t;Vp=Vp[f0]}(Ip=Ip(_v=Vp[Ep=Ep[Ep.length-1]]))!=_v&&Ip!=null&&h(Vp,Ep,{configurable:!0,writable:!0,value:Ip})}}function _n(Ep){return(Ep={next:Ep})[Symbol.iterator]=function(){return this},Ep}function _o(Ep){var Ip=typeof Symbol<"u"&&Symbol.iterator&&Ep[Symbol.iterator];return Ip?Ip.call(Ep):{next:a(Ep)}}if(_e("Symbol",function(Ep){function Ip(f0,zp){this.A=f0,h(this,"description",{configurable:!0,writable:!0,value:zp})}if(Ep)return Ep;Ip.prototype.toString=function(){return this.A};var Vp="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",_v=0;return function f0(zp){if(this instanceof f0)throw new TypeError("Symbol is not a constructor");return new Ip(Vp+(zp||"")+"_"+_v++,zp)}}),_e("Symbol.iterator",function(Ep){if(Ep)return Ep;Ep=Symbol("Symbol.iterator");for(var Ip="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Vp=0;Vp<Ip.length;Vp++){var _v=j[Ip[Vp]];typeof _v=="function"&&typeof _v.prototype[Ep]!="function"&&h(_v.prototype,Ep,{configurable:!0,writable:!0,value:function(){return _n(a(this))}})}return Ep}),typeof Object.setPrototypeOf=="function")g=Object.setPrototypeOf;else{var _a;t:{var _r={};try{_r.__proto__={a:!0},_a=_r.a;break t}catch{}_a=!1}g=_a?function(Ep,Ip){if(Ep.__proto__=Ip,Ep.__proto__!==Ip)throw new TypeError(Ep+" is not extensible");return Ep}:null}var ba=g;function xa(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function El(Ep){if(Ep.m)throw new TypeError("Generator is already running");Ep.m=!0}function yl(Ep,Ip){return Ep.h=3,{value:Ip}}function Ol(Ep){this.g=new xa,this.G=Ep}function Al(Ep,Ip,Vp,_v){try{var f0=Ip.call(Ep.g.j,Vp);if(!(f0 instanceof Object))throw new TypeError("Iterator result "+f0+" is not an object");if(!f0.done)return Ep.g.m=!1,f0;var zp=f0.value}catch(Il){return Ep.g.j=null,Ep.g.s(Il),Nl(Ep)}return Ep.g.j=null,_v.call(Ep.g,zp),Nl(Ep)}function Nl(Ep){for(;Ep.g.h;)try{var Ip=Ep.G(Ep.g);if(Ip)return Ep.g.m=!1,{value:Ip.value,done:!1}}catch(Vp){Ep.g.v=void 0,Ep.g.s(Vp)}if(Ep.g.m=!1,Ep.g.l){if(Ip=Ep.g.l,Ep.g.l=null,Ip.F)throw Ip.D;return{value:Ip.return,done:!0}}return{value:void 0,done:!0}}function Ml(Ep){this.next=function(Ip){return Ep.o(Ip)},this.throw=function(Ip){return Ep.s(Ip)},this.return=function(Ip){return function(Vp,_v){El(Vp.g);var f0=Vp.g.j;return f0?Al(Vp,"return"in f0?f0.return:function(zp){return{value:zp,done:!0}},_v,Vp.g.return):(Vp.g.return(_v),Nl(Vp))}(Ep,Ip)},this[Symbol.iterator]=function(){return this}}function Fl(Ep,Ip){return Ip=new Ml(new Ol(Ip)),ba&&Ep.prototype&&ba(Ip,Ep.prototype),Ip}if(xa.prototype.o=function(Ep){this.v=Ep},xa.prototype.s=function(Ep){this.l={D:Ep,F:!0},this.h=this.C||this.u},xa.prototype.return=function(Ep){this.l={return:Ep},this.h=this.u},Ol.prototype.o=function(Ep){return El(this.g),this.g.j?Al(this,this.g.j.next,Ep,this.g.o):(this.g.o(Ep),Nl(this))},Ol.prototype.s=function(Ep){return El(this.g),this.g.j?Al(this,this.g.j.throw,Ep,this.g.o):(this.g.s(Ep),Nl(this))},_e("Array.prototype.entries",function(Ep){return Ep||function(){return function(Ip,Vp){Ip instanceof String&&(Ip+="");var _v=0,f0=!1,zp={next:function(){if(!f0&&_v<Ip.length){var Il=_v++;return{value:Vp(Il,Ip[Il]),done:!1}}return f0=!0,{done:!0,value:void 0}}};return zp[Symbol.iterator]=function(){return zp},zp}(this,function(Ip,Vp){return[Ip,Vp]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var up=function(Ep,Ip){for(var Vp=0;Vp<Ep.length;Vp++)Ip(Ep[Vp])},_p=function(Ep){return Ep.replace(/\r?\n|\r/g,`\r
`)},Tp=function(Ep,Ip,Vp){return Ip instanceof Blob?(Vp=Vp!==void 0?String(Vp+""):typeof Ip.name=="string"?Ip.name:"blob",Ip.name===Vp&&Object.prototype.toString.call(Ip)!=="[object Blob]"||(Ip=new File([Ip],Vp)),[String(Ep),Ip]):[String(Ep),String(Ip)]},Fp=function(Ep,Ip){if(Ep.length<Ip)throw new TypeError(Ip+" argument required, but only "+Ep.length+" present.")},Ap=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,Xp=Ap.FormData,_g=Ap.XMLHttpRequest&&Ap.XMLHttpRequest.prototype.send,Yp=Ap.Request&&Ap.fetch,h0=Ap.navigator&&Ap.navigator.sendBeacon,E0=Ap.Element&&Ap.Element.prototype,A0=Ap.Symbol&&Symbol.toStringTag;A0&&(Blob.prototype[A0]||(Blob.prototype[A0]="Blob"),"File"in Ap&&!File.prototype[A0]&&(File.prototype[A0]="File"));try{new File([],"")}catch{Ap.File=function(Ip,Vp,_v){return Ip=new Blob(Ip,_v||{}),Object.defineProperties(Ip,{name:{value:Vp},lastModified:{value:+(_v&&_v.lastModified!==void 0?new Date(_v.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),A0&&Object.defineProperty(Ip,A0,{value:"File"}),Ip}}var _E=function(Ep){return Ep.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},Rp=function(Ep){this.i=[];var Ip=this;Ep&&up(Ep.elements,function(Vp){if(Vp.name&&!Vp.disabled&&Vp.type!=="submit"&&Vp.type!=="button"&&!Vp.matches("form fieldset[disabled] *"))if(Vp.type==="file"){var _v=Vp.files&&Vp.files.length?Vp.files:[new File([],"",{type:"application/octet-stream"})];up(_v,function(f0){Ip.append(Vp.name,f0)})}else Vp.type==="select-multiple"||Vp.type==="select-one"?up(Vp.options,function(f0){!f0.disabled&&f0.selected&&Ip.append(Vp.name,f0.value)}):Vp.type==="checkbox"||Vp.type==="radio"?Vp.checked&&Ip.append(Vp.name,Vp.value):(_v=Vp.type==="textarea"?_p(Vp.value):Vp.value,Ip.append(Vp.name,_v))})};if((s=Rp.prototype).append=function(Ep,Ip,Vp){Fp(arguments,2),this.i.push(Tp(Ep,Ip,Vp))},s.delete=function(Ep){Fp(arguments,1);var Ip=[];Ep=String(Ep),up(this.i,function(Vp){Vp[0]!==Ep&&Ip.push(Vp)}),this.i=Ip},s.entries=function Ep(){var Ip,Vp=this;return Fl(Ep,function(_v){if(_v.h==1&&(Ip=0),_v.h!=3)return Ip<Vp.i.length?_v=yl(_v,Vp.i[Ip]):(_v.h=0,_v=void 0),_v;Ip++,_v.h=2})},s.forEach=function(Ep,Ip){Fp(arguments,1);for(var Vp=_o(this),_v=Vp.next();!_v.done;_v=Vp.next()){var f0=_o(_v.value);_v=f0.next().value,f0=f0.next().value,Ep.call(Ip,f0,_v,this)}},s.get=function(Ep){Fp(arguments,1);var Ip=this.i;Ep=String(Ep);for(var Vp=0;Vp<Ip.length;Vp++)if(Ip[Vp][0]===Ep)return Ip[Vp][1];return null},s.getAll=function(Ep){Fp(arguments,1);var Ip=[];return Ep=String(Ep),up(this.i,function(Vp){Vp[0]===Ep&&Ip.push(Vp[1])}),Ip},s.has=function(Ep){Fp(arguments,1),Ep=String(Ep);for(var Ip=0;Ip<this.i.length;Ip++)if(this.i[Ip][0]===Ep)return!0;return!1},s.keys=function Ep(){var Ip,Vp,_v,f0,zp=this;return Fl(Ep,function(Il){if(Il.h==1&&(Ip=_o(zp),Vp=Ip.next()),Il.h!=3)return Vp.done?void(Il.h=0):(_v=Vp.value,f0=_o(_v),yl(Il,f0.next().value));Vp=Ip.next(),Il.h=2})},s.set=function(Ep,Ip,Vp){Fp(arguments,2),Ep=String(Ep);var _v=[],f0=Tp(Ep,Ip,Vp),zp=!0;up(this.i,function(Il){Il[0]===Ep?zp&&(zp=!_v.push(f0)):_v.push(Il)}),zp&&_v.push(f0),this.i=_v},s.values=function Ep(){var Ip,Vp,_v,f0,zp=this;return Fl(Ep,function(Il){if(Il.h==1&&(Ip=_o(zp),Vp=Ip.next()),Il.h!=3)return Vp.done?void(Il.h=0):(_v=Vp.value,(f0=_o(_v)).next(),yl(Il,f0.next().value));Vp=Ip.next(),Il.h=2})},Rp.prototype._asNative=function(){for(var Ep=new Xp,Ip=_o(this),Vp=Ip.next();!Vp.done;Vp=Ip.next()){var _v=_o(Vp.value);Vp=_v.next().value,_v=_v.next().value,Ep.append(Vp,_v)}return Ep},Rp.prototype._blob=function(){var Ep="----formdata-polyfill-"+Math.random(),Ip=[],Vp="--"+Ep+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(_v,f0){return typeof _v=="string"?Ip.push(Vp+_E(_p(f0))+`"\r
\r
`+_p(_v)+`\r
`):Ip.push(Vp+_E(_p(f0))+'"; filename="'+_E(_v.name)+`"\r
Content-Type: `+(_v.type||"application/octet-stream")+`\r
\r
`,_v,`\r
`)}),Ip.push("--"+Ep+"--"),new Blob(Ip,{type:"multipart/form-data; boundary="+Ep})},Rp.prototype[Symbol.iterator]=function(){return this.entries()},Rp.prototype.toString=function(){return"[object FormData]"},E0&&!E0.matches&&(E0.matches=E0.matchesSelector||E0.mozMatchesSelector||E0.msMatchesSelector||E0.oMatchesSelector||E0.webkitMatchesSelector||function(Ep){for(var Ip=(Ep=(this.document||this.ownerDocument).querySelectorAll(Ep)).length;0<=--Ip&&Ep.item(Ip)!==this;);return-1<Ip}),A0&&(Rp.prototype[A0]="FormData"),_g){var Lp=Ap.XMLHttpRequest.prototype.setRequestHeader;Ap.XMLHttpRequest.prototype.setRequestHeader=function(Ep,Ip){Lp.call(this,Ep,Ip),Ep.toLowerCase()==="content-type"&&(this.B=!0)},Ap.XMLHttpRequest.prototype.send=function(Ep){Ep instanceof Rp?(Ep=Ep._blob(),this.B||this.setRequestHeader("Content-Type",Ep.type),_g.call(this,Ep)):_g.call(this,Ep)}}Yp&&(Ap.fetch=function(Ep,Ip){return Ip&&Ip.body&&Ip.body instanceof Rp&&(Ip.body=Ip.body._blob()),Yp.call(this,Ep,Ip)}),h0&&(Ap.navigator.sendBeacon=function(Ep,Ip){return Ip instanceof Rp&&(Ip=Ip._asNative()),h0.call(this,Ep,Ip)}),Ap.FormData=Rp}})();let z8=1;function Got(s,a,h,g,j){z8+=1;const _e={sid:h.sid,command:"convergeAllocateEdge",uid:"666",appId:h.appId,ts:Math.floor(Date.now()/1e3),seq:z8,requestId:z8,version:Ky,cname:h.cname},_n={service_name:a,json_body:JSON.stringify(_e)};let _o,_a,_r=s[0];return QS(async()=>{_o=Date.now();const ba=await xS(_r,{data:_n,cancelToken:g,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(_a=Date.now()-_o,ba.code!==0){const yl=new Ql(Hl.UNEXPECTED_RESPONSE,"live streaming ap error, code"+ba.code,{retry:!0,responseTime:_a});throw Ll.error(yl.toString()),yl}const xa=JSON.parse(ba.json_body);if(xa.code!==200){const yl=new Ql(Hl.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(xa.code,", reason: ").concat(xa.reason),{code:xa.code,responseTime:_a});throw Ll.error(yl.toString()),yl}if(!xa.servers||xa.servers.length===0){const yl=new Ql(Hl.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:xa.code,responseTime:_a});throw Ll.error(yl.toString()),yl}const El=function(yl,Ol){return{addressList:yl.servers.map(Al=>"wss://".concat(Al.address.replace(/\./g,"-"),".").concat(wp("WORKER_DOMAIN"),":").concat(Al.wss,"?serviceName=").concat(encodeURIComponent(Ol))),workerToken:yl.workerToken,vid:yl.vid}}(xa,a);return wp("LIVE_STREAMING_ADDRESS")&&(El.addressList=wp("LIVE_STREAMING_ADDRESS")instanceof Array?wp("LIVE_STREAMING_ADDRESS"):[wp("LIVE_STREAMING_ADDRESS")]),WY(WY({},El),{},{responseTime:_a})},(ba,xa)=>(d0.apworkerEvent(h.sid,{success:!0,sc:200,serviceName:a,responseDetail:JSON.stringify(ba.addressList),firstSuccess:xa===0,responseTime:_a,serverIp:s[xa%s.length]}),!1),(ba,xa)=>(d0.apworkerEvent(h.sid,{success:!1,sc:ba.data&&ba.data.code||200,serviceName:a,responseTime:_a,serverIp:s[xa%s.length]}),!!(ba.code!==Hl.OPERATION_ABORTED&&ba.code!==Hl.UNEXPECTED_RESPONSE||ba.data&&ba.data.retry)&&(_r=s[(xa+1)%s.length],!0)),j)}let Y8=1;function HY(s,a,h,g){let{url:j,areaCode:_e}=s;const _n=Date.now();let _o;const[_a,_r]=JY(a,_e,[n1.CHOOSE_SERVER]);let ba=q_.networkState;return QS(async()=>{ba&&q_.networkState===M1.OFFLINE&&q_.onlineWaiter&&await s0.race([q_.onlineWaiter,g1(g&&g.maxRetryTimeout||t1.maxRetryTimeout)]),ba=q_.networkState;const{data:xa,headers:El}=await xS(j,{data:_a,cancelToken:h,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);_o=El.http3==="1"?1:-1,d0.reportResourceTiming(j,a.sid),zY(xa,j,a,_n,[n1.CHOOSE_SERVER],_o);const yl=p8(xa,n1.CHOOSE_SERVER);return YY(yl),fz(yl,j)},xa=>(xa&&d0.joinChooseServer(a.sid,{lts:_n,succ:!0,csAddr:j,opid:_r,serverList:xa.gatewayAddrs.map(El=>El.address),ec:null,cid:xa.cid.toString(),uid:xa.uid.toString(),csIp:xa.csIp,unilbsServerIds:[n1.CHOOSE_SERVER].toString(),isHttp3:_o}),!1),xa=>xa.code!==Hl.OPERATION_ABORTED&&(xa.code===Hl.CAN_NOT_GET_GATEWAY_SERVER?xa.data.retry:(d0.joinChooseServer(a.sid,{lts:_n,succ:!1,csAddr:j,serverList:null,opid:_r,ec:xa.code,csIp:xa.data&&xa.data.csIp,unilbsServerIds:[n1.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:ba}),isHttp3:_o}),Ll.warning("[".concat(a.clientId,"] Choose server network error, retry"),xa),!0)),g)}function KY(s,a,h,g){let j,{url:_e,areaCode:_n,serviceIds:_o}=s;const _a=Date.now(),[_r,ba]=JY(a,_n,_o);let xa;return QS(async()=>{xa&&q_.networkState===M1.OFFLINE&&q_.onlineWaiter&&await s0.race([q_.onlineWaiter,g1(g&&g.maxRetryTimeout||t1.maxRetryTimeout)]),xa=q_.networkState;const{data:El,headers:yl}=await xS(_e,{data:_r,cancelToken:h,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);j=yl.http3==="1"?1:-1,d0.reportResourceTiming(_e,a.sid),zY(El,_e,a,_a,_o,j);const Ol=p8(El,n1.CHOOSE_SERVER),Al=p8(El,a.cloudProxyServer==="proxy5"?n1.CLOUD_PROXY_5:a.cloudProxyServer==="proxy3"||a.cloudProxyServer==="proxy4"?n1.CLOUD_PROXY:n1.CLOUD_PROXY_FALLBACK);return YY(Ol),{gatewayInfo:fz(Ol,_e),proxyInfo:Al,url:_e}},El=>(El.gatewayInfo&&d0.joinChooseServer(a.sid,{lts:_a,succ:!0,csAddr:_e,serverList:El.gatewayInfo.gatewayAddrs.map(yl=>yl.address),ec:null,opid:ba,cid:El.gatewayInfo.cid.toString(),uid:El.gatewayInfo.uid.toString(),csIp:El.gatewayInfo.csIp,unilbsServerIds:_o.toString(),isHttp3:j}),El.proxyInfo&&d0.joinWebProxyAP(a.sid,{lts:_a,sucess:1,apServerAddr:_e,turnServerAddrList:El.proxyInfo.addresses.map(yl=>yl.ip).join(","),errorCode:null,eventType:a.cloudProxyServer,unilbsServerIds:_o.toString()}),!1),El=>El.code!==Hl.OPERATION_ABORTED&&(El.code===Hl.CAN_NOT_GET_GATEWAY_SERVER?El.data.retry:(d0.joinWebProxyAP(a.sid,{lts:_a,sucess:0,apServerAddr:_e,turnServerAddrList:null,errorCode:El.code,eventType:a.cloudProxyServer,unilbsServerIds:_o.toString(),extend:JSON.stringify({networkState:xa})}),Ll.warning("[".concat(a.clientId,"] multi unilbs network error, retry"),El),!0)),g)}const zY=(s,a,h,g,j,_e)=>{const _n=[],_o=_a=>{_a.flag===4096?d0.joinChooseServer(h.sid,{lts:g,succ:!1,csAddr:a,opid:s.opid,serverList:null,ec:_a.error.message,csIp:_a.error.data&&_a.error.data.csIp,unilbsServerIds:j.toString(),isHttp3:_e}):_a.flag!==1048576&&_a.flag!==4194304&&_a.flag!==4194310||d0.joinWebProxyAP(h.sid,{lts:g,sucess:0,apServerAddr:a,turnServerAddrList:null,errorCode:_a.error.code,eventType:h.cloudProxyServer,unilbsServerIds:j.toString()})};if(s.response_body.forEach(_a=>{const _r=_a.buffer.code;if(_a.uri===23&&_r===0&&!_a.buffer.edges_services)if(_a.buffer.flag===4194310)Ll.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),_a.buffer.edges_services=[];else{const ba={error:new Ql(Hl.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:s.detail[502]}),flag:_a.buffer.flag};_n.push(ba),_o(ba)}if(_r!==0){const ba=q4(_r),xa={error:new Ql(Hl.CAN_NOT_GET_GATEWAY_SERVER,ba.desc,{desc:ba.desc,retry:ba.retry,csIp:s.detail[502]}),flag:_a.buffer.flag};_a.buffer.flag===4194310?Ll.warning(xa.error.toString()):_n.push(xa),_o(xa)}}),_n.length)throw Ll.warning("[".concat(h.clientId,"] multi unilbs ").concat(a," failed, ").concat(_n.map(_a=>"flag: ".concat(_a.flag,", message: ").concat(_a.error.message,", retry: ").concat(_a.error.data.retry)).join(" | "))),new Ql(Hl.CAN_NOT_GET_GATEWAY_SERVER,_n.map(_a=>"flag: ".concat(_a.flag,", message: ").concat(_a.error.message)).join(" | "),{retry:!!_n.find(_a=>_a.error.data.retry),csIp:s.detail[502],desc:[...new Set(_n.map(_a=>{var _r,ba;return _a==null||(_r=_a.error)===null||_r===void 0||(ba=_r.data)===null||ba===void 0?void 0:ba.desc}).filter(_a=>!!_a))]})},YY=s=>{var a,h;if(s.addresses&&s.addresses.length===0&&s.code===0)throw new Ql(Hl.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:s.detail&&s.detail[502]});if((a=s.detail)!==null&&a!==void 0&&a[19]&&typeof((h=s.detail)===null||h===void 0?void 0:h[19])=="string"){const j=s.detail[19],_e=j==null?void 0:j.split(";");for(let _n=0;_n<_e.length;_n++){var g;const _o=OT(g=_e[_n]).call(g);s.addresses[_n]&&_e&&(s.addresses[_n].fingerprint=_o)}}if(wp("GATEWAY_ADDRESS")&&wp("GATEWAY_ADDRESS").length>0){Ll.debug("assign gateway address to",wp("GATEWAY_ADDRESS"));const j=wp("GATEWAY_ADDRESS").map(_e=>{var _n,_o;const _a=(_n=(_o=s.addresses.find(_r=>_r.ip===_e.ip&&_r.port===_e.port))===null||_o===void 0?void 0:_o.fingerprint)!==null&&_n!==void 0?_n:"";return{ip:_e.ip,port:_e.port,ticket:s.addresses[0]&&s.addresses[0].ticket,fingerprint:_a}});s.addresses=j}},qot=(s,a)=>{if(s.response_body&&s.response_body.length){const h=s.response_body[0];if(h.buffer.code!==0){const g=q4(h.buffer.code);throw new Ql(Hl.UPDATE_TICKET_FAILED,"[".concat(h.buffer.code,"]: ").concat(g.desc),{retry:g.retry})}return h.buffer.ticket}throw Ll.debug("update ticket request received ap response without response body:",a),new Ql(Hl.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},JY=(s,a,h)=>{const g=Math.floor(Math.random()*1e12),j={appid:s.appId,client_ts:Date.now(),opid:g,sid:s.sid,request_bodies:[{uri:22,buffer:{cname:s.cname,detail:{6:s.stringUid,11:a,12:wp("USE_NEW_TOKEN")?"1":void 0},key:s.token,service_ids:h,uid:s.uid||0}}]};j.request_bodies.forEach(_n=>{s.multiIP&&s.multiIP.gateway_ip&&(_n.buffer.detail[5]=JSON.stringify({vocs_ip:[s.multiIP.uni_lbs_ip],vos_ip:[s.multiIP.gateway_ip]}))});const _e=new FormData;return _e.append("request",JSON.stringify(j)),[_e,g]},Wot=(s,a)=>{const h=Math.floor(Math.random()*1e12),g={appid:s.appId,client_ts:Date.now(),opid:h,sid:s.sid,request_bodies:[{uri:28,buffer:{cname:s.cname,detail:{1:"",6:s.stringUid,12:"1"},token:s.token,service_ids:a,uid:s.uid||0,edges_services:s.apResponse.addresses.map(_e=>({ip:_e.ip,port:_e.port}))}}]},j=new FormData;return j.append("request",JSON.stringify(g)),[j,h]};let J8=0;const W4=()=>{const s=wp("AREAS");return s.length===0&&s.push(Z0.GLOBAL),Gy(s).call(s,(a,h,g)=>{const j=Hot(h);return j?g===0?j:"".concat(a,",").concat(j):a},"")},Hot=s=>s===Z0.OVERSEA?"".concat(o1.ASIA,",").concat(o1.EUROPE,",").concat(o1.AFRICA,",").concat(o1.NORTH_AMERICA,",").concat(o1.SOUTH_AMERICA,",").concat(o1.OCEANIA):o1[s],H4={GLOBAL:{ASIA:[Z0.CHINA,Z0.JAPAN,Z0.INDIA,Z0.KOREA,Z0.HKMC],EUROPE:[],NORTH_AMERICA:[Z0.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},X8=Object.keys(H4[Z0.GLOBAL]),XY=[Z0.CHINA,Z0.NORTH_AMERICA,Z0.EUROPE,Z0.ASIA,Z0.JAPAN,Z0.INDIA,Z0.OCEANIA,Z0.SOUTH_AMERICA,Z0.AFRICA,Z0.KOREA,Z0.HKMC,Z0.US],Kot=function(s,a){let h=[];if(s.includes(Z0.GLOBAL)){const _e=[Z0.GLOBAL,Z0.OVERSEA],_n=Object.keys(_j);if(a===Z0.GLOBAL)throw new Ql(Hl.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(a===Z0.CHINA)h=[Z0.OVERSEA];else if(j=a,X8.includes(j)){const _o=(g=a,H4[Z0.GLOBAL][g]||[]),_a=[..._e,a,..._o];h=_n.filter(_r=>!_a.includes(_r))}else if(function(_o){let _a=!1;return X8.forEach(_r=>{H4[Z0.GLOBAL][_r].includes(_o)&&(_a=!0)}),_a}(a)){const _o=function(_r){let ba;return X8.forEach(xa=>{H4[Z0.GLOBAL][xa].includes(_r)&&(ba=xa)}),ba}(a),_a=[..._e,_o,a];h=_n.filter(_r=>!_a.includes(_r))}else h=s;h=function(_o){const _a=[];return XY.forEach(_r=>{_o.includes(_r)&&_a.push(_r)}),_a.concat(_o.filter(_r=>!XY.includes(_r)))}(h)}else h=s;var g,j;return h};async function Q8(s,a,h,g){return{gatewayInfo:await async function(_e,_n,_o,_a){let _r=null;const ba=[],xa=async()=>{const yl=wp("WEBCS_DOMAIN").slice(0,wp("AJAX_REQUEST_CONCURRENT")).map(Nl=>({url:_e.proxyServer?"https://".concat(_e.proxyServer,"/ap/?url=").concat(Nl+"/api/v2/transpond/webrtc?v=2"):"https://".concat(Nl,"/api/v2/transpond/webrtc?v=2"),areaCode:W4()})),Ol=_a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:yl.map(Nl=>Nl.url)}),Al=await PP({fragementLength:wp("FRAGEMENT_LENGTH"),referenceList:yl,asyncMapHandler:Nl=>(Ll.debug("[".concat(_e.clientId,"] Connect to choose_server:"),Nl.url),HY(Nl,_e,_n,_o)),allFailedhandler:Nl=>{throw _a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:Nl},Ol),Nl[0]},promisesCollector:ba});return _a.recordJoinChannelService({endTs:Date.now(),status:"success"},Ol),Al},El=async()=>{if(await g1(1e3),_r!==null)return _r;const yl=wp("WEBCS_DOMAIN_BACKUP_LIST").map(Nl=>({url:_e.proxyServer?"https://".concat(_e.proxyServer,"/ap/?url=").concat(Nl+"/api/v2/transpond/webrtc?v=2"):"https://".concat(Nl,"/api/v2/transpond/webrtc?v=2"),areaCode:W4()})),Ol=_a.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:yl.map(Nl=>Nl.url)}),Al=await PP({fragementLength:wp("FRAGEMENT_LENGTH"),referenceList:yl,asyncMapHandler:Nl=>(Ll.debug("[".concat(_e.clientId,"] Connect to backup choose_server:"),Nl.url),HY(Nl,_e,_n,_o)),allFailedhandler:Nl=>{throw _a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:Nl},Ol),Nl[0]},promisesCollector:ba});return _a.recordJoinChannelService({endTs:Date.now(),status:"success"},Ol),Al};try{return _r=await Q2([xa(),El()]),ba.length&&ba.forEach(yl=>yl.cancel&&typeof yl.cancel=="function"&&yl.cancel()),_r}catch(yl){throw yl[0]}}(s,a,h,g)}}async function QY(s,a,h,g,j){const _e=s.cloudProxyServer;if(_e==="disabled"){if(!g)return;if(s.useLocalAccessPoint)return await Q8(s,a,h,j);if(wp("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:_r,proxyInfo:ba}=await ZY(s,a,h,j);return s.turnServer&&s.turnServer.mode!=="auto"||(s.turnServer={mode:"manual",servers:ba.map(xa=>({turnServerURL:xa.address,tcpport:xa.tcpport||Cy.tcpport,udpport:xa.udpport||Cy.udpport,username:xa.username||Cy.username,password:xa.password||Cy.password,forceturn:wp("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE"),security:!0}))}),{gatewayInfo:_r}}return await Q8(s,a,h,j)}const{proxyInfo:_n,gatewayInfo:_o}=await ZY(s,a,h,j),_a={gatewayInfo:_o};return s.turnServer={mode:"manual",servers:_n.map(_r=>({turnServerURL:_r.address,tcpport:_e==="proxy3"?void 0:_r.tcpport?_r.tcpport:Cy.tcpport,udpport:_e==="proxy4"?void 0:_r.udpport?_r.udpport:Cy.udpport,username:_r.username||Cy.username,password:_r.password||Cy.password,forceturn:_e!=="proxy4",security:_e==="proxy5"}))},Ll.debug("[".concat(s.clientId,"] set proxy server: ").concat(s.proxyServer,", mode: ").concat(_e)),_a}async function $Y(s,a,h,g,j){const _e=wp("ACCOUNT_REGISTER").slice(0,wp("AJAX_REQUEST_CONCURRENT"));let _n=[];_n=a.proxyServer?_e.map(_a=>"https://".concat(a.proxyServer,"/ap/?url=").concat(_a+"/api/v1")):_e.map(_a=>"https://".concat(_a,"/api/v1"));const _o=j==null?void 0:j.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:_n});try{const _a=await async function(_r,ba,xa,El,yl){const Ol=Date.now(),Al={sid:xa.sid,opid:10,appid:xa.appId,string_uid:ba};let Nl=_r[0];const Ml=await QS(()=>xS(Nl+"".concat(Nl.indexOf("?")===-1?"?":"&","action=stringuid"),{data:Al,cancelToken:El,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(Fl,up)=>{if(Fl.code===0){if(Fl.uid<=0||Fl.uid>=Math.pow(2,32))throw Ll.error("Invalid Uint Uid ".concat(ba," => ").concat(Fl.uid),Fl),d0.reqUserAccount(Al.sid,{lts:Ol,success:!1,serverAddr:Nl,stringUid:Al.string_uid,uid:Fl.uid,errorCode:Hl.INVALID_UINT_UID_FROM_STRING_UID,extend:Al}),new Ql(Hl.INVALID_UINT_UID_FROM_STRING_UID);return d0.reqUserAccount(Al.sid,{lts:Ol,success:!0,serverAddr:Nl,stringUid:Al.string_uid,uid:Fl.uid,errorCode:null,extend:Al}),!1}const _p=q4(Fl.code);return _p.retry&&(Nl=_r[(up+1)%_r.length]),d0.reqUserAccount(Al.sid,{lts:Ol,success:!1,serverAddr:Nl,stringUid:Al.string_uid,uid:Fl.uid,errorCode:_p.desc,extend:Al}),_p.retry},(Fl,up)=>Fl.code!==Hl.OPERATION_ABORTED&&(d0.reqUserAccount(Al.sid,{lts:Ol,success:!1,serverAddr:Nl,stringUid:Al.string_uid,uid:null,errorCode:Fl.code,extend:Al}),Nl=_r[(up+1)%_r.length],!0),yl);if(Ml.code!==0){const Fl=q4(Ml.code);throw new Ql(Hl.UNEXPECTED_RESPONSE,Fl.desc)}return Ml}(_n,s,a,h,g);return j==null||j.recordJoinChannelService({status:"success",endTs:Date.now()},_o),_a.uid}catch(_a){throw j==null||j.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[_a]},_o),_a}}async function zot(s,a,h){const g=wp("CDS_AP").slice(0,wp("AJAX_REQUEST_CONCURRENT")).map(_o=>s.proxyServer?"https://".concat(s.proxyServer,"/ap/?url=").concat(_o+"/api/v1"):"https://".concat(_o,"/api/v1?action=config")).map(_o=>function(_a,_r,ba,xa){const El=p_(),yl={flag:64,cipher_method:0,features:{device:El.name,system:El.os,system_general:navigator.userAgent,vendor:_r.appId,version:Ky,cname:_r.cname,sid:_r.sid,session_id:_r.sid,detail:"",proxyServer:_r.proxyServer}};return QS(()=>xS(_a,{data:yl,timeout:1e3,cancelToken:ba,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,Ol=>Ol.code!==Hl.OPERATION_ABORTED,xa)}(_o,s,a,h));let j=null,_e=null,_n={};try{j=await Q2(g)}catch(_o){if(_o.code===Hl.OPERATION_ABORTED)throw _o;_e=_o}if(g.forEach(_o=>_o.cancel()),d0.reportApiInvoke(s.sid,{name:Y_.REQUEST_CONFIG_DISTRIBUTE,options:{error:_e,res:j}}).onSuccess(),j&&j.test_tags)try{_n=function(_o){if(!_o.test_tags)return{};const _a=_o.test_tags,_r=Object.keys(_a),ba={};return _r.forEach(xa=>{var El;const yl=OT(El=xa.slice(4)).call(El),Ol=JSON.parse(_a[xa])[1];ba[yl]=Ol}),ba}(j)}catch{}return _n}async function ZY(s,a,h,g){const j=wp("PROXY_SERVER_TYPE3"),_e=(yl,Ol,Al)=>{let Nl=Al||j;return Array.isArray(Nl)&&(Nl=Ol%2==0?j[1]:j[0]),"https://".concat(Nl,"/ap/?url=").concat(yl)};let _n=null;const _o=[],_a=async()=>{const yl=wp("WEBCS_DOMAIN").slice(0,wp("AJAX_REQUEST_CONCURRENT")).map((Nl,Ml)=>{let Fl;return Fl=s.cloudProxyServer==="disabled"&&s.proxyServer?_e("".concat(Nl,"/api/v2/transpond/webrtc?v=2"),Ml,s.proxyServer):s.cloudProxyServer==="disabled"||s.cloudProxyServer==="fallback"?"https://".concat(Nl,"/api/v2/transpond/webrtc?v=2"):_e("".concat(Nl,"/api/v2/transpond/webrtc?v=2"),Ml),{url:Fl,areaCode:W4(),serviceIds:[n1.CHOOSE_SERVER,s.cloudProxyServer==="proxy5"?n1.CLOUD_PROXY_5:s.cloudProxyServer==="proxy3"||s.cloudProxyServer==="proxy4"?n1.CLOUD_PROXY:n1.CLOUD_PROXY_FALLBACK]}}),Ol=g.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:yl.map(Nl=>Nl.url)}),Al=await PP({fragementLength:wp("FRAGEMENT_LENGTH"),referenceList:yl,asyncMapHandler:Nl=>(Ll.debug("[".concat(s.clientId,"] Connect to choose_server:"),Nl.url),KY(Nl,s,a,h)),allFailedhandler:Nl=>{throw g.recordJoinChannelService({endTs:Date.now(),status:"error",errors:Nl},Ol),Nl[0]},promisesCollector:_o});return g.recordJoinChannelService({endTs:Date.now(),status:"success"},Ol),Al},_r=async()=>{if(await g1(1e3),_n!==null)return _n;const yl=wp("WEBCS_DOMAIN_BACKUP_LIST").map((Nl,Ml)=>{let Fl;return Fl=s.cloudProxyServer==="disabled"&&s.proxyServer?_e("".concat(Nl,"/api/v2/transpond/webrtc?v=2"),Ml,s.proxyServer):s.cloudProxyServer==="disabled"||s.cloudProxyServer==="fallback"?"https://".concat(Nl,"/api/v2/transpond/webrtc?v=2"):_e("".concat(Nl,"/api/v2/transpond/webrtc?v=2"),Ml),{url:Fl,areaCode:W4(),serviceIds:[n1.CHOOSE_SERVER,s.cloudProxyServer==="proxy5"?n1.CLOUD_PROXY_5:s.cloudProxyServer==="proxy3"||s.cloudProxyServer==="proxy4"?n1.CLOUD_PROXY:n1.CLOUD_PROXY_FALLBACK]}}),Ol=g.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:yl.map(Nl=>Nl.url)}),Al=await PP({fragementLength:wp("FRAGEMENT_LENGTH"),referenceList:yl,asyncMapHandler:Nl=>(Ll.debug("[".concat(s.clientId,"] Connect to backup choose_server:"),Nl.url),KY(Nl,s,a,h)),allFailedhandler:Nl=>{throw g.recordJoinChannelService({endTs:Date.now(),status:"error",errors:Nl},Ol),Nl[0]},promisesCollector:_o});return g.recordJoinChannelService({endTs:Date.now(),status:"success"},Ol),Al};let ba,xa,El;try{({gatewayInfo:ba,proxyInfo:xa,url:El}=await Q2([_a(),_r()]))}catch(yl){throw yl[0]}if(_o.length&&_o.forEach(yl=>yl.cancel&&typeof yl.cancel=="function"&&yl.cancel()),!ba||!xa)throw new Ql(Hl.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(s.apUrl=El,s.cloudProxyServer!=="disabled"&&Array.isArray(j)&&El){const yl=new DY(El).host;j.includes(yl)&&(s.proxyServer=yl,Ll.setProxyServer(yl),d0.setProxyServer(yl))}return _n={gatewayInfo:ba,proxyInfo:await iit(xa,ba.uid)},_n}async function _J(s,a,h,g){const j=wp("UAP_AP").slice(0,wp("AJAX_REQUEST_CONCURRENT")).map(_e=>a.proxyServer?"https://".concat(a.proxyServer,"/ap/?url=").concat(_e+"/api/v1?action=uap"):"https://".concat(_e,"/api/v1?action=uap"));return await Got(j,s,a,h,g)}async function Yot(s,a,h){const g=wp("UAP_AP").slice(0,wp("AJAX_REQUEST_CONCURRENT")).map(j=>s.proxyServer?"https://".concat(s.proxyServer,"/ap/?url=").concat(j+"/api/v1?action=uap"):"https://".concat(j,"/api/v1?action=uap")).map(j=>function(_e,_n,_o,_a){const _r={command:"convergeAllocateEdge",sid:_n.sid,appId:_n.appId,token:_n.token,ts:Date.now(),version:Ky,cname:_n.cname,uid:_n.uid.toString(),requestId:Y8,seq:Y8};Y8+=1;const ba={service_name:"tele_channel",json_body:JSON.stringify(_r)};return QS(async()=>{const xa=await xS(_e,{data:ba,cancelToken:_o,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(xa.code!==0){const yl=new Ql(Hl.UNEXPECTED_RESPONSE,"cross channel ap error, code"+xa.code,{retry:!0});throw Ll.error(yl.toString()),yl}const El=JSON.parse(xa.json_body);if(El.code!==200){const yl=new Ql(Hl.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(El.code,", reason: ").concat(El.reason));throw Ll.error(yl.toString()),yl}if(!El.servers||El.servers.length===0){const yl=new Ql(Hl.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw Ll.error(yl.toString()),yl}return{vid:El.vid,workerToken:El.workerToken,addressList:(wp("CHANNEL_MEDIA_RELAY_SERVERS")||El.servers).map(yl=>"wss://".concat(yl.address.replace(/\./g,"-"),".").concat(wp("WORKER_DOMAIN"),":").concat(yl.wss))}},void 0,xa=>!!(xa.code!==Hl.OPERATION_ABORTED&&xa.code!==Hl.UNEXPECTED_RESPONSE||xa.data&&xa.data.retry),_a)}(j,s,a,h));try{const j=await Q2(g);return g.forEach(_e=>_e.cancel()),j}catch(j){throw j[0]}}async function Jot(s,a,h){let g=null;const j=[],_e=async _n=>{const _o=wp(_n?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(_a=>s.proxyServer?"https://".concat(s.proxyServer,"/ap/?url=").concat(_a+"/api/v2/transpond/webrtc?v=2"):"https://".concat(_a,"/api/v2/transpond/webrtc?v=2"));return _n&&(await g1(1e3),g!==null)?g:await PP({fragementLength:wp("FRAGEMENT_LENGTH"),referenceList:_o,asyncMapHandler:_a=>(Ll.debug("[".concat(s.clientId,"] update ticket, Connect to ").concat(_n?"backup":""," choose_server:"),_a),function(_r,ba,xa,El){const[yl]=Wot(ba,[n1.CHOOSE_SERVER]);let Ol=q_.networkState;return QS(async()=>{Ol&&q_.networkState===M1.OFFLINE&&q_.onlineWaiter&&await s0.race([q_.onlineWaiter,g1(El&&El.maxRetryTimeout||t1.maxRetryTimeout)]),Ol=q_.networkState;const Al=await xS(_r,{data:yl,cancelToken:xa,headers:{"Content-Type":"multipart/form-data;"}},!0);return qot(Al,_r)},()=>!1,Al=>Al.code!==Hl.OPERATION_ABORTED&&(Al.code===Hl.UPDATE_TICKET_FAILED?Al.data.retry:(Ll.warning("[".concat(ba.clientId,"] update ticket network error, retry"),Al),!0)),El)}(_a,s,a,h)),allFailedhandler:_a=>{throw _a[0]},promisesCollector:j})};try{return g=await Q2([_e(!1),_e(!0)]),j.length&&j.forEach(_n=>_n.cancel&&typeof _n.cancel=="function"&&_n.cancel()),g}catch(_n){throw _n[0]}}function tX(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function eX(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?tX(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):tX(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}class Xot extends C_{constructor(){super(),Rl(this,"configs",void 0),Rl(this,"joinInfo",void 0),Rl(this,"cancelToken",void 0),Rl(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),Rl(this,"interval",void 0),Rl(this,"mutex",new B1("config-distribute")),Rl(this,"mutableParamsRead",!1)}startGetConfigDistribute(a,h){this.joinInfo=a,this.cancelToken=h,this.interval&&this.stopGetConfigDistribute(),wp("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},wp("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,d0.reportApiInvoke(null,{options:void 0,name:Y_.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:A_.TRACER}).onSuccess(JSON.stringify(x6))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void Ll.debug("[config-distribute] get config distribute interrupted have no joininfo");let a;const h=await this.mutex.lock();try{a=await zot(this.joinInfo,this.cancelToken,this.retryConfig),Ll.debug("[config-distribute] get config distribute",JSON.stringify(a)),a.limit_bitrate&&this.handleBitrateLimit(a.limit_bitrate),this.cacheGlobalParameterConfig(a),this.configs=a}catch(g){const j=new Ql(Hl.NETWORK_RESPONSE_ERROR,g);Ll.warning("[config-distribute] ".concat(j.toString()))}finally{h()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(a){var h;(h=a)&&h.uplink&&h.id&&h.uplink.max_bitrate!==void 0&&h.uplink.min_bitrate!==void 0&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==a.id&&this.emit(OP.UPDATE_BITRATE_LIMIT,a):this.emit(OP.UPDATE_BITRATE_LIMIT,a))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&eX({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(a){var h;const g=B6(h=Object.keys(a).filter(_e=>/^webrtc_ng_global_parameter/.test(_e))).call(h);for(let _e=0;_e<g.length;_e++)for(let _n=g.length-1;_n>_e;_n--){const _o=g[_n];if(typeof a[_o].__priority=="number"){const _a=a[_o].__priority,_r=g[_n-1];if(typeof a[_r].__priority=="number"){if(!(_a>a[_r].__priority))continue;{const ba=_o;g[_n]=g[_n-1],g[_n-1]=ba}}else{const ba=_o;g[_n]=g[_n-1],g[_n-1]=ba}}}const j={};g.forEach(_e=>{const _n=a[_e],_o=_n.__expires;Object.keys(_n).forEach(_a=>{_a==="__priority"||_a==="__expires"||Object.prototype.hasOwnProperty.call(j,_a)||(j[_a]=eX({value:_n[_a]},_o&&{expires:_o}))})});try{const _e=JSON.stringify(j),_n=window.btoa(_e);window.localStorage.setItem("websdk_ng_global_parameter",_n),Ll.debug("Caching global parameters ".concat(_e))}catch(_e){Ll.error("Error caching global parameters:",_e.message)}}}function nX(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function ZP(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?nX(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):nX(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}class Qot extends C_{constructor(a,h,g,j){super(),Rl(this,"spec",void 0),Rl(this,"token",void 0),Rl(this,"websocket",void 0),Rl(this,"pingpongTimer",void 0),Rl(this,"reconnectMode","retry"),Rl(this,"serviceMode",void 0),Rl(this,"reqId",0),Rl(this,"commandReqId",0),Rl(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),Rl(this,"handleWebSocketMessage",_e=>{if(!_e.data)return;const _n=JSON.parse(_e.data);_n.requestId?this.emit("@".concat(_n.requestId,"-").concat(_n.sid),_n):this.serviceMode===J_.INJECT?this.emit(fS.INJECT_STREAM_STATUS,_n):(d0.workerEvent(this.spec.sid,{actionType:"status",serverCode:_n.code,workerType:this.serviceMode===J_.TRANSCODE?1:2}),this.emit(fS.PUBLISH_STREAM_STATUS,_n))}),this.spec=h,this.token=a,this.serviceMode=j,this.websocket=new rN("live-streaming",g),this.websocket.on(k0.CONNECTED,this.handleWebSocketOpen),this.websocket.on(k0.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(k0.REQUEST_NEW_URLS,(_e,_n)=>{A1(this,fS.REQUEST_NEW_ADDRESS).then(_e).catch(_n)}),this.websocket.on(k0.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(a){return this.websocket.init(a)}async request(a,h,g,j){this.reqId+=1,a==="request"&&(this.commandReqId+=1);const _e=this.commandReqId,_n=this.reqId;if(!_n||!this.websocket)throw new Ql(Hl.UNEXPECTED_ERROR);const _o=ZP({command:a,sdkVersion:Ky==="4.16.1"?"0.0.1":Ky,seq:_n,requestId:_n,allocate:g,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},h);if(this.websocket.state==="closed")throw new Ql(Hl.WS_DISCONNECT);const _a=()=>new s0((El,yl)=>{this.websocket.once(k0.CLOSED,()=>yl(new Ql(Hl.WS_ABORT))),this.websocket.once(k0.CONNECTED,El)});this.websocket.state!=="connected"&&await _a(),_o.clientRequest&&(_o.clientRequest.workerToken=this.token);const _r=new s0((El,yl)=>{const Ol=()=>{yl(new Ql(Hl.WS_ABORT))};this.websocket.once(k0.RECONNECTING,Ol),this.websocket.once(k0.CLOSED,Ol),this.once("@".concat(_n,"-").concat(this.spec.sid),Al=>{El(Al)})});j&&d0.workerEvent(this.spec.sid,ZP(ZP({},j),{},{requestId:_e,actionType:"request",payload:JSON.stringify(h.clientRequest),serverCode:0,code:0}));const ba=Date.now();this.websocket.sendMessage(_o);let xa=null;try{xa=await _r}catch(El){if(this.websocket.state==="closed")throw El;return await _a(),await this.request(a,h,g)}return j&&d0.workerEvent(this.spec.sid,ZP(ZP({},j),{},{requestId:_e,actionType:"response",payload:JSON.stringify(xa.serverResponse),serverCode:xa.code,success:xa.code===200,responseTime:Date.now()-ba})),xa.code!==200&&this.handleResponseError(xa),xa}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const a=Ky==="4.16.1"?"0.0.1":Ky;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:a,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(a){switch(a.code){case P_.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void Ll.warning("live stream response already exists stream");case P_.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case P_.LIVE_STREAM_RESPONSE_BAD_STREAM:case P_.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new Ql(Hl.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:a.code}).throw();case P_.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(a.serverResponse.command==="UnpublishStream"||a.serverResponse.command==="UninjectStream")return;throw new Ql(Hl.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case P_.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new Ql(Hl.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:a.code}).throw();case P_.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const h=new Ql(Hl.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(fS.WARNING,h,a.serverResponse.url)}case P_.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const h=new Ql(Hl.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(fS.WARNING,h,a.serverResponse.url)}case P_.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new Ql(Hl.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case P_.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new Ql(Hl.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:a.code}).throw();case P_.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const h=new Ql(Hl.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(fS.WARNING,h,a.serverResponse.url)}case P_.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new Ql(Hl.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:a.code}).throw();case P_.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new Ql(Hl.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case P_.LIVE_STREAM_RESPONSE_WORKER_LOST:case P_.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(a.serverResponse.command==="UnpublishStream"||a.serverResponse.command==="UninjectStream")return;throw new Ql(Hl.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case P_.ERROR_FAIL_SEND_MESSAGE:if(a.serverResponse.command==="UnpublishStream"||a.serverResponse.command==="UninjectStream")return;if(a.serverResponse.command==="UpdateTranscoding"||a.serverResponse.command==="ControlStream")return new Ql(Hl.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:a.code}).throw();throw new Ql(Hl.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case P_.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case P_.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case P_.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case P_.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new Ql(Hl.LIVE_STREAMING_CDN_ERROR,"",{code:a.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(O4)},6e3)}}function rX(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function J1(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?rX(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):rX(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}class $ot extends C_{constructor(a){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t1,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t1;super(),Rl(this,"onLiveStreamWarning",void 0),Rl(this,"onLiveStreamError",void 0),Rl(this,"onInjectStatusChange",void 0),Rl(this,"spec",void 0),Rl(this,"retryTimeout",1e4),Rl(this,"connection",void 0),Rl(this,"httpRetryConfig",void 0),Rl(this,"wsRetryConfig",void 0),Rl(this,"streamingTasks",new Map),Rl(this,"isStartingStreamingTask",!1),Rl(this,"taskMutex",new B1("live-streaming")),Rl(this,"cancelToken",hS.CancelToken.source()),Rl(this,"transcodingConfig",void 0),Rl(this,"injectConfig",J1({},Fnt)),Rl(this,"injectLoopTimes",0),Rl(this,"uapResponse",void 0),Rl(this,"lastTaskId",1),Rl(this,"statusError",new Map),this.spec=a,this.httpRetryConfig=g,this.wsRetryConfig=h}async setTranscodingConfig(a){const h=J1(J1({},jnt),a);h.videoCodecProfile!==66&&h.videoCodecProfile!==77&&h.videoCodecProfile!==100&&(Ll.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(h.videoCodecProfile," -> 100")),h.videoCodecProfile=100),h.transcodingUsers||(h.transcodingUsers=h.userConfigs),h.transcodingUsers&&(h.transcodingUsers=h.transcodingUsers.map(_n=>J1(J1(J1({},Unt),_n),{},{zOrder:_n.zOrder?_n.zOrder+1:1}))),function(_n){S_(_n.width)||f_(_n.width,"config.width",0,1e4),S_(_n.height)||f_(_n.height,"config.height",0,1e4),S_(_n.videoBitrate)||f_(_n.videoBitrate,"config.videoBitrate",1,1e6),S_(_n.videoFrameRate)||f_(_n.videoFrameRate,"config.videoFrameRate"),S_(_n.lowLatency)||SP(_n.lowLatency,"config.lowLatency"),S_(_n.audioSampleRate)||y1(_n.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),S_(_n.audioBitrate)||f_(_n.audioBitrate,"config.audioBitrate",1,128),S_(_n.audioChannels)||y1(_n.audioChannels,"config.audioChannels",[1,2,3,4,5]),S_(_n.videoGop)||f_(_n.videoGop,"config.videoGop"),S_(_n.videoCodecProfile)||y1(_n.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),S_(_n.userCount)||f_(_n.userCount,"config.userCount",0,17),S_(_n.backgroundColor)||f_(_n.backgroundColor,"config.backgroundColor",0,16777215),S_(_n.userConfigExtraInfo)||b1(_n.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),_n.transcodingUsers&&!S_(_n.transcodingUsers)&&(kT(_n.transcodingUsers,"config.transcodingUsers"),_n.transcodingUsers.forEach((_o,_a)=>{W6(_o.uid),S_(_o.x)||f_(_o.x,"transcodingUser[".concat(_a,"].x"),0,1e4),S_(_o.y)||f_(_o.y,"transcodingUser[".concat(_a,"].y"),0,1e4),S_(_o.width)||f_(_o.width,"transcodingUser[".concat(_a,"].width"),0,1e4),S_(_o.height)||f_(_o.height,"transcodingUser[".concat(_a,"].height"),0,1e4),S_(_o.zOrder)||f_(_o.zOrder-1,"transcodingUser[".concat(_a,"].zOrder"),0,100),S_(_o.alpha)||f_(_o.alpha,"transcodingUser[".concat(_a,"].alpha"),0,1,!1)})),S_(_n.watermark)||Q6(_n.watermark,"watermark"),S_(_n.backgroundImage)||Q6(_n.backgroundImage,"backgroundImage"),_n.images&&!S_(_n.images)&&(kT(_n.images,"config.images"),_n.images.forEach((_o,_a)=>{Q6(_o,"images[".concat(_a,"]"))}))}(h);const g=[];h.images&&g.push(...h.images.map(_n=>J1(J1(J1({},X6),_n),{},{zOrder:255}))),h.backgroundImage&&(g.push(J1(J1(J1({},X6),h.backgroundImage),{},{zOrder:0})),delete h.backgroundImage),h.watermark&&(g.push(J1(J1(J1({},X6),h.watermark),{},{zOrder:255})),delete h.watermark),h.images=g,h.transcodingUsers&&(h.userConfigs=h.transcodingUsers.map(_n=>J1({},_n)),h.userCount=h.transcodingUsers.length,delete h.transcodingUsers);const j=(h.userConfigs||[]).map(_n=>typeof _n.uid=="number"?s0.resolve(_n.uid):$Y(_n.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await s0.all(j)).forEach((_n,_o)=>{h.userConfigs&&h.userConfigs[_o]&&(h.userConfigs[_o].uid=_n)}),this.transcodingConfig=h,this.connection)try{var _e;const _n=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(PT(_e=this.streamingTasks).call(_e)).map(_o=>_o.taskId).join("#")});Ll.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(_n.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(_n){if(!_n.data||!_n.data.retry)throw _n;_n.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(_o=>{Ll.warning("[".concat(this.spec.clientId,"] live streaming receive error"),_n.toString(),"try to republish",_o.url),this.startLiveStreamingTask(_o.url,_o.mode,_n).then(()=>{Ll.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(_o.url," success"))}).catch(_a=>{Ll.error("[".concat(this.spec.clientId,"] live streaming republish failed"),_o.url,_a.toString()),this.onLiveStreamError&&this.onLiveStreamError(_o.url,_a)})})}}setInjectStreamConfig(a,h){this.injectConfig=Object.assign({},this.injectConfig,a),this.injectLoopTimes=h}async startLiveStreamingTask(a,h,g){var j;if(Array.from(PT(j=this.streamingTasks).call(j)).find(_a=>_a.mode===J_.INJECT)&&h===J_.INJECT)return new Ql(Hl.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&h===J_.TRANSCODE)throw new Ql(Hl.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let _e={command:"PublishStream",ts:Date.now(),url:a,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};Ll.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(a,", mode: ").concat(h));const _n=await this.taskMutex.lock();if(!this.connection&&g)return void _n();if(this.streamingTasks.get(a)&&!g)return _n(),new Ql(Hl.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(h))}catch(_a){throw _n(),_a}switch(h){case J_.TRANSCODE:_e.transcodingConfig=J1({},this.transcodingConfig);break;case J_.RAW:break;case J_.INJECT:_e={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:a,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(_e.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const _o=this.lastTaskId++;try{const _a=new s0((ba,xa)=>{g1(this.retryTimeout).then(()=>{if(g)return xa(g);const El=this.statusError.get(a);return El?(this.statusError.delete(a),xa(El)):void 0})}),_r=await s0.race([this.connection.request("request",{clientRequest:_e},!0,{url:a,command:"PublishStream",workerType:h===J_.TRANSCODE?1:2,requestByUser:!g,tid:_o.toString()}),_a]);this.isStartingStreamingTask=!1,Ll.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(_r.code)),this.streamingTasks.set(a,{clientRequest:_e,mode:h,url:a,taskId:_o}),_n()}catch(_a){if(_n(),this.isStartingStreamingTask=!1,!_a.data||!_a.data.retry||g)throw _a;return _a.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(a,h,_a)):await this.startLiveStreamingTask(a,h,_a)}}stopLiveStreamingTask(a){return new s0((h,g)=>{const j=this.streamingTasks.get(a);if(!j||!this.connection)return new Ql(Hl.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const _e=j.mode;j.abortTask=()=>{Ll.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(a),h()},this.connection.request("request",{clientRequest:{command:_e===J_.INJECT?"UninjectStream":"UnpublishStream",url:j.url}},!1,{url:a,command:"UnPublishStream",workerType:_e===J_.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(_n=>{Ll.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(_n.code)),this.streamingTasks.delete(a),this.streamingTasks.size===0&&_e!==J_.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),h(),_e===J_.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(mR.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,a)}).catch(g)})}async controlInjectStream(a,h,g,j){const _e=this.streamingTasks.get(a);if(!_e||!this.connection||_e.mode!==J_.INJECT)throw new Ql(Hl.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:a,control:h,audioVolume:g,position:j}})).serverResponse}resetAllTask(){var a;const h=Array.from(PT(a=this.streamingTasks).call(a));this.terminate();for(const g of h)this.startLiveStreamingTask(g.url,g.mode).catch(j=>{this.onLiveStreamError&&this.onLiveStreamError(g.url,j)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=hS.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(a){if(this.connection)throw new Ql(Hl.UNEXPECTED_ERROR,"live streaming connection has already connected");const h=await A1(this,W2.REQUEST_WORKER_MANAGER_LIST,a);return this.uapResponse=h,this.connection=new Qot(h.workerToken,this.spec,this.wsRetryConfig,a),this.connection.on(fS.WARNING,(g,j)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(j,g)),this.connection.on(fS.PUBLISH_STREAM_STATUS,g=>this.handlePublishStreamServer(g)),this.connection.on(fS.INJECT_STREAM_STATUS,g=>this.handleInjectStreamServerStatus(g)),this.connection.on(fS.REQUEST_NEW_ADDRESS,(g,j)=>{if(!this.connection)return j(new Ql(Hl.UNEXPECTED_ERROR,"can not get new live streaming address list"));A1(this,W2.REQUEST_WORKER_MANAGER_LIST,a).then(_e=>{this.uapResponse=_e,g(_e.addressList)}).catch(j)}),await this.connection.init(h.addressList),this.connection}handlePublishStreamServer(a){const h=a.serverStatus&&a.serverStatus.url||"empty_url",g=this.streamingTasks.get(h),j=a.reason;switch(a.code){case P_.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case P_.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case P_.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case P_.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const _n=new Ql(Hl.LIVE_STREAMING_CDN_ERROR,"",{code:a.code});if(g)return Ll.error(_n.toString()),this.onLiveStreamError&&this.onLiveStreamError(h,_n);if(!this.isStartingStreamingTask)return;this.statusError.set(h,_n)}case P_.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const _n=new Ql(Hl.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,j);return this.onLiveStreamWarning&&this.onLiveStreamWarning(h,_n)}case P_.LIVE_STREAM_RESPONSE_WORKER_LOST:case P_.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var _e;if(!this.connection)return;this.connection.tryNextAddress();const _n=Array.from(PT(_e=this.streamingTasks).call(_e));for(const _o of _n)_o.abortTask?_o.abortTask():(Ll.warning("[".concat(this.spec.clientId,"] publish stream status code"),a.code,"try to republish",_o.url),this.startLiveStreamingTask(_o.url,_o.mode,new Ql(Hl.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:a.code})).then(()=>{Ll.debug("[".concat(this.spec.clientId,"] republish live stream success"),_o.url)}).catch(_a=>{Ll.error(_a.toString()),this.onLiveStreamError&&this.onLiveStreamError(_o.url,_a)}));return}}}handleInjectStreamServerStatus(a){const h=Number(a.uid),g=a.serverStatus&&a.serverStatus.url;switch(a.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(mR.INJECT_STREAM_STATUS_START_SUCCESS,h,g));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(mR.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,h,g),void this.streamingTasks.delete(g);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(mR.INJECT_STREAM_STATUS_START_UNAUTHORIZED,h,g),void this.streamingTasks.delete(g);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(mR.INJECT_STREAM_STATUS_BROKEN,h,g),void this.streamingTasks.delete(g);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(mR.INJECT_STREAM_STATUS_START_TIMEOUT,h,g),void this.streamingTasks.delete(g);default:return void Ll.debug("inject stream server status",a)}}hasUrl(a){return this.streamingTasks.has(a)}}class iX{constructor(){Rl(this,"destChannelMediaInfos",new Map),Rl(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(a){bq(a),this.srcChannelMediaInfo=a}addDestChannelInfo(a){bq(a),this.destChannelMediaInfos.set(a.channelName,a)}removeDestChannelInfo(a){q6(a),this.destChannelMediaInfos.delete(a)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function oX(s){if(!(s instanceof iX))return new Ql(Hl.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const a=s.getSrcChannelMediaInfo(),h=s.getDestChannelMediaInfo();if(!a)return new Ql(Hl.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(h.size===0)return new Ql(Hl.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class Zot extends C_{constructor(a,h,g){super(),Rl(this,"ws",void 0),Rl(this,"requestId",1),Rl(this,"heartBeatTimer",void 0),Rl(this,"joinInfo",void 0),Rl(this,"clientId",void 0),Rl(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),Rl(this,"onClose",j=>{this.emit("close"),this.dispose()}),Rl(this,"onMessage",j=>{const _e=JSON.parse(j.data);if(!_e||_e.command!=="serverResponse"||!_e.requestId)return _e&&_e.command==="serverStatus"&&_e.serverStatus&&_e.serverStatus.command?(this.emit("status",_e.serverStatus),void this.emit(_e.serverStatus.command,_e.serverStatus)):void 0;this.emit("req_".concat(_e.requestId),_e)}),this.joinInfo=a,this.clientId=h,this.ws=new rN("cross-channel-".concat(this.clientId),g),this.ws.on(k0.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(k0.CONNECTED,this.onOpen),this.ws.on(k0.ON_MESSAGE,this.onMessage),this.ws.on(k0.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(a){const h=this.requestId++;return a.requestId=h,a.seq=h,this.ws.sendMessage(a),h}waitStatus(a){return new s0((h,g)=>{const j=window.setTimeout(()=>{g(new Ql(Hl.TIMEOUT,"wait status timeout, status: ".concat(a)))},5e3);this.once(a,_e=>{window.clearTimeout(j),_e.state&&_e.state!==0?g(new Ql(Hl.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(a))):h(void 0)}),this.once("dispose",()=>{window.clearTimeout(j),g(new Ql(Hl.WS_ABORT))})})}async request(a){if(this.ws.state==="closed")throw new Ql(Hl.WS_DISCONNECT);const h=()=>new s0((_n,_o)=>{this.ws.once(k0.CLOSED,()=>_o(new Ql(Hl.WS_ABORT))),this.ws.once(k0.CONNECTED,_n)});this.ws.state!=="connected"&&await h();const g=this.sendMessage(a),j=new s0((_n,_o)=>{const _a=()=>{_o(new Ql(Hl.WS_ABORT))};this.ws.once(k0.RECONNECTING,_a),this.ws.once(k0.CLOSED,_a),this.once("req_".concat(g),_n),g1(3e3).then(()=>{this.removeAllListeners("req_".concat(g)),this.ws.off(k0.RECONNECTING,_a),this.ws.off(k0.CLOSED,_a),_o(new Ql(Hl.TIMEOUT,"cross channel ws request timeout"))})}),_e=await j;if(!_e||_e.code!==200)throw new Ql(Hl.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(_e)));return _e}async connect(a){this.ws.removeAllListeners(k0.REQUEST_NEW_URLS),this.ws.on(k0.REQUEST_NEW_URLS,h=>{h(a)}),await this.ws.init(a)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(a){const h=this.requestId++;return a.requestId=h,this.ws.sendMessage(a),h}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class tst extends C_{set state(a){a!==this._state&&(a!==z1.RELAY_STATE_FAILURE&&(this.errorCode=vR.RELAY_OK),this.emit("state",a,this.errorCode),this._state=a)}get state(){return this._state}constructor(a,h,g,j){super(),Rl(this,"joinInfo",void 0),Rl(this,"sid",void 0),Rl(this,"clientId",void 0),Rl(this,"cancelToken",hS.CancelToken.source()),Rl(this,"workerToken",void 0),Rl(this,"requestId",0),Rl(this,"signal",void 0),Rl(this,"prevChannelMediaConfig",void 0),Rl(this,"httpRetryConfig",void 0),Rl(this,"_state",z1.RELAY_STATE_IDLE),Rl(this,"errorCode",vR.RELAY_OK),Rl(this,"onStatus",_e=>{Ll.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(_e))),_e&&_e.command&&(_e.command==="onAudioPacketReceived"&&this.emit("event",DS.PACKET_RECEIVED_AUDIO_FROM_SRC),_e.command==="onVideoPacketReceived"&&this.emit("event",DS.PACKET_RECEIVED_VIDEO_FROM_SRC),_e.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=vR.SRC_TOKEN_EXPIRED,this.state=z1.RELAY_STATE_FAILURE),_e.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=vR.DEST_TOKEN_EXPIRED,this.state=z1.RELAY_STATE_FAILURE))}),Rl(this,"onReconnect",async()=>{Ll.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",DS.NETWORK_DISCONNECTED),this.state=z1.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(_e=>{this.state!==z1.RELAY_STATE_IDLE&&(Ll.error("auto restart channel media relay failed",_e.toString()),this.errorCode=vR.SERVER_CONNECTION_LOST,this.state=z1.RELAY_STATE_FAILURE)})}),this.joinInfo=a,this.clientId=h,this.sid=f8(),this.signal=new Zot(this.joinInfo,this.clientId,g),this.httpRetryConfig=j}async startChannelMediaRelay(a){if(this.state!==z1.RELAY_STATE_IDLE)throw new Ql(Hl.INVALID_OPERATION);this.state=z1.RELAY_STATE_CONNECTING,await this.connect(),Ll.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(a)}catch(h){throw h.data&&h.data.serverResponse&&h.data.serverResponse.command==="SetSourceChannel"?new Ql(Hl.CROSS_CHANNEL_FAILED_JOIN_SRC):h.data&&h.data.serverResponse&&h.serverResponse.command==="SetDestChannelStatus"?new Ql(Hl.CROSS_CHANNEL_FAILED_JOIN_DEST):h.data&&h.data.serverResponse&&h.serverResponse.command==="StartPacketTransfer"?new Ql(Hl.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):h}this.prevChannelMediaConfig=a}async updateChannelMediaRelay(a){if(this.state!==z1.RELAY_STATE_RUNNING)throw new Ql(Hl.INVALID_OPERATION);await this.sendUpdateMessage(a),this.prevChannelMediaConfig=a}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),Ll.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=z1.RELAY_STATE_IDLE,this.dispose()}dispose(){Ll.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=hS.CancelToken.source(),this.state=z1.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const a=await Yot(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=a.workerToken,await this.signal.connect(a.addressList),this.emit("event",DS.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(a){const h=this.genMessage(V1.StopPacketTransfer);await this.signal.request(h),await this.signal.waitStatus("Normal Quit"),Ll.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const g=this.genMessage(V1.SetSdkProfile,a);await this.signal.request(g),Ll.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const j=this.genMessage(V1.SetSourceChannel,a);await this.signal.request(j),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",DS.PACKET_JOINED_SRC_CHANNEL),Ll.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const _e=this.genMessage(V1.SetSourceUserId,a);await this.signal.request(_e),Ll.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const _n=this.genMessage(V1.SetDestChannel,a);await this.signal.request(_n),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",DS.PACKET_JOINED_DEST_CHANNEL),Ll.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const _o=this.genMessage(V1.StartPacketTransfer,a);await this.signal.request(_o),this.emit("event",DS.PACKET_SENT_TO_DEST_CHANNEL),this.state=z1.RELAY_STATE_RUNNING,Ll.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success"))}async sendUpdateMessage(a){const h=this.genMessage(V1.UpdateDestChannel,a);await this.signal.request(h),this.emit("event",DS.PACKET_UPDATE_DEST_CHANNEL),Ll.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const a=this.genMessage(V1.StopPacketTransfer);await this.signal.request(a),Ll.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(a,h){const g=[],j=[],_e=[];this.requestId+=1;const _n={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:Ky,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};_n.sdkVersion==="4.16.1"&&(_n.sdkVersion="0.0.1");let _o=null,_a=null;switch(a){case V1.SetSdkProfile:return _n.clientRequest={command:"SetSdkProfile",type:"multi_channel"},_n;case V1.SetSourceChannel:if(_a=h&&h.getSrcChannelMediaInfo(),!_a)throw new Ql(Hl.UNEXPECTED_ERROR,"can not find source config");return _n.clientRequest={command:"SetSourceChannel",uid:"0",channelName:_a.channelName,token:_a.token||this.joinInfo.appId},_n;case V1.SetSourceUserId:if(_a=h&&h.getSrcChannelMediaInfo(),!_a)throw new Ql(Hl.UNEXPECTED_ERROR,"can not find source config");return _n.clientRequest={command:"SetSourceUserId",uid:_a.uid+""},_n;case V1.SetDestChannel:if(_o=h&&h.getDestChannelMediaInfo(),!_o)throw new Ql(Hl.UNEXPECTED_ERROR,"can not find dest config");return _o.forEach(_r=>{g.push(_r.channelName),j.push(_r.uid+""),_e.push(_r.token||this.joinInfo.appId)}),_n.clientRequest={command:"SetDestChannel",channelName:g,uid:j,token:_e},_n;case V1.StartPacketTransfer:return _n.clientRequest={command:"StartPacketTransfer"},_n;case V1.Reconnect:return _n.clientRequest={command:"Reconnect"},_n;case V1.StopPacketTransfer:return _n.clientRequest={command:"StopPacketTransfer"},_n;case V1.UpdateDestChannel:if(_o=h&&h.getDestChannelMediaInfo(),!_o)throw new Ql(Hl.UNEXPECTED_ERROR,"can not find dest config");return _o.forEach(_r=>{g.push(_r.channelName),j.push(_r.uid+""),_e.push(_r.token||this.joinInfo.appId)}),_n.clientRequest={command:"UpdateDestChannel",channelName:g,uid:j,token:_e},_n}return _n}}const $8=s=>{const a=document.createElement("canvas");return a.width=2,a.height=2,new s0((h,g)=>{a.toBlob(async j=>{if(a.remove(),j){const _e=await sX(j);h({buffer:_e,width:a.width,height:a.height})}else g(new Ql(Hl.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},s,1)})},sX=async s=>{const a=await s.arrayBuffer();return new Uint8Array(a)};function aX(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function cX(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?aX(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):aX(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}class uX{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(a){a!==this._videoElementStatus&&(Ll.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(a)),this._videoElementStatus=a)}constructor(a){Rl(this,"trackId",void 0),Rl(this,"config",void 0),Rl(this,"onFirstVideoFrameDecoded",void 0),Rl(this,"freezeTimeCounterList",[]),Rl(this,"renderFreezeAccTime",0),Rl(this,"timeUpdatedCount",0),Rl(this,"freezeTime",0),Rl(this,"playbackTime",0),Rl(this,"lastTimeUpdatedTime",0),Rl(this,"autoplayFailed",!1),Rl(this,"videoTrack",void 0),Rl(this,"container",void 0),Rl(this,"videoElement",void 0),Rl(this,"videoElementCheckInterval",void 0),Rl(this,"_videoElementStatus",S1.NONE),Rl(this,"slot",void 0),Rl(this,"isGettingVideoDimensions",!1),Rl(this,"handleVideoEvents",h=>{switch(h.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=S1.PLAYING;break;case"loadeddata":this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded();break;case"canplay":this.videoElementStatus=S1.CANPLAY;break;case"stalled":this.videoElementStatus=S1.STALLED;break;case"suspend":this.videoElementStatus=S1.SUSPEND;break;case"pause":this.videoElementStatus=S1.PAUSED,x1()||AT()||iy()&&this.autoplayFailed||!this.videoElement||!this.videoTrack||this.videoTrack.readyState!=="live"||(Ll.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=S1.WAITING;break;case"abort":this.videoElementStatus=S1.ABORT;break;case"ended":this.videoElementStatus=S1.ENDED;break;case"emptied":this.videoElementStatus=S1.EMPTIED;break;case"error":{var g;this.videoElementStatus=S1.ERROR;const j=(g=this.videoElement)===null||g===void 0?void 0:g.error;j&&Ll.error("[".concat(this.trackId,"] media error, code: ").concat(j.code,", message: ").concat(j.message));break}case"timeupdate":{const j=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=j);const _e=j-this.lastTimeUpdatedTime,_n=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=j,DT.lastVisibleTime<DT.lastHiddenTime||_n<DT.lastHiddenTime||_n<DT.lastVisibleTime)return;for(_e>wp("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=_e),this.playbackTime+=_e;this.playbackTime>=6e3;){this.playbackTime-=6e3;const _o=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(_o),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),Rl(this,"startGetVideoDimensions",()=>{const h=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement&&this.videoElement.videoWidth*this.videoElement.videoHeight>4)return Ll.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(h,500)};!this.isGettingVideoDimensions&&h()}),Rl(this,"autoResumeAfterInterruption",()=>{this.videoElement&&this.videoTrack&&this.videoTrack.readyState==="live"&&G0.curState==="running"&&(p6()?(Ll.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):vV()?(Ll.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):mV()&&(Ll.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))}),Rl(this,"autoResumeAfterInterruptionOnIOS15",()=>{this.videoElement&&this.videoTrack&&this.videoTrack.readyState==="live"&&(p6()?(Ll.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):vV()?(Ll.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):mV()&&(Ll.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))}),this.slot=a.element,this.trackId=a.trackId,this.updateConfig(a),G0.on(r1.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),G0.on(r1.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15)}updateConfig(a){this.config=a,this.trackId=a.trackId;const h=a.element;h!==this.slot&&(this.destroy(),this.slot=h),this.createElements()}updateVideoTrack(a){this.videoTrack!==a&&(this.videoTrack=a,this.createElements())}play(a){if(this.videoElement){const h=this.videoElement.play();h&&h.catch&&h.catch(j=>{a&&d0.autoplayFailed(a,"video",j.message,this.trackId),j.name==="NotAllowedError"?(Ll.warning("detected video element autoplay failed",j),this.autoplayFailed=!0,this.handleAutoPlayFailed()):Ll.warning("[".concat(this.trackId,"] play warning: "),j)});const g=p_();if((g.name==="Safari"&&Number(g.version)===15||P2())&&h&&h.then&&h.catch){const j=()=>{this.config.mirror&&this.videoElement&&(this.videoElement.style.transform="rotateY(180deg)")};h.then(j).catch(j)}}}getCurrentFrame(){if(!this.videoElement)return new ImageData(2,2);const a=document.createElement("canvas");a.width=this.videoElement.videoWidth,a.height=this.videoElement.videoHeight;const h=a.getContext("2d");if(!h)return Ll.error("create canvas context failed!"),new ImageData(2,2);h.drawImage(this.videoElement,0,0,a.width,a.height);const g=h.getImageData(0,0,a.width,a.height);return a.remove(),g}async getCurrentFrameToUint8Array(a){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(!this.videoElement)return await $8(a);const g=document.createElement("canvas");g.width=this.videoElement.videoWidth,g.height=this.videoElement.videoHeight;const j=g.getContext("2d");return j?(j.drawImage(this.videoElement,0,0,g.width,g.height),new s0((_e,_n)=>{g.toBlob(async _o=>{if(g.remove(),_o){const _a=await sX(_o);_e({buffer:_a,width:g.width,height:g.height})}else _n(new Ql(Hl.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},a,h<0?.1:h>1?1:h)})):await $8(a)}destroy(){if(G0.off(r1.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),G0.off(r1.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),this.videoElement&&(this.videoElement.srcObject=null,this.videoElement.remove(),this.videoElement=void 0),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}this.freezeTimeCounterList=[]}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",this.createVideoElement(),this.container.appendChild(this.videoElement)):this.removeVideoElement(),this.slot.appendChild(this.container)}createVideoElement(){if(!this.videoElement&&(this.videoElementStatus=S1.INIT,this.videoElement=document.createElement("video"),this.container&&this.container.appendChild(this.videoElement),lX.forEach(_e=>{this.videoElement&&this.videoElement.addEventListener(_e,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{!document.getElementById("video_".concat(this.trackId))&&this.videoElement&&(this.videoElementStatus=S1.DESTROYED)},1e3),wp("ENABLE_VIDEO_FRAME_CALLBACK"))){var a,h;let _e;const _n=(_o,_a)=>{if(this.videoElementStatus===S1.PLAYING){if(_e){const xa=_a.presentationTime-_e.presentationTime;xa>wp("VIDEO_FREEZE_DURATION")&&DT.lastVisibleTime>=DT.lastHiddenTime&&_e.timestamp>DT.lastVisibleTime&&_e.timestamp>DT.lastHiddenTime&&(this.renderFreezeAccTime+=xa)}_e=cX(cX({},_a),{},{timestamp:_o})}var _r,ba;wp("ENABLE_VIDEO_FRAME_CALLBACK")&&((_r=this.videoElement)===null||_r===void 0||(ba=_r.requestVideoFrameCallback)===null||ba===void 0||ba.call(_r,_n))};(a=(h=this.videoElement).requestVideoFrameCallback)===null||a===void 0||a.call(h,_n)}this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),this.videoElement.style.left="0",this.videoElement.style.top="0",f6()&&(this.videoElement.poster="noposter");const g=p_();g.name==="Safari"&&Number(g.version)===15||P2()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,M_()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,M_()&&this.videoElement.load());const j=this.videoElement.play();j!==void 0&&j.catch(_e=>{Ll.debug("[".concat(this.trackId,"] playback interrupted"),_e.toString())})}removeVideoElement(){if(this.videoElement){lX.forEach(a=>{this.videoElement&&this.videoElement.removeEventListener(a,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0);try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=void 0,this.videoElementStatus=S1.NONE}}handleAutoPlayFailed(){if(this.videoElement){const a=h=>{h.preventDefault(),this.videoElement&&(this.videoElement.play().then(()=>{Ll.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(g=>{Ll.error(g)}),this.autoplayFailed=!1,QL()?document.body.removeEventListener("click",a,!0):(document.body.removeEventListener("touchstart",a,!0),document.body.removeEventListener("mousedown",a,!0)))};QL()?document.body.addEventListener("click",a,!0):(document.body.addEventListener("touchstart",a,!0),document.body.addEventListener("mousedown",a,!0)),hW()}}getVideoElement(){return this.videoElement}getContainerElement(){return this.container}}const lX=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];var dX={exports:{}};function est(s,a,h){const g=s.createShader(h);if(!g)return new Ql(Hl.WEBGL_INTERNAL_ERROR,"can not create shader").throw();if(s.shaderSource(g,a),s.compileShader(g),!s.getShaderParameter(g,s.COMPILE_STATUS)){const j=s.getShaderInfoLog(g);return s.deleteShader(g),new Ql(Hl.WEBGL_INTERNAL_ERROR,"error compiling shader:"+j).throw()}return g}function nst(s,a,h,g){const j=[];for(let _e=0;_e<a.length;++_e){const _n=_e===0?s.VERTEX_SHADER:s.FRAGMENT_SHADER;j.push(est(s,a[_e],_n))}return function(_e,_n,_o,_a){const _r=_e.createProgram();if(!_r)throw new Ql(Hl.WEBGL_INTERNAL_ERROR,"can not create webgl program");if(_n.forEach(ba=>{_e.attachShader(_r,ba)}),_o&&_o.forEach((ba,xa)=>{_e.bindAttribLocation(_r,_a?_a[xa]:xa,ba)}),_e.linkProgram(_r),!_e.getProgramParameter(_r,_e.LINK_STATUS)){const ba=_e.getProgramInfoLog(_r);throw _e.deleteProgram(_r),new Ql(Hl.WEBGL_INTERNAL_ERROR,"error in program linking:"+ba)}return _r}(s,j,h,g)}(function(s,a){var h;h=()=>(()=>{var g={3536:(_o,_a,_r)=>{var ba=_r(1910);_o.exports=ba},8171:(_o,_a,_r)=>{_r(6450);var ba=_r(4058).Object,xa=_o.exports=function(El,yl,Ol){return ba.defineProperty(El,yl,Ol)};ba.defineProperty.sham&&(xa.sham=!0)},2956:(_o,_a,_r)=>{_r(7627),_r(6274),_r(5967),_r(8881),_r(4560),_r(7206),_r(4349),_r(7971);var ba=_r(4058);_o.exports=ba.Promise},3685:(_o,_a,_r)=>{_o.exports=_r(621)},621:(_o,_a,_r)=>{var ba=_r(3536);_o.exports=ba},4883:(_o,_a,_r)=>{var ba=_r(7475),xa=_r(9826),El=TypeError;_o.exports=function(yl){if(ba(yl))return yl;throw El(xa(yl)+" is not a function")}},174:(_o,_a,_r)=>{var ba=_r(4284),xa=_r(9826),El=TypeError;_o.exports=function(yl){if(ba(yl))return yl;throw El(xa(yl)+" is not a constructor")}},1851:(_o,_a,_r)=>{var ba=_r(7475),xa=String,El=TypeError;_o.exports=function(yl){if(typeof yl=="object"||ba(yl))return yl;throw El("Can't set "+xa(yl)+" as a prototype")}},8479:_o=>{_o.exports=function(){}},5743:(_o,_a,_r)=>{var ba=_r(7046),xa=TypeError;_o.exports=function(El,yl){if(ba(yl,El))return El;throw xa("Incorrect invocation")}},6059:(_o,_a,_r)=>{var ba=_r(941),xa=String,El=TypeError;_o.exports=function(yl){if(ba(yl))return yl;throw El(xa(yl)+" is not an object")}},1692:(_o,_a,_r)=>{var ba=_r(4529),xa=_r(9413),El=_r(623),yl=function(Ol){return function(Al,Nl,Ml){var Fl,up=ba(Al),_p=El(up),Tp=xa(Ml,_p);if(Ol&&Nl!=Nl){for(;_p>Tp;)if((Fl=up[Tp++])!=Fl)return!0}else for(;_p>Tp;Tp++)if((Ol||Tp in up)&&up[Tp]===Nl)return Ol||Tp||0;return!Ol&&-1}};_o.exports={includes:yl(!0),indexOf:yl(!1)}},3765:(_o,_a,_r)=>{var ba=_r(5329);_o.exports=ba([].slice)},1385:(_o,_a,_r)=>{var ba=_r(9813)("iterator"),xa=!1;try{var El=0,yl={next:function(){return{done:!!El++}},return:function(){xa=!0}};yl[ba]=function(){return this},Array.from(yl,function(){throw 2})}catch{}_o.exports=function(Ol,Al){if(!Al&&!xa)return!1;var Nl=!1;try{var Ml={};Ml[ba]=function(){return{next:function(){return{done:Nl=!0}}}},Ol(Ml)}catch{}return Nl}},2532:(_o,_a,_r)=>{var ba=_r(4163),xa=ba({}.toString),El=ba("".slice);_o.exports=function(yl){return El(xa(yl),8,-1)}},9697:(_o,_a,_r)=>{var ba=_r(2885),xa=_r(7475),El=_r(2532),yl=_r(9813)("toStringTag"),Ol=Object,Al=El(function(){return arguments}())=="Arguments";_o.exports=ba?El:function(Nl){var Ml,Fl,up;return Nl===void 0?"Undefined":Nl===null?"Null":typeof(Fl=function(_p,Tp){try{return _p[Tp]}catch{}}(Ml=Ol(Nl),yl))=="string"?Fl:Al?El(Ml):(up=El(Ml))=="Object"&&xa(Ml.callee)?"Arguments":up}},3489:(_o,_a,_r)=>{var ba=_r(953),xa=_r(1136),El=_r(9677),yl=_r(5988);_o.exports=function(Ol,Al,Nl){for(var Ml=xa(Al),Fl=yl.f,up=El.f,_p=0;_p<Ml.length;_p++){var Tp=Ml[_p];ba(Ol,Tp)||Nl&&ba(Nl,Tp)||Fl(Ol,Tp,up(Al,Tp))}}},4160:(_o,_a,_r)=>{var ba=_r(5981);_o.exports=!ba(function(){function xa(){}return xa.prototype.constructor=null,Object.getPrototypeOf(new xa)!==xa.prototype})},3538:_o=>{_o.exports=function(_a,_r){return{value:_a,done:_r}}},2029:(_o,_a,_r)=>{var ba=_r(5746),xa=_r(5988),El=_r(1887);_o.exports=ba?function(yl,Ol,Al){return xa.f(yl,Ol,El(1,Al))}:function(yl,Ol,Al){return yl[Ol]=Al,yl}},1887:_o=>{_o.exports=function(_a,_r){return{enumerable:!(1&_a),configurable:!(2&_a),writable:!(4&_a),value:_r}}},5929:(_o,_a,_r)=>{var ba=_r(2029);_o.exports=function(xa,El,yl,Ol){return Ol&&Ol.enumerable?xa[El]=yl:ba(xa,El,yl),xa}},5609:(_o,_a,_r)=>{var ba=_r(1899),xa=Object.defineProperty;_o.exports=function(El,yl){try{xa(ba,El,{value:yl,configurable:!0,writable:!0})}catch{ba[El]=yl}return yl}},5746:(_o,_a,_r)=>{var ba=_r(5981);_o.exports=!ba(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},6616:_o=>{var _a=typeof document=="object"&&document.all,_r=_a===void 0&&_a!==void 0;_o.exports={all:_a,IS_HTMLDDA:_r}},1333:(_o,_a,_r)=>{var ba=_r(1899),xa=_r(941),El=ba.document,yl=xa(El)&&xa(El.createElement);_o.exports=function(Ol){return yl?El.createElement(Ol):{}}},3281:_o=>{_o.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3321:(_o,_a,_r)=>{var ba=_r(8501),xa=_r(6049);_o.exports=!ba&&!xa&&typeof window=="object"&&typeof document=="object"},8501:_o=>{_o.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},4470:(_o,_a,_r)=>{var ba=_r(2861),xa=_r(1899);_o.exports=/ipad|iphone|ipod/i.test(ba)&&xa.Pebble!==void 0},2749:(_o,_a,_r)=>{var ba=_r(2861);_o.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(ba)},6049:(_o,_a,_r)=>{var ba=_r(2532),xa=_r(1899);_o.exports=ba(xa.process)=="process"},8045:(_o,_a,_r)=>{var ba=_r(2861);_o.exports=/web0s(?!.*chrome)/i.test(ba)},2861:(_o,_a,_r)=>{var ba=_r(626);_o.exports=ba("navigator","userAgent")||""},3385:(_o,_a,_r)=>{var ba,xa,El=_r(1899),yl=_r(2861),Ol=El.process,Al=El.Deno,Nl=Ol&&Ol.versions||Al&&Al.version,Ml=Nl&&Nl.v8;Ml&&(xa=(ba=Ml.split("."))[0]>0&&ba[0]<4?1:+(ba[0]+ba[1])),!xa&&yl&&(!(ba=yl.match(/Edge\/(\d+)/))||ba[1]>=74)&&(ba=yl.match(/Chrome\/(\d+)/))&&(xa=+ba[1]),_o.exports=xa},6759:_o=>{_o.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3995:(_o,_a,_r)=>{var ba=_r(5329),xa=Error,El=ba("".replace),yl=String(xa("zxcasd").stack),Ol=/\n\s*at [^:]*:[^\n]*/,Al=Ol.test(yl);_o.exports=function(Nl,Ml){if(Al&&typeof Nl=="string"&&!xa.prepareStackTrace)for(;Ml--;)Nl=El(Nl,Ol,"");return Nl}},8780:(_o,_a,_r)=>{var ba=_r(5981),xa=_r(1887);_o.exports=!ba(function(){var El=Error("a");return!("stack"in El)||(Object.defineProperty(El,"stack",xa(1,7)),El.stack!==7)})},6887:(_o,_a,_r)=>{var ba=_r(1899),xa=_r(9730),El=_r(5329),yl=_r(7475),Ol=_r(9677).f,Al=_r(7252),Nl=_r(4058),Ml=_r(6843),Fl=_r(2029),up=_r(953),_p=function(Tp){var Fp=function(Ap,Xp,_g){if(this instanceof Fp){switch(arguments.length){case 0:return new Tp;case 1:return new Tp(Ap);case 2:return new Tp(Ap,Xp)}return new Tp(Ap,Xp,_g)}return xa(Tp,this,arguments)};return Fp.prototype=Tp.prototype,Fp};_o.exports=function(Tp,Fp){var Ap,Xp,_g,Yp,h0,E0,A0,_E,Rp=Tp.target,Lp=Tp.global,Ep=Tp.stat,Ip=Tp.proto,Vp=Lp?ba:Ep?ba[Rp]:(ba[Rp]||{}).prototype,_v=Lp?Nl:Nl[Rp]||Fl(Nl,Rp,{})[Rp],f0=_v.prototype;for(_g in Fp)Ap=!Al(Lp?_g:Rp+(Ep?".":"#")+_g,Tp.forced)&&Vp&&up(Vp,_g),h0=_v[_g],Ap&&(E0=Tp.dontCallGetSet?(_E=Ol(Vp,_g))&&_E.value:Vp[_g]),Yp=Ap&&E0?E0:Fp[_g],Ap&&typeof h0==typeof Yp||(A0=Tp.bind&&Ap?Ml(Yp,ba):Tp.wrap&&Ap?_p(Yp):Ip&&yl(Yp)?El(Yp):Yp,(Tp.sham||Yp&&Yp.sham||h0&&h0.sham)&&Fl(A0,"sham",!0),Fl(_v,_g,A0),Ip&&(up(Nl,Xp=Rp+"Prototype")||Fl(Nl,Xp,{}),Fl(Nl[Xp],_g,Yp),Tp.real&&f0&&!f0[_g]&&Fl(f0,_g,Yp)))}},5981:_o=>{_o.exports=function(_a){try{return!!_a()}catch{return!0}}},9730:(_o,_a,_r)=>{var ba=_r(8285),xa=Function.prototype,El=xa.apply,yl=xa.call;_o.exports=typeof Reflect=="object"&&Reflect.apply||(ba?yl.bind(El):function(){return yl.apply(El,arguments)})},6843:(_o,_a,_r)=>{var ba=_r(5329),xa=_r(4883),El=_r(8285),yl=ba(ba.bind);_o.exports=function(Ol,Al){return xa(Ol),Al===void 0?Ol:El?yl(Ol,Al):function(){return Ol.apply(Al,arguments)}}},8285:(_o,_a,_r)=>{var ba=_r(5981);_o.exports=!ba(function(){var xa=function(){}.bind();return typeof xa!="function"||xa.hasOwnProperty("prototype")})},8834:(_o,_a,_r)=>{var ba=_r(8285),xa=Function.prototype.call;_o.exports=ba?xa.bind(xa):function(){return xa.apply(xa,arguments)}},9417:(_o,_a,_r)=>{var ba=_r(5746),xa=_r(953),El=Function.prototype,yl=ba&&Object.getOwnPropertyDescriptor,Ol=xa(El,"name"),Al=Ol&&function(){}.name==="something",Nl=Ol&&(!ba||ba&&yl(El,"name").configurable);_o.exports={EXISTS:Ol,PROPER:Al,CONFIGURABLE:Nl}},4163:(_o,_a,_r)=>{var ba=_r(8285),xa=Function.prototype,El=xa.call,yl=ba&&xa.bind.bind(El,El);_o.exports=ba?yl:function(Ol){return function(){return El.apply(Ol,arguments)}}},5329:(_o,_a,_r)=>{var ba=_r(2532),xa=_r(4163);_o.exports=function(El){if(ba(El)==="Function")return xa(El)}},626:(_o,_a,_r)=>{var ba=_r(4058),xa=_r(1899),El=_r(7475),yl=function(Ol){return El(Ol)?Ol:void 0};_o.exports=function(Ol,Al){return arguments.length<2?yl(ba[Ol])||yl(xa[Ol]):ba[Ol]&&ba[Ol][Al]||xa[Ol]&&xa[Ol][Al]}},2902:(_o,_a,_r)=>{var ba=_r(9697),xa=_r(4229),El=_r(2119),yl=_r(2077),Ol=_r(9813)("iterator");_o.exports=function(Al){if(!El(Al))return xa(Al,Ol)||xa(Al,"@@iterator")||yl[ba(Al)]}},3476:(_o,_a,_r)=>{var ba=_r(8834),xa=_r(4883),El=_r(6059),yl=_r(9826),Ol=_r(2902),Al=TypeError;_o.exports=function(Nl,Ml){var Fl=arguments.length<2?Ol(Nl):Ml;if(xa(Fl))return El(ba(Fl,Nl));throw Al(yl(Nl)+" is not iterable")}},4229:(_o,_a,_r)=>{var ba=_r(4883),xa=_r(2119);_o.exports=function(El,yl){var Ol=El[yl];return xa(Ol)?void 0:ba(Ol)}},1899:(_o,_a,_r)=>{var ba=function(xa){return xa&&xa.Math==Math&&xa};_o.exports=ba(typeof globalThis=="object"&&globalThis)||ba(typeof window=="object"&&window)||ba(typeof self=="object"&&self)||ba(typeof _r.g=="object"&&_r.g)||function(){return this}()||Function("return this")()},953:(_o,_a,_r)=>{var ba=_r(5329),xa=_r(9678),El=ba({}.hasOwnProperty);_o.exports=Object.hasOwn||function(yl,Ol){return El(xa(yl),Ol)}},7748:_o=>{_o.exports={}},4845:(_o,_a,_r)=>{var ba=_r(1899);_o.exports=function(xa,El){var yl=ba.console;yl&&yl.error&&(arguments.length==1?yl.error(xa):yl.error(xa,El))}},5463:(_o,_a,_r)=>{var ba=_r(626);_o.exports=ba("document","documentElement")},2840:(_o,_a,_r)=>{var ba=_r(5746),xa=_r(5981),El=_r(1333);_o.exports=!ba&&!xa(function(){return Object.defineProperty(El("div"),"a",{get:function(){return 7}}).a!=7})},7026:(_o,_a,_r)=>{var ba=_r(5329),xa=_r(5981),El=_r(2532),yl=Object,Ol=ba("".split);_o.exports=xa(function(){return!yl("z").propertyIsEnumerable(0)})?function(Al){return El(Al)=="String"?Ol(Al,""):yl(Al)}:yl},1302:(_o,_a,_r)=>{var ba=_r(5329),xa=_r(7475),El=_r(3030),yl=ba(Function.toString);xa(El.inspectSource)||(El.inspectSource=function(Ol){return yl(Ol)}),_o.exports=El.inspectSource},3794:(_o,_a,_r)=>{var ba=_r(941),xa=_r(2029);_o.exports=function(El,yl){ba(yl)&&"cause"in yl&&xa(El,"cause",yl.cause)}},5402:(_o,_a,_r)=>{var ba,xa,El,yl=_r(7093),Ol=_r(1899),Al=_r(941),Nl=_r(2029),Ml=_r(953),Fl=_r(3030),up=_r(4262),_p=_r(7748),Tp="Object already initialized",Fp=Ol.TypeError,Ap=Ol.WeakMap;if(yl||Fl.state){var Xp=Fl.state||(Fl.state=new Ap);Xp.get=Xp.get,Xp.has=Xp.has,Xp.set=Xp.set,ba=function(Yp,h0){if(Xp.has(Yp))throw Fp(Tp);return h0.facade=Yp,Xp.set(Yp,h0),h0},xa=function(Yp){return Xp.get(Yp)||{}},El=function(Yp){return Xp.has(Yp)}}else{var _g=up("state");_p[_g]=!0,ba=function(Yp,h0){if(Ml(Yp,_g))throw Fp(Tp);return h0.facade=Yp,Nl(Yp,_g,h0),h0},xa=function(Yp){return Ml(Yp,_g)?Yp[_g]:{}},El=function(Yp){return Ml(Yp,_g)}}_o.exports={set:ba,get:xa,has:El,enforce:function(Yp){return El(Yp)?xa(Yp):ba(Yp,{})},getterFor:function(Yp){return function(h0){var E0;if(!Al(h0)||(E0=xa(h0)).type!==Yp)throw Fp("Incompatible receiver, "+Yp+" required");return E0}}}},6782:(_o,_a,_r)=>{var ba=_r(9813),xa=_r(2077),El=ba("iterator"),yl=Array.prototype;_o.exports=function(Ol){return Ol!==void 0&&(xa.Array===Ol||yl[El]===Ol)}},7475:(_o,_a,_r)=>{var ba=_r(6616),xa=ba.all;_o.exports=ba.IS_HTMLDDA?function(El){return typeof El=="function"||El===xa}:function(El){return typeof El=="function"}},4284:(_o,_a,_r)=>{var ba=_r(5329),xa=_r(5981),El=_r(7475),yl=_r(9697),Ol=_r(626),Al=_r(1302),Nl=function(){},Ml=[],Fl=Ol("Reflect","construct"),up=/^\s*(?:class|function)\b/,_p=ba(up.exec),Tp=!up.exec(Nl),Fp=function(Xp){if(!El(Xp))return!1;try{return Fl(Nl,Ml,Xp),!0}catch{return!1}},Ap=function(Xp){if(!El(Xp))return!1;switch(yl(Xp)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Tp||!!_p(up,Al(Xp))}catch{return!0}};Ap.sham=!0,_o.exports=!Fl||xa(function(){var Xp;return Fp(Fp.call)||!Fp(Object)||!Fp(function(){Xp=!0})||Xp})?Ap:Fp},7252:(_o,_a,_r)=>{var ba=_r(5981),xa=_r(7475),El=/#|\.prototype\./,yl=function(Fl,up){var _p=Al[Ol(Fl)];return _p==Ml||_p!=Nl&&(xa(up)?ba(up):!!up)},Ol=yl.normalize=function(Fl){return String(Fl).replace(El,".").toLowerCase()},Al=yl.data={},Nl=yl.NATIVE="N",Ml=yl.POLYFILL="P";_o.exports=yl},2119:_o=>{_o.exports=function(_a){return _a==null}},941:(_o,_a,_r)=>{var ba=_r(7475),xa=_r(6616),El=xa.all;_o.exports=xa.IS_HTMLDDA?function(yl){return typeof yl=="object"?yl!==null:ba(yl)||yl===El}:function(yl){return typeof yl=="object"?yl!==null:ba(yl)}},2529:_o=>{_o.exports=!0},6664:(_o,_a,_r)=>{var ba=_r(626),xa=_r(7475),El=_r(7046),yl=_r(2302),Ol=Object;_o.exports=yl?function(Al){return typeof Al=="symbol"}:function(Al){var Nl=ba("Symbol");return xa(Nl)&&El(Nl.prototype,Ol(Al))}},3091:(_o,_a,_r)=>{var ba=_r(6843),xa=_r(8834),El=_r(6059),yl=_r(9826),Ol=_r(6782),Al=_r(623),Nl=_r(7046),Ml=_r(3476),Fl=_r(2902),up=_r(7609),_p=TypeError,Tp=function(Ap,Xp){this.stopped=Ap,this.result=Xp},Fp=Tp.prototype;_o.exports=function(Ap,Xp,_g){var Yp,h0,E0,A0,_E,Rp,Lp,Ep=_g&&_g.that,Ip=!(!_g||!_g.AS_ENTRIES),Vp=!(!_g||!_g.IS_RECORD),_v=!(!_g||!_g.IS_ITERATOR),f0=!(!_g||!_g.INTERRUPTED),zp=ba(Xp,Ep),Il=function(_h){return Yp&&up(Yp,"normal",_h),new Tp(!0,_h)},Gl=function(_h){return Ip?(El(_h),f0?zp(_h[0],_h[1],Il):zp(_h[0],_h[1])):f0?zp(_h,Il):zp(_h)};if(Vp)Yp=Ap.iterator;else if(_v)Yp=Ap;else{if(!(h0=Fl(Ap)))throw _p(yl(Ap)+" is not iterable");if(Ol(h0)){for(E0=0,A0=Al(Ap);A0>E0;E0++)if((_E=Gl(Ap[E0]))&&Nl(Fp,_E))return _E;return new Tp(!1)}Yp=Ml(Ap,h0)}for(Rp=Vp?Ap.next:Yp.next;!(Lp=xa(Rp,Yp)).done;){try{_E=Gl(Lp.value)}catch(_h){up(Yp,"throw",_h)}if(typeof _E=="object"&&_E&&Nl(Fp,_E))return _E}return new Tp(!1)}},7609:(_o,_a,_r)=>{var ba=_r(8834),xa=_r(6059),El=_r(4229);_o.exports=function(yl,Ol,Al){var Nl,Ml;xa(yl);try{if(!(Nl=El(yl,"return"))){if(Ol==="throw")throw Al;return Al}Nl=ba(Nl,yl)}catch(Fl){Ml=!0,Nl=Fl}if(Ol==="throw")throw Al;if(Ml)throw Nl;return xa(Nl),Al}},3847:(_o,_a,_r)=>{var ba=_r(5143).IteratorPrototype,xa=_r(9290),El=_r(1887),yl=_r(904),Ol=_r(2077),Al=function(){return this};_o.exports=function(Nl,Ml,Fl,up){var _p=Ml+" Iterator";return Nl.prototype=xa(ba,{next:El(+!up,Fl)}),yl(Nl,_p,!1,!0),Ol[_p]=Al,Nl}},5105:(_o,_a,_r)=>{var ba=_r(6887),xa=_r(8834),El=_r(2529),yl=_r(9417),Ol=_r(7475),Al=_r(3847),Nl=_r(249),Ml=_r(8929),Fl=_r(904),up=_r(2029),_p=_r(5929),Tp=_r(9813),Fp=_r(2077),Ap=_r(5143),Xp=yl.PROPER,_g=yl.CONFIGURABLE,Yp=Ap.IteratorPrototype,h0=Ap.BUGGY_SAFARI_ITERATORS,E0=Tp("iterator"),A0="keys",_E="values",Rp="entries",Lp=function(){return this};_o.exports=function(Ep,Ip,Vp,_v,f0,zp,Il){Al(Vp,Ip,_v);var Gl,_h,Pp,m0=function(X0){if(X0===f0&&q0)return q0;if(!h0&&X0 in e_)return e_[X0];switch(X0){case A0:case _E:case Rp:return function(){return new Vp(this,X0)}}return function(){return new Vp(this)}},Q0=Ip+" Iterator",h_=!1,e_=Ep.prototype,$_=e_[E0]||e_["@@iterator"]||f0&&e_[f0],q0=!h0&&$_||m0(f0),E_=Ip=="Array"&&e_.entries||$_;if(E_&&(Gl=Nl(E_.call(new Ep)))!==Object.prototype&&Gl.next&&(El||Nl(Gl)===Yp||(Ml?Ml(Gl,Yp):Ol(Gl[E0])||_p(Gl,E0,Lp)),Fl(Gl,Q0,!0,!0),El&&(Fp[Q0]=Lp)),Xp&&f0==_E&&$_&&$_.name!==_E&&(!El&&_g?up(e_,"name",_E):(h_=!0,q0=function(){return xa($_,this)})),f0)if(_h={values:m0(_E),keys:zp?q0:m0(A0),entries:m0(Rp)},Il)for(Pp in _h)(h0||h_||!(Pp in e_))&&_p(e_,Pp,_h[Pp]);else ba({target:Ip,proto:!0,forced:h0||h_},_h);return El&&!Il||e_[E0]===q0||_p(e_,E0,q0,{name:f0}),Fp[Ip]=q0,_h}},5143:(_o,_a,_r)=>{var ba,xa,El,yl=_r(5981),Ol=_r(7475),Al=_r(941),Nl=_r(9290),Ml=_r(249),Fl=_r(5929),up=_r(9813),_p=_r(2529),Tp=up("iterator"),Fp=!1;[].keys&&("next"in(El=[].keys())?(xa=Ml(Ml(El)))!==Object.prototype&&(ba=xa):Fp=!0),!Al(ba)||yl(function(){var Ap={};return ba[Tp].call(Ap)!==Ap})?ba={}:_p&&(ba=Nl(ba)),Ol(ba[Tp])||Fl(ba,Tp,function(){return this}),_o.exports={IteratorPrototype:ba,BUGGY_SAFARI_ITERATORS:Fp}},2077:_o=>{_o.exports={}},623:(_o,_a,_r)=>{var ba=_r(3057);_o.exports=function(xa){return ba(xa.length)}},5331:_o=>{var _a=Math.ceil,_r=Math.floor;_o.exports=Math.trunc||function(ba){var xa=+ba;return(xa>0?_r:_a)(xa)}},6132:(_o,_a,_r)=>{var ba,xa,El,yl,Ol,Al,Nl,Ml,Fl=_r(1899),up=_r(6843),_p=_r(9677).f,Tp=_r(2941).set,Fp=_r(2749),Ap=_r(4470),Xp=_r(8045),_g=_r(6049),Yp=Fl.MutationObserver||Fl.WebKitMutationObserver,h0=Fl.document,E0=Fl.process,A0=Fl.Promise,_E=_p(Fl,"queueMicrotask"),Rp=_E&&_E.value;Rp||(ba=function(){var Lp,Ep;for(_g&&(Lp=E0.domain)&&Lp.exit();xa;){Ep=xa.fn,xa=xa.next;try{Ep()}catch(Ip){throw xa?yl():El=void 0,Ip}}El=void 0,Lp&&Lp.enter()},Fp||_g||Xp||!Yp||!h0?!Ap&&A0&&A0.resolve?((Nl=A0.resolve(void 0)).constructor=A0,Ml=up(Nl.then,Nl),yl=function(){Ml(ba)}):_g?yl=function(){E0.nextTick(ba)}:(Tp=up(Tp,Fl),yl=function(){Tp(ba)}):(Ol=!0,Al=h0.createTextNode(""),new Yp(ba).observe(Al,{characterData:!0}),yl=function(){Al.data=Ol=!Ol})),_o.exports=Rp||function(Lp){var Ep={fn:Lp,next:void 0};El&&(El.next=Ep),xa||(xa=Ep,yl()),El=Ep}},9520:(_o,_a,_r)=>{var ba=_r(4883),xa=TypeError,El=function(yl){var Ol,Al;this.promise=new yl(function(Nl,Ml){if(Ol!==void 0||Al!==void 0)throw xa("Bad Promise constructor");Ol=Nl,Al=Ml}),this.resolve=ba(Ol),this.reject=ba(Al)};_o.exports.f=function(yl){return new El(yl)}},4649:(_o,_a,_r)=>{var ba=_r(5803);_o.exports=function(xa,El){return xa===void 0?arguments.length<2?"":El:ba(xa)}},9290:(_o,_a,_r)=>{var ba,xa=_r(6059),El=_r(9938),yl=_r(6759),Ol=_r(7748),Al=_r(5463),Nl=_r(1333),Ml=_r(4262)("IE_PROTO"),Fl=function(){},up=function(Fp){return"<script>"+Fp+"<\/script>"},_p=function(Fp){Fp.write(up("")),Fp.close();var Ap=Fp.parentWindow.Object;return Fp=null,Ap},Tp=function(){try{ba=new ActiveXObject("htmlfile")}catch{}var Fp,Ap;Tp=typeof document<"u"?document.domain&&ba?_p(ba):((Ap=Nl("iframe")).style.display="none",Al.appendChild(Ap),Ap.src=String("javascript:"),(Fp=Ap.contentWindow.document).open(),Fp.write(up("document.F=Object")),Fp.close(),Fp.F):_p(ba);for(var Xp=yl.length;Xp--;)delete Tp.prototype[yl[Xp]];return Tp()};Ol[Ml]=!0,_o.exports=Object.create||function(Fp,Ap){var Xp;return Fp!==null?(Fl.prototype=xa(Fp),Xp=new Fl,Fl.prototype=null,Xp[Ml]=Fp):Xp=Tp(),Ap===void 0?Xp:El.f(Xp,Ap)}},9938:(_o,_a,_r)=>{var ba=_r(5746),xa=_r(3937),El=_r(5988),yl=_r(6059),Ol=_r(4529),Al=_r(4771);_a.f=ba&&!xa?Object.defineProperties:function(Nl,Ml){yl(Nl);for(var Fl,up=Ol(Ml),_p=Al(Ml),Tp=_p.length,Fp=0;Tp>Fp;)El.f(Nl,Fl=_p[Fp++],up[Fl]);return Nl}},5988:(_o,_a,_r)=>{var ba=_r(5746),xa=_r(2840),El=_r(3937),yl=_r(6059),Ol=_r(3894),Al=TypeError,Nl=Object.defineProperty,Ml=Object.getOwnPropertyDescriptor;_a.f=ba?El?function(Fl,up,_p){if(yl(Fl),up=Ol(up),yl(_p),typeof Fl=="function"&&up==="prototype"&&"value"in _p&&"writable"in _p&&!_p.writable){var Tp=Ml(Fl,up);Tp&&Tp.writable&&(Fl[up]=_p.value,_p={configurable:"configurable"in _p?_p.configurable:Tp.configurable,enumerable:"enumerable"in _p?_p.enumerable:Tp.enumerable,writable:!1})}return Nl(Fl,up,_p)}:Nl:function(Fl,up,_p){if(yl(Fl),up=Ol(up),yl(_p),xa)try{return Nl(Fl,up,_p)}catch{}if("get"in _p||"set"in _p)throw Al("Accessors not supported");return"value"in _p&&(Fl[up]=_p.value),Fl}},9677:(_o,_a,_r)=>{var ba=_r(5746),xa=_r(8834),El=_r(6760),yl=_r(1887),Ol=_r(4529),Al=_r(3894),Nl=_r(953),Ml=_r(2840),Fl=Object.getOwnPropertyDescriptor;_a.f=ba?Fl:function(up,_p){if(up=Ol(up),_p=Al(_p),Ml)try{return Fl(up,_p)}catch{}if(Nl(up,_p))return yl(!xa(El.f,up,_p),up[_p])}},946:(_o,_a,_r)=>{var ba=_r(5629),xa=_r(6759).concat("length","prototype");_a.f=Object.getOwnPropertyNames||function(El){return ba(El,xa)}},7857:(_o,_a)=>{_a.f=Object.getOwnPropertySymbols},249:(_o,_a,_r)=>{var ba=_r(953),xa=_r(7475),El=_r(9678),yl=_r(4262),Ol=_r(4160),Al=yl("IE_PROTO"),Nl=Object,Ml=Nl.prototype;_o.exports=Ol?Nl.getPrototypeOf:function(Fl){var up=El(Fl);if(ba(up,Al))return up[Al];var _p=up.constructor;return xa(_p)&&up instanceof _p?_p.prototype:up instanceof Nl?Ml:null}},7046:(_o,_a,_r)=>{var ba=_r(5329);_o.exports=ba({}.isPrototypeOf)},5629:(_o,_a,_r)=>{var ba=_r(5329),xa=_r(953),El=_r(4529),yl=_r(1692).indexOf,Ol=_r(7748),Al=ba([].push);_o.exports=function(Nl,Ml){var Fl,up=El(Nl),_p=0,Tp=[];for(Fl in up)!xa(Ol,Fl)&&xa(up,Fl)&&Al(Tp,Fl);for(;Ml.length>_p;)xa(up,Fl=Ml[_p++])&&(~yl(Tp,Fl)||Al(Tp,Fl));return Tp}},4771:(_o,_a,_r)=>{var ba=_r(5629),xa=_r(6759);_o.exports=Object.keys||function(El){return ba(El,xa)}},6760:(_o,_a)=>{var _r={}.propertyIsEnumerable,ba=Object.getOwnPropertyDescriptor,xa=ba&&!_r.call({1:2},1);_a.f=xa?function(El){var yl=ba(this,El);return!!yl&&yl.enumerable}:_r},8929:(_o,_a,_r)=>{var ba=_r(5329),xa=_r(6059),El=_r(1851);_o.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var yl,Ol=!1,Al={};try{(yl=ba(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(Al,[]),Ol=Al instanceof Array}catch{}return function(Nl,Ml){return xa(Nl),El(Ml),Ol?yl(Nl,Ml):Nl.__proto__=Ml,Nl}}():void 0)},5623:(_o,_a,_r)=>{var ba=_r(2885),xa=_r(9697);_o.exports=ba?{}.toString:function(){return"[object "+xa(this)+"]"}},9811:(_o,_a,_r)=>{var ba=_r(8834),xa=_r(7475),El=_r(941),yl=TypeError;_o.exports=function(Ol,Al){var Nl,Ml;if(Al==="string"&&xa(Nl=Ol.toString)&&!El(Ml=ba(Nl,Ol))||xa(Nl=Ol.valueOf)&&!El(Ml=ba(Nl,Ol))||Al!=="string"&&xa(Nl=Ol.toString)&&!El(Ml=ba(Nl,Ol)))return Ml;throw yl("Can't convert object to primitive value")}},1136:(_o,_a,_r)=>{var ba=_r(626),xa=_r(5329),El=_r(946),yl=_r(7857),Ol=_r(6059),Al=xa([].concat);_o.exports=ba("Reflect","ownKeys")||function(Nl){var Ml=El.f(Ol(Nl)),Fl=yl.f;return Fl?Al(Ml,Fl(Nl)):Ml}},4058:_o=>{_o.exports={}},2:_o=>{_o.exports=function(_a){try{return{error:!1,value:_a()}}catch(_r){return{error:!0,value:_r}}}},7742:(_o,_a,_r)=>{var ba=_r(1899),xa=_r(6991),El=_r(7475),yl=_r(7252),Ol=_r(1302),Al=_r(9813),Nl=_r(3321),Ml=_r(8501),Fl=_r(2529),up=_r(3385),_p=xa&&xa.prototype,Tp=Al("species"),Fp=!1,Ap=El(ba.PromiseRejectionEvent),Xp=yl("Promise",function(){var _g=Ol(xa),Yp=_g!==String(xa);if(!Yp&&up===66||Fl&&(!_p.catch||!_p.finally))return!0;if(!up||up<51||!/native code/.test(_g)){var h0=new xa(function(A0){A0(1)}),E0=function(A0){A0(function(){},function(){})};if((h0.constructor={})[Tp]=E0,!(Fp=h0.then(function(){})instanceof E0))return!0}return!Yp&&(Nl||Ml)&&!Ap});_o.exports={CONSTRUCTOR:Xp,REJECTION_EVENT:Ap,SUBCLASSING:Fp}},6991:(_o,_a,_r)=>{var ba=_r(1899);_o.exports=ba.Promise},6584:(_o,_a,_r)=>{var ba=_r(6059),xa=_r(941),El=_r(9520);_o.exports=function(yl,Ol){if(ba(yl),xa(Ol)&&Ol.constructor===yl)return Ol;var Al=El.f(yl);return(0,Al.resolve)(Ol),Al.promise}},1542:(_o,_a,_r)=>{var ba=_r(6991),xa=_r(1385),El=_r(7742).CONSTRUCTOR;_o.exports=El||!xa(function(yl){ba.all(yl).then(void 0,function(){})})},8397:_o=>{var _a=function(){this.head=null,this.tail=null};_a.prototype={add:function(_r){var ba={item:_r,next:null};this.head?this.tail.next=ba:this.head=ba,this.tail=ba},get:function(){var _r=this.head;if(_r)return this.head=_r.next,this.tail===_r&&(this.tail=null),_r.item}},_o.exports=_a},8219:(_o,_a,_r)=>{var ba=_r(2119),xa=TypeError;_o.exports=function(El){if(ba(El))throw xa("Can't call method on "+El);return El}},4431:(_o,_a,_r)=>{var ba=_r(626),xa=_r(5988),El=_r(9813),yl=_r(5746),Ol=El("species");_o.exports=function(Al){var Nl=ba(Al),Ml=xa.f;yl&&Nl&&!Nl[Ol]&&Ml(Nl,Ol,{configurable:!0,get:function(){return this}})}},904:(_o,_a,_r)=>{var ba=_r(2885),xa=_r(5988).f,El=_r(2029),yl=_r(953),Ol=_r(5623),Al=_r(9813)("toStringTag");_o.exports=function(Nl,Ml,Fl,up){if(Nl){var _p=Fl?Nl:Nl.prototype;yl(_p,Al)||xa(_p,Al,{configurable:!0,value:Ml}),up&&!ba&&El(_p,"toString",Ol)}}},4262:(_o,_a,_r)=>{var ba=_r(8726),xa=_r(9418),El=ba("keys");_o.exports=function(yl){return El[yl]||(El[yl]=xa(yl))}},3030:(_o,_a,_r)=>{var ba=_r(1899),xa=_r(5609),El="__core-js_shared__",yl=ba[El]||xa(El,{});_o.exports=yl},8726:(_o,_a,_r)=>{var ba=_r(2529),xa=_r(3030);(_o.exports=function(El,yl){return xa[El]||(xa[El]=yl!==void 0?yl:{})})("versions",[]).push({version:"3.26.0",mode:ba?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.0/LICENSE",source:"https://github.com/zloirock/core-js"})},487:(_o,_a,_r)=>{var ba=_r(6059),xa=_r(174),El=_r(2119),yl=_r(9813)("species");_o.exports=function(Ol,Al){var Nl,Ml=ba(Ol).constructor;return Ml===void 0||El(Nl=ba(Ml)[yl])?Al:xa(Nl)}},4620:(_o,_a,_r)=>{var ba=_r(5329),xa=_r(2435),El=_r(5803),yl=_r(8219),Ol=ba("".charAt),Al=ba("".charCodeAt),Nl=ba("".slice),Ml=function(Fl){return function(up,_p){var Tp,Fp,Ap=El(yl(up)),Xp=xa(_p),_g=Ap.length;return Xp<0||Xp>=_g?Fl?"":void 0:(Tp=Al(Ap,Xp))<55296||Tp>56319||Xp+1===_g||(Fp=Al(Ap,Xp+1))<56320||Fp>57343?Fl?Ol(Ap,Xp):Tp:Fl?Nl(Ap,Xp,Xp+2):Fp-56320+(Tp-55296<<10)+65536}};_o.exports={codeAt:Ml(!1),charAt:Ml(!0)}},3405:(_o,_a,_r)=>{var ba=_r(3385),xa=_r(5981);_o.exports=!!Object.getOwnPropertySymbols&&!xa(function(){var El=Symbol();return!String(El)||!(Object(El)instanceof Symbol)||!Symbol.sham&&ba&&ba<41})},2941:(_o,_a,_r)=>{var ba,xa,El,yl,Ol=_r(1899),Al=_r(9730),Nl=_r(6843),Ml=_r(7475),Fl=_r(953),up=_r(5981),_p=_r(5463),Tp=_r(3765),Fp=_r(1333),Ap=_r(8348),Xp=_r(2749),_g=_r(6049),Yp=Ol.setImmediate,h0=Ol.clearImmediate,E0=Ol.process,A0=Ol.Dispatch,_E=Ol.Function,Rp=Ol.MessageChannel,Lp=Ol.String,Ep=0,Ip={};try{ba=Ol.location}catch{}var Vp=function(Il){if(Fl(Ip,Il)){var Gl=Ip[Il];delete Ip[Il],Gl()}},_v=function(Il){return function(){Vp(Il)}},f0=function(Il){Vp(Il.data)},zp=function(Il){Ol.postMessage(Lp(Il),ba.protocol+"//"+ba.host)};Yp&&h0||(Yp=function(Il){Ap(arguments.length,1);var Gl=Ml(Il)?Il:_E(Il),_h=Tp(arguments,1);return Ip[++Ep]=function(){Al(Gl,void 0,_h)},xa(Ep),Ep},h0=function(Il){delete Ip[Il]},_g?xa=function(Il){E0.nextTick(_v(Il))}:A0&&A0.now?xa=function(Il){A0.now(_v(Il))}:Rp&&!Xp?(yl=(El=new Rp).port2,El.port1.onmessage=f0,xa=Nl(yl.postMessage,yl)):Ol.addEventListener&&Ml(Ol.postMessage)&&!Ol.importScripts&&ba&&ba.protocol!=="file:"&&!up(zp)?(xa=zp,Ol.addEventListener("message",f0,!1)):xa="onreadystatechange"in Fp("script")?function(Il){_p.appendChild(Fp("script")).onreadystatechange=function(){_p.removeChild(this),Vp(Il)}}:function(Il){setTimeout(_v(Il),0)}),_o.exports={set:Yp,clear:h0}},9413:(_o,_a,_r)=>{var ba=_r(2435),xa=Math.max,El=Math.min;_o.exports=function(yl,Ol){var Al=ba(yl);return Al<0?xa(Al+Ol,0):El(Al,Ol)}},4529:(_o,_a,_r)=>{var ba=_r(7026),xa=_r(8219);_o.exports=function(El){return ba(xa(El))}},2435:(_o,_a,_r)=>{var ba=_r(5331);_o.exports=function(xa){var El=+xa;return El!=El||El===0?0:ba(El)}},3057:(_o,_a,_r)=>{var ba=_r(2435),xa=Math.min;_o.exports=function(El){return El>0?xa(ba(El),9007199254740991):0}},9678:(_o,_a,_r)=>{var ba=_r(8219),xa=Object;_o.exports=function(El){return xa(ba(El))}},6935:(_o,_a,_r)=>{var ba=_r(8834),xa=_r(941),El=_r(6664),yl=_r(4229),Ol=_r(9811),Al=_r(9813),Nl=TypeError,Ml=Al("toPrimitive");_o.exports=function(Fl,up){if(!xa(Fl)||El(Fl))return Fl;var _p,Tp=yl(Fl,Ml);if(Tp){if(up===void 0&&(up="default"),_p=ba(Tp,Fl,up),!xa(_p)||El(_p))return _p;throw Nl("Can't convert object to primitive value")}return up===void 0&&(up="number"),Ol(Fl,up)}},3894:(_o,_a,_r)=>{var ba=_r(6935),xa=_r(6664);_o.exports=function(El){var yl=ba(El,"string");return xa(yl)?yl:yl+""}},2885:(_o,_a,_r)=>{var ba={};ba[_r(9813)("toStringTag")]="z",_o.exports=String(ba)==="[object z]"},5803:(_o,_a,_r)=>{var ba=_r(9697),xa=String;_o.exports=function(El){if(ba(El)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return xa(El)}},9826:_o=>{var _a=String;_o.exports=function(_r){try{return _a(_r)}catch{return"Object"}}},9418:(_o,_a,_r)=>{var ba=_r(5329),xa=0,El=Math.random(),yl=ba(1 .toString);_o.exports=function(Ol){return"Symbol("+(Ol===void 0?"":Ol)+")_"+yl(++xa+El,36)}},2302:(_o,_a,_r)=>{var ba=_r(3405);_o.exports=ba&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3937:(_o,_a,_r)=>{var ba=_r(5746),xa=_r(5981);_o.exports=ba&&xa(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},8348:_o=>{var _a=TypeError;_o.exports=function(_r,ba){if(_r<ba)throw _a("Not enough arguments");return _r}},7093:(_o,_a,_r)=>{var ba=_r(1899),xa=_r(7475),El=ba.WeakMap;_o.exports=xa(El)&&/native code/.test(String(El))},9813:(_o,_a,_r)=>{var ba=_r(1899),xa=_r(8726),El=_r(953),yl=_r(9418),Ol=_r(3405),Al=_r(2302),Nl=xa("wks"),Ml=ba.Symbol,Fl=Ml&&Ml.for,up=Al?Ml:Ml&&Ml.withoutSetter||yl;_o.exports=function(_p){if(!El(Nl,_p)||!Ol&&typeof Nl[_p]!="string"){var Tp="Symbol."+_p;Ol&&El(Ml,_p)?Nl[_p]=Ml[_p]:Nl[_p]=Al&&Fl?Fl(Tp):up(Tp)}return Nl[_p]}},9812:(_o,_a,_r)=>{var ba=_r(6887),xa=_r(7046),El=_r(249),yl=_r(8929),Ol=_r(3489),Al=_r(9290),Nl=_r(2029),Ml=_r(1887),Fl=_r(3995),up=_r(3794),_p=_r(3091),Tp=_r(4649),Fp=_r(9813),Ap=_r(8780),Xp=Fp("toStringTag"),_g=Error,Yp=[].push,h0=function(A0,_E){var Rp,Lp=arguments.length>2?arguments[2]:void 0,Ep=xa(E0,this);yl?Rp=yl(_g(),Ep?El(this):E0):(Rp=Ep?this:Al(E0),Nl(Rp,Xp,"Error")),_E!==void 0&&Nl(Rp,"message",Tp(_E)),Ap&&Nl(Rp,"stack",Fl(Rp.stack,1)),up(Rp,Lp);var Ip=[];return _p(A0,Yp,{that:Ip}),Nl(Rp,"errors",Ip),Rp};yl?yl(h0,_g):Ol(h0,_g,{name:!0});var E0=h0.prototype=Al(_g.prototype,{constructor:Ml(1,h0),message:Ml(1,""),name:Ml(1,"AggregateError")});ba({global:!0,constructor:!0,arity:2},{AggregateError:h0})},7627:(_o,_a,_r)=>{_r(9812)},6274:(_o,_a,_r)=>{var ba=_r(4529),xa=_r(8479),El=_r(2077),yl=_r(5402),Ol=_r(5988).f,Al=_r(5105),Nl=_r(3538),Ml=_r(2529),Fl=_r(5746),up="Array Iterator",_p=yl.set,Tp=yl.getterFor(up);_o.exports=Al(Array,"Array",function(Ap,Xp){_p(this,{type:up,target:ba(Ap),index:0,kind:Xp})},function(){var Ap=Tp(this),Xp=Ap.target,_g=Ap.kind,Yp=Ap.index++;return!Xp||Yp>=Xp.length?(Ap.target=void 0,Nl(void 0,!0)):Nl(_g=="keys"?Yp:_g=="values"?Xp[Yp]:[Yp,Xp[Yp]],!1)},"values");var Fp=El.Arguments=El.Array;if(xa("keys"),xa("values"),xa("entries"),!Ml&&Fl&&Fp.name!=="values")try{Ol(Fp,"name",{value:"values"})}catch{}},6450:(_o,_a,_r)=>{var ba=_r(6887),xa=_r(5746),El=_r(5988).f;ba({target:"Object",stat:!0,forced:Object.defineProperty!==El,sham:!xa},{defineProperty:El})},5967:()=>{},4560:(_o,_a,_r)=>{var ba=_r(6887),xa=_r(8834),El=_r(4883),yl=_r(9520),Ol=_r(2),Al=_r(3091);ba({target:"Promise",stat:!0},{allSettled:function(Nl){var Ml=this,Fl=yl.f(Ml),up=Fl.resolve,_p=Fl.reject,Tp=Ol(function(){var Fp=El(Ml.resolve),Ap=[],Xp=0,_g=1;Al(Nl,function(Yp){var h0=Xp++,E0=!1;_g++,xa(Fp,Ml,Yp).then(function(A0){E0||(E0=!0,Ap[h0]={status:"fulfilled",value:A0},--_g||up(Ap))},function(A0){E0||(E0=!0,Ap[h0]={status:"rejected",reason:A0},--_g||up(Ap))})}),--_g||up(Ap)});return Tp.error&&_p(Tp.value),Fl.promise}})},6890:(_o,_a,_r)=>{var ba=_r(6887),xa=_r(8834),El=_r(4883),yl=_r(9520),Ol=_r(2),Al=_r(3091);ba({target:"Promise",stat:!0,forced:_r(1542)},{all:function(Nl){var Ml=this,Fl=yl.f(Ml),up=Fl.resolve,_p=Fl.reject,Tp=Ol(function(){var Fp=El(Ml.resolve),Ap=[],Xp=0,_g=1;Al(Nl,function(Yp){var h0=Xp++,E0=!1;_g++,xa(Fp,Ml,Yp).then(function(A0){E0||(E0=!0,Ap[h0]=A0,--_g||up(Ap))},_p)}),--_g||up(Ap)});return Tp.error&&_p(Tp.value),Fl.promise}})},7206:(_o,_a,_r)=>{var ba=_r(6887),xa=_r(8834),El=_r(4883),yl=_r(626),Ol=_r(9520),Al=_r(2),Nl=_r(3091),Ml="No one promise resolved";ba({target:"Promise",stat:!0},{any:function(Fl){var up=this,_p=yl("AggregateError"),Tp=Ol.f(up),Fp=Tp.resolve,Ap=Tp.reject,Xp=Al(function(){var _g=El(up.resolve),Yp=[],h0=0,E0=1,A0=!1;Nl(Fl,function(_E){var Rp=h0++,Lp=!1;E0++,xa(_g,up,_E).then(function(Ep){Lp||A0||(A0=!0,Fp(Ep))},function(Ep){Lp||A0||(Lp=!0,Yp[Rp]=Ep,--E0||Ap(new _p(Yp,Ml)))})}),--E0||Ap(new _p(Yp,Ml))});return Xp.error&&Ap(Xp.value),Tp.promise}})},3376:(_o,_a,_r)=>{var ba=_r(6887),xa=_r(2529),El=_r(7742).CONSTRUCTOR,yl=_r(6991),Ol=_r(626),Al=_r(7475),Nl=_r(5929),Ml=yl&&yl.prototype;if(ba({target:"Promise",proto:!0,forced:El,real:!0},{catch:function(up){return this.then(void 0,up)}}),!xa&&Al(yl)){var Fl=Ol("Promise").prototype.catch;Ml.catch!==Fl&&Nl(Ml,"catch",Fl,{unsafe:!0})}},6934:(_o,_a,_r)=>{var ba,xa,El,yl=_r(6887),Ol=_r(2529),Al=_r(6049),Nl=_r(1899),Ml=_r(8834),Fl=_r(5929),up=_r(8929),_p=_r(904),Tp=_r(4431),Fp=_r(4883),Ap=_r(7475),Xp=_r(941),_g=_r(5743),Yp=_r(487),h0=_r(2941).set,E0=_r(6132),A0=_r(4845),_E=_r(2),Rp=_r(8397),Lp=_r(5402),Ep=_r(6991),Ip=_r(7742),Vp=_r(9520),_v="Promise",f0=Ip.CONSTRUCTOR,zp=Ip.REJECTION_EVENT,Il=Ip.SUBCLASSING,Gl=Lp.getterFor(_v),_h=Lp.set,Pp=Ep&&Ep.prototype,m0=Ep,Q0=Pp,h_=Nl.TypeError,e_=Nl.document,$_=Nl.process,q0=Vp.f,E_=q0,X0=!!(e_&&e_.createEvent&&Nl.dispatchEvent),Q1="unhandledrejection",$0=function(R0){var c_;return!(!Xp(R0)||!Ap(c_=R0.then))&&c_},v_=function(R0,c_){var T_,j_,rS,d3=c_.value,gZ=c_.state==1,q9=gZ?R0.ok:R0.fail,mZ=R0.resolve,lU=R0.reject,fN=R0.domain;try{q9?(gZ||(c_.rejection===2&&uU(c_),c_.rejection=1),q9===!0?T_=d3:(fN&&fN.enter(),T_=q9(d3),fN&&(fN.exit(),rS=!0)),T_===R0.promise?lU(h_("Promise-chain cycle")):(j_=$0(T_))?Ml(j_,T_,mZ,lU):mZ(T_)):lU(d3)}catch(Vat){fN&&!rS&&fN.exit(),lU(Vat)}},nS=function(R0,c_){R0.notified||(R0.notified=!0,E0(function(){for(var T_,j_=R0.reactions;T_=j_.get();)v_(T_,R0);R0.notified=!1,c_&&!R0.rejection&&dN(R0)}))},k1=function(R0,c_,T_){var j_,rS;X0?((j_=e_.createEvent("Event")).promise=c_,j_.reason=T_,j_.initEvent(R0,!1,!0),Nl.dispatchEvent(j_)):j_={promise:c_,reason:T_},!zp&&(rS=Nl["on"+R0])?rS(j_):R0===Q1&&A0("Unhandled promise rejection",T_)},dN=function(R0){Ml(h0,Nl,function(){var c_,T_=R0.facade,j_=R0.value;if(l3(R0)&&(c_=_E(function(){Al?$_.emit("unhandledRejection",j_,T_):k1(Q1,T_,j_)}),R0.rejection=Al||l3(R0)?2:1,c_.error))throw c_.value})},l3=function(R0){return R0.rejection!==1&&!R0.parent},uU=function(R0){Ml(h0,Nl,function(){var c_=R0.facade;Al?$_.emit("rejectionHandled",c_):k1("rejectionhandled",c_,R0.value)})},hN=function(R0,c_,T_){return function(j_){R0(c_,j_,T_)}},pN=function(R0,c_,T_){R0.done||(R0.done=!0,T_&&(R0=T_),R0.value=c_,R0.state=2,nS(R0,!0))},G9=function(R0,c_,T_){if(!R0.done){R0.done=!0,T_&&(R0=T_);try{if(R0.facade===c_)throw h_("Promise can't be resolved itself");var j_=$0(c_);j_?E0(function(){var rS={done:!1};try{Ml(j_,c_,hN(G9,rS,R0),hN(pN,rS,R0))}catch(d3){pN(rS,d3,R0)}}):(R0.value=c_,R0.state=1,nS(R0,!1))}catch(rS){pN({done:!1},rS,R0)}}};if(f0&&(Q0=(m0=function(R0){_g(this,Q0),Fp(R0),Ml(ba,this);var c_=Gl(this);try{R0(hN(G9,c_),hN(pN,c_))}catch(T_){pN(c_,T_)}}).prototype,(ba=function(R0){_h(this,{type:_v,done:!1,notified:!1,parent:!1,reactions:new Rp,rejection:!1,state:0,value:void 0})}).prototype=Fl(Q0,"then",function(R0,c_){var T_=Gl(this),j_=q0(Yp(this,m0));return T_.parent=!0,j_.ok=!Ap(R0)||R0,j_.fail=Ap(c_)&&c_,j_.domain=Al?$_.domain:void 0,T_.state==0?T_.reactions.add(j_):E0(function(){v_(j_,T_)}),j_.promise}),xa=function(){var R0=new ba,c_=Gl(R0);this.promise=R0,this.resolve=hN(G9,c_),this.reject=hN(pN,c_)},Vp.f=q0=function(R0){return R0===m0||R0===void 0?new xa(R0):E_(R0)},!Ol&&Ap(Ep)&&Pp!==Object.prototype)){El=Pp.then,Il||Fl(Pp,"then",function(R0,c_){var T_=this;return new m0(function(j_,rS){Ml(El,T_,j_,rS)}).then(R0,c_)},{unsafe:!0});try{delete Pp.constructor}catch{}up&&up(Pp,Q0)}yl({global:!0,constructor:!0,wrap:!0,forced:f0},{Promise:m0}),_p(m0,_v,!1,!0),Tp(_v)},4349:(_o,_a,_r)=>{var ba=_r(6887),xa=_r(2529),El=_r(6991),yl=_r(5981),Ol=_r(626),Al=_r(7475),Nl=_r(487),Ml=_r(6584),Fl=_r(5929),up=El&&El.prototype;if(ba({target:"Promise",proto:!0,real:!0,forced:!!El&&yl(function(){up.finally.call({then:function(){}},function(){})})},{finally:function(Tp){var Fp=Nl(this,Ol("Promise")),Ap=Al(Tp);return this.then(Ap?function(Xp){return Ml(Fp,Tp()).then(function(){return Xp})}:Tp,Ap?function(Xp){return Ml(Fp,Tp()).then(function(){throw Xp})}:Tp)}}),!xa&&Al(El)){var _p=Ol("Promise").prototype.finally;up.finally!==_p&&Fl(up,"finally",_p,{unsafe:!0})}},8881:(_o,_a,_r)=>{_r(6934),_r(6890),_r(3376),_r(5921),_r(4069),_r(4482)},5921:(_o,_a,_r)=>{var ba=_r(6887),xa=_r(8834),El=_r(4883),yl=_r(9520),Ol=_r(2),Al=_r(3091);ba({target:"Promise",stat:!0,forced:_r(1542)},{race:function(Nl){var Ml=this,Fl=yl.f(Ml),up=Fl.reject,_p=Ol(function(){var Tp=El(Ml.resolve);Al(Nl,function(Fp){xa(Tp,Ml,Fp).then(Fl.resolve,up)})});return _p.error&&up(_p.value),Fl.promise}})},4069:(_o,_a,_r)=>{var ba=_r(6887),xa=_r(8834),El=_r(9520);ba({target:"Promise",stat:!0,forced:_r(7742).CONSTRUCTOR},{reject:function(yl){var Ol=El.f(this);return xa(Ol.reject,void 0,yl),Ol.promise}})},4482:(_o,_a,_r)=>{var ba=_r(6887),xa=_r(626),El=_r(2529),yl=_r(6991),Ol=_r(7742).CONSTRUCTOR,Al=_r(6584),Nl=xa("Promise"),Ml=El&&!Ol;ba({target:"Promise",stat:!0,forced:El||Ol},{resolve:function(Fl){return Al(Ml&&this===Nl?yl:this,Fl)}})},7971:(_o,_a,_r)=>{var ba=_r(4620).charAt,xa=_r(5803),El=_r(5402),yl=_r(5105),Ol=_r(3538),Al="String Iterator",Nl=El.set,Ml=El.getterFor(Al);yl(String,"String",function(Fl){Nl(this,{type:Al,string:xa(Fl),index:0})},function(){var Fl,up=Ml(this),_p=up.string,Tp=up.index;return Tp>=_p.length?Ol(void 0,!0):(Fl=ba(_p,Tp),up.index+=Fl.length,Ol(Fl,!1))})},7634:(_o,_a,_r)=>{_r(6274);var ba=_r(3281),xa=_r(1899),El=_r(9697),yl=_r(2029),Ol=_r(2077),Al=_r(9813)("toStringTag");for(var Nl in ba){var Ml=xa[Nl],Fl=Ml&&Ml.prototype;Fl&&El(Fl)!==Al&&yl(Fl,Al,Nl),Ol[Nl]=Ol.Array}},1910:(_o,_a,_r)=>{var ba=_r(8171);_o.exports=ba},7460:(_o,_a,_r)=>{var ba=_r(2956);_r(7634),_o.exports=ba},9662:(_o,_a,_r)=>{var ba=_r(614),xa=_r(6330),El=TypeError;_o.exports=function(yl){if(ba(yl))return yl;throw El(xa(yl)+" is not a function")}},6077:(_o,_a,_r)=>{var ba=_r(614),xa=String,El=TypeError;_o.exports=function(yl){if(typeof yl=="object"||ba(yl))return yl;throw El("Can't set "+xa(yl)+" as a prototype")}},1223:(_o,_a,_r)=>{var ba=_r(5112),xa=_r(30),El=_r(3070).f,yl=ba("unscopables"),Ol=Array.prototype;Ol[yl]==null&&El(Ol,yl,{configurable:!0,value:xa(null)}),_o.exports=function(Al){Ol[yl][Al]=!0}},9670:(_o,_a,_r)=>{var ba=_r(111),xa=String,El=TypeError;_o.exports=function(yl){if(ba(yl))return yl;throw El(xa(yl)+" is not an object")}},1318:(_o,_a,_r)=>{var ba=_r(5656),xa=_r(1400),El=_r(6244),yl=function(Ol){return function(Al,Nl,Ml){var Fl,up=ba(Al),_p=El(up),Tp=xa(Ml,_p);if(Ol&&Nl!=Nl){for(;_p>Tp;)if((Fl=up[Tp++])!=Fl)return!0}else for(;_p>Tp;Tp++)if((Ol||Tp in up)&&up[Tp]===Nl)return Ol||Tp||0;return!Ol&&-1}};_o.exports={includes:yl(!0),indexOf:yl(!1)}},4326:(_o,_a,_r)=>{var ba=_r(84),xa=ba({}.toString),El=ba("".slice);_o.exports=function(yl){return El(xa(yl),8,-1)}},648:(_o,_a,_r)=>{var ba=_r(1694),xa=_r(614),El=_r(4326),yl=_r(5112)("toStringTag"),Ol=Object,Al=El(function(){return arguments}())=="Arguments";_o.exports=ba?El:function(Nl){var Ml,Fl,up;return Nl===void 0?"Undefined":Nl===null?"Null":typeof(Fl=function(_p,Tp){try{return _p[Tp]}catch{}}(Ml=Ol(Nl),yl))=="string"?Fl:Al?El(Ml):(up=El(Ml))=="Object"&&xa(Ml.callee)?"Arguments":up}},9920:(_o,_a,_r)=>{var ba=_r(2597),xa=_r(3887),El=_r(1236),yl=_r(3070);_o.exports=function(Ol,Al,Nl){for(var Ml=xa(Al),Fl=yl.f,up=El.f,_p=0;_p<Ml.length;_p++){var Tp=Ml[_p];ba(Ol,Tp)||Nl&&ba(Nl,Tp)||Fl(Ol,Tp,up(Al,Tp))}}},8544:(_o,_a,_r)=>{var ba=_r(7293);_o.exports=!ba(function(){function xa(){}return xa.prototype.constructor=null,Object.getPrototypeOf(new xa)!==xa.prototype})},6178:_o=>{_o.exports=function(_a,_r){return{value:_a,done:_r}}},8880:(_o,_a,_r)=>{var ba=_r(9781),xa=_r(3070),El=_r(9114);_o.exports=ba?function(yl,Ol,Al){return xa.f(yl,Ol,El(1,Al))}:function(yl,Ol,Al){return yl[Ol]=Al,yl}},9114:_o=>{_o.exports=function(_a,_r){return{enumerable:!(1&_a),configurable:!(2&_a),writable:!(4&_a),value:_r}}},8052:(_o,_a,_r)=>{var ba=_r(614),xa=_r(3070),El=_r(6339),yl=_r(3072);_o.exports=function(Ol,Al,Nl,Ml){Ml||(Ml={});var Fl=Ml.enumerable,up=Ml.name!==void 0?Ml.name:Al;if(ba(Nl)&&El(Nl,up,Ml),Ml.global)Fl?Ol[Al]=Nl:yl(Al,Nl);else{try{Ml.unsafe?Ol[Al]&&(Fl=!0):delete Ol[Al]}catch{}Fl?Ol[Al]=Nl:xa.f(Ol,Al,{value:Nl,enumerable:!1,configurable:!Ml.nonConfigurable,writable:!Ml.nonWritable})}return Ol}},3072:(_o,_a,_r)=>{var ba=_r(7854),xa=Object.defineProperty;_o.exports=function(El,yl){try{xa(ba,El,{value:yl,configurable:!0,writable:!0})}catch{ba[El]=yl}return yl}},9781:(_o,_a,_r)=>{var ba=_r(7293);_o.exports=!ba(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},4154:_o=>{var _a=typeof document=="object"&&document.all,_r=_a===void 0&&_a!==void 0;_o.exports={all:_a,IS_HTMLDDA:_r}},317:(_o,_a,_r)=>{var ba=_r(7854),xa=_r(111),El=ba.document,yl=xa(El)&&xa(El.createElement);_o.exports=function(Ol){return yl?El.createElement(Ol):{}}},8324:_o=>{_o.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(_o,_a,_r)=>{var ba=_r(317)("span").classList,xa=ba&&ba.constructor&&ba.constructor.prototype;_o.exports=xa===Object.prototype?void 0:xa},8113:(_o,_a,_r)=>{var ba=_r(5005);_o.exports=ba("navigator","userAgent")||""},7392:(_o,_a,_r)=>{var ba,xa,El=_r(7854),yl=_r(8113),Ol=El.process,Al=El.Deno,Nl=Ol&&Ol.versions||Al&&Al.version,Ml=Nl&&Nl.v8;Ml&&(xa=(ba=Ml.split("."))[0]>0&&ba[0]<4?1:+(ba[0]+ba[1])),!xa&&yl&&(!(ba=yl.match(/Edge\/(\d+)/))||ba[1]>=74)&&(ba=yl.match(/Chrome\/(\d+)/))&&(xa=+ba[1]),_o.exports=xa},748:_o=>{_o.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},1060:(_o,_a,_r)=>{var ba=_r(1702),xa=Error,El=ba("".replace),yl=String(xa("zxcasd").stack),Ol=/\n\s*at [^:]*:[^\n]*/,Al=Ol.test(yl);_o.exports=function(Nl,Ml){if(Al&&typeof Nl=="string"&&!xa.prepareStackTrace)for(;Ml--;)Nl=El(Nl,Ol,"");return Nl}},2914:(_o,_a,_r)=>{var ba=_r(7293),xa=_r(9114);_o.exports=!ba(function(){var El=Error("a");return!("stack"in El)||(Object.defineProperty(El,"stack",xa(1,7)),El.stack!==7)})},2109:(_o,_a,_r)=>{var ba=_r(7854),xa=_r(1236).f,El=_r(8880),yl=_r(8052),Ol=_r(3072),Al=_r(9920),Nl=_r(4705);_o.exports=function(Ml,Fl){var up,_p,Tp,Fp,Ap,Xp=Ml.target,_g=Ml.global,Yp=Ml.stat;if(up=_g?ba:Yp?ba[Xp]||Ol(Xp,{}):(ba[Xp]||{}).prototype)for(_p in Fl){if(Fp=Fl[_p],Tp=Ml.dontCallGetSet?(Ap=xa(up,_p))&&Ap.value:up[_p],!Nl(_g?_p:Xp+(Yp?".":"#")+_p,Ml.forced)&&Tp!==void 0){if(typeof Fp==typeof Tp)continue;Al(Fp,Tp)}(Ml.sham||Tp&&Tp.sham)&&El(Fp,"sham",!0),yl(up,_p,Fp,Ml)}}},7293:_o=>{_o.exports=function(_a){try{return!!_a()}catch{return!0}}},2104:(_o,_a,_r)=>{var ba=_r(4374),xa=Function.prototype,El=xa.apply,yl=xa.call;_o.exports=typeof Reflect=="object"&&Reflect.apply||(ba?yl.bind(El):function(){return yl.apply(El,arguments)})},4374:(_o,_a,_r)=>{var ba=_r(7293);_o.exports=!ba(function(){var xa=function(){}.bind();return typeof xa!="function"||xa.hasOwnProperty("prototype")})},6916:(_o,_a,_r)=>{var ba=_r(4374),xa=Function.prototype.call;_o.exports=ba?xa.bind(xa):function(){return xa.apply(xa,arguments)}},6530:(_o,_a,_r)=>{var ba=_r(9781),xa=_r(2597),El=Function.prototype,yl=ba&&Object.getOwnPropertyDescriptor,Ol=xa(El,"name"),Al=Ol&&function(){}.name==="something",Nl=Ol&&(!ba||ba&&yl(El,"name").configurable);_o.exports={EXISTS:Ol,PROPER:Al,CONFIGURABLE:Nl}},84:(_o,_a,_r)=>{var ba=_r(4374),xa=Function.prototype,El=xa.call,yl=ba&&xa.bind.bind(El,El);_o.exports=ba?yl:function(Ol){return function(){return El.apply(Ol,arguments)}}},1702:(_o,_a,_r)=>{var ba=_r(4326),xa=_r(84);_o.exports=function(El){if(ba(El)==="Function")return xa(El)}},5005:(_o,_a,_r)=>{var ba=_r(7854),xa=_r(614),El=function(yl){return xa(yl)?yl:void 0};_o.exports=function(yl,Ol){return arguments.length<2?El(ba[yl]):ba[yl]&&ba[yl][Ol]}},8173:(_o,_a,_r)=>{var ba=_r(9662),xa=_r(8554);_o.exports=function(El,yl){var Ol=El[yl];return xa(Ol)?void 0:ba(Ol)}},7854:(_o,_a,_r)=>{var ba=function(xa){return xa&&xa.Math==Math&&xa};_o.exports=ba(typeof globalThis=="object"&&globalThis)||ba(typeof window=="object"&&window)||ba(typeof self=="object"&&self)||ba(typeof _r.g=="object"&&_r.g)||function(){return this}()||Function("return this")()},2597:(_o,_a,_r)=>{var ba=_r(1702),xa=_r(7908),El=ba({}.hasOwnProperty);_o.exports=Object.hasOwn||function(yl,Ol){return El(xa(yl),Ol)}},3501:_o=>{_o.exports={}},490:(_o,_a,_r)=>{var ba=_r(5005);_o.exports=ba("document","documentElement")},4664:(_o,_a,_r)=>{var ba=_r(9781),xa=_r(7293),El=_r(317);_o.exports=!ba&&!xa(function(){return Object.defineProperty(El("div"),"a",{get:function(){return 7}}).a!=7})},8361:(_o,_a,_r)=>{var ba=_r(1702),xa=_r(7293),El=_r(4326),yl=Object,Ol=ba("".split);_o.exports=xa(function(){return!yl("z").propertyIsEnumerable(0)})?function(Al){return El(Al)=="String"?Ol(Al,""):yl(Al)}:yl},9587:(_o,_a,_r)=>{var ba=_r(614),xa=_r(111),El=_r(7674);_o.exports=function(yl,Ol,Al){var Nl,Ml;return El&&ba(Nl=Ol.constructor)&&Nl!==Al&&xa(Ml=Nl.prototype)&&Ml!==Al.prototype&&El(yl,Ml),yl}},2788:(_o,_a,_r)=>{var ba=_r(1702),xa=_r(614),El=_r(5465),yl=ba(Function.toString);xa(El.inspectSource)||(El.inspectSource=function(Ol){return yl(Ol)}),_o.exports=El.inspectSource},8340:(_o,_a,_r)=>{var ba=_r(111),xa=_r(8880);_o.exports=function(El,yl){ba(yl)&&"cause"in yl&&xa(El,"cause",yl.cause)}},9909:(_o,_a,_r)=>{var ba,xa,El,yl=_r(4811),Ol=_r(7854),Al=_r(111),Nl=_r(8880),Ml=_r(2597),Fl=_r(5465),up=_r(6200),_p=_r(3501),Tp="Object already initialized",Fp=Ol.TypeError,Ap=Ol.WeakMap;if(yl||Fl.state){var Xp=Fl.state||(Fl.state=new Ap);Xp.get=Xp.get,Xp.has=Xp.has,Xp.set=Xp.set,ba=function(Yp,h0){if(Xp.has(Yp))throw Fp(Tp);return h0.facade=Yp,Xp.set(Yp,h0),h0},xa=function(Yp){return Xp.get(Yp)||{}},El=function(Yp){return Xp.has(Yp)}}else{var _g=up("state");_p[_g]=!0,ba=function(Yp,h0){if(Ml(Yp,_g))throw Fp(Tp);return h0.facade=Yp,Nl(Yp,_g,h0),h0},xa=function(Yp){return Ml(Yp,_g)?Yp[_g]:{}},El=function(Yp){return Ml(Yp,_g)}}_o.exports={set:ba,get:xa,has:El,enforce:function(Yp){return El(Yp)?xa(Yp):ba(Yp,{})},getterFor:function(Yp){return function(h0){var E0;if(!Al(h0)||(E0=xa(h0)).type!==Yp)throw Fp("Incompatible receiver, "+Yp+" required");return E0}}}},614:(_o,_a,_r)=>{var ba=_r(4154),xa=ba.all;_o.exports=ba.IS_HTMLDDA?function(El){return typeof El=="function"||El===xa}:function(El){return typeof El=="function"}},4705:(_o,_a,_r)=>{var ba=_r(7293),xa=_r(614),El=/#|\.prototype\./,yl=function(Fl,up){var _p=Al[Ol(Fl)];return _p==Ml||_p!=Nl&&(xa(up)?ba(up):!!up)},Ol=yl.normalize=function(Fl){return String(Fl).replace(El,".").toLowerCase()},Al=yl.data={},Nl=yl.NATIVE="N",Ml=yl.POLYFILL="P";_o.exports=yl},8554:_o=>{_o.exports=function(_a){return _a==null}},111:(_o,_a,_r)=>{var ba=_r(614),xa=_r(4154),El=xa.all;_o.exports=xa.IS_HTMLDDA?function(yl){return typeof yl=="object"?yl!==null:ba(yl)||yl===El}:function(yl){return typeof yl=="object"?yl!==null:ba(yl)}},1913:_o=>{_o.exports=!1},2190:(_o,_a,_r)=>{var ba=_r(5005),xa=_r(614),El=_r(7976),yl=_r(3307),Ol=Object;_o.exports=yl?function(Al){return typeof Al=="symbol"}:function(Al){var Nl=ba("Symbol");return xa(Nl)&&El(Nl.prototype,Ol(Al))}},3061:(_o,_a,_r)=>{var ba=_r(3383).IteratorPrototype,xa=_r(30),El=_r(9114),yl=_r(8003),Ol=_r(7497),Al=function(){return this};_o.exports=function(Nl,Ml,Fl,up){var _p=Ml+" Iterator";return Nl.prototype=xa(ba,{next:El(+!up,Fl)}),yl(Nl,_p,!1,!0),Ol[_p]=Al,Nl}},1656:(_o,_a,_r)=>{var ba=_r(2109),xa=_r(6916),El=_r(1913),yl=_r(6530),Ol=_r(614),Al=_r(3061),Nl=_r(9518),Ml=_r(7674),Fl=_r(8003),up=_r(8880),_p=_r(8052),Tp=_r(5112),Fp=_r(7497),Ap=_r(3383),Xp=yl.PROPER,_g=yl.CONFIGURABLE,Yp=Ap.IteratorPrototype,h0=Ap.BUGGY_SAFARI_ITERATORS,E0=Tp("iterator"),A0="keys",_E="values",Rp="entries",Lp=function(){return this};_o.exports=function(Ep,Ip,Vp,_v,f0,zp,Il){Al(Vp,Ip,_v);var Gl,_h,Pp,m0=function(X0){if(X0===f0&&q0)return q0;if(!h0&&X0 in e_)return e_[X0];switch(X0){case A0:case _E:case Rp:return function(){return new Vp(this,X0)}}return function(){return new Vp(this)}},Q0=Ip+" Iterator",h_=!1,e_=Ep.prototype,$_=e_[E0]||e_["@@iterator"]||f0&&e_[f0],q0=!h0&&$_||m0(f0),E_=Ip=="Array"&&e_.entries||$_;if(E_&&(Gl=Nl(E_.call(new Ep)))!==Object.prototype&&Gl.next&&(El||Nl(Gl)===Yp||(Ml?Ml(Gl,Yp):Ol(Gl[E0])||_p(Gl,E0,Lp)),Fl(Gl,Q0,!0,!0),El&&(Fp[Q0]=Lp)),Xp&&f0==_E&&$_&&$_.name!==_E&&(!El&&_g?up(e_,"name",_E):(h_=!0,q0=function(){return xa($_,this)})),f0)if(_h={values:m0(_E),keys:zp?q0:m0(A0),entries:m0(Rp)},Il)for(Pp in _h)(h0||h_||!(Pp in e_))&&_p(e_,Pp,_h[Pp]);else ba({target:Ip,proto:!0,forced:h0||h_},_h);return El&&!Il||e_[E0]===q0||_p(e_,E0,q0,{name:f0}),Fp[Ip]=q0,_h}},3383:(_o,_a,_r)=>{var ba,xa,El,yl=_r(7293),Ol=_r(614),Al=_r(111),Nl=_r(30),Ml=_r(9518),Fl=_r(8052),up=_r(5112),_p=_r(1913),Tp=up("iterator"),Fp=!1;[].keys&&("next"in(El=[].keys())?(xa=Ml(Ml(El)))!==Object.prototype&&(ba=xa):Fp=!0),!Al(ba)||yl(function(){var Ap={};return ba[Tp].call(Ap)!==Ap})?ba={}:_p&&(ba=Nl(ba)),Ol(ba[Tp])||Fl(ba,Tp,function(){return this}),_o.exports={IteratorPrototype:ba,BUGGY_SAFARI_ITERATORS:Fp}},7497:_o=>{_o.exports={}},6244:(_o,_a,_r)=>{var ba=_r(7466);_o.exports=function(xa){return ba(xa.length)}},6339:(_o,_a,_r)=>{var ba=_r(7293),xa=_r(614),El=_r(2597),yl=_r(9781),Ol=_r(6530).CONFIGURABLE,Al=_r(2788),Nl=_r(9909),Ml=Nl.enforce,Fl=Nl.get,up=Object.defineProperty,_p=yl&&!ba(function(){return up(function(){},"length",{value:8}).length!==8}),Tp=String(String).split("String"),Fp=_o.exports=function(Ap,Xp,_g){String(Xp).slice(0,7)==="Symbol("&&(Xp="["+String(Xp).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),_g&&_g.getter&&(Xp="get "+Xp),_g&&_g.setter&&(Xp="set "+Xp),(!El(Ap,"name")||Ol&&Ap.name!==Xp)&&(yl?up(Ap,"name",{value:Xp,configurable:!0}):Ap.name=Xp),_p&&_g&&El(_g,"arity")&&Ap.length!==_g.arity&&up(Ap,"length",{value:_g.arity});try{_g&&El(_g,"constructor")&&_g.constructor?yl&&up(Ap,"prototype",{writable:!1}):Ap.prototype&&(Ap.prototype=void 0)}catch{}var Yp=Ml(Ap);return El(Yp,"source")||(Yp.source=Tp.join(typeof Xp=="string"?Xp:"")),Ap};Function.prototype.toString=Fp(function(){return xa(this)&&Fl(this).source||Al(this)},"toString")},4758:_o=>{var _a=Math.ceil,_r=Math.floor;_o.exports=Math.trunc||function(ba){var xa=+ba;return(xa>0?_r:_a)(xa)}},6277:(_o,_a,_r)=>{var ba=_r(1340);_o.exports=function(xa,El){return xa===void 0?arguments.length<2?"":El:ba(xa)}},30:(_o,_a,_r)=>{var ba,xa=_r(9670),El=_r(6048),yl=_r(748),Ol=_r(3501),Al=_r(490),Nl=_r(317),Ml=_r(6200)("IE_PROTO"),Fl=function(){},up=function(Fp){return"<script>"+Fp+"<\/script>"},_p=function(Fp){Fp.write(up("")),Fp.close();var Ap=Fp.parentWindow.Object;return Fp=null,Ap},Tp=function(){try{ba=new ActiveXObject("htmlfile")}catch{}var Fp,Ap;Tp=typeof document<"u"?document.domain&&ba?_p(ba):((Ap=Nl("iframe")).style.display="none",Al.appendChild(Ap),Ap.src=String("javascript:"),(Fp=Ap.contentWindow.document).open(),Fp.write(up("document.F=Object")),Fp.close(),Fp.F):_p(ba);for(var Xp=yl.length;Xp--;)delete Tp.prototype[yl[Xp]];return Tp()};Ol[Ml]=!0,_o.exports=Object.create||function(Fp,Ap){var Xp;return Fp!==null?(Fl.prototype=xa(Fp),Xp=new Fl,Fl.prototype=null,Xp[Ml]=Fp):Xp=Tp(),Ap===void 0?Xp:El.f(Xp,Ap)}},6048:(_o,_a,_r)=>{var ba=_r(9781),xa=_r(3353),El=_r(3070),yl=_r(9670),Ol=_r(5656),Al=_r(1956);_a.f=ba&&!xa?Object.defineProperties:function(Nl,Ml){yl(Nl);for(var Fl,up=Ol(Ml),_p=Al(Ml),Tp=_p.length,Fp=0;Tp>Fp;)El.f(Nl,Fl=_p[Fp++],up[Fl]);return Nl}},3070:(_o,_a,_r)=>{var ba=_r(9781),xa=_r(4664),El=_r(3353),yl=_r(9670),Ol=_r(4948),Al=TypeError,Nl=Object.defineProperty,Ml=Object.getOwnPropertyDescriptor;_a.f=ba?El?function(Fl,up,_p){if(yl(Fl),up=Ol(up),yl(_p),typeof Fl=="function"&&up==="prototype"&&"value"in _p&&"writable"in _p&&!_p.writable){var Tp=Ml(Fl,up);Tp&&Tp.writable&&(Fl[up]=_p.value,_p={configurable:"configurable"in _p?_p.configurable:Tp.configurable,enumerable:"enumerable"in _p?_p.enumerable:Tp.enumerable,writable:!1})}return Nl(Fl,up,_p)}:Nl:function(Fl,up,_p){if(yl(Fl),up=Ol(up),yl(_p),xa)try{return Nl(Fl,up,_p)}catch{}if("get"in _p||"set"in _p)throw Al("Accessors not supported");return"value"in _p&&(Fl[up]=_p.value),Fl}},1236:(_o,_a,_r)=>{var ba=_r(9781),xa=_r(6916),El=_r(5296),yl=_r(9114),Ol=_r(5656),Al=_r(4948),Nl=_r(2597),Ml=_r(4664),Fl=Object.getOwnPropertyDescriptor;_a.f=ba?Fl:function(up,_p){if(up=Ol(up),_p=Al(_p),Ml)try{return Fl(up,_p)}catch{}if(Nl(up,_p))return yl(!xa(El.f,up,_p),up[_p])}},8006:(_o,_a,_r)=>{var ba=_r(6324),xa=_r(748).concat("length","prototype");_a.f=Object.getOwnPropertyNames||function(El){return ba(El,xa)}},5181:(_o,_a)=>{_a.f=Object.getOwnPropertySymbols},9518:(_o,_a,_r)=>{var ba=_r(2597),xa=_r(614),El=_r(7908),yl=_r(6200),Ol=_r(8544),Al=yl("IE_PROTO"),Nl=Object,Ml=Nl.prototype;_o.exports=Ol?Nl.getPrototypeOf:function(Fl){var up=El(Fl);if(ba(up,Al))return up[Al];var _p=up.constructor;return xa(_p)&&up instanceof _p?_p.prototype:up instanceof Nl?Ml:null}},7976:(_o,_a,_r)=>{var ba=_r(1702);_o.exports=ba({}.isPrototypeOf)},6324:(_o,_a,_r)=>{var ba=_r(1702),xa=_r(2597),El=_r(5656),yl=_r(1318).indexOf,Ol=_r(3501),Al=ba([].push);_o.exports=function(Nl,Ml){var Fl,up=El(Nl),_p=0,Tp=[];for(Fl in up)!xa(Ol,Fl)&&xa(up,Fl)&&Al(Tp,Fl);for(;Ml.length>_p;)xa(up,Fl=Ml[_p++])&&(~yl(Tp,Fl)||Al(Tp,Fl));return Tp}},1956:(_o,_a,_r)=>{var ba=_r(6324),xa=_r(748);_o.exports=Object.keys||function(El){return ba(El,xa)}},5296:(_o,_a)=>{var _r={}.propertyIsEnumerable,ba=Object.getOwnPropertyDescriptor,xa=ba&&!_r.call({1:2},1);_a.f=xa?function(El){var yl=ba(this,El);return!!yl&&yl.enumerable}:_r},7674:(_o,_a,_r)=>{var ba=_r(1702),xa=_r(9670),El=_r(6077);_o.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var yl,Ol=!1,Al={};try{(yl=ba(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(Al,[]),Ol=Al instanceof Array}catch{}return function(Nl,Ml){return xa(Nl),El(Ml),Ol?yl(Nl,Ml):Nl.__proto__=Ml,Nl}}():void 0)},2140:(_o,_a,_r)=>{var ba=_r(6916),xa=_r(614),El=_r(111),yl=TypeError;_o.exports=function(Ol,Al){var Nl,Ml;if(Al==="string"&&xa(Nl=Ol.toString)&&!El(Ml=ba(Nl,Ol))||xa(Nl=Ol.valueOf)&&!El(Ml=ba(Nl,Ol))||Al!=="string"&&xa(Nl=Ol.toString)&&!El(Ml=ba(Nl,Ol)))return Ml;throw yl("Can't convert object to primitive value")}},3887:(_o,_a,_r)=>{var ba=_r(5005),xa=_r(1702),El=_r(8006),yl=_r(5181),Ol=_r(9670),Al=xa([].concat);_o.exports=ba("Reflect","ownKeys")||function(Nl){var Ml=El.f(Ol(Nl)),Fl=yl.f;return Fl?Al(Ml,Fl(Nl)):Ml}},2626:(_o,_a,_r)=>{var ba=_r(3070).f;_o.exports=function(xa,El,yl){yl in xa||ba(xa,yl,{configurable:!0,get:function(){return El[yl]},set:function(Ol){El[yl]=Ol}})}},4488:(_o,_a,_r)=>{var ba=_r(8554),xa=TypeError;_o.exports=function(El){if(ba(El))throw xa("Can't call method on "+El);return El}},8003:(_o,_a,_r)=>{var ba=_r(3070).f,xa=_r(2597),El=_r(5112)("toStringTag");_o.exports=function(yl,Ol,Al){yl&&!Al&&(yl=yl.prototype),yl&&!xa(yl,El)&&ba(yl,El,{configurable:!0,value:Ol})}},6200:(_o,_a,_r)=>{var ba=_r(2309),xa=_r(9711),El=ba("keys");_o.exports=function(yl){return El[yl]||(El[yl]=xa(yl))}},5465:(_o,_a,_r)=>{var ba=_r(7854),xa=_r(3072),El="__core-js_shared__",yl=ba[El]||xa(El,{});_o.exports=yl},2309:(_o,_a,_r)=>{var ba=_r(1913),xa=_r(5465);(_o.exports=function(El,yl){return xa[El]||(xa[El]=yl!==void 0?yl:{})})("versions",[]).push({version:"3.26.0",mode:ba?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.0/LICENSE",source:"https://github.com/zloirock/core-js"})},6293:(_o,_a,_r)=>{var ba=_r(7392),xa=_r(7293);_o.exports=!!Object.getOwnPropertySymbols&&!xa(function(){var El=Symbol();return!String(El)||!(Object(El)instanceof Symbol)||!Symbol.sham&&ba&&ba<41})},1400:(_o,_a,_r)=>{var ba=_r(9303),xa=Math.max,El=Math.min;_o.exports=function(yl,Ol){var Al=ba(yl);return Al<0?xa(Al+Ol,0):El(Al,Ol)}},5656:(_o,_a,_r)=>{var ba=_r(8361),xa=_r(4488);_o.exports=function(El){return ba(xa(El))}},9303:(_o,_a,_r)=>{var ba=_r(4758);_o.exports=function(xa){var El=+xa;return El!=El||El===0?0:ba(El)}},7466:(_o,_a,_r)=>{var ba=_r(9303),xa=Math.min;_o.exports=function(El){return El>0?xa(ba(El),9007199254740991):0}},7908:(_o,_a,_r)=>{var ba=_r(4488),xa=Object;_o.exports=function(El){return xa(ba(El))}},7593:(_o,_a,_r)=>{var ba=_r(6916),xa=_r(111),El=_r(2190),yl=_r(8173),Ol=_r(2140),Al=_r(5112),Nl=TypeError,Ml=Al("toPrimitive");_o.exports=function(Fl,up){if(!xa(Fl)||El(Fl))return Fl;var _p,Tp=yl(Fl,Ml);if(Tp){if(up===void 0&&(up="default"),_p=ba(Tp,Fl,up),!xa(_p)||El(_p))return _p;throw Nl("Can't convert object to primitive value")}return up===void 0&&(up="number"),Ol(Fl,up)}},4948:(_o,_a,_r)=>{var ba=_r(7593),xa=_r(2190);_o.exports=function(El){var yl=ba(El,"string");return xa(yl)?yl:yl+""}},1694:(_o,_a,_r)=>{var ba={};ba[_r(5112)("toStringTag")]="z",_o.exports=String(ba)==="[object z]"},1340:(_o,_a,_r)=>{var ba=_r(648),xa=String;_o.exports=function(El){if(ba(El)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return xa(El)}},6330:_o=>{var _a=String;_o.exports=function(_r){try{return _a(_r)}catch{return"Object"}}},9711:(_o,_a,_r)=>{var ba=_r(1702),xa=0,El=Math.random(),yl=ba(1 .toString);_o.exports=function(Ol){return"Symbol("+(Ol===void 0?"":Ol)+")_"+yl(++xa+El,36)}},3307:(_o,_a,_r)=>{var ba=_r(6293);_o.exports=ba&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3353:(_o,_a,_r)=>{var ba=_r(9781),xa=_r(7293);_o.exports=ba&&xa(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},4811:(_o,_a,_r)=>{var ba=_r(7854),xa=_r(614),El=ba.WeakMap;_o.exports=xa(El)&&/native code/.test(String(El))},5112:(_o,_a,_r)=>{var ba=_r(7854),xa=_r(2309),El=_r(2597),yl=_r(9711),Ol=_r(6293),Al=_r(3307),Nl=xa("wks"),Ml=ba.Symbol,Fl=Ml&&Ml.for,up=Al?Ml:Ml&&Ml.withoutSetter||yl;_o.exports=function(_p){if(!El(Nl,_p)||!Ol&&typeof Nl[_p]!="string"){var Tp="Symbol."+_p;Ol&&El(Ml,_p)?Nl[_p]=Ml[_p]:Nl[_p]=Al&&Fl?Fl(Tp):up(Tp)}return Nl[_p]}},9191:(_o,_a,_r)=>{var ba=_r(5005),xa=_r(2597),El=_r(8880),yl=_r(7976),Ol=_r(7674),Al=_r(9920),Nl=_r(2626),Ml=_r(9587),Fl=_r(6277),up=_r(8340),_p=_r(1060),Tp=_r(2914),Fp=_r(9781),Ap=_r(1913);_o.exports=function(Xp,_g,Yp,h0){var E0="stackTraceLimit",A0=h0?2:1,_E=Xp.split("."),Rp=_E[_E.length-1],Lp=ba.apply(null,_E);if(Lp){var Ep=Lp.prototype;if(!Ap&&xa(Ep,"cause")&&delete Ep.cause,!Yp)return Lp;var Ip=ba("Error"),Vp=_g(function(_v,f0){var zp=Fl(h0?f0:_v,void 0),Il=h0?new Lp(_v):new Lp;return zp!==void 0&&El(Il,"message",zp),Tp&&El(Il,"stack",_p(Il.stack,2)),this&&yl(Ep,this)&&Ml(Il,this,Vp),arguments.length>A0&&up(Il,arguments[A0]),Il});if(Vp.prototype=Ep,Rp!=="Error"?Ol?Ol(Vp,Ip):Al(Vp,Ip,{name:!0}):Fp&&E0 in Lp&&(Nl(Vp,Lp,E0),Nl(Vp,Lp,"prepareStackTrace")),Al(Vp,Lp),!Ap)try{Ep.name!==Rp&&El(Ep,"name",Rp),Ep.constructor=Vp}catch{}return Vp}}},6992:(_o,_a,_r)=>{var ba=_r(5656),xa=_r(1223),El=_r(7497),yl=_r(9909),Ol=_r(3070).f,Al=_r(1656),Nl=_r(6178),Ml=_r(1913),Fl=_r(9781),up="Array Iterator",_p=yl.set,Tp=yl.getterFor(up);_o.exports=Al(Array,"Array",function(Ap,Xp){_p(this,{type:up,target:ba(Ap),index:0,kind:Xp})},function(){var Ap=Tp(this),Xp=Ap.target,_g=Ap.kind,Yp=Ap.index++;return!Xp||Yp>=Xp.length?(Ap.target=void 0,Nl(void 0,!0)):Nl(_g=="keys"?Yp:_g=="values"?Xp[Yp]:[Yp,Xp[Yp]],!1)},"values");var Fp=El.Arguments=El.Array;if(xa("keys"),xa("values"),xa("entries"),!Ml&&Fl&&Fp.name!=="values")try{Ol(Fp,"name",{value:"values"})}catch{}},1703:(_o,_a,_r)=>{var ba=_r(2109),xa=_r(7854),El=_r(2104),yl=_r(9191),Ol=xa.WebAssembly,Al=Error("e",{cause:7}).cause!==7,Nl=function(Fl,up){var _p={};_p[Fl]=yl(Fl,up,Al),ba({global:!0,constructor:!0,arity:1,forced:Al},_p)},Ml=function(Fl,up){if(Ol&&Ol[Fl]){var _p={};_p[Fl]=yl("WebAssembly."+Fl,up,Al),ba({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:Al},_p)}};Nl("Error",function(Fl){return function(up){return El(Fl,this,arguments)}}),Nl("EvalError",function(Fl){return function(up){return El(Fl,this,arguments)}}),Nl("RangeError",function(Fl){return function(up){return El(Fl,this,arguments)}}),Nl("ReferenceError",function(Fl){return function(up){return El(Fl,this,arguments)}}),Nl("SyntaxError",function(Fl){return function(up){return El(Fl,this,arguments)}}),Nl("TypeError",function(Fl){return function(up){return El(Fl,this,arguments)}}),Nl("URIError",function(Fl){return function(up){return El(Fl,this,arguments)}}),Ml("CompileError",function(Fl){return function(up){return El(Fl,this,arguments)}}),Ml("LinkError",function(Fl){return function(up){return El(Fl,this,arguments)}}),Ml("RuntimeError",function(Fl){return function(up){return El(Fl,this,arguments)}})},3948:(_o,_a,_r)=>{var ba=_r(7854),xa=_r(8324),El=_r(8509),yl=_r(6992),Ol=_r(8880),Al=_r(5112),Nl=Al("iterator"),Ml=Al("toStringTag"),Fl=yl.values,up=function(Tp,Fp){if(Tp){if(Tp[Nl]!==Fl)try{Ol(Tp,Nl,Fl)}catch{Tp[Nl]=Fl}if(Tp[Ml]||Ol(Tp,Ml,Fp),xa[Fp]){for(var Ap in yl)if(Tp[Ap]!==yl[Ap])try{Ol(Tp,Ap,yl[Ap])}catch{Tp[Ap]=yl[Ap]}}}};for(var _p in xa)up(ba[_p]&&ba[_p].prototype,_p);up(El,"DOMTokenList")},6226:(_o,_a,_r)=>{_o.exports=_r(7460)},7445:(_o,_a,_r)=>{_o.exports=_r(3685)}},j={};function _e(_o){var _a=j[_o];if(_a!==void 0)return _a.exports;var _r=j[_o]={exports:{}};return g[_o](_r,_r.exports,_e),_r.exports}_e.n=_o=>{var _a=_o&&_o.__esModule?()=>_o.default:()=>_o;return _e.d(_a,{a:_a}),_a},_e.d=(_o,_a)=>{for(var _r in _a)_e.o(_a,_r)&&!_e.o(_o,_r)&&Object.defineProperty(_o,_r,{enumerable:!0,get:_a[_r]})},_e.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),_e.o=(_o,_a)=>Object.prototype.hasOwnProperty.call(_o,_a),_e.r=_o=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(_o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_o,"__esModule",{value:!0})};var _n={};return(()=>{_e.r(_n),_e.d(_n,{AudioExtension:()=>_g,AudioProcessor:()=>Ap,Extension:()=>Xp,PromiseMutex:()=>A0,Ticker:()=>h0,VideoProcessor:()=>Fp,logger:()=>Al,reporter:()=>Fl});var _o=_e(7445);function _a(_E,Rp,Lp){return Rp in _E?_o(_E,Rp,{value:Lp,enumerable:!0,configurable:!0,writable:!0}):_E[Rp]=Lp,_E}_e(1703),_e(6992),_e(3948);var _r=_e(6226),ba=_e.n(_r);const xa=Date.now(),El={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4};function yl(){const _E=new Date;return _E.toTimeString().split(" ")[0]+":"+_E.getMilliseconds()}const Ol=_E=>{for(const Rp in El)if(Object.prototype.hasOwnProperty.call(El,Rp)&&El[Rp]===_E)return Rp;return"DEFAULT"},Al=new class{constructor(){_a(this,"logLevel",El.DEBUG),_a(this,"hookLog",void 0)}debug(){for(var _E=arguments.length,Rp=new Array(_E),Lp=0;Lp<_E;Lp++)Rp[Lp]=arguments[Lp];const Ep=[El.DEBUG].concat(Rp);this.log.apply(this,Ep)}info(){for(var _E=arguments.length,Rp=new Array(_E),Lp=0;Lp<_E;Lp++)Rp[Lp]=arguments[Lp];const Ep=[El.INFO].concat(Rp);this.log.apply(this,Ep)}warning(){for(var _E=arguments.length,Rp=new Array(_E),Lp=0;Lp<_E;Lp++)Rp[Lp]=arguments[Lp];const Ep=[El.WARNING].concat(Rp);this.log.apply(this,Ep)}error(){for(var _E=arguments.length,Rp=new Array(_E),Lp=0;Lp<_E;Lp++)Rp[Lp]=arguments[Lp];const Ep=[El.ERROR].concat(Rp);this.log.apply(this,Ep)}log(){for(var _E,Rp=arguments.length,Lp=new Array(Rp),Ep=0;Ep<Rp;Ep++)Lp[Ep]=arguments[Ep];if(Date.now()-xa<100)return void setTimeout(()=>{this.log(...Lp)},Date.now()-xa);const Ip=Math.max(0,Math.min(4,Lp[0]));if(Lp[0]=yl()+" Agora-Extension [".concat(Ol(Ip),"]:"),Ip<this.logLevel)return;const Vp=yl()+" %cAgora-Extension [".concat(Ol(Ip),"]:");let _v=[];switch(Ip){case El.DEBUG:_v=[Vp,"color: #64B5F6;"].concat(Lp.slice(1)),console.log.apply(console,_v);break;case El.INFO:_v=[Vp,"color: #1E88E5; font-weight: bold;"].concat(Lp.slice(1)),console.log.apply(console,_v);break;case El.WARNING:_v=[Vp,"color: #FB8C00; font-weight: bold;"].concat(Lp.slice(1)),console.warn.apply(console,_v);break;case El.ERROR:_v=[Vp,"color: #B00020; font-weight: bold;"].concat(Lp.slice(1)),console.error.apply(console,_v)}(_E=this.hookLog)===null||_E===void 0||_E.call(this,Ip,_v)}};function Nl(_E,Rp){var Lp=Object.keys(_E);if(Object.getOwnPropertySymbols){var Ep=Object.getOwnPropertySymbols(_E);Rp&&(Ep=Ep.filter(function(Ip){return Object.getOwnPropertyDescriptor(_E,Ip).enumerable})),Lp.push.apply(Lp,Ep)}return Lp}function Ml(_E){for(var Rp=1;Rp<arguments.length;Rp++){var Lp=arguments[Rp]!=null?arguments[Rp]:{};Rp%2?Nl(Object(Lp),!0).forEach(function(Ep){_a(_E,Ep,Lp[Ep])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_E,Object.getOwnPropertyDescriptors(Lp)):Nl(Object(Lp)).forEach(function(Ep){Object.defineProperty(_E,Ep,Object.getOwnPropertyDescriptor(Lp,Ep))})}return _E}const Fl=new class{constructor(){_a(this,"apiInvokeMsgQueue",[]),_a(this,"hookApiInvoke",void 0)}reportApiInvoke(_E){_E.timeout=_E.timeout||6e4,_E.reportResult=_E.reportResult===void 0||_E.reportResult;const Rp=Date.now(),Lp=()=>({name:_E.name,apiInvokeTime:Rp,options:_E.options});let Ep=!1;var Ip;(Ip=_E.timeout,new(ba())(_v=>{window.setTimeout(_v,Ip)})).then(()=>{Ep||(this.sendApiInvoke(Ml(Ml({},Lp()),{},{error:"API_INVOKE_TIMEOUT",success:!1})),Al.debug("".concat(_E.name," timeout")))});const Vp=new Error("".concat(_E.name,": this api invoke is end"));return{onSuccess:_v=>{if(Ep)throw Vp;Ep=!0,this.sendApiInvoke(Ml(Ml({},Lp()),{},{success:!0},_E.reportResult&&{result:_v}))},onError:_v=>{if(Ep)throw _v;Ep=!0,this.sendApiInvoke(Ml(Ml({},Lp()),{},{success:!1,error:_v.toString()}))}}}sendApiInvoke(_E){this.hookApiInvoke?(this.hookApiInvoke([...this.apiInvokeMsgQueue,_E]),this.apiInvokeMsgQueue=[]):this.apiInvokeMsgQueue.push(_E)}};function up(_E,Rp){var Lp=Object.keys(_E);if(Object.getOwnPropertySymbols){var Ep=Object.getOwnPropertySymbols(_E);Rp&&(Ep=Ep.filter(function(Ip){return Object.getOwnPropertyDescriptor(_E,Ip).enumerable})),Lp.push.apply(Lp,Ep)}return Lp}function _p(_E){for(var Rp=1;Rp<arguments.length;Rp++){var Lp=arguments[Rp]!=null?arguments[Rp]:{};Rp%2?up(Object(Lp),!0).forEach(function(Ep){_a(_E,Ep,Lp[Ep])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_E,Object.getOwnPropertyDescriptors(Lp)):up(Object(Lp)).forEach(function(Ep){Object.defineProperty(_E,Ep,Object.getOwnPropertyDescriptor(Lp,Ep))})}return _E}class Tp extends class{constructor(){_a(this,"_events",{}),_a(this,"addListener",this.on)}getListeners(Rp){return this._events[Rp]?this._events[Rp].map(Lp=>Lp.listener):[]}on(Rp,Lp){this._events[Rp]||(this._events[Rp]=[]);const Ep=this._events[Rp];this._indexOfListener(Ep,Lp)===-1&&Ep.push({listener:Lp,once:!1})}once(Rp,Lp){this._events[Rp]||(this._events[Rp]=[]);const Ep=this._events[Rp];this._indexOfListener(Ep,Lp)===-1&&Ep.push({listener:Lp,once:!0})}off(Rp,Lp){if(!this._events[Rp])return;const Ep=this._events[Rp],Ip=this._indexOfListener(Ep,Lp);Ip!==-1&&Ep.splice(Ip,1),this._events[Rp].length===0&&delete this._events[Rp]}removeAllListeners(Rp){Rp?delete this._events[Rp]:this._events={}}emit(Rp){this._events[Rp]||(this._events[Rp]=[]);const Lp=this._events[Rp].map(_v=>_v);for(var Ep=arguments.length,Ip=new Array(Ep>1?Ep-1:0),Vp=1;Vp<Ep;Vp++)Ip[Vp-1]=arguments[Vp];for(let _v=0;_v<Lp.length;_v+=1){const f0=Lp[_v];f0.once&&this.off(Rp,f0.listener),f0.listener.apply(this,Ip||[])}}_indexOfListener(Rp,Lp){let Ep=Rp.length;for(;Ep--;)if(Rp[Ep].listener===Lp)return Ep;return-1}emitAsPromise(Rp){for(var Lp=arguments.length,Ep=new Array(Lp>1?Lp-1:0),Ip=1;Ip<Lp;Ip++)Ep[Ip-1]=arguments[Ip];return this.getListeners(Rp).length===0?ba().reject(new Error("No promise event handler.")):new(ba())((Vp,_v)=>{this.emit(Rp,...Ep,Vp,_v)})}emitAsPromiseNoResponse(Rp){for(var Lp=arguments.length,Ep=new Array(Lp>1?Lp-1:0),Ip=1;Ip<Lp;Ip++)Ep[Ip-1]=arguments[Ip];return this.getListeners(Rp).length===0?ba().resolve():new(ba())((Vp,_v)=>{this.emit(Rp,...Ep,Vp,_v)})}}{get enabled(){return this._enabled}output(Rp,Lp){if(this.outputTrack===Rp)return;const Ep=Fl.reportApiInvoke({name:"".concat(this.name,".output"),options:{track:Rp==null?void 0:Rp.toString()}});this.outputTrack=Rp,this.destination&&this.destination.updateInput({track:Rp,context:Lp}),Ep.onSuccess()}constructor(){super(),_a(this,"inputTrack",void 0),_a(this,"outputTrack",void 0),_a(this,"_enabled",!0),_a(this,"_source",void 0),_a(this,"ID",function Rp(){let Lp=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,Ep=arguments.length>1?arguments[1]:void 0;const Ip=Math.random().toString(16).substr(2,Lp).toLowerCase();return Ip.length===Lp?"".concat(Ep).concat(Ip):"".concat(Ep).concat(Ip)+Rp(Lp-Ip.length,"")}(6,"")),_a(this,"destination",void 0),_a(this,"context",void 0),_a(this,"name",void 0)}enable(){if(this._enabled)return;const Rp=Fl.reportApiInvoke({name:"".concat(this.name,".enable"),options:!0});Al.info("".concat(this.name,"-").concat(this.ID," enabled")),this._enabled=!0;try{var Lp;const Ep=(Lp=this.onEnableChange)===null||Lp===void 0?void 0:Lp.call(this,this._enabled);if(Ep instanceof ba())return Ep.then(()=>{Rp.onSuccess()}).catch(Ip=>{throw Rp.onError(Ip),Ip});Rp.onSuccess()}catch(Ep){throw Rp.onError(Ep),Ep}}disable(){if(!this._enabled)return;const Rp=Fl.reportApiInvoke({name:"".concat(this.name,".enable"),options:!1});Al.info("".concat(this.name,"-").concat(this.ID," disabled")),this._enabled=!1;try{var Lp;const Ep=(Lp=this.onEnableChange)===null||Lp===void 0?void 0:Lp.call(this,this._enabled);if(Ep instanceof ba())return Ep.then(()=>{Rp.onSuccess()}).catch(Ip=>{throw Rp.onError(Ip),Ip});Rp.onSuccess()}catch(Ep){throw Rp.onError(Ep),Ep}}}class Fp extends Tp{get kind(){return"video"}pipe(Rp){const Lp=Fl.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:Rp.name}});if(this.destination===Rp)return Lp.onSuccess(),Rp;if(Rp._source){const Ep=new Error("Processor ".concat(Rp.name," already being piped, please call ").concat(Rp._source.name,".unpipe() beforehand."));throw Lp.onError(Ep),Ep}return this.destination&&this.unpipe(),this.destination=Rp,Rp._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,context:this.context}),Lp.onSuccess(),Rp}unpipe(){if(!this.destination)return;const Rp=Fl.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});Al.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));try{const Lp=this.destination;this.destination._source=void 0,this.destination=void 0,Lp.reset()}finally{Rp.onSuccess()}}updateInput(Rp){var Lp,Ep;Rp.context!==this.context&&(this.context=Rp.context,(Lp=this.onPiped)===null||Lp===void 0||Lp.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,context:Rp.context})),Rp.track&&this.inputTrack!==Rp.track&&(this.inputTrack=Rp.track,(Ep=this.onTrack)===null||Ep===void 0||Ep.call(this,Rp.track,this.context))}reset(){var Rp;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.context=void 0,(Rp=this.onUnpiped)===null||Rp===void 0||Rp.call(this),this.destination&&this.destination.reset()}}class Ap extends Tp{constructor(){super(...arguments),_a(this,"inputNode",void 0),_a(this,"outputNode",void 0),_a(this,"destination",void 0),_a(this,"context",void 0)}get kind(){return"audio"}pipe(Rp){const Lp=Fl.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:Rp.name}});if(this.destination===Rp)return Lp.onSuccess(),Rp;if(Rp._source){const Ep=new Error("Processor ".concat(Rp.name," already being piped, please call ").concat(Rp._source.name,".unpipe() beforehand."));throw Lp.onError(Ep),Ep}return this.destination&&this.unpipe(),this.destination=Rp,Rp._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:this.context}),Lp.onSuccess(),Rp}unpipe(){if(!this.destination)return;Al.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));const Rp=Fl.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});try{var Lp;let Ep=this.destination;(Lp=this.outputNode)===null||Lp===void 0||Lp.disconnect(),this.destination._source=void 0,this.destination=void 0,Ep.reset()}finally{Rp.onSuccess()}}output(Rp,Lp){if(Rp instanceof MediaStreamTrack)super.output(Rp,Lp);else if(Rp instanceof AudioNode){if(this.outputNode===Rp)return;const Ep=Fl.reportApiInvoke({name:"".concat(this.name,".output"),options:_p(_p({},Rp instanceof MediaStreamTrack&&{track:Rp.toString()}),Rp instanceof AudioNode&&{audioNode:Rp.toString()})});this.outputNode=Rp,this.destination&&this.destination.updateInput({node:Rp,context:Lp}),Ep.onSuccess()}}updateInput(Rp){var Lp,Ep,Ip;Rp.context!==this.context&&(this.context=Rp.context,(Lp=this.onPiped)===null||Lp===void 0||Lp.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:Rp.context})),Rp.track&&this.inputTrack!==Rp.track&&(this.inputTrack=Rp.track,(Ep=this.onTrack)===null||Ep===void 0||Ep.call(this,Rp.track,this.context)),Rp.node&&this.inputNode!==Rp.node&&(this.inputNode=Rp.node,(Ip=this.onNode)===null||Ip===void 0||Ip.call(this,Rp.node,this.context))}reset(){var Rp;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.inputNode=void 0,(Rp=this.onUnpiped)===null||Rp===void 0||Rp.call(this,this.context),this.context=void 0,this.destination&&this.destination.reset()}}class Xp{constructor(){_a(this,"__registered__",!1),_a(this,"logger",Al),_a(this,"reporter",Fl),_a(this,"parameters",{})}createProcessor(){if(!this.__registered__)throw new Error("Extension not registered yet!");return this._createProcessor()}}class _g extends Xp{}let Yp;class h0{get running(){return this._running}constructor(Rp,Lp){if(_a(this,"type",void 0),_a(this,"interval",void 0),_a(this,"fn",void 0),_a(this,"_running",!1),_a(this,"_osc",void 0),!Rp)throw new Error;if(Lp<=0)throw new Error;this.type=Rp,this.interval=Lp}add(Rp){this.fn=Rp}remove(){this.fn=void 0}start(){if(!this._running)switch(this._running=!0,this.type){case"Timer":{const Rp=()=>{setTimeout(()=>{this.fn&&this.fn(),this._running&&Rp()},this.interval)};Rp();break}case"RAF":{const Rp=Lp=>{requestAnimationFrame(Ep=>{Ep-Lp<this.interval?this._running&&Rp(Lp):(this.fn&&this.fn(),this._running&&Rp(Ep))})};Rp(performance.now());break}case"Oscillator":{Yp||(Yp=new AudioContext);const Rp=Yp.createGain();let Lp;Rp.gain.value=0,Rp.connect(Yp.destination);const Ep=()=>{this.fn&&this.fn(),Lp&&Lp.disconnect(),Lp=Yp.createOscillator(),this._osc=Lp,Lp.connect(Rp),this._running&&(Lp.onended=Ep,Lp.start(0),Lp.stop(Yp.currentTime+this.interval/1e3))};Ep();break}}}stop(){this._running=!1,this._osc&&(this._osc.onended=null,this._osc=void 0)}}let E0=1;class A0{constructor(Rp){_a(this,"lockingPromise",ba().resolve()),_a(this,"locks",0),_a(this,"name",""),_a(this,"lockId",void 0),this.lockId=E0++,Rp&&(this.name=Rp)}get isLocked(){return this.locks>0}lock(Rp){let Lp;this.locks+=1;const Ep=new(ba())(Vp=>{Lp=()=>{this.locks-=1,Vp()}}),Ip=this.lockingPromise.then(()=>Lp);return this.lockingPromise=this.lockingPromise.then(()=>Ep),Ip}}})(),_n})(),s.exports=h()})(dX);var hX;!document.documentMode&&window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(hX=HTMLCanvasElement.prototype.getContext,function(){let s=arguments;return s[0]==="webgl"&&(s=[].slice.call(arguments),s[0]="experimental-webgl"),hX.apply(null,s)}));const rst=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189];function pX(s){const a=new Uint8Array([99,114,121,112,116,105,105]),h=a.length,g=s,j=g.length,_e=new Uint8Array(j),_n=new Uint8Array(256);for(let xa=0;xa<256;xa++)_n[xa]=xa;let _o=0;for(let xa=0;xa<256;xa++)_o=(_o+_n[xa]+a[xa%h])%256,[_n[xa],_n[_o]]=[_n[_o],_n[xa]];let _a,_r=0;_o=0;for(let xa=0;xa<0+j;xa++)_r=(_r+1)%256,_o=(_o+_n[_r])%256,[_n[_r],_n[_o]]=[_n[_o],_n[_r]],_a=_n[(_n[_r]+_n[_o])%256],xa>=0&&(_e[xa-0]=g[xa-0]^_a);const ba=String.fromCharCode.apply(null,Array.from(_e));return Function("var winSize = 5; return `"+ba+"`")()}const ist=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67];class fX{constructor(a,h){Rl(this,"program",void 0),Rl(this,"gl",void 0),Rl(this,"kernel",void 0),this.gl=a,this.kernel=h||ist,this.program=function(g,j){const _e=pX(j),_n=nst(g,[pX(rst),_e]);{const _o=g.getAttribLocation(_n,"a_position"),_a=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,_a),g.bufferData(g.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),g.STATIC_DRAW),g.enableVertexAttribArray(_o);const _r=2,ba=g.FLOAT,xa=!1,El=0,yl=0;g.vertexAttribPointer(_o,_r,ba,xa,El,yl)}{const _o=g.getAttribLocation(_n,"a_texCoord"),_a=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,_a),g.bufferData(g.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),g.STATIC_DRAW),g.enableVertexAttribArray(_o);const _r=2,ba=g.FLOAT,xa=!1,El=0,yl=0;g.vertexAttribPointer(_o,_r,ba,xa,El,yl)}return _n}(this.gl,this.kernel)}setUniforms(){const a=this.gl.getUniformLocation(this.program,"u_flipY");this.gl.uniform1f(a,1)}}class FT extends fX{constructor(a,h,g,j){super(a,h),Rl(this,"xOffset",void 0),Rl(this,"yOffset",void 0),Rl(this,"denoiseLevel",5),this.xOffset=1/g,this.yOffset=1/j}setUniforms(){const a=this.gl.getUniformLocation(this.program,"u_flipY"),h=this.gl.getUniformLocation(this.program,"u_singleStepOffset"),g=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform2f(h,this.xOffset,this.yOffset),this.gl.uniform1f(g,this.denoiseLevel),this.gl.uniform1f(a,1)}setParameters(a){a.denoiseLevel!==void 0&&(this.denoiseLevel=a.denoiseLevel)}setSize(a,h){this.xOffset=1/a,this.yOffset=1/h}}const ost=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11];class sst extends FT{constructor(a,h,g){super(a,ost,h,g)}}const ast=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188];class cst extends FT{constructor(a,h,g){super(a,ast,h,g)}}const ust=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24];class lst extends FT{constructor(a,h,g){super(a,ust,h,g)}}const dst=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144],hst=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],gX=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],pst=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255];class fst extends FT{constructor(a,h,g,j){super(a,dst,g,j),Rl(this,"inputTexture",void 0),Rl(this,"lightLevel",.1),Rl(this,"rednessLevel",.5),Rl(this,"mskin_he_max",175/180*3.141593),Rl(this,"mskin_he_min",115/180*3.141593),Rl(this,"mskin_hc_max",173/180*3.141593),Rl(this,"mskin_hc_min",116/180*3.141593),Rl(this,"mskin_hc_axis",2.04203545),Rl(this,"mfacts_rotate_c",0),Rl(this,"mfacts_rotate_le",0),Rl(this,"mfacts_rotate_ge",0),Rl(this,"tab_addr",null),Rl(this,"lutTextures",[]),this.inputTexture=h,this.init()}setUniforms(){const a=this.gl.getUniformLocation(this.program,"u_flipY"),h=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform1f(h,this.denoiseLevel),this.gl.uniform1f(a,1);const g=this.gl.getUniformLocation(this.program,"light");this.gl.uniform1f(g,this.lightLevel);const j=this.gl.getUniformLocation(this.program,"redness");this.gl.uniform1f(j,this.rednessLevel);const _e=this.gl.getUniformLocation(this.program,"skin_he_max"),_n=this.gl.getUniformLocation(this.program,"skin_he_min"),_o=this.gl.getUniformLocation(this.program,"skin_hc_max"),_a=this.gl.getUniformLocation(this.program,"skin_hc_min"),_r=this.gl.getUniformLocation(this.program,"skin_hc_axis"),ba=this.gl.getUniformLocation(this.program,"facts_rotate_c"),xa=this.gl.getUniformLocation(this.program,"facts_rotate_le"),El=this.gl.getUniformLocation(this.program,"facts_rotate_ge");this.gl.uniform1f(_e,this.mskin_he_max),this.gl.uniform1f(_n,this.mskin_he_min),this.gl.uniform1f(_o,this.mskin_hc_max),this.gl.uniform1f(_a,this.mskin_hc_min),this.gl.uniform1f(_r,this.mskin_hc_axis),this.gl.uniform1f(ba,this.mfacts_rotate_c),this.gl.uniform1f(xa,this.mfacts_rotate_le),this.gl.uniform1f(El,this.mfacts_rotate_ge);const yl=this.gl.getUniformLocation(this.program,"u_originImage");this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.uniform1i(yl,2);const Ol=["lighten_lut"],Al=[this.gl.TEXTURE3];for(let Nl=0;Nl<Ol.length;Nl++){const Ml=this.gl.getUniformLocation(this.program,Ol[Nl]);this.gl.activeTexture(Al[Nl]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[Nl]),this.gl.uniform1i(Ml,Nl+3)}}setParameters(a){a.denoiseLevel!==void 0&&(this.denoiseLevel=a.denoiseLevel),a.lightLevel!==void 0&&(this.lightLevel=a.lightLevel),a.rednessLevel!==void 0&&(this.rednessLevel=a.rednessLevel,this.updateRedness(this.rednessLevel)),a.lighteningContrastLevel&&this.updateLut(a.lighteningContrastLevel)}init(){this.tab_addr=new Uint8Array(gX);const a=[this.tab_addr],h=[256],g=[1];for(let j=0;j<a.length;j++){const _e=this.gl.createTexture();if(!_e)throw new Ql(Hl.WEBGL_INTERNAL_ERROR,"create lut texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,_e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,h[j],g[j],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,a[j]),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.lutTextures.push(_e)}}updateRedness(a){let g,j,_e=a,_n=_e;_e>1&&(_e=1),_e<0&&(_e=0),_n>1&&(_n=1),_n<0&&(_n=0),this.mfacts_rotate_c=.8*_e,_n<.8&&(_n=0),this.mskin_he_max=175/180*3.141593,this.mskin_hc_max=173/180*3.141593,this.mskin_he_min=(115-4*_n)/180*3.141593,this.mskin_hc_min=(116-4*_n)/180*3.141593,this.mskin_hc_axis=(117-4*_n)/180*3.141593,this.mskin_hc_axis<this.mskin_hc_min&&(this.mskin_hc_axis=this.mskin_hc_min),this.mskin_hc_min<3.141593/2&&(this.mskin_hc_min=3.141593/2),this.mskin_hc_axis<3.141593/2&&(this.mskin_hc_axis=3.141593/2),this.mskin_he_min<3.141593/2&&(this.mskin_he_min=3.141593/2),this.mskin_hc_max>3.141593&&(this.mskin_hc_max=3.141593),this.mskin_hc_axis>3.141593&&(this.mskin_hc_axis=3.141593),this.mskin_he_max>3.141593&&(this.mskin_he_max=3.141593),g=this.mskin_he_max-this.mskin_hc_max,j=this.mskin_hc_max-this.mskin_hc_axis,this.mfacts_rotate_ge=g>.01?this.mfacts_rotate_c*j/g:this.mfacts_rotate_c,g=this.mskin_hc_min-this.mskin_he_min,j=this.mskin_hc_axis-this.mskin_hc_min,this.mfacts_rotate_le=g>.01?this.mfacts_rotate_c*j/g:this.mfacts_rotate_c}updateLut(a){let h=null;if(a===0&&(h=gX),a===1&&(h=pst),a===2&&(h=hst),!h)throw new Ql(Hl.WEBGL_INTERNAL_ERROR,"invalid ylut_table value:"+a);this.tab_addr=new Uint8Array(h);const g=[this.tab_addr],j=[256],_e=[1];for(let _n=0;_n<g.length;_n++)this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[_n]),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,j[_n],_e[_n],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,g[_n])}}class gst{constructor(){Rl(this,"gl",null),Rl(this,"canvas",null),Rl(this,"programs",[]),Rl(this,"commonProgram",null),Rl(this,"inputTexture",null),Rl(this,"outputTextures",[]),Rl(this,"fbos",[]),Rl(this,"originalFrameWidth",0),Rl(this,"originalFrameHeight",0),Rl(this,"enableBeauty",!1),Rl(this,"denoiseLevel",5),Rl(this,"lightLevel",.35),Rl(this,"rednessLevel",.5),Rl(this,"lighteningContrastLevel",1)}setEnableBeauty(a){this.enableBeauty=!!a}init(a,h,g){if(!O1().supportWebGL)throw new Ql(Hl.NOT_SUPPORTED,"your browser is not support webGL");if(this.gl=g.getContext("webgl"),!this.gl)throw new Ql(Hl.WEBGL_INTERNAL_ERROR,"can not get webgl context");if(this.initGL(a,h),!this.inputTexture)throw new Ql(Hl.WEBGL_INTERNAL_ERROR,"can not find input texture");this.canvas=g,this.programs.push(new fX(this.gl)),this.programs.push(new sst(this.gl,a,h)),this.programs.push(new cst(this.gl,a,h)),this.programs.push(new lst(this.gl,a,h)),this.programs.push(new fst(this.gl,this.inputTexture,a,h)),this.commonProgram=this.programs[0].program,this.setDenoiseLevel(this.denoiseLevel),this.setLightLevel(this.lightLevel),this.setRednessLevel(this.rednessLevel),this.setContrastLevel(this.lighteningContrastLevel)}render(a){if(!this.gl||!this.commonProgram||!this.canvas)return void Ll.warning("video effect manager is not init!");let h=0;if(this.originalFrameHeight===a.videoWidth&&this.originalFrameWidth===a.videoHeight)h=2;else if(this.originalFrameHeight!==a.videoHeight||this.originalFrameWidth!==a.videoWidth){if(Ll.debug("beauty effect: resolution changed ".concat(this.originalFrameWidth,"x").concat(this.originalFrameHeight," -> ").concat(a.videoWidth,"x").concat(a.videoHeight)),a.videoHeight===0||a.videoWidth===0)return void Ll.debug("beauty effect: skip 0 resolution frame");this.canvas.width=a.videoWidth,this.canvas.height=a.videoHeight,a.setAttribute("width",a.videoWidth.toString()),a.setAttribute("height",a.videoHeight.toString()),this.release(),this.init(a.videoWidth,a.videoHeight,this.canvas)}this.gl.viewport(0,0,a.videoWidth,a.videoHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,a);const g=this.enableBeauty?this.programs.length-1:0;for(let _e=0;_e<=g;_e++){const _n=this.programs[_e].program;this.gl.useProgram(_n);const _o=this.gl.getUniformLocation(_n,"u_image");this.programs[_e].setUniforms(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbos[h+_e%2]),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.outputTextures[h+_e%2]),this.gl.uniform1i(_o,0)}this.gl.useProgram(this.commonProgram);const j=this.gl.getUniformLocation(this.commonProgram,"u_flipY");this.gl.uniform1f(j,-1),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}setDenoiseLevel(a){this.programs.forEach(h=>{h instanceof FT&&h.setParameters({denoiseLevel:a})}),this.denoiseLevel=a}setLightLevel(a){this.programs.forEach(h=>{h instanceof FT&&h.setParameters({lightLevel:a})}),this.lightLevel=a}setRednessLevel(a){this.programs.forEach(h=>{h instanceof FT&&h.setParameters({rednessLevel:a})}),this.rednessLevel=a}setContrastLevel(a){this.programs.forEach(h=>{h instanceof FT&&h.setParameters({lighteningContrastLevel:a})}),this.lighteningContrastLevel=a}setSize(a,h){this.programs.forEach(g=>{g instanceof FT&&g.setSize(a,h)})}release(){this.gl=null,this.commonProgram=null,this.inputTexture=null,this.programs=[],this.outputTextures=[],this.fbos=[]}initGL(a,h){if(!this.gl)throw new Ql(Hl.WEBGL_INTERNAL_ERROR,"can not find webgl context");this.inputTexture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);for(let g=0;g<4;g++){const j=this.gl.createTexture();if(!j)throw new Ql(Hl.WEBGL_INTERNAL_ERROR,"create texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,j),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),g<2?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,a,h,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,h,a,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null);const _e=this.gl.createFramebuffer();if(!_e)throw new Ql(Hl.WEBGL_INTERNAL_ERROR,"create frame buffer failed");this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,_e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,j,0),this.outputTextures.push(j),this.fbos.push(_e)}this.gl.viewport(0,0,a,h),this.originalFrameWidth=a,this.originalFrameHeight=h}}class mst{constructor(){Rl(this,"targetFrameRate",0),Rl(this,"recordedFrameCount",0),Rl(this,"recordingTime",2),Rl(this,"recordID",void 0)}async startRecordBeautyEffectOutput(a){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;if(this.recordID)throw new Ql(Hl.UNEXPECTED_ERROR,"another beauty effect recording is in progress");const g=N_(6,"");return this.recordID=g,this.targetFrameRate=a,this.recordedFrameCount=0,this.recordingTime=h,await g1(1e3*this.recordingTime),this.recordID!==g?(this.recordID=void 0,!0):(this.recordID=void 0,this.recordedFrameCount<this.targetFrameRate*this.recordingTime/2?(Ll.warning("detect beauty effect overload, current framerate",this.recordedFrameCount/2),!1):(Ll.debug("beauty effect current framerate",this.recordedFrameCount/2),!0))}stopRecordBeautyEffectOutput(){this.targetFrameRate=0,this.recordedFrameCount=0,this.recordID=void 0}addFrame(){this.recordID&&(this.recordedFrameCount+=1)}}class vst extends dX.exports.VideoProcessor{constructor(){super(),Rl(this,"name","BeautyProcessor"),Rl(this,"fps",15),Rl(this,"canvas",void 0),Rl(this,"video",void 0),Rl(this,"manager",void 0),Rl(this,"overloadDetector",new mst),Rl(this,"stopChromeBackgroundLoop",null),Rl(this,"onOverload",void 0),Rl(this,"stopLoop",void 0),Rl(this,"lastRenderTime",0),this.fps=30,this.manager=new gst,this._enabled=!1}async onEnableChange(a){this.manager.setEnableBeauty(a),this.context&&this.inputTrack&&(a?await this.startEffect(this.inputTrack,this.context):await this.stopEffect(this.inputTrack,this.context))}async setBeautyEffectOptions(a){if(function(h){h.smoothnessLevel!==void 0&&f_(h.smoothnessLevel,"options.smoothnessLevel",0,1,!1),h.lighteningLevel!==void 0&&f_(h.lighteningLevel,"options.lighteningLevel",0,1,!1),h.rednessLevel!==void 0&&f_(h.rednessLevel,"options.rednessLevel",0,1,!1),h.lighteningContrastLevel!==void 0&&y1(h.lighteningContrastLevel,"options.lighteningContrastLevel",[0,1,2])}(a),a.smoothnessLevel!==void 0){const h=Math.max(.1,10*a.smoothnessLevel);this.manager.setDenoiseLevel(h)}if(a.lighteningLevel!==void 0){const h=Math.max(.1,a.lighteningLevel/2);this.manager.setLightLevel(h)}if(a.rednessLevel!==void 0){const h=Math.max(.01,a.rednessLevel);this.manager.setRednessLevel(h)}if(a.lighteningContrastLevel!==void 0){const h=a.lighteningContrastLevel;this.manager.setContrastLevel(h)}}async onTrack(a,h){var g;this.video&&this.enabled&&((g=this.stopLoop)===null||g===void 0||g.call(this),await this.stopEffect(a,h)),await this.startEffect(a,h)}async startEffect(a,h){if(!this.enabled)return;const g=p_(),j=await this.renderWithWebGL(a);this.output(j,h),Ll.info("start video effect, output:",this.outputTrack),this.overloadDetector.startRecordBeautyEffectOutput(this.fps).then(_o=>{_o||this.onOverload&&this.onOverload()});let _e=!1;this.stopLoop=()=>{_e=!0};const _n=()=>{this.enabled&&!_e&&requestAnimationFrame(_n);const _o=Date.now(),_a=1e3/this.fps,_r=this.lastRenderTime?_o-this.lastRenderTime:_a;_r<_a||(this.lastRenderTime=_o-(_r-_a),this.video&&this.video.paused&&this.video.play(),this.enabled&&this.video&&(this.manager.render(this.video),this.outputTrack&&this.outputTrack.requestFrame&&this.outputTrack.requestFrame(),this.overloadDetector.addFrame()))};requestAnimationFrame(_n),g.name===u_.CHROME&&document.addEventListener("visibilitychange",()=>{document.hidden?this.stopChromeBackgroundLoop=u8(()=>{this.enabled&&this.video&&this.manager.render(this.video),this.outputTrack&&this.outputTrack.requestFrame&&this.outputTrack.requestFrame(),this.overloadDetector.addFrame()},this.fps):this.stopChromeBackgroundLoop&&(this.stopChromeBackgroundLoop(),this.stopChromeBackgroundLoop=null)},!1)}async renderWithWebGL(a){this.canvas&&(this.canvas.remove(),this.canvas=void 0),this.video&&(this.video.remove(),this.video=void 0),this.canvas=document.createElement("canvas"),this.video=document.createElement("video"),this.video.setAttribute("autoplay",""),this.video.setAttribute("muted",""),this.video.muted=!0,this.video.setAttribute("playsinline",""),this.video.setAttribute("style","display:none"),this.video.srcObject=new MediaStream([a]);const h=new s0(_o=>{const _a=()=>{this.video&&this.video.removeEventListener("playing",_a),_o(void 0)};this.video&&this.video.addEventListener("playing",_a)});this.video.play(),await h;const g=a.getSettings(),j=g.width||this.video.videoWidth,_e=g.height||this.video.videoHeight;if(g.frameRate&&this.fps!==g.frameRate&&(this.fps=g.frameRate,Ll.debug("beauty video processor: set fps to",this.fps)),Ll.debug("beauty video processor: width ".concat(j," height ").concat(_e)),!j||!_e)throw new Ql(Hl.BEAUTY_PROCESSOR_INTERNAL_ERROR,"can not get track resolution");this.canvas.width=j,this.canvas.height=_e,this.video.setAttribute("width",j.toString()),this.video.setAttribute("height",_e.toString()),this.manager.init(j,_e,this.canvas);const _n=O1();return this.canvas.captureStream(_n.supportRequestFrame?0:this.fps).getVideoTracks()[0]}async stopEffect(a,h){Ll.info("stop video effect"),this.overloadDetector.stopRecordBeautyEffectOutput(),this.manager.release(),this.canvas&&this.canvas.remove(),this.video&&this.video.remove(),this.canvas=void 0,this.video=void 0,this.output(a,h)}}function Z8(s){const a={};if(s.facingMode&&(a.facingMode=s.facingMode),s.cameraId&&(a.deviceId={exact:s.cameraId}),!s.encoderConfig)return a;const h=V2(s.encoderConfig);return a.width=h.width,a.height=h.height,!_V()&&h.frameRate&&(a.frameRate=h.frameRate),p_().name===u_.EDGE&&typeof a.frameRate=="object"&&(a.frameRate.max=60),M_()&&(a.frameRate={ideal:30,max:30}),a}function Est(s){const a={};s.screenSourceType&&(a.mediaSource=s.screenSourceType),s.extensionId&&h6()&&(a.extensionId=s.extensionId),s.electronScreenSourceId&&(a.sourceId=s.electronScreenSourceId);const h=s.encoderConfig?D6(s.encoderConfig):null;return a.mandatory={chromeMediaSource:"desktop",maxWidth:h?h.width:void 0,maxHeight:h?h.height:void 0},h&&h.frameRate&&(typeof h.frameRate=="number"?(a.mandatory.maxFrameRate=h.frameRate,a.mandatory.minFrameRate=h.frameRate):(a.mandatory.maxFrameRate=h.frameRate.max||h.frameRate.ideal||h.frameRate.exact||void 0,a.mandatory.minFrameRate=h.frameRate.min||h.frameRate.ideal||h.frameRate.exact||void 0),a.frameRate=h.frameRate),h&&h.width&&(a.width=h.width),h&&h.height&&(a.height=h.height),a}function mX(s){const a={};if(_V()||(s.AGC!==void 0&&(a.autoGainControl=s.AGC),s.AEC!==void 0&&(a.echoCancellation=s.AEC),s.ANS!==void 0&&(a.noiseSuppression=s.ANS,h6()&&s.ANS&&(a.googHighpassFilter=s.ANS))),s.encoderConfig){const h=g4(s.encoderConfig);a.channelCount=h.stereo?2:1,a.sampleRate=h.sampleRate,a.sampleSize=h.sampleSize}return s.microphoneId&&(a.deviceId={exact:s.microphoneId}),f6()&&(a.sampleRate=void 0),a}var iN,K4;(function(s){s.COVERED="COVERED",s.POSITION="POSITION",s.SIZE="SIZE",s.STYLE="STYLE"})(iN||(iN={})),function(s){s.UNMOUNTED="UNMOUNTED",s.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(K4||(K4={}));var vX,EX,_X,yX,bX,SX,TX,RX,wX,IX,OX,CX,AX,NX,kX,LX,PX,DX,xX,MX,UX,Y0,jX,FX,VX,BX,GX,qX,WX,HX,$y,KX=new class{constructor(){Rl(this,"_clientSize",null),Rl(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),Rl(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),Rl(this,"getStyle",s=>window.getComputedStyle(s,null)),Rl(this,"checkCssVisibleProperty",s=>{let a=!0;const h=this.getStyle(s),{display:g,visibility:j,opacity:_e,filter:_n}=h;return(g==="none"||["hidden","collapse"].includes(j)||Number(_e)<.1)&&(a=!1),a?(_n&&_n.split(" ").filter(_o=>{const _a=_o.split("(")[0];return["brightness","blur","opacity"].includes(_a)}).map(_o=>{const[_a,_r]=_o.split(/\(|\)/);return[_a,Number(_r.match(/^[0-9\.]+/))]}).forEach(_o=>{const[_a,_r]=_o;switch(_a){case"brightness":(_r<.1||_r>3)&&(a=!1);break;case"blur":_r>3&&(a=!1);break;case"opacity":_r<.1&&(a=!1)}}),a):!1}),Rl(this,"checkPropertyUpToAllParentNodes",(s,a)=>{let h=!0,g=!0;const j=_n=>a(_n);let _e=s;for(;_e&&g;)j(_e)||(h=!1,g=!1),_e=_e.parentElement,_e||(g=!1);return h}),Rl(this,"checkActualCssVisibleIncludeInherit",s=>this.checkPropertyUpToAllParentNodes(s,this.checkCssVisibleProperty)),Rl(this,"getSizeAboutClient",s=>{const{width:a,height:h,left:g,right:j,top:_e,bottom:_n}=s.getBoundingClientRect(),_o=this.getClientWidth(),_a=this.getClientHeight();return{width:a,height:h,left:g,right:j,top:_e,bottom:_n,clientWidth:_o,clientHeight:_a,clientMin:Math.min(_o,_a)}}),Rl(this,"checkActualSize",()=>{const{width:s,height:a,clientMin:h}=this._clientSize;return this.checkSizeIsVisible(s,a,h)}),Rl(this,"elementFromPoint",(s,a)=>document.elementFromPoint?document.elementFromPoint(s,a):null),Rl(this,"checkCoverForAPoint",(s,a,h)=>{const g=this.elementFromPoint(s,a);return g!==null&&g!==h}),Rl(this,"getPointPositionList",()=>{const{width:s,height:a,left:h,top:g}=this._clientSize,j=s/6,_e=a/6,_n=[],_o=10**6;for(let _a=0;_a<5;_a++)for(let _r=0;_r<5;_r++){const ba=(h*_o+(_a===0?.1:_a===4?(j*_a*_o-1e5)/_o:j*_a)*_o)/_o,xa=(g*_o+(_r===0?.1:_r===4?(_e*_r*_o-1e5)/_o:_e*_r)*_o)/_o;_n.push({x:ba,y:xa})}return[..._n]}),Rl(this,"checkElementCover",s=>this.getPointPositionList().map(a=>this.checkCoverForAPoint(a.x,a.y,s)).filter(a=>!!a).length>6),Rl(this,"checkSizeIsVisible",(s,a,h)=>(s>50||h/s<=10)&&(a>50||h/a<=10)),Rl(this,"checkSizeOfPartInClient",()=>{const{left:s,right:a,top:h,bottom:g,clientHeight:j,clientWidth:_e,clientMin:_n}=this._clientSize;let _o,_a,_r,ba;if(s<0)_o=0;else{if(!(s<_e))return!1;_o=s}if(a<0)return!1;if(_a=a<_e?a:_e,h<0)_r=0;else{if(!(h<j))return!1;_r=h}if(g<0)return!1;ba=g<j?g:j;const xa=_a-_o,El=ba-_r;return this.checkSizeIsVisible(xa,El,_n)}),Rl(this,"returnHiddenResult",s=>(this._clientSize=null,{visible:!1,reason:s})),Rl(this,"checkOneElementVisible",s=>{if(s instanceof HTMLElement){if(this.checkElementIsMountedOnDom(s)){if(this.checkActualCssVisibleIncludeInherit(s)){if(this._clientSize=this.getSizeAboutClient(s),this.checkElementCover(s))return this.returnHiddenResult(iN.COVERED);{const a=this.checkActualSize(),h=this.checkSizeOfPartInClient();return a&&!h?this.returnHiddenResult(iN.POSITION):a?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(iN.SIZE)}}return this.returnHiddenResult(iN.STYLE)}return this.returnHiddenResult(K4.UNMOUNTED)}return this.returnHiddenResult(K4.INVALID_HTML_ELEMENT)}),Rl(this,"checkElementIsMountedOnDom",s=>this.checkPropertyUpToAllParentNodes(s,a=>a.nodeName.toUpperCase()!=="HTML"?a.parentElement!==null:!!document.documentElement))}};function zX(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function oN(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?zX(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):zX(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}let H_=(vX=b0({argsMap:(s,a,h)=>[s.getTrackId(),typeof a=="string"?a:"HTMLElement",h]}),EX=U_(),_X=b0({argsMap:s=>[s.getTrackId()]}),yX=K2("LocalVideoTrack","_enabledMutex"),bX=b0({argsMap:(s,a)=>[s.getTrackId(),a]}),SX=U_(),TX=K2("LocalVideoTrack","_enabledMutex"),RX=b0({argsMap:(s,a)=>[s.getTrackId(),a]}),wX=U_(),IX=U_(),OX=b0({argsMap:(s,a,h)=>[s.getTrackId(),a,h]}),CX=U_(),AX=U_(),NX=U_(),kX=U_(),LX=U_(),PX=U_(),DX=U_(),xX=b0({argsMap:(s,a)=>[s.getTrackId(),a.name]}),MX=b0({argsMap:s=>[s.getTrackId()]}),UX=b0({argsMap:s=>[s.getTrackId()]}),Wp((Y0=class vZ extends a8{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==S1.PLAYING)}get __className__(){return"LocalVideoTrack"}constructor(a,h,g,j,_e,_n){super(a,_e),Rl(this,"trackMediaType","video"),Rl(this,"_player",void 0),Rl(this,"_videoBeautyProcessor",void 0),Rl(this,"_videoVisibleTimer",null),Rl(this,"_previousVideoVisibleStatus",void 0),Rl(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),Rl(this,"_encoderConfig",void 0),Rl(this,"_scalabiltyMode",{numSpatialLayers:1,numTemporalLayers:1}),Rl(this,"_optimizationMode",void 0),Rl(this,"_videoHeight",void 0),Rl(this,"_videoWidth",void 0),Rl(this,"_forceBitrateLimit",void 0),Rl(this,"_enabled",!0),Rl(this,"processorDestination",void 0),Rl(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this._encoderConfig=h,this._scalabiltyMode=g,this._optimizationMode=j,this._hints=_n||[],this._hints.indexOf(c1.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile(),this.processorContext=new sz(this.getTrackId(),"local"),this.processorDestination=new oz(this.processorContext),this.bindProcessorDestinationEvents()}play(a){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof a=="string"){const j=document.getElementById(a);j?a=j:(Ll.warning("[".concat(this.getTrackId(),'] can not find "#').concat(a,'" element, use document.body')),a=document.body)}Ll.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(h));const g=oN(oN(oN({},this._getDefaultPlayerConfig()),h),{},{trackId:this.getTrackId(),element:a});this._player?this._player.updateConfig(g):(this._player=new uX(g),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const j=this.getVideoElementVisibleStatus();this.emit(ER.VIDEO_ELEMENT_VISIBLE_STATUS,j)}catch{}},wp("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,Ll.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(a,h){if(!h){if(a===this._enabled)return;this.stateCheck("enabled",a)}if(Ll.info("[".concat(this.getTrackId(),"] start setEnabled"),a),!a){this._originMediaStreamTrack.enabled=!1;try{await D_(this,w0.NEED_DISABLE_TRACK,this)}catch(g){throw Ll.error("[".concat(this.getTrackId(),"] setEnabled to false error"),g.toString()),g}return h||(this._enabled=!1),void Ll.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await D_(this,w0.NEED_ENABLE_TRACK,this)}catch(g){throw Ll.error("[".concat(this.getTrackId(),"] setEnabled to true error"),g.toString()),g}Ll.info("[".concat(this.getTrackId(),"] setEnabled to true success")),h||(this._enabled=!0)}async setMuted(a){a!==this._muted&&(this.stateCheck("muted",a),this._muted=a,this._originMediaStreamTrack.enabled=!a,Ll.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(a)),a?await D_(this,w0.NEED_MUTE_TRACK,this):await D_(this,w0.NEED_UNMUTE_TRACK,this))}getStats(){return LP(()=>{Ll.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),tT(this,w0.GET_STATS)||oN({},J6)}async setBeautyEffect(a){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(a||this._videoBeautyProcessor){if(fV()===_1.IOS||fV()===_1.ANDROID)throw new Ql(Hl.INVALID_OPERATION,"can not enable beauty effect on mobile device");if(!this._enabled&&a)throw new Ql(Hl.TRACK_IS_DISABLED,"can not enable beauty effect when track is disabled");if(Ll.info("[".concat(this.getTrackId(),"] start setBeautyEffect"),a,JSON.stringify(h)),this._videoBeautyProcessor||a){try{if(!this._videoBeautyProcessor)if(this._videoBeautyProcessor=new vst,this.processor){const g=this.processor;this.pipe(this._videoBeautyProcessor).pipe(g)}else this.pipe(this._videoBeautyProcessor).pipe(this.processorDestination);await this._videoBeautyProcessor.setBeautyEffectOptions(h),a?await this._videoBeautyProcessor.enable():await this._videoBeautyProcessor.disable()}catch(g){throw Ll.error("[".concat(this.getTrackId(),"] setBeautyEffect error"),g.toString()),g}Ll.info("[".concat(this.getTrackId(),"] setBeautyEffect success"))}}}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(a){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(a,h):await $8(a)}clone(a,h,g,j){const _e=this._mediaStreamTrack.clone();return new vZ(_e,a,h,g,j)}async setBitrateLimit(a){if(Ll.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(a))),a){this._forceBitrateLimit=a,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<a.max_bitrate?this._encoderConfig.bitrateMax:a.max_bitrate:this._encoderConfig.bitrateMax=a.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=a.min_bitrate);try{await D_(this,w0.NEED_UPDATE_VIDEO_ENCODER,this)}catch(h){return h.throw()}}}async setOptimizationMode(a){if(a!=="motion"&&a!=="detail"&&a!=="balanced")return void Ll.error(Hl.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const h=this._optimizationMode;try{this._optimizationMode=a,await D_(this,w0.SET_OPTIMIZATION_MODE,this)}catch(g){throw this._optimizationMode=h,Ll.error("[".concat(this.getTrackId(),"] set optimization mode failed"),g.toString()),g}Ll.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(a,")"))}setScalabiltyMode(a){if(a.numSpatialLayers===1&&a.numTemporalLayers!==1)return Ll.error(Hl.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabiltyMode=a,Ll.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(a,")"))}updateMediaStreamTrackResolution(){_z(this._originMediaStreamTrack).then(a=>{let[h,g]=a;this._videoHeight=g,this._videoWidth=h}).catch(O4)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:a,height:h,frameRate:g}=this.getMediaStreamTrackSettings();if(!a||!h||!g)return;const[j,_e]=function(_n,_o,_a){const _r=wp("BITRATE_ADAPTER_TYPE");let ba;const xa=200*Math.pow(_a/15,.6)*Math.pow(_n*_o/640/360,.75),El=xa;if(_r==="STANDARD_BITRATE")ba=4*xa;else{if(_r!=="COMPATIABLE_BITRATE")return;ba=2*xa}return[Math.floor(ba),Math.floor(El)]}(a,h,g)||[void 0,void 0];this._encoderConfig.bitrateMin||this._encoderConfig.bitrateMax||(this._encoderConfig.bitrateMin=_e,this._encoderConfig.bitrateMax=j,Ll.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(a,", h: ").concat(h,", fps: ").concat(g,"] => [brMax: ").concat(j,", brMin: ").concat(_e,"]")))}getVideoElementVisibleStatus(){try{var a,h;const g=this==null||(a=this._player)===null||a===void 0?void 0:a.getContainerElement(),j={track:this,element:this==null||(h=this._player)===null||h===void 0?void 0:h.getVideoElement(),slot:g==null?void 0:g.parentElement},{element:_e,slot:_n}=j;if(this.isPlaying&&_e instanceof HTMLVideoElement&&_n instanceof HTMLElement){const _o=KX.checkOneElementVisible(_e),_a=Object.assign({},_o);if(_a.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=_a.visible;const _r=d0.reportApiInvoke(null,{tag:A_.TRACER,name:Y_.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});_a.visible?_r.onSuccess("Video is visible"):_r.onSuccess("Invisible because of ".concat(_a.reason))}return _a}return}catch(g){throw new Ql(Hl.GET_VIDEO_ELEMENT_VISIBLE_ERROR,g.message)}}async renewMediaStreamTrack(a){}pipe(a){if(this._videoBeautyProcessor&&a!==this._videoBeautyProcessor)return this._videoBeautyProcessor.pipe(a);if(this.processor===a)return a;if(a._source)throw new Ql(Hl.INVALID_OPERATION,"Processor ".concat(a.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=a,this.processor._source=this,a.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),a}unpipe(){if(!this.processor)return;if(this._videoBeautyProcessor&&this.processor===this._videoBeautyProcessor)return void this._videoBeautyProcessor.unpipe();const a=this.processor;this.processor._source=void 0,this.processor=void 0,a.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}bindProcessorDestinationEvents(){this.processorDestination.on(I1.ON_TRACK,async a=>{a?a!==this._mediaStreamTrack&&(this._mediaStreamTrack=a,this._updatePlayerSource(),await D_(this,w0.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await D_(this,w0.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(I1.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(cy.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(cy.REQUEST_CONSTRAINTS)}}).prototype,"play",[vX,EX],Object.getOwnPropertyDescriptor(Y0.prototype,"play"),Y0.prototype),Wp(Y0.prototype,"stop",[_X],Object.getOwnPropertyDescriptor(Y0.prototype,"stop"),Y0.prototype),Wp(Y0.prototype,"setEnabled",[yX,bX,SX],Object.getOwnPropertyDescriptor(Y0.prototype,"setEnabled"),Y0.prototype),Wp(Y0.prototype,"setMuted",[TX,RX,wX],Object.getOwnPropertyDescriptor(Y0.prototype,"setMuted"),Y0.prototype),Wp(Y0.prototype,"getStats",[IX],Object.getOwnPropertyDescriptor(Y0.prototype,"getStats"),Y0.prototype),Wp(Y0.prototype,"setBeautyEffect",[OX,CX],Object.getOwnPropertyDescriptor(Y0.prototype,"setBeautyEffect"),Y0.prototype),Wp(Y0.prototype,"getCurrentFrameData",[AX],Object.getOwnPropertyDescriptor(Y0.prototype,"getCurrentFrameData"),Y0.prototype),Wp(Y0.prototype,"getCurrentFrameImage",[NX],Object.getOwnPropertyDescriptor(Y0.prototype,"getCurrentFrameImage"),Y0.prototype),Wp(Y0.prototype,"setBitrateLimit",[kX],Object.getOwnPropertyDescriptor(Y0.prototype,"setBitrateLimit"),Y0.prototype),Wp(Y0.prototype,"setOptimizationMode",[LX],Object.getOwnPropertyDescriptor(Y0.prototype,"setOptimizationMode"),Y0.prototype),Wp(Y0.prototype,"setScalabiltyMode",[PX],Object.getOwnPropertyDescriptor(Y0.prototype,"setScalabiltyMode"),Y0.prototype),Wp(Y0.prototype,"updateMediaStreamTrackResolution",[DX],Object.getOwnPropertyDescriptor(Y0.prototype,"updateMediaStreamTrackResolution"),Y0.prototype),Wp(Y0.prototype,"pipe",[xX],Object.getOwnPropertyDescriptor(Y0.prototype,"pipe"),Y0.prototype),Wp(Y0.prototype,"unpipe",[MX],Object.getOwnPropertyDescriptor(Y0.prototype,"unpipe"),Y0.prototype),Wp(Y0.prototype,"close",[UX],Object.getOwnPropertyDescriptor(Y0.prototype,"close"),Y0.prototype),Y0),YX=(jX=b0({argsMap:(s,a)=>[s.getTrackId(),a]}),FX=U_(),VX=K2("CameraVideoTrack","_enabledMutex"),BX=b0({argsMap:(s,a)=>[s.getTrackId(),a]}),GX=U_(),qX=b0({argsMap:(s,a)=>[s.getTrackId(),a]}),WX=U_(),HX=b0({argsMap:s=>[s.getTrackId()]}),Wp(($y=class extends H_{get __className__(){return"CameraVideoTrack"}constructor(s,a,h,g,j,_e){super(s,a.encoderConfig?V2(a.encoderConfig):{},g,j,_e),Rl(this,"_config",void 0),Rl(this,"_originalConstraints",void 0),Rl(this,"_constraints",void 0),Rl(this,"_enabled",!0),Rl(this,"_deviceName","default"),Rl(this,"tryResumeVideoForIOS15WeChat",async()=>{P2()&&!p6()&&EV()&&this._enabled&&!this._isClosed&&(Ll.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=a,this._originalConstraints=h,this._constraints=h,this._deviceName=s.label,this._config.encoderConfig&&(this._encoderConfig=V2(this._config.encoderConfig)),G0.on(r1.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),G0.on(r1.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),this.bindProcessorContextEvents()}async setDevice(s){if(Ll.info("[".concat(this.getTrackId(),"] set device to ").concat(s)),this._enabled)try{const a=await vy.getDeviceById(s),h={};h.video=oN({},this._constraints),h.video.deviceId={exact:s},h.video.facingMode=void 0,this._originMediaStreamTrack.stop();let g=null;try{g=await gS(h,this.getTrackId())}catch(j){throw Ll.error("[".concat(this.getTrackId(),"] setDevice failed"),j.toString()),g=await gS({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(g.getVideoTracks()[0],!1),j}await this._updateOriginMediaStreamTrack(g.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=a.label,this._config.cameraId=s,this._constraints.deviceId={exact:s}}catch(a){throw Ll.error("[".concat(this.getTrackId(),"] setDevice error"),a.toString()),a}else try{const a=await vy.getDeviceById(s);this._deviceName=a.label,this._config.cameraId=s,this._constraints.deviceId={exact:s}}catch(a){throw Ll.error("[".concat(this.getTrackId(),"] setDevice error"),a.toString()),a}Ll.info("[".concat(this.getTrackId(),"] setDevice success"))}async setEnabled(s,a){if(!a){if(s===this._enabled)return;this.stateCheck("enabled",s)}if(Ll.info("[".concat(this.getTrackId(),"] start setEnabled"),s),!s){this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),a||(this._enabled=!1);try{await D_(this,w0.NEED_DISABLE_TRACK,this)}catch(j){throw Ll.error("[".concat(this.getTrackId(),"] setEnabled to false error"),j.toString()),j}return void Ll.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}const h=oN({},this._constraints),g=vy.searchDeviceIdByName(this._deviceName);g&&!h.deviceId&&(h.deviceId={exact:g});try{const j=await gS({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(j.getVideoTracks()[0],!1),await D_(this,w0.NEED_ENABLE_TRACK,this)}catch(j){throw Ll.error("[".concat(this.getTrackId(),"] setEnabled true error"),j.toString()),j}this.updateMediaStreamTrackResolution(),Ll.info("[".concat(this.getTrackId(),"] setEnabled to true success")),a||(this._enabled=!0)}async setEncoderConfiguration(s,a){if(!this._enabled)throw new Ql(Hl.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");s=V2(s),this._forceBitrateLimit&&(s.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:s.bitrateMax,s.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:s.bitrateMin);const h=W_(this._config);h.encoderConfig=s;const g=Z8(h);(iy()||x1()||AT())&&(g.deviceId=void 0),Ll.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(s),JSON.stringify(g));try{await this._originMediaStreamTrack.applyConstraints(g),this.updateMediaStreamTrackResolution()}catch(j){const _e=new Ql(Hl.UNEXPECTED_ERROR,j.toString());throw Ll.error("[".concat(this.getTrackId(),"] applyConstraints error"),_e.toString()),_e}this._config=h,this._constraints=g,this._originalConstraints=g,this._encoderConfig=s,this._hints.indexOf(c1.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await D_(this,w0.NEED_UPDATE_VIDEO_ENCODER,this)}catch(j){return j.throw()}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((x1()||AT())&&this._enabled&&!this._isClosed&&G0.duringInterruption){const s=async()=>{G0.off(r1.IOS_INTERRUPTION_END,s),this._enabled&&!this._isClosed&&(Ll.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};G0.on(r1.IOS_INTERRUPTION_END,s)}else Ll.debug("[".concat(this.getTrackId(),"] track ended")),this.emit(ER.TRACK_ENDED)}async renewMediaStreamTrack(s){const a=s||this._constraints,h=vy.searchDeviceIdByName(this._deviceName);if(h&&!a.deviceId&&(a.deviceId={exact:h}),this._enabled){const g=await gS({video:a},this.getTrackId());this._constraints=a,await this._updateOriginMediaStreamTrack(g.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),G0.off(r1.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),G0.off(r1.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat)}bindProcessorContextEvents(){this.processorContext.on(cy.REQUEST_UPDATE_CONSTRAINTS,async(s,a,h)=>{try{const g=Object.assign({},this._originalConstraints,...s);await this.renewMediaStreamTrack(g),a()}catch(g){h(g)}}),this.processorContext.on(cy.REQUEST_CONSTRAINTS,async s=>{s(this._originMediaStreamTrack.getSettings())})}}).prototype,"setDevice",[jX,FX],Object.getOwnPropertyDescriptor($y.prototype,"setDevice"),$y.prototype),Wp($y.prototype,"setEnabled",[VX,BX,GX],Object.getOwnPropertyDescriptor($y.prototype,"setEnabled"),$y.prototype),Wp($y.prototype,"setEncoderConfiguration",[qX,WX],Object.getOwnPropertyDescriptor($y.prototype,"setEncoderConfiguration"),$y.prototype),Wp($y.prototype,"close",[HX],Object.getOwnPropertyDescriptor($y.prototype,"close"),$y.prototype),$y);class t9{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio)return this._audioTrack}get videoTrack(){if(this.hasVideo)return this._videoTrack}constructor(a,h){Rl(this,"uid",void 0),Rl(this,"_uintid",void 0),Rl(this,"_trust_in_room_",!0),Rl(this,"_trust_audio_enabled_state_",!0),Rl(this,"_trust_video_enabled_state_",!0),Rl(this,"_trust_audio_mute_state_",!0),Rl(this,"_trust_video_mute_state_",!0),Rl(this,"_audio_muted_",!1),Rl(this,"_video_muted_",!1),Rl(this,"_audio_enabled_",!0),Rl(this,"_video_enabled_",!0),Rl(this,"_audio_added_",!1),Rl(this,"_video_added_",!1),Rl(this,"_trust_video_stream_added_state_",!0),Rl(this,"_trust_audio_stream_added_state_",!0),Rl(this,"_audioTrack",void 0),Rl(this,"_videoTrack",void 0),Rl(this,"_audioSSRC",void 0),Rl(this,"_videoSSRC",void 0),Rl(this,"_audioOrtc",void 0),Rl(this,"_videoOrtc",void 0),Rl(this,"_cname",void 0),Rl(this,"_rtxSsrcId",void 0),this.uid=a,this._uintid=h}}var _st=D7,yst=C2,bst=HM;a1({target:"Promise",stat:!0},{try:function(s){var a=yst.f(this),h=bst(s);return(h.error?a.reject:a.resolve)(h.value),a.promise}});var e9=_st,Sst=a1,Tst=Dl,Rst=_,wst=NP,Ist=hy,Ost=Uy,Cst=cS,JX=m4,Ast=eW,Nst=aW,kst=BT,XX=y0("isConcatSpreadable"),QX=9007199254740991,$X="Maximum allowed index exceeded",ZX=Tst.TypeError,Lst=kst>=51||!Rst(function(){var s=[];return s[XX]=!1,s.concat()[0]!==s}),Pst=Nst("concat"),Dst=function(s){if(!Ist(s))return!1;var a=s[XX];return a!==void 0?!!a:wst(s)};Sst({target:"Array",proto:!0,forced:!Lst||!Pst},{concat:function(s){var a,h,g,j,_e,_n=Ost(this),_o=Ast(_n,0),_a=0;for(a=-1,g=arguments.length;a<g;a++)if(Dst(_e=a===-1?_n:arguments[a])){if(_a+(j=Cst(_e))>QX)throw ZX($X);for(h=0;h<j;h++,_a++)h in _e&&JX(_o,_a,_e[h])}else{if(_a>=QX)throw ZX($X);JX(_o,_a++,_e)}return _o.length=_a,_o}});var tQ={},xst=_f,Mst=iS,eQ=BR.f,Ust=U6,nQ=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];tQ.f=function(s){return nQ&&xst(s)=="Window"?function(a){try{return eQ(a)}catch{return Ust(nQ)}}(s):eQ(Mst(s))};var _D={},jst=y0;_D.f=jst;var rQ=IS,Fst=E1,Vst=_D,Bst=Ty.f,m1=function(s){var a=rQ.Symbol||(rQ.Symbol={});Fst(a,s)||Bst(a,s,{value:Vst.f(s)})},sN=a1,n9=Dl,Gst=xy,qst=_d,t3=I0,Wst=Tl,aN=Kp,dO=EN,r9=_,N1=E1,Hst=NP,Kst=Sp,zst=hy,Yst=Cl,i9=_N,o9=$1,Jst=Uy,z4=iS,s9=GS,iQ=dS,a9=Qp,e3=ZT,oQ=wy,Xst=BR,sQ=tQ,c9=ty,aQ=Up,cQ=Ty,Qst=pT,uQ=Cp,$st=k5,u9=lR,n3=O_.exports,lQ=GR,dQ=EO,hQ=y0,Zst=_D,tat=m1,eat=wT,pQ=cR,Y4=rW.forEach,Py=JT("hidden"),J4="Symbol",fQ=hQ("toPrimitive"),nat=pQ.set,gQ=pQ.getterFor(J4),FS=Object.prototype,RR=n9.Symbol,hO=RR&&RR.prototype,mQ=n9.TypeError,l9=n9.QObject,r3=Gst("JSON","stringify"),vQ=aQ.f,wR=cQ.f,EQ=sQ.f,rat=uQ.f,_Q=Wst([].push),VT=n3("symbols"),i3=n3("op-symbols"),d9=n3("string-to-symbol-registry"),h9=n3("symbol-to-string-registry"),iat=n3("wks"),p9=!l9||!l9.prototype||!l9.prototype.findChild,f9=aN&&r9(function(){return e3(wR({},"a",{get:function(){return wR(this,"a",{value:7}).a}})).a!=7})?function(s,a,h){var g=vQ(FS,a);g&&delete FS[a],wR(s,a,h),g&&s!==FS&&wR(FS,a,g)}:wR,g9=function(s,a){var h=VT[s]=e3(hO);return nat(h,{type:J4,tag:s,description:a}),aN||(h.description=a),h},X4=function(s,a,h){s===FS&&X4(i3,a,h),o9(s);var g=s9(a);return o9(h),N1(VT,g)?(h.enumerable?(N1(s,Py)&&s[Py][g]&&(s[Py][g]=!1),h=e3(h,{enumerable:a9(0,!1)})):(N1(s,Py)||wR(s,Py,a9(1,{})),s[Py][g]=!0),f9(s,g,h)):wR(s,g,h)},m9=function(s,a){o9(s);var h=z4(a),g=oQ(h).concat(v9(h));return Y4(g,function(j){aN&&!t3(yQ,h,j)||X4(s,j,h[j])}),s},yQ=function(s){var a=s9(s),h=t3(rat,this,a);return!(this===FS&&N1(VT,a)&&!N1(i3,a))&&(!(h||!N1(this,a)||!N1(VT,a)||N1(this,Py)&&this[Py][a])||h)},bQ=function(s,a){var h=z4(s),g=s9(a);if(h!==FS||!N1(VT,g)||N1(i3,g)){var j=vQ(h,g);return!j||!N1(VT,g)||N1(h,Py)&&h[Py][g]||(j.enumerable=!0),j}},SQ=function(s){var a=EQ(z4(s)),h=[];return Y4(a,function(g){N1(VT,g)||N1(lQ,g)||_Q(h,g)}),h},v9=function(s){var a=s===FS,h=EQ(a?i3:z4(s)),g=[];return Y4(h,function(j){!N1(VT,j)||a&&!N1(FS,j)||_Q(g,VT[j])}),g};if(dO||(u9(hO=(RR=function(){if(Yst(hO,this))throw mQ("Symbol is not a constructor");var s=arguments.length&&arguments[0]!==void 0?iQ(arguments[0]):void 0,a=dQ(s),h=function(g){this===FS&&t3(h,i3,g),N1(this,Py)&&N1(this[Py],a)&&(this[Py][a]=!1),f9(this,a,a9(1,g))};return aN&&p9&&f9(FS,a,{configurable:!0,set:h}),g9(a,s)}).prototype,"toString",function(){return gQ(this).tag}),u9(RR,"withoutSetter",function(s){return g9(dQ(s),s)}),uQ.f=yQ,cQ.f=X4,Qst.f=m9,aQ.f=bQ,Xst.f=sQ.f=SQ,c9.f=v9,Zst.f=function(s){return g9(hQ(s),s)},aN&&wR(hO,"description",{configurable:!0,get:function(){return gQ(this).description}})),sN({global:!0,wrap:!0,forced:!dO,sham:!dO},{Symbol:RR}),Y4(oQ(iat),function(s){tat(s)}),sN({target:J4,stat:!0,forced:!dO},{for:function(s){var a=iQ(s);if(N1(d9,a))return d9[a];var h=RR(a);return d9[a]=h,h9[h]=a,h},keyFor:function(s){if(!i9(s))throw mQ(s+" is not a symbol");if(N1(h9,s))return h9[s]},useSetter:function(){p9=!0},useSimple:function(){p9=!1}}),sN({target:"Object",stat:!0,forced:!dO,sham:!aN},{create:function(s,a){return a===void 0?e3(s):m9(e3(s),a)},defineProperty:X4,defineProperties:m9,getOwnPropertyDescriptor:bQ}),sN({target:"Object",stat:!0,forced:!dO},{getOwnPropertyNames:SQ,getOwnPropertySymbols:v9}),sN({target:"Object",stat:!0,forced:r9(function(){c9.f(1)})},{getOwnPropertySymbols:function(s){return c9.f(Jst(s))}}),r3&&sN({target:"JSON",stat:!0,forced:!dO||r9(function(){var s=RR();return r3([s])!="[null]"||r3({a:s})!="{}"||r3(Object(s))!="{}"})},{stringify:function(s,a,h){var g=$st(arguments),j=a;if((zst(a)||s!==void 0)&&!i9(s))return Hst(a)||(a=function(_e,_n){if(Kst(j)&&(_n=t3(j,this,_e,_n)),!i9(_n))return _n}),g[1]=a,qst(r3,null,g)}}),!hO[fQ]){var oat=hO.valueOf;u9(hO,fQ,function(s){return t3(oat,this)})}eat(RR,J4),lQ[Py]=!0,m1("asyncIterator"),m1("hasInstance"),m1("isConcatSpreadable"),m1("iterator"),m1("match"),m1("matchAll"),m1("replace"),m1("search"),m1("species"),m1("split"),m1("toPrimitive"),m1("toStringTag"),m1("unscopables"),wT(Dl.JSON,"JSON",!0);var sat=IS.Symbol;m1("asyncDispose"),m1("dispose"),m1("matcher"),m1("metadata"),m1("observable"),m1("patternMatch"),m1("replaceAll");var TQ=sat,RQ=_D.f("asyncIterator"),aat=RQ;function wQ(s){this.wrapped=s}function o3(s){var a,h;function g(_e,_n){try{var _o=s[_e](_n),_a=_o.value,_r=_a instanceof wQ;e9.resolve(_r?_a.wrapped:_a).then(function(ba){_r?g(_e==="return"?"return":"next",ba):j(_o.done?"return":"normal",ba)},function(ba){g("throw",ba)})}catch(ba){j("throw",ba)}}function j(_e,_n){switch(_e){case"return":a.resolve({value:_n,done:!0});break;case"throw":a.reject(_n);break;default:a.resolve({value:_n,done:!1})}(a=a.next)?g(a.key,a.arg):h=null}this._invoke=function(_e,_n){return new e9(function(_o,_a){var _r={key:_e,arg:_n,resolve:_o,reject:_a,next:null};h?h=h.next=_r:(a=h=_r,g(_e,_n))})},typeof s.return!="function"&&(this.return=void 0)}function bS(s){return function(){return new o3(s.apply(this,arguments))}}function V0(s){return new wQ(s)}o3.prototype[typeof TQ=="function"&&aat||"@@asyncIterator"]=function(){return this},o3.prototype.next=function(s){return this._invoke("next",s)},o3.prototype.throw=function(s){return this._invoke("throw",s)},o3.prototype.return=function(s){return this._invoke("return",s)};var cat=_D.f("iterator");function s3(s,a){var h={},g=!1;function j(_e,_n){return g=!0,_n=new e9(function(_o){_o(s[_e](_n))}),{done:!1,value:a(_n)}}return h[TQ!==void 0&&cat||"@@iterator"]=function(){return this},h.next=function(_e){return g?(g=!1,_e):j("next",_e)},typeof s.throw=="function"&&(h.throw=function(_e){if(g)throw g=!1,_e;return j("throw",_e)}),typeof s.return=="function"&&(h.return=function(_e){return g?(g=!1,_e):j("return",_e)}),h}var IQ=RQ,K_={exports:{}};function OQ(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function CQ(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?OQ(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):OQ(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}function E9(s,a,h,g,j,_e,_n){let _o=[],_a=[],_r=[],ba=[],xa=!1,El=!1;if(K_.exports.parse(s).mediaDescriptions.forEach(yl=>{_n&&_n!==yl.attributes.direction||(yl.media.mediaType!=="video"||xa||(_a=yl.attributes.payloads,ba=yl.attributes.extmaps,xa=!0),yl.media.mediaType!=="audio"||El||(_o=yl.attributes.payloads,_r=yl.attributes.extmaps,El=!0))}),!ba||_a.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!_r||_o.length===0)throw new Error("Cannot get audio capabilities from SDP.");return _a.forEach(yl=>{var Ol;(Ol=yl.rtpMap)!==null&&Ol!==void 0&&Ol.clockRate&&(yl.rtpMap.clockRate=parseInt(yl.rtpMap.clockRate))}),_o.forEach(yl=>{var Ol;(Ol=yl.rtpMap)!==null&&Ol!==void 0&&Ol.clockRate&&(yl.rtpMap.clockRate=parseInt(yl.rtpMap.clockRate))}),a&&(_o=_o.filter(yl=>{var Ol;return((Ol=yl.rtpMap)===null||Ol===void 0?void 0:Ol.encodingName.toLowerCase())!=="rtx"}),_a=_a.filter(yl=>{var Ol;return((Ol=yl.rtpMap)===null||Ol===void 0?void 0:Ol.encodingName.toLowerCase())!=="rtx"})),h&&(_a=_a.filter(yl=>{var Ol;return!/(red)|(ulpfec)|(flexfec)/i.test(((Ol=yl.rtpMap)===null||Ol===void 0?void 0:Ol.encodingName)||"")})),g&&(_o=_o.filter(yl=>{var Ol;return!/(red)|(ulpfec)|(flexfec)/i.test(((Ol=yl.rtpMap)===null||Ol===void 0?void 0:Ol.encodingName)||"")})),j&&(j==null?void 0:j.length)>0&&(_o=_o.filter(yl=>{var Ol;return j.includes(((Ol=yl.rtpMap)===null||Ol===void 0?void 0:Ol.encodingName.toLowerCase())||"")})),_e&&(_e==null?void 0:_e.length)>0&&(_a=_a.filter(yl=>{var Ol;return _e.includes(((Ol=yl.rtpMap)===null||Ol===void 0?void 0:Ol.encodingName.toLowerCase())||"")})),{audioCodecs:_o,videoCodecs:_a,audioExtensions:_r,videoExtensions:ba}}function pO(s){const a=K_.exports.parse(s);let h,g;for(const j of a.mediaDescriptions){if(!h){const _e=j.attributes.iceUfrag,_n=j.attributes.icePwd;if(!_e||!_n)throw new Error("Cannot get iceUfrag or icePwd from SDP.");h={iceUfrag:_e,icePwd:_n}}if(!g){const _e=j.attributes.fingerprints;_e.length>0&&(g={fingerprints:_e})}}if(!g&&a.attributes.fingerprints.length>0&&(g={fingerprints:a.attributes.fingerprints}),!g||!h)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:h,dtlsParameters:g}}function AQ(s,a){const h=[],g=s.attributes.ssrcGroups.filter(_n=>_n.semantic==="FID"),j=s.attributes.ssrcGroups.find(_n=>_n.semantic==="SIM"),_e=s.attributes.ssrcs;if(j)j.ssrcIds.forEach(_n=>{var _o;const _a=(_o=g.find(_r=>_r.ssrcIds[0]===_n))===null||_o===void 0?void 0:_o.ssrcIds[1];h.push({ssrcId:_n,rtx:a?_a:void 0})});else if(g.length>0){const _n=g[0].ssrcIds[0],_o=g[0].ssrcIds[1];h.push({ssrcId:_n,rtx:a?_o:void 0})}else{if(_e.length===0)throw new Error("No ssrcs found on local media description.");h.push({ssrcId:_e[0].ssrcId})}return h}function NQ(s,a){const{cname:h}=s;let g;a&&a.ip&&typeof a.port=="number"?(g=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:a.ip,port:a.port.toString(),type:"host",extension:{}}],Ll.debug("Using remote candidate from AP ".concat(a.ip,":").concat(a.port)),a.ip6&&(g.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:a.ip6,port:a.port.toString(),type:"host",extension:{}}),Ll.debug("Using IPV6 remote candidate from AP ".concat(a.ip6,":").concat(a.port)))):g=s.iceParameters.candidates.map(_o=>({foundation:_o.foundation,componentId:"1",transport:_o.protocol,priority:_o.priority.toString(),connectionAddress:_o.ip,port:_o.port.toString(),type:_o.type,extension:{}}));const j={fingerprints:s.dtlsParameters.fingerprints.map(_o=>({hashFunction:_o.algorithm,fingerprint:_o.fingerprint}))},_e={iceUfrag:s.iceParameters.iceUfrag,icePwd:s.iceParameters.icePwd};let _n;switch(s.dtlsParameters.role){case"server":_n="passive";break;case"client":_n="active";break;case"auto":_n="actpass"}return{dtlsParameters:j,iceParameters:_e,candidates:g,rtpCapabilities:b9(s.rtpCapabilities),setup:_n,cname:h}}function Zy(s,a,h){const g=[],j=[];return s.forEach(_e=>{let{ssrcId:_n,rtx:_o}=_e;const _a=N_(8,"track-"),_r={ssrcId:_n,attributes:CQ({label:_a,mslabel:h=h||N_(10,""),msid:"".concat(h," ").concat(_a)},a&&{cname:a})};if(g.push(_r),_o!==void 0){const ba={ssrcId:_o,attributes:CQ({label:_a,mslabel:h,msid:"".concat(h," ").concat(_a)},a&&{cname:a})};g.push(ba),j.push({semantic:"FID",ssrcIds:[_n,_o]})}}),s.length>1&&j.push({semantic:"SIM",ssrcIds:s.map(_e=>{let{ssrcId:_n}=_e;return _n})}),{ssrcs:g,ssrcGroups:j}}function cN(s,a){a instanceof C1&&s.attributes.payloads.forEach(h=>{var g;const j=(g=h.rtpMap)===null||g===void 0?void 0:g.encodingName.toLowerCase();if(!j||["opus","pcmu","pcma","g722"].indexOf(j)===-1)return;h.fmtp||(h.fmtp={parameters:{}}),h.fmtp.parameters.minptime="10",h.fmtp.parameters.useinbandfec="1";const _e=a._encoderConfig;_e&&j!=="pcmu"&&j!=="pcma"&&j!=="g722"&&(_e.bitrate&&!M_()&&(h.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*_e.bitrate))),_e.sampleRate&&(h.fmtp.parameters.maxplaybackrate="".concat(_e.sampleRate),h.fmtp.parameters["sprop-maxcapturerate"]="".concat(_e.sampleRate)),_e.stereo&&(h.fmtp.parameters.stereo="1",h.fmtp.parameters["sprop-stereo"]="1"))})}function _9(s){const a=s.attributes.unrecognized.findIndex(h=>h.attField==="x-google-flag"&&h.attValue==="conference");a!==-1&&s.attributes.unrecognized.splice(a,1)}function y9(s,a){if(!(a instanceof H_&&a._encoderConfig&&a._hints.indexOf(c1.SCREEN_TRACK)===-1))return;const h=a._encoderConfig;O1().supportMinBitrate&&h.bitrateMin&&s.attributes.payloads.forEach(g=>{var j;["h264","vp8","vp9","av1"].includes(((j=g.rtpMap)===null||j===void 0?void 0:j.encodingName.toLowerCase())||"")&&(g.fmtp||(g.fmtp={parameters:{}}),g.fmtp.parameters["x-google-min-bitrate"]="".concat(h.bitrateMin))}),O1().supportMinBitrate&&!a._hints.includes(c1.LOW_STREAM)&&h.bitrateMax&&s.attributes.payloads.forEach(g=>{var j;["h264","vp8","vp9","av1"].includes(((j=g.rtpMap)===null||j===void 0?void 0:j.encodingName.toLowerCase())||"")&&(g.fmtp||(g.fmtp={parameters:{}}),g.fmtp.parameters["x-google-start-bitrate"]="".concat(wp("X_GOOGLE_START_BITRATE")||Math.floor(h.bitrateMax)))})}function kQ(s){if(s.media.mediaType!=="video")return;const a=p_();if(a.name!==u_.SAFARI&&a.os!==_1.IOS)return;const h=s.attributes.extmaps.findIndex(g=>/video-orientation/g.test(g.extensionName));h!==-1&&s.attributes.extmaps.splice(h,1)}function Q4(s,a,h){if(!a)return;let g,j;if(s.media.mediaType==="video"?(g=h.videoExtensions,j=h.videoCodecs):(g=h.audioExtensions,j=h.audioCodecs),a.tcc===!0){const _e=g.find(_n=>_n.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");_e&&(s.attributes.extmaps.find(_n=>_n.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")||s.attributes.extmaps.push({entry:_e.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(_n,_o){return _o.filter(_a=>!!_n.find(_r=>_r.payloadType===_a.payloadType&&!!_r.rtcpFeedbacks.find(ba=>ba.type==="transport-cc")))}(j,s.attributes.payloads).forEach(_n=>{_n.rtcpFeedbacks.find(_o=>_o.type==="transport-cc")||_n.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(a.tcc===!1){const _e=s.attributes.extmaps.findIndex(_n=>_n.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");_e!==-1&&s.attributes.extmaps.splice(_e,1),s.attributes.payloads.forEach(_n=>{const _o=_n.rtcpFeedbacks.findIndex(_a=>_a.type==="transport-cc");_o!==-1&&_n.rtcpFeedbacks.splice(_o,1)})}if(a.remb===!0){const _e=g.find(_n=>_n.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");_e&&(s.attributes.extmaps.find(_n=>_n.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time")||s.attributes.extmaps.push({entry:_e.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(_n,_o){return _o.filter(_a=>!!_n.find(_r=>_r.payloadType===_a.payloadType&&!!_r.rtcpFeedbacks.find(ba=>ba.type==="goog-remb")))}(j,s.attributes.payloads).forEach(_n=>{_n.rtcpFeedbacks.find(_o=>_o.type==="goog-remb")||_n.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(a.remb===!1){const _e=s.attributes.extmaps.findIndex(_n=>_n.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");_e!==-1&&s.attributes.extmaps.splice(_e,1),s.attributes.payloads.forEach(_n=>{const _o=_n.rtcpFeedbacks.findIndex(_a=>_a.type==="goog-remb");_o!==-1&&_n.rtcpFeedbacks.splice(_o,1)})}}function LQ(s,a,h){if(M_()||s.media.mediaType!=="video"||!(a instanceof H_)||h!=="vp9"&&h!=="vp8"||h==="vp8"&&!wp("SIMULCAST")||a._scalabiltyMode===void 0||a._scalabiltyMode.numSpatialLayers<=1)return;const g=h==="vp8"?2:a._scalabiltyMode.numSpatialLayers,j=s.attributes.ssrcs[0],_e=s.attributes.ssrcGroups.find(_o=>_o.semantic==="FID"&&_o.ssrcIds[0]===j.ssrcId),_n={semantic:"SIM",ssrcIds:[j.ssrcId]};for(let _o=1;_o<g;_o++)s.attributes.ssrcs.push({ssrcId:j.ssrcId+_o,attributes:W_(j.attributes)}),_n.ssrcIds.push(j.ssrcId+_o),_e&&(s.attributes.ssrcs.push({ssrcId:_e.ssrcIds[1]+_o,attributes:W_(j.attributes)}),s.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[j.ssrcId+_o,_e.ssrcIds[1]+_o]}));s.attributes.ssrcGroups.unshift(_n)}async function PQ(s,a,h,g,j){const _e=new RTCPeerConnection;_e.addTransceiver("video",{direction:"sendonly"}),_e.addTransceiver("audio",{direction:"sendonly"}),_e.addTransceiver("video",{direction:"recvonly"}),_e.addTransceiver("audio",{direction:"recvonly"});const _n=(await _e.createOffer()).sdp,_o=E9(_n,s,a,h,g,j,"sendonly"),_a=E9(_n,s,a,h,g,j,"recvonly"),_r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},ba={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},xa={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if($4(_o,_a,"videoExtensions",_r,ba,xa),$4(_o,_a,"videoCodecs",_r,ba,xa),$4(_o,_a,"audioExtensions",_r,ba,xa),$4(_o,_a,"audioCodecs",_r,ba,xa),wp("RAISE_H264_BASELINE_PRIORITY")){const El=xa.videoCodecs.findIndex(yl=>{var Ol,Al;return((Ol=yl.rtpMap)===null||Ol===void 0?void 0:Ol.encodingName.toLocaleLowerCase())==="h264"&&((Al=yl.fmtp)===null||Al===void 0?void 0:Al.parameters["profile-level-id"])==="42001f"});if(El!==-1){const yl=xa.videoCodecs.findIndex(Ol=>{var Al;return((Al=Ol.rtpMap)===null||Al===void 0?void 0:Al.encodingName.toLocaleLowerCase())==="h264"});if(yl<El){Ll.debug("raising H264 baseline profile priority");const Ol=xa.videoCodecs[El];xa.videoCodecs.splice(El,1),xa.videoCodecs.splice(yl,0,Ol)}yl!==-1&&(ba.videoCodecs=ba.videoCodecs.filter(Ol=>{var Al,Nl;return!(((Al=Ol.rtpMap)===null||Al===void 0?void 0:Al.encodingName.toLocaleLowerCase())==="h264"&&((Nl=Ol.fmtp)===null||Nl===void 0?void 0:Nl.parameters["profile-level-id"])!=="42001f")})),yl!==-1&&wp("FILTER_SEND_H264_BASELINE")&&(_r.videoCodecs=_r.videoCodecs.filter(Ol=>{var Al,Nl;return!(((Al=Ol.rtpMap)===null||Al===void 0?void 0:Al.encodingName.toLocaleLowerCase())==="h264"&&((Nl=Ol.fmtp)===null||Nl===void 0?void 0:Nl.parameters["profile-level-id"])!=="42001f")}))}}try{_e.close()}catch{}return{send:_r,recv:ba,sendrecv:xa}}function $4(s,a,h,g,j,_e){if(h==="videoExtensions"||h==="audioExtensions"){const _n=[];return s[h].forEach(_o=>{a[h].some((_a,_r)=>{if(_o.entry===_a.entry&&_o.extensionName===_a.extensionName)return _n.push(_r),!0})?_e[h].push(_o):g[h].push(_o)}),void a[h].forEach((_o,_a)=>{_n.indexOf(_a)===-1&&j[h].push(_o)})}if(h==="videoCodecs"||h==="audioCodecs"){const _n=[];return s[h].forEach(_o=>{a[h].some((_a,_r)=>{if(_o.payloadType===_a.payloadType&&JSON.stringify(_o)===JSON.stringify(_a))return _n.push(_r),!0})?_e[h].push(_o):g[h].push(_o)}),void a[h].forEach((_o,_a)=>{_n.indexOf(_a)===-1&&j[h].push(_o)})}}function b9(s){const{send:a,recv:h,sendrecv:g}=s;if(!g){if(!a||!h)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:a,recv:h}}let j,_e;return a?(j={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},j.audioCodecs=[...a.audioCodecs,...g.audioCodecs],j.videoCodecs=[...a.videoCodecs,...g.videoCodecs],j.audioExtensions=[...a.audioExtensions,...g.audioExtensions],j.videoExtensions=[...a.videoExtensions,...g.videoExtensions]):j=g,h?(_e={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_e.audioCodecs=[...h.audioCodecs,...g.audioCodecs],_e.videoCodecs=[...h.videoCodecs,...g.videoCodecs],_e.audioExtensions=[...h.audioExtensions,...g.audioExtensions],_e.videoExtensions=[...h.videoExtensions,...g.videoExtensions]):_e=g,{send:j,recv:_e}}function IR(s){s.media.mediaType==="audio"&&s.attributes.payloads.filter(a=>{var h;return((h=a.rtpMap)===null||h===void 0?void 0:h.encodingName.toLowerCase())==="opus"}).forEach(a=>{a.fmtp||(a.fmtp={parameters:{}}),a.fmtp.parameters.stereo="1",a.fmtp.parameters["sprop-stereo"]="1"})}(function(s,a){s.exports=(()=>{var h={8:(_e,_n,_o)=>{_o.r(_n),_o.d(_n,{Parser:()=>h0,Printer:()=>Lp,parse:()=>_v,print:()=>f0});const _a=`
`,_r="".concat("\r").concat(_a),ba=" ";let xa;function El(zp){return zp>="0"&&zp<="9"}function yl(zp){return zp>="!"&&zp<="~"}function Ol(zp){return yl(zp)||zp>=""&&zp<=""}function Al(zp){return zp==="!"||zp>="#"&&zp<="'"||zp>="*"&&zp<="+"||zp>="-"&&zp<="."||zp>="0"&&zp<="9"||zp>="A"&&zp<="Z"||zp>="^"&&zp<="~"}function Nl(zp){return zp>="1"&&zp<="9"}function Ml(zp){return zp>="A"&&zp<="Z"||zp>="a"&&zp<="z"}function Fl(zp){return zp==="d"||zp==="h"||zp==="m"||zp==="s"}function up(zp){return zp>""&&zp<"	"||zp>"\v"&&zp<"\f"||zp>""&&zp<""}function _p(zp){return Ml(zp)||El(zp)||zp==="+"||zp==="/"}function Tp(zp){return El(zp)||Ml(zp)||zp==="+"||zp==="/"||zp==="-"||zp==="_"}function Fp(zp){return Ml(zp)||El(zp)||zp==="+"||zp==="/"}function Ap(zp,Il){var Gl=Object.keys(zp);if(Object.getOwnPropertySymbols){var _h=Object.getOwnPropertySymbols(zp);Il&&(_h=_h.filter(function(Pp){return Object.getOwnPropertyDescriptor(zp,Pp).enumerable})),Gl.push.apply(Gl,_h)}return Gl}function Xp(zp){for(var Il=1;Il<arguments.length;Il++){var Gl=arguments[Il]!=null?arguments[Il]:{};Il%2?Ap(Object(Gl),!0).forEach(function(_h){_g(zp,_h,Gl[_h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(zp,Object.getOwnPropertyDescriptors(Gl)):Ap(Object(Gl)).forEach(function(_h){Object.defineProperty(zp,_h,Object.getOwnPropertyDescriptor(Gl,_h))})}return zp}function _g(zp,Il,Gl){return Il in zp?Object.defineProperty(zp,Il,{value:Gl,enumerable:!0,configurable:!0,writable:!0}):zp[Il]=Gl,zp}(function(zp){zp.VERSION="v",zp.ORIGIN="o",zp.SESSION_NAME="s",zp.INFORMATION="i",zp.URI="u",zp.EMAIL="e",zp.PHONE="p",zp.CONNECTION="c",zp.BANDWIDTH="b",zp.TIME="t",zp.REPEAT="r",zp.ZONE_ADJUSTMENTS="z",zp.KEY="k",zp.ATTRIBUTE="a",zp.MEDIA="m"})(xa||(xa={}));class Yp{consumeText(Il,Gl){let _h=Gl;for(;_h<Il.length;){const Pp=Il[_h];if(Pp==="\0"||Pp==="\r"||Pp===_a)break;_h+=1}if(_h-Gl==0)throw new Error("Invalid text, at ".concat(Il));return _h}consumeUnicastAddress(Il,Gl,_h){return this.consumeTill(Il,Gl,ba)}consumeOneOrMore(Il,Gl,_h){let Pp=Gl;for(;_h(Il[Pp]);)Pp++;if(Pp-Gl==0)throw new Error("Invalid rule at ".concat(Gl,"."));return Pp}consumeSpace(Il,Gl){if(Il[Gl]===ba)return Gl+1;throw new Error("Invalid space at ".concat(Gl,"."))}consumeIP4Address(Il,Gl){let _h=Gl;for(let Pp=0;Pp<4;Pp++)if(_h=this.consumeDecimalUChar(Il,_h),Pp!==3){if(Il[_h]!==".")throw new Error("Invalid IP4 address.");_h++}return _h}consumeDecimalUChar(Il,Gl){let _h=Gl;for(let m0=0;m0<3&&El(Il[_h]);m0++,_h++);if(_h-Gl==0)throw new Error("Invalid decimal uchar.");const Pp=parseInt(Il.slice(Gl,_h));if(Pp>=0&&Pp<=255)return _h;throw new Error("Invalid decimal uchar")}consumeIP6Address(Il,Gl){let _h=this.consumeHexpart(Il,Gl);return Il[_h]===":"&&(_h+=1,_h=this.consumeIP4Address(Il,_h)),_h}consumeHexpart(Il,Gl){let _h=Gl;if(Il[_h]===":"&&Il[_h+1]===":"){_h+=2;try{_h=this.consumeHexseq(Il,_h)}catch{}return _h}if(_h=this.consumeHexseq(Il,_h),Il[_h]===":"&&Il[_h+1]===":"){_h+=2;try{_h=this.consumeHexseq(Il,_h)}catch{}return _h}return _h}consumeHexseq(Il,Gl){let _h=Gl;for(;_h=this.consumeHex4(Il,_h),Il[_h]===":"&&Il[_h+1]!==":";)_h+=1;return _h}consumeHex4(Il,Gl){let _h=0;for(;_h<4;_h++)if(!((Pp=Il[Gl+_h])>="0"&&Pp<="9"||Pp>="a"&&Pp<="f"||Pp>="A"&&Pp<="F")){if(_h===0)throw new Error("Invalid hex 4");break}var Pp;return Gl+_h}consumeFQDN(Il,Gl){let _h=Gl;for(;El(Il[_h])||Ml(Il[_h])||Il[_h]==="-"||Il[_h]===".";)_h+=1;if(_h-Gl<4)throw new Error("Invalid FQDN");return _h}consumeExtnAddr(Il,Gl){return this.consumeOneOrMore(Il,Gl,Ol)}consumeMulticastAddress(Il,Gl,_h){switch(_h){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(Il,Gl);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(Il,Gl);default:try{return this.consumeFQDN(Il,Gl)}catch{return this.consumeExtnAddr(Il,Gl)}}}consumeIP6MulticastAddress(Il,Gl){const _h=this.consumeHexpart(Il,Gl);return Il[_h]==="/"?this.consumeInteger(Il,_h+1):_h}consumeIP4MulticastAddress(Il,Gl){let _h=Gl+3;const Pp=Il.slice(Gl,_h),m0=parseInt(Pp);if(m0<224||m0>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let Q0=0;Q0<3;Q0++){if(Il[_h]!==".")throw new Error("Invalid IP4 multicast address.");_h+=1,_h=this.consumeDecimalUChar(Il,_h)}return Il[_h]==="/"&&(_h+=1),_h=this.consumeTTL(Il,_h),Il[_h]==="/"&&(_h=this.consumeInteger(Il,_h)),_h}consumeInteger(Il,Gl){if(!Nl(Il[Gl]))throw new Error("Invalid integer.");for(Gl+=1;El(Il[Gl]);)Gl+=1;return Gl}consumeTTL(Il,Gl){if(Il[Gl]==="0")return Gl+1;if(!Nl(Il[Gl]))throw new Error("Invalid TTL.");Gl+=1;for(let _h=0;_h<2&&El(Il[Gl]);_h++)Gl+=1;return Gl}consumeToken(Il,Gl){return this.consumeOneOrMore(Il,Gl,Al)}consumeTime(Il,Gl){let _h=Gl;if(Il[_h]==="0")return _h+1;for(Nl(Il[_h])&&(_h+=1);El(Il[_h]);)_h++;if(_h-Gl<10)throw new Error("Invalid time");return _h}consumeAddress(Il,Gl){return this.consumeTill(Il,Gl,ba)}consumeTypedTime(Il,Gl){let _h=Gl;return _h=this.consumeOneOrMore(Il,_h,El),Fl(Il[_h])?_h+1:_h}consumeRepeatInterval(Il,Gl){if(!Nl(Il[Gl]))throw new Error("Invalid repeat interval");for(Gl+=1;El(Il[Gl]);)Gl+=1;return Fl(Il[Gl])&&(Gl+=1),Gl}consumePort(Il,Gl){return this.consumeOneOrMore(Il,Gl,El)}consume(Il,Gl,_h){for(let Pp=0;Pp<_h.length;Pp++){if(Gl+Pp>=Il.length)throw new Error("consume exceeding value length");if(Il[Gl+Pp]!==_h[Pp])throw new Error("consume ".concat(_h," failed at ").concat(Pp))}return Gl+_h.length}consumeTill(Il,Gl,_h){let Pp=Gl;for(;Pp<Il.length&&(typeof _h!="string"||Il[Pp]!==_h)&&(typeof _h!="function"||!_h(Il[Pp]));)Pp++;return Pp}}class h0 extends Yp{constructor(){super(),_g(this,"records",[]),_g(this,"currentLine",0)}parse(Il){const Gl=this.probeEOL(Il);this.records=Il.split(Gl).filter(nS=>!!nS.trim()).map(this.parseLine),this.currentLine=0;const _h=this.parseVersion(),Pp=this.parseOrigin(),m0=this.parseSessionName(),Q0=this.parseInformation(),h_=this.parseUri(),e_=this.parseEmail(),$_=this.parsePhone(),q0=this.parseConnection(),E_=this.parseBandWidth(),X0=this.parseTimeFields(),Q1=this.parseKey(),$0=this.parseSessionAttribute(),v_=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:_h,origin:Pp,sessionName:m0,information:Q0,uri:h_,emails:e_,phones:$_,connection:q0,bandwidths:E_,timeFields:X0,key:Q1,attributes:$0,mediaDescriptions:v_}}getCurrentRecord(){const Il=this.records[this.currentLine];if(!Il)throw new Error("Record doesn't exit.");return Il}probeEOL(Il){for(let Gl=0;Gl<Il.length;Gl++)if(Il[Gl]===_a)return Il[Gl-1]==="\r"?_r:_a;throw new Error("Invalid newline character.")}parseLine(Il,Gl){if(Il.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const _h=Il[0];if(Il[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:_h,value:Il.slice(2),line:Gl,cur:0}}parseSessionAttribute(){const Il=new A0;for(;this.currentLine<this.records.length;){const Gl=this.getCurrentRecord();if(Gl.type!==xa.ATTRIBUTE)break;const _h={attField:this.extractOneOrMore(Gl,Pp=>Al(Pp)&&Pp!==":"),_cur:0};Gl.value[Gl.cur]===":"&&(Gl.cur+=1,_h.attValue=this.extractOneOrMore(Gl,up)),Il.parse(_h),this.currentLine++}return Il.digest()}parseMediaAttributes(Il){const Gl=new _E(Il);for(;this.currentLine<this.records.length;){const _h=this.getCurrentRecord();if(_h.type!==xa.ATTRIBUTE)break;const Pp={attField:this.extractOneOrMore(_h,m0=>Al(m0)&&m0!==":"),_cur:0};_h.value[_h.cur]===":"&&(_h.cur+=1,Pp.attValue=this.extractOneOrMore(_h,up)),Gl.parse(Pp),this.currentLine++}return Gl.digest()}parseKey(){const Il=this.getCurrentRecord();if(Il.type===xa.KEY){if(Il.value==="prompt"||Il.value==="clear:"||Il.value==="base64:"||Il.value==="uri:")return Il.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const Il=this.getCurrentRecord();if(Il.type===xa.ZONE_ADJUSTMENTS){const Gl=[];for(;;)try{const _h=this.extract(Il,this.consumeTime);this.consumeSpaceForRecord(Il);let Pp=!1;Il.value[Il.cur]==="-"&&(Pp=!0,Il.cur+=1);const m0=this.extract(Il,this.consumeTypedTime);Gl.push({time:_h,typedTime:m0,back:Pp})}catch{break}if(Gl.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,Gl}return[]}parseRepeat(){const Il=[];for(;;){const Gl=this.getCurrentRecord();if(Gl.type!==xa.REPEAT)break;{const _h=this.extract(Gl,this.consumeRepeatInterval),Pp=this.parseTypedTime(Gl);Il.push({repeatInterval:_h,typedTimes:Pp}),this.currentLine++}}return Il}parseTypedTime(Il){const Gl=[];for(;;)try{this.consumeSpaceForRecord(Il),Gl.push(this.extract(Il,this.consumeTypedTime))}catch{break}if(Gl.length===0)throw new Error("Invalid typed time.");return Gl}parseTime(){const Il=this.getCurrentRecord(),Gl=this.extract(Il,this.consumeTime);this.consumeSpaceForRecord(Il);const _h=this.extract(Il,this.consumeTime);return this.currentLine++,{startTime:Gl,stopTime:_h}}parseBandWidth(){const Il=[];for(;this.currentLine<this.records.length;){const Gl=this.getCurrentRecord();if(Gl.type!==xa.BANDWIDTH)break;{const _h=this.extractOneOrMore(Gl,Al);if(Gl.value[Gl.cur]!==":")throw new Error("Invalid bandwidth field.");Gl.cur++;const Pp=this.extractOneOrMore(Gl,El);Il.push({bwtype:_h,bandwidth:Pp}),this.currentLine++}}return Il}parseVersion(){const Il=this.getCurrentRecord();if(Il.type!==xa.VERSION)throw new Error("first sdp record must be version");const Gl=Il.value.slice(0,this.consumeOneOrMore(Il.value,0,El));if(Gl.length!==Il.value.length)throw new Error('invalid proto version, "v='.concat(Il.value,'"'));return this.currentLine++,Gl}parseOrigin(){const Il=this.getCurrentRecord();if(Il.type!==xa.ORIGIN)throw new Error("second line of sdp must be origin");const Gl=this.extractOneOrMore(Il,Ol);this.consumeSpaceForRecord(Il);const _h=this.extractOneOrMore(Il,El);this.consumeSpaceForRecord(Il);const Pp=this.extractOneOrMore(Il,El);this.consumeSpaceForRecord(Il);const m0=this.extractOneOrMore(Il,Al);this.consumeSpaceForRecord(Il);const Q0=this.extractOneOrMore(Il,Al);this.consumeSpaceForRecord(Il);const h_=this.extract(Il,this.consumeUnicastAddress);return this.currentLine++,{username:Gl,sessId:_h,sessVersion:Pp,nettype:m0,addrtype:Q0,unicastAddress:h_}}parseSessionName(){const Il=this.getCurrentRecord();if(Il.type===xa.SESSION_NAME){const Gl=this.extract(Il,this.consumeText);return this.currentLine++,Gl}}parseInformation(){const Il=this.getCurrentRecord();if(Il.type!==xa.INFORMATION)return;const Gl=this.extract(Il,this.consumeText);return this.currentLine++,Gl}parseUri(){const Il=this.getCurrentRecord();if(Il.type===xa.URI)return this.currentLine++,Il.value}parseEmail(){const Il=[];for(;;){const Gl=this.getCurrentRecord();if(Gl.type!==xa.EMAIL)break;Il.push(Gl.value),this.currentLine++}return Il}parsePhone(){const Il=[];for(;;){const Gl=this.getCurrentRecord();if(Gl.type!==xa.PHONE)break;Il.push(Gl.value),this.currentLine++}return Il}parseConnection(){const Il=this.getCurrentRecord();if(Il.type===xa.CONNECTION){const Gl=this.extractOneOrMore(Il,Al);this.consumeSpaceForRecord(Il);const _h=this.extractOneOrMore(Il,Al);this.consumeSpaceForRecord(Il);const Pp=this.extract(Il,this.consumeAddress);return this.currentLine++,{nettype:Gl,addrtype:_h,address:Pp}}}parseMedia(){const Il=this.getCurrentRecord(),Gl=this.extract(Il,this.consumeToken);this.consumeSpaceForRecord(Il);let _h=this.extract(Il,this.consumePort);Il.value[Il.cur]==="/"&&(Il.cur+=1,_h+=this.extract(Il,this.consumeInteger)),this.consumeSpaceForRecord(Il);const Pp=[];for(Pp.push(this.extract(Il,this.consumeToken));Il.value[Il.cur]==="/";)Il.cur+=1,Pp.push(this.extract(Il,this.consumeToken));if(Pp.length===0)throw new Error("Invalid proto");const m0=this.parseFmt(Il);return this.currentLine++,{mediaType:Gl,port:_h,protos:Pp,fmts:m0}}parseTimeFields(){const Il=[];for(;this.getCurrentRecord().type===xa.TIME;){const Gl=this.parseTime(),_h=this.parseRepeat(),Pp=this.parseZone();Il.push({time:Gl,repeats:_h,zones:Pp})}return Il}parseMediaDescription(){const Il=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===xa.MEDIA;){const Gl=this.parseMedia(),_h=this.parseInformation(),Pp=this.parseConnections(),m0=this.parseBandWidth(),Q0=this.parseKey(),h_=this.parseMediaAttributes(Gl);Il.push({media:Gl,information:_h,connections:Pp,bandwidths:m0,key:Q0,attributes:h_})}return Il}parseConnections(){const Il=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===xa.CONNECTION;)Il.push(this.parseConnection());return Il}parseFmt(Il){const Gl=[];for(;;)try{this.consumeSpaceForRecord(Il),Gl.push(this.extract(Il,this.consumeToken))}catch{break}if(Gl.length===0)throw new Error("Invalid fmts");return Gl}extract(Il,Gl,..._h){const Pp=Gl.call(this,Il.value,Il.cur,..._h),m0=Il.value.slice(Il.cur,Pp);return Il.cur=Pp,m0}extractOneOrMore(Il,Gl){const _h=this.consumeOneOrMore(Il.value,Il.cur,Gl),Pp=Il.value.slice(Il.cur,_h);return Il.cur=_h,Pp}consumeSpaceForRecord(Il){if(Il.value[Il.cur]!==ba)throw new Error("Invalid space at ".concat(Il.cur,"."));Il.cur+=1}}class E0 extends Yp{constructor(...Il){super(...Il),_g(this,"attributes",void 0),_g(this,"digested",!1)}extractOneOrMore(Il,Gl,_h){const Pp=this.consumeOneOrMore(Il.attValue,Il._cur,Gl),m0=Il.attValue.slice(Il._cur,Pp),[Q0,h_]=_h||[];if(typeof Q0=="number"&&m0.length<Q0)throw new Error("error in length, should be more or equal than ".concat(Q0," characters."));if(typeof h_=="number"&&m0.length>h_)throw new Error("error in length, should be less or equal than ".concat(h_," characters."));return Il._cur=Pp,m0}consumeAttributeSpace(Il){if(Il.attValue[Il._cur]!==ba)throw new Error("Invalid space at ".concat(Il._cur,"."));Il._cur+=1}extract(Il,Gl,..._h){if(!Il.attValue)throw new Error("Nothing to extract from attValue.");const Pp=Gl.call(this,Il.attValue,Il._cur,..._h),m0=Il.attValue.slice(Il._cur,Pp);return Il._cur=Pp,m0}atEnd(Il){if(!Il.attValue)throw new Error;return Il._cur>=Il.attValue.length}peekChar(Il){if(!Il.attValue)throw new Error;return Il.attValue[Il._cur]}peek(Il,Gl){if(!Il.attValue)throw new Error;for(let _h=0;_h<Gl.length;_h++)if(Gl[_h]!==Il.attValue[Il._cur+_h])return!1;return!0}parseIceUfrag(Il){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(Il,_p,[4,256])}parseIcePwd(Il){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(Il,_p,[22,256])}parseIceOptions(Il){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const Gl=[];for(;!this.atEnd(Il);){Gl.push(this.extractOneOrMore(Il,_p));try{this.consumeAttributeSpace(Il)}catch(_h){if(this.atEnd(Il))break;throw _h}}this.attributes.iceOptions=Gl}parseFingerprint(Il){const Gl=this.extract(Il,this.consumeToken);this.consumeAttributeSpace(Il);const _h=this.extract(Il,this.consumeTill);this.attributes.fingerprints.push({hashFunction:Gl,fingerprint:_h})}parseExtmap(Il){const Gl=this.extractOneOrMore(Il,El);let _h;this.peekChar(Il)==="/"&&(this.extract(Il,this.consume,"/"),_h=this.extract(Il,this.consumeToken)),this.consumeAttributeSpace(Il);const Pp=this.extract(Il,this.consumeTill,ba),m0=Xp(Xp({entry:parseInt(Gl,10)},_h&&{direction:_h}),{},{extensionName:Pp});this.peekChar(Il)===ba&&(this.consumeAttributeSpace(Il),m0.extensionAttributes=this.extract(Il,this.consumeTill)),this.attributes.extmaps.push(m0)}parseSetup(Il){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const Gl=this.extract(Il,this.consumeTill);if(Gl!=="active"&&Gl!=="passive"&&Gl!=="actpass"&&Gl!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=Gl}}class A0 extends E0{constructor(...Il){super(...Il),_g(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(Il){if(this.digested)throw new Error("already digested");try{switch(Il.attField){case"group":this.parseGroup(Il);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(Il);break;case"ice-pwd":this.parseIcePwd(Il);break;case"ice-options":this.parseIceOptions(Il);break;case"fingerprint":this.parseFingerprint(Il);break;case"setup":this.parseSetup(Il);break;case"tls-id":this.parseTlsId(Il);break;case"identity":this.parseIdentity(Il);break;case"extmap":this.parseExtmap(Il);break;case"msid-semantic":this.parseMsidSemantic(Il);break;default:Il.ignored=!0,this.attributes.unrecognized.push(Il)}}catch(Gl){throw console.error("parsing session attribute ".concat(Il.attField,' error, "a=').concat(Il.attField,":").concat(Il.attValue,'"')),Gl}if(!Il.ignored&&Il.attValue&&!this.atEnd(Il))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(Il){const Gl=this.extract(Il,this.consumeToken),_h=[];for(;!this.atEnd(Il)&&this.peekChar(Il)===ba;)this.consumeAttributeSpace(Il),_h.push(this.extract(Il,this.consumeToken));this.attributes.groups.push({semantic:Gl,identificationTag:_h})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(Il){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(Il,Tp)}parseIdentity(Il){const Gl=this.extractOneOrMore(Il,Fp),_h=[];for(;!this.atEnd(Il)&&this.peekChar(Il)===ba;){this.consumeAttributeSpace(Il);const Pp=this.extract(Il,this.consumeToken);this.extract(Il,this.consume,"=");const m0=this.extractOneOrMore(Il,Q0=>Q0!==ba&&up(Q0));_h.push({name:Pp,value:m0})}this.attributes.identities.push({assertionValue:Gl,extensions:_h})}parseMsidSemantic(Il){this.peekChar(Il)===ba&&this.consumeAttributeSpace(Il);const Gl={semantic:this.extract(Il,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(Il)}catch{break}if(this.peekChar(Il)==="*"){this.extract(Il,this.consume,"*"),Gl.applyForAll=!0;break}{const _h=this.extract(Il,this.consumeTill,ba);Gl.identifierList.push(_h)}}this.attributes.msidSemantic=Gl}}class _E extends E0{constructor(Il){super(),_g(this,"attributes",void 0),Il.protos.indexOf("RTP")!==-1||Il.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(Il){if(this.digested)throw new Error("already digested");try{switch(Il.attField){case"extmap":this.parseExtmap(Il);break;case"setup":this.parseSetup(Il);break;case"ice-ufrag":this.parseIceUfrag(Il);break;case"ice-pwd":this.parseIcePwd(Il);break;case"ice-options":this.parseIceOptions(Il);break;case"candidate":this.parseCandidate(Il);break;case"remote-candidate":this.parseRemoteCandidate(Il);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(Il);break;case"rtpmap":this.parseRtpmap(Il);break;case"ptime":this.parsePtime(Il);break;case"maxptime":this.parseMaxPtime(Il);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(Il);break;case"ssrc":this.parseSSRC(Il);break;case"fmtp":this.parseFmtp(Il);break;case"rtcp-fb":this.parseRtcpFb(Il);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(Il);break;case"mid":this.parseMid(Il);break;case"msid":this.parseMsid(Il);break;case"imageattr":this.parseImageAttr(Il);break;case"rid":this.parseRid(Il);break;case"simulcast":this.parseSimulcast(Il);break;case"sctp-port":this.parseSctpPort(Il);break;case"max-message-size":this.parseMaxMessageSize(Il);break;case"ssrc-group":this.parseSSRCGroup(Il);break;default:Il.ignored=!0,this.attributes.unrecognized.push(Il)}}catch(Gl){throw console.error("parsing media attribute ".concat(Il.attField,' error, "a=').concat(Il.attField,":").concat(Il.attValue,'"')),Gl}if(!Il.ignored&&Il.attValue&&!this.atEnd(Il))throw new Error("attribute parsing error")}parseCandidate(Il){const Gl=this.extractOneOrMore(Il,_p,[1,32]);this.consumeAttributeSpace(Il);const _h=this.extractOneOrMore(Il,El,[1,5]);this.consumeAttributeSpace(Il);const Pp=this.extract(Il,this.consumeToken);this.consumeAttributeSpace(Il);const m0=this.extractOneOrMore(Il,El,[1,10]);this.consumeAttributeSpace(Il);const Q0=this.extract(Il,this.consumeAddress);this.consumeAttributeSpace(Il);const h_=this.extract(Il,this.consumePort);this.consumeAttributeSpace(Il),this.extract(Il,this.consume,"typ"),this.consumeAttributeSpace(Il);const e_={foundation:Gl,componentId:_h,transport:Pp,priority:m0,connectionAddress:Q0,port:h_,type:this.extract(Il,this.consumeToken),extension:{}};for(this.peek(Il," raddr")&&(this.extract(Il,this.consume," raddr"),this.consumeAttributeSpace(Il),e_.relAddr=this.extract(Il,this.consumeAddress)),this.peek(Il," rport")&&(this.extract(Il,this.consume," rport"),this.consumeAttributeSpace(Il),e_.relPort=this.extract(Il,this.consumePort));this.peekChar(Il)===ba;){this.consumeAttributeSpace(Il);const $_=this.extract(Il,this.consumeToken);this.consumeAttributeSpace(Il),e_.extension[$_]=this.extractOneOrMore(Il,yl)}this.attributes.candidates.push(e_)}parseRemoteCandidate(Il){const Gl=[];for(;;){const _h=this.extractOneOrMore(Il,El,[1,5]);this.consumeAttributeSpace(Il);const Pp=this.extract(Il,this.consumeAddress);this.consumeAttributeSpace(Il);const m0=this.extract(Il,this.consumePort);Gl.push({componentId:_h,connectionAddress:Pp,port:m0});try{this.consumeAttributeSpace(Il)}catch{break}}this.attributes.remoteCandidatesList.push(Gl)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(Il){const Gl=this.extract(Il,this.consumeToken);this.consumeAttributeSpace(Il);const _h=this.extract(Il,this.consumeTill,"/");this.extract(Il,this.consume,"/");const Pp={encodingName:_h,clockRate:this.extractOneOrMore(Il,El)};this.atEnd(Il)||this.peekChar(Il)!=="/"||(this.extract(Il,this.consume,"/"),Pp.encodingParameters=parseInt(this.extract(Il,this.consumeTill),10));const m0=this.attributes.payloads.find(Q0=>Q0.payloadType===parseInt(Gl,10));m0?m0.rtpMap=Pp:this.attributes.payloads.push({payloadType:parseInt(Gl,10),rtpMap:Pp,rtcpFeedbacks:[]})}parsePtime(Il){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(Il,this.consumeTill)}parseMaxPtime(Il){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(Il,this.consumeTill)}parseDirection(Il){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=Il.attField}parseSSRC(Il){const Gl=this.extractOneOrMore(Il,El);this.consumeAttributeSpace(Il);const _h=this.extract(Il,this.consumeTill,":");let Pp;this.peekChar(Il)===":"&&(this.extract(Il,this.consume,":"),Pp=this.extract(Il,this.consumeTill));const m0=this.attributes.ssrcs.find(Q0=>Q0.ssrcId===parseInt(Gl,10));m0?m0.attributes[_h]=Pp:this.attributes.ssrcs.push({ssrcId:parseInt(Gl,10),attributes:{[_h]:Pp}})}parseFmtp(Il){const Gl=this.extract(Il,this.consumeTill,ba);this.consumeAttributeSpace(Il);const _h=this.extract(Il,this.consumeTill),Pp={};_h.split(";").forEach(Q0=>{let[h_,e_]=Q0.split("=");h_=h_.trim();const $_=typeof e_=="string"?e_.trim():null;typeof h_=="string"&&h_.length>0&&(Pp[h_]=$_)});const m0=this.attributes.payloads.find(Q0=>Q0.payloadType===parseInt(Gl,10));m0?m0.fmtp={parameters:Pp}:this.attributes.payloads.push({payloadType:parseInt(Gl,10),rtcpFeedbacks:[],fmtp:{parameters:Pp}})}parseFmtParameters(Il){const Gl={},_h=this.extract(Il,this.consumeTill,"=");Il._cur++;const Pp=this.extract(Il,this.consumeTill,";");for(Gl[_h]=Pp;Il.attValue[Il._cur]===";";){const m0=this.extract(Il,this.consumeTill,"=");Il._cur++;const Q0=this.extract(Il,this.consumeTill,";");Gl[m0]=Q0}return Gl}parseRtcpFb(Il){let Gl="";Gl=this.peekChar(Il)==="*"?this.extract(Il,this.consume,"*"):this.extract(Il,this.consumeTill,ba),this.consumeAttributeSpace(Il);const _h=this.extract(Il,this.consumeTill,ba);let Pp;switch(_h){case"trr-int":Pp={type:_h,interval:this.extract(Il,this.consumeTill)};break;case"ack":case"nack":default:{const m0={type:_h};this.peekChar(Il)===ba&&(this.consumeAttributeSpace(Il),m0.parameter=this.extract(Il,this.consumeToken),this.peekChar(Il)===ba&&(m0.additional=this.extract(Il,this.consumeTill))),Pp=m0}}if(Gl==="*")this.attributes.rtcpFeedbackWildcards.push(Pp);else{const m0=this.attributes.payloads.find(Q0=>Q0.payloadType===parseInt(Gl,10));m0?m0.rtcpFeedbacks.push(Pp):this.attributes.payloads.push({payloadType:parseInt(Gl,10),rtcpFeedbacks:[Pp]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(Il){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const Gl={port:this.extract(Il,this.consumePort)};this.peekChar(Il)===ba&&(this.consumeAttributeSpace(Il),Gl.netType=this.extractOneOrMore(Il,Al),this.consumeAttributeSpace(Il),Gl.addressType=this.extractOneOrMore(Il,Al),this.consumeAttributeSpace(Il),Gl.address=this.extract(Il,this.consumeAddress)),this.attributes.rtcp=Gl}parseMsid(Il){const Gl={id:this.extractOneOrMore(Il,Al,[1,64])};this.peekChar(Il)===ba&&(this.consumeAttributeSpace(Il),Gl.appdata=this.extractOneOrMore(Il,Al,[1,64])),this.attributes.msids.push(Gl)}parseImageAttr(Il){this.attributes.imageattr.push(Il.attValue)}parseRid(Il){const Gl=this.extractOneOrMore(Il,Pp=>Ml(Pp)||El(Pp)||Pp==="_"||Pp==="-");this.consumeAttributeSpace(Il);const _h={id:Gl,direction:this.extract(Il,this.consumeToken),params:[]};if(this.peekChar(Il)===ba){if(this.consumeAttributeSpace(Il),this.peek(Il,"pt=")){this.extract(Il,this.consume,"pt=");const Pp=[];for(;;){const m0=this.extract(Il,this.consumeToken);Pp.push(m0);try{this.extract(Il,this.consume,",")}catch{break}}_h.payloads=Pp,this.peekChar(Il)===ba&&this.extract(Il,this.consume,ba)}for(;;){const Pp=this.extract(Il,this.consumeToken);switch(Pp){case"depend":{const m0={type:Pp,rids:this.extract(Il,this.consume,"=").split(",")};_h.params.push(m0);break}case"max-width":case"height-width":case"max-fps":case"max-fs":case"max-br":case"max-pps":case"max-bpp":default:{const m0={type:Pp};this.peekChar(Il)==="="&&(this.extract(Il,this.consume,"="),m0.val=this.extract(Il,this.consumeTill,";")),_h.params.push(m0)}}try{this.extract(Il,this.consume,";")}catch{break}}}this.attributes.rids.push(_h)}parseSimulcast(Il){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=Il.attValue,this.extract(Il,this.consumeTill)}parseSctpPort(Il){this.attributes.sctpPort=this.extractOneOrMore(Il,El,[1,5])}parseMaxMessageSize(Il){this.attributes.maxMessageSize=this.extractOneOrMore(Il,El,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(Il){this.attributes.mid=this.extract(Il,this.consumeToken)}parseSSRCGroup(Il){const Gl=this.extract(Il,this.consumeToken),_h=[];for(;;)try{this.consumeAttributeSpace(Il);const Pp=this.extract(Il,this.consumeInteger);_h.push(parseInt(Pp,10))}catch{break}this.attributes.ssrcGroups.push({semantic:Gl,ssrcIds:_h})}}function Rp(zp,Il,Gl){return Il in zp?Object.defineProperty(zp,Il,{value:Gl,enumerable:!0,configurable:!0,writable:!0}):zp[Il]=Gl,zp}class Lp{constructor(){Rp(this,"eol",_r)}print(Il,Gl){let _h="";return Gl&&(this.eol=Gl),_h+=this.printVersion(Il.version),_h+=this.printOrigin(Il.origin),_h+=this.printSessionName(Il.sessionName),_h+=this.printInformation(Il.information),_h+=this.printUri(Il.uri),_h+=this.printEmail(Il.emails),_h+=this.printPhone(Il.phones),_h+=this.printConnection(Il.connection),_h+=this.printBandwidth(Il.bandwidths),_h+=this.printTimeFields(Il.timeFields),_h+=this.printKey(Il.key),_h+=this.printSessionAttributes(Il.attributes),_h+=this.printMediaDescription(Il.mediaDescriptions),_h}printVersion(Il){return"v=".concat(Il).concat(this.eol)}printOrigin(Il){return"o=".concat(Il.username," ").concat(Il.sessId," ").concat(Il.sessVersion," ").concat(Il.nettype," ").concat(Il.addrtype," ").concat(Il.unicastAddress).concat(this.eol)}printSessionName(Il){return Il?"s=".concat(Il).concat(this.eol):""}printInformation(Il){return Il?"i=".concat(Il).concat(this.eol):""}printUri(Il){return Il?"u=".concat(Il).concat(this.eol):""}printEmail(Il){let Gl="";for(const _h of Il)Gl+="e=".concat(_h).concat(this.eol);return Gl}printPhone(Il){let Gl="";for(const _h of Il)Gl+="e=".concat(_h).concat(this.eol);return Gl}printConnection(Il){return Il?"c=".concat(Il.nettype," ").concat(Il.addrtype," ").concat(Il.address).concat(this.eol):""}printBandwidth(Il){let Gl="";for(const _h of Il)Gl+="b=".concat(_h.bwtype,":").concat(_h.bandwidth).concat(this.eol);return Gl}printTimeFields(Il){let Gl="";for(const _h of Il){Gl+="t=".concat(_h.time.startTime," ").concat(_h.time.startTime).concat(this.eol);for(const Pp of _h.repeats)Gl+="r=".concat(Pp.repeatInterval," ").concat(Pp.typedTimes.join(" ")).concat(this.eol);_h.zoneAdjustments&&(Gl+="z=",Gl+="z=".concat(_h.zoneAdjustments.map(Pp=>"".concat(Pp.time," ").concat(Pp.back?"-":""," ").concat(Pp.typedTime)).join(" ")).concat(this.eol),Gl+=this.eol)}return Gl}printKey(Il){return Il?"k=".concat(Il).concat(this.eol):""}printAttributes(Il){let Gl="";for(const _h of Il)Gl+="a=".concat(_h.attField).concat(_h.attValue?":".concat(_h.attValue):"").concat(this.eol);return Gl}printMediaDescription(Il){let Gl="";for(const _h of Il)Gl+=this.printMedia(_h.media),Gl+=this.printInformation(_h.information),Gl+=this.printConnections(_h.connections),Gl+=this.printBandwidth(_h.bandwidths),Gl+=this.printKey(_h.key),Gl+=this.printMediaAttributes(_h);return Gl}printConnections(Il){let Gl="";for(const _h of Il)Gl+=this.printConnection(_h);return Gl}printMedia(Il){return"m=".concat(Il.mediaType," ").concat(Il.port," ").concat(Il.protos.join("/")," ").concat(Il.fmts.join(" ")).concat(this.eol)}printSessionAttributes(Il){return new Ip(this.eol).print(Il)}printMediaAttributes(Il){return new Vp(this.eol).print(Il)}}class Ep{constructor(Il){Rp(this,"eol",void 0),this.eol=Il}printIceUfrag(Il){return Il===void 0?"":"a=ice-ufrag:".concat(Il).concat(this.eol)}printIcePwd(Il){return Il===void 0?"":"a=ice-pwd:".concat(Il).concat(this.eol)}printIceOptions(Il){return Il===void 0?"":"a=ice-options:".concat(Il.join(ba)).concat(this.eol)}printFingerprints(Il){return Il.length>0?Il.map(Gl=>"a=fingerprint:".concat(Gl.hashFunction).concat(ba).concat(Gl.fingerprint)).join(this.eol)+this.eol:""}printExtmap(Il){return Il.map(Gl=>"a=extmap:".concat(Gl.entry).concat(Gl.direction?"/".concat(Gl.direction):"").concat(ba).concat(Gl.extensionName).concat(Gl.extensionAttributes?"".concat(ba).concat(Gl.extensionAttributes):"").concat(this.eol)).join("")}printSetup(Il){return Il===void 0?"":"a=setup:".concat(Il).concat(this.eol)}printUnrecognized(Il){return Il.map(Gl=>"a=".concat(Gl.attField).concat(Gl.attValue?":".concat(Gl.attValue):"").concat(this.eol)).join("")}}class Ip extends Ep{print(Il){let Gl="";return Gl+=this.printGroups(Il.groups),Gl+=this.printMsidSemantic(Il.msidSemantic),Gl+=this.printIceLite(Il.iceLite),Gl+=this.printIceUfrag(Il.iceUfrag),Gl+=this.printIcePwd(Il.icePwd),Gl+=this.printIceOptions(Il.iceOptions),Gl+=this.printFingerprints(Il.fingerprints),Gl+=this.printSetup(Il.setup),Gl+=this.printTlsId(Il.tlsId),Gl+=this.printIdentity(Il.identities),Gl+=this.printExtmap(Il.extmaps),Gl+=this.printUnrecognized(Il.unrecognized),Gl}printGroups(Il){let Gl="";return Il.length>0&&(Gl+=Il.map(_h=>"a=group:".concat(_h.semantic).concat(_h.identificationTag.map(Pp=>"".concat(ba).concat(Pp)).join("")).concat(this.eol)).join("")),Gl}printIceLite(Il){return Il===void 0?"":"a=ice-lite"+this.eol}printTlsId(Il){return Il?"a=tls-id:".concat(Il).concat(this.eol):""}printIdentity(Il){return Il.length===0?"":Il.map(Gl=>"a=identity:".concat(Gl.assertionValue).concat(Gl.extensions.map(_h=>"".concat(ba).concat(_h.name).concat(_h.value?"=".concat(_h.value):"")))).join(this.eol)+this.eol}printMsidSemantic(Il){if(!Il)return"";let Gl="a=msid-semantic:".concat(Il.semantic);return Il.applyForAll?Gl+="".concat(ba,"*"):Il.identifierList.length>0&&(Gl+=Il.identifierList.map(_h=>"".concat(ba).concat(_h))),Gl+this.eol}}class Vp extends Ep{print(Il){const Gl=Il.attributes;let _h="";return _h+=this.printRTCP(Gl.rtcp),_h+=this.printIceUfrag(Gl.iceUfrag),_h+=this.printIcePwd(Gl.icePwd),_h+=this.printIceOptions(Gl.iceOptions),_h+=this.printCandidates(Gl.candidates),_h+=this.printRemoteCandidatesList(Gl.remoteCandidatesList),_h+=this.printEndOfCandidates(Gl.endOfCandidates),_h+=this.printFingerprints(Gl.fingerprints),_h+=this.printSetup(Gl.setup),_h+=this.printMid(Gl.mid),_h+=this.printExtmap(Gl.extmaps),_h+=this.printRTPRelated(Gl),_h+=this.printPtime(Gl.ptime),_h+=this.printMaxPtime(Gl.maxPtime),_h+=this.printDirection(Gl.direction),_h+=this.printSSRCGroups(Gl.ssrcGroups),_h+=this.printSSRC(Gl.ssrcs),_h+=this.printRTCPMux(Gl.rtcpMux),_h+=this.printRTCPMuxOnly(Gl.rtcpMuxOnly),_h+=this.printRTCPRsize(Gl.rtcpRsize),_h+=this.printMSId(Gl.msids),_h+=this.printImageattr(Gl.imageattr),_h+=this.printRid(Gl.rids),_h+=this.printSimulcast(Gl.simulcast),_h+=this.printSCTPPort(Gl.sctpPort),_h+=this.printMaxMessageSize(Gl.maxMessageSize),_h+=this.printUnrecognized(Gl.unrecognized),_h}printCandidates(Il){return Il.map(Gl=>"a=candidate:".concat(Gl.foundation).concat(ba).concat(Gl.componentId).concat(ba).concat(Gl.transport).concat(ba).concat(Gl.priority).concat(ba).concat(Gl.connectionAddress).concat(ba).concat(Gl.port).concat(ba,"typ").concat(ba).concat(Gl.type).concat(Gl.relAddr?"".concat(ba,"raddr").concat(ba).concat(Gl.relAddr):"").concat(Gl.relPort?"".concat(ba,"rport").concat(ba).concat(Gl.relPort):"").concat(Object.keys(Gl.extension).map(_h=>"".concat(ba).concat(_h).concat(ba).concat(Gl.extension[_h])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(Il){return Il.map(Gl=>"a=remote-candidates:".concat(Gl.join(ba)).concat(this.eol)).join("")}printEndOfCandidates(Il){return Il===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(Il){if(!Il.payloads)return"";const Gl=Il.payloads;let _h="";_h+=Il.rtcpFeedbackWildcards.map(Pp=>this.printRTCPFeedback("*",Pp)).join("");for(const Pp of Gl)_h+=this.printRtpMap(Pp.payloadType,Pp.rtpMap),_h+=this.printFmtp(Pp.payloadType,Pp.fmtp),_h+=Pp.rtcpFeedbacks.map(m0=>this.printRTCPFeedback(Pp.payloadType,m0)).join("");return _h}printFmtp(Il,Gl){if(!Gl)return"";const _h=Object.keys(Gl.parameters);return _h.length===1&&Gl.parameters[_h[0]]===null?"a=fmtp:".concat(Il).concat(ba).concat(_h[0]).concat(this.eol):"a=fmtp:".concat(Il).concat(ba).concat(Object.keys(Gl.parameters).map(Pp=>"".concat(Pp,"=").concat(Gl.parameters[Pp])).join(";")).concat(this.eol)}printRtpMap(Il,Gl){return Gl?"a=rtpmap:".concat(Il).concat(ba).concat(Gl.encodingName,"/").concat(Gl.clockRate).concat(Gl.encodingParameters?"/".concat(Gl.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(Il,Gl){let _h="a=rtcp-fb:".concat(Il).concat(ba),Pp=Gl;switch(Pp.type){case"trr-int":_h+="ttr-int".concat(ba).concat(Pp.interval);break;case"ack":case"nack":default:Pp=Pp,_h+="".concat(Pp.type),Pp.parameter&&(_h+="".concat(ba).concat(Pp.parameter),Pp.additional&&(_h+="".concat(ba).concat(Pp.additional)))}return _h+this.eol}printPtime(Il){return Il===void 0?"":"a=ptime:".concat(Il).concat(this.eol)}printMaxPtime(Il){return Il===void 0?"":"a=maxptime:".concat(Il).concat(this.eol)}printDirection(Il){return Il===void 0?"":"a=".concat(Il).concat(this.eol)}printSSRC(Il){return Il.map(Gl=>Object.keys(Gl.attributes).map(_h=>"a=ssrc:".concat(Gl.ssrcId.toString(10)).concat(ba).concat(_h).concat(Gl.attributes[_h]?":".concat(Gl.attributes[_h]):"").concat(this.eol)).join("")).join("")}printRTCPMux(Il){return Il===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(Il){return Il===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(Il){return Il===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(Il){if(Il===void 0)return"";let Gl="a=rtcp:".concat(Il.port);return Il.netType&&(Gl+="".concat(ba).concat(Il.netType)),Il.addressType&&(Gl+="".concat(ba).concat(Il.addressType)),Il.address&&(Gl+="".concat(ba).concat(Il.address)),Gl+this.eol}printMSId(Il){return Il.map(Gl=>"a=msid:".concat(Gl.id).concat(Gl.appdata?"".concat(ba).concat(Gl.appdata):"").concat(this.eol)).join("")}printImageattr(Il){return Il.map(Gl=>"a=imageattr:".concat(Gl).concat(this.eol)).join("")}printRid(Il){return Il.map(Gl=>{let _h="a=rid:".concat(Gl.id).concat(ba).concat(Gl.direction);return Gl.payloads&&(_h+="".concat(ba,"pt=").concat(Gl.payloads.join(","))),Gl.params.length>0&&(_h+="".concat(ba).concat(Gl.params.map(Pp=>Pp.type==="depend"?"depend=".concat(Pp.rids.join(",")):"".concat(Pp.type,"=").concat(Pp.val)).join(";"))),_h+this.eol}).join("")}printSimulcast(Il){return Il===void 0?"":"a=simulcast:".concat(Il).concat(this.eol)}printSCTPPort(Il){return Il===void 0?"":"a=sctp-port:".concat(Il).concat(this.eol)}printMaxMessageSize(Il){return Il===void 0?"":"a=max-message-size:".concat(Il).concat(this.eol)}printMid(Il){return Il===void 0?"":"a=mid:".concat(Il).concat(this.eol)}printSSRCGroups(Il){return Il.map(Gl=>"a=ssrc-group:".concat(Gl.semantic).concat(Gl.ssrcIds.map(_h=>"".concat(ba).concat(_h.toString(10))).join("")).concat(this.eol)).join("")}}function _v(zp){return new h0().parse(zp)}function f0(zp,Il){return new Lp().print(zp,Il)}}},g={};function j(_e){if(g[_e])return g[_e].exports;var _n=g[_e]={exports:{}};return h[_e](_n,_n.exports,j),_n.exports}return j.d=(_e,_n)=>{for(var _o in _n)j.o(_n,_o)&&!j.o(_e,_o)&&Object.defineProperty(_e,_o,{enumerable:!0,get:_n[_o]})},j.o=(_e,_n)=>Object.prototype.hasOwnProperty.call(_e,_n),j.r=_e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(_e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_e,"__esModule",{value:!0})},j(8)})()})(K_);class uat{constructor(a){Rl(this,"sessionDesc",void 0),Rl(this,"localCapabilities",void 0),Rl(this,"rtpCapabilities",void 0),Rl(this,"candidates",void 0),Rl(this,"iceParameters",void 0),Rl(this,"dtlsParameters",void 0),Rl(this,"setup",void 0),Rl(this,"currentMidIndex",void 0),Rl(this,"cname",void 0),a=W_(a);const{remoteIceParameters:h,remoteDtlsParameters:g,candidates:j,remoteRTPCapabilities:_e,remoteSetup:_n,localCapabilities:_o,sdkCodec:_a,cname:_r}=a,ba=K_.exports.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=_e,this.candidates=j,this.iceParameters=h,this.dtlsParameters=g,this.setup=_n,this.localCapabilities=_o,this.cname=_r;for(let xa=0;xa<ba.mediaDescriptions.length;xa++){const El=ba.mediaDescriptions[xa];if(El.attributes.iceUfrag=h.iceUfrag,El.attributes.icePwd=h.icePwd,El.attributes.fingerprints=g.fingerprints,El.attributes.candidates=j,El.attributes.setup=_n,El.media.mediaType==="video"){El.media.fmts=_e.videoCodecs.map(Ol=>Ol.payloadType.toString(10));const yl=_e.videoCodecs.filter(Ol=>{var Al;return(Al=Ol.rtpMap)===null||Al===void 0?void 0:Al.encodingName.toLowerCase().includes(_a)});if(yl.length===0)throw new Error("Codec ".concat(_a," not supported by remote SDP."));El.attributes.payloads=yl,El.attributes.extmaps=_e.videoExtensions}El.media.mediaType==="audio"&&(El.media.fmts=_e.audioCodecs.map(yl=>yl.payloadType.toString(10)),El.attributes.payloads=_e.audioCodecs,El.attributes.extmaps=_e.audioExtensions),ba.mediaDescriptions[xa]=this.mungMediaDesc(El)}this.sessionDesc=ba,this.currentMidIndex=ba.mediaDescriptions.length-1}toString(){return K_.exports.print(this.sessionDesc)}send(a,h,g){const{ssrcs:j,ssrcGroups:_e}=Zy(h,this.cname),_n=this.sessionDesc.mediaDescriptions.find(_r=>a===N0.VIDEO?_r.media.mediaType==="video":_r.media.mediaType==="audio"),_o=j[0].attributes.label,_a=j[0].attributes.mslabel;return _n.attributes.ssrcs=_n.attributes.ssrcs.concat(j),_n.attributes.ssrcGroups=_n.attributes.ssrcGroups.concat(_e),{id:_o,mslabel:_a}}batchSend(a){return a.map(h=>{let{kind:g,ssrcMsg:j}=h;return this.send(g,j,void 0)})}stopSending(a){this.sessionDesc.mediaDescriptions.forEach(h=>{const g=[],j=[],_e=[];h.attributes.ssrcs.forEach(_n=>{a.includes(_n.attributes.label||"")?_e.push(_n):g.push(_n)}),h.attributes.ssrcGroups.forEach(_n=>{_e.map(_o=>_o.ssrcId).includes(_n.ssrcIds[0])||j.push(_n)}),h.attributes.ssrcs=g,h.attributes.ssrcGroups=j})}mute(a){const h=this.sessionDesc.mediaDescriptions.find(g=>g.attributes.mid===a);if(!h)throw new Error("mediaDescription not found with ".concat(a," in remote SDP when calling RemoteSDP.mute."));h.attributes.direction="inactive"}unmute(a){const h=this.sessionDesc.mediaDescriptions.find(g=>g.attributes.mid===a);if(!h)throw new Error("mediaDescription not found with ".concat(a," in remote SDP when calling RemoteSDP.unmute."));h.attributes.direction="sendonly"}receive(a,h,g){a.forEach((j,_e)=>{const _n=j._mediaStreamTrack,_o=this.sessionDesc.mediaDescriptions.findIndex(_r=>_r.attributes.mid===_n.kind),_a=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[_o],j);this.sessionDesc.mediaDescriptions[_o]=_a})}stopReceiving(a){}restartICE(a){a=W_(a),this.iceParameters=a,this.sessionDesc.mediaDescriptions.forEach(h=>{h.attributes.iceUfrag=a.iceUfrag,h.attributes.icePwd=a.icePwd})}predictReceivingMids(a){const h=[];for(let g=0;g<a;g++)h.push((this.currentMidIndex+g+1).toString(10));return h}mungRecvMediaDsec(a,h){const g=W_(a);return cN(g,h),y9(g,h),g}updateRecvMedia(a,h){const g=this.sessionDesc.mediaDescriptions.findIndex(j=>j.attributes.mid===a);if(g!==-1){const j=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[g],h);this.sessionDesc.mediaDescriptions[g]=j}}bumpMid(a){this.currentMidIndex+=a}updateTrackLabel(a,h,g){const j=this.sessionDesc.mediaDescriptions.find(_n=>a===N0.VIDEO?_n.attributes.mid==="video":_n.attributes.mid==="audio");if(j){const _n=j.attributes.ssrcs.find(_o=>_o.attributes.label===h);var _e;_n&&(_n.attributes.label=g,(_e=_n.attributes.msid)===null||_e===void 0||_e.replace(h,g))}}mungMediaDesc(a){const h=W_(a);return _9(h),function(g){const j=g.attributes.extmaps.find(_e=>_e.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");j&&g.attributes.extmaps.splice(g.attributes.extmaps.indexOf(j),1),g.attributes.payloads.forEach(_e=>{const _n=_e.rtcpFeedbacks.findIndex(_o=>_o.type==="transport-cc");_n!==-1&&_e.rtcpFeedbacks.splice(_n,1)})}(h),h}getSSRC(a){for(const h of this.sessionDesc.mediaDescriptions)for(const g of h.attributes.ssrcs)if(g.attributes.label===a)return[g]}}function SS(s){if(Array.isArray(s))return s.map(function(g){return g});if(!DQ(s))return s;var a={};for(var h in s)DQ(s[h])||Array.isArray(s[h])?a[h]=SS(s[h]):a[h]=s[h];return a}function DQ(s){return!(typeof s!="object"||Array.isArray(s)||!s)}var S9=function(){function s(a){this.input=[],this.size=a}return s.prototype.add=function(a){this.input.push(a),this.input.length>this.size&&this.input.splice(0,1)},s.prototype.diffMean=function(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length},s}(),xQ=function(s,a){return(xQ=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,g){h.__proto__=g}||function(h,g){for(var j in g)g.hasOwnProperty(j)&&(h[j]=g[j])})(s,a)};/*! *****************************************************************************
		Copyright (c) Microsoft Corporation. All rights reserved.
		Licensed under the Apache License, Version 2.0 (the "License"); you may not use
		this file except in compliance with the License. You may obtain a copy of the
		License at http://www.apache.org/licenses/LICENSE-2.0

		THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
		KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
		WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
		MERCHANTABLITY OR NON-INFRINGEMENT.

		See the Apache Version 2.0 License for specific language governing permissions
		and limitations under the License.
		***************************************************************************** */function T9(s,a){function h(){this.constructor=s}xQ(s,a),s.prototype=a===null?Object.create(a):(h.prototype=a.prototype,new h)}var fO=function(){return(fO=Object.assign||function(s){for(var a,h=1,g=arguments.length;h<g;h++)for(var j in a=arguments[h])Object.prototype.hasOwnProperty.call(a,j)&&(s[j]=a[j]);return s}).apply(this,arguments)};function R9(s,a,h,g){return new(h||(h=Promise))(function(j,_e){function _n(_r){try{_a(g.next(_r))}catch(ba){_e(ba)}}function _o(_r){try{_a(g.throw(_r))}catch(ba){_e(ba)}}function _a(_r){_r.done?j(_r.value):new h(function(ba){ba(_r.value)}).then(_n,_o)}_a((g=g.apply(s,a||[])).next())})}function w9(s,a){var h,g,j,_e,_n={label:0,sent:function(){if(1&j[0])throw j[1];return j[1]},trys:[],ops:[]};return _e={next:_o(0),throw:_o(1),return:_o(2)},typeof Symbol=="function"&&(_e[Symbol.iterator]=function(){return this}),_e;function _o(_a){return function(_r){return function(ba){if(h)throw new TypeError("Generator is already executing.");for(;_n;)try{if(h=1,g&&(j=2&ba[0]?g.return:ba[0]?g.throw||((j=g.return)&&j.call(g),0):g.next)&&!(j=j.call(g,ba[1])).done)return j;switch(g=0,j&&(ba=[2&ba[0],j.value]),ba[0]){case 0:case 1:j=ba;break;case 4:return _n.label++,{value:ba[1],done:!1};case 5:_n.label++,g=ba[1],ba=[0];continue;case 7:ba=_n.ops.pop(),_n.trys.pop();continue;default:if(j=_n.trys,!((j=j.length>0&&j[j.length-1])||ba[0]!==6&&ba[0]!==2)){_n=0;continue}if(ba[0]===3&&(!j||ba[1]>j[0]&&ba[1]<j[3])){_n.label=ba[1];break}if(ba[0]===6&&_n.label<j[1]){_n.label=j[1],j=ba;break}if(j&&_n.label<j[2]){_n.label=j[2],_n.ops.push(ba);break}j[2]&&_n.ops.pop(),_n.trys.pop();continue}ba=a.call(s,_n)}catch(xa){ba=[6,xa],g=0}finally{h=j=0}if(5&ba[0])throw ba[1];return{value:ba[0]?ba[1]:void 0,done:!0}}([_a,_r])}}}var TS,MQ={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},a3={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:MQ,remoteCandidate:MQ}},UQ={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},jQ={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,qpSumPerFrame:0},FQ={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},VQ={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0},I9=function(){function s(a,h){var g=this;this.videoIsReady=!1,this.videoIsReady2={},this.stats=SS(a3),this.isFirstVideoReceived={},this.isFirstVideoDecoded={},this.isFirstAudioReceived={},this.isFirstAudioDecoded={},this.lossRateWindowStats=[],this.pc=a,this.options=h,this.intervalTimer=window.setInterval(function(){return R9(g,void 0,void 0,function(){return w9(this,function(j){return this.updateStats(),[2]})})},this.options.updateInterval)}return s.prototype.getStats=function(){return this.stats},s.prototype.setVideoIsReady=function(a){this.videoIsReady=a},s.prototype.setVideoIsReady2=function(a,h){this.videoIsReady2[a]=h},s.prototype.getVideoIsReady=function(a){return this.videoIsReady2[a]||!1},s.prototype.setIsFirstAudioDecoded=function(a){},s.prototype.destroy=function(){window.clearInterval(this.intervalTimer),this.pc=void 0},s.prototype.calcLossRate=function(a){var h=this;this.lossRateWindowStats.push(a),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);for(var g=this.lossRateWindowStats.length,j=0,_e=0,_n=0,_o=0,_a=function(xa){a[xa].forEach(function(El,yl){if(h.lossRateWindowStats[g-1][xa][yl]&&h.lossRateWindowStats[0][xa][yl]){var Ol=h.lossRateWindowStats[g-1][xa][yl].packets-h.lossRateWindowStats[0][xa][yl].packets,Al=h.lossRateWindowStats[g-1][xa][yl].packetsLost-h.lossRateWindowStats[0][xa][yl].packetsLost;xa==="videoSend"||xa==="audioSend"?(j+=Ol,_n+=Al):(_e+=Ol,_o+=Al),Number.isNaN(Ol)||Number.isNaN(Ol)?El.packetLostRate=0:El.packetLostRate=Ol<=0||Al<=0?0:Al/(Ol+Al)}})},_r=0,ba=["videoSend","audioSend","videoRecv","audioRecv"];_r<ba.length;_r++)_a(ba[_r]);a.sendPacketLossRate=j<=0||_n<=0?0:_n/(j+_n),a.recvPacketLossRate=_e<=0||_o<=0?0:_o/(_e+_o)},s}(),lat=function(s){function a(){var h=s!==null&&s.apply(this,arguments)||this;return h._stats=a3,h.lastDecodeVideoReceiverStats=new Map,h}return T9(a,s),a.prototype.updateStats=function(){return R9(this,void 0,void 0,function(){var h,g,j,_e;return w9(this,function(_n){switch(_n.label){case 0:return[4,this._getStats()];case 1:return h=_n.sent(),g=this.statsResponsesToObjects(h),this._stats=SS(a3),j=g.filter(function(_o){return _o.type==="ssrc"}),this.processSSRCStats(j),(_e=g.find(function(_o){return _o.type==="VideoBwe"}))&&this.processBandwidthStats(_e),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}})})},a.prototype.processBandwidthStats=function(h){this._stats.bitrate={actualEncoded:Number(h.googActualEncBitrate),targetEncoded:Number(h.googTargetEncBitrate),retransmit:Number(h.googRetransmitBitrate),transmit:Number(h.googTransmitBitrate)},this._stats.sendBandwidth=Number(h.googAvailableSendBandwidth)},a.prototype.processSSRCStats=function(h){var g=this;h.forEach(function(j){var _e=j.id.includes("send");switch("".concat(j.mediaType,"_").concat(_e?"send":"recv")){case"video_send":var _n=SS(jQ);_n.codec=j.googCodecName,_n.adaptionChangeReason="none",j.googCpuLimitedResolution&&(_n.adaptionChangeReason="cpu"),j.googBandwidthLimitedResolution&&(_n.adaptionChangeReason="bandwidth"),_n.avgEncodeMs=Number(j.googAvgEncodeMs),_n.inputFrame={width:Number(j.googFrameWidthInput)||Number(j.googFrameWidthSent),height:Number(j.googFrameHeightInput)||Number(j.googFrameHeightSent),frameRate:Number(j.googFrameRateInput)},_n.sentFrame={width:Number(j.googFrameWidthSent),height:Number(j.googFrameHeightSent),frameRate:Number(j.googFrameRateInput)},_n.firsCount=Number(j.googFirReceived),_n.nacksCount=Number(j.googNacksReceived),_n.plisCount=Number(j.googPlisReceived),_n.frameCount=Number(j.framesEncoded),_n.bytes=Number(j.bytesSent),_n.packets=Number(j.packetsSent),_n.packetsLost=Number(j.packetsLost),_n.ssrc=Number(j.ssrc),_n.rttMs=Number(j.googRtt||0),g._stats.videoSend.push(_n),g._stats.rtt=_n.rttMs;break;case"video_recv":var _o=SS(UQ),_a=g.lastDecodeVideoReceiverStats.get(Number(j.ssrc));if(_o.codec=j.googCodecName,_o.targetDelayMs=Number(j.googTargetDelayMs),_o.renderDelayMs=Number(j.googRenderDelayMs),_o.currentDelayMs=Number(j.googCurrentDelayMs),_o.minPlayoutDelayMs=Number(j.googMinPlayoutDelayMs),_o.decodeMs=Number(j.googDecodeMs),_o.maxDecodeMs=Number(j.googMaxDecodeMs),_o.receivedFrame={width:Number(j.googFrameWidthReceived),height:Number(j.googFrameHeightReceived),frameRate:Number(j.googFrameRateReceived)},_o.decodedFrame={width:Number(j.googFrameWidthReceived),height:Number(j.googFrameHeightReceived),frameRate:Number(j.googFrameRateDecoded)},_o.decodeFrameRate=Number(j.googFrameRateDecoded),_o.outputFrame={width:Number(j.googFrameWidthReceived),height:Number(j.googFrameHeightReceived),frameRate:Number(j.googFrameRateOutput)},_o.jitterBufferMs=Number(j.googJitterBufferMs),_o.firsCount=Number(j.googFirsSent),_o.nacksCount=Number(j.googNacksSent),_o.plisCount=Number(j.googPlisSent),_o.framesDecodeCount=Number(j.framesDecoded),_o.bytes=Number(j.bytesReceived),_o.packets=Number(j.packetsReceived),_o.packetsLost=Number(j.packetsLost),_o.ssrc=Number(j.ssrc),_o.packets>0&&!g.isFirstVideoReceived[_o.ssrc]&&(g.onFirstVideoReceived&&g.onFirstVideoReceived(_o.ssrc),g.isFirstVideoReceived[_o.ssrc]=!0),_o.framesDecodeCount>0&&!g.isFirstVideoDecoded[_o.ssrc]&&(g.onFirstVideoDecoded&&g.onFirstVideoDecoded(_o.ssrc,_o.decodedFrame.width,_o.decodedFrame.height),g.isFirstVideoDecoded[_o.ssrc]=!0),_a){var _r=_a.stats,ba=Date.now()-_a.lts;_o.framesDecodeFreezeTime=_r.framesDecodeFreezeTime,_o.framesDecodeInterval=_r.framesDecodeInterval,_o.framesDecodeCount>_r.framesDecodeCount&&g.isFirstVideoDecoded[_o.ssrc]?(_a.lts=Date.now(),_o.framesDecodeInterval=ba,_o.framesDecodeInterval>=g.options.freezeRateLimit&&(g.getVideoIsReady(parseInt(j.ssrc,10))?_o.framesDecodeFreezeTime+=_o.framesDecodeInterval:g.setVideoIsReady2(parseInt(j.ssrc,10),!0))):_o.framesDecodeCount<_a.stats.framesDecodeCount&&(_o.framesDecodeInterval=0)}g.lastDecodeVideoReceiverStats.set(_o.ssrc,{stats:fO({},_o),lts:Date.now()}),g._stats.videoRecv.push(_o);break;case"audio_recv":var xa=SS(VQ);xa.codec=j.googCodecName,xa.outputLevel=Math.abs(Number(j.audioOutputLevel))/32767,xa.decodingCNG=Number(j.googDecodingCNG),xa.decodingCTN=Number(j.googDecodingCTN),xa.decodingCTSG=Number(j.googDecodingCTSG),xa.decodingNormal=Number(j.googDecodingNormal),xa.decodingPLC=Number(j.googDecodingPLC),xa.decodingPLCCNG=Number(j.googDecodingPLCCNG),xa.expandRate=Number(j.googExpandRate),xa.accelerateRate=Number(j.googAccelerateRate),xa.preemptiveExpandRate=Number(j.googPreemptiveExpandRate),xa.secondaryDecodedRate=Number(j.googSecondaryDecodedRate),xa.speechExpandRate=Number(j.googSpeechExpandRate),xa.preferredJitterBufferMs=Number(j.googPreferredJitterBufferMs),xa.jitterBufferMs=Number(j.googJitterBufferMs),xa.jitterMs=Number(j.googJitterReceived),xa.bytes=Number(j.bytesReceived),xa.packets=Number(j.packetsReceived),xa.packetsLost=Number(j.packetsLost),xa.ssrc=Number(j.ssrc),xa.receivedFrames=Number(j.googDecodingCTN)||Number(j.packetsReceived),xa.droppedFrames=Number(j.googDecodingPLC)+Number(j.googDecodingPLCCNG)||Number(j.packetsLost),xa.receivedFrames>0&&!g.isFirstAudioReceived[xa.ssrc]&&(g.onFirstAudioReceived&&g.onFirstAudioReceived(xa.ssrc),g.isFirstAudioReceived[xa.ssrc]=!0),xa.decodingNormal>0&&!g.isFirstAudioDecoded[xa.ssrc]&&(g.onFirstAudioDecoded&&g.onFirstAudioDecoded(xa.ssrc),g.isFirstAudioDecoded[xa.ssrc]=!0),g._stats.audioRecv.push(xa);break;case"audio_send":var El=SS(FQ);El.codec=j.googCodecName,El.inputLevel=Math.abs(Number(j.audioInputLevel))/32767,El.aecReturnLoss=Number(j.googEchoCancellationReturnLoss||0),El.aecReturnLossEnhancement=Number(j.googEchoCancellationReturnLossEnhancement||0),El.residualEchoLikelihood=Number(j.googResidualEchoLikelihood||0),El.residualEchoLikelihoodRecentMax=Number(j.googResidualEchoLikelihoodRecentMax||0),El.bytes=Number(j.bytesSent),El.packets=Number(j.packetsSent),El.packetsLost=Number(j.packetsLost),El.ssrc=Number(j.ssrc),El.rttMs=Number(j.googRtt||0),g._stats.rtt=El.rttMs,g._stats.audioSend.push(El)}})},a.prototype._getStats=function(){var h=this;return new Promise(function(g,j){h.pc.getStats(g,j)})},a.prototype.statsResponsesToObjects=function(h){var g=[];return h.result().forEach(function(j){var _e={id:j.id,timestamp:j.timestamp.valueOf().toString(),type:j.type};j.names().forEach(function(_n){_e[_n]=j.stat(_n)}),g.push(_e)}),g},a}(I9);(function(s){s.CERTIFICATE="certificate",s.CODEC="codec",s.CANDIDATE_PAIR="candidate-pair",s.LOCAL_CANDIDATE="local-candidate",s.REMOTE_CANDIDATE="remote-candidate",s.INBOUND="inbound-rtp",s.TRACK="track",s.OUTBOUND="outbound-rtp",s.PC="peer-connection",s.REMOTE_INBOUND="remote-inbound-rtp",s.REMOTE_OUTBOUND="remote-outbound-rtp",s.TRANSPORT="transport",s.CSRC="csrc",s.DATA_CHANNEL="data-channel",s.STREAM="stream",s.SENDER="sender",s.RECEIVER="receiver"})(TS||(TS={}));var l_,BQ=function(s){function a(){var h=s!==null&&s.apply(this,arguments)||this;return h._stats=a3,h.lastDecodeVideoReceiverStats=new Map,h.lastVideoFramesRecv=new Map,h.lastVideoFramesSent=new Map,h.lastVideoFramesDecode=new Map,h.lastVideoJBDelay=new Map,h.lastAudioJBDelay=new Map,h.mediaBytesSent=new Map,h.mediaBytesRetransmit=new Map,h.mediaBytesTargetEncode=new Map,h.lastEncoderMs=new Map,h}return T9(a,s),a.prototype.updateStats=function(){return R9(this,void 0,void 0,function(){var h,g=this;return w9(this,function(j){switch(j.label){case 0:return h=this,[4,this.pc.getStats()];case 1:return h.report=j.sent(),this._stats=SS(a3),this.report.forEach(function(_e){switch(_e.type){case TS.OUTBOUND:_e.mediaType==="audio"?g.processAudioOutboundStats(_e):_e.mediaType==="video"&&g.processVideoOutboundStats(_e);break;case TS.INBOUND:_e.mediaType==="audio"?g.processAudioInboundStats(_e):_e.mediaType==="video"&&g.processVideoInboundStats(_e);break;case TS.TRANSPORT:var _n=g.report.get(_e.selectedCandidatePairId);_n&&g.processCandidatePairStats(_n);break;case TS.CANDIDATE_PAIR:_e.selected&&g.processCandidatePairStats(_e)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}})})},a.prototype.processCandidatePairStats=function(h){if(this._stats.sendBandwidth=h.availableOutgoingBitrate||0,h.currentRoundTripTime&&(this._stats.rtt=1e3*h.currentRoundTripTime),this._stats.videoSend.forEach(function(_e){!_e.rttMs&&h.currentRoundTripTime&&(_e.rttMs=1e3*h.currentRoundTripTime)}),this._stats.audioSend.forEach(function(_e){!_e.rttMs&&h.currentRoundTripTime&&(_e.rttMs=1e3*h.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=h.id,h.localCandidateId){var g=this.report.get(h.localCandidateId);g&&this.processCandidateStats(g)}if(h.remoteCandidateId){var j=this.report.get(h.remoteCandidateId);j&&this.processCandidateStats(j)}},a.prototype.processCandidateStats=function(h){var g;h.type===TS.LOCAL_CANDIDATE&&(g=this._stats.selectedCandidatePair.localCandidate),h.type===TS.REMOTE_CANDIDATE&&(g=this._stats.selectedCandidatePair.remoteCandidate),g&&(g.type=h.type,g.id=h.id,h.address&&(g.address=h.address),h.candidateType&&(g.candidateType=h.candidateType),h.port&&(g.port=h.port),h.priority&&(g.priority=h.priority),h.protocol&&(g.protocol=h.protocol),h.relayProtocol&&(g.relayProtocol=h.relayProtocol),h.type===TS.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==g.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(fO({},g),fO({},this.stats.selectedCandidatePair.localCandidate)),h.type===TS.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==g.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(fO({},g),fO({},this.stats.selectedCandidatePair.remoteCandidate)))},a.prototype.processAudioInboundStats=function(h){var g=this._stats.audioRecv.find(function(j){return j.ssrc===h.ssrc});g||(g=SS(VQ),this._stats.audioRecv.push(g)),g.ssrc=h.ssrc,g.packets=h.packetsReceived,g.packetsLost=h.packetsLost,g.bytes=h.bytesReceived,g.jitterMs=1e3*h.jitter,this.processAudioTrackReceiverStats(h,h.trackId,g),h.codecId&&(g.codec=this.getCodecFromCodecStats(h.codecId)),g.receivedFrames||(g.receivedFrames=h.packetsReceived),g.droppedFrames||(g.droppedFrames=h.packetsLost),g.receivedFrames>0&&!this.isFirstAudioReceived[g.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(g.ssrc),this.isFirstAudioReceived[g.ssrc]=!0),g.outputLevel&&g.outputLevel>0&&!this.isFirstAudioDecoded[g.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(g.ssrc),this.isFirstAudioDecoded[g.ssrc]=!0),typeof h.concealedSamples=="number"&&(g.concealedSamples=h.concealedSamples)},a.prototype.processVideoInboundStats=function(h){var g=this._stats.videoRecv.find(function(xa){return xa.ssrc===h.ssrc});g||(g=SS(UQ),this._stats.videoRecv.push(g)),g.ssrc=h.ssrc,g.packets=h.packetsReceived,g.packetsLost=h.packetsLost,g.bytes=h.bytesReceived,g.firsCount=h.firCount,g.nacksCount=h.nackCount,g.plisCount=h.pliCount,g.framesDecodeCount=h.framesDecoded,g.totalInterFrameDelay=h.totalInterFrameDelay,g.totalSquaredInterFrameDelay=h.totalSquaredInterFrameDelay;var j=this.lastDecodeVideoReceiverStats.get(g.ssrc),_e=this.lastVideoFramesDecode.get(g.ssrc),_n=Date.now();if(g.framesDecodeCount>0&&!this.isFirstVideoDecoded[g.ssrc]){var _o=g.decodedFrame?g.decodedFrame.width:0,_a=g.decodedFrame?g.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(g.ssrc,_o,_a),this.isFirstVideoDecoded[g.ssrc]=!0}if(j){var _r=j.stats,ba=_n-j.lts;g.framesDecodeFreezeTime=_r.framesDecodeFreezeTime,g.framesDecodeInterval=_r.framesDecodeInterval,!this.isFirstVideoDecoded[g.ssrc]&&ba>this.options.firstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(g.ssrc),g.framesDecodeCount>_r.framesDecodeCount&&this.isFirstVideoDecoded[g.ssrc]?(j.lts=Date.now(),g.framesDecodeInterval=ba,g.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(h.ssrc))?g.framesDecodeFreezeTime+=g.framesDecodeInterval:this.setVideoIsReady2(parseInt(h.ssrc,10),!0))):g.framesDecodeCount<_r.framesDecodeCount&&(g.framesDecodeInterval=0),h.framesDecoded&&h.qpSum&&(j.stats.framesDecodeCount>h.framesDecoded?g.qpSumPerFrame=h.qpSum/h.framesDecoded:g.qpSumPerFrame=(h.qpSum-j.qpSum)/(h.framesDecoded-j.stats.framesDecodeCount))}_e&&_n-_e.lts>=800?(g.decodeFrameRate=Math.round((g.framesDecodeCount-_e.count)/((_n-_e.lts)/1e3)),this.lastVideoFramesDecode.set(g.ssrc,{count:g.framesDecodeCount,lts:_n,rate:g.decodeFrameRate})):_e?g.decodeFrameRate=_e.rate:this.lastVideoFramesDecode.set(g.ssrc,{count:g.framesDecodeCount,lts:_n,rate:0}),h.totalDecodeTime&&(g.decodeMs=1e3*h.totalDecodeTime),this.processVideoTrackReceiverStats(h,h.trackId,g),h.codecId&&(g.codec=this.getCodecFromCodecStats(h.codecId)),h.framerateMean&&(g.framesRateFirefox=h.framerateMean),g.packets>0&&!this.isFirstVideoReceived[g.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(g.ssrc),this.isFirstVideoReceived[g.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(g.ssrc,{stats:fO({},g),lts:j?j.lts:Date.now(),qpSum:h.qpSum})},a.prototype.processVideoOutboundStats=function(h){var g=this._stats.videoSend.find(function(El){return El.ssrc===h.ssrc});g||(g=SS(jQ),this._stats.videoSend.push(g));var j,_e=this.mediaBytesSent.get(h.ssrc);if(_e?_e.add(h.bytesSent):((_o=new S9(10)).add(h.bytesSent),this.mediaBytesSent.set(h.ssrc,_o)),h.retransmittedBytesSent!==void 0){var _n=this.mediaBytesRetransmit.get(h.ssrc);_n?_n.add(h.retransmittedBytesSent):((_o=new S9(10)).add(h.retransmittedBytesSent),this.mediaBytesRetransmit.set(h.ssrc,_o))}if(h.totalEncodedBytesTarget){var _o,_a=this.mediaBytesTargetEncode.get(h.ssrc);_a?_a.add(h.totalEncodedBytesTarget):((_o=new S9(10)).add(h.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(h.ssrc,_o))}if(g.ssrc=h.ssrc,g.bytes=h.bytesSent,g.packets=h.packetsSent,g.firsCount=h.firCount,g.nacksCount=h.nackCount,g.plisCount=h.pliCount,g.frameCount=h.framesEncoded,g.adaptionChangeReason=h.qualityLimitationReason,h.totalEncodeTime&&h.framesEncoded)if(!(j=this.lastEncoderMs.get(h.ssrc))||j.lastFrameCount>h.framesEncoded)g.avgEncodeMs=1e3*h.totalEncodeTime/h.framesEncoded;else{var _r=h.framesEncoded-j.lastFrameCount,ba=h.totalEncodeTime-j.lastEncoderTime;g.avgEncodeMs=1e3*ba/_r}if(h.framesEncoded&&h.qpSum&&(!(j=this.lastEncoderMs.get(h.ssrc))||j.lastFrameCount>h.framesEncoded?g.qpSumPerFrame=h.qpSum/h.framesEncoded:g.qpSumPerFrame=(h.qpSum-j.lastQpSum)/(h.framesEncoded-j.lastFrameCount)),this.lastEncoderMs.set(h.ssrc,{lastFrameCount:h.framesEncoded,lastEncoderTime:h.totalEncodeTime,lastQpSum:h.qpSum,lts:Date.now()}),h.codecId&&(g.codec=this.getCodecFromCodecStats(h.codecId)),h.mediaSourceId&&this.processVideoMediaSource(h.mediaSourceId,g),this.processVideoTrackSenderStats(h,h.trackId,g),h.remoteId)this.processRemoteInboundStats(h.remoteId,g);else{var xa=this.findRemoteStatsId(h.ssrc,TS.REMOTE_INBOUND);xa&&this.processRemoteInboundStats(xa,g)}},a.prototype.processAudioOutboundStats=function(h){var g=this._stats.audioSend.find(function(_e){return _e.ssrc===h.ssrc});if(g||(g=SS(FQ),this._stats.audioSend.push(g)),g.ssrc=h.ssrc,g.packets=h.packetsSent,g.bytes=h.bytesSent,h.mediaSourceId&&this.processAudioMediaSource(h.mediaSourceId,g),h.codecId&&(g.codec=this.getCodecFromCodecStats(h.codecId)),this.processAudioTrackSenderStats(h,h.trackId,g),h.remoteId)this.processRemoteInboundStats(h.remoteId,g);else{var j=this.findRemoteStatsId(h.ssrc,TS.REMOTE_INBOUND);j&&this.processRemoteInboundStats(j,g)}},a.prototype.findRemoteStatsId=function(h,g){var j=Array.from(this.report.values()).find(function(_e){return _e.type===g&&_e.ssrc===h});return j?j.id:null},a.prototype.processVideoMediaSource=function(h,g){var j=this.report.get(h);j&&j.width&&j.height&&j.framesPerSecond&&(g.inputFrame={width:j.width,height:j.height,frameRate:j.framesPerSecond})},a.prototype.processAudioMediaSource=function(h,g){var j=this.report.get(h);j&&(g.inputLevel=j.audioLevel)},a.prototype.processVideoTrackSenderStats=function(h,g,j){var _e,_n,_o,_a=g?this.report.get(g):void 0,_r=(_e=_a==null?void 0:_a.framesSent)!==null&&_e!==void 0?_e:h.framesSent,ba=(_n=_a==null?void 0:_a.frameWidth)!==null&&_n!==void 0?_n:h.frameWidth,xa=(_o=_a==null?void 0:_a.frameHeight)!==null&&_o!==void 0?_o:h.frameHeight;if(typeof _r=="number"&&typeof ba=="number"&&typeof xa=="number"){var El=0,yl=Date.now(),Ol=this.lastVideoFramesSent.get(j.ssrc);Ol&&yl-Ol.lts>=800?(El=Math.round((_r-Ol.count)/((yl-Ol.lts)/1e3)),this.lastVideoFramesSent.set(j.ssrc,{count:_r,lts:yl,rate:El})):Ol?El=Ol.rate:this.lastVideoFramesSent.set(j.ssrc,{count:_r,lts:yl,rate:0}),j.sentFrame={width:ba,height:xa,frameRate:El}}},a.prototype.processVideoTrackReceiverStats=function(h,g,j){var _e,_n,_o,_a,_r,ba=g?this.report.get(g):void 0,xa=(_e=ba==null?void 0:ba.framesReceived)!==null&&_e!==void 0?_e:h.framesReceived,El=(_n=ba==null?void 0:ba.frameWidth)!==null&&_n!==void 0?_n:h.frameWidth,yl=(_o=ba==null?void 0:ba.frameHeight)!==null&&_o!==void 0?_o:h.frameHeight,Ol=(_a=ba==null?void 0:ba.jitterBufferDelay)!==null&&_a!==void 0?_a:h.jitterBufferDelay,Al=(_r=ba==null?void 0:ba.jitterBufferEmittedCount)!==null&&_r!==void 0?_r:h.jitterBufferEmittedCount;if(typeof xa=="number"){var Nl=this.lastVideoFramesRecv.get(j.ssrc),Ml=Date.now();j.framesReceivedCount=xa;var Fl=0;Nl&&Ml-Nl.lts>=800?(Fl=Math.round((xa-Nl.count)/((Ml-Nl.lts)/1e3)),this.lastVideoFramesRecv.set(j.ssrc,{count:xa,lts:Ml,rate:Fl})):Nl?Fl=Nl.rate:this.lastVideoFramesRecv.set(j.ssrc,{count:xa,lts:Ml,rate:0}),j.receivedFrame={width:El||0,height:yl||0,frameRate:Fl||0},j.decodedFrame={width:El||0,height:yl||0,frameRate:j.decodeFrameRate||0},j.outputFrame={width:El||0,height:yl||0,frameRate:j.decodeFrameRate||0}}if(Ol&&Al){var up=this.lastVideoJBDelay.get(j.ssrc);this.lastVideoJBDelay.set(j.ssrc,{jitterBufferDelay:Ol,jitterBufferEmittedCount:Al}),up||(up={jitterBufferDelay:0,jitterBufferEmittedCount:0});var _p=1e3*(Ol-up.jitterBufferDelay)/(Al-up.jitterBufferEmittedCount);j.jitterBufferMs=_p,j.currentDelayMs=Math.round(_p)}},a.prototype.processAudioTrackSenderStats=function(h,g,j){var _e,_n,_o,_a,_r=g?this.report.get(g):void 0,ba=(_n=(_e=_r==null?void 0:_r.echoReturnLoss)!==null&&_e!==void 0?_e:h.echoReturnLoss)!==null&&_n!==void 0?_n:0,xa=(_a=(_o=_r==null?void 0:_r.echoReturnLossEnhancement)!==null&&_o!==void 0?_o:h.echoReturnLossEnhancement)!==null&&_a!==void 0?_a:0;j.aecReturnLoss=ba,j.aecReturnLossEnhancement=xa},a.prototype.processAudioTrackReceiverStats=function(h,g,j){var _e,_n,_o,_a,_r,ba,xa,El=g?this.report.get(g):void 0,yl=(_e=El==null?void 0:El.removedSamplesForAcceleration)!==null&&_e!==void 0?_e:h.removedSamplesForAcceleration,Ol=(_n=El==null?void 0:El.totalSamplesReceived)!==null&&_n!==void 0?_n:h.totalSamplesReceived,Al=(_o=El==null?void 0:El.jitterBufferDelay)!==null&&_o!==void 0?_o:h.jitterBufferDelay,Nl=(_a=El==null?void 0:El.jitterBufferEmittedCount)!==null&&_a!==void 0?_a:h.jitterBufferEmittedCount,Ml=(_r=El==null?void 0:El.audioLevel)!==null&&_r!==void 0?_r:h==null?void 0:h.audioLevel,Fl=(ba=El==null?void 0:El.totalSamplesDuration)!==null&&ba!==void 0?ba:h==null?void 0:h.totalSamplesDuration,up=(xa=El==null?void 0:El.concealedSamples)!==null&&xa!==void 0?xa:h.concealedSamples;if(yl&&Ol&&(j.accelerateRate=yl/Ol),Al&&Nl){var _p=this.lastAudioJBDelay.get(j.ssrc);this.lastAudioJBDelay.set(j.ssrc,{jitterBufferDelay:Al,jitterBufferEmittedCount:Nl}),_p||(_p={jitterBufferDelay:0,jitterBufferEmittedCount:0});var Tp=1e3*(Al-_p.jitterBufferDelay)/(Nl-_p.jitterBufferEmittedCount);j.jitterBufferMs=Math.round(Tp)}j.outputLevel=Ml;var Fp=1920;Fl&&Ol&&(Fp=Ol/Fl/50,j.receivedFrames=Math.round(Ol/Fp)),up&&(j.droppedFrames=Math.round(up/Fp))},a.prototype.processRemoteInboundStats=function(h,g){var j=this.report.get(h);j&&(g.packetsLost=j.packetsLost,j.roundTripTime&&(g.rttMs=1e3*j.roundTripTime))},a.prototype.getCodecFromCodecStats=function(h){var g=this.report.get(h);if(!g)return"";var j=g.mimeType.match(/\/(.*)$/);return j&&j[1]?j[1]:""},a.prototype.updateSendBitrate=function(){var h=0,g=null,j=null;this.mediaBytesSent.forEach(function(_n){h+=_n.diffMean()}),this.mediaBytesRetransmit.forEach(function(_n){g=g===null?_n.diffMean():g+_n.diffMean()}),this.mediaBytesTargetEncode.forEach(function(_n){j=j===null?_n.diffMean():j+_n.diffMean()});var _e=g!==null?h-g:h;this._stats.bitrate={actualEncoded:8*_e/(this.options.updateInterval/1e3),transmit:8*h/(this.options.updateInterval/1e3)},g!==null&&(this._stats.bitrate.retransmit=8*g/(this.options.updateInterval/1e3)),j!==null&&(this._stats.bitrate.targetEncoded=8*j/(this.options.updateInterval/1e3))},a}(I9),dat=function(s){function a(){return s!==null&&s.apply(this,arguments)||this}return T9(a,s),a.prototype.updateStats=function(){return Promise.resolve()},a}(I9);function O9(s,a,h,g,j){a===void 0&&(a=250),h===void 0&&(h=8),g===void 0&&(g=500),j===void 0&&(j=1e4);var _e,_n=(_e=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i))&&_e[0]?Number(_e[0].split("/")[1]):null;return _n?_n<76?new lat(s,{updateInterval:a,lossRateInterval:h,freezeRateLimit:g,firstVideoDecodedTimeout:j}):new BQ(s,{updateInterval:a,lossRateInterval:h,freezeRateLimit:g,firstVideoDecodedTimeout:j}):function(_o){return!!window.RTCStatsReport&&_o.getStats()instanceof Promise}(s)?new BQ(s,{updateInterval:a,lossRateInterval:h,freezeRateLimit:g,firstVideoDecodedTimeout:j}):new dat(s,{updateInterval:a,lossRateInterval:h,freezeRateLimit:g,firstVideoDecodedTimeout:j})}function GQ(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function qQ(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?GQ(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):GQ(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}let hat=(Wp((l_=class dU extends E4{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}constructor(a,h){super(a,h),Rl(this,"store",void 0),Rl(this,"peerConnection",void 0),Rl(this,"remoteSDP",void 0),Rl(this,"initialOffer",void 0),Rl(this,"statsFilter",void 0),Rl(this,"useRTX",!1),Rl(this,"localCapabilities",void 0),Rl(this,"localCandidateCount",0),Rl(this,"allCandidatesReceived",!1),Rl(this,"mutex",new B1("P2PConnection-mutex")),this.store=h,this.peerConnection=new RTCPeerConnection(dU.resolvePCConfiguration(a),{optional:[{googDscp:!0}]}),this.statsFilter=O9(this.peerConnection,void 0,void 0,M_()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(){try{const a=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!a.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const h=pO(a.sdp),g=E9(a.sdp,!this.useRTX,wp("FILTER_VIDEO_FEC"),wp("FILTER_AUDIO_FEC"),["opus"]);return this.localCapabilities=g,this.initialOffer=a,qQ(qQ({},h),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:g},offerSDP:a.sdp})}catch(a){throw new Ql(Hl.GET_LOCAL_CONNECTION_PARAMS_FAILED,a.toString())}}async connect(a,h,g,j,_e,_n){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new uat({remoteIceParameters:a,remoteDtlsParameters:h,candidates:g,remoteRTPCapabilities:j.send,remoteSetup:_e,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:_n});const _o=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_o})}catch(_o){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(_o.toString()))}}send(a,h){var g=this;return bS(function*(){const j=yield V0(g.mutex.lock());try{if(!g.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const _e=a.map(El=>g.peerConnection.addTrack(El._mediaStreamTrack)),_n=yield V0(g.peerConnection.createOffer()),_o=K_.exports.parse(_n.sdp),_a=a.map(El=>{const yl=El._mediaStreamTrack,Ol=_o.mediaDescriptions.find(Al=>Al.attributes.mid===yl.kind);if(!Ol)throw new Error("Cannot extract ssrc from mediaDescription.");return function(Al,Nl,Ml){const Fl=Al.attributes.ssrcs.filter(_p=>_p.attributes.label===Nl),up=Al.attributes.ssrcGroups;if(Fl.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(up&&Fl.length>1){const _p=up.find(Tp=>Tp.ssrcIds.indexOf(Fl[0].ssrcId)!==-1);return _p?[{ssrcId:_p.ssrcIds[0],rtx:Ml?_p.ssrcIds[1]:void 0}]:[{ssrcId:Fl[0].ssrcId}]}return[{ssrcId:Fl[0].ssrcId}]}(Ol,yl.id,g.useRTX)});let _r;try{_r=yield _a}catch(El){throw _e.forEach(yl=>{iy()&&yl.replaceTrack(null),g.peerConnection.removeTrack(yl)}),El}const ba=g.mungSendOfferSDP(_n.sdp,a);g.remoteSDP.receive(a,h,_r);const xa=g.remoteSDP.toString();return yield V0(g.peerConnection.setLocalDescription({type:"offer",sdp:ba})),yield V0(g.applySendEncodings(_e,a)),yield V0(g.peerConnection.setRemoteDescription({type:"answer",sdp:xa})),a.map((El,yl)=>{const Ol=El._mediaStreamTrack.id;return{localSSRC:_a[yl],id:Ol}})}catch(_e){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(_e.toString()))}finally{j()}})()}async stopSending(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const h=this.peerConnection.getSenders().filter(_e=>{var _n;return a.indexOf(((_n=_e.track)===null||_n===void 0?void 0:_n.id)||"")!==-1});if(h.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");h.map(_e=>{iy()&&_e.replaceTrack(null),this.peerConnection.removeTrack(_e)});const g=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(g),this.remoteSDP.stopReceiving(a);const j=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:j})}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(h.toString()))}}async receive(a,h,g,j){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(a," before remoteSDP created."));const{id:_e,mslabel:_n}=this.remoteSDP.send(a,h,j),_o=new s0((ba,xa)=>{const El=setTimeout(()=>{xa(new Error("Cannot receive track, id: ".concat(_e)))},1e4),yl=Ol=>{const Al=p_();if((Al.name==="Safari"&&Number(Al.version)===11||x1())&&Ol.track.id!==_e&&Ol.streams[0].id===_n){var Nl;const Ml=Ol.streams[0].getTracks()[0];return(Nl=this.remoteSDP)===null||Nl===void 0||Nl.updateTrackLabel(a,_e,Ol.track.id),this.peerConnection.removeEventListener("track",yl),clearTimeout(El),void ba(Ml)}if(Ol.track.id===_e)return this.peerConnection.removeEventListener("track",yl),clearTimeout(El),void ba(Ol.track)};this.peerConnection.addEventListener("track",yl)}),_a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_a});const _r=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(_r),{track:await _o,id:_e}}catch(_e){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_e.toString()))}}async stopReceiving(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(a);const h=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const g=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(g)}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(h.toString()))}}async muteRemote(a){}async unmuteRemote(a){}async muteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const h=this.peerConnection.getSenders().filter(g=>{var j;return a.indexOf(((j=g.track)===null||j===void 0?void 0:j.id)||"")!==-1});if(h.length!==a.length)throw new Error("sender' length doesn't match mids' length.");h.map(g=>{if(iy()&&g.track)g.track.enabled=!1;else{const j=g.getParameters();j.encodings.forEach(_e=>_e.active=!1),g.setParameters(j)}})}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(h.toString()))}}async unmuteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const h=this.peerConnection.getSenders().filter(_e=>{var _n;return a.indexOf(((_n=_e.track)===null||_n===void 0?void 0:_n.id)||"")!==-1});if(h.length!==a.length)throw new Error("Senders' length doesn't match mids' length.");h.map(async _e=>{if(iy()&&_e.track)_e.track.enabled=!0;else{const _n=_e.getParameters();_n.encodings.forEach(_o=>_o.active=!0),await _e.setParameters(_n)}});const g=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(g);const j=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:j})}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(h.toString()))}}restartICE(){var a=this;return bS(function*(){const h=yield V0(a.mutex.lock("From P2PConnection.restartICE"));try{const g=yield V0(a.peerConnection.createOffer({iceRestart:!0}));if(!g.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const j=pO(g.sdp),{remoteIceParameters:_e}=yield j.iceParameters;if(!a.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");a.remoteSDP.restartICE(_e);const _n=a.remoteSDP.toString();yield V0(a.peerConnection.setLocalDescription(g)),yield V0(a.peerConnection.setRemoteDescription({type:"answer",sdp:_n}))}catch(g){Ll.warning("restart ICE failed, abort operation",g)}finally{h()}})()}close(){var a;this.peerConnection.close(),(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(a){return this.statsFilter.getVideoIsReady(a)}async updateEncoderConfig(a,h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const g=await this.peerConnection.createOffer(),j=this.mungSendOfferSDP(g.sdp,[h]);this.remoteSDP.updateRecvMedia(h._mediaStreamTrack.kind,h);const _e=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:j}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_e})}catch(g){throw new Ql(Hl.EXCHANGE_SDP_FAILED,g.toString())}}async updateSendParameters(a,h){const g=this.peerConnection.getSenders().filter(j=>{var _e;return((_e=j.track)===null||_e===void 0?void 0:_e.id)===a});g.length===1&&await this.applySendEncodings(g,[h])}setStatsRemoteVideoIsReady(a,h){this.statsFilter.setVideoIsReady2(a,h)}async replaceTrack(a,h){const g=this.peerConnection.getSenders().find(j=>{var _e;return((_e=j.track)===null||_e===void 0?void 0:_e.id)===h});g&&await g.replaceTrack(a._mediaStreamTrack)}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var a;(a=this.onICEConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var a;(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=a=>{a.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,Ll.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,Ll.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},wp("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(a){const h={iceServers:[],sdpSemantics:"plan-b"};return a.iceServers?h.iceServers=a.iceServers:a.turnServer&&a.turnServer.mode!=="off"&&(RP(a.turnServer.servers)?h.iceServers=a.turnServer.servers:(h.iceServers&&h.iceServers.push(...dU.turnServerConfigToIceServers(a.turnServer.servers)),wp("USE_TURN_SERVER_OF_GATEWAY")&&h.iceServers&&a.turnServer.serversFromGateway&&h.iceServers.push(...dU.turnServerConfigToIceServers(a.turnServer.serversFromGateway)),a.turnServer.servers.concat(a.turnServer.serversFromGateway||[]).forEach(g=>{g.forceturn&&(h.iceTransportPolicy="relay")}))),h}static turnServerConfigToIceServers(a){const h=[];return a.forEach(g=>{g.security?g.tcpport&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turns:".concat(g.turnServerURL,":").concat(g.tcpport,"?transport=tcp")}):(g.udpport&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turn:".concat(g.turnServerURL,":").concat(g.udpport,"?transport=udp")}),g.tcpport&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turn:".concat(g.turnServerURL,":").concat(g.tcpport,"?transport=tcp")}))}),h}async applySendEncodings(a,h){try{if(!O1().supportSetRtpSenderParameters||a.length!==h.length)return;for(let j=0;j<a.length;j++){var g;const _e=a[j],_n=h[j];if(!_n)continue;const _o={},_a={};if(_n instanceof H_)switch(_n._optimizationMode){case"motion":_o.degradationPreference="maintain-framerate";break;case"detail":_o.degradationPreference="maintain-resolution";break;default:_o.degradationPreference="balanced"}if(wp("DSCP_TYPE")&&_I()){const xa=wp("DSCP_TYPE");["very-low","low","medium","high"].includes(xa)&&(_a.networkPriority=xa)}const _r=_e.getParameters(),ba=(g=_r.encodings)===null||g===void 0?void 0:g[0];ba&&Object.assign(ba,_a),Object.assign(_r,_o),await _e.setParameters(_r)}}catch{Ll.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(a,h){const g=K_.exports.parse(a);return h.forEach((j,_e)=>{const _n=j._mediaStreamTrack,_o=g.mediaDescriptions.find(_a=>_a.attributes.mid===_n.kind);_o&&cN(_o,j)}),K_.exports.print(g)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=a=>{var h;(h=this.onFirstAudioReceived)===null||h===void 0||h.call(this,a)},this.statsFilter.onFirstVideoReceived=a=>{var h;(h=this.onFirstVideoReceived)===null||h===void 0||h.call(this,a)},this.statsFilter.onFirstAudioDecoded=a=>{var h;(h=this.onFirstAudioDecoded)===null||h===void 0||h.call(this,a)},this.statsFilter.onFirstVideoDecoded=(a,h,g)=>{var j;(j=this.onFirstVideoDecoded)===null||j===void 0||j.call(this,a,h,g)},this.statsFilter.onSelectedLocalCandidateChanged=(a,h)=>{var g;(g=this.onSelectedLocalCandidateChanged)===null||g===void 0||g.call(this,a,h)},this.statsFilter.onSelectedRemoteCandidateChanged=(a,h)=>{var g;(g=this.onSelectedRemoteCandidateChanged)===null||g===void 0||g.call(this,a,h)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const h=this.remoteSDP.batchSend(a).map((_e,_n)=>{let{id:_o,mslabel:_a}=_e;const{kind:_r}=a[_n];return new s0((ba,xa)=>{const El=setTimeout(()=>{xa(new Error("Cannot receive track, id: ".concat(_o)))},1e4),yl=Ol=>{const Al=p_();if(Al.name==="Safari"&&Number(Al.version)===11&&Ol.track.id!==_o&&Ol.streams[0].id===_a){var Nl;const Ml=Ol.streams[0].getTracks()[0];return(Nl=this.remoteSDP)===null||Nl===void 0||Nl.updateTrackLabel(_r,_o,Ol.track.id),this.peerConnection.removeEventListener("track",yl),clearTimeout(El),void ba({track:Ml,id:_o})}if(Ol.track.id===_o)return this.peerConnection.removeEventListener("track",yl),clearTimeout(El),void ba({track:Ol.track,id:_o})};this.peerConnection.addEventListener("track",yl)})}),g=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const j=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(j),await s0.all(h)}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(h.toString()))}}async getRemoteSSRC(a){if(!this.remoteSDP)return;const h=this.remoteSDP.getSSRC(a);return h==null?void 0:h[0].ssrcId}}).prototype,"connect",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"connect"),l_.prototype),Wp(l_.prototype,"stopSending",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"stopSending"),l_.prototype),Wp(l_.prototype,"receive",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"receive"),l_.prototype),Wp(l_.prototype,"stopReceiving",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"stopReceiving"),l_.prototype),Wp(l_.prototype,"muteRemote",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"muteRemote"),l_.prototype),Wp(l_.prototype,"unmuteRemote",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"unmuteRemote"),l_.prototype),Wp(l_.prototype,"muteLocal",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"muteLocal"),l_.prototype),Wp(l_.prototype,"unmuteLocal",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"unmuteLocal"),l_.prototype),Wp(l_.prototype,"close",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"close"),l_.prototype),Wp(l_.prototype,"updateEncoderConfig",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"updateEncoderConfig"),l_.prototype),Wp(l_.prototype,"updateSendParameters",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"updateSendParameters"),l_.prototype),Wp(l_.prototype,"replaceTrack",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"replaceTrack"),l_.prototype),Wp(l_.prototype,"getRemoteSSRC",[_b],Object.getOwnPropertyDescriptor(l_.prototype,"getRemoteSSRC"),l_.prototype),l_);function _b(s,a,h){const g=s[a];if(typeof g!="function")throw new Error("Cannot use mutex on object property.");return h.value=async function(){const j=this.mutex,_e=await j.lock("Locking from P2PConnection.".concat(a));try{for(var _n=arguments.length,_o=new Array(_n),_a=0;_a<_n;_a++)_o[_a]=arguments[_a];return await g.apply(this,_o)}finally{_e()}},h}const Z4="9",WQ=4e4;class pat{get localCapabilities(){return W_(this._localCapabilities)}get rtpCapabilities(){return W_(this._rtpCapabilities)}get candidates(){return W_(this._candidates)}get iceParameters(){return W_(this._iceParameters)}get dtlsParameters(){return W_(this._dtlsParameters)}constructor(a){Rl(this,"sessionDesc",void 0),Rl(this,"_localCapabilities",void 0),Rl(this,"_rtpCapabilities",void 0),Rl(this,"_candidates",void 0),Rl(this,"_iceParameters",void 0),Rl(this,"_dtlsParameters",void 0),Rl(this,"setup",void 0),Rl(this,"currentMidIndex",void 0),Rl(this,"cname",void 0),Rl(this,"firefoxSsrcMidMap",new Map),a=W_(a);const{remoteIceParameters:h,remoteDtlsParameters:g,candidates:j,remoteRTPCapabilities:_e,remoteSetup:_n,localCapabilities:_o,cname:_a}=a,_r=K_.exports.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`);this._rtpCapabilities=_e,this._candidates=j,this._iceParameters=h,this._dtlsParameters=g,this._localCapabilities=_o,this.setup=_n,this.cname=_a;const ba=this.rtpCapabilities.send;for(const xa of _r.mediaDescriptions){if(xa.attributes.iceUfrag=h.iceUfrag,xa.attributes.icePwd=h.icePwd,xa.attributes.fingerprints=g.fingerprints,xa.attributes.candidates=j,xa.attributes.setup=_n,xa.media.mediaType==="video"&&(xa.media.fmts=ba.videoCodecs.map(El=>El.payloadType.toString(10)),xa.attributes.payloads=ba.videoCodecs,xa.attributes.extmaps=ba.videoExtensions,wp("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:El,ssrcGroups:yl}=Zy([{ssrcId:WQ,rtx:wp("USE_RTX")?40001:void 0}],this.cname);xa.attributes.ssrcs=El,xa.attributes.ssrcGroups=yl}if(xa.media.mediaType==="audio"&&(xa.media.fmts=ba.audioCodecs.map(El=>El.payloadType.toString(10)),xa.attributes.payloads=ba.audioCodecs,xa.attributes.extmaps=ba.audioExtensions,IR(xa),wp("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:El,ssrcGroups:yl}=Zy([{ssrcId:2e4}],this.cname);xa.attributes.ssrcs=El,xa.attributes.ssrcGroups=yl}}this.sessionDesc=_r,this.currentMidIndex=_r.mediaDescriptions.length-1}preloadRemoteMedia(){const a=wp("PRELOAD_MEDIA_COUNT");this.rtpCapabilities;const h=this.candidates,g=this.dtlsParameters,j=this.iceParameters,_e=this.rtpCapabilities.send;for(let _n=1;_n<a;_n++){const _o=2*_n+2e4,_a=2*_n+WQ,{ssrcs:_r,ssrcGroups:ba}=Zy([{ssrcId:_o}],this.cname),{ssrcs:xa,ssrcGroups:El}=Zy([{ssrcId:_a,rtx:wp("USE_RTX")?_a+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:Z4,protos:["UDP","TLS","RTP","SAVPF"],fmts:_e.videoCodecs.map(yl=>yl.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:j.iceUfrag,icePwd:j.icePwd,unrecognized:[],candidates:h,extmaps:_e.videoExtensions,fingerprints:g.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:xa,ssrcGroups:El,rtcpFeedbackWildcards:[],payloads:_e.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*_n)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:Z4,protos:["UDP","TLS","RTP","SAVPF"],fmts:_e.audioCodecs.map(yl=>yl.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:j.iceUfrag,icePwd:j.icePwd,unrecognized:[],candidates:h,extmaps:_e.audioExtensions,fingerprints:g.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_r,ssrcGroups:ba,rtcpFeedbackWildcards:[],payloads:_e.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*_n+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return K_.exports.print(this.sessionDesc)}send(a,h,g,j){const{ssrcs:_e,ssrcGroups:_n}=Zy(h,this.cname,g),_o=this.findPreloadMediaDesc(_e);if(_o){if(M_()&&this.firefoxSsrcMidMap.set(_e[0].ssrcId,_o.attributes.mid),j&&(j.tcc||j.remb)){const _a=this.sessionDesc.mediaDescriptions.indexOf(_o);return this.sessionDesc.mediaDescriptions[_a]=this.mungSendMediaDesc(_o,j),{mid:_o.attributes.mid,needExchangeSDP:!0}}return{mid:_o.attributes.mid,needExchangeSDP:!1}}{const _a=this.findAvailableMediaIndex(a,_e);let _r;return _a===-1||iy()||x1()||gV()?(_r=this.createOrRecycleSendMedia(a,_e,_n,"sendonly",j),this.updateBundleMids()):(_r=W_(this.sessionDesc.mediaDescriptions[_a]),_r.attributes.direction="sendonly",_r.attributes.ssrcs=_e,_r.attributes.ssrcGroups=_n,this.sessionDesc.mediaDescriptions[_a]=this.mungSendMediaDesc(_r,j)),M_()&&this.firefoxSsrcMidMap.set(_e[0].ssrcId,_r.attributes.mid),{mid:_r.attributes.mid,needExchangeSDP:!0}}}batchSend(a){const h=a.map(_e=>{let{kind:_n,ssrcMsg:_o,mslabel:_a}=_e;return this.send(_n,_o,_a)}),g=[];let j=!1;return h.forEach(_e=>{let{mid:_n,needExchangeSDP:_o}=_e;_o&&(j=!0),g.push(_n)}),{mids:g,needExchangeSDP:j}}stopSending(a){const h=this.sessionDesc.mediaDescriptions.filter(g=>g.attributes.mid&&a.indexOf(g.attributes.mid)!==-1);if(h.length!==a.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");h.forEach(g=>{g.attributes.mid==="0"||M_()||iy()||x1()?g.attributes.ssrcs=[]:(g.attributes.ssrcs=[],g.attributes.direction="inactive",g.media.port="0")}),this.updateBundleMids()}mute(a){const h=this.sessionDesc.mediaDescriptions.find(g=>g.attributes.mid===a);if(!h)throw new Error("mediaDescription not found with ".concat(a," in remote SDP when calling RemoteSDP.mute."));h.attributes.direction="inactive"}unmute(a){const h=this.sessionDesc.mediaDescriptions.find(g=>g.attributes.mid===a);if(!h)throw new Error("mediaDescription not found with ".concat(a," in remote SDP when calling RemoteSDP.unmute."));h.attributes.direction="sendonly"}muteRemote(a){const h=this.sessionDesc.mediaDescriptions.filter(g=>a.includes(g.attributes.mid||""));if(h.length!==a.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");h.forEach(g=>{g.attributes.direction="inactive"})}unmuteRemote(a){const h=this.sessionDesc.mediaDescriptions.filter(g=>a.includes(g.attributes.mid||""));if(h.length!==a.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");h.forEach(g=>{g.attributes.direction="recvonly"})}receive(a,h,g,j){a.forEach((_e,_n)=>{this.createOrRecycleRecvMedia(_e,[],"recvonly",h,g,j[_n])}),this.updateBundleMids()}stopReceiving(a){const h=this.sessionDesc.mediaDescriptions.filter(g=>a.indexOf(g.attributes.mid)!==-1);if(h.length!==a.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");h.forEach(g=>{g.media.port="0",g.attributes.direction="inactive"}),this.updateBundleMids()}restartICE(a){a=W_(a),this._iceParameters=a,this.sessionDesc.mediaDescriptions.forEach(h=>{h.attributes.iceUfrag=a.iceUfrag,h.attributes.icePwd=a.icePwd})}predictReceivingMids(a){const h=[];for(let g=0;g<a;g++)h.push((this.currentMidIndex+g+1).toString(10));return h}findAvailableMediaIndex(a,h){return this.sessionDesc.mediaDescriptions.findIndex(g=>{const j=g.media.mediaType===a&&g.media.port!=="0"&&(g.attributes.direction==="sendonly"||g.attributes.direction==="sendrecv")&&g.attributes.ssrcs.length===0;if(M_()){if(j){const _e=this.firefoxSsrcMidMap.get(h[0].ssrcId);return!(_e||g.attributes.mid!=="0"&&g.attributes.mid!=="1")||!(!_e||_e!==g.attributes.mid)}return!1}return j})}createOrRecycleRecvMedia(a,h,g,j,_e,_n){const _o=a._mediaStreamTrack.kind,_a=this.rtpCapabilities.recv,_r=this.localCapabilities.send;let ba=[];if(_o===N0.VIDEO){var xa,El;if(wp("H264_PROFILE_LEVEL_ID")&&j==="h264"&&(ba=_a.videoCodecs.filter(Ml=>{var Fl,up;return(((Fl=Ml.rtpMap)===null||Fl===void 0?void 0:Fl.encodingName.toLowerCase())||"").includes(j)&&(Ml==null||(up=Ml.fmtp)===null||up===void 0?void 0:up.parameters["profile-level-id"])===wp("H264_PROFILE_LEVEL_ID")})),!ba||((xa=ba)===null||xa===void 0?void 0:xa.length)===0){const Ml=_r.videoCodecs.filter(Fl=>{var up;return(((up=Fl.rtpMap)===null||up===void 0?void 0:up.encodingName.toLowerCase())||"").includes(j)});Ml.length!==0&&(ba=_a.videoCodecs.filter(Fl=>Ml.some(up=>up.payloadType===Fl.payloadType)))}if(wp("USE_RTX")){const Ml=ba.map(up=>up.payloadType.toString()),Fl=_a.videoCodecs.filter(up=>{var _p,Tp;return((_p=up.rtpMap)===null||_p===void 0?void 0:_p.encodingName)==="rtx"&&Ml.includes(((Tp=up.fmtp)===null||Tp===void 0?void 0:Tp.parameters.apt)||"")});ba=[...ba,...Fl]}ba.length===0&&(Ll.warning("codec ".concat(j," not included in rtpCapabilities, fallback to default payloads: ").concat((El=_a.videoCodecs[0].rtpMap)===null||El===void 0?void 0:El.encodingName)),ba=_a.videoCodecs)}else ba=_a.audioCodecs.filter(Ml=>{var Fl;return(((Fl=Ml.rtpMap)===null||Fl===void 0?void 0:Fl.encodingName.toLowerCase())||"").includes(_e)}),ba.length===0&&(Ll.warning("codec ".concat(_e," not included in rtpCapabilities, fallback to opus")),ba=_a.audioCodecs.filter(Ml=>{var Fl;return(((Fl=Ml.rtpMap)===null||Fl===void 0?void 0:Fl.encodingName.toLowerCase())||"").includes("opus")}));const yl=_o===N0.VIDEO?_a.videoExtensions:_a.audioExtensions;this.currentMidIndex+=1;const Ol="".concat(this.currentMidIndex);let Al={media:{mediaType:_o,port:Z4,protos:["UDP","TLS","RTP","SAVPF"],fmts:ba.map(Ml=>Ml.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:yl,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:h,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:ba,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:g,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(Ol)}};Al=this.mungRecvMediaDsec(Al,a,_n);const Nl=this.findFirstClosedMedia(_o);if(Nl){const Ml=this.sessionDesc.mediaDescriptions.indexOf(Nl);this.sessionDesc.mediaDescriptions[Ml]=Al}else this.sessionDesc.mediaDescriptions.push(Al);return Al}createOrRecycleSendMedia(a,h,g,j,_e){const _n=this.rtpCapabilities.send,_o=a===N0.VIDEO?_n.videoCodecs:_n.audioCodecs,_a=a===N0.VIDEO?_n.videoExtensions:_n.audioExtensions;this.currentMidIndex+=1;const _r="".concat(this.currentMidIndex);let ba={media:{mediaType:a,port:Z4,protos:["UDP","TLS","RTP","SAVPF"],fmts:_o.map(El=>El.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:_a,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:h,ssrcGroups:g,rtcpFeedbackWildcards:[],payloads:_o,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:j,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_r)}};ba=this.mungSendMediaDesc(ba,_e);const xa=this.findFirstClosedMedia(a);if(xa){const El=this.sessionDesc.mediaDescriptions.indexOf(xa);this.sessionDesc.mediaDescriptions[El]=ba}else this.sessionDesc.mediaDescriptions.push(ba);return ba}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(a=>a.media.port!=="0").map(a=>a.attributes.mid)}mungRecvMediaDsec(a,h,g){const j=W_(a);return _9(j),cN(j,h),y9(j,h),kQ(j),Q4(j,g,this.localCapabilities.send),j}mungSendMediaDesc(a,h){const g=W_(a);return Q4(g,h,this.localCapabilities.recv),IR(g),g}updateRecvMedia(a,h){const g=this.sessionDesc.mediaDescriptions.findIndex(j=>j.attributes.mid===a);if(g!==-1){const j=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[g],h);this.sessionDesc.mediaDescriptions[g]=j}}bumpMid(a){this.currentMidIndex+=a}findFirstClosedMedia(a){return this.sessionDesc.mediaDescriptions.find(h=>M_()?h.media.port==="0"&&h.media.mediaType===a:h.media.port==="0")}findPreloadMediaDesc(a){return this.sessionDesc.mediaDescriptions.find(h=>{var g,j;return((g=h.attributes)===null||g===void 0||(j=g.ssrcs[0])===null||j===void 0?void 0:j.ssrcId)===a[0].ssrcId})}getSSRC(a){var h;return(h=this.sessionDesc.mediaDescriptions.find(g=>g.attributes.mid===a))===null||h===void 0?void 0:h.attributes.ssrcs}}var d_;function HQ(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function KQ(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?HQ(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):HQ(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}let fat=(Wp((d_=class hU extends E4{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(a,h){super(a,h),Rl(this,"store",void 0),Rl(this,"peerConnection",void 0),Rl(this,"remoteSDP",void 0),Rl(this,"initialOffer",void 0),Rl(this,"transportEventReceiver",void 0),Rl(this,"statsFilter",void 0),Rl(this,"useRTX",wp("USE_RTX")),Rl(this,"localCapabilities",void 0),Rl(this,"localCandidateCount",0),Rl(this,"allCandidatesReceived",!1),Rl(this,"mutex",new B1("P2PConnection-mutex")),this.store=h,this.peerConnection=new RTCPeerConnection(hU.resolvePCConfiguration(a),{optional:[{googDscp:!0}]}),this.statsFilter=O9(this.peerConnection,void 0,void 0,M_()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const a=await this.peerConnection.createOffer();if(!a.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const h=pO(a.sdp),g=await PQ(!this.useRTX,wp("FILTER_VIDEO_FEC"),wp("FILTER_AUDIO_FEC"));return this.localCapabilities=b9(g),this.initialOffer=a,KQ(KQ({},h),{},{rtpCapabilities:g,offerSDP:a.sdp})}catch(a){throw new Ql(Hl.GET_LOCAL_CONNECTION_PARAMS_FAILED,a.toString())}}async connect(a,h,g,j,_e,_n){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new pat({remoteIceParameters:a,remoteDtlsParameters:h,candidates:g,remoteRTPCapabilities:j,remoteSetup:_e,localCapabilities:this.localCapabilities,cname:_n});const _o=this.remoteSDP.toString(),_a=K_.exports.parse(this.initialOffer.sdp),_r=_a.mediaDescriptions.find(yl=>yl.media.mediaType==="audio");_r&&IR(_r);const ba=K_.exports.print(_a),xa=this.logSDPExchange(ba||"","offer","local","connect");await this.peerConnection.setLocalDescription({type:"offer",sdp:ba}),xa==null||xa(_o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_o});const El=this.peerConnection.getTransceivers()[0];if(El!=null&&El.receiver&&this.tryBindTransportEvents(El.receiver),wp("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const yl=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:yl});const Ol=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(Ol)}}catch(_o){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(_o.toString()))}}send(a,h,g){var j=this;return bS(function*(){const _e=yield V0(j.mutex.lock("From P2PConnection.send"));try{if(!j.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const _n=[];a.forEach(Al=>{const Nl=j.peerConnection.addTransceiver(Al._mediaStreamTrack,{direction:"sendonly"});_n.push(Nl)}),M_()&&wp("SIMULCAST")===!0&&(yield V0(j.applySimulcastForFirefox(_n,a)));const _o=yield V0(j.peerConnection.createOffer()),_a=j.remoteSDP.predictReceivingMids(a.length),_r=j.mungSendOfferSDP(_o.sdp,a,_a),ba=K_.exports.parse(_r),xa=_a.map(Al=>{const Nl=ba.mediaDescriptions.find(Ml=>Ml.attributes.mid===Al);if(!Nl)throw new Error("Cannot extract ssrc from mediaDescription.");return AQ(Nl,j.useRTX)});let El;try{El=yield xa}catch(Al){El=[],j.remoteSDP.receive(a,h,g,El);const Nl=j.remoteSDP.toString();throw yield V0(j.peerConnection.setLocalDescription({type:"offer",sdp:_r})),yield V0(j.peerConnection.setRemoteDescription({type:"answer",sdp:Nl})),yield V0(j.stopSending(_a,!0)),Al}j.remoteSDP.receive(a,h,g,El);const yl=j.remoteSDP.toString(),Ol=j.logSDPExchange(_r,"offer","local","send");return yield V0(j.peerConnection.setLocalDescription({type:"offer",sdp:_r})),yield V0(j.applySimulcastEncodings(_n,a)),yield V0(j.applySendEncodings(_n,a)),Ol==null||Ol(yl),yield V0(j.peerConnection.setRemoteDescription({type:"answer",sdp:yl})),_n.map((Al,Nl)=>{const Ml=_a[Nl];return{localSSRC:xa[Nl],id:Ml,transceiver:Al}})}catch(_n){throw _n instanceof Ql?_n:new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(_n.toString()))}finally{_e()}})()}async stopSending(a,h){const g=h?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const j=this.peerConnection.getTransceivers().filter(_a=>a.indexOf(_a.mid)!==-1);if(j.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");j.map(_a=>{var _r;_a.direction="inactive",(_r=_a.stop)===null||_r===void 0||_r.call(_a)});const _e=await this.peerConnection.createOffer(),_n=this.logSDPExchange(_e.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(_e),this.remoteSDP.stopReceiving(a);const _o=this.remoteSDP.toString();_n==null||_n(_o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_o})}catch(j){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(j.toString()))}finally{g&&g()}}async receive(a,h,g,j){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(a," before remoteSDP created."));const{mid:_e,needExchangeSDP:_n}=this.remoteSDP.send(a,h,g,j);if(_n){const _a=this.remoteSDP.toString(),_r=this.logSDPExchange(_a,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_a});const ba=await this.peerConnection.createAnswer(),xa=this.mungReceiveAnswerSDP(ba.sdp,_e,a);_r==null||_r(xa||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:xa}),Ll.debug("[P2PConnection] receive ".concat(a," by exchanging SDP."))}else Ll.debug("[P2PConnection] receive ".concat(a," no need to exchange SDP."));const _o=this.peerConnection.getTransceivers().find(_a=>_a.mid===_e);if(!_o)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_o.receiver.track,id:_e}}catch(_e){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_e.toString()))}}async batchReceive(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:h,needExchangeSDP:g}=this.remoteSDP.batchSend(a);if(g){const j=this.remoteSDP.toString(),_e=this.logSDPExchange(j,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:j});const _n=await this.peerConnection.createAnswer();_e==null||_e(_n.sdp||""),await this.peerConnection.setLocalDescription(_n),Ll.debug("[P2PConnection] batchReceive by exchanging SDP.")}else Ll.debug("[P2PConnection] batchReceive no need to exchange SDP.");return h.map(j=>{const _e=this.peerConnection.getTransceivers().find(_n=>_n.mid===j);if(!_e)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_e.receiver.track,id:j}})}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(h.toString()))}}async stopReceiving(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(a);const h=this.remoteSDP.toString(),g=this.logSDPExchange(h,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const j=await this.peerConnection.createAnswer();g==null||g(j.sdp||""),await this.peerConnection.setLocalDescription(j)}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(h.toString()))}}async muteRemote(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(a," before remote SDP created."));this.remoteSDP.mute(a);const h=this.remoteSDP.toString(),g=this.logSDPExchange(h,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const j=await this.peerConnection.createAnswer();g==null||g(j.sdp||""),await this.peerConnection.setLocalDescription(j)}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(h.toString()))}}async unmuteRemote(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(a," before remote SDP created."));this.remoteSDP.unmute(a);const h=this.remoteSDP.toString(),g=this.logSDPExchange(h,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const j=await this.peerConnection.createAnswer();g==null||g(j.sdp||""),await this.peerConnection.setLocalDescription(j)}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(h.toString()))}}async muteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const h=this.peerConnection.getTransceivers().filter(_n=>_n.mid&&a.indexOf(_n.mid)!==-1);if(h.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");h.map(_n=>{_n.direction="inactive"});const g=await this.peerConnection.createOffer(),j=this.logSDPExchange(g.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(g),this.remoteSDP.muteRemote(a);const _e=this.remoteSDP.toString();j==null||j(_e),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_e})}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(h.toString()))}}async unmuteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const h=this.peerConnection.getTransceivers().filter(_n=>_n.mid&&a.indexOf(_n.mid)!==-1);if(h.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");h.map(async(_n,_o)=>{_n.direction="sendonly"});const g=await this.peerConnection.createOffer(),j=this.logSDPExchange(g.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(g),this.remoteSDP.unmuteRemote(a);const _e=this.remoteSDP.toString();j==null||j(_e),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_e})}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(h.toString()))}}restartICE(){var a=this;return bS(function*(){const h=yield V0(a.mutex.lock("From P2PConnection.restartICE"));try{const g=yield V0(a.peerConnection.createOffer({iceRestart:!0}));if(!g.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const j=pO(g.sdp),{remoteIceParameters:_e}=yield j.iceParameters;if(!a.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");a.remoteSDP.restartICE(_e);const _n=a.remoteSDP.toString(),_o=a.logSDPExchange(g.sdp||"","offer","local","restartICE");yield V0(a.peerConnection.setLocalDescription(g)),_o==null||_o(_n),yield V0(a.peerConnection.setRemoteDescription({type:"answer",sdp:_n}))}catch(g){Ll.warning("restart ICE failed, abort operation",g)}finally{h()}})()}close(){var a;this.peerConnection.close(),(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(a){return this.statsFilter.getVideoIsReady(a)}async updateEncoderConfig(a,h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const g=await this.peerConnection.createOffer(),j=this.mungSendOfferSDP(g.sdp,[h],[a]);this.remoteSDP.updateRecvMedia(a,h);const _e=this.remoteSDP.toString(),_n=this.logSDPExchange(j,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:j}),_n==null||_n(_e),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_e})}catch(g){throw new Ql(Hl.EXCHANGE_SDP_FAILED,g.toString())}}async updateSendParameters(a,h){const g=this.peerConnection.getTransceivers().filter(j=>j.mid===a);g.length===1&&(this.isVP8Simulcast(h)?M_()||await this.applySimulcastEncodings(g,[h]):await this.applySendEncodings(g,[h]))}setStatsRemoteVideoIsReady(a,h){this.statsFilter.setVideoIsReady2(a,h)}async replaceTrack(a,h){const g=this.peerConnection.getTransceivers().find(j=>j.mid===h);g&&await g.sender.replaceTrack(a._mediaStreamTrack)}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var a;(a=this.onICEConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var a;(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=a=>{a.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,Ll.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,Ll.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},wp("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(a){const h={iceServers:[]};return a.iceServers?h.iceServers=a.iceServers:a.turnServer&&a.turnServer.mode!=="off"&&(RP(a.turnServer.servers)?h.iceServers=a.turnServer.servers:(h.iceServers&&h.iceServers.push(...hU.turnServerConfigToIceServers(a.turnServer.servers)),wp("USE_TURN_SERVER_OF_GATEWAY")&&h.iceServers&&a.turnServer.serversFromGateway&&h.iceServers.push(...hU.turnServerConfigToIceServers(a.turnServer.serversFromGateway)),wp("FORCE_TURN_TCP")?h.iceTransportPolicy="relay":a.turnServer.servers.concat(a.turnServer.serversFromGateway||[]).forEach(g=>{g.forceturn&&(h.iceTransportPolicy="relay")}))),h}static turnServerConfigToIceServers(a){const h=[];return a.forEach(g=>{g.security?g.tcpport&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turns:".concat(w4(g.turnServerURL),":").concat(g.tcpport,"?transport=tcp")}):(g.udpport&&!wp("FORCE_TURN_TCP")&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turn:".concat(g.turnServerURL,":").concat(g.udpport,"?transport=udp")}),g.tcpport&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turn:".concat(g.turnServerURL,":").concat(g.tcpport,"?transport=tcp")}))}),h}tryBindTransportEvents(a){a.transport&&(this.transportEventReceiver=a,a.transport.onstatechange=()=>{var h,g;(h=a.transport)!==null&&h!==void 0&&h.state&&((g=this.onDTLSTransportStateChange)===null||g===void 0||g.call(this,a.transport.state))},a.transport.onerror=h=>{var g;(g=this.onDTLSTransportError)===null||g===void 0||g.call(this,h.error)},a.transport.iceTransport&&(a.transport.iceTransport.onstatechange=()=>{var h,g,j;(h=a.transport)!==null&&h!==void 0&&h.iceTransport.state&&((g=this.onICETransportStateChange)===null||g===void 0||g.call(this,(j=a.transport)===null||j===void 0?void 0:j.iceTransport.state))}))}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async applySendEncodings(a,h){try{if(!O1().supportSetRtpSenderParameters||a.length!==h.length)return;for(let _r=0;_r<a.length;_r++){const ba=a[_r],xa=h[_r];if(xa&&xa instanceof H_){var g,j;if(this.isVP8Simulcast(xa))continue;const El={},yl={};switch(xa._optimizationMode){case"motion":El.degradationPreference="maintain-framerate";break;case"detail":El.degradationPreference="maintain-resolution";break;default:El.degradationPreference="balanced"}var _e,_n,_o,_a;if((g=xa._encoderConfig)!==null&&g!==void 0&&g.bitrateMax&&(yl.maxBitrate=1e3*((_e=xa._encoderConfig)===null||_e===void 0?void 0:_e.bitrateMax)),xa._hints.includes(c1.LOW_STREAM)&&((_n=xa._encoderConfig)!==null&&_n!==void 0&&_n.frameRate&&(yl.maxFramerate=xT(xa._encoderConfig.frameRate)),(_o=xa._encoderConfig)!==null&&_o!==void 0&&_o.scaleResolutionDownBy&&((_a=xa._encoderConfig)===null||_a===void 0?void 0:_a.scaleResolutionDownBy)>1&&(yl.scaleResolutionDownBy=xa._encoderConfig.scaleResolutionDownBy)),wp("DSCP_TYPE")&&_I()){const Nl=wp("DSCP_TYPE");["very-low","low","medium","high"].includes(Nl)&&(yl.networkPriority=Nl)}const Ol=ba.sender.getParameters(),Al=(j=Ol.encodings)===null||j===void 0?void 0:j[0];M_()&&!Al&&(El.encodings=[yl]),Al&&Object.assign(Al,yl),Object.assign(Ol,El),await ba.sender.setParameters(Ol)}}}catch{Ll.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(a,h,g){const j=K_.exports.parse(a);return h.forEach((_e,_n)=>{const _o=g[_n],_a=j.mediaDescriptions.find(_r=>_r.attributes.mid===_o);_a&&(cN(_a,_e),LQ(_a,_e,this.store.codec))}),K_.exports.print(j)}mungReceiveAnswerSDP(a,h,g){const j=K_.exports.parse(a),_e=j.mediaDescriptions.find(_n=>_n.attributes.mid===h);return _e&&g===N0.AUDIO&&_e.media.mediaType==="audio"&&IR(_e),K_.exports.print(j)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=a=>{var h;(h=this.onFirstAudioReceived)===null||h===void 0||h.call(this,a)},this.statsFilter.onFirstVideoReceived=a=>{var h;(h=this.onFirstVideoReceived)===null||h===void 0||h.call(this,a)},this.statsFilter.onFirstAudioDecoded=a=>{var h;(h=this.onFirstAudioDecoded)===null||h===void 0||h.call(this,a)},this.statsFilter.onFirstVideoDecoded=(a,h,g)=>{var j;(j=this.onFirstVideoDecoded)===null||j===void 0||j.call(this,a,h,g)},this.statsFilter.onSelectedLocalCandidateChanged=(a,h)=>{var g;(g=this.onSelectedLocalCandidateChanged)===null||g===void 0||g.call(this,a,h)},this.statsFilter.onSelectedRemoteCandidateChanged=(a,h)=>{var g;(g=this.onSelectedRemoteCandidateChanged)===null||g===void 0||g.call(this,a,h)},this.statsFilter.onFirstVideoDecodedTimeout=a=>{var h;(h=this.onFirstVideoDecodedTimeout)===null||h===void 0||h.call(this,a)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(a,h){if(a.length===h.length)for(let _o=0;_o<a.length;_o++){var g,j,_e,_n;const _a=a[_o],_r=h[_o];if(_r instanceof H_&&!_r._hints.includes(c1.LOW_STREAM)&&(g=_r._encoderConfig)!==null&&g!==void 0&&g.bitrateMax&&((j=_r._encoderConfig)===null||j===void 0?void 0:j.bitrateMax)>200&&(_e=_r._scalabiltyMode)!==null&&_e!==void 0&&_e.numSpatialLayers&&((_n=_r._scalabiltyMode)===null||_n===void 0?void 0:_n.numSpatialLayers)>1&&this.store.codec==="vp8"){const ba={},xa={high:1e3*(_r._encoderConfig.bitrateMax-50),medium:5e4};ba.encodings=[{rid:"m",active:!0,maxBitrate:xa.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:xa.high}];const El=_a.sender.getParameters();await _a.sender.setParameters(Object.assign(El,ba))}}}async applySimulcastEncodings(a,h){if(!M_()&&a.length===h.length)for(let g=0;g<a.length;g++){const j=h[g];if(j instanceof H_&&this.isVP8Simulcast(j)){const _e=a[g],_n={},_o={high:1e3*(j._encoderConfig.bitrateMax-50),medium:5e4};_n.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:_o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:_o.medium,scaleResolutionDownBy:4}];const _a=_e.sender.getParameters();await _e.sender.setParameters(Object.assign(_a,_n))}}}isVP8Simulcast(a){var h,g,j,_e;return!!(a instanceof H_&&wp("SIMULCAST")&&this.store.codec==="vp8"&&!a._hints.includes(c1.LOW_STREAM)&&(h=a._encoderConfig)!==null&&h!==void 0&&h.bitrateMax&&((g=a._encoderConfig)===null||g===void 0?void 0:g.bitrateMax)>200&&(j=a._scalabiltyMode)!==null&&j!==void 0&&j.numSpatialLayers&&((_e=a._scalabiltyMode)===null||_e===void 0?void 0:_e.numSpatialLayers)>1)}logSDPExchange(a,h,g,j){if(wp("SDP_LOGGING"))return Ll.upload("exchanging ".concat(g," ").concat(h," SDP during P2PConnection.").concat(j,`
`),a),h==="offer"?_e=>{this.logSDPExchange(_e,"answer",g==="local"?"remote":"local",j)}:void 0}async getRemoteSSRC(a){if(!this.remoteSDP)return;const h=this.remoteSDP.getSSRC(a);return h==null?void 0:h[0].ssrcId}}).prototype,"connect",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"connect"),d_.prototype),Wp(d_.prototype,"receive",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"receive"),d_.prototype),Wp(d_.prototype,"batchReceive",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"batchReceive"),d_.prototype),Wp(d_.prototype,"stopReceiving",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"stopReceiving"),d_.prototype),Wp(d_.prototype,"muteRemote",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"muteRemote"),d_.prototype),Wp(d_.prototype,"unmuteRemote",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"unmuteRemote"),d_.prototype),Wp(d_.prototype,"muteLocal",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"muteLocal"),d_.prototype),Wp(d_.prototype,"unmuteLocal",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"unmuteLocal"),d_.prototype),Wp(d_.prototype,"close",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"close"),d_.prototype),Wp(d_.prototype,"updateEncoderConfig",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"updateEncoderConfig"),d_.prototype),Wp(d_.prototype,"updateSendParameters",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"updateSendParameters"),d_.prototype),Wp(d_.prototype,"replaceTrack",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"replaceTrack"),d_.prototype),Wp(d_.prototype,"getRemoteSSRC",[tS],Object.getOwnPropertyDescriptor(d_.prototype,"getRemoteSSRC"),d_.prototype),d_);function tS(s,a,h){const g=s[a];if(typeof g!="function")throw new Error("Cannot use mutex on object property.");return h.value=async function(){const j=this.mutex,_e=await j.lock("From P2PConnection.".concat(a));try{for(var _n=arguments.length,_o=new Array(_n),_a=0;_a<_n;_a++)_o[_a]=arguments[_a];return await g.apply(this,_o)}finally{_e()}},h}function zQ(s,a){let h=document.createElement("video"),g=document.createElement("canvas");h.setAttribute("style","display:none"),g.setAttribute("style","display:none"),h.setAttribute("muted",""),h.muted=!0,h.setAttribute("autoplay",""),h.autoplay=!0,h.setAttribute("playsinline",""),g.width=xT(a.width),g.height=xT(a.height);const j=xT(a.framerate||15);document.body.append(h),document.body.append(g);let _e=s._mediaStreamTrack;h.srcObject=new MediaStream([_e]),h.play();const _n=g.getContext("2d");if(!_n)throw new Ql(Hl.UNEXPECTED_ERROR,"can not get canvas context");const _o=O1(),_a=g.captureStream(_o.supportRequestFrame?0:j).getVideoTracks()[0],_r=u8(()=>(()=>{if(h.paused&&h.play(),h.videoHeight>2&&h.videoWidth>2){const xa=h.videoWidth,El=h.videoHeight/xa,yl=g.width*El;Math.abs(yl-g.height)>=2&&(Ll.debug("adjust low stream resolution","".concat(g.width,"x").concat(g.height," -> ").concat(g.width,"x").concat(yl)),g.height=yl)}_n.drawImage(h,0,0,g.width,g.height),_a.requestFrame&&_a.requestFrame(),_e!==s._mediaStreamTrack&&(_e=s._mediaStreamTrack,h.srcObject=new MediaStream([_e]))})(),j),ba=_a.stop;return _a.stop=()=>{ba.call(_a),_r(),h&&(h.remove(),h=null),g&&(g.width=0,g.remove(),g=null),Ll.debug("clean low stream renderer")},_a}var YQ,JQ,XQ,QQ,eS,$Q,ZQ,t$,e$,n$,r$,U1;function i$(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function tU(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?i$(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):i$(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}class o$ extends gW{getUserId(){return this._userId}constructor(a,h,g,j){super(a,"track-".concat(a.kind,"-").concat(h,"-").concat(j.clientId,"_").concat(N_(5,""))),Rl(this,"_userId",void 0),Rl(this,"_uintId",void 0),Rl(this,"_isDestroyed",!1),Rl(this,"store",void 0),Rl(this,"processor",void 0),Rl(this,"processorContext",void 0),this._userId=h,this._uintId=g,this.store=j}_updateOriginMediaStreamTrack(a){this._originMediaStreamTrack=a,this._mediaStreamTrack=a,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,Ll.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let eU=(YQ=b0({argsMap:(s,a,h)=>[s.getTrackId(),typeof a=="string"?a:"HTMLElement",h]}),JQ=b0({argsMap:s=>[s.getTrackId()]}),XQ=b0({argsMap:(s,a)=>[s.getTrackId(),a.name]}),QQ=b0({argsMap:s=>[s.getTrackId()]}),Wp((eS=class extends o${get isPlaying(){return!(!this._player||this._player.videoElementStatus!==S1.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(s,a,h,g){super(s,a,h,g),Rl(this,"_videoVisibleTimer",null),Rl(this,"_previousVideoVisibleStatus",void 0),Rl(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),Rl(this,"trackMediaType","video"),Rl(this,"_videoWidth",void 0),Rl(this,"_videoHeight",void 0),Rl(this,"_player",void 0),Rl(this,"processorDestination",void 0),Rl(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new sz(this.getTrackId(),"remote"),this.processorDestination=new oz(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return LP(()=>{Ll.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),tT(this,w0.GET_STATS)||tU({},vq)}play(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof s=="string"){const g=document.getElementById(s);g?s=g:(Ll.warning("[".concat(this.getTrackId(),'] can not find "#').concat(s,'" element, use document.body')),s=document.body)}Ll.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(a));const h=tU(tU({fit:"cover"},a),{},{trackId:this.getTrackId(),element:s});this._player?this._player.updateConfig(h):(this._player=new uX(h),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.emit(H2.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const g=this.getVideoElementVisibleStatus();this.emit(H2.VIDEO_ELEMENT_VISIBLE_STATUS,g)}catch{}},wp("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,Ll.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){_z(this._originMediaStreamTrack).then(s=>{let[a,h]=s;this._videoHeight=h,this._videoWidth=a}).catch(O4)}_updatePlayerSource(){Ll.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var s,a;const h=this==null||(s=this._player)===null||s===void 0?void 0:s.getContainerElement(),g={track:this,element:this==null||(a=this._player)===null||a===void 0?void 0:a.getVideoElement(),slot:h==null?void 0:h.parentElement},{element:j,slot:_e}=g;if(this.isPlaying&&j instanceof HTMLVideoElement&&_e instanceof HTMLElement){const _n=KX.checkOneElementVisible(j),_o=Object.assign({},_n);if(_o.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=_o.visible;const _a=d0.reportApiInvoke(null,{tag:A_.TRACER,name:Y_.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});_o.visible?_a.onSuccess("Video is visible"):_a.onSuccess("Invisible because of ".concat(_o.reason))}return _o}return}catch(h){throw new Ql(Hl.GET_VIDEO_ELEMENT_VISIBLE_ERROR,h.message)}}pipe(s){if(this.processor===s)return s;if(s._source)throw new Ql(Hl.INVALID_OPERATION,"Processor ".concat(s.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=s,this.processor._source=this,s.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),s}unpipe(){if(!this.processor)return;const s=this.processor;this.processor._source=void 0,this.processor=void 0,s.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(I1.ON_TRACK,async s=>{s?s!==this._mediaStreamTrack&&(this._mediaStreamTrack=s,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(I1.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}}).prototype,"play",[YQ],Object.getOwnPropertyDescriptor(eS.prototype,"play"),eS.prototype),Wp(eS.prototype,"stop",[JQ],Object.getOwnPropertyDescriptor(eS.prototype,"stop"),eS.prototype),Wp(eS.prototype,"pipe",[XQ],Object.getOwnPropertyDescriptor(eS.prototype,"pipe"),eS.prototype),Wp(eS.prototype,"unpipe",[QQ],Object.getOwnPropertyDescriptor(eS.prototype,"unpipe"),eS.prototype),eS),nU=($Q=b0({argsMap:(s,a)=>[s.getTrackId(),a],throttleTime:300}),ZQ=b0({argsMap:(s,a)=>[s.getTrackId(),a]}),t$=b0({argsMap:s=>[s.getTrackId()]}),e$=b0({argsMap:s=>[s.getTrackId()]}),n$=b0({argsMap:(s,a)=>[s.getTrackId(),a.name]}),r$=b0({argsMap:s=>[s.getTrackId()]}),Wp((U1=class extends o${get isPlaying(){return this._useAudioElement?Ey.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(s,a,h,g){super(s,a,h,g),Rl(this,"trackMediaType","audio"),Rl(this,"_source",void 0),Rl(this,"_useAudioElement",!0),Rl(this,"_volume",100),Rl(this,"processorContext",void 0),Rl(this,"processorDestination",void 0),Rl(this,"_played",!1),Rl(this,"_bypassWebAudio",!1),wp("DISABLE_WEBAUDIO")?(this._source=new uz,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new yW(s,!0),wp("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(ay.RECEIVE_TRACK_BUFFER,()=>{this.emit(H2.FIRST_FRAME_DECODED)}),this.processorContext=new cz(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new az(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(ay.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!s)return this._source.removeAllListeners(ay.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(a),this._source.removeAllListeners(ay.ON_AUDIO_BUFFER),this._source.on(ay.ON_AUDIO_BUFFER,h=>s(h))}setVolume(s){this._volume=s,this._useAudioElement?Ey.setVolume(this.getTrackId(),s):this._source.setVolume(s/100)}async setPlaybackDevice(s){if(!this._useAudioElement)throw new Ql(Hl.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Ey.setSinkID(this.getTrackId(),s)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return LP(()=>{Ll.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),tT(this,w0.GET_STATS)||tU({},mq)}play(){Ll.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(Ll.debug("[".concat(this.getTrackId(),"] use audio element to play")),Ey.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){Ll.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?Ey.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let s=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];Ll.debug("[".concat(this.getTrackId(),"] update player source track")),s&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Ey.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(s){if(this._bypassWebAudio)throw new Ql(Hl.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===s)return s;if(s._source)throw new Ql(Hl.INVALID_OPERATION,"Processor ".concat(s.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=s,this.processor._source=this,s.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),s}unpipe(){var s;if(this._bypassWebAudio)throw new Ql(Hl.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const a=this.processor;(s=this._source.processSourceNode)===null||s===void 0||s.disconnect(),this.processor._source=!1,this.processor=void 0,a.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(I1.ON_TRACK,async s=>{s?s!==this._mediaStreamTrack&&(this._mediaStreamTrack=s,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(s)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(I1.ON_NODE,s=>{this._source.processedNode=s;const a=!s;this._useAudioElement!==a&&(this._played?(this.stop(),this._useAudioElement=a,this.play()):this._useAudioElement=a)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(I1.ON_TRACK),this.processorDestination.removeAllListeners(I1.ON_NODE)}}).prototype,"setVolume",[$Q],Object.getOwnPropertyDescriptor(U1.prototype,"setVolume"),U1.prototype),Wp(U1.prototype,"setPlaybackDevice",[ZQ],Object.getOwnPropertyDescriptor(U1.prototype,"setPlaybackDevice"),U1.prototype),Wp(U1.prototype,"play",[t$],Object.getOwnPropertyDescriptor(U1.prototype,"play"),U1.prototype),Wp(U1.prototype,"stop",[e$],Object.getOwnPropertyDescriptor(U1.prototype,"stop"),U1.prototype),Wp(U1.prototype,"pipe",[n$],Object.getOwnPropertyDescriptor(U1.prototype,"pipe"),U1.prototype),Wp(U1.prototype,"unpipe",[r$],Object.getOwnPropertyDescriptor(U1.prototype,"unpipe"),U1.prototype),U1);function s$(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function a$(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?s$(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):s$(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}class gat extends C_{constructor(){super(),Rl(this,"uplinkStatsUploadInterval",void 0),Rl(this,"uplinkStatsUploadSlowInterval",void 0),Rl(this,"uplinkRelatedStatsUploadInterval",void 0),Rl(this,"uplinkDenoiserStatsUploadInterval",void 0),Rl(this,"transportStatsUploadInterval",void 0),Rl(this,"uplinkExtensionStatsUploadInterval",void 0),Rl(this,"downlinkExtensionStatsUploadInterval",void 0),Rl(this,"extensionUsageStatsUploadInterval",void 0),Rl(this,"downlinkStatsUploadInterval",void 0),Rl(this,"downlinkStatsUploadSlowInterval",void 0),Rl(this,"downlinkRelatedStatsUploadInterval",void 0),Rl(this,"lastStats",void 0),Rl(this,"uploadUnplinkStarted",!1),Rl(this,"uploadDownlinkStarted",!1),Rl(this,"uploadTransportStarted",!1),Rl(this,"uploadExtensionUsageStarted",!1),Rl(this,"requestStats",void 0),Rl(this,"requestLocalMedia",void 0),Rl(this,"requestRemoteMedia",void 0),Rl(this,"requestAllTracks",void 0),Rl(this,"requestVideoIsReady",void 0),Rl(this,"requestUpload",void 0)}startUploadTransportStats(){this.uploadTransportStarted||(this.uploadTransportStarted=!0,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=window.setInterval(()=>{var a;const h=(a=this.requestStats)===null||a===void 0?void 0:a.call(this);h&&this.uploadTransportStats(h)},6e3))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.extensionUsageStatsUploadInterval&&window.clearInterval(this.extensionUsageStatsUploadInterval);const a=new Map;this.extensionUsageStatsUploadInterval=window.setInterval(async()=>{var h,g,j;const _e=Date.now(),_n={connectionInterval:wp("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:_e};let _o=[];const _a=((h=this.requestAllTracks)===null||h===void 0?void 0:h.call(this))||[];for(const El of _a)!El.muted&&El.enabled&&(_o=_o.concat(await El.getProcessorUsage()));const _r=((g=this.requestRemoteMedia)===null||g===void 0?void 0:g.call(this))||[];for(const[El,yl]of _r)yl.has(N0.VIDEO)&&El.videoTrack&&(_o=_o.concat(await El.videoTrack.getProcessorUsage())),yl.has(N0.AUDIO)&&El.audioTrack&&(_o=_o.concat(await El.audioTrack.getProcessorUsage()));if(_o.length===0)return;_n.details=function(El,yl){const Ol={};for(const{id:Fl,value:up,level:_p,direction:Tp}of El){var Al;const Fp=(Al=yl.get(Fl))!==null&&Al!==void 0?Al:0,Ap=up===2?Fp+wp("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:Fp;var Nl,Ml;yl.set(Fl,Ap),Ol[Fl]?(up===2&&(Ol[Fl].value=up),_p>Ol[Fl].level&&(Ol[Fl].level=_p),Tp==="remote"&&(Ol[Fl].remoteUidCount+=1),Ol[Fl].totalTs=(Nl=yl.get(Fl))!==null&&Nl!==void 0?Nl:0):Ol[Fl]={value:up,level:_p,remoteUidCount:Tp==="local"?0:1,totalTs:(Ml=yl.get(Fl))!==null&&Ml!==void 0?Ml:0}}return Object.keys(Ol).map(Fl=>{const{level:up,value:_p,totalTs:Tp}=Ol[Fl];return{id:Fl,level:up,value:_p,totalTs:Tp}})}(_o,a);const ba=Date.now(),xa=ba>_e?ba:_e+1;(j=this.requestUpload)===null||j===void 0||j.call(this,sy.EXTENSION_USAGE_STATS,{usageStats:_n,sendTs:xa})},wp("EXTENSION_USAGE_UPLOAD_INTERVAL"))}startUploadUplinkStats(){this.uploadUnplinkStarted||(this.uploadUnplinkStarted=!0,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkStatsUploadInterval=window.setInterval(()=>{var a;const h=(a=this.requestStats)===null||a===void 0?void 0:a.call(this);h&&(this.uploadUplinkStats(h,this.lastStats),this.lastStats=h)},3e3),this.uplinkStatsUploadSlowInterval&&window.clearInterval(this.uplinkStatsUploadSlowInterval),this.uplinkStatsUploadSlowInterval=window.setInterval(()=>{var a;const h=(a=this.requestStats)===null||a===void 0?void 0:a.call(this);h&&this.uploadSlowUplinkStats(h)},6e4),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkRelatedStatsUploadInterval=window.setInterval(()=>{var a;const h=(a=this.requestStats)===null||a===void 0?void 0:a.call(this);h&&this.uploadRelatedUplinkStats(h,this.lastStats),this.lastStats=h},1e3),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval=window.setInterval(()=>{var a;const h=(a=this.requestAllTracks)===null||a===void 0?void 0:a.call(this);h&&this.uploadDenoiserStats(h)},2e3),this.uplinkExtensionStatsUploadInterval&&window.clearInterval(this.uplinkExtensionStatsUploadInterval),this.uplinkExtensionStatsUploadInterval=window.setInterval(()=>{var a;const h=(a=this.requestAllTracks)===null||a===void 0?void 0:a.call(this);h&&this.uploadExtensionStats(h)},2e3))}uploadTransportStats(a){mS(()=>{var h;(h=this.requestUpload)===null||h===void 0||h.call(this,sy.TRANSPORT_STATS,function(g){const j={connectionType:100};if(g.selectedCandidatePair.localCandidate.candidateType==="relay"){const _e=g.selectedCandidatePair.localCandidate.relayProtocol;_e==="udp"&&(j.connectionType=101),_e==="tcp"&&(j.connectionType=103),_e==="tls"&&(j.connectionType=104)}return j}(a))})}uploadUplinkStats(a,h){var g;(((g=this.requestLocalMedia)===null||g===void 0?void 0:g.call(this))||[]).forEach(j=>{let[_e,{track:_n,ssrcs:_o}]=j;switch(_e){case a0.LocalVideoLowTrack:case a0.LocalVideoTrack:{const _a=function(xa,El,yl){var Ol;const Al=El.videoSend.find(Ml=>Ml.ssrc===xa);if(!Al)return null;const Nl={id:N_(10,""),timestamp:new Date(El.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:Al.ssrc.toString()};switch(Nl.A_vstd=yl._originMediaStreamTrack&&!yl._originMediaStreamTrack.enabled||yl._mediaStreamTrack&&!yl._mediaStreamTrack.enabled?"1":"0",Al.sentFrame&&(Nl.A_fhs=Al.sentFrame.height.toString(),Nl.A_frs=Al.sentFrame.frameRate.toString(),Nl.A_fws=Al.sentFrame.width.toString()),Al.adaptionChangeReason){case"none":Nl.A_ac="0";break;case"cpu":Nl.A_ac="1";break;case"bandwidth":Nl.A_ac="2";break;case"other":Nl.A_ac="3"}return Nl.A_lvps=H6[yl._player?yl._player.videoElementStatus:"uninit"].toString(),Nl.A_nr=(Ol=Al.nacksCount)===null||Ol===void 0?void 0:Ol.toString(),Al.avgEncodeMs&&(Nl.A_aem=Al.avgEncodeMs.toFixed(0).toString()),Nl}(_o[0].ssrcId,a,_n),_r=mz(_o[0].ssrcId,a,h);_a&&mS(()=>{var xa;return(xa=this.requestUpload)===null||xa===void 0?void 0:xa.call(this,sy.PUBLISH_STATS,{stream_type:_e===a0.LocalVideoLowTrack?"low":"high",stats:a$(a$({},_a),_r)})});const ba=function(xa){const El={id:"bweforvideo",timestamp:new Date(xa.timestamp).toISOString(),type:"VideoBwe"};return xa.bitrate.retransmit&&(El.A_rb=xa.bitrate.retransmit.toString()),xa.bitrate.targetEncoded&&(El.A_teb=xa.bitrate.targetEncoded.toString()),El.A_aeb=xa.bitrate.actualEncoded.toString(),El.A_tb=xa.bitrate.transmit.toString(),xa.sendBandwidth!==void 0&&(El.A_asb=xa.sendBandwidth.toString()),El}(a);ba&&setTimeout(()=>{var xa;return(xa=this.requestUpload)===null||xa===void 0?void 0:xa.call(this,sy.PUBLISH_STATS,{stream_type:_e===a0.LocalVideoLowTrack?"low":"high",stats:ba})},1e3);break}case a0.LocalAudioTrack:{const _a=function(_r,ba,xa){const El=ba.audioSend.find(Ol=>Ol.ssrc===_r);if(!El)return null;const yl={id:N_(10,""),timestamp:new Date(ba.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:El.ssrc.toString()};return yl.A_astd=xa._originMediaStreamTrack.enabled&&xa._mediaStreamTrack.enabled?"0":"1",El.inputLevel?yl.A_ail=Math.round(100*El.inputLevel).toString():yl.A_ail=Math.round(100*xa._source.getAccurateVolumeLevel()).toString(),yl.A_apil=Math.round(100*xa._source.getAccurateVolumeLevel()).toString(),El.aecReturnLoss&&(yl.A_ecrl=Math.round(El.aecReturnLoss).toString()),El.aecReturnLossEnhancement&&(yl.A_ecrle=Math.round(El.aecReturnLossEnhancement).toString()),yl}(_o[0].ssrcId,a,_n);_a&&mS(()=>{var _r;return(_r=this.requestUpload)===null||_r===void 0?void 0:_r.call(this,sy.PUBLISH_STATS,{stream_type:"high",stats:_a})});break}}})}uploadSlowUplinkStats(a){var h;(((h=this.requestLocalMedia)===null||h===void 0?void 0:h.call(this))||[]).filter(g=>{let[j]=g;return j===a0.LocalVideoLowTrack||j===a0.LocalVideoTrack}).forEach(g=>{let[j,{ssrcs:_e}]=g;const _n=mz(_e[0].ssrcId,a);_n&&mS(()=>{var _o;return(_o=this.requestUpload)===null||_o===void 0?void 0:_o.call(this,sy.PUBLISH_STATS,{stream_type:j===a0.LocalVideoLowTrack?"low":"high",stats:_n})})})}uploadRelatedUplinkStats(a,h){var g;(((g=this.requestLocalMedia)===null||g===void 0?void 0:g.call(this))||[]).filter(j=>{let[_e]=j;return _e===a0.LocalVideoLowTrack||_e===a0.LocalVideoTrack}).forEach(j=>{let[_e,{ssrcs:_n}]=j;const _o=function(_a,_r){const ba=_r.videoSend.find(xa=>xa.ssrc===_a);return ba?{mediaType:"video",isVideoMute:!1,frameRateInput:ba.inputFrame&&ba.inputFrame.frameRate.toString(),frameRateSent:ba.sentFrame&&ba.sentFrame.frameRate.toString(),googRtt:ba.rttMs.toString(),qpSumPerFrame:Math.floor(ba.qpSumPerFrame).toString()}:null}(_n[0].ssrcId,a);_o&&mS(()=>{var _a;(_a=this.requestUpload)===null||_a===void 0||_a.call(this,sy.PUBLISH_RELATED_STATS,{stream_type:_e===a0.LocalVideoLowTrack?"low":"high",stats:_o})})})}uploadDenoiserStats(a){for(let _e=0;_e<a.length;_e++){const _n=a[_e];if(_n instanceof T4){var h,g,j;const _o=(h=(g=_n._external).getDenoiserStats)===null||h===void 0?void 0:h.call(g);return void(_o&&((j=this.requestUpload)===null||j===void 0||j.call(this,sy.DENOISER_STATS,_o)))}}}uploadExtensionStats(a){for(let h=0;h<a.length;h++)a[h].getProcessorStats().forEach(g=>{var j;(j=this.requestUpload)===null||j===void 0||j.call(this,g.type,g.stats)})}stopUploadUplinkStats(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkStatsUploadInterval=void 0,this.uplinkRelatedStatsUploadInterval=void 0,this.uplinkDenoiserStatsUploadInterval=void 0)}startUploadDownlinkStats(){if(this.uploadDownlinkStarted)return;let a;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);let h=!1;this.downlinkStatsUploadInterval=window.setInterval(()=>{var g;const j=(g=this.requestStats)===null||g===void 0?void 0:g.call(this);j&&(this.uploadDownlinkStats(j,h,a),a=j),h=!h},3e3),this.downlinkStatsUploadSlowInterval&&window.clearInterval(this.downlinkStatsUploadSlowInterval),this.downlinkStatsUploadSlowInterval=window.setInterval(()=>{var g;const j=(g=this.requestStats)===null||g===void 0?void 0:g.call(this);j&&this.uploadSlowDownlinkStats(j)},6e4),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkRelatedStatsUploadInterval=window.setInterval(()=>{var g;const j=(g=this.requestStats)===null||g===void 0?void 0:g.call(this);j&&(this.uploadRelatedDownlinkStats(j,this.lastStats),this.lastStats=j)},1e3),this.downlinkExtensionStatsUploadInterval&&window.clearInterval(this.downlinkExtensionStatsUploadInterval),this.downlinkExtensionStatsUploadInterval=window.setInterval(()=>{var g;const j=(g=this.requestRemoteMedia)===null||g===void 0?void 0:g.call(this);j&&this.uploadDownlinkExtensionStats(j)},2e3)}uploadDownlinkStats(a,h,g){var j;(((j=this.requestRemoteMedia)===null||j===void 0?void 0:j.call(this))||[]).forEach(_e=>{let[_n,_o]=_e;if(_o.has(N0.VIDEO)&&_n.videoTrack){const _a=_n.videoTrack?function(_r,ba,xa,El,yl){const Ol=ba.videoRecv.find(Fl=>Fl.ssrc===_r);if(!Ol)return null;const Al={id:N_(10,""),timestamp:new Date(ba.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:Ol.ssrc.toString()};var Nl,Ml;if(Al.bytesReceived=Ol.bytes.toString(),Al.packetsLost=Ol.packetsLost.toString(),Al.packetsReceived=Ol.packets.toString(),Ol.framesRateFirefox&&(Al.A_frr=Ol.framesRateFirefox.toString()),Ol.receivedFrame?(Al.A_frr=Ol.receivedFrame.frameRate.toString(),Al.A_fhr=Ol.receivedFrame.height.toString(),Al.A_fwr=Ol.receivedFrame.width.toString()):(Al.A_fhr=(Nl=El._videoHeight)===null||Nl===void 0?void 0:Nl.toString(),Al.A_fwr=(Ml=El._videoWidth)===null||Ml===void 0?void 0:Ml.toString()),Al.A_frd=Ol.decodeFrameRate.toString(),Ol.outputFrame&&(Al.A_fro=Ol.outputFrame.frameRate.toString()),Ol.jitterBufferMs!==void 0&&(Al.A_jbm=Math.floor(Ol.jitterBufferMs).toString()),Ol.currentDelayMs!==void 0&&(Al.A_cdm=Math.floor(Ol.currentDelayMs).toString()),Al.A_fs=Ol.firsCount.toString(),Al.A_ns=Ol.nacksCount.toString(),Al.A_ps=Ol.plisCount.toString(),El&&(Al.A_vrtd=El._originMediaStreamTrack.enabled&&El._mediaStreamTrack.enabled?"0":"1"),El._player&&El._player.freezeTimeCounterList.length>0&&(Al.A_vrft=Math.round(El._player.freezeTimeCounterList.splice(0,1)[0]).toString()),yl&&El._player&&DT.visibility==="visible"){const Fl=Math.min(6e3,El._player.renderFreezeAccTime);Al.A_vrrft=Math.round(Fl).toString(),El._player.renderFreezeAccTime=Math.max(0,El._player.renderFreezeAccTime-Fl)}if(Al.A_rvps=H6[El._player?El._player.videoElementStatus:"uninit"].toString(),xa){const Fl=xa.videoRecv.find(up=>up.ssrc===_r);if(Fl&&Ol.totalInterFrameDelay!==void 0&&Ol.totalSquaredInterFrameDelay!==void 0&&Fl.totalInterFrameDelay!==void 0&&Fl.totalSquaredInterFrameDelay!==void 0){const up=Ol.totalInterFrameDelay-Fl.totalInterFrameDelay,_p=Ol.totalSquaredInterFrameDelay-Fl.totalSquaredInterFrameDelay,Tp=Ol.framesDecodeCount-Fl.framesDecodeCount,Fp=up/Tp*1e3,Ap=Math.round(1e3*Math.sqrt((_p-Math.pow(up,2)/Tp)/Tp));!isNaN(Ap)&&Fp+Ap>Math.max(3*Fp,Fp+150)&&(Al.A_ifdsd=Ap.toString())}}return Al}(_n._videoSSRC,a,g,_n.videoTrack,h):void 0;_a&&mS(()=>{var _r;return(_r=this.requestUpload)===null||_r===void 0?void 0:_r.call(this,sy.SUBSCRIBE_STATS,{stream_id:_n.uid,stats:_a})})}if(_o.has(N0.AUDIO)&&_n.audioTrack){const _a=_n.audioTrack?function(_r,ba,xa,El){const yl=ba.audioRecv.find(Al=>Al.ssrc===_r);if(!yl)return null;const Ol={id:N_(10,""),timestamp:new Date(ba.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:yl.ssrc.toString()};if(Ol.bytesReceived=yl.bytes.toString(),Ol.packetsLost=yl.packetsLost.toString(),Ol.packetsReceived=yl.packets.toString(),yl.outputLevel?Ol.A_aol=Math.round(100*yl.outputLevel).toString():Ol.A_aol=Math.round(100*El._source.getAccurateVolumeLevel()).toString(),Ol.A_apol=Math.round(100*El._source.getAccurateVolumeLevel()).toString(),El&&(Ol.A_artd=El._originMediaStreamTrack.enabled&&El._mediaStreamTrack.enabled?"0":"1"),Ol.A_jr=yl.jitterMs.toString(),Ol.A_jbm=Math.floor(yl.jitterBufferMs).toString(),Ol.A_cdm=Math.floor(yl.jitterBufferMs).toString(),Ol.A_raps=H6[Ey.getPlayerState(El.getTrackId())].toString(),xa){const Al=xa.audioRecv.find(Nl=>Nl.ssrc===_r);if(Al){const Nl=yl.concealedSamples-Al.concealedSamples;Nl>0&&(Ol.A_cs=Math.round(Nl).toString())}}return Ol}(_n._audioSSRC,a,g,_n.audioTrack):void 0;_a&&mS(()=>{var _r;return(_r=this.requestUpload)===null||_r===void 0?void 0:_r.call(this,sy.SUBSCRIBE_STATS,{stream_id:_n.uid,stats:_a})})}})}uploadSlowDownlinkStats(a){}uploadRelatedDownlinkStats(a,h){var g;(((g=this.requestRemoteMedia)===null||g===void 0?void 0:g.call(this))||[]).forEach(j=>{let[_e,_n]=j;if(_n.has(N0.VIDEO)&&_e.videoTrack){var _o;const _a=(_e._videoSSRC&&((_o=this.requestVideoIsReady)===null||_o===void 0?void 0:_o.call(this,_e._videoSSRC))||!1)===!0,_r=function(ba,xa,El,yl,Ol,Al){const Nl=El.videoRecv.find(_p=>_p.ssrc===ba),Ml=Ol?Ol.videoRecv.find(_p=>_p.ssrc===ba):void 0;if(!Nl)return null;const Fl=J2.isRemoteVideoFreeze(Al,Nl,Ml)&&xa,up={mediaType:"video",isVideoMute:!1,peerId:yl,frameRateReceived:Nl.receivedFrame&&Nl.receivedFrame.frameRate.toString(),frameRateDecoded:Nl.decodedFrame&&Nl.decodedFrame.frameRate.toString(),isFreeze:Fl,bytesReceived:Nl.bytes.toString(),packetsReceived:Nl.packets.toString(),packetsLost:Nl.packetsLost.toString(),qpSumPerFrame:Math.floor(Nl.qpSumPerFrame).toString()};return Nl.framesRateFirefox&&(up.frameRateDecoded=Nl.framesRateFirefox.toString(),up.frameRateReceived=Nl.framesRateFirefox.toString()),up}(_e._videoSSRC,_a,a,_e.uid,h,_e.videoTrack);_r&&mS(()=>{var ba;(ba=this.requestUpload)===null||ba===void 0||ba.call(this,sy.SUBSCRIBE_RELATED_STATS,{stream_id:_e.uid,stats:_r})})}if(_n.has(N0.AUDIO)&&_e.audioTrack){const _a=function(_r,ba,xa,El){const yl=ba.audioRecv.find(Al=>Al.ssrc===_r);if(!yl)return null;const Ol=J2.isRemoteAudioFreeze(El);return{mediaType:"audio",isAudioMute:!1,peerId:xa,googJitterReceived:yl.jitterMs.toString(),isFreeze:Ol,bytesReceived:yl.bytes.toString(),packetsReceived:yl.packets.toString(),packetsLost:yl.packetsLost.toString(),frameReceived:yl.receivedFrames.toString(),frameDropped:yl.droppedFrames.toString()}}(_e._audioSSRC,a,_e.uid,_e.audioTrack);_a&&mS(()=>{var _r;(_r=this.requestUpload)===null||_r===void 0||_r.call(this,sy.SUBSCRIBE_RELATED_STATS,{stream_id:_e.uid,stats:_a})})}})}stopUploadDownlinkStats(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkStatsUploadInterval=void 0,this.downlinkRelatedStatsUploadInterval=void 0)}stopUploadTransportStats(){this.uploadTransportStarted&&(this.uploadTransportStarted=!1,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=void 0)}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.extensionUsageStatsUploadInterval&&window.clearInterval(this.extensionUsageStatsUploadInterval),this.extensionUsageStatsUploadInterval=void 0)}uploadDownlinkExtensionStats(a){a.forEach(h=>{let[g,j]=h;j.has(N0.VIDEO)&&g.videoTrack&&g.videoTrack.getProcessorStats().forEach(_e=>{var _n;(_n=this.requestUpload)===null||_n===void 0||_n.call(this,_e.type,_e.stats)}),j.has(N0.AUDIO)&&g.audioTrack&&g.audioTrack.getProcessorStats().forEach(_e=>{var _n;(_n=this.requestUpload)===null||_n===void 0||_n.call(this,_e.type,_e.stats)})})}}const c$=`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0
a=msid-semantic: WMS
a=ice-lite
m=application 9 UDP/DTLS/SCTP webrtc-datachannel
c=IN IP4 127.0.0.1
a=mid:0
`,rU="9",C9=2e4,A9=4e4;class mat{get localCapabilities(){return W_(this._localCapabilities)}get rtpCapabilities(){return W_(this._rtpCapabilities)}get candidates(){return W_(this._candidates)}get iceParameters(){return W_(this._iceParameters)}get dtlsParameters(){return W_(this._dtlsParameters)}constructor(a){Rl(this,"sessionDesc",void 0),Rl(this,"_localCapabilities",void 0),Rl(this,"_rtpCapabilities",void 0),Rl(this,"_candidates",void 0),Rl(this,"_iceParameters",void 0),Rl(this,"_dtlsParameters",void 0),Rl(this,"setup",void 0),Rl(this,"currentMidIndex",void 0),Rl(this,"cname",void 0),Rl(this,"firefoxSsrcMidMap",new Map),a=W_(a);const{remoteIceParameters:h,remoteDtlsParameters:g,candidates:j,remoteRTPCapabilities:_e,remoteSetup:_n,localCapabilities:_o,cname:_a}=a,_r=K_.exports.parse(c$);this._rtpCapabilities=_e,this._candidates=j,this._iceParameters=h,this._dtlsParameters=g,this._localCapabilities=_o,this.setup=_n,this.cname=_a;const ba=this.rtpCapabilities.send;for(const xa of _r.mediaDescriptions){if(xa.attributes.iceUfrag=h.iceUfrag,xa.attributes.icePwd=h.icePwd,xa.attributes.fingerprints=g.fingerprints,xa.attributes.candidates=j,xa.attributes.setup=_n,xa.media.mediaType==="application"&&(xa.attributes.sctpPort="5000"),xa.media.mediaType==="video"&&(xa.media.fmts=ba.videoCodecs.map(El=>El.payloadType.toString(10)),xa.attributes.payloads=ba.videoCodecs,xa.attributes.extmaps=ba.videoExtensions,wp("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:El,ssrcGroups:yl}=Zy([{ssrcId:A9,rtx:wp("USE_RTX")?40001:void 0}],this.cname);xa.attributes.ssrcs=El,xa.attributes.ssrcGroups=yl}if(xa.media.mediaType==="audio"&&(xa.media.fmts=ba.audioCodecs.map(El=>El.payloadType.toString(10)),xa.attributes.payloads=ba.audioCodecs,xa.attributes.extmaps=ba.audioExtensions,IR(xa),wp("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:El,ssrcGroups:yl}=Zy([{ssrcId:C9}],this.cname);xa.attributes.ssrcs=El,xa.attributes.ssrcGroups=yl}}this.sessionDesc=_r,this.currentMidIndex=_r.mediaDescriptions.length-1}updateRemoteRTPCapabilities(a){const h=K_.exports.parse(c$);this._rtpCapabilities=a;const g=this.rtpCapabilities.send;for(const j of h.mediaDescriptions){if(j.attributes.iceUfrag=this._iceParameters.iceUfrag,j.attributes.icePwd=this._iceParameters.icePwd,j.attributes.fingerprints=this._dtlsParameters.fingerprints,j.attributes.candidates=this._candidates,j.attributes.setup=this.setup,j.media.mediaType==="application"&&(j.attributes.sctpPort="5000"),j.media.mediaType==="video"&&(j.media.fmts=g.videoCodecs.map(_e=>_e.payloadType.toString(10)),j.attributes.payloads=g.videoCodecs,j.attributes.extmaps=g.videoExtensions,wp("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_e,ssrcGroups:_n}=Zy([{ssrcId:A9,rtx:wp("USE_RTX")?40001:void 0}],this.cname);j.attributes.ssrcs=_e,j.attributes.ssrcGroups=_n}if(j.media.mediaType==="audio"&&(j.media.fmts=g.audioCodecs.map(_e=>_e.payloadType.toString(10)),j.attributes.payloads=g.audioCodecs,j.attributes.extmaps=g.audioExtensions,wp("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_e,ssrcGroups:_n}=Zy([{ssrcId:C9}],this.cname);j.attributes.ssrcs=_e,j.attributes.ssrcGroups=_n}}this.sessionDesc=h,this.currentMidIndex=h.mediaDescriptions.length-1}preloadRemoteMedia(a){this.rtpCapabilities;const h=this.candidates,g=this.dtlsParameters,j=this.iceParameters,_e=this.rtpCapabilities.send;for(let _n=1;_n<a;_n++){const _o=2*_n+C9,_a=2*_n+A9,{ssrcs:_r,ssrcGroups:ba}=Zy([{ssrcId:_o}],this.cname),{ssrcs:xa,ssrcGroups:El}=Zy([{ssrcId:_a,rtx:wp("USE_RTX")?_a+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:rU,protos:["UDP","TLS","RTP","SAVPF"],fmts:_e.videoCodecs.map(yl=>yl.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:j.iceUfrag,icePwd:j.icePwd,unrecognized:[],candidates:h,extmaps:_e.videoExtensions,fingerprints:g.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:xa,ssrcGroups:El,rtcpFeedbackWildcards:[],payloads:_e.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*_n-1)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:rU,protos:["UDP","TLS","RTP","SAVPF"],fmts:_e.audioCodecs.map(yl=>yl.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:j.iceUfrag,icePwd:j.icePwd,unrecognized:[],candidates:h,extmaps:_e.audioExtensions,fingerprints:g.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_r,ssrcGroups:ba,rtcpFeedbackWildcards:[],payloads:_e.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*_n)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return K_.exports.print(this.sessionDesc)}send(a,h,g,j){const{ssrcs:_e,ssrcGroups:_n}=Zy(h,this.cname,g),_o=this.findPreloadMediaDesc(_e);if(_o){if(M_()&&this.firefoxSsrcMidMap.set(_e[0].ssrcId,_o.attributes.mid),j&&(j.tcc||j.remb)){const _a=this.sessionDesc.mediaDescriptions.indexOf(_o);return this.sessionDesc.mediaDescriptions[_a]=this.mungSendMediaDesc(_o,j),{mid:_o.attributes.mid,needExchangeSDP:!0}}return{mid:_o.attributes.mid,needExchangeSDP:!1}}{const _a=this.findAvailableMediaIndex(a,_e);let _r;return _a===-1||iy()||x1()||gV()?(_r=this.createOrRecycleSendMedia(a,_e,_n,"sendonly",j),this.updateBundleMids()):(_r=W_(this.sessionDesc.mediaDescriptions[_a]),_r.attributes.direction="sendonly",_r.attributes.ssrcs=_e,_r.attributes.ssrcGroups=_n,this.sessionDesc.mediaDescriptions[_a]=this.mungSendMediaDesc(_r,j)),M_()&&this.firefoxSsrcMidMap.set(_e[0].ssrcId,_r.attributes.mid),{mid:_r.attributes.mid,needExchangeSDP:!0}}}batchSend(a){const h=a.map(_e=>{let{kind:_n,ssrcMsg:_o,mslabel:_a}=_e;return this.send(_n,_o,_a)}),g=[];let j=!1;return h.forEach(_e=>{let{mid:_n,needExchangeSDP:_o}=_e;_o&&(j=!0),g.push(_n)}),{mids:g,needExchangeSDP:j}}stopSending(a){const h=this.sessionDesc.mediaDescriptions.filter(g=>g.attributes.mid&&a.indexOf(g.attributes.mid)!==-1);if(h.length!==a.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");h.forEach(g=>{g.attributes.mid==="0"||M_()||iy()||x1()?g.attributes.ssrcs=[]:(g.attributes.ssrcs=[],g.attributes.direction="inactive",g.media.port="0")}),this.updateBundleMids()}mute(a){const h=this.sessionDesc.mediaDescriptions.find(g=>g.attributes.mid===a);if(!h)throw new Error("mediaDescription not found with ".concat(a," in remote SDP when calling RemoteSDP.mute."));h.attributes.direction="inactive"}unmute(a){const h=this.sessionDesc.mediaDescriptions.find(g=>g.attributes.mid===a);if(!h)throw new Error("mediaDescription not found with ".concat(a," in remote SDP when calling RemoteSDP.unmute."));h.attributes.direction="sendonly"}muteRemote(a){const h=this.sessionDesc.mediaDescriptions.filter(g=>a.includes(g.attributes.mid||""));if(h.length!==a.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");h.forEach(g=>{g.attributes.direction="inactive"})}unmuteRemote(a){const h=this.sessionDesc.mediaDescriptions.filter(g=>a.includes(g.attributes.mid||""));if(h.length!==a.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");h.forEach(g=>{g.attributes.direction="recvonly"})}receive(a,h,g,j){a.forEach((_e,_n)=>{this.createOrRecycleRecvMedia(_e,[],"recvonly",h,g,j[_n])}),this.updateBundleMids()}stopReceiving(a){const h=this.sessionDesc.mediaDescriptions.filter(g=>a.indexOf(g.attributes.mid)!==-1);if(h.length!==a.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");h.forEach(g=>{g.media.port="0",g.attributes.direction="inactive"}),this.updateBundleMids()}restartICE(a){a=W_(a),this._iceParameters=a,this.sessionDesc.mediaDescriptions.forEach(h=>{h.attributes.iceUfrag=a.iceUfrag,h.attributes.icePwd=a.icePwd})}predictReceivingMids(a){const h=[];for(let g=0;g<a;g++)h.push((this.currentMidIndex+g+1).toString(10));return h}findAvailableMediaIndex(a,h){return this.sessionDesc.mediaDescriptions.findIndex(g=>{const j=g.media.mediaType===a&&g.media.port!=="0"&&(g.attributes.direction==="sendonly"||g.attributes.direction==="sendrecv")&&g.attributes.ssrcs.length===0;if(M_()){if(j){const _e=this.firefoxSsrcMidMap.get(h[0].ssrcId);return!(_e||g.attributes.mid!=="0"&&g.attributes.mid!=="1")||!(!_e||_e!==g.attributes.mid)}return!1}return j})}createOrRecycleRecvMedia(a,h,g,j,_e,_n){const _o=a._mediaStreamTrack.kind,_a=this.rtpCapabilities.recv,_r=this.localCapabilities.send;let ba=[];if(_o===N0.VIDEO){var xa,El;if(wp("H264_PROFILE_LEVEL_ID")&&j==="h264"&&(ba=_a.videoCodecs.filter(Ml=>{var Fl,up;return(((Fl=Ml.rtpMap)===null||Fl===void 0?void 0:Fl.encodingName.toLowerCase())||"").includes(j)&&(Ml==null||(up=Ml.fmtp)===null||up===void 0?void 0:up.parameters["profile-level-id"])===wp("H264_PROFILE_LEVEL_ID")})),!ba||((xa=ba)===null||xa===void 0?void 0:xa.length)===0){const Ml=_r.videoCodecs.filter(Fl=>{var up;return(((up=Fl.rtpMap)===null||up===void 0?void 0:up.encodingName.toLowerCase())||"").includes(j)});Ml.length!==0&&(ba=_a.videoCodecs.filter(Fl=>Ml.some(up=>up.payloadType===Fl.payloadType)))}if(wp("USE_RTX")){const Ml=ba.map(up=>up.payloadType.toString()),Fl=_a.videoCodecs.filter(up=>{var _p,Tp;return((_p=up.rtpMap)===null||_p===void 0?void 0:_p.encodingName)==="rtx"&&Ml.includes(((Tp=up.fmtp)===null||Tp===void 0?void 0:Tp.parameters.apt)||"")});ba=[...ba,...Fl]}ba.length===0&&(Ll.warning("codec ".concat(j," not included in rtpCapabilities, fallback to default payloads: ").concat((El=_a.videoCodecs[0].rtpMap)===null||El===void 0?void 0:El.encodingName)),ba=_a.videoCodecs)}else ba=_a.audioCodecs.filter(Ml=>{var Fl;return(((Fl=Ml.rtpMap)===null||Fl===void 0?void 0:Fl.encodingName.toLowerCase())||"").includes(_e)}),ba.length===0&&(Ll.warning("codec ".concat(_e," not included in rtpCapabilities, fallback to opus")),ba=_a.audioCodecs.filter(Ml=>{var Fl;return(((Fl=Ml.rtpMap)===null||Fl===void 0?void 0:Fl.encodingName.toLowerCase())||"").includes("opus")}));const yl=_o===N0.VIDEO?_a.videoExtensions:_a.audioExtensions;this.currentMidIndex+=1;const Ol="".concat(this.currentMidIndex);let Al={media:{mediaType:_o,port:rU,protos:["UDP","TLS","RTP","SAVPF"],fmts:ba.map(Ml=>Ml.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:yl,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:h,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:ba,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:g,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(Ol)}};Al=this.mungRecvMediaDsec(Al,a,_n);const Nl=this.findFirstClosedMedia(_o);if(Nl){const Ml=this.sessionDesc.mediaDescriptions.indexOf(Nl);this.sessionDesc.mediaDescriptions[Ml]=Al}else this.sessionDesc.mediaDescriptions.push(Al);return Al}createOrRecycleSendMedia(a,h,g,j,_e){const _n=this.rtpCapabilities.send,_o=a===N0.VIDEO?_n.videoCodecs:_n.audioCodecs,_a=a===N0.VIDEO?_n.videoExtensions:_n.audioExtensions;this.currentMidIndex+=1;const _r="".concat(this.currentMidIndex);let ba={media:{mediaType:a,port:rU,protos:["UDP","TLS","RTP","SAVPF"],fmts:_o.map(El=>El.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:_a,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:h,ssrcGroups:g,rtcpFeedbackWildcards:[],payloads:_o,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:j,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_r)}};ba=this.mungSendMediaDesc(ba,_e);const xa=this.findFirstClosedMedia(a);if(xa){const El=this.sessionDesc.mediaDescriptions.indexOf(xa);this.sessionDesc.mediaDescriptions[El]=ba}else this.sessionDesc.mediaDescriptions.push(ba);return ba}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(a=>a.media.port!=="0").map(a=>a.attributes.mid)}mungRecvMediaDsec(a,h,g){const j=W_(a);return _9(j),cN(j,h),y9(j,h),kQ(j),Q4(j,g,this.localCapabilities.send),j}mungSendMediaDesc(a,h){const g=W_(a);return Q4(g,h,this.localCapabilities.recv),IR(g),g}updateRecvMedia(a,h){const g=this.sessionDesc.mediaDescriptions.findIndex(j=>j.attributes.mid===a);if(g!==-1){const j=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[g],h);this.sessionDesc.mediaDescriptions[g]=j}}bumpMid(a){this.currentMidIndex+=a}findFirstClosedMedia(a){return this.sessionDesc.mediaDescriptions.find(h=>M_()?h.media.port==="0"&&h.media.mediaType===a:h.media.port==="0")}findPreloadMediaDesc(a){return this.sessionDesc.mediaDescriptions.find(h=>{var g,j;return((g=h.attributes)===null||g===void 0||(j=g.ssrcs[0])===null||j===void 0?void 0:j.ssrcId)===a[0].ssrcId})}getSSRC(a){var h;return(h=this.sessionDesc.mediaDescriptions.find(g=>g.attributes.mid===a))===null||h===void 0?void 0:h.attributes.ssrcs}}var o_;function u$(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function iU(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?u$(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):u$(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}let vat=(Wp((o_=class W9 extends E4{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(a,h,g){super(a,h),Rl(this,"store",void 0),Rl(this,"peerConnection",void 0),Rl(this,"remoteSDP",void 0),Rl(this,"initialOffer",void 0),Rl(this,"transportEventReceiver",void 0),Rl(this,"statsFilter",void 0),Rl(this,"useRTX",wp("USE_RTX")),Rl(this,"localCapabilities",void 0),Rl(this,"localCandidateCount",0),Rl(this,"allCandidatesReceived",!1),Rl(this,"mutex",new B1("NVExtentionsConnection-mutex")),Rl(this,"rtcMedia",void 0),this.store=h,this.peerConnection=g,this.statsFilter=O9(this.peerConnection,void 0,void 0,M_()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(a){try{const h=await this.peerConnection.createOffer();if(!h.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const g=pO(h.sdp),j=await PQ(!this.useRTX,wp("FILTER_VIDEO_FEC"),wp("FILTER_AUDIO_FEC"));return this.localCapabilities=j,this.initialOffer=h,iU(iU({},g),{},{rtpCapabilities:j,offerSDP:h.sdp})}catch(h){throw new Ql(Hl.GET_LOCAL_CONNECTION_PARAMS_FAILED,h.toString())}}async connect(a,h,g,j,_e,_n){try{if(!this.initialOffer)throw new Error("Cannot establish NVConnection without initial offer.");this.remoteSDP=new mat({remoteIceParameters:a,remoteDtlsParameters:h,candidates:g,remoteRTPCapabilities:j,remoteSetup:_e,localCapabilities:b9(this.localCapabilities),cname:_n});const _o=this.remoteSDP.toString(),_a=K_.exports.parse(this.initialOffer.sdp),_r=_a.mediaDescriptions.find(El=>El.media.mediaType==="audio");_r&&IR(_r);const ba=K_.exports.print(_a),xa=this.logSDPExchange(ba||"","offer","local","connect");await this.peerConnection.setLocalDescription({type:"offer",sdp:ba}),xa==null||xa(_o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_o})}catch(_o){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"NV.connect failed; ".concat(_o.toString()))}}async updateRemoteConnect(a){var h,g,j;(h=this.remoteSDP)===null||h===void 0||h.updateRemoteRTPCapabilities(a),(g=this.remoteSDP)===null||g===void 0||g.preloadRemoteMedia(2);const _e=(j=this.remoteSDP)===null||j===void 0?void 0:j.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_e});const _n=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(_n),Ll.debug("[NVExtentionsConnection] updateRemoteRTPCapabilities by exchanging SDP.")}send(a,h,g){var j=this;return bS(function*(){const _e=yield V0(j.mutex.lock("From NVExtentionsConnection.send"));try{if(!j.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.send before remote SDP created");const _n=[];a.forEach(Al=>{const Nl=j.peerConnection.addTransceiver(Al._mediaStreamTrack,{direction:"sendonly"});_n.push(Nl)}),M_()&&wp("SIMULCAST")===!0&&(yield V0(j.applySimulcastForFirefox(_n,a)));const _o=yield V0(j.peerConnection.createOffer()),_a=j.remoteSDP.predictReceivingMids(a.length),_r=j.mungSendOfferSDP(_o.sdp,a,_a),ba=K_.exports.parse(_r),xa=_a.map(Al=>{const Nl=ba.mediaDescriptions.find(Ml=>Ml.attributes.mid===Al);if(!Nl)throw new Error("Cannot extract ssrc from mediaDescription.");return AQ(Nl,j.useRTX)});let El;try{El=yield xa}catch(Al){El=[],j.remoteSDP.receive(a,h,g,El);const Nl=j.remoteSDP.toString();throw yield V0(j.peerConnection.setLocalDescription({type:"offer",sdp:_r})),yield V0(j.peerConnection.setRemoteDescription({type:"answer",sdp:Nl})),yield V0(j.stopSending(_a,!0)),Al}j.remoteSDP.receive(a,h,g,El);const yl=j.remoteSDP.toString(),Ol=j.logSDPExchange(_r,"offer","local","send");return yield V0(j.peerConnection.setLocalDescription({type:"offer",sdp:_r})),yield V0(j.applySimulcastEncodings(_n,a)),yield V0(j.applySendEncodings(_n,a)),Ol==null||Ol(yl),yield V0(j.peerConnection.setRemoteDescription({type:"answer",sdp:yl})),_n.map((Al,Nl)=>{const Ml=_a[Nl];return{localSSRC:xa[Nl],id:Ml,transceiver:Al}})}catch(_n){throw _n instanceof Ql?_n:new Ql(Hl.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.send failed; ".concat(_n.toString()))}finally{_e()}})()}async stopSending(a,h){const g=h?void 0:await this.mutex.lock("From NVExtentionsConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopSending before remote SDP created");const j=this.peerConnection.getTransceivers().filter(_a=>a.indexOf(_a.mid)!==-1);if(j.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVExtentionsConnection.stopSending.");j.map(_a=>{var _r;_a.direction="inactive",(_r=_a.stop)===null||_r===void 0||_r.call(_a)});const _e=await this.peerConnection.createOffer(),_n=this.logSDPExchange(_e.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(_e),this.remoteSDP.stopReceiving(a);const _o=this.remoteSDP.toString();_n==null||_n(_o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_o})}catch(j){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.stopSending failed; ".concat(j.toString()))}finally{g&&g()}}async receive(a,h,g,j){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.receive ".concat(a," before remoteSDP created."));const{mid:_e,needExchangeSDP:_n}=this.remoteSDP.send(a,h,g,j);if(_n){const _a=this.remoteSDP.toString(),_r=this.logSDPExchange(_a,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_a});const ba=await this.peerConnection.createAnswer(),xa=this.mungReceiveAnswerSDP(ba.sdp,_e,a);_r==null||_r(xa||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:xa}),Ll.debug("[NVExtentionsConnection] receive ".concat(a," by exchanging SDP."))}else Ll.debug("[NVExtentionsConnection] receive ".concat(a," no need to exchange SDP."));const _o=this.peerConnection.getTransceivers().find(_a=>_a.mid===_e);if(!_o)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_o.receiver.track,id:_e}}catch(_e){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(_e.toString()))}}async batchReceive(a){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.batchReceive before remoteSDP created.");const{mids:h,needExchangeSDP:g}=this.remoteSDP.batchSend(a);if(g){const j=this.remoteSDP.toString(),_e=this.logSDPExchange(j,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:j});const _n=await this.peerConnection.createAnswer();_e==null||_e(_n.sdp||""),await this.peerConnection.setLocalDescription(_n),Ll.debug("[NVExtentionsConnection] batchReceive by exchanging SDP.")}else Ll.debug("[NVExtentionsConnection] batchReceive no need to exchange SDP.");return h.map(j=>{const _e=this.peerConnection.getTransceivers().find(_n=>_n.mid===j);if(!_e)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_e.receiver.track,id:j}})}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(h.toString()))}}async stopReceiving(a){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(a);const h=this.remoteSDP.toString(),g=this.logSDPExchange(h,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const j=await this.peerConnection.createAnswer();g==null||g(j.sdp||""),await this.peerConnection.setLocalDescription(j)}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"NVExtentionsConnection stopReceiving failed; ".concat(h.toString()))}}async muteRemote(a){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteRemote mid=".concat(a," before remote SDP created."));this.remoteSDP.mute(a);const h=this.remoteSDP.toString(),g=this.logSDPExchange(h,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const j=await this.peerConnection.createAnswer();g==null||g(j.sdp||""),await this.peerConnection.setLocalDescription(j)}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteRemote failed; ".concat(h.toString()))}}async unmuteRemote(a){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteRemote mid=".concat(a," before remote SDP created."));this.remoteSDP.unmute(a);const h=this.remoteSDP.toString(),g=this.logSDPExchange(h,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const j=await this.peerConnection.createAnswer();g==null||g(j.sdp||""),await this.peerConnection.setLocalDescription(j)}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteRemote failed; ".concat(h.toString()))}}async muteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteLocal before remote SDP created.");const h=this.peerConnection.getTransceivers().filter(_n=>_n.mid&&a.indexOf(_n.mid)!==-1);if(h.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");h.map(_n=>{_n.direction="inactive"});const g=await this.peerConnection.createOffer(),j=this.logSDPExchange(g.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(g),this.remoteSDP.muteRemote(a);const _e=this.remoteSDP.toString();j==null||j(_e),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_e})}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteLocal failed; ".concat(h.toString()))}}async unmuteLocal(a){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteLocal before remote SDP created.");const h=this.peerConnection.getTransceivers().filter(_n=>_n.mid&&a.indexOf(_n.mid)!==-1);if(h.length!==a.length)throw new Error("Transceivers' length doesn't match mids' length.");h.map(async(_n,_o)=>{_n.direction="sendonly"});const g=await this.peerConnection.createOffer(),j=this.logSDPExchange(g.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(g),this.remoteSDP.unmuteRemote(a);const _e=this.remoteSDP.toString();j==null||j(_e),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_e})}catch(h){throw new Ql(Hl.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteLocal failed; ".concat(h.toString()))}}restartICE(){var a=this;return bS(function*(){const h=yield V0(a.mutex.lock("From NVExtentionsConnection.restartICE"));try{const g=yield V0(a.peerConnection.createOffer({iceRestart:!0}));if(!g.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const j=pO(g.sdp),{remoteIceParameters:_e}=yield j.iceParameters;if(!a.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");a.remoteSDP.restartICE(_e);const _n=a.remoteSDP.toString(),_o=a.logSDPExchange(g.sdp||"","offer","local","restartICE");yield V0(a.peerConnection.setLocalDescription(g)),_o==null||_o(_n),yield V0(a.peerConnection.setRemoteDescription({type:"answer",sdp:_n}))}catch(g){Ll.warning("restart ICE failed, abort operation",g)}finally{h()}})()}close(){var a;(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(a){return this.statsFilter.getVideoIsReady(a)}async updateEncoderConfig(a,h){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.updateEncoderConfig before remote SDP created.");const g=await this.peerConnection.createOffer(),j=this.mungSendOfferSDP(g.sdp,[h],[a]);this.remoteSDP.updateRecvMedia(a,h);const _e=this.remoteSDP.toString(),_n=this.logSDPExchange(j,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:j}),_n==null||_n(_e),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_e})}catch(g){throw new Ql(Hl.EXCHANGE_SDP_FAILED,g.toString())}}async updateSendParameters(a,h){const g=this.peerConnection.getTransceivers().filter(j=>j.mid===a);g.length===1&&(this.isVP8Simulcast(h)?M_()||await this.applySimulcastEncodings(g,[h]):await this.applySendEncodings(g,[h]))}setStatsRemoteVideoIsReady(a,h){this.statsFilter.setVideoIsReady2(a,h)}async replaceTrack(a,h){const g=this.peerConnection.getTransceivers().find(j=>j.mid===h);g&&await g.sender.replaceTrack(a._mediaStreamTrack)}getP2PConnectionParams(){var a;if((a=this.peerConnection.currentLocalDescription)===null||a===void 0||!a.sdp||!this.localCapabilities)throw new Error;return iU(iU({},pO(this.peerConnection.currentLocalDescription.sdp)),{},{rtpCapabilities:this.localCapabilities})}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var a;(a=this.onICEConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var a;(a=this.onConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=a=>{a.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,Ll.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,Ll.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},wp("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(a){const h={iceServers:[]};return a.iceServers?h.iceServers=a.iceServers:a.turnServer&&a.turnServer.mode!=="off"&&(RP(a.turnServer.servers)?h.iceServers=a.turnServer.servers:(h.iceServers&&h.iceServers.push(...W9.turnServerConfigToIceServers(a.turnServer.servers)),wp("USE_TURN_SERVER_OF_GATEWAY")&&h.iceServers&&a.turnServer.serversFromGateway&&h.iceServers.push(...W9.turnServerConfigToIceServers(a.turnServer.serversFromGateway)),wp("FORCE_TURN_TCP")?h.iceTransportPolicy="relay":a.turnServer.servers.concat(a.turnServer.serversFromGateway||[]).forEach(g=>{g.forceturn&&(h.iceTransportPolicy="relay")}))),h}static turnServerConfigToIceServers(a){const h=[];return a.forEach(g=>{g.security?g.tcpport&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turns:".concat(w4(g.turnServerURL),":").concat(g.tcpport,"?transport=tcp")}):(g.udpport&&!wp("FORCE_TURN_TCP")&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turn:".concat(g.turnServerURL,":").concat(g.udpport,"?transport=udp")}),g.tcpport&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turn:".concat(g.turnServerURL,":").concat(g.tcpport,"?transport=tcp")}))}),h}async applySendEncodings(a,h){try{if(!O1().supportSetRtpSenderParameters||a.length!==h.length)return;for(let _r=0;_r<a.length;_r++){const ba=a[_r],xa=h[_r];if(xa&&xa instanceof H_){var g,j;if(this.isVP8Simulcast(xa))continue;const El={},yl={};switch(xa._optimizationMode){case"motion":El.degradationPreference="maintain-framerate";break;case"detail":El.degradationPreference="maintain-resolution";break;default:El.degradationPreference="balanced"}var _e,_n,_o,_a;if((g=xa._encoderConfig)!==null&&g!==void 0&&g.bitrateMax&&(yl.maxBitrate=1e3*((_e=xa._encoderConfig)===null||_e===void 0?void 0:_e.bitrateMax)),xa._hints.includes(c1.LOW_STREAM)&&((_n=xa._encoderConfig)!==null&&_n!==void 0&&_n.frameRate&&(yl.maxFramerate=xT(xa._encoderConfig.frameRate)),(_o=xa._encoderConfig)!==null&&_o!==void 0&&_o.scaleResolutionDownBy&&((_a=xa._encoderConfig)===null||_a===void 0?void 0:_a.scaleResolutionDownBy)>1&&(yl.scaleResolutionDownBy=xa._encoderConfig.scaleResolutionDownBy)),wp("DSCP_TYPE")&&_I()){const Nl=wp("DSCP_TYPE");["very-low","low","medium","high"].includes(Nl)&&(yl.networkPriority=Nl)}const Ol=ba.sender.getParameters(),Al=(j=Ol.encodings)===null||j===void 0?void 0:j[0];M_()&&!Al&&(El.encodings=[yl]),Al&&Object.assign(Al,yl),Object.assign(Ol,El),await ba.sender.setParameters(Ol)}}}catch{Ll.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(a,h,g){const j=K_.exports.parse(a);return h.forEach((_e,_n)=>{const _o=g[_n],_a=j.mediaDescriptions.find(_r=>_r.attributes.mid===_o);_a&&(cN(_a,_e),LQ(_a,_e,this.store.codec))}),K_.exports.print(j)}mungReceiveAnswerSDP(a,h,g){const j=K_.exports.parse(a),_e=j.mediaDescriptions.find(_n=>_n.attributes.mid===h);return _e&&g===N0.AUDIO&&_e.media.mediaType==="audio"&&IR(_e),K_.exports.print(j)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=a=>{var h;(h=this.onFirstAudioReceived)===null||h===void 0||h.call(this,a)},this.statsFilter.onFirstVideoReceived=a=>{var h;(h=this.onFirstVideoReceived)===null||h===void 0||h.call(this,a)},this.statsFilter.onFirstAudioDecoded=a=>{var h;(h=this.onFirstAudioDecoded)===null||h===void 0||h.call(this,a)},this.statsFilter.onFirstVideoDecoded=(a,h,g)=>{var j;(j=this.onFirstVideoDecoded)===null||j===void 0||j.call(this,a,h,g)},this.statsFilter.onSelectedLocalCandidateChanged=(a,h)=>{var g;(g=this.onSelectedLocalCandidateChanged)===null||g===void 0||g.call(this,a,h)},this.statsFilter.onSelectedRemoteCandidateChanged=(a,h)=>{var g;(g=this.onSelectedRemoteCandidateChanged)===null||g===void 0||g.call(this,a,h)},this.statsFilter.onFirstVideoDecodedTimeout=a=>{var h;(h=this.onFirstVideoDecodedTimeout)===null||h===void 0||h.call(this,a)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(a,h){if(a.length===h.length)for(let _o=0;_o<a.length;_o++){var g,j,_e,_n;const _a=a[_o],_r=h[_o];if(_r instanceof H_&&!_r._hints.includes(c1.LOW_STREAM)&&(g=_r._encoderConfig)!==null&&g!==void 0&&g.bitrateMax&&((j=_r._encoderConfig)===null||j===void 0?void 0:j.bitrateMax)>200&&(_e=_r._scalabiltyMode)!==null&&_e!==void 0&&_e.numSpatialLayers&&((_n=_r._scalabiltyMode)===null||_n===void 0?void 0:_n.numSpatialLayers)>1&&this.store.codec==="vp8"){const ba={},xa={high:1e3*(_r._encoderConfig.bitrateMax-50),medium:5e4};ba.encodings=[{rid:"m",active:!0,maxBitrate:xa.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:xa.high}];const El=_a.sender.getParameters();await _a.sender.setParameters(Object.assign(El,ba))}}}async applySimulcastEncodings(a,h){if(!M_()&&a.length===h.length)for(let g=0;g<a.length;g++){const j=h[g];if(j instanceof H_&&this.isVP8Simulcast(j)){const _e=a[g],_n={},_o={high:1e3*(j._encoderConfig.bitrateMax-50),medium:5e4};_n.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:_o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:_o.medium,scaleResolutionDownBy:4}];const _a=_e.sender.getParameters();await _e.sender.setParameters(Object.assign(_a,_n))}}}isVP8Simulcast(a){var h,g,j,_e;return!!(a instanceof H_&&wp("SIMULCAST")&&this.store.codec==="vp8"&&!a._hints.includes(c1.LOW_STREAM)&&(h=a._encoderConfig)!==null&&h!==void 0&&h.bitrateMax&&((g=a._encoderConfig)===null||g===void 0?void 0:g.bitrateMax)>200&&(j=a._scalabiltyMode)!==null&&j!==void 0&&j.numSpatialLayers&&((_e=a._scalabiltyMode)===null||_e===void 0?void 0:_e.numSpatialLayers)>1)}logSDPExchange(a,h,g,j){if(wp("SDP_LOGGING"))return Ll.upload("exchanging ".concat(g," ").concat(h," SDP during NVExtentionsConnection.").concat(j,`
`),a),h==="offer"?_e=>{this.logSDPExchange(_e,"answer",g==="local"?"remote":"local",j)}:void 0}async getRemoteSSRC(a){if(!this.remoteSDP)return;const h=this.remoteSDP.getSSRC(a);return h==null?void 0:h[0].ssrcId}}).prototype,"connect",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"connect"),o_.prototype),Wp(o_.prototype,"updateRemoteConnect",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"updateRemoteConnect"),o_.prototype),Wp(o_.prototype,"receive",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"receive"),o_.prototype),Wp(o_.prototype,"batchReceive",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"batchReceive"),o_.prototype),Wp(o_.prototype,"stopReceiving",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"stopReceiving"),o_.prototype),Wp(o_.prototype,"muteRemote",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"muteRemote"),o_.prototype),Wp(o_.prototype,"unmuteRemote",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"unmuteRemote"),o_.prototype),Wp(o_.prototype,"muteLocal",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"muteLocal"),o_.prototype),Wp(o_.prototype,"unmuteLocal",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"unmuteLocal"),o_.prototype),Wp(o_.prototype,"close",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"close"),o_.prototype),Wp(o_.prototype,"updateEncoderConfig",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"updateEncoderConfig"),o_.prototype),Wp(o_.prototype,"updateSendParameters",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"updateSendParameters"),o_.prototype),Wp(o_.prototype,"replaceTrack",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"replaceTrack"),o_.prototype),Wp(o_.prototype,"getRemoteSSRC",[Dy],Object.getOwnPropertyDescriptor(o_.prototype,"getRemoteSSRC"),o_.prototype),o_);function Dy(s,a,h){const g=s[a];if(typeof g!="function")throw new Error("Cannot use mutex on object property.");return h.value=async function(){const j=this.mutex,_e=await j.lock("From NVExtentionsConnection.".concat(a));try{for(var _n=arguments.length,_o=new Array(_n),_a=0;_a<_n;_a++)_o[_a]=arguments[_a];return await g.apply(this,_o)}finally{_e()}},h}var g_;function l$(s){var a,h,g,j=2;for(typeof Symbol<"u"&&(h=IQ,g=Symbol.iterator);j--;){if(h&&(a=s[h])!=null)return a.call(s);if(g&&(a=s[g])!=null)return new N9(a.call(s));h="@@asyncIterator",g="@@iterator"}throw new TypeError("Object is not async iterable")}function N9(s){function a(h){if(Object(h)!==h)return s0.reject(new TypeError(h+" is not an object."));var g=h.done;return s0.resolve(h.value).then(function(j){return{value:j,done:g}})}return(N9=function(h){this.s=h,this.n=h.next}).prototype={s:null,n:null,next:function(){return a(this.n.apply(this.s,arguments))},return:function(h){var g=this.s.return;return g===void 0?s0.resolve({value:h,done:!0}):a(g.apply(this.s,arguments))},throw:function(h){var g=this.s.return;return g===void 0?s0.reject(h):a(g.apply(this.s,arguments))}},new N9(s)}let k9=(Wp((g_=class pU extends E4{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(a,h){super(a,h),Rl(this,"store",void 0),Rl(this,"peerConnection",void 0),Rl(this,"cname",void 0),Rl(this,"mutex",new B1("DataChannelConnection-mutex")),Rl(this,"dataChannel",void 0),Rl(this,"_p2pConnection",void 0),Rl(this,"_nvMedia",void 0),this.store=h,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection(pU.resolvePCConfiguration(a),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new vat(a,h,this.peerConnection),this.bindPCEvents()}async establish(){var a;const h=(a=this._nvMedia)===null||a===void 0?void 0:a.getLocalRtpCapabilities();return await this._p2pConnection.establish(h)}getP2PConnectionParams(){return this._p2pConnection.getP2PConnectionParams()}async connect(a,h,g,j,_e,_n){return this.cname=_n,await this._p2pConnection.connect(a,h,g,j,_e,_n),await new s0((_o,_a)=>{const _r=setTimeout(()=>{this.closeSignal(),_a(new Ql(Hl.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(g))))},2e3);this.dataChannel.onopen=()=>{if(this.dataChannel.readyState==="open")return clearTimeout(_r),void _o()},this.dataChannel.onerror=ba=>{this.closeSignal(),_a(ba)}}),{transmitter:this.dataChannel,close:this.closeSignal.bind(this)}}send(a,h,g){var j=this;return bS(function*(){const _e=yield V0(j.mutex.lock("From DataChannelConnection.send"));try{return yield*s3(l$(j._p2pConnection.send(a,h,g)),V0)}finally{_e()}})()}async stopSending(a,h){return this._p2pConnection.stopSending(a,h)}async receive(a,h,g,j){return this._nvMedia?(Ll.debug("[DataChannelConnection] receive ".concat(a," by DataChannel.")),await this._nvMedia.reveiveByRTCMedia(a,h,this.cname)):(Ll.debug("[DataChannelConnection] receive ".concat(a," by WebRTC.")),await this._p2pConnection.receive(a,h,g,j))}async batchReceive(a){return[...await this._p2pConnection.batchReceive(a)]}async stopReceiving(a){return await this._p2pConnection.stopReceiving(a)}async muteRemote(a){return await this._p2pConnection.muteRemote(a)}async unmuteRemote(a){return await this._p2pConnection.unmuteRemote(a)}async muteLocal(a){return await this._p2pConnection.muteLocal(a)}async unmuteLocal(a){return await this._p2pConnection.unmuteLocal(a)}restartICE(){var a=this;return bS(function*(){return yield*s3(l$(a._p2pConnection.restartICE()),V0)})()}close(){var a;(a=this._nvMedia)===null||a===void 0||a.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(a){return this._p2pConnection.getRemoteVideoIsReady(a)}updateRemoteConnect(a){var h;(h=this._nvMedia)===null||h===void 0||h.setRemoteRtpCapabilities(a),this._p2pConnection.updateRemoteConnect(a)}async updateEncoderConfig(a,h){return await this._p2pConnection.updateEncoderConfig(a,h)}async updateSendParameters(a,h){return await this._p2pConnection.updateSendParameters(a,h)}setStatsRemoteVideoIsReady(a,h){this._p2pConnection.setStatsRemoteVideoIsReady(a,h)}async replaceTrack(a,h){return await this._p2pConnection.replaceTrack(a,h)}async getRemoteSSRC(a){return this._p2pConnection.getRemoteSSRC(a)}logSDPExchange(a,h,g,j){if(wp("SDP_LOGGING"))return Ll.upload("exchanging ".concat(g," ").concat(h," SDP during DataChannelConnection.").concat(j,`
`),a),h==="offer"?_e=>{this.logSDPExchange(_e,"answer",g==="local"?"remote":"local",j)}:void 0}static resolvePCConfiguration(a){const h={iceServers:[]};return a.iceServers?h.iceServers=a.iceServers:a.turnServer&&a.turnServer.mode!=="off"&&(RP(a.turnServer.servers)?h.iceServers=a.turnServer.servers:(h.iceServers&&h.iceServers.push(...pU.turnServerConfigToIceServers(a.turnServer.servers)),wp("USE_TURN_SERVER_OF_GATEWAY")&&h.iceServers&&a.turnServer.serversFromGateway&&h.iceServers.push(...pU.turnServerConfigToIceServers(a.turnServer.serversFromGateway)),wp("FORCE_TURN_TCP")?h.iceTransportPolicy="relay":a.turnServer.servers.concat(a.turnServer.serversFromGateway||[]).forEach(g=>{g.forceturn&&(h.iceTransportPolicy="relay")}))),h}static turnServerConfigToIceServers(a){const h=[];return a.forEach(g=>{g.security?g.tcpport&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turns:".concat(w4(g.turnServerURL),":").concat(g.tcpport,"?transport=tcp")}):(g.udpport&&!wp("FORCE_TURN_TCP")&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turn:".concat(g.turnServerURL,":").concat(g.udpport,"?transport=udp")}),g.tcpport&&h.push({username:g.username,credential:g.password,credentialType:"password",urls:"turn:".concat(g.turnServerURL,":").concat(g.tcpport,"?transport=tcp")}))}),h}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=a=>{var h;return(h=this.onICEConnectionStateChange)===null||h===void 0?void 0:h.call(this,a)},this._p2pConnection.onConnectionStateChange=a=>{var h;return(h=this.onConnectionStateChange)===null||h===void 0?void 0:h.call(this,a)},this._p2pConnection.onDTLSTransportStateChange=a=>{var h;return(h=this.onDTLSTransportStateChange)===null||h===void 0?void 0:h.call(this,a)},this._p2pConnection.onDTLSTransportError=a=>{var h;return(h=this.onDTLSTransportError)===null||h===void 0?void 0:h.call(this,a)},this._p2pConnection.onICETransportStateChange=a=>{var h;return(h=this.onICETransportStateChange)===null||h===void 0?void 0:h.call(this,a)},this._p2pConnection.onFirstAudioReceived=a=>{var h;return(h=this.onFirstAudioReceived)===null||h===void 0?void 0:h.call(this,a)},this._p2pConnection.onFirstVideoReceived=a=>{var h;return(h=this.onFirstVideoReceived)===null||h===void 0?void 0:h.call(this,a)},this._p2pConnection.onFirstAudioDecoded=a=>{var h;return(h=this.onFirstAudioDecoded)===null||h===void 0?void 0:h.call(this,a)},this._p2pConnection.onFirstVideoDecoded=(a,h,g)=>{var j;return(j=this.onFirstVideoDecoded)===null||j===void 0?void 0:j.call(this,a,h,g)},this._p2pConnection.onFirstVideoDecodedTimeout=a=>{var h;return(h=this.onFirstVideoDecodedTimeout)===null||h===void 0?void 0:h.call(this,a)},this._p2pConnection.onSelectedLocalCandidateChanged=(a,h)=>{var g;return(g=this.onSelectedLocalCandidateChanged)===null||g===void 0?void 0:g.call(this,a,h)},this._p2pConnection.onSelectedRemoteCandidateChanged=(a,h)=>{var g;return(g=this.onSelectedRemoteCandidateChanged)===null||g===void 0?void 0:g.call(this,a,h)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(a){a.onConnectionStateChange=void 0,a.onICEConnectionStateChange=void 0,a.onICETransportStateChange=void 0,a.onDTLSTransportStateChange=void 0,a.onDTLSTransportError=void 0,a.onFirstAudioDecoded=void 0,a.onFirstAudioReceived=void 0,a.onFirstVideoDecoded=void 0,a.onFirstVideoReceived=void 0,a.onSelectedLocalCandidateChanged=void 0,a.onSelectedRemoteCandidateChanged=void 0,a.onFirstVideoDecodedTimeout=void 0}}).prototype,"connect",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"connect"),g_.prototype),Wp(g_.prototype,"receive",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"receive"),g_.prototype),Wp(g_.prototype,"stopReceiving",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"stopReceiving"),g_.prototype),Wp(g_.prototype,"muteRemote",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"muteRemote"),g_.prototype),Wp(g_.prototype,"unmuteRemote",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"unmuteRemote"),g_.prototype),Wp(g_.prototype,"muteLocal",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"muteLocal"),g_.prototype),Wp(g_.prototype,"unmuteLocal",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"unmuteLocal"),g_.prototype),Wp(g_.prototype,"close",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"close"),g_.prototype),Wp(g_.prototype,"updateEncoderConfig",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"updateEncoderConfig"),g_.prototype),Wp(g_.prototype,"updateSendParameters",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"updateSendParameters"),g_.prototype),Wp(g_.prototype,"replaceTrack",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"replaceTrack"),g_.prototype),Wp(g_.prototype,"getRemoteSSRC",[RS],Object.getOwnPropertyDescriptor(g_.prototype,"getRemoteSSRC"),g_.prototype),g_);function RS(s,a,h){const g=s[a];if(typeof g!="function")throw new Error("Cannot use mutex on object property.");return h.value=async function(){const j=this.mutex,_e=await j.lock("From DataChannelConnection.".concat(a));try{for(var _n=arguments.length,_o=new Array(_n),_a=0;_a<_n;_a++)_o[_a]=arguments[_a];return await g.apply(this,_o)}finally{_e()}},h}var J0;function d$(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function OR(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?d$(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):d$(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}function L9(s){var a,h,g,j=2;for(typeof Symbol<"u"&&(h=IQ,g=Symbol.iterator);j--;){if(h&&(a=s[h])!=null)return a.call(s);if(g&&(a=s[g])!=null)return new P9(a.call(s));h="@@asyncIterator",g="@@iterator"}throw new TypeError("Object is not async iterable")}function P9(s){function a(h){if(Object(h)!==h)return s0.reject(new TypeError(h+" is not an object."));var g=h.done;return s0.resolve(h.value).then(function(j){return{value:j,done:g}})}return(P9=function(h){this.s=h,this.n=h.next}).prototype={s:null,n:null,next:function(){return a(this.n.apply(this.s,arguments))},return:function(h){var g=this.s.return;return g===void 0?s0.resolve({value:h,done:!0}):a(g.apply(this.s,arguments))},throw:function(h){var g=this.s.return;return g===void 0?s0.reject(h):a(g.apply(this.s,arguments))}},new P9(s)}let Eat=(Wp((J0=class extends C_{get state(){return this._state}set state(s){const a=this._state;this._state=s,this.emit(z0.StateChange,a,this._state)}constructor(s,a){super(),Rl(this,"store",void 0),Rl(this,"statsUploader",void 0),Rl(this,"connection",void 0),Rl(this,"localTrackMap",new Map),Rl(this,"remoteUserMap",new Map),Rl(this,"pendingLocalTracks",[]),Rl(this,"pendingRemoteTracks",[]),Rl(this,"statsCollector",void 0),Rl(this,"isPlanB",!1),Rl(this,"iceFailedCount",0),Rl(this,"dtlsFailedCount",0),Rl(this,"mutex",new B1("P2PChannel-mutex")),Rl(this,"_state",w1.Disconnected),Rl(this,"handleMuteLocalTrack",async(h,g,j)=>{const _e=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==w1.Connected)return void j(new Ql(Hl.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const _n=this.filterTobeMutedTracks(h);if(_n.length===0)return void g();const _o=_n.find(_r=>_r[0]==="videoLowTrack");_o&&_o[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(_n.map(_r=>{let[,{id:ba}]=_r;return ba}));const _a=this.createMuteMessage(_n);await D_(this,z0.RequestMuteLocal,_a),g()}catch(_n){j(_n)}finally{_e()}}),Rl(this,"handleUnmuteLocalTrack",async(h,g,j)=>{const _e=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==w1.Connected)return void j(new Ql(Hl.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const _n=this.filterTobeUnmutedTracks(h);if(_n.length===0)return void g();const _o=_n.find(_r=>_r[0]==="videoLowTrack");if(_o){const _r=_o[1];if(_r.track._originMediaStreamTrack.stop(),O1().supportDualStreamEncoding){const ba=h._mediaStreamTrack.clone();_r.track._mediaStreamTrack=ba,_r.track._originMediaStreamTrack=ba}else{const ba=zQ(h,sO(this,z0.RequestLowStreamParameter));_r.track._mediaStreamTrack=ba,_r.track._originMediaStreamTrack=ba}await new s0((ba,xa)=>{this.handleReplaceTrack(_r.track,ba,xa,!0)})}await this.connection.unmuteLocal(_n.map(_r=>{let[,{id:ba}]=_r;return ba}));const _a=this.createUnmuteMessage(_n);await D_(this,z0.RequestUnmuteLocal,_a),g()}catch(_n){j(_n)}finally{_e()}}),Rl(this,"handleUpdateVideoEncoder",async(h,g,j)=>{const _e=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const _n=this.localTrackMap.get(a0.LocalVideoTrack);if(!this.connection||!_n||_n.track!==h||this.state!==w1.Connected)return void g();const{id:_o,track:_a}=_n;await this.connection.updateSendParameters(_o,_a),await this.connection.updateEncoderConfig(_o,_a),this.emit(z0.UpdateVideoEncoder,_a),g()}catch(_n){j(_n)}finally{_e()}}),Rl(this,"handleSetOptimizationMode",async(h,g,j)=>{const _e=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const _n=this.localTrackMap.get(a0.LocalVideoTrack);if(!this.connection||!_n||_n.track!==h||this.state!==w1.Connected)return;const{id:_o,track:_a}=_n;await this.connection.updateSendParameters(_o,_a),g()}catch(_n){j(_n)}finally{_e()}}),Rl(this,"handleReplaceTrack",async(h,g,j,_e)=>{let _n;Ll.debug("P2PChannel handleReplaceTrack for [track-id-".concat(h.getTrackId(),"]")),typeof _e=="boolean"&&_e||(_n=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var _o;const _r=Array.from(this.localTrackMap.entries()).find(ba=>{let[,{track:xa}]=ba;return h===xa});if(!this.connection||!_r||this.state!==w1.Connected)return void g();if(await((_o=this.connection)===null||_o===void 0?void 0:_o.replaceTrack(h,_r[1].id)),this.isPlanB){const ba=_r[1];ba.id=h._mediaStreamTrack.id,this.localTrackMap.set(_r[0],ba)}if(_r[0]===a0.LocalVideoTrack&&O1().supportDualStreamEncoding){const ba=this.localTrackMap.get(a0.LocalVideoLowTrack);if(ba){const xa=h._mediaStreamTrack.clone();ba.track._originMediaStreamTrack.stop(),ba.track._mediaStreamTrack=xa,ba.track._originMediaStreamTrack=xa,await new s0((El,yl)=>{this.handleReplaceTrack(ba.track,El,yl,!0)})}}g()}catch(_r){j(_r)}finally{var _a;(_a=_n)===null||_a===void 0||_a()}}),Rl(this,"handleGetLocalVideoStats",h=>{h(this.statsCollector.getLocalVideoTrackStats())}),Rl(this,"handleGetLocalAudioStats",h=>{h(this.statsCollector.getLocalAudioTrackStats())}),Rl(this,"handleGetRemoteVideoStats",h=>this.statsCollector.getRemoteVideoTrackStats(h.uid)[h.uid]),Rl(this,"handleGetRemoteAudioStats",h=>this.statsCollector.getRemoteAudioTrackStats(h.uid)[h.uid]),this.store=s,this.statsCollector=a,this.statsCollector.addP2PChannel(this),this.statsUploader=new gat,this.bindStatsUploaderEvents(),this.isPlanB=!O1().supportUnifiedPlan||wp("CHROME_FORCE_PLAN_B")&&_I()}async startP2PConnection(s,a){return this.state=w1.New,this.connection=a?new k9(s,this.store):this.isPlanB?new hat(s,this.store):new fat(s,this.store),this.bindConnectionEvents(this.connection),this.connection.establish()}async connect(s,a,h,g,j,_e){if(!this.connection)throw new Ql(Hl.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.connection instanceof k9?this.connection.updateRemoteConnect(g):(this.store.peerConnectionStart(),await this.connection.connect(s,a,h,g,j,_e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=w1.Connected)}async preConnect(s,a,h,g,j,_e){if(!this.connection)throw new Ql(Hl.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.store.peerConnectionStart();const _n=await this.connection.connect(s,a,h,g,j,_e);return this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=w1.Connected,_n}getEstablishParams(){if(this.connection instanceof k9)return this.connection.getP2PConnectionParams();throw new Error("Only DataChannelConnection needs to obtain establishParams")}publish(s,a,h){var g=this;return bS(function*(){const j=yield V0(g.mutex.lock("From P2PChannel.publish"));try{if(!g.connection||g.state!==w1.Connected){if(g.state===w1.Disconnected)throw new Ql(Hl.UNEXPECTED_ERROR,"PeerConnection already disconnected.");g.throwIfTrackTypeNotMatch(s);const _n=s.filter(_o=>g.pendingLocalTracks.indexOf(_o)===-1);return void(g.pendingLocalTracks=g.pendingLocalTracks.concat(_n))}g.store.pubId=g.store.pubId+1,Jy.markPublishStart(g.store.clientId,g.store.pubId);const _e=g.filterTobePublishedTracks(s,a,h);if(_e.length===0)return void(yield V0(g.tryToUnmuteAudio(s)));yield*s3(L9(g.doPublish(g.connection,_e)),V0)}finally{j()}})()}doPublish(s,a){var h=this;return bS(function*(){a.forEach(_r=>{let{track:ba,type:xa}=_r;const El=Date.now();h.store.publish(ba.getTrackId(),xa===a0.LocalAudioTrack?"audio":"video",El)}),h.bindLocalTrackEvents(a);const g=yield V0(s.send(a.map(_r=>{let{track:ba}=_r;return ba}),h.store.codec,h.store.audioCodec)),j=(yield V0(g.next())).value,_e=h.createGatewayPublishMessage(a,j);let _n;try{_n=yield _e}catch(_r){throw g.throw(_r),(_r==null?void 0:_r.code)===Hl.WS_ABORT&&a.forEach(ba=>{let{track:xa}=ba;h.pendingLocalTracks.indexOf(xa)===-1&&h.pendingLocalTracks.push(xa)}),h.unbindLocalTrackEvents(a),_r}const _o=h.mapPubResToRemoteConfig(_e,_n),_a=(yield V0(g.next(_o))).value;a.forEach(_r=>{let{type:ba}=_r;h.statsCollector.addLocalStats(ba)}),h.assignLocalTracks(a,_a),h.statsUploader.startUploadUplinkStats(),a.forEach(_r=>{let{track:ba,type:xa}=_r;const El=Date.now();h.store.publish(ba.getTrackId(),xa===a0.LocalAudioTrack?"audio":"video",void 0,El)})})()}publishLowStream(s){var a=this;return bS(function*(){if(!a.connection||a.state!==w1.Connected)return;const h=yield V0(a.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const j=a.localTrackMap.get(a0.LocalVideoTrack);if(!j)throw new Ql(Hl.UNEXPECTED_ERROR,"Could not find high stream");if(a.localTrackMap.has(a0.LocalVideoLowTrack))throw new Ql(Hl.UNEXPECTED_ERROR,"[".concat(a.store.clientId,"] Can't publish low stream when stream already publish"));const _e=[{track:a.getLowVideoTrack(j.track,s),type:a0.LocalVideoLowTrack}];if(yield*s3(L9(a.doPublish(a.connection,_e)),V0),j.track.muted||!j.track.enabled){var g;const _n=(g=a.localTrackMap.get(a0.LocalVideoLowTrack))===null||g===void 0?void 0:g.id;_n!==void 0&&(yield V0(a.connection.muteLocal([_n])))}}finally{h()}})()}async republish(){this.pendingLocalTracks.length>0&&(Ll.debug("Emit P2PChannelEvents.RequestRePublish to republish tracks."),await A1(this,z0.RequestRePublish,this.pendingLocalTracks),this.emit(z0.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async reSubscribe(s){for(let a=this.pendingRemoteTracks.length-1;a>=0;a--){const{user:h,kind:g}=this.pendingRemoteTracks[a];(g!==N0.AUDIO||h._audio_added_&&h._audioSSRC)&&(g!==N0.VIDEO||h._video_added_&&h._videoSSRC)||this.pendingRemoteTracks.splice(a,1)}if(s)await A1(this,z0.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:a,kind:h}of this.pendingRemoteTracks)await this.subscribe(a,h,h===N0.VIDEO?a._videoSSRC:a._audioSSRC);this.pendingRemoteTracks.forEach(a=>{let{user:h}=a;this.emit(z0.MediaReconnectEnd,h.uid)}),this.pendingRemoteTracks=[]}async unpublish(s){if(!this.connection||this.state!==w1.Connected)return void s.forEach(g=>{const j=this.pendingLocalTracks.indexOf(g);j!==-1&&this.pendingLocalTracks.splice(j,1)});const a=this.filterTobeUnpublishedTracks(s);if(a.length===0)return;const h=a.find(g=>g[0]==="videoLowTrack");return h&&h[1].track.close(),this.doUnpublish(this.connection,a)}async unpublishLowStream(){if(!this.connection||this.state!==w1.Connected)return;const s=this.localTrackMap.get(a0.LocalVideoLowTrack);if(!s)return;s.track.close();const a=[[a0.LocalVideoLowTrack,s]];return this.doUnpublish(this.connection,a)}async doUnpublish(s,a){const h=this.createGatewayUnpublishMessage(a);return await s.stopSending(a.map(g=>{let[,{id:j}]=g;return j})),this.withdrawLocalTracks(a),this.unbindLocalTrackEvents(a.map(g=>{let[j,{track:_e}]=g;return{type:j,track:_e}})),a.forEach(g=>{let[j]=g;this.statsCollector.removeLocalStats(j)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadUplinkStats(),h}async subscribe(s,a,h,g,j){var _e;if(!this.connection||this.state!==w1.Connected)throw new Ql(Hl.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((_e=this.remoteUserMap.get(s))!==null&&_e!==void 0&&_e.has(a))return;let _n,_o;if(j){const ba=j.find(El=>{let{stream_type:yl}=El;return yl===a});if(!ba)throw new Ql(Hl.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(a," for user: ").concat(s.uid," because subscribe answer from gateway does not contain stream_type: ").concat(a,"."));const xa=await this.connection.receive(a,ba.ssrcs,String(s._uintid),ba.attributes);_n=xa.track,_o=xa.id}else{const ba=await this.connection.receive(a,[{ssrcId:h,rtx:g}],String(s._uintid),void 0);_n=ba.track,_o=ba.id}a===N0.AUDIO?(s._audioTrack?s._audioTrack._updateOriginMediaStreamTrack(_n):(s._audioTrack=new nU(_n,s.uid,s._uintid,this.store),Ll.info("[".concat(this.store.p2pId,"] create remote audio track: ").concat(s._audioTrack.getTrackId()))),this.bindRemoteTrackEvents(s,s._audioTrack)):(s._videoTrack?s._videoTrack._updateOriginMediaStreamTrack(_n):(s._videoTrack=new eU(_n,s.uid,s._uintid,this.store),Ll.info("[".concat(this.store.p2pId,"] create remote video track: ").concat(s._videoTrack.getTrackId()))),this.bindRemoteTrackEvents(s,s._videoTrack));const _a=this.remoteUserMap.get(s);_a?_a.set(a,_o):this.remoteUserMap.set(s,new Map([[a,_o]])),this.statsCollector.addRemoteStats(s.uid),this.statsUploader.startUploadDownlinkStats();const _r=this.pendingRemoteTracks.findIndex(ba=>{let{user:xa,kind:El}=ba;return xa.uid===s.uid&&a===El});_r!==-1&&(this.pendingRemoteTracks.splice(_r,1),this.emit(z0.MediaReconnectEnd,s.uid))}async massSubscribe(s){return this.massSubscribeNoLock(s)}async massSubscribeNoLock(s){if(!this.connection||this.state!==w1.Connected)throw new Ql(Hl.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");s=s.filter(h=>{var g;let{user:j,mediaType:_e}=h;return!((g=this.remoteUserMap.get(j))!==null&&g!==void 0&&g.has(_e))});const a=await this.connection.batchReceive(s.map(h=>{let{user:g,mediaType:j,ssrcId:_e,rtxSsrcId:_n}=h;return{kind:j,ssrcMsg:[{ssrcId:_e,rtx:_n}],mslabel:String(g._uintid)}}));s.forEach((h,g)=>{let{user:j,mediaType:_e}=h;const{track:_n,id:_o}=a[g];_e===N0.AUDIO?(j._audioTrack?j._audioTrack._updateOriginMediaStreamTrack(_n):(j._audioTrack=new nU(_n,j.uid,j._uintid,this.store),Ll.info("[".concat(this.store.p2pId,"] create remote audio track: ").concat(j._audioTrack.getTrackId()))),this.bindRemoteTrackEvents(j,j._audioTrack)):(j._videoTrack?j._videoTrack._updateOriginMediaStreamTrack(_n):(j._videoTrack=new eU(_n,j.uid,j._uintid,this.store),Ll.info("[".concat(this.store.p2pId,"] create remote video track: ").concat(j._videoTrack.getTrackId()))),this.bindRemoteTrackEvents(j,j._videoTrack));const _a=this.remoteUserMap.get(j);_a?_a.set(_e,_o):this.remoteUserMap.set(j,new Map([[_e,_o]])),this.statsCollector.addRemoteStats(j.uid),this.statsUploader.startUploadDownlinkStats();const _r=this.pendingRemoteTracks.findIndex(ba=>{let{user:xa,kind:El}=ba;return xa.uid===j.uid&&_e===El});_r!==-1&&(this.pendingRemoteTracks.splice(_r,1),this.emit(z0.MediaReconnectEnd,j.uid))})}async unsubscribe(s,a,h){const g=this.pendingRemoteTracks.filter(_n=>{let{user:_o,kind:_a}=_n;return a!==void 0?_o.uid===s.uid&&a===_a:_o.uid===s.uid});if(g.forEach(_n=>{const _o=this.pendingRemoteTracks.indexOf(_n);this.pendingRemoteTracks.splice(_o,1)}),this.connection||h||g.forEach(_n=>{let{kind:_o}=_n;var _a;if(_o===N0.AUDIO)(_a=s._audioTrack)===null||_a===void 0||_a._destroy(),s._audioTrack=void 0;else if(_o===N0.VIDEO){var _r;(_r=s._videoTrack)===null||_r===void 0||_r._destroy(),s._videoTrack=void 0}}),!this.connection)return;const j=this.filterTobeUnSubscribedTracks(s,a);if(j.length===0)return;await this.connection.stopReceiving(j.map(_n=>{let[,{id:_o}]=_n;return _o}));const _e=this.createUnsubscribeMessage(j);return this.withdrawRemoteTracks(j),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),j.forEach(_n=>{let[_o,{kind:_a}]=_n;var _r,ba;if(_a===N0.VIDEO&&_o._videoSSRC&&((_r=this.connection)===null||_r===void 0||_r.setStatsRemoteVideoIsReady(_o._videoSSRC,!1)),_a===N0.VIDEO)this.unbindRemoteTrackEvents(_o._videoTrack),h||((ba=_o._videoTrack)===null||ba===void 0||ba._destroy(),_o._videoTrack=void 0);else if(_a===N0.AUDIO){var xa;this.unbindRemoteTrackEvents(_o._audioTrack),!h&&((xa=_o._audioTrack)===null||xa===void 0||xa._destroy(),_o._audioTrack=void 0)}}),_e}async massUnsubscribe(s){return this.massUnsubscribeNoLock(s)}async massUnsubscribeNoLock(s){let a=[];for(const{user:j,mediaType:_e}of s){const _n=this.pendingRemoteTracks.filter(_o=>{let{user:_a,kind:_r}=_o;return _e!==void 0?_a.uid===j.uid&&_e===_r:_a.uid===j.uid});_n.forEach(_o=>{const _a=this.pendingRemoteTracks.indexOf(_o);this.pendingRemoteTracks.splice(_a,1)}),a=a.concat(_n)}if(!this.connection)return void a.forEach(j=>{let{user:_e,kind:_n}=j;var _o;if(_n===N0.AUDIO)(_o=_e._audioTrack)===null||_o===void 0||_o._destroy(),_e._audioTrack=void 0;else if(_n===N0.VIDEO){var _a;(_a=_e._videoTrack)===null||_a===void 0||_a._destroy(),_e._videoTrack=void 0}});const h=Gy(s).call(s,(j,_e)=>{let{user:_n,mediaType:_o}=_e;const _a=this.filterTobeUnSubscribedTracks(_n,_o);return j.concat(_a)},[]);if(h.length===0)return;await this.connection.stopReceiving(h.map(j=>{let[,{id:_e}]=j;return _e}));const g=this.createUnsubscribeAllMessage(h);return this.withdrawRemoteTracks(h),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),h.forEach(j=>{let[_e,{kind:_n}]=j;var _o,_a;if(_n===N0.VIDEO&&_e._videoSSRC&&((_o=this.connection)===null||_o===void 0||_o.setStatsRemoteVideoIsReady(_e._videoSSRC,!1)),_n===N0.VIDEO)this.unbindRemoteTrackEvents(_e._videoTrack),(_a=_e._videoTrack)===null||_a===void 0||_a._destroy(),_e._videoTrack=void 0;else if(_n===N0.AUDIO){var _r;this.unbindRemoteTrackEvents(_e._audioTrack),(_r=_e._audioTrack)===null||_r===void 0||_r._destroy(),_e._audioTrack=void 0}}),g}async muteRemote(s,a){if(!this.connection)return;const h=this.remoteUserMap.get(s);if(!h)return void Ll.warning("P2PChannel.muteRemote has no remote user ".concat(s.uid,"."));if(!h.get(a))return void Ll.warning("P2PChannel.muteRemote has no remote user ".concat(s.uid," media type ").concat(a,"."));const g=a===N0.VIDEO?s._videoSSRC:s._audioSSRC;g!==void 0&&this.connection.setStatsRemoteVideoIsReady(g,!1)}async unmuteRemote(s,a){return this.unmuteRemoteNoLock(s,a)}async unmuteRemoteNoLock(s,a){if(!this.connection)return;const h=this.remoteUserMap.get(s);if(!h)return void Ll.warning("P2PChannel.unmuteRemote has no remote user ".concat(s.uid,"."));h.get(a)||Ll.warning("P2PChannel.unmuteRemote has no remote user ".concat(s.uid," media type ").concat(a,"."))}getAllTracks(s){const a=this.localTrackMap.get(a0.LocalAudioTrack);if((a==null?void 0:a.track)instanceof Yy){const h=a.track;return Array.from(this.localTrackMap.entries()).filter(g=>{let[j]=g;return j!==a0.LocalAudioTrack}).filter(g=>{let[j]=g;return!(s&&j===a0.LocalVideoLowTrack)}).map(g=>{let[,{track:j}]=g;return j}).concat(h.trackList)}return Array.from(this.localTrackMap.entries()).filter(h=>{let[g]=h;return!(s&&g===a0.LocalVideoLowTrack)}).map(h=>{let[,{track:g}]=h;return g})}reportPublishEvent(s,a,h,g,j){if(s){const _n=this.localTrackMap.get(a0.LocalAudioTrack),_o=g?this.localTrackMap.get(a0.LocalVideoLowTrack):this.localTrackMap.get(a0.LocalVideoTrack);d0.publish(this.store.sessionId,{eventElapse:Jy.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:s,ec:a,audioName:_n==null?void 0:_n.track.getTrackLabel(),videoName:_o==null?void 0:_o.track.getTrackLabel(),screenshare:(_o==null?void 0:_o.track._hints.indexOf(c1.SCREEN_TRACK))!==-1,audio:!!_n,video:!!_o,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:j})}else{var _e;h||(h=[]);const _n=h.find(_a=>_a instanceof C1),_o=g?(_e=this.localTrackMap.get(a0.LocalVideoTrack))===null||_e===void 0?void 0:_e.track:h.find(_a=>_a instanceof H_);d0.publish(this.store.sessionId,{eventElapse:Jy.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:s,ec:a,audioName:_n==null?void 0:_n.getTrackLabel(),videoName:_o==null?void 0:_o.getTrackLabel(),screenshare:(_o==null?void 0:_o._hints.indexOf(c1.SCREEN_TRACK))!==-1,audio:!!_n,video:!!_o,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:j})}}reportSubscribeEvent(s,a,h,g){const j=g===N0.VIDEO?h._videoSSRC:h._audioSSRC;j&&d0.subscribe(this.store.sessionId,{succ:s,ec:a,video:g===N0.VIDEO,audio:g===N0.AUDIO,peerid:h.uid,subscribeRequestid:g===N0.VIDEO?h._videoSSRC:h._audioSSRC,p2pid:this.store.p2pId,eventElapse:Jy.measureFromSubscribeStart(this.store.clientId,j)})}reset(){Ll.debug("P2PChannel.reset"),this.mutex=new B1("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.state=w1.Disconnected}getStats(){var s;return(s=this.connection)===null||s===void 0?void 0:s.getStats()}getRemoteVideoIsReady(s){var a;return((a=this.connection)===null||a===void 0?void 0:a.getRemoteVideoIsReady(s))||!1}getLocalAudioVolume(){const s=this.localTrackMap.get(a0.LocalAudioTrack);if(s)return s.track.getVolumeLevel()}getLocalVideoSize(){const s=this.localTrackMap.get(a0.LocalVideoTrack);if(s)return{width:s.track._videoWidth||0,height:s.track._videoHeight||0}}getEncoderConfig(s){const a=this.localTrackMap.get(s);return a&&a.track instanceof H_||a&&a.track instanceof C1?a.track._encoderConfig:void 0}getLocalMedia(s){return this.localTrackMap.get(s)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(s,a){if(!s)return this.remoteUserMap.size>0;const h=this.remoteUserMap.get(s);return!!h&&(!a||h.has(a))}async hasRemoteMediaWithLock(s,a){if(!s)return this.remoteUserMap.size>0;const h=this.remoteUserMap.get(s);return!!h&&(!a||h.has(a))}getRemoteMedia(s){var a;const h=Array.from(nO(a=this.remoteUserMap).call(a)).find(g=>g.uid===s);return h?{audioTrack:h.audioTrack,audioSSRC:h._audioSSRC,videoTrack:h.videoTrack,videoSSRC:h._videoSSRC}:{}}getAudioLevels(){let s=Array.from(this.remoteUserMap.entries()).map(h=>{let[g]=h;return{uid:g.uid,level:g.audioTrack?100*g.audioTrack._source.getAccurateVolumeLevel():0}});const a=this.localTrackMap.get(a0.LocalAudioTrack);return a&&s.push({level:100*a.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),s=B6(s).call(s,(h,g)=>h.level-g.level),s}async disconnectForReconnect(){this.connection&&(Ll.debug("P2PChannel.disconnectForReconnect closing P2PConnection"),this.state=w1.Reconnecting,this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(s=>{let[a,{track:h}]=s;switch(a){case a0.LocalVideoTrack:h._hints.includes(c1.LOW_STREAM)?h.close():this.pendingLocalTracks.push(h);break;case a0.LocalAudioTrack:h instanceof Yy?this.pendingLocalTracks=this.pendingLocalTracks.concat(h.trackList):this.pendingLocalTracks.push(h);break;case a0.LocalVideoLowTrack:}}),this.emit(z0.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(s=>{let[a,h]=s;Array.from(nO(h).call(h)).forEach(g=>{this.setPendingRemoteMedia(a,g)}),this.emit(z0.MediaReconnectStart,a.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),Ll.debug("P2PChannel disconnected, waiting to reconnect."))}hasPendingRemoteMedia(s,a){for(const h of this.pendingRemoteTracks){const{user:g,kind:j}=h;if((s instanceof t9?s.uid:s)===g.uid&&a===j)return!0}return!1}setPendingRemoteMedia(s,a){this.hasPendingRemoteMedia(s,a)||this.pendingRemoteTracks.push({user:s,kind:a})}restartICE(){var s=this;return bS(function*(){if(!s.connection)throw new Error;const a=yield V0(s.mutex.lock("From P2PChannel.restartICE"));try{yield*s3(L9(s.connection.restartICE()),V0)}finally{a()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const s=this.connection.getStats(),a=this.localTrackMap.get(a0.LocalVideoTrack),h=this.localTrackMap.get(a0.LocalAudioTrack),g=s.videoSend.find(yl=>yl.ssrc===(a==null?void 0:a.ssrcs[0].ssrcId)),j=s.audioSend.find(yl=>yl.ssrc===(h==null?void 0:h.ssrcs[0].ssrcId));if(!g||!j)return 1;const _e=tT(this,z0.NeedSignalRTT),_n=g?g.rttMs:void 0,_o=j?j.rttMs:void 0,_a=_n&&_o?(_n+_o)/2:_n||_o,_r=(_a&&_e?(_a+_e)/2:_a||_e)||0,ba=100*s.sendPacketLossRate*.7/50+.3*_r/1500,xa=ba<.17?1:ba<.36?2:ba<.59?3:ba<.1?4:5,El=a==null?void 0:a.track;if(El&&El._encoderConfig&&El._hints.indexOf(c1.SCREEN_TRACK)===-1){const yl=El._encoderConfig.bitrateMax,Ol=s.bitrate.actualEncoded;if(yl&&Ol){const Al=(1e3*yl-Ol)/(1e3*yl);return rnt[Al<.15?0:Al<.3?1:Al<.45?2:Al<.6?3:4][xa]}}return xa}getDownlinkNetworkQuality(){if(!this.connection)return 0;const s=this.connection.getStats();let a=0;return Array.from(this.remoteUserMap.entries()).forEach(h=>{let[g]=h;const j=g._audioSSRC,_e=g._videoSSRC,_n=s.audioRecv.find(Ol=>Ol.ssrc===j),_o=s.videoRecv.find(Ol=>Ol.ssrc===_e);if(!_n&&!_o)return void(a+=1);const _a=tT(this,z0.NeedSignalRTT),_r=s.rtt,ba=(_r&&_a?(_r+_a)/2:_r||_a)||0,xa=_n?_n.jitterMs:void 0,El=s.recvPacketLossRate;let yl=.7*El*100/50+.3*ba/1500;xa&&(yl=.6*El*100/50+.2*ba/1500+.2*xa/400),a+=yl<.1?1:yl<.17?2:yl<.36?3:yl<.59?4:5}),this.remoteUserMap.size>0?Math.round(a/this.remoteUserMap.size):a}async muteLocalTrack(s){return new s0((a,h)=>{this.handleMuteLocalTrack(s,a,h)})}filterTobePublishedTracks(s,a,h){const g=[],j=O1(),_e=this.getAllTracks();s=yz(s=s.filter(_a=>_e.indexOf(_a)===-1));let _n=!1,_o=!1;for(const _a of s){if(_a instanceof H_&&(this.localTrackMap.has(a0.LocalVideoTrack)||_n?new Ql(Hl.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(g.push({track:_a,type:a0.LocalVideoTrack}),_n=!0),a)){const _r=this.getLowVideoTrack(_a,h);g.push({track:_r,type:a0.LocalVideoLowTrack})}if(_a instanceof C1){const _r=this.localTrackMap.get(a0.LocalAudioTrack);if(_r){if(!(_r.track instanceof Yy))throw new Ql(Hl.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_a._bypassWebAudio)throw new Ql(Hl.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");_r.track.addAudioTrack(_a),this.bindLocalAudioTrackEvents(_a,!0)}else if(_o){const ba=g.find(xa=>{let{type:El}=xa;return El===a0.LocalAudioTrack});if(!(ba.track instanceof Yy))throw new Ql(Hl.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_a._bypassWebAudio)throw new Ql(Hl.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");ba.track.addAudioTrack(_a)}else{if(!j.webAudioMediaStreamDest||_a instanceof Yy||_a._bypassWebAudio)g.push({track:_a,type:a0.LocalAudioTrack});else{const ba=new Yy;ba.addAudioTrack(_a),g.push({track:ba,type:a0.LocalAudioTrack})}_o=!0}}}return g}filterTobeUnpublishedTracks(s){const a=[],h=this.getAllTracks();s=yz(s=s.filter(g=>h.indexOf(g)!==-1));for(const g of s){if(g instanceof C1){const j=this.localTrackMap.get(a0.LocalAudioTrack);if(!j)continue;j.track instanceof Yy?(j.track.removeAudioTrack(g),this.unbindLocalAudioTrackEvents(g),j.track.trackList.length===0&&(a.push([a0.LocalAudioTrack,j]),j.track.close())):a.push([a0.LocalAudioTrack,j])}if(g instanceof H_){const j=this.localTrackMap.get(a0.LocalVideoTrack);if(!j)continue;a.push([a0.LocalVideoTrack,j]);const _e=this.localTrackMap.get(a0.LocalVideoLowTrack);_e&&a.push([a0.LocalVideoLowTrack,_e])}}return a}bindLocalTrackEvents(s){s.forEach(a=>{let{track:h,type:g}=a;switch(g){case a0.LocalVideoTrack:h.addListener(w0.GET_STATS,this.handleGetLocalVideoStats),h.addListener(w0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),h.addListener(w0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),h.addListener(w0.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),h.addListener(w0.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),h.addListener(w0.NEED_REPLACE_TRACK,this.handleReplaceTrack),h.addListener(w0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),h.addListener(w0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case a0.LocalAudioTrack:this.bindLocalAudioTrackEvents(h);break;case a0.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(s,a){s instanceof Yy?s.trackList.forEach(h=>{h.addListener(w0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),h.addListener(w0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),h.addListener(w0.GET_STATS,this.handleGetLocalAudioStats),h.addListener(w0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),h.addListener(w0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(s.addListener(w0.GET_STATS,this.handleGetLocalAudioStats),s.addListener(w0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(w0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(w0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(w0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),a||s.addListener(w0.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(s){s||(s=Array.from(this.localTrackMap.entries()).map(a=>{let[h,{track:g}]=a;return{track:g,type:h}})),s.forEach(a=>{let{track:h,type:g}=a;switch(g){case a0.LocalVideoTrack:h.off(w0.GET_STATS,this.handleGetLocalVideoStats),h.off(w0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),h.off(w0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),h.off(w0.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),h.off(w0.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),h.off(w0.NEED_REPLACE_TRACK,this.handleReplaceTrack),h.off(w0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),h.off(w0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case a0.LocalAudioTrack:this.unbindLocalAudioTrackEvents(h);break;case a0.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(s){s instanceof Yy?s.trackList.forEach(a=>{a.off(w0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(w0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(w0.GET_STATS,this.handleGetLocalAudioStats),a.off(w0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(w0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(s.off(w0.GET_STATS,this.handleGetLocalAudioStats),s.off(w0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(w0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(w0.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(w0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(w0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(s,a){a instanceof eU&&a.addListener(w0.GET_STATS,h=>{h(this.handleGetRemoteVideoStats(s))}),a instanceof nU&&a.addListener(w0.GET_STATS,h=>{h(this.handleGetRemoteAudioStats(s))})}unbindRemoteTrackEvents(s){s&&s.removeAllListeners(w0.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(s=>{let[a,h]=s;h.has(N0.AUDIO)&&this.unbindRemoteTrackEvents(a._audioTrack),h.has(N0.VIDEO)&&this.unbindRemoteTrackEvents(a._videoTrack)})}createGatewayPublishMessage(s,a){return s.map((h,g)=>{let j,_e,{track:_n,type:_o}=h;switch(_o){case a0.LocalAudioTrack:j=X_.Audio,_e={dtx:_n instanceof T4&&_n._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case a0.LocalVideoTrack:j=_n._hints.includes(c1.SCREEN_TRACK)?X_.Screen:X_.High,_e=OR(OR({},gz(_n)),{},{codec:this.store.codec});break;case a0.LocalVideoLowTrack:j=X_.Low,_e=OR(OR({},gz(_n)),{},{codec:this.store.codec})}return{stream_type:j,attributes:_e,ssrcs:a[g]}})}createGatewayUnpublishMessage(s){return s.map(a=>{let h,[g,{track:j,ssrcs:_e,id:_n}]=a;switch(g){case a0.LocalVideoTrack:h=j._hints.includes(c1.SCREEN_TRACK)?X_.Screen:X_.High;break;case a0.LocalAudioTrack:h=X_.Audio;break;case a0.LocalVideoLowTrack:h=X_.Low}return{stream_type:h,ssrcs:_e,mid:_n}})}assignLocalTracks(s,a){s.forEach((h,g)=>{let{track:j,type:_e}=h;this.localTrackMap.set(_e,{track:j,id:a[g].id,ssrcs:a[g].localSSRC})})}withdrawLocalTracks(s){s.forEach(a=>{let[h]=a;this.localTrackMap.delete(h)})}bindConnectionEvents(s){s.onConnectionStateChange=async a=>{if(Ll.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(a,")")),this.emit(z0.PeerConnectionStateChange,a),a!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),a==="disconnected"&&s.iceConnectionState==="disconnected")return setTimeout(()=>{s.iceConnectionState==="disconnected"&&wp("ICE_RESTART")&&tT(this,z0.QueryClientConnectionState)==="CONNECTED"&&this.emit(z0.RequestRestartICE)},800),void setTimeout(()=>{s.peerConnectionState==="disconnected"&&(Ll.debug("P2PConnection disconnected timeout 4000ms, force reconnect"),setTimeout(()=>this.emit(z0.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);a==="failed"&&(Ll.debug("P2PConnection state failed, force reconnect"),setTimeout(()=>this.emit(z0.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())},s.onICEConnectionStateChange=a=>{a!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),Ll.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(a,")")),d0.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:a,tag:A_.TRACER}).onSuccess(),this.emit(z0.IceConnectionStateChange,a)},s.onICETransportStateChange=a=>{Ll.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(a,")"))},s.onDTLSTransportStateChange=a=>{Ll.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(a,")"))},s.onDTLSTransportError=a=>{Ll.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(a,")"))},s.onFirstAudioDecoded=a=>{var h;const g=Array.from(nO(h=this.remoteUserMap).call(h)).find(_e=>_e._audioSSRC===a);var j;g&&(this.store.subscribe(g.uid,"audio",void 0,void 0,void 0,Date.now()),(j=g.audioTrack)===null||j===void 0||j.emit(H2.FIRST_FRAME_DECODED),d0.firstRemoteFrame(this.store.sessionId,T1.FIRST_AUDIO_DECODE,k_.FIRST_AUDIO_DECODE,{peer:g._uintid,subscribeElapse:Jy.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId}))},s.onFirstAudioReceived=a=>{var h;const g=Array.from(nO(h=this.remoteUserMap).call(h)).find(j=>j._audioSSRC===a);g&&d0.firstRemoteFrame(this.store.sessionId,T1.FIRST_AUDIO_RECEIVED,k_.FIRST_AUDIO_RECEIVED,{peer:g._uintid,subscribeElapse:Jy.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId})},s.onFirstVideoDecoded=(a,h,g)=>{this.reportVideoFirstFrameDecoded(a,h,g)},s.onFirstVideoReceived=a=>{var h;const g=Array.from(nO(h=this.remoteUserMap).call(h)).find(j=>j._videoSSRC===a);g&&d0.firstRemoteFrame(this.store.sessionId,T1.FIRST_VIDEO_RECEIVED,k_.FIRST_VIDEO_RECEIVED,{peer:g._uintid,subscribeElapse:Jy.measureFromSubscribeStart(this.store.clientId,a),subscribeRequestid:a,p2pid:this.store.p2pId})},s.onSelectedLocalCandidateChanged=(a,h)=>{const g=a.candidateType==="relay",j=h.candidateType==="relay";h.candidateType!=="unknown"&&g===j||this.emit(z0.ConnectionTypeChange,g),Ll.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(I4(h))," -> ").concat(JSON.stringify(I4(a)),")"))},s.onSelectedRemoteCandidateChanged=(a,h)=>{Ll.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(I4(h))," -> ").concat(JSON.stringify(I4(a)),")"))},s.onFirstVideoDecodedTimeout=a=>{this.reportVideoFirstFrameDecoded(a,void 0,void 0,!0)}}unbindConnectionEvents(s){s.onConnectionStateChange=void 0,s.onICEConnectionStateChange=void 0,s.onICETransportStateChange=void 0,s.onDTLSTransportStateChange=void 0,s.onDTLSTransportError=void 0,s.onFirstAudioDecoded=void 0,s.onFirstAudioReceived=void 0,s.onFirstVideoDecoded=void 0,s.onFirstVideoReceived=void 0,s.onSelectedLocalCandidateChanged=void 0,s.onSelectedRemoteCandidateChanged=void 0,s.onFirstVideoDecodedTimeout=void 0}filterTobeMutedTracks(s){const a=[];if(this.getAllTracks().indexOf(s)===-1)return a;const h=this.localTrackMap.get(a0.LocalAudioTrack);if(s instanceof C1&&(h==null?void 0:h.track)instanceof Yy)return h.track.isActive||a.push([a0.LocalAudioTrack,h]),a;const g=Array.from(this.localTrackMap.entries()).find(j=>{let[,{track:_e}]=j;return s===_e});if(g&&(a.push(g),g[0]===a0.LocalVideoTrack)){const j=this.localTrackMap.get(a0.LocalVideoLowTrack);j&&a.push([a0.LocalVideoLowTrack,j])}return a}filterTobeUnmutedTracks(s){const a=[],h=this.localTrackMap.get(a0.LocalAudioTrack);if(s instanceof C1&&(h==null?void 0:h.track)instanceof Yy)return h.track.isActive&&a.push([a0.LocalAudioTrack,h]),a;const g=Array.from(this.localTrackMap.entries()).find(j=>{let[,{track:_e}]=j;return s===_e});if(g)if(g[0]===a0.LocalVideoTrack){a.push(g);const j=this.localTrackMap.get(a0.LocalVideoLowTrack);j&&a.push([a0.LocalVideoLowTrack,j])}else a.push(g);return a}createMuteMessage(s){return s.map(a=>{let h,[g,{track:j,ssrcs:_e,id:_n}]=a;switch(g){case a0.LocalAudioTrack:h=X_.Audio;break;case a0.LocalVideoTrack:h=j._hints.includes(c1.SCREEN_TRACK)?X_.Screen:X_.High;break;case a0.LocalVideoLowTrack:h=X_.Low}return{stream_type:h,ssrcs:_e,mid:_n}})}createUnmuteMessage(s){return s.map(a=>{let h,[g,{track:j,ssrcs:_e,id:_n}]=a;switch(g){case a0.LocalAudioTrack:h=X_.Audio;break;case a0.LocalVideoTrack:h=j._hints.includes(c1.SCREEN_TRACK)?X_.Screen:X_.High;break;case a0.LocalVideoLowTrack:h=X_.Low}return{stream_type:h,ssrcs:_e,mid:_n}})}filterTobeUnSubscribedTracks(s,a){const h=[],g=this.remoteUserMap.get(s);if(!g)return h;if(a){const j=g.get(a);if(!j)return h;h.push([s,{kind:a,id:j}])}else Array.from(g.entries()).forEach(j=>{let[_e,_n]=j;h.push([s,{kind:_e,id:_n}])});return h}createUnsubscribeMessage(s){const a=[];return s.forEach(h=>{let[g,{kind:j,id:_e}]=h;switch(j){case N0.VIDEO:return void(g._videoSSRC&&a.push({stream_type:N0.VIDEO,ssrcId:g._videoSSRC}));case N0.AUDIO:return void(g._audioSSRC&&a.push({stream_type:N0.AUDIO,ssrcId:g._audioSSRC}))}}),a}createUnsubscribeAllMessage(s){const a=new Map;return s.forEach(h=>{let[g,{kind:j}]=h;if(a.has(g)){let _e=a.get(g);j===N0.VIDEO?_e|=G_.Video:_e|=G_.Audio,a.set(g,_e)}else j===N0.VIDEO?a.set(g,G_.Video):a.set(g,G_.Audio)}),{users:Array.from(a.entries()).map(h=>{let[g,j]=h;return{stream_id:g.uid,stream_type:j}})}}withdrawRemoteTracks(s){s.forEach(a=>{let[h,{kind:g}]=a;const j=this.remoteUserMap.get(h);j&&(j.delete(g),Array.from(j.entries()).length===0&&this.remoteUserMap.delete(h))})}async updateBitrateLimit(s){const a=this.localTrackMap.get(a0.LocalVideoTrack),h=this.localTrackMap.get(a0.LocalVideoLowTrack);a&&await a.track.setBitrateLimit(s.uplink),h&&s.low_stream_uplink&&await h.track.setBitrateLimit({max_bitrate:s.low_stream_uplink.bitrate,min_bitrate:s.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(s,a){return s.map((h,g)=>{var j;let{stream_type:_e}=h;return(j=a.find(_n=>{let{stream_type:_o}=_n;return _e===_o}))===null||j===void 0?void 0:j.attributes})}async tryToUnmuteAudio(s){for(let h=0;h<s.length;h++)if(s[h]instanceof C1){var a;const g=this.filterTobeUnmutedTracks(s[h]);if(g.length===0)continue;await((a=this.connection)===null||a===void 0?void 0:a.unmuteLocal(g.map(_e=>{let[,{id:_n}]=_e;return _n})));const j=this.createUnmuteMessage(g);return void await D_(this,z0.RequestUnmuteLocal,j)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=s=>{var a;return!((a=this.connection)===null||a===void 0||!a.getRemoteVideoIsReady(s))},this.statsUploader.requestUpload=(s,a)=>this.emit(z0.RequestUploadStats,s,a),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await g1(N6(this.dtlsFailedCount,t1)),this.emit(z0.RequestReconnect)}async reconnectP2P(){const s=Array.from(this.localTrackMap.entries()),a=this.createGatewayUnpublishMessage(s);Array.from(this.remoteUserMap.entries()),a.length>0&&await A1(this,z0.RequestUnpublishForReconnectPC,a),this.disconnectForReconnect(),this.emit(z0.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(a0.LocalVideoTrack)||this.pendingLocalTracks.some(s=>s instanceof H_)}throwIfTrackTypeNotMatch(s){if(s.filter(a=>a instanceof H_).length>1)throw new Ql(Hl.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(s.filter(a=>a instanceof C1).length>1&&(s.some(a=>a instanceof C1&&a._bypassWebAudio)||!O1().webAudioMediaStreamDest))throw new Ql(Hl.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const a of s){if(a instanceof H_&&this.pendingLocalTracks.some(h=>h instanceof H_))throw new Ql(Hl.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(a instanceof C1&&this.pendingLocalTracks.some(h=>h instanceof C1)&&(!O1().webAudioMediaStreamDest||a._bypassWebAudio||this.pendingLocalTracks.some(h=>h instanceof C1&&h._bypassWebAudio)))throw new Ql(Hl.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(s,a){const h=O1().supportDualStreamEncoding,g=OR(OR({},{width:160,height:120,framerate:15,bitrate:50}),a);let j;j=h?s._mediaStreamTrack.clone():zQ(s,g);const _e=N_(8,"track-low-"),_n=new H_(j,OR(OR({},h&&{scaleResolutionDownBy:oit(g,s)}),{},{frameRate:g.framerate,bitrateMax:g.bitrate,bitrateMin:g.bitrate}),void 0,void 0,_e);return _n._hints.push(c1.LOW_STREAM),s.addListener(w0.NEED_CLOSE,()=>{_n.close()}),_n}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}reportVideoFirstFrameDecoded(s,a,h,g){var j;const _e=Array.from(nO(j=this.remoteUserMap).call(j)).find(_n=>_n._videoSSRC===s);if(_e){g||this.store.subscribe(_e.uid,"video",void 0,void 0,void 0,void 0,Date.now());const _n=this.store.keyMetrics,_o=_n.subscribe.find(_a=>_a.userId===_e.uid&&_a.type==="video");d0.firstRemoteVideoDecode(this.store.sessionId,T1.FIRST_VIDEO_DECODE,k_.FIRST_VIDEO_DECODE,{peer:_e._uintid,videowidth:a,videoheight:h,subscribeElapse:Jy.measureFromSubscribeStart(this.store.clientId,s),subscribeRequestid:s,p2pid:this.store.p2pId,apEnd:_n.requestAPEnd||0,apStart:_n.requestAPStart||0,joinGwEnd:_n.joinGatewayEnd||0,joinGwStart:_n.joinGatewayStart||0,pcEnd:_n.peerConnectionEnd||0,pcStart:_n.peerConnectionStart||0,subscriberEnd:(_o==null?void 0:_o.subscribeEnd)||0,subscriberStart:(_o==null?void 0:_o.subscribeStart)||0,videoAddNotify:(_o==null?void 0:_o.streamAdded)||0,state:g?1:0})}}async remoteMediaSsrcChanged(s,a,h){if(!this.connection)return!1;const g=this.remoteUserMap.get(s);if(!g)return!1;const j=g.get(a);if(!j)return!1;const _e=await this.connection.getRemoteSSRC(j);return _e!==void 0&&_e!==h}}).prototype,"startP2PConnection",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"startP2PConnection"),J0.prototype),Wp(J0.prototype,"connect",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"connect"),J0.prototype),Wp(J0.prototype,"preConnect",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"preConnect"),J0.prototype),Wp(J0.prototype,"unpublish",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"unpublish"),J0.prototype),Wp(J0.prototype,"unpublishLowStream",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"unpublishLowStream"),J0.prototype),Wp(J0.prototype,"subscribe",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"subscribe"),J0.prototype),Wp(J0.prototype,"massSubscribe",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"massSubscribe"),J0.prototype),Wp(J0.prototype,"unsubscribe",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"unsubscribe"),J0.prototype),Wp(J0.prototype,"massUnsubscribe",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"massUnsubscribe"),J0.prototype),Wp(J0.prototype,"muteRemote",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"muteRemote"),J0.prototype),Wp(J0.prototype,"unmuteRemote",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"unmuteRemote"),J0.prototype),Wp(J0.prototype,"hasRemoteMediaWithLock",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"hasRemoteMediaWithLock"),J0.prototype),Wp(J0.prototype,"disconnectForReconnect",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"disconnectForReconnect"),J0.prototype),Wp(J0.prototype,"updateBitrateLimit",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"updateBitrateLimit"),J0.prototype),Wp(J0.prototype,"remoteMediaSsrcChanged",[_y],Object.getOwnPropertyDescriptor(J0.prototype,"remoteMediaSsrcChanged"),J0.prototype),J0);function _y(s,a,h){const g=s[a];if(typeof g!="function")throw new Error("Cannot use mutex on object property.");return h.value=async function(){const j=this.mutex,_e=await j.lock("From P2PChannel.".concat(a));try{for(var _n=arguments.length,_o=new Array(_n),_a=0;_a<_n;_a++)_o[_a]=arguments[_a];return await g.apply(this,_o)}finally{_e()}},h}function wS(s){return"Minified Redux error #"+s+"; visit https://redux.js.org/Errors?code="+s+" for the full message or use the non-minified dev environment for full errors. "}var W0,h$=typeof Symbol=="function"&&Symbol.observable||"@@observable",D9=function(){return Math.random().toString(36).substring(7).split("").join(".")},p$={INIT:"@@redux/INIT"+D9(),REPLACE:"@@redux/REPLACE"+D9(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+D9()}};function _at(s){if(typeof s!="object"||s===null)return!1;for(var a=s;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(s)===a}function f$(s,a,h){var g;if(typeof a=="function"&&typeof h=="function"||typeof h=="function"&&typeof arguments[3]=="function")throw new Error(wS(0));if(typeof a=="function"&&h===void 0&&(h=a,a=void 0),h!==void 0){if(typeof h!="function")throw new Error(wS(1));return h(f$)(s,a)}if(typeof s!="function")throw new Error(wS(2));var j=s,_e=a,_n=[],_o=_n,_a=!1;function _r(){_o===_n&&(_o=_n.slice())}function ba(){if(_a)throw new Error(wS(3));return _e}function xa(Al){if(typeof Al!="function")throw new Error(wS(4));if(_a)throw new Error(wS(5));var Nl=!0;return _r(),_o.push(Al),function(){if(Nl){if(_a)throw new Error(wS(6));Nl=!1,_r();var Ml=_o.indexOf(Al);_o.splice(Ml,1),_n=null}}}function El(Al){if(!_at(Al))throw new Error(wS(7));if(Al.type===void 0)throw new Error(wS(8));if(_a)throw new Error(wS(9));try{_a=!0,_e=j(_e,Al)}finally{_a=!1}for(var Nl=_n=_o,Ml=0;Ml<Nl.length;Ml++)(0,Nl[Ml])();return Al}function yl(Al){if(typeof Al!="function")throw new Error(wS(10));j=Al,El({type:p$.REPLACE})}function Ol(){var Al,Nl=xa;return(Al={subscribe:function(Ml){if(typeof Ml!="object"||Ml===null)throw new Error(wS(11));function Fl(){Ml.next&&Ml.next(ba())}return Fl(),{unsubscribe:Nl(Fl)}}})[h$]=function(){return this},Al}return El({type:p$.INIT}),(g={dispatch:El,subscribe:xa,getState:ba,replaceReducer:yl})[h$]=Ol,g}function g$(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function p0(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?g$(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):g$(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}(function(s){s.SET_SESSION_ID="SET_SESSION_ID",s.SET_P2P_ID="SET_P2P_id",s.SET_DC_ID="SET_DC_id",s.SET_UID="SET_UID",s.SET_PUB_ID="SET_PUB_ID",s.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",s.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",s.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",s.AVOID_JOIN_START="AVOID_JOIN_START",s.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",s.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",s.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",s.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",s.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",s.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",s.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",s.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",s.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",s.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",s.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",s.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",s.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",s.RESET_KEY_METRICS="RESET_KEY_METRICS"})(W0||(W0={}));class yat{constructor(a,h,g,j){Rl(this,"store",void 0),Rl(this,"reducer",void 0);const _e={codec:a,audioCodec:h,mode:g,clientId:j,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled"};this.reducer=function(){let _n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_e,_o=arguments.length>1?arguments[1]:void 0;switch(_o.type){case W0.SET_SESSION_ID:return p0(p0({},_n),{},{sessionId:_o.sessionId});case W0.SET_P2P_ID:return p0(p0({},_n),{},{p2pId:_o.p2pId});case W0.SET_UID:return p0(p0({},_n),{},{uid:_o.uid});case W0.SET_PUB_ID:return p0(p0({},_n),{},{pubId:_o.pubId});case W0.KEY_METRIC_CLIENT_CREATED:return p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{clientCreated:_o.metric})});case W0.KEY_METRIC_JOIN_START:return p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{joinStart:_o.metric})});case W0.AVOID_JOIN_START:return p0(p0({},_n),{},{avoidJoinStart:_o.avoidJoinStart});case W0.KEY_METRIC_JOIN_END:return p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{joinEnd:_o.metric})});case W0.KEY_METRIC_REQUEST_AP_START:return p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{requestAPStart:_o.metric})});case W0.KEY_METRIC_REQUEST_AP_END:return p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{requestAPEnd:_o.metric})});case W0.KEY_METRIC_JOIN_GATEWAY_START:return p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{joinGatewayStart:_o.metric})});case W0.KEY_METRIC_JOIN_GATEWAY_END:return p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{joinGatewayEnd:_o.metric})});case W0.KEY_METRIC_PEER_CONNECTION_START:return p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{peerConnectionStart:_o.metric})});case W0.KEY_METRIC_PEER_CONNECTION_END:return p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{peerConnectionEnd:_o.metric})});case W0.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{signalChannelOpen:_o.metric})});case W0.KEY_METRIC_ICE_CONNECTION_END:return p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{iceConnectionEnd:_o.metric})});case W0.KEY_METRIC_PUBLISH:{const _a=_n.keyMetrics.publish,_r=_a.findIndex(ba=>ba.trackId===_o.metric.trackId);return _r!==-1?(_a[_r]=p0(p0({},_a[_r]),_o.metric),p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{publish:[..._a]})})):p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{publish:[..._n.keyMetrics.publish,_o.metric]})})}case W0.KEY_METRIC_SUBSCRIBE:{const _a=_n.keyMetrics.subscribe,_r=_a.findIndex(ba=>ba.userId===_o.metric.userId&&ba.type===_o.metric.type);return _r!==-1?(_a[_r]=p0(p0({},_a[_r]),_o.metric),p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{subscribe:[..._a]})})):p0(p0({},_n),{},{keyMetrics:p0(p0({},_n.keyMetrics),{},{subscribe:[..._n.keyMetrics.subscribe,_o.metric]})})}case W0.SET_CLOUD_PROXY_SERVER_MODE:return _n.cloudProxyServerMode=_o.mode,_n;case W0.RECORD_JOIN_CHANNEL_SERVICE:return typeof _o.index!="number"?_n.joinChannelServiceRecords=[..._n.joinChannelServiceRecords,_o.record]:(_n.joinChannelServiceRecords[_o.index]=p0(p0({},_n.joinChannelServiceRecords[_o.index]),_o.record),_n.joinChannelServiceRecords=[..._n.joinChannelServiceRecords]),_n;case W0.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return _n.joinChannelServiceRecords=[],_n;case W0.RESET_KEY_METRICS:return _n.keyMetrics={publish:[],subscribe:[]},_n;default:return _n}},this.store=f$(this.reducer)}set sessionId(a){this.store.dispatch({type:W0.SET_SESSION_ID,sessionId:a})}get sessionId(){return this.store.getState().sessionId}get codec(){return this.store.getState().codec}get audioCodec(){return this.store.getState().audioCodec}get clientId(){return this.store.getState().clientId}set p2pId(a){this.store.dispatch({type:W0.SET_P2P_ID,p2pId:a})}get p2pId(){return this.store.getState().p2pId}set dcId(a){this.store.dispatch({type:W0.SET_DC_ID,dcId:a})}get dcId(){return this.store.getState().dcId}set uid(a){this.store.dispatch({type:W0.SET_UID,uid:a})}get uid(){return this.store.getState().uid}set pubId(a){this.store.dispatch({type:W0.SET_PUB_ID,pubId:a})}get pubId(){return this.store.getState().pubId}set cloudProxyServerMode(a){this.store.dispatch({type:W0.SET_CLOUD_PROXY_SERVER_MODE,mode:a})}get cloudProxyServerMode(){return this.store.getState().cloudProxyServerMode}clientCreated(){this.store.dispatch({type:W0.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.store.dispatch({type:W0.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.store.dispatch({type:W0.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.store.dispatch({type:W0.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.store.dispatch({type:W0.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.store.dispatch({type:W0.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.store.dispatch({type:W0.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.store.dispatch({type:W0.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.store.dispatch({type:W0.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}signalChannelOpen(){this.store.dispatch({type:W0.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.store.dispatch({type:W0.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(a,h,g,j){this.store.dispatch({type:W0.KEY_METRIC_PUBLISH,metric:p0(p0({trackId:a,type:h},g&&{publishStart:g}),j&&{publishEnd:j})})}subscribe(a,h,g,j,_e,_n,_o){this.store.dispatch({type:W0.KEY_METRIC_SUBSCRIBE,metric:p0(p0(p0(p0(p0({userId:a,type:h},g&&{subscribeStart:g}),j&&{subscribeEnd:j}),_e&&{firstFrame:_e}),_n&&{streamAdded:_n}),_o&&{firstDecoded:_o})})}massSubscribe(a,h,g,j){a.forEach(_e=>{this.store.dispatch({type:W0.KEY_METRIC_SUBSCRIBE,metric:p0(p0(p0({userId:_e.userId,type:_e.type},h&&{subscribeStart:h}),g&&{subscribeEnd:g}),j&&{firstFrame:j})})})}get keyMetrics(){return this.store.getState().keyMetrics}recordJoinChannelService(a,h){a.service==="gateway"&&Array.isArray(a.urls)&&(a.urls=a.urls.map(g=>g.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof h!="number"?(this.store.dispatch({type:W0.RECORD_JOIN_CHANNEL_SERVICE,record:p0(p0({},a),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.store.getState().joinChannelServiceRecords.length-1):(h<0||h>=this.store.getState().joinChannelServiceRecords.length||this.store.dispatch({type:W0.RECORD_JOIN_CHANNEL_SERVICE,record:a,index:h}),h)}catch{return 0}}resetJoinChannelServiceRecords(){this.store.dispatch({type:W0.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.store.dispatch({type:W0.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.store.getState().joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.store.getState().avoidJoinStart}set avoidJoinStart(a){this.store.dispatch({type:W0.AVOID_JOIN_START,avoidJoinStart:a})}}let oU;const bat=()=>(oU||oU||(oU=(window.location.protocol.split(":")[0]||"").toUpperCase(),oU))==="HTTPS",m$=()=>window.isSecureContext!==void 0;function Sat(s){let a=_$();return function(h,g){let j=h.appId;j!==void 0&&(t_(g,10),iT(g,j));let _e=h.cid;_e!==void 0&&(t_(g,16),t_(g,_e));let _n=h.cname;_n!==void 0&&(t_(g,26),iT(g,_n));let _o=h.deviceId;_o!==void 0&&(t_(g,34),iT(g,_o));let _a=h.elapse;_a!==void 0&&(t_(g,40),CR(g,_a));let _r=h.fileSize;_r!==void 0&&(t_(g,48),CR(g,uN(_r)));let ba=h.height;ba!==void 0&&(t_(g,56),CR(g,uN(ba)));let xa=h.jpg;xa!==void 0&&(t_(g,66),t_(g,xa.length),function(Lp,Ep){let Ip=lN(Lp,Ep.length);Lp.bytes.set(Ep,Ip)}(g,xa));let El=h.networkType;El!==void 0&&(t_(g,72),CR(g,uN(El)));let yl=h.osType;yl!==void 0&&(t_(g,80),CR(g,uN(yl)));let Ol=h.requestId;Ol!==void 0&&(t_(g,90),iT(g,Ol));let Al=h.sdkVersion;Al!==void 0&&(t_(g,98),iT(g,Al));let Nl=h.sequence;Nl!==void 0&&(t_(g,104),CR(g,uN(Nl)));let Ml=h.sid;Ml!==void 0&&(t_(g,114),iT(g,Ml));let Fl=h.timestamp;Fl!==void 0&&(t_(g,120),CR(g,Fl));let up=h.uid;up!==void 0&&(t_(g,128),t_(g,up));let _p=h.vid;_p!==void 0&&(t_(g,136),t_(g,_p));let Tp=h.width;Tp!==void 0&&(t_(g,144),CR(g,uN(Tp)));let Fp=h.service;Fp!==void 0&&(t_(g,152),t_(g,Fp));let Ap=h.callbackData;Ap!==void 0&&(t_(g,162),iT(g,Ap));let Xp=h.jpgEncryption;Xp!==void 0&&(t_(g,168),t_(g,Xp));let _g=h.requestType;_g!==void 0&&(t_(g,176),t_(g,_g));let Yp=h.scorePorn;Yp!==void 0&&(t_(g,185),F9(g,Yp));let h0=h.scoreSexy;h0!==void 0&&(t_(g,193),F9(g,h0));let E0=h.scoreNeutral;E0!==void 0&&(t_(g,201),F9(g,E0));let A0=h.scene;A0!==void 0&&(t_(g,208),t_(g,A0));let _E=h.ossFilePrefix;_E!==void 0&&(t_(g,218),iT(g,_E));let Rp=h.serviceVendor;if(Rp!==void 0)for(let Lp of Rp){t_(g,226);let Ep=_$();wat(Lp,Ep),t_(g,Ep.limit),Aat(g,Ep),Cat(Ep)}}(s,a),function(h){let g=h.bytes,j=h.limit;return g.length===j?g:g.subarray(0,j)}(a)}function Tat(s){return function(h){let g={};t:for(;!y$(h);){let j=oT(h);switch(j>>>3){case 0:break t;case 1:g.code=oT(h);break;case 2:g.msg=b$(h,oT(h));break;case 3:{let _e=Iat(h);g.data=Rat(h),h.limit=_e;break}default:v$(h,7&j)}}return g}({bytes:a=s,offset:0,limit:a.length});var a}function Rat(s){let a={};t:for(;!y$(s);){let h=oT(s);switch(h>>>3){case 0:break t;case 1:a.requestId=b$(s,oT(s));break;case 2:a.requestType=oT(s)>>>0;break;case 3:a.scorePorn=j9(s);break;case 4:a.scoreSexy=j9(s);break;case 5:a.scoreNeutral=j9(s);break;case 6:a.requestScene=oT(s)>>>0;break;case 7:a.scene=oT(s)>>>0;break;default:v$(s,7&h)}}return a}function wat(s,a){let h=s.service;h!==void 0&&(t_(a,8),t_(a,h));let g=s.vendor;g!==void 0&&(t_(a,16),t_(a,g));let j=s.token;j!==void 0&&(t_(a,26),iT(a,j));let _e=s.callbackUrl;_e!==void 0&&(t_(a,34),iT(a,_e))}function Iat(s){let a=oT(s),h=s.limit;return s.limit=s.offset+a,h}function v$(s,a){switch(a){case 0:for(;128&S$(s););break;case 2:M9(s,oT(s));break;case 5:M9(s,4);break;case 1:M9(s,8);break;default:throw new Error("Unimplemented type: "+a)}}let Oat=new Float32Array(1);new Uint8Array(Oat.buffer);let x9=new Float64Array(1),ly=new Uint8Array(x9.buffer);function uN(s){return{low:s|=0,high:s>>31,unsigned:s>=0}}let E$=[];function _$(){const s=E$.pop();return s?(s.offset=s.limit=0,s):{bytes:new Uint8Array(64),offset:0,limit:0}}function Cat(s){E$.push(s)}function M9(s,a){if(s.offset+a>s.limit)throw new Error("Skip past limit");s.offset+=a}function y$(s){return s.offset>=s.limit}function lN(s,a){let h=s.bytes,g=s.offset,j=s.limit,_e=g+a;if(_e>h.length){let _n=new Uint8Array(2*_e);_n.set(h),s.bytes=_n}return s.offset=_e,_e>j&&(s.limit=_e),g}function U9(s,a){let h=s.offset;if(h+a>s.limit)throw new Error("Read past limit");return s.offset+=a,h}function b$(s,a){let h=U9(s,a),g=String.fromCharCode,j=s.bytes,_e="",_n="";for(let _o=0;_o<a;_o++){let _a,_r,ba,xa,El=j[_o+h];128&El?(224&El)==192?_o+1>=a?_n+=_e:(_a=j[_o+h+1],(192&_a)!=128?_n+=_e:(xa=(31&El)<<6|63&_a,xa<128?_n+=_e:(_n+=g(xa),_o++))):(240&El)==224?_o+2>=a?_n+=_e:(_a=j[_o+h+1],_r=j[_o+h+2],(49344&(_a|_r<<8))!=32896?_n+=_e:(xa=(15&El)<<12|(63&_a)<<6|63&_r,xa<2048||xa>=55296&&xa<=57343?_n+=_e:(_n+=g(xa),_o+=2))):(248&El)==240?_o+3>=a?_n+=_e:(_a=j[_o+h+1],_r=j[_o+h+2],ba=j[_o+h+3],(12632256&(_a|_r<<8|ba<<16))!=8421504?_n+=_e:(xa=(7&El)<<18|(63&_a)<<12|(63&_r)<<6|63&ba,xa<65536||xa>1114111?_n+=_e:(xa-=65536,_n+=g(55296+(xa>>10),56320+(1023&xa)),_o+=3))):_n+=_e:_n+=g(El)}return _n}function iT(s,a){let h=a.length,g=0;for(let _n=0;_n<h;_n++){let _o=a.charCodeAt(_n);_o>=55296&&_o<=56319&&_n+1<h&&(_o=(_o<<10)+a.charCodeAt(++_n)-56613888),g+=_o<128?1:_o<2048?2:_o<65536?3:4}t_(s,g);let j=lN(s,g),_e=s.bytes;for(let _n=0;_n<h;_n++){let _o=a.charCodeAt(_n);_o>=55296&&_o<=56319&&_n+1<h&&(_o=(_o<<10)+a.charCodeAt(++_n)-56613888),_o<128?_e[j++]=_o:(_o<2048?_e[j++]=_o>>6&31|192:(_o<65536?_e[j++]=_o>>12&15|224:(_e[j++]=_o>>18&7|240,_e[j++]=_o>>12&63|128),_e[j++]=_o>>6&63|128),_e[j++]=63&_o|128)}}function Aat(s,a){let h=lN(s,a.limit),g=s.bytes,j=a.bytes;for(let _e=0,_n=a.limit;_e<_n;_e++)g[_e+h]=j[_e]}function S$(s){return s.bytes[U9(s,1)]}function T$(s,a){let h=lN(s,1);s.bytes[h]=a}function j9(s){let a=U9(s,8),h=s.bytes;return ly[0]=h[a++],ly[1]=h[a++],ly[2]=h[a++],ly[3]=h[a++],ly[4]=h[a++],ly[5]=h[a++],ly[6]=h[a++],ly[7]=h[a++],x9[0]}function F9(s,a){let h=lN(s,8),g=s.bytes;x9[0]=a,g[h++]=ly[0],g[h++]=ly[1],g[h++]=ly[2],g[h++]=ly[3],g[h++]=ly[4],g[h++]=ly[5],g[h++]=ly[6],g[h++]=ly[7]}function oT(s){let a,h=0,g=0;do a=S$(s),h<32&&(g|=(127&a)<<h),h+=7;while(128&a);return g}function t_(s,a){for(a>>>=0;a>=128;)T$(s,127&a|128),a>>>=7;T$(s,a)}function CR(s,a){let h=a.low>>>0,g=(a.low>>>28|a.high<<4)>>>0,j=a.high>>>24,_e=j===0?g===0?h<16384?h<128?1:2:h<1<<21?3:4:g<16384?g<128?5:6:g<1<<21?7:8:j<128?9:10,_n=lN(s,_e),_o=s.bytes;switch(_e){case 10:_o[_n+9]=j>>>7&1;case 9:_o[_n+8]=_e!==9?128|j:127&j;case 8:_o[_n+7]=_e!==8?g>>>21|128:g>>>21&127;case 7:_o[_n+6]=_e!==7?g>>>14|128:g>>>14&127;case 6:_o[_n+5]=_e!==6?g>>>7|128:g>>>7&127;case 5:_o[_n+4]=_e!==5?128|g:127&g;case 4:_o[_n+3]=_e!==4?h>>>21|128:h>>>21&127;case 3:_o[_n+2]=_e!==3?h>>>14|128:h>>>14&127;case 2:_o[_n+1]=_e!==2?h>>>7|128:h>>>7&127;case 1:_o[_n]=_e!==1?128|h:127&h}}var R$={};Object.defineProperty(R$,"__esModule",{value:!0});var w$=function(){function s(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}return s.hashStr=function(a,h){return h===void 0&&(h=!1),this.onePassHasher.start().appendStr(a).end(h)},s.hashAsciiStr=function(a,h){return h===void 0&&(h=!1),this.onePassHasher.start().appendAsciiStr(a).end(h)},s._hex=function(a){var h,g,j,_e,_n=s.hexChars,_o=s.hexOut;for(_e=0;_e<4;_e+=1)for(g=8*_e,h=a[_e],j=0;j<8;j+=2)_o[g+1+j]=_n.charAt(15&h),h>>>=4,_o[g+0+j]=_n.charAt(15&h),h>>>=4;return _o.join("")},s._md5cycle=function(a,h){var g=a[0],j=a[1],_e=a[2],_n=a[3];j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j&_e|~j&_n)+h[0]-680876936|0)<<7|g>>>25)+j|0)&j|~g&_e)+h[1]-389564586|0)<<12|_n>>>20)+g|0)&g|~_n&j)+h[2]+606105819|0)<<17|_e>>>15)+_n|0)&_n|~_e&g)+h[3]-1044525330|0)<<22|j>>>10)+_e|0,j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j&_e|~j&_n)+h[4]-176418897|0)<<7|g>>>25)+j|0)&j|~g&_e)+h[5]+1200080426|0)<<12|_n>>>20)+g|0)&g|~_n&j)+h[6]-1473231341|0)<<17|_e>>>15)+_n|0)&_n|~_e&g)+h[7]-45705983|0)<<22|j>>>10)+_e|0,j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j&_e|~j&_n)+h[8]+1770035416|0)<<7|g>>>25)+j|0)&j|~g&_e)+h[9]-1958414417|0)<<12|_n>>>20)+g|0)&g|~_n&j)+h[10]-42063|0)<<17|_e>>>15)+_n|0)&_n|~_e&g)+h[11]-1990404162|0)<<22|j>>>10)+_e|0,j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j&_e|~j&_n)+h[12]+1804603682|0)<<7|g>>>25)+j|0)&j|~g&_e)+h[13]-40341101|0)<<12|_n>>>20)+g|0)&g|~_n&j)+h[14]-1502002290|0)<<17|_e>>>15)+_n|0)&_n|~_e&g)+h[15]+1236535329|0)<<22|j>>>10)+_e|0,j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j&_n|_e&~_n)+h[1]-165796510|0)<<5|g>>>27)+j|0)&_e|j&~_e)+h[6]-1069501632|0)<<9|_n>>>23)+g|0)&j|g&~j)+h[11]+643717713|0)<<14|_e>>>18)+_n|0)&g|_n&~g)+h[0]-373897302|0)<<20|j>>>12)+_e|0,j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j&_n|_e&~_n)+h[5]-701558691|0)<<5|g>>>27)+j|0)&_e|j&~_e)+h[10]+38016083|0)<<9|_n>>>23)+g|0)&j|g&~j)+h[15]-660478335|0)<<14|_e>>>18)+_n|0)&g|_n&~g)+h[4]-405537848|0)<<20|j>>>12)+_e|0,j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j&_n|_e&~_n)+h[9]+568446438|0)<<5|g>>>27)+j|0)&_e|j&~_e)+h[14]-1019803690|0)<<9|_n>>>23)+g|0)&j|g&~j)+h[3]-187363961|0)<<14|_e>>>18)+_n|0)&g|_n&~g)+h[8]+1163531501|0)<<20|j>>>12)+_e|0,j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j&_n|_e&~_n)+h[13]-1444681467|0)<<5|g>>>27)+j|0)&_e|j&~_e)+h[2]-51403784|0)<<9|_n>>>23)+g|0)&j|g&~j)+h[7]+1735328473|0)<<14|_e>>>18)+_n|0)&g|_n&~g)+h[12]-1926607734|0)<<20|j>>>12)+_e|0,j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j^_e^_n)+h[5]-378558|0)<<4|g>>>28)+j|0)^j^_e)+h[8]-2022574463|0)<<11|_n>>>21)+g|0)^g^j)+h[11]+1839030562|0)<<16|_e>>>16)+_n|0)^_n^g)+h[14]-35309556|0)<<23|j>>>9)+_e|0,j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j^_e^_n)+h[1]-1530992060|0)<<4|g>>>28)+j|0)^j^_e)+h[4]+1272893353|0)<<11|_n>>>21)+g|0)^g^j)+h[7]-155497632|0)<<16|_e>>>16)+_n|0)^_n^g)+h[10]-1094730640|0)<<23|j>>>9)+_e|0,j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j^_e^_n)+h[13]+681279174|0)<<4|g>>>28)+j|0)^j^_e)+h[0]-358537222|0)<<11|_n>>>21)+g|0)^g^j)+h[3]-722521979|0)<<16|_e>>>16)+_n|0)^_n^g)+h[6]+76029189|0)<<23|j>>>9)+_e|0,j=((j+=((_e=((_e+=((_n=((_n+=((g=((g+=(j^_e^_n)+h[9]-640364487|0)<<4|g>>>28)+j|0)^j^_e)+h[12]-421815835|0)<<11|_n>>>21)+g|0)^g^j)+h[15]+530742520|0)<<16|_e>>>16)+_n|0)^_n^g)+h[2]-995338651|0)<<23|j>>>9)+_e|0,j=((j+=((_n=((_n+=(j^((g=((g+=(_e^(j|~_n))+h[0]-198630844|0)<<6|g>>>26)+j|0)|~_e))+h[7]+1126891415|0)<<10|_n>>>22)+g|0)^((_e=((_e+=(g^(_n|~j))+h[14]-1416354905|0)<<15|_e>>>17)+_n|0)|~g))+h[5]-57434055|0)<<21|j>>>11)+_e|0,j=((j+=((_n=((_n+=(j^((g=((g+=(_e^(j|~_n))+h[12]+1700485571|0)<<6|g>>>26)+j|0)|~_e))+h[3]-1894986606|0)<<10|_n>>>22)+g|0)^((_e=((_e+=(g^(_n|~j))+h[10]-1051523|0)<<15|_e>>>17)+_n|0)|~g))+h[1]-2054922799|0)<<21|j>>>11)+_e|0,j=((j+=((_n=((_n+=(j^((g=((g+=(_e^(j|~_n))+h[8]+1873313359|0)<<6|g>>>26)+j|0)|~_e))+h[15]-30611744|0)<<10|_n>>>22)+g|0)^((_e=((_e+=(g^(_n|~j))+h[6]-1560198380|0)<<15|_e>>>17)+_n|0)|~g))+h[13]+1309151649|0)<<21|j>>>11)+_e|0,j=((j+=((_n=((_n+=(j^((g=((g+=(_e^(j|~_n))+h[4]-145523070|0)<<6|g>>>26)+j|0)|~_e))+h[11]-1120210379|0)<<10|_n>>>22)+g|0)^((_e=((_e+=(g^(_n|~j))+h[2]+718787259|0)<<15|_e>>>17)+_n|0)|~g))+h[9]-343485551|0)<<21|j>>>11)+_e|0,a[0]=g+a[0]|0,a[1]=j+a[1]|0,a[2]=_e+a[2]|0,a[3]=_n+a[3]|0},s.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(s.stateIdentity),this},s.prototype.appendStr=function(a){var h,g,j=this._buffer8,_e=this._buffer32,_n=this._bufferLength;for(g=0;g<a.length;g+=1){if((h=a.charCodeAt(g))<128)j[_n++]=h;else if(h<2048)j[_n++]=192+(h>>>6),j[_n++]=63&h|128;else if(h<55296||h>56319)j[_n++]=224+(h>>>12),j[_n++]=h>>>6&63|128,j[_n++]=63&h|128;else{if((h=1024*(h-55296)+(a.charCodeAt(++g)-56320)+65536)>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");j[_n++]=240+(h>>>18),j[_n++]=h>>>12&63|128,j[_n++]=h>>>6&63|128,j[_n++]=63&h|128}_n>=64&&(this._dataLength+=64,s._md5cycle(this._state,_e),_n-=64,_e[0]=_e[16])}return this._bufferLength=_n,this},s.prototype.appendAsciiStr=function(a){for(var h,g=this._buffer8,j=this._buffer32,_e=this._bufferLength,_n=0;;){for(h=Math.min(a.length-_n,64-_e);h--;)g[_e++]=a.charCodeAt(_n++);if(_e<64)break;this._dataLength+=64,s._md5cycle(this._state,j),_e=0}return this._bufferLength=_e,this},s.prototype.appendByteArray=function(a){for(var h,g=this._buffer8,j=this._buffer32,_e=this._bufferLength,_n=0;;){for(h=Math.min(a.length-_n,64-_e);h--;)g[_e++]=a[_n++];if(_e<64)break;this._dataLength+=64,s._md5cycle(this._state,j),_e=0}return this._bufferLength=_e,this},s.prototype.getState=function(){var a=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[a[0],a[1],a[2],a[3]]}},s.prototype.setState=function(a){var h,g=a.buffer,j=a.state,_e=this._state;for(this._dataLength=a.length,this._bufferLength=a.buflen,_e[0]=j[0],_e[1]=j[1],_e[2]=j[2],_e[3]=j[3],h=0;h<g.length;h+=1)this._buffer8[h]=g.charCodeAt(h)},s.prototype.end=function(a){a===void 0&&(a=!1);var h=this._bufferLength,g=this._buffer8,j=this._buffer32,_e=1+(h>>2);this._dataLength+=h;var _n=8*this._dataLength;if(g[h]=128,g[h+1]=g[h+2]=g[h+3]=0,j.set(s.buffer32Identity.subarray(_e),_e),h>55&&(s._md5cycle(this._state,j),j.set(s.buffer32Identity)),_n<=4294967295)j[14]=_n;else{var _o=_n.toString(16).match(/(.*?)(.{0,8})$/);if(_o===null)return;var _a=parseInt(_o[2],16),_r=parseInt(_o[1],16)||0;j[14]=_a,j[15]=_r}return s._md5cycle(this._state,j),a?this._state:s._hex(this._state)},s.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),s.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),s.hexChars="0123456789abcdef",s.hexOut=[],s.onePassHasher=new s,s}(),Nat=R$.Md5=w$;if(w$.hashStr("hello")!=="5d41402abc4b2a76b9719d911017c592")throw new Error("Md5 self test failed.");const kat=async(s,a,h)=>await(async(g,j,_e)=>{const _n=""+j+_e,_o=new Uint8Array(Nat.hashStr(_n,!0).buffer).slice(0,16),_a=_o.slice(0,12),_r=await window.crypto.subtle.importKey("raw",_o,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:_a},_r,g))})(s.buffer,a,h);function I$(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}const Lat=new Map([["moderation",1],["supervise",2]]);class sU extends C_{get connectionState(){return this._connectionState}set connectionState(a){if(this._connectionState===a)return;const h=this._connectionState;this._connectionState=a,this.emit(Q_.CONNECTION_STATE_CHANGE,h,a)}get inspectType(){return this._inspectType}set inspectType(a){var h;this._inspectMode=Gy(h=a.map(g=>Lat.get(g)||0)).call(h,(g,j)=>g+j),this._inspectType=a}get quality(){return this._quality}set quality(a){this._quality=a>1?1:a<.1?.1:a,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(a){super(),Rl(this,"name","AgoraRTCVideoContentInspect"),Rl(this,"_connectionState",Ny.CONNECTING),Rl(this,"_innerConnectionState",void 0),Rl(this,"sequence",0),Rl(this,"inspectStartTime",void 0),Rl(this,"workerManagerConnection",void 0),Rl(this,"workerConnection",void 0),Rl(this,"workerMessageLengthLimit",void 0),Rl(this,"inspectIntervalMinimum",void 0),Rl(this,"qualityRatio",void 0),Rl(this,"_connectInfo",void 0),Rl(this,"_cancelTokenSource",hS.CancelToken.source()),Rl(this,"_retryConfig",void 0),Rl(this,"wmSequence",0),Rl(this,"inspectInterval",void 0),Rl(this,"inspectTimer",null),Rl(this,"ossFilePrefix",void 0),Rl(this,"extraInfo",void 0),Rl(this,"_inspectType",void 0),Rl(this,"_inspectMode",void 0),Rl(this,"_quality",1),Rl(this,"qualityTimer",null),Rl(this,"_inspectId",void 0),Rl(this,"_needWorkUrlOnly",!1),Rl(this,"inspectImage",()=>{if(this.connectionState!==Ny.CONNECTED)throw new Ql(Hl.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===Ny.CONNECTED?this.requestToInspectImage():Ll.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=N_(5,"inspect-"),this.workerMessageLengthLimit=wp("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=wp("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=wp("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=a.interval,this.ossFilePrefix=a.ossFilePrefix,this.extraInfo=a.extraInfo,this.inspectType=a.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new rN("worker-manager-"+this._inspectId,t1),this.on(Q_.STATE_CHANGE,(h,g)=>{this._innerConnectionState=h,Ll.debug("[".concat(this._inspectId,"] Inspect operation :").concat(ky[h]," ").concat(g||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new rN("worker-"+this._inspectId,t1),this.handleWorkerEvents()}async init(a,h){this.emit(Q_.STATE_CHANGE,ky.CONNECT_AP),this._connectInfo=a;const g=this._cancelTokenSource.token;return this._retryConfig=h,new s0((j,_e)=>{this.on(Q_.CONNECTION_STATE_CHANGE,(_n,_o)=>{_o===Ny.CONNECTED&&j()}),this.requestAP(a,g,h).then(_n=>{this.connectWorkerManager(_n)}).catch(_n=>{_e(_n)})})}async requestAP(a,h,g){const j=wp("WEBCS_DOMAIN").map(_o=>"https://".concat(_o,"/api/v1")),_e=await function(_o,_a,_r,ba){let{appId:xa,areaCode:El,cname:yl,sid:Ol,token:Al,uid:Nl}=_a;J8++;const Ml="image_moderation_api",Fl={service_name:Ml,json_body:JSON.stringify({appId:xa,areaCode:El,cname:yl,command:"allocateEdge",requestId:J8,seq:J8,sid:Ol,token:Al,ts:Date.now(),uid:Nl+""})};let up,_p,Tp=_o[0];return QS(async()=>{up=Date.now();const Fp=await xS(Tp,{data:Fl,cancelToken:_r,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(_p=Date.now()-up,Fp.code!==0){const Yp=new Ql(Hl.UNEXPECTED_RESPONSE,"image inspect ap error, code"+Fp.code,{retry:!0,responseTime:_p});throw Ll.error(Yp.toString()),Yp}const Ap=JSON.parse(Fp.json_body);if(Ap.code!==200){const Yp=new Ql(Hl.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(Ap.code,", reason: ").concat(Ap.reason),{code:Ap.code,responseTime:_p});throw Ll.error(Yp.toString()),Yp}if(!Ap.servers||!Array.isArray(Ap.servers)||Ap.servers.length===0){const Yp=new Ql(Hl.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:Ap.code,responseTime:_p});throw Ll.error(Yp.toString()),Yp}const Xp=wp("VIDEO_INSPECT_WORKER_MANAGER_HOST"),_g=wp("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:Ap.servers.map(Yp=>{let{address:h0,wss:E0}=Yp;if(h0&&E0)return"wss://".concat(h0.replace(/\./g,"-"),".").concat(Xp,":").concat(_g||E0)}).filter(Yp=>!!Yp),workerToken:Ap.workerToken,vid:Ap.vid,responseTime:_p}},(Fp,Ap)=>(d0.apworkerEvent(Ol,{success:!0,sc:200,serviceName:Ml,responseDetail:JSON.stringify(Fp.addressList),firstSuccess:Ap===0,responseTime:_p,serverIp:_o[Ap%_o.length]}),!1),(Fp,Ap)=>(d0.apworkerEvent(Ol,{success:!1,sc:Fp.data&&Fp.data.code||200,serviceName:Ml,responseTime:_p,serverIp:_o[Ap%_o.length]}),!!(Fp.code!==Hl.OPERATION_ABORTED&&Fp.code!==Hl.UNEXPECTED_RESPONSE||Fp.data&&Fp.data.retry)&&(Tp=_o[(Ap+1)%_o.length],!0)),ba)}(j,a,h,g);this.emit(Q_.STATE_CHANGE,ky.AP_CONNECTED);const{addressList:_n}=_e;return this.wmSequence++,_n}async connectWorkerManager(a){let h=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=h,this.emit(Q_.STATE_CHANGE,ky.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(a,1e4)}async connectWorker(a){await this.workerConnection.init([a])}handleWorkerManagerEvents(){this.workerManagerConnection.on(k0.CONNECTED,async()=>{this.emit(Q_.STATE_CHANGE,ky.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.16.1",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(k0.CLOSED,()=>{this._innerConnectionState<ky.GET_WORKER_MANAGER_RESPONSE&&Ll.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(k0.FAILED,()=>{this._innerConnectionState<ky.GET_WORKER_MANAGER_RESPONSE&&Ll.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(k0.RECONNECTING,()=>{this._innerConnectionState<ky.GET_WORKER_MANAGER_RESPONSE&&Ll.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(k0.ON_MESSAGE,async a=>{this.emit(Q_.STATE_CHANGE,ky.GET_WORKER_MANAGER_RESPONSE);const h=this.workerManagerConnection.url;this.workerManagerConnection.close();const g=JSON.parse(a.data);if(g.code!==200)throw Ll.error("[".concat(this._inspectId,"] Unexpected code ").concat(g.code," from worker manager")),new Ql(Hl.UNEXPECTED_RESPONSE,"response code of worker is unexpected",g);if(!(g.serverResponse&&g.serverResponse.portWss&&h))throw Ll.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(g))),new Ql(Hl.UNEXPECTED_RESPONSE,"response content of worker is unexpected",g);{const j=wp("VIDEO_INSPECT_WORKER_PORT")||g.serverResponse.portWss,_e=h.replace(/:\d+\/?$/,":".concat(j));this.emit(Q_.STATE_CHANGE,ky.CONNECT_WORKER,_e),this._needWorkUrlOnly?this.emit(Q_.REQUEST_NEW_WORKER_URL,_e):await this.connectWorker(_e)}}),this.workerManagerConnection.on(k0.WILL_RECONNECT,(a,h)=>{h(a)}),this.workerManagerConnection.on(k0.REQUEST_NEW_URLS,(a,h)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(a).catch(h)})}handleWorkerEvents(){this.workerConnection.on(k0.CONNECTED,async()=>{this.emit(Q_.STATE_CHANGE,ky.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=Ny.CONNECTED}),this.workerConnection.on(k0.ON_MESSAGE,async a=>{if(a.data instanceof ArrayBuffer){const g=Tat(new Uint8Array(a.data));if(wp("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&Ll.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(g)),g.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(Q_.INSPECT_RESULT,void 0,void 0);if(g.data&&g.data.scorePorn&&g.data.scoreSexy&&g.data.scoreNeutral){var h;const j={porn:g.data.scorePorn,sexy:g.data.scoreSexy,neutral:g.data.scoreNeutral},_e=Gy(h=Object.keys(j)).call(h,(_o,_a)=>j[_o]>j[_a]?_o:_a,"porn"),_n=Object.keys(j).find(_o=>_o===_e);this.emit(Q_.INSPECT_RESULT,_n)}else this.emit(Q_.INSPECT_RESULT,void 0,new Ql(Hl.UNEXPECTED_RESPONSE,g.code+"","There is an unexpected data on message"))}else this.emit(Q_.INSPECT_RESULT,void 0,new Ql(Hl.UNEXPECTED_RESPONSE,g.code+"",g.msg))}else Ll.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(Q_.INSPECT_RESULT,void 0,new Ql(Hl.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(k0.CLOSED,()=>{this.connectionState=Ny.CLOSED}),this.workerConnection.on(k0.FAILED,()=>{this.connectionState=Ny.CLOSED}),this.workerConnection.on(k0.RECONNECTING,()=>{this.connectionState=this.connectionState===Ny.CONNECTED?Ny.RECONNECTING:Ny.CONNECTING}),this.workerConnection.on(k0.WILL_RECONNECT,(a,h)=>{a==="recover"&&h(a),h("tryNext")}),this.workerConnection.on(k0.REQUEST_NEW_URLS,(a,h)=>{this.workerManagerConnection.close(),this.once(Q_.REQUEST_NEW_WORKER_URL,g=>{a([g])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(g=>{this.connectWorkerManager(g,!0)}).catch(g=>{h(g)})})}static intToLong(a){return{low:a|=0,high:a>>31,unsigned:a>=0}}async requestToInspectImage(){this.sequence++;const a=tT(this,Q_.CLIENT_LOCAL_VIDEO_TRACK),h={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(a){if(!a.isPlaying)return void this.emit(Q_.INSPECT_RESULT,void 0,new Ql(Hl.INVALID_OPERATION,"Only the track being played can be inspected"));const g=await this.generateRequestData(a,h);this.workerConnection.sendMessage(g,!0,!0)}else this.emit(Q_.INSPECT_RESULT,void 0,new Ql(Hl.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(a,h){let{appId:g,cname:j,cid:_e,vid:_n,sid:_o,uid:_a}=h;const _r=Date.now(),ba=await a.getCurrentFrameImage("image/jpeg",this.quality),xa=await kat(ba,g,j),El=this.sequence+"-"+_e+"-"+_a+"-"+_r+"-"+N_(12,""),yl={appId:g,cid:_e,cname:j,deviceId:"",elapse:sU.intToLong(Number(_r-this.inspectStartTime)),fileSize:xa.byteLength,jpgEncryption:2,height:ba.height,width:ba.width,jpg:xa,networkType:6,osType:7,requestId:El,sdkVersion:"4.16.1",sequence:this.sequence,sid:_o,timestamp:sU.intToLong(_r),uid:_a,vid:_n,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};this.extraInfo===void 0&&delete yl.callbackData,this.ossFilePrefix===void 0&&delete yl.ossFilePrefix;const Ol=Sat(yl);if(Ol.byteLength<this.workerMessageLengthLimit){if(wp("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const Al=function(Nl){for(var Ml=1;Ml<arguments.length;Ml++){var Fl=arguments[Ml]!=null?arguments[Ml]:{};Ml%2?I$(Object(Fl),!0).forEach(function(up){Rl(Nl,up,Fl[up])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Nl,Object.getOwnPropertyDescriptors(Fl)):I$(Object(Fl)).forEach(function(up){Object.defineProperty(Nl,up,Object.getOwnPropertyDescriptor(Fl,up))})}return Nl}({},yl);delete Al.jpg,Ll.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(Al))}return Ol}{const Al=this.quality*this.qualityRatio;return this.quality=Al,await this.generateRequestData(a,{appId:g,cname:j,cid:_e,vid:_n,sid:_o,uid:_a})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=hS.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=Ny.CLOSED,this.emit(Q_.STATE_CHANGE,ky.CLOSED)}}var O$,C$,A$,N$,k$,L$,P$,D$,x$,M$,U$,j$,F$,V$,B$,G$,q$,W$,H$,K$,z$,Y$,J$,X$,Q$,$$,Z$,tZ,eZ,nZ,rZ,iZ,oZ,sZ,aZ,cZ,uZ,lZ,e0;function dZ(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function c3(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?dZ(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):dZ(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}let Pat=(O$=b0(),C$=b0({argsMap:(s,a)=>(Array.isArray(a)||(a=[a]),a.map(h=>h?Object(h).toString():"null"))}),A$=b0({argsMap:(s,a)=>(a||(a=[]),Array.isArray(a)||(a=[a]),a.map(h=>h.getTrackId()))}),N$=b0({argsMap:(s,a,h)=>[a.uid,h]}),k$=b0({argsMap:(s,a)=>a.map(h=>{let{user:g,mediaType:j}=h;return[g==null?void 0:g.uid,j]})}),L$=b0({argsMap:(s,a,h)=>[a.uid,h]}),P$=b0({argsMap:(s,a)=>a.map(h=>{let{user:g,mediaType:j}=h;return{uid:g==null?void 0:g.uid,mediaType:j}})}),D$=b0(),x$=b0(),M$=b0(),U$=b0(),j$=b0(),F$=b0(),V$=b0(),B$=b0(),G$=b0(),q$=b0(),W$=b0(),H$=b0(),K$=b0(),z$=b0(),Y$=b0({argsMap:(s,a)=>[a]}),J$=b0(),X$=b0(),Q$=b0(),$$=b0(),Z$=b0(),tZ=b0(),eZ=b0(),nZ=b0(),rZ=b0(),iZ=b0(),oZ=b0({argsMap:(s,a)=>(Array.isArray(a)||(a=[a]),[JSON.stringify(a)])}),sZ=b0(),aZ=b0(),cZ=b0(),uZ=b0({reportResult:!0}),lZ=b0(),Wp((e0=class extends C_{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(s){let a;if(super(),Rl(this,"store",void 0),Rl(this,"_uid",void 0),Rl(this,"_channelName",void 0),Rl(this,"_uintUid",void 0),Rl(this,"_users",[]),Rl(this,"_codec",void 0),Rl(this,"_mode",void 0),Rl(this,"_config",void 0),Rl(this,"_clientId",void 0),Rl(this,"_appId",void 0),Rl(this,"_sessionId",null),Rl(this,"_key",void 0),Rl(this,"_joinInfo",void 0),Rl(this,"_gateway",void 0),Rl(this,"_statsCollector",void 0),Rl(this,"_configDistribute",void 0),Rl(this,"_leaveMutex",new B1("client-leave")),Rl(this,"_publishMutex",new B1("client-publish")),Rl(this,"_renewTokenMutex",new B1("client-renewtoken")),Rl(this,"_subscribeMutex",new B1("client-subscribe")),Rl(this,"_encryptionMode","none"),Rl(this,"_encryptionSecret",null),Rl(this,"_encryptionSalt",null),Rl(this,"_proxyServer",void 0),Rl(this,"_turnServer",{servers:[],mode:"auto"}),Rl(this,"_cloudProxyServerMode","disabled"),Rl(this,"_isDualStreamEnabled",!1),Rl(this,"_defaultStreamFallbackType",void 0),Rl(this,"_lowStreamParameter",void 0),Rl(this,"_streamFallbackTypeCacheMap",new Map),Rl(this,"_remoteStreamTypeCacheMap",new Map),Rl(this,"_axiosCancelSource",hS.CancelToken.source()),Rl(this,"_audioVolumeIndicationInterval",void 0),Rl(this,"_networkQualityInterval",void 0),Rl(this,"_userOfflineTimeout",void 0),Rl(this,"_streamRemovedTimeout",void 0),Rl(this,"_injectStreamingClient",void 0),Rl(this,"_liveTranscodeStreamingClient",void 0),Rl(this,"_liveRawStreamingClient",void 0),Rl(this,"_channelMediaRelayClient",void 0),Rl(this,"_networkQualitySensitivity","normal"),Rl(this,"_p2pChannel",void 0),Rl(this,"_useLocalAccessPoint",!1),Rl(this,"_setLocalAPVersion",void 0),Rl(this,"_joinAndNotLeaveYet",!1),Rl(this,"_numberOfJoinCount",0),Rl(this,"_remoteDefaultVideoStreamType",void 0),Rl(this,"_inspect",void 0),Rl(this,"_license",void 0),Rl(this,"_handleLocalTrackEnable",(h,g,j)=>{this.publish(h,!1).then(g).catch(j)}),Rl(this,"_handleLocalTrackDisable",(h,g,j)=>{this.unpublish(h).then(g).catch(j)}),Rl(this,"_handleUserOnline",h=>{this.isStringUID&&typeof h.uid!="string"&&Ll.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const g=this._users.find(j=>j.uid===h.uid);if(g)g._trust_in_room_=!0;else{const j=new t9(h.uid,h.uint_id||h.uid);this._users.push(j),Ll.debug("[".concat(this._clientId,"] user online"),h.uid),this.emit(F0.USER_JOINED,j)}}),Rl(this,"_handleUserOffline",h=>{const g=this._users.find(j=>j.uid===h.uid);g&&(this._handleRemoveStream(h),g8(this._users,g),this._remoteStreamTypeCacheMap.delete(g.uid),this._streamFallbackTypeCacheMap.delete(g.uid),Ll.debug("[".concat(this._clientId,"] user offline"),h.uid,"reason:",h.reason),this.emit(F0.USER_LEAVED,g,h.reason))}),Rl(this,"_handleAddAudioOrVideoStream",(h,g,j,_e,_n,_o,_a)=>{const _r=this._users.find(xa=>xa.uid===g);if(!_r)return void Ll.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));Ll.debug("[".concat(this._clientId,"] stream added with uid ").concat(g,", type ").concat(h)),this.store.subscribe(_r.uid,h,void 0,void 0,void 0,Date.now());const ba=h==="audio"?_r.hasAudio:_r.hasVideo;_r._uintid||(_r._uintid=_n||g),h==="audio"?_r._trust_audio_stream_added_state_=!0:_r._trust_video_stream_added_state_=!0,h==="audio"?(_r._audio_added_=!0,j!==void 0&&(_r._audioSSRC=j),_e!==void 0&&(_r._cname=_e),_o&&(_r._audioOrtc=_o)):(_r._video_added_=!0,j!==void 0&&(_r._videoSSRC=j),_e!==void 0&&(_r._cname=_e),_a!==void 0&&(_r._rtxSsrcId=_a),_o&&(_r._videoOrtc=_o)),(h==="audio"?_r.hasAudio:_r.hasVideo)&&!ba&&(Ll.info("[".concat(this._clientId,"] remote user ").concat(_r.uid," published ").concat(h)),this.emit(F0.USER_PUBLISHED,_r,h)),h==="video"?d0.onGatewayStream(this._sessionId,T1.ON_ADD_VIDEO_STREAM,k_.ON_ADD_VIDEO_STREAM,{peer:_n||g}):d0.onGatewayStream(this._sessionId,T1.ON_ADD_AUDIO_STREAM,k_.ON_ADD_AUDIO_STREAM,{peer:_n||g}),this._p2pChannel.remoteMediaSsrcChanged(_r,h,j).then(xa=>{if(xa)return Ll.debug("[".concat(this._clientId,"] resubscribe ").concat(h," for user ").concat(_r.uid," after rejoin because SSRC id changed.")),this._p2pChannel.unsubscribe(_r,h,!0).then(()=>this._subscribe(_r,h,!0).catch(El=>{Ll.error("[".concat(this._clientId,"] resubscribe error"),El.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(_r,h)&&(Ll.debug("[".concat(this._clientId,"] resubscribe ").concat(h," for user ").concat(_r.uid," after reconnect.")),this._subscribe(_r,h,!0).catch(xa=>{Ll.error("[".concat(this._clientId,"] resubscribe error"),xa.toString())}))}),Rl(this,"_handleRemoveStream",h=>{const g=this._users.find(_e=>_e.uid===h.uid);if(!g)return void Ll.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));Ll.debug("[".concat(this._clientId,"] stream removed with uid ").concat(h.uid));let j=()=>{};g.hasAudio&&g.hasVideo?j=()=>{Ll.info("[".concat(this._clientId,"] remote user ").concat(g.uid," unpublished audio track")),this.emit(F0.USER_UNPUBLISHED,g,"audio"),Ll.info("[".concat(this._clientId,"] remote user ").concat(g.uid," unpublished video track")),this.emit(F0.USER_UNPUBLISHED,g,"video")}:g.hasVideo?j=()=>{Ll.info("[".concat(this._clientId,"] remote user ").concat(g.uid," unpublished video track")),this.emit(F0.USER_UNPUBLISHED,g,"video")}:g.hasAudio&&(j=()=>{Ll.info("[".concat(this._clientId,"] remote user ").concat(g.uid," unpublished audio track")),this.emit(F0.USER_UNPUBLISHED,g,"audio")}),g._trust_audio_stream_added_state_=!0,g._trust_video_stream_added_state_=!0,g._audio_added_=!1,g._video_added_=!1,this._p2pChannel.unsubscribe(g).then(_e=>{if(_e)return this._gateway.unsubscribe(_e,g.uid)}),g._audioSSRC=void 0,g._videoSSRC=void 0,g._audioOrtc=void 0,g._videoOrtc=void 0,g._rtxSsrcId=void 0,d0.onGatewayStream(this._sessionId,T1.ON_REMOVE_STREAM,k_.ON_REMOVE_STREAM,{peer:h.uint_id||h.uid}),j()}),Rl(this,"_handleSetStreamLocalEnable",(h,g,j)=>{const _e=this._users.find(_a=>_a.uid===g);if(!_e)return void Ll.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));Ll.debug("[".concat(this._clientId,"] local ").concat(h," ").concat(j?"enabled":"disabled"," with uid ").concat(g));const _n=h==="audio"?_e.hasAudio:_e.hasVideo;if(h==="audio"){_e._trust_audio_enabled_state_=!0;const _a=_e._audio_enabled_;if(_e._audio_enabled_=j,_e._audio_enabled_===_a)return;{const _r=_e._audio_enabled_?"enable-local-audio":"disable-local-audio";Ll.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(g,", msg: ").concat(_r)),this.emit(F0.USER_INFO_UPDATED,g,_r)}}else{_e._trust_video_enabled_state_=!0;const _a=_e._video_enabled_;if(_e._video_enabled_=j,_e._video_enabled_===_a)return;{const _r=_e._video_enabled_?"enable-local-video":"disable-local-video";Ll.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(g,", msg: ").concat(_r)),this.emit(F0.USER_INFO_UPDATED,g,_r)}}const _o=h==="audio"?_e.hasAudio:_e.hasVideo;return _n!==_o?!_n&&_o?(Ll.info("[".concat(this._clientId,"] remote user ").concat(g," published ").concat(h)),void this.emit(F0.USER_PUBLISHED,_e,h)):(h==="video"&&_e._videoTrack&&_e._videoTrack._destroy(),h==="audio"&&_e._audioTrack,this._p2pChannel.muteRemote(_e,h),Ll.info("[".concat(this._clientId,"] remote user ").concat(g," unpublished ").concat(h)),void this.emit(F0.USER_UNPUBLISHED,_e,h)):void 0}),Rl(this,"_handleMuteStream",(h,g,j)=>{Ll.debug("[".concat(this._clientId,"] receive mute message"),h,g,j);const _e=this._users.find(_a=>_a.uid===h);if(!_e)return void Ll.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(h));const _n=g==="audio"?_e.hasAudio:_e.hasVideo;if(g==="audio"){_e._trust_audio_mute_state_=!0;const _a=_e._audio_muted_;if(_e._audio_muted_=j,_e._audio_muted_===_a)return;{const _r=_e._audio_muted_?"mute-audio":"unmute-audio";Ll.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(h,", msg: ").concat(_r)),this.emit(F0.USER_INFO_UPDATED,h,_r)}}else{_e._trust_video_mute_state_=!0;const _a=_e._video_muted_;if(_e._video_muted_=j,_e._video_muted_===_a)return;{const _r=_e._video_muted_?"mute-video":"unmute-video";Ll.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(h,", msg: ").concat(_r)),this.emit(F0.USER_INFO_UPDATED,h,_r)}}const _o=g==="audio"?_e.hasAudio:_e.hasVideo;if(_n!==_o){if(!_n&&_o)return(g==="audio"?_e._audioSSRC:_e._videoSSRC)?(Ll.info("[".concat(this._clientId,"] remote user ").concat(h," published ").concat(g)),void this.emit(F0.USER_PUBLISHED,_e,g)):void Ll.warning("[".concat(this._clientId,"] remote user ").concat(h," receive ").concat(g," unmute message  before add stream message, ").concat(g," SSRC doesn't exist yet."));g==="video"&&_e._videoTrack&&_e._videoTrack._destroy(),g==="audio"&&_e._audioTrack,this._p2pChannel.muteRemote(_e,g),Ll.info("[".concat(this._clientId,"] remote user ").concat(h," unpublished ").concat(g)),this.emit(F0.USER_UNPUBLISHED,_e,g)}}),Rl(this,"_handleP2PLost",async h=>{Ll.debug("[".concat(this._clientId,"] receive p2p lost"),h),parseInt(h.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():Ll.warning("P2PLost stream not found",h)}),Rl(this,"_handleTokenWillExpire",()=>{Ll.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.emit(F0.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),Rl(this,"_handleBeforeUnload",h=>{h.type==="beforeunload"&&h.returnValue!==void 0&&h.returnValue!==""||(this.leave(),Ll.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),Rl(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.emit(F0.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const h={downlinkNetworkQuality:0,uplinkNetworkQuality:0};h.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),h.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.emit(F0.NETWORK_QUALITY,h)}),this._codec=s.codec,this._mode=s.mode,this._clientId=N_(5,"client-"),this.store=new yat(s.codec,s.audioCodec,s.mode,this._clientId),this.store.clientCreated(),s.proxyServer&&this.setProxyServer(s.proxyServer,!0),s.turnServer&&this.setTurnServer(s.turnServer,!0),Ll.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(Ky," build: ").concat(L6,", mode: ").concat(this._mode,", codec: ").concat(this._codec)),s.clientRoleOptions)try{gq(s.clientRoleOptions),a=Object.assign({},s.clientRoleOptions)}catch(h){Ll.warning("[".concat(this._clientId,"] ").concat(h.toString()))}this._statsCollector=new J2(this.store),this._statsCollector.onStatsException=(h,g,j)=>{Ll.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(h,", msg: ").concat(g,", uid: ").concat(j)),this.emit(F0.EXCEPTION,{code:h,msg:g,uid:j})},this._statsCollector.onUploadPublishDuration=(h,g,j,_e)=>{const _n=this._users.find(_o=>_o.uid===h);_n&&d0.peerPublishStatus(this._sessionId,{subscribeElapse:_e,audioPublishDuration:g,videoPublishDuration:j,peer:_n._uintid})},this._gateway=new Bot(this.store,{clientId:this._clientId,mode:this._mode,codec:this._codec,websocketRetryConfig:s.websocketRetryConfig||t1,httpRetryConfig:s.httpRetryConfig||t1,forceWaitGatewayResponse:s.forceWaitGatewayResponse===void 0||s.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:s.role,clientRoleOptions:a}),this._config=s,this._configDistribute=new Xot,this._p2pChannel=new Eat(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async join(s,a,h,g,j){const _e=++this._numberOfJoinCount;this.store.joinStart(),g&&(this.store.uid=g);const _n=bat(),_o=m$()?window.isSecureContext:"Browser Not Support";if(!m$()&&!_n||!window.isSecureContext){const yl="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";Ll.warning(yl)}const _a=f8();this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),Ll.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)));const _r=d0.reportApiInvoke(_a,{name:Y_.JOIN,options:[s,a,h,g],states:{isHttps:_n,isSecureContext:_o},tag:A_.TRACER});d0.setAppId(s);try{if(!h&&h!==null)throw new Ql(Hl.INVALID_PARAMS,"Invalid token: ".concat(h,". If you don not use token, set it to null"));h&&b1(h,"token",1,2047),b1(s,"appid",1,2047),q6(a),g&&W6(g),j&&b1(j,"optionalInfo",1,2047)}catch(yl){throw _r.onError(yl),yl}if(Ll.info("[".concat(this._clientId,"] start join channel ").concat(a,", join number: ").concat(_e)),this._leaveMutex.isLocked&&(Ll.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),Ll.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const yl=new Ql(Hl.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw _r.onError(yl),yl}this._sessionId||(this._sessionId=_a,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const ba=c3({clientId:this._clientId,appId:s,sid:this._sessionId,cname:a,uid:typeof g!="string"?g:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:h||s,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:j,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(this._useLocalAccessPoint&&(ba.setLocalAPVersion=this._setLocalAPVersion),typeof g=="string"&&(ba.stringUid=g,this._uintUid?(ba.uid=this._uintUid,this._uintUid=void 0):ba.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(ba.aesmode=this._encryptionMode,ba.aespassword=await(async yl=>{const Ol=m8(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),Al=await window.crypto.subtle.importKey("spki",Ol,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),Nl=s8(yl),Ml=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},Al,Nl);return C4(new Uint8Array(Ml))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new Ql(Hl.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(ba.aessalt=this._encryptionSalt)}this._startSession(this._sessionId,{channel:a,appId:s});const xa=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&xa===this._sessionId&&d0.joinChannelTimeout(this._sessionId,5)},5e3);try{let yl;const Ol=ba.cloudProxyServer;if(["proxy3","proxy4","proxy5"].includes(Ol)){const Fl=wp("PROXY_SERVER_TYPE3");Array.isArray(Fl)?ba.proxyServer=Fl[0]:ba.proxyServer=Fl}if(d0.setProxyServer(ba.proxyServer),Ll.setProxyServer(ba.proxyServer),this.store.requestAPStart(),ba.stringUid&&!ba.uid){const Fl=await $Y(ba.stringUid,ba,this._axiosCancelSource.token,this._config.httpRetryConfig||t1,this.store);Ll.debug("getUserAccount Success ".concat(ba.stringUid," => ").concat(Fl)),ba.uid=Fl,yl=await QY(ba,this._axiosCancelSource.token,this._config.httpRetryConfig||t1,!0,this.store)}else yl=await QY(ba,this._axiosCancelSource.token,this._config.httpRetryConfig||t1,!0,this.store);if(!this._joinAndNotLeaveYet)throw new Ql(Hl.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(ba,this._axiosCancelSource.token),this._configDistribute.on(OP.UPDATE_BITRATE_LIMIT,Fl=>{this._p2pChannel.updateBitrateLimit(Fl)})},0),this._key=h||s;const Al=yl.gatewayInfo;this._joinInfo=c3(c3({},ba),{},{cid:Al.cid,uid:ba.uid?ba.uid:Al.uid,vid:Al.vid,apResponse:Al.res,uni_lbs_ip:Al.uni_lbs_ip,gatewayAddrs:Al.gatewayAddrs});const Nl=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new Ql(Hl.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));_r.onSuccess(Nl),this._appId=s,this._channelName=ba.cname,this._uid=Nl,this.store.uid=Nl,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(iy()?"beforeunload":"pagehide",this._handleBeforeUnload)},0);const Ml=ba.stringUid?"string uid: ".concat(ba.stringUid,",uid: ").concat(ba.uid):"uid: ".concat(this._uid);return Ll.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(a,",").concat(Ml)),setTimeout(()=>{Ll.startUpload()},5e3),this.store.joinEnd(),El=this,G2.includes(El)||G2.push(El),Nl}catch(yl){const Ol=Array.isArray(yl)?yl[0]:yl;throw Ll.error("[".concat(this._clientId,"] join number: ").concat(_e,", Joining channel failed, rollback"),Ol),Ol.code!==Hl.OPERATION_ABORTED&&this._numberOfJoinCount===_e&&(this._gateway.state="DISCONNECTED",this._reset()),_r.onError(Ol),Ol}var El}_joinGateway(){if(!this._joinInfo||!this._key)throw new Ql(Hl.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!wp("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then(s=>s).catch(s=>{if(s.code===Hl.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,i_.FALLBACK),s;if(s.code===Hl.INIT_DATACHANNEL_TIMEOUT)return this._gateway.leave(!0,i_.FALLBACK),s;throw s}).then(s=>{if(s instanceof Ql){if(s.code===Hl.INIT_WEBSOCKET_TIMEOUT){if(Ll.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new Ql(Hl.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const a=wp("PROXY_SERVER_TYPE3");if(Array.isArray(a))if(this._joinInfo.apUrl){const g=new DY(this._joinInfo.apUrl).host.split("."),j=g.slice(g.length-2).join(".");a.forEach(_e=>{this._joinInfo&&_e.includes(j)&&(this._joinInfo.proxyServer=_e)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=a[0])}else this._joinInfo.proxyServer=a[0];else this._joinInfo.proxyServer=a;const h=wp("LOG_UPLOAD_SERVER").match(/.+:(\d{1,5})$/);return h&&h[1]&&h[1]!=="443"&&Ll.setProxyServer(this._joinInfo.proxyServer),wp("STATS_COLLECTOR_PORT").toString()!=="443"&&d0.setProxyServer(this._joinInfo.proxyServer),d0.reportApiInvoke(this._sessionId,{name:Y_.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:A_.TRACER}).onSuccess(),this.emit(F0.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),this._gateway.join(this._joinInfo,this._key)}if(Ll.info("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new Ql(Hl.INVALID_OPERATION);return d0.reportApiInvoke(this._sessionId,{name:Y_.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:A_.TRACER}).onSuccess(),this._joinGateway()}return s}).then(s=>s)}async leave(){Ll.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(iy()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(a){const h=G2.indexOf(a);h!==-1&&G2.splice(h,1)}(this);const s=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return Ll.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void s();await this._gateway.leave(this.connectionState!=="CONNECTED"),Ll.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),s()}async publish(s){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(Array.isArray(s)||(s=[s]),s.length===0)throw new Ql(Hl.INVALID_PARAMS,"track list is empty");if(this._gateway.role==="audience")throw new Ql(Hl.INVALID_OPERATION,"audience can not publish stream");for(const g of s){if(!(g instanceof a8))throw new Ql(Hl.INVALID_PARAMS,"parameter is not local track");if(!g._enabled&&a)throw new Ql(Hl.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(g.getTrackId()))}Ll.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(s.map(g=>"".concat(g.getTrackId()," ")))),await this._configDistribute.awaitConfigDistributeComplete(),a&&s.forEach(g=>{const j=this._configDistribute.getBitrateLimit();g instanceof H_&&j&&g.setBitrateLimit(j.uplink)});const h=await this._publishMutex.lock();try{await this._publishHighStream(s),Ll.info("[".concat(this._clientId,"] Publish success, id ").concat(s.map(g=>"".concat(g.getTrackId()," "))))}catch(g){throw Ll.error("[".concat(this._clientId,"] publish error"),g.toString()),g}finally{h()}}async unpublish(s){if(!this._joinInfo||this._uid===void 0)throw new Ql(Hl.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");s?Array.isArray(s)||(s=[s]):s=this._p2pChannel.getAllTracks(!0),Ll.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(s.map(h=>"".concat(h.getTrackId()," "))," "));const a=await this._publishMutex.lock();try{const h=await this._p2pChannel.unpublish(s);h&&await this._gateway.unpublish(h,this._uid),Ll.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(s.map(g=>"".concat(g.getTrackId()))))}catch(h){throw Ll.error("[".concat(this._clientId,"] unpublish error"),h.toString()),h}finally{a&&a()}}async subscribe(s,a){return this._subscribe(s,a)}async _subscribe(s,a,h){if(y1(a,"mediaType",["audio","video"]),!this._joinInfo)throw new Ql(Hl.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ql(Hl.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(_a=>_a===s)){const _a=new Ql(Hl.INVALID_REMOTE_USER,"user is not in the channel");throw Ll.error("[".concat(this._clientId,"] can not subscribe ").concat(s.uid,", this user is not in the channel")),_a}if(!s.hasAudio&&!s.hasVideo){const _a=new Ql(Hl.INVALID_REMOTE_USER,"user is not published");throw Ll.error("[".concat(this._clientId,"] can not subscribe ").concat(s.uid,", user is not published")),_a}if(!(h||(a!=="audio"||s.hasAudio&&s._audioSSRC!==void 0)&&(a!=="video"||s.hasVideo&&s._videoSSRC!==void 0))){const _a=new Ql(Hl.REMOTE_USER_IS_NOT_PUBLISHED);throw Ll.error("[".concat(this._clientId,"] can not subscribe ").concat(s.uid," with mediaType ").concat(a,", remote track is not published")),_a}const g=a==="audio"?s._audioSSRC:s._videoSSRC,j=a==="audio"?s._audioOrtc:s._videoOrtc,_e=a==="video"?s._rtxSsrcId:void 0,_n={stream_type:a==="audio"?N0.AUDIO:N0.VIDEO,ssrcId:g},_o=await this._subscribeMutex.lock();Ll.info("[".concat(this._clientId,"] subscribe user ").concat(s.uid,", mediaType: ").concat(a));try{if(await this._p2pChannel.hasRemoteMediaWithLock(s,a))await this._p2pChannel.unmuteRemote(s,a);else try{Jy.markSubscribeStart(this.store.clientId,g),this.store.subscribe(s.uid,a,Date.now()),await this._p2pChannel.subscribe(s,a,g,_e,j);try{await this._gateway.subscribe(s.uid,_n,!0)}catch(_r){if((_r==null?void 0:_r.code)!==Hl.WS_ABORT)throw await this._p2pChannel.unsubscribe(s,a),_r;await this._p2pChannel.unsubscribe(s,a,!0),this._p2pChannel.setPendingRemoteMedia(s,a)}this.store.subscribe(s.uid,a,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,s,a)}catch(_r){throw this._p2pChannel.reportSubscribeEvent(!1,_r==null?void 0:_r.code,s,a),_r}Ll.info("[".concat(this._clientId,"] subscribe success user ").concat(s.uid,", mediaType: ").concat(a)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(s.uid,this._defaultStreamFallbackType).catch(_r=>{Ll.warning("[".concat(this._clientId,"] auto set fallback failed"),_r)});const _a=a==="audio"?s._audioTrack:s._videoTrack;if(!_a)throw new Ql(Hl.UNEXPECTED_ERROR,"can not find remote track in user object");return _a}catch(_a){throw Ll.error("[".concat(this._clientId,"] subscribe user ").concat(s.uid," error"),_a),_a}finally{_o()}}async massSubscribe(s){if(kT(s,"subscribeList"),!this._joinInfo)throw new Ql(Hl.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ql(Hl.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const a=Date.now(),h=new Map,g=await this._subscribeMutex.lock();Ll.info("[".concat(this._clientId,"]start massSubscribe user ").concat(s.map(_o=>{let{user:_a,mediaType:_r}=_o;return"user: ".concat(_a==null?void 0:_a.uid,", mediaType: ").concat(_r)}).join("; ")));const j=(s=[...s]).map(_o=>{let{user:_a,mediaType:_r}=_o;return{user:_a,mediaType:_r}}),_e=await this._p2pChannel.globalLock();try{var _n;for(let _a=s.length-1;_a>=0;_a--){const _r=s[_a],{user:ba,mediaType:xa}=_r;if(y1(xa,"mediaType",["audio","video"]),!ba){const Ol=new Ql(Hl.INVALID_PARAMS,"user property does not exist in subscribeList item");throw Ll.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),Ol}if(!this._users.find(Ol=>Ol===ba)){const Ol=new Ql(Hl.INVALID_REMOTE_USER,"user is not in the channel");Ll.error("[".concat(this._clientId,"] can not massSubscribe ").concat(ba.uid,", this user is not in the channel")),j[_a].error=Ol,s.splice(_a,1);continue}if(xa==="audio"&&(!ba.hasAudio||ba._audioSSRC===void 0)||xa==="video"&&(!ba.hasVideo||ba._videoSSRC===void 0)){const Ol=new Ql(Hl.REMOTE_USER_IS_NOT_PUBLISHED);Ll.error("[".concat(this._clientId,"] can not subscribe ").concat(ba.uid," with mediaType ").concat(xa,", remote user is not published")),j[_a].error=Ol,s.splice(_a,1);continue}const El=G_.Video|G_.LwoVideo,yl=h.get(ba);if(yl){if(xa==="video"?yl&El:yl&G_.Audio){s.splice(_a,1),Ll.warning("repeat massSubscribe user:".concat(ba.uid,", mediaType:").concat(xa," twice"));continue}h.set(ba,yl|(xa==="video"?El:G_.Audio))}else h.set(ba,xa==="video"?El:G_.Audio)}for(let _a=s.length-1;_a>=0;_a--){const _r=s[_a],{user:ba,mediaType:xa}=_r,El=G_.Video|G_.LwoVideo;if(this._p2pChannel.hasRemoteMedia(ba,xa)){await this._p2pChannel.unmuteRemoteNoLock(ba,xa);const yl=h.get(ba);h.set(ba,xa==="video"?yl^El:yl^G_.Audio),s.splice(_a,1)}}this.store.massSubscribe(s.map(_a=>({userId:_a.user.uid,type:_a.mediaType})),a);const _o=Gy(_n=Array.from(h.entries())).call(_n,(_a,_r)=>{let[ba,xa]=_r;if(xa===0)return _a;const El={stream_id:ba.uid,stream_type:xa};return xa&G_.Audio&&(El.audio_ssrc=ba._audioSSRC),xa&G_.Video&&(El.video_ssrc=ba._videoSSRC),_a.push(El),_a},[]);try{s.length>0&&await this._p2pChannel.massSubscribeNoLock(s.map(_r=>{let{user:ba,mediaType:xa}=_r;return{user:ba,mediaType:xa,ssrcId:xa===N0.VIDEO?ba._videoSSRC:ba._audioSSRC,rtxSsrcId:ba._rtxSsrcId}}));const _a=new Map;if(_o.length>0){const _r=await this._gateway.subscribeAll(_o,!0);((_r==null?void 0:_r.users)||[]).forEach(ba=>{let{stream_id:xa,video_error_code:El,audio_error_code:yl,error_code:Ol}=ba;(El||yl||Ol)&&_a.set(xa,{video_error_code:El,audio_error_code:yl,error_code:Ol})})}if(Array.from(_a.entries()).length>0){const _r=Array.from(_a.entries()).map(ba=>{let xa,[El,yl]=ba;return yl.error_code||yl.video_error_code&&yl.audio_error_code?xa=void 0:yl.video_error_code?xa=N0.VIDEO:yl.audio_error_code&&(xa=N0.AUDIO),{user:this.remoteUsers.find(Ol=>Ol.uid===El),mediaType:xa}});await this._p2pChannel.massUnsubscribeNoLock(_r)}for(const _r of j){const ba=_a.get(_r.user.uid);if(ba){const xa=ba.error_code||_r.mediaType==="audio"&&ba.audio_error_code||_r.mediaType==="video"&&ba.video_error_code;if(xa){const El=$P(xa);Ll.error("user:".concat(_r.user.uid," mediaType:").concat(_r.mediaType," has massSubscribe error ").concat(El.desc)),_r.error=new Ql(Hl.SUBSCRIBE_FAILED,"code ".concat(xa,": ").concat(El.desc))}}_r.error||(_r.mediaType==="video"?_r.track=_r.user.videoTrack:_r.track=_r.user.audioTrack)}return this.store.massSubscribe(j.filter(_r=>!_r.error).map(_r=>({userId:_r.user.uid,type:_r.mediaType})),void 0,Date.now()),j.forEach(_r=>{var ba;d0.subscribe(this.store.sessionId,{succ:!!_r.error,ec:((ba=_r.error)===null||ba===void 0?void 0:ba.code)||null,video:_r.mediaType===N0.VIDEO,audio:_r.mediaType===N0.AUDIO,peerid:_r.user.uid,subscribeRequestid:_r.mediaType===N0.VIDEO?_r.user._videoSSRC:_r.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-a)},!0)}),Ll.info("[".concat(this._clientId,"] massSubscribe success ").concat(s.map(_r=>{let{user:ba,mediaType:xa}=_r;return"user: ".concat(ba==null?void 0:ba.uid,", mediaType: ").concat(xa)}).join("; "))),j}catch(_a){throw await this._p2pChannel.massUnsubscribeNoLock(s),_a}}finally{_e(),g()}}async unsubscribe(s,a){if(a&&y1(a,"mediaType",["audio","video"]),!this._joinInfo)throw new Ql(Hl.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(h=>h===s)){const h=new Ql(Hl.INVALID_REMOTE_USER,"user is not in the channel");throw Ll.error("[".concat(this._clientId,"] can not unsubscribe ").concat(s.uid,", user is not in the channel")),h}Ll.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(s.uid,", mediaType: ").concat(a));try{const h=await this._p2pChannel.unsubscribe(s,a);h&&await this._gateway.unsubscribe(h,s.uid),Ll.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(s.uid,", mediaType: ").concat(a))}catch(h){if(h.code===Hl.DISCONNECT_P2P)return void Ll.warning("disconnecting p2p, abort unsubscribe request.");throw Ll.error("[".concat(this._clientId,"] unsubscribe user ").concat(s.uid," error"),h.toString()),h}}async massUnsubscribe(s){if(kT(s,"unsubscribeList"),!this._joinInfo)throw new Ql(Hl.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");Ll.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(s.map(h=>{let{user:g,mediaType:j}=h;return"user: ".concat(g==null?void 0:g.uid,", mediaType: ").concat(j,";")}).join())),s=[...s];const a=new Map;for(let h=s.length-1;h>=0;h--){const{user:g,mediaType:j}=s[h];if(!g){const _n=new Ql(Hl.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw Ll.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),_n}if(y1(j,"mediaType",["video","audio",void 0]),!this._users.find(_n=>_n===g)){Ll.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(g.uid,", user is not in the channel")),s.splice(h,1);continue}const _e=G_.Video|G_.LwoVideo;if(a.has(g)){const _n=a.get(g);let _o;switch(j){case"video":_o=_n&_e;break;case"audio":_o=_n&G_.Audio;break;default:_o=_n&(G_.Audio|_e)}if(_o){Ll.warning("repeat massUnsubscribe user:".concat(g.uid,",mediaType:").concat(j," twice.")),s.splice(h,1);continue}j?j==="audio"?a.set(g,_n|G_.Audio):j==="video"&&a.set(g,_n|_e):a.set(g,_n|G_.Audio|_e)}else j?j==="audio"?a.set(g,G_.Audio):j==="video"&&a.set(g,_e):a.set(g,G_.Audio|_e)}try{const h=await this._p2pChannel.massUnsubscribe(s);h&&await this._gateway.massUnsubscribe(h),Ll.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(s.map(g=>{let{user:j,mediaType:_e}=g;return"user: ".concat(j==null?void 0:j.uid,", mediaType: ").concat(_e,";")}).join()))}catch(h){if(h.code===Hl.DISCONNECT_P2P)return void Ll.warning("disconnecting p2p, abort unsubscribe request.");throw Ll.error("[".concat(this._clientId,"] massUnsubscribe error"),h.toString()),h}}setLowStreamParameter(s){(function(h){if(!h)throw new Ql(Hl.INVALID_PARAMS);S_(h.width)||G6(h.width,"streamParameter.width"),S_(h.height)||G6(h.height,"streamParameter.height"),S_(h.framerate)||G6(h.framerate,"streamParameter.framerate"),S_(h.bitrate)||f_(h.bitrate,"streamParameter.bitrate")})(s),(!s.width&&s.height||s.width&&!s.height)&&Ll.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),Ll.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(s));const a=this._configDistribute.getLowStreamConfigDistribute();a&&a.bitrate&&s.bitrate&&a.bitrate<s.bitrate&&(s.bitrate=a.bitrate),this._lowStreamParameter=s}async enableDualStream(){if(!O1().supportDualStream)throw d0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new Ql(Hl.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new Ql(Hl.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(s){throw d0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),s}this._isDualStreamEnabled=!0,d0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),Ll.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new Ql(Hl.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(a0.LocalVideoLowTrack))try{const s=await this._p2pChannel.unpublishLowStream();s&&await this._gateway.unpublish(s,this._joinInfo.stringUid||this._joinInfo.uid)}catch(s){throw d0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),s}this._isDualStreamEnabled=!1,d0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),Ll.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(s,a){if(function(h){y1(h,"role",["audience","host"])}(s),a&&gq(a),this._mode==="rtc")throw Ll.warning("[".concat(this._clientId,"]rtc mode can not use setClientRole")),new Ql(Hl.INVALID_OPERATION,"rtc mode can not use setClientRole");if(a&&a.level&&s==="host")throw new Ql(Hl.INVALID_OPERATION,"host mode can not set audience latency level");if(s==="audience"&&this._p2pChannel.hasLocalMedia())throw new Ql(Hl.INVALID_OPERATION,"can not set client role to audience when publishing stream");await this._gateway.setClientRole(s,a),Ll.info("[".concat(this._clientId,"] set client role to ").concat(s,", level: ").concat(a&&a.level))}setProxyServer(s,a){if(b1(s,"proxyServer"),!a){if(this.connectionState!=="DISCONNECTED")throw new Ql(Hl.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new Ql(Hl.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=s,d0.setProxyServer(this._proxyServer),Ll.setProxyServer(this._proxyServer),Ll.info("[".concat(this._clientId,"] Set proxy server ").concat(a?"by initialize call":""," success."))}setTurnServer(s,a){if(Array.isArray(s)||(s=[s]),!a){if(this.connectionState!=="DISCONNECTED")throw new Ql(Hl.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new Ql(Hl.INVALID_OPERATION,"You have already set the proxy")}if(RP(s))return this._turnServer={servers:s,mode:"original-manual"},void Ll.info("[".concat(this._clientId,"] Set original turnserver ").concat(a?"by initialize call":""," success: ").concat(s.map(h=>h.urls).join(","),"."));s.forEach(h=>fq(h)),this._turnServer={servers:s,mode:"manual"},Ll.info("[".concat(this._clientId,"] Set turnserver ").concat(a?"by initialize call":""," success."))}setLicense(s){if(this.connectionState!=="DISCONNECTED")throw new Ql(Hl.INVALID_OPERATION,"you should set license before join channel");if(b1(s,"license",32,32),!/^[A-Za-z\d]+$/.test(s))throw new Ql(Hl.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=s,Ll.info("[".concat(this._clientId,"] set license success"),s)}startProxyServer(s){if(this.connectionState!=="DISCONNECTED")throw new Ql(Hl.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new Ql(Hl.INVALID_OPERATION,"You have already set the proxy");const a=[3,4,5];let h;switch(s===void 0&&(s=3),s){case 1:case 2:throw new Ql(Hl.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:h="proxy3";break;case 4:h="proxy4";break;case 5:h="proxy5";break;default:throw new Ql(Hl.INVALID_PARAMS,"proxy server mode must be ".concat(a.join("|")))}this._cloudProxyServerMode=h,this.store.cloudProxyServerMode=h,Ll.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new Ql(Hl.INVALID_OPERATION,"Stop proxy server after leave channel");d0.setProxyServer(),Ll.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",Ll.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(s){if(!s.accessPoints)throw new Ql(Hl.INVALID_PARAMS,"accessPoints is required.");kT(s.accessPoints.serverList,"accessPoints.serverList"),b1(s.accessPoints.domain,"accessPoints.domain");const a=(El,yl)=>{f_(El,yl,0,65535,!0)};let h=443;if(s.accessPoints.port&&(a(s.accessPoints.port,"accessPoints.port"),h=s.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new Ql(Hl.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");wp("CLOSE_AFB_FOR_LOCAL_AP")&&(m_("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),m_("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const g=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,j=s.accessPoints.domain,_e=s.accessPoints.serverList.map(El=>g.test(El)?"".concat(El.replace(/\./g,"-"),".").concat(j):El),_n=_e.map(El=>"".concat(El,":").concat(h));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,m_("WEBCS_DOMAIN",_n),m_("WEBCS_DOMAIN_BACKUP_LIST",_n),m_("GATEWAY_DOMAINS",[j]),s.report&&s.report.hostname&&Array.isArray(s.report.hostname)&&s.report.hostname.length?(kT(s.report.hostname,"report.hostname"),m_("EVENT_REPORT_DOMAIN",s.report.hostname[0]),m_("EVENT_REPORT_BACKUP_DOMAIN",s.report.hostname[1]||s.report.hostname[0])):(m_("EVENT_REPORT_DOMAIN",_e[0]),m_("EVENT_REPORT_BACKUP_DOMAIN",_e[1]||_e[0]));let _o=6443;s.report&&s.report.port&&(a(s.report.port,"report.port"),_o=s.report.port),m_("STATS_COLLECTOR_PORT",_o),s.report?m_("ENABLE_EVENT_REPORT",!0):m_("ENABLE_EVENT_REPORT",!1);let _a="";s.log&&s.log.hostname&&Array.isArray(s.log.hostname)&&s.log.hostname.length?(kT(s.log.hostname,"log.hostname"),_a=s.log.hostname[0]):_a=_e[0];let _r=6444;s.log&&s.log.port&&(a(s.log.port,"log.port"),_r=s.log.port),m_("LOG_UPLOAD_SERVER","".concat(_a,":").concat(_r));let ba=[];s.cds&&s.cds.hostname&&Array.isArray(s.cds.hostname)&&s.cds.hostname.length?(kT(s.cds.hostname,"cds.hostname"),ba=s.cds.hostname):ba=_e;let xa=443;s.cds&&s.cds.port&&(a(s.cds.port,"cds.port"),xa=s.cds.port),m_("CDS_AP",ba.map(El=>"".concat(El,":").concat(xa))),s.cds?m_("ENABLE_CONFIG_DISTRIBUTE",!0):m_("ENABLE_CONFIG_DISTRIBUTE",!1),Ll.info("set local access point v2 success")}setLocalAccessPoints(s,a){if(kT(s,"serverList"),b1(a,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new Ql(Hl.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const h=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;s=s.map(g=>h.test(g)?"".concat(g.replace(/\./g,"-"),".").concat(a):g),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,m_("WEBCS_DOMAIN",s),m_("WEBCS_DOMAIN_BACKUP_LIST",s),m_("GATEWAY_DOMAINS",[a]),m_("EVENT_REPORT_DOMAIN",s[0]),m_("EVENT_REPORT_BACKUP_DOMAIN",s[1]||s[0]),m_("LOG_UPLOAD_SERVER","".concat(s[0],":6444")),Ll.info("set local access point success")}async setRemoteDefaultVideoStreamType(s){if(y1(s,"streamType",[0,1]),this._remoteDefaultVideoStreamType=s,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(s),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(a){throw Ll.error("[".concat(this._clientId,"] set default remote video stream type error"),a.toString()),a}else Ll.debug("haven't joined yet, cache remoteDefaultVideoStreamType ".concat(s))}async setRemoteVideoStreamType(s,a){y1(a,"streamType",[0,1]);try{await this._gateway.setRemoteVideoStreamType(s,a),setTimeout(()=>{const h=this._users.find(g=>g.uid===s);h&&h.videoTrack&&h.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(h){throw Ll.error("[".concat(this._clientId,"] set remote video stream type error"),h.toString()),h}Ll.info("[".concat(this._clientId,"] set remote ").concat(s," video stream type to ").concat(a)),this._remoteStreamTypeCacheMap.set(s,a)}async setStreamFallbackOption(s,a){y1(a,"fallbackType",[0,1,2]);try{await this._gateway.setStreamFallbackOption(s,a)}catch(h){throw Ll.error("[".concat(this._clientId,"] set stream fallback option"),h.toString()),h}Ll.info("[".concat(this._clientId,"] set remote ").concat(s," stream fallback type to ").concat(a)),this._streamFallbackTypeCacheMap.set(s,a)}setEncryptionConfig(s,a,h){if(function(g){y1(g,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])}(s),b1(a,"secret"),["aes-128-gcm2","aes-256-gcm2"].includes(s)){if(!h||!(h instanceof Uint8Array&&h.length===32))throw new Ql(Hl.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(h)throw new Ql(Hl.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(a)||Ll.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=s,this._encryptionSecret=a,h&&(this._encryptionSalt=C4(h))}async renewToken(s){if(b1(s,"token",1,2047),!this._key||!this._joinInfo)throw new Ql(Hl.INVALID_OPERATION,"renewToken should not be called before user join");const a=this._key;this._key=s,this._joinInfo&&(this._joinInfo.token=s);const h=await this._renewTokenMutex.lock();try{if(wp("USE_NEW_TOKEN")){Ll.debug("start renew token with ticket from unilbs");const g=await Jot(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||t1);Ll.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:s,ticket:g})}else Ll.debug("start renew token without ticket"),await this._gateway.renewToken({token:s});Ll.debug("[".concat(this._clientId,"] renewToken success"))}catch(g){throw this._key=a,this._joinInfo.token=a,Ll.error("[".concat(this._clientId,"] renewToken failed"),g.toString()),g}finally{h()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?Ll.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const s=this._p2pChannel.getAudioLevels();this.emit(F0.VOLUME_INDICATOR,s)},wp("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const s=this._statsCollector.getRTCStats(),a=this._gateway.getInChannelInfo();return s.Duration=Math.round(a.duration/1e3),s}async startLiveStreaming(s,a){if(!a){if(this._codec!=="h264")throw new Ql(Hl.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new Ql(Hl.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(s)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(s))throw new Ql(Hl.LIVE_STREAMING_TASK_CONFLICT);const h=a?J_.TRANSCODE:J_.RAW;return this._createLiveStreamingClient(h).startLiveStreamingTask(s,h)}setLiveTranscoding(s){return this._createLiveStreamingClient(J_.TRANSCODE).setTranscodingConfig(s)}async stopLiveStreaming(s){const a=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(h=>h&&h.hasUrl(s));if(!a.length)throw new Ql(Hl.INVALID_PARAMS,"can not find live streaming url to stop");await s0.all(a.map(h=>h&&h.stopLiveStreamingTask(s)))}async addInjectStreamUrl(s,a){if(!this._joinInfo)throw new Ql(Hl.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const h=this._createLiveStreamingClient(J_.INJECT);h.setInjectStreamConfig(a,0),await h.startLiveStreamingTask(s,J_.INJECT)}async removeInjectStreamUrl(){var s;const a=this._createLiveStreamingClient(J_.INJECT),h=Array.from(PT(s=a.streamingTasks).call(s)).find(g=>g.mode===J_.INJECT);if(!this._joinInfo||!h)throw new Ql(Hl.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await a.stopLiveStreamingTask(h.url)}async startChannelMediaRelay(s){oX(s),await this._createChannelMediaRelayClient().startChannelMediaRelay(s)}async updateChannelMediaRelay(s){oX(s),await this._createChannelMediaRelayClient().updateChannelMediaRelay(s)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay()}sendStreamMessage(s){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new Ql(Hl.INVALID_OPERATION,"can not send data stream, not joined");if(typeof s=="string"&&(s=new TextEncoder().encode(s)),new Blob([s]).size>1024)throw new Ql(Hl.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(T0.DATA_STREAM,{payload:C4(s)},!a)}sendMetadata(s){if(!this._joinInfo)throw new Ql(Hl.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([s]).size>1024)throw new Ql(Hl.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(T0.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:C4(s)})}async sendCustomReportMessage(s){if(Array.isArray(s)||(s=[s]),s.forEach(Pnt),!this._joinInfo)throw new Ql(Hl.INVALID_OPERATION,"can not send custom report, not joined");await d0.sendCustomReportMessage(this._joinInfo.sid,s)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(s,a){y1(a.spatialLayer,"spatialLayer",[0,1,2,3]),y1(a.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(s,a)}catch(h){throw Ll.error("[".concat(this._clientId,"] pick SVC layer failed"),h.toString()),h}}_reset(){if(Ll.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=hS.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._users.forEach(s=>{s._audioTrack&&s._audioTrack._destroy(),s._videoTrack&&s._videoTrack._destroy()}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new B1("client-publish"),this._subscribeMutex=new B1("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}}_startSession(s,a){const h=s||f8();s?Ll.debug("[".concat(this._clientId,"] new Session ").concat(h)):Ll.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(h)),this._sessionId=h,this.store.sessionId=h,a?d0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:a.channel,appid:a.appId,mode:this._mode}):this._joinInfo?d0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this._mode}):this._gateway.joinInfo&&d0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this._mode}),this._joinInfo&&(this._joinInfo.sid=h),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=h)}async _publishHighStream(s){if(!this._joinInfo||this._uid===void 0)throw new Ql(Hl.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ql(Hl.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&wp("FORCE_TURN")&&!wp("TURN_ENABLE_TCP")&&!wp("TURN_ENABLE_UDP"))throw new Ql(Hl.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");Ll.debug("[".concat(this._clientId,"] publish high stream"));try{const h=await this._p2pChannel.publish(s,this._isDualStreamEnabled,this._lowStreamParameter),g=(await h.next()).value;if(g){var a;let j;try{j=await this._gateway.publish(this._uid,g,!0)}catch(_e){if(_e.code!==Hl.DISCONNECT_P2P)throw h.throw(_e),_e}await h.next(((a=j)===null||a===void 0?void 0:a.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const j of s)j instanceof H_&&j._encoderConfig&&this._gateway.setVideoProfile(j._encoderConfig),!j.muted&&j.enabled||await this._p2pChannel.muteLocalTrack(j)}catch(h){if(this._p2pChannel.reportPublishEvent(!1,h==null?void 0:h.code,s),(h==null?void 0:h.code)===Hl.WS_ABORT)return;throw h}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new Ql(Hl.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ql(Hl.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));Ll.debug("[".concat(this._clientId,"] publish low stream"));const s=this._configDistribute.getLowStreamConfigDistribute();s&&s.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&s.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=s.bitrate));try{const h=await this._p2pChannel.publishLowStream(this._lowStreamParameter),g=(await h.next()).value;if(g){var a;let j;try{j=await this._gateway.publish(this._uid,g,!0)}catch(_e){if(_e.code!==Hl.DISCONNECT_P2P)throw h.throw(_e),_e}h.next(((a=j)===null||a===void 0?void 0:a.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(h){if(this._p2pChannel.reportPublishEvent(!1,h==null?void 0:h.code,void 0,!0),(h==null?void 0:h.code)===Hl.WS_ABORT)return;throw h}}_createLiveStreamingClient(s){if(!this._joinInfo||!this._appId)return new Ql(Hl.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const a=()=>new $ot(this._joinInfo,this._config.websocketRetryConfig||t1,this._config.httpRetryConfig||t1),h=g=>{g.onLiveStreamError=(j,_e)=>{d0.reportApiInvoke(this._sessionId,{name:Y_.ON_LIVE_STREAM_ERROR,options:[j,_e],tag:A_.TRACER}).onSuccess(),this.emit(F0.LIVE_STREAMING_ERROR,j,_e)},g.onLiveStreamWarning=(j,_e)=>{d0.reportApiInvoke(this._sessionId,{name:Y_.ON_LIVE_STREAM_WARNING,options:[j,_e],tag:A_.TRACER}).onSuccess(),this.emit(F0.LIVE_STREAMING_WARNING,j,_e)},g.on(W2.REQUEST_WORKER_MANAGER_LIST,(j,_e,_n)=>{if(!this._joinInfo)return _n(new Ql(Hl.INVALID_OPERATION,"can not find join info to get worker manager"));_J(j,this._joinInfo,this._axiosCancelSource.token,t1).then(_e).catch(_n)})};switch(s){case J_.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=a(),h(this._liveRawStreamingClient)),this._liveRawStreamingClient;case J_.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=a(),h(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case J_.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=a(),this._injectStreamingClient.on(W2.REQUEST_WORKER_MANAGER_LIST,(g,j,_e)=>{if(!this._joinInfo)return _e(new Ql(Hl.INVALID_OPERATION,"can not find join info to get worker manager"));_J(g,this._joinInfo,this._axiosCancelSource.token,t1).then(j).catch(_e)}),this._injectStreamingClient.onInjectStatusChange=(g,j,_e)=>{this.emit(F0.INJECT_STREAM_STATUS,g,j,_e)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){return this._joinInfo?(this._channelMediaRelayClient||(this._channelMediaRelayClient=new tst(this._joinInfo,this._clientId,this._config.websocketRetryConfig||t1,this._config.httpRetryConfig||t1),this._channelMediaRelayClient.on("state",s=>{s===z1.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.emit(F0.CHANNEL_MEDIA_RELAY_STATE,s)}),this._channelMediaRelayClient.on("event",s=>{this.emit(F0.CHANNEL_MEDIA_RELAY_EVENT,s)})),this._channelMediaRelayClient):new Ql(Hl.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw()}_handleGatewayEvents(){this._gateway.on(I_.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(I_.CONNECTION_STATE_CHANGE,(s,a,h)=>{var g;if(h===i_.FALLBACK)return;const j=()=>{this.emit(F0.CONNECTION_STATE_CHANGE,s,a,h)};if(d0.reportApiInvoke(this._sessionId||((g=this._gateway.joinInfo)===null||g===void 0?void 0:g.sid)||null,{name:Y_.CONNECTION_STATE_CHANGE,options:[s,a,h],tag:A_.TRACER}).onSuccess(JSON.stringify({cur:s,prev:a,reason:h})),Ll.info("[".concat(this._clientId,"] connection state change: ").concat(a," -> ").concat(s)),s==="DISCONNECTED")return this._reset(),void j();if(s==="RECONNECTING")this._users.forEach(_n=>{_n._trust_in_room_=!1,_n._trust_audio_enabled_state_=!1,_n._trust_video_enabled_state_=!1,_n._trust_audio_mute_state_=!1,_n._trust_video_mute_state_=!1,_n._trust_audio_stream_added_state_=!1,_n._trust_video_stream_added_state_=!1,_n._audioSSRC=void 0,_n._videoSSRC=void 0,_n._videoOrtc=void 0,_n._audioOrtc=void 0,_n._cname=void 0,_n._rtxSsrcId=void 0}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(s==="CONNECTED"){var _e;this._streamFallbackTypeCacheMap.forEach((_n,_o)=>{this._gateway.setStreamFallbackOption(_o,_n).catch(_a=>{Ll.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),_a)})}),this._remoteStreamTypeCacheMap.forEach((_n,_o)=>{this._gateway.setRemoteVideoStreamType(_o,_n).catch(_a=>{Ll.warning("[".concat(this._clientId,"] auto set remote stream type failed"),_a)})}),this._remoteDefaultVideoStreamType!==void 0&&((_e=this._joinInfo)===null||_e===void 0?void 0:_e.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{Ll.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(_n=>{Ll.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(_n))}),this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(_n=>!_n._trust_in_room_).forEach(_n=>{Ll.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(_n.uid)),this._handleUserOffline({uid:_n.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(_n=>{_n._trust_audio_mute_state_||(Ll.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(_n.uid)),this._handleMuteStream(_n.uid,"audio",!1)),_n._trust_video_mute_state_||(Ll.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(_n.uid)),this._handleMuteStream(_n.uid,"video",!1)),_n._trust_audio_enabled_state_||(Ll.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(_n.uid)),this._handleSetStreamLocalEnable("audio",_n.uid,!0)),_n._trust_video_enabled_state_||(Ll.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(_n.uid)),this._handleSetStreamLocalEnable("video",_n.uid,!0)),_n._trust_video_stream_added_state_||(Ll.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(_n.uid)),this._handleResetAddStream(_n,"video")),_n._trust_audio_stream_added_state_||(Ll.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(_n.uid)),this._handleResetAddStream(_n,"audio")),_n._video_added_||_n._audio_added_||(Ll.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(_n.uid)),this._handleRemoveStream({uid:_n.uid,uint_id:_n._uintid}))}))},1e3)}j()}),this._gateway.on(I_.REQUEST_NEW_GATEWAY_LIST,(s,a)=>{if(!this._joinInfo)return a(new Ql(Hl.UNEXPECTED_ERROR,"can not recover, no join info"));Q8(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||t1,this.store).then(h=>{this._joinInfo&&(this._joinInfo.apResponse=h.gatewayInfo.res,this._joinInfo.gatewayAddrs=h.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=h.gatewayInfo.uni_lbs_ip),s(h.gatewayInfo.gatewayAddrs.map(g=>{if(this._joinInfo&&this._joinInfo.proxyServer){const j=g.address.split(":");return"wss://".concat(this._joinInfo.proxyServer,"/ws/?h=").concat(j[0],"&p=").concat(j[1])}return"wss://".concat(g.address)}))}).catch(a)}),this._gateway.on(I_.NETWORK_QUALITY,s=>{this._networkQualitySensitivity==="normal"&&this.emit(F0.NETWORK_QUALITY,s)}),this._gateway.on(I_.STREAM_TYPE_CHANGE,(s,a)=>{this.emit(F0.STREAM_TYPE_CHANGED,s,a),d0.reportApiInvoke(this._sessionId,{name:Y_.STREAM_TYPE_CHANGE,options:[s,a],tag:A_.TRACER}).onSuccess(JSON.stringify({uid:s,streamType:a}))}),this._gateway.on(I_.IS_P2P_DISCONNECTED,s=>{this._p2pChannel.isP2PDisconnected()?s(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?s(!1):s(!0)}),this._gateway.on(I_.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(I_.REQUEST_P2P_CONNECTION_PARAMS,async(s,a,h)=>{try{a(await this._p2pChannel.startP2PConnection(s))}catch(g){h(g)}}),this._gateway.on(I_.JOIN_RESPONSE,(s,a)=>{const{dtlsParameters:h,iceParameters:g,candidates:j,rtpCapabilities:_e,setup:_n,cname:_o}=NQ(s.ortc,a);this._p2pChannel.connect(g,h,j,_e,_n,_o)}),this._gateway.on(I_.REQUEST_DC_CONNECTION_PARAMS,s=>{s(this._p2pChannel.getEstablishParams())}),this._gateway.on(I_.RESET_CONNECTION_EVENTS,()=>{this._handleGatewaySignalEvents()}),this._gateway.on(I_.DATACHANNEL_FAILBACK,()=>{this._joinGateway()}),this._gateway.on(I_.DATACHANNEL_PRECONNECT,async(s,a,h,g)=>{var j,_e,_n,_o,_a,_r;await this._p2pChannel.startP2PConnection({turnServer:(j=this._joinInfo)===null||j===void 0?void 0:j.turnServer},!0);const ba=function(xa,El){let yl;return El&&El.ip&&typeof El.port=="number"?(yl=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:El.ip,port:El.port.toString(),type:"host",extension:{}}],Ll.debug("Using remote candidate from AP ".concat(El.ip,":").concat(El.port)),El.ip6&&(yl.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:El.ip6,port:El.port.toString(),type:"host",extension:{}}),Ll.debug("Using IPV6 remote candidate from AP ".concat(El.ip6,":").concat(El.port)))):yl=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:xa.ip,port:xa.port.toString(),type:"host",extension:{}}],yl}(s,a);return this._p2pChannel.preConnect({iceUfrag:"".concat((_e=this._joinInfo)===null||_e===void 0?void 0:_e.apResponse.cid,"_").concat((_n=this._joinInfo)===null||_n===void 0?void 0:_n.apResponse.cert),icePwd:"".concat((_o=this._joinInfo)===null||_o===void 0?void 0:_o.apResponse.cid,"_").concat((_a=this._joinInfo)===null||_a===void 0?void 0:_a.apResponse.cert)},{fingerprints:[{hashFunction:"sha-256",fingerprint:(_r=wp("FINGERPRINT"))!==null&&_r!==void 0?_r:s.fingerprint}]},ba,{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},"active","o/i14u9pJrxRKAsu").then(h).catch(g)})}_handleGatewaySignalEvents(){this._gateway.signal.on(M0.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(M0.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(M0.ON_ADD_AUDIO_STREAM,s=>this._handleAddAudioOrVideoStream("audio",s.uid,s.ssrcId,s.cname,s.uint_id,s.ortc)),this._gateway.signal.on(M0.ON_ADD_VIDEO_STREAM,s=>this._handleAddAudioOrVideoStream("video",s.uid,s.ssrcId,s.cname,s.uint_id,s.ortc,s.rtxSsrcId)),this._gateway.signal.on(M0.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(M0.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(M0.MUTE_AUDIO,s=>this._handleMuteStream(s.uid,"audio",!0)),this._gateway.signal.on(M0.UNMUTE_AUDIO,s=>this._handleMuteStream(s.uid,"audio",!1)),this._gateway.signal.on(M0.MUTE_VIDEO,s=>this._handleMuteStream(s.uid,"video",!0)),this._gateway.signal.on(M0.UNMUTE_VIDEO,s=>this._handleMuteStream(s.uid,"video",!1)),this._gateway.signal.on(M0.RECEIVE_METADATA,s=>{const a=m8(s.metadata);this.emit(F0.RECEIVE_METADATA,s.uid,a)}),this._gateway.signal.on(M0.ON_DATA_STREAM,s=>{s.seq&&delete s.seq,s.payload=m8(s.payload),this.emit(F0.STREAM_MESSAGE,s.uid,s.payload),this.onStreamMessage&&this.onStreamMessage(s)}),this._gateway.signal.on(M0.ON_CRYPT_ERROR,()=>{LP(()=>{Ll.warning("[".concat(this._clientId,"] on crypt error")),this.emit(F0.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(M0.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(M0.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{Ll.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0),this.emit(F0.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(M0.ON_STREAM_FALLBACK_UPDATE,s=>{Ll.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(s.stream_id,", attr: ").concat(s.stream_type)),this.emit(F0.STREAM_FALLBACK,s.stream_id,s.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(M0.ON_PUBLISH_STREAM,s=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:s.proxy})),Ll.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(s))))}),this._gateway.signal.on(M0.ENABLE_LOCAL_VIDEO,s=>{this._handleSetStreamLocalEnable("video",s.uid,!0)}),this._gateway.signal.on(M0.DISABLE_LOCAL_VIDEO,s=>{this._handleSetStreamLocalEnable("video",s.uid,!1)}),this._gateway.signal.on(l0.REQUEST_TIMEOUT,(s,a)=>{if(this._joinInfo)switch(s){case T0.PUBLISH:{if(!a)return;const _n=(a=a).ortc;if(_n){var h,g,j,_e;const _o=_n.some(ba=>{let{stream_type:xa}=ba;return xa===X_.Audio}),_a=_n.some(ba=>{let{stream_type:xa}=ba;return xa!==X_.Audio}),_r=_n.some(ba=>{let{stream_type:xa}=ba;return xa===X_.Screen||xa===X_.ScreenLow});a.state==="offer"&&d0.publish(this._joinInfo.sid,{eventElapse:Jy.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:Hl.TIMEOUT,audio:_o,video:_a,p2pid:a.p2p_id,publishRequestid:this.store.pubId,screenshare:_r,audioName:_o?(h=_n.find(ba=>{let{stream_type:xa}=ba;return xa===X_.Audio}))===null||h===void 0||(g=h.ssrcs[0])===null||g===void 0?void 0:g.ssrcId.toString():void 0,videoName:_a?(j=_n.find(ba=>{let{stream_type:xa}=ba;return xa!==X_.Audio}))===null||j===void 0||(_e=j.ssrcs[0])===null||_e===void 0?void 0:_e.ssrcId.toString():void 0})}break}case T0.SUBSCRIBE:(a=a)&&d0.subscribe(this._joinInfo.sid,{succ:!1,ec:Hl.TIMEOUT,audio:a.stream_type===N0.AUDIO,video:a.stream_type===N0.VIDEO,peerid:a.stream_id,subscribeRequestid:a.ssrcId,p2pid:this.store.p2pId,eventElapse:Jy.measureFromSubscribeStart(this.store.clientId,a.ssrcId)})}}),this._gateway.signal.on(M0.ON_P2P_OK,s=>{this.uid,this._uid}),this._gateway.signal.on(M0.ON_PUBLISHED_USER_LIST,s=>{if(s==null||!s.users)return;const a=[],h=[];for(const g of s.users){let j=this._users.find(_r=>_r.uid===g.stream_id);j?j._trust_in_room_=!0:(j=new t9(g.stream_id,g.stream_id),this._users.push(j),this.getListeners(F0.PUBLISHED_USER_LIST).length===0&&(Ll.debug("[".concat(this._clientId,"] user online"),g.stream_id),this.emit(F0.USER_JOINED,j)));const _e=G_.Audio&g.stream_type,_n=(G_.Video|G_.LwoVideo)&g.stream_type,_o=_e&&j.hasAudio,_a=_n&&j.hasVideo;_n&&(j._trust_video_stream_added_state_=!0,j._video_added_=!0,j._videoSSRC=g.video_ssrc),_e&&(j._trust_audio_stream_added_state_=!0,j._audio_added_=!0,j._audioSSRC=g.audio_ssrc),_e&&!_o&&this.getListeners(F0.PUBLISHED_USER_LIST).length===0&&(Ll.info("[".concat(this._clientId,"] remote user ").concat(j.uid," published audio")),this.emit(F0.USER_PUBLISHED,j,"audio")),_n&&!_a&&this.getListeners(F0.PUBLISHED_USER_LIST).length===0&&(Ll.info("[".concat(this._clientId,"] remote user ").concat(j.uid," published video")),this.emit(F0.USER_PUBLISHED,j,"video")),(_e&&!_o||_n&&!_a)&&a.push(j),_n&&this._p2pChannel.hasPendingRemoteMedia(j,"video")&&h.push({user:j,mediaType:"video"}),_e&&this._p2pChannel.hasPendingRemoteMedia(j,"audio")&&h.push({user:j,mediaType:"audio"})}h.length>0&&(Ll.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(h.map(g=>"user: ".concat(g.user.uid,", mediaType: ").concat(g.mediaType)).join("; ")," ")),this.massSubscribe(h).catch(g=>{Ll.error("[".concat(this._clientId,"] mass resubscribe error"),g.toString())})),this.getListeners(F0.PUBLISHED_USER_LIST).length>0?(Ll.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(a.map(g=>g.uid).join(", "))),this.emit(F0.PUBLISHED_USER_LIST,a)):Ll.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(a.map(g=>g.uid).join(", ")))})}_handleP2PChannelEvents(){this._p2pChannel.on(z0.RequestMuteLocal,async(s,a,h)=>{if(this._joinInfo)try{await this._gateway.muteLocal(s,this._joinInfo.stringUid||this._joinInfo.uid),a()}catch(g){g.code===Hl.DISCONNECT_P2P?a():h(g)}else a()}),this._p2pChannel.on(z0.RequestUnmuteLocal,async(s,a,h)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(s,this._joinInfo.stringUid||this._joinInfo.uid),a()}catch(g){g.code===Hl.DISCONNECT_P2P?a():h(g)}else a()}),this._p2pChannel.on(z0.RequestRePublish,(s,a,h)=>{this.publish(s,!1).then(a).catch(h)}),this._p2pChannel.on(z0.RequestReSubscribe,async(s,a,h)=>{try{for(const{user:g,kind:j}of s)j===N0.VIDEO?await this.subscribe(g,"video"):await this.subscribe(g,"audio");a()}catch(g){h(g)}}),this._p2pChannel.on(z0.RequestUploadStats,(s,a)=>{this._gateway.uploadStats(s,a)}),this._p2pChannel.on(z0.MediaReconnectStart,s=>{this.emit(F0.MEDIA_RECONNECT_START,s)}),this._p2pChannel.on(z0.MediaReconnectEnd,s=>{this.emit(F0.MEDIA_RECONNECT_END,s)}),this._p2pChannel.on(z0.NeedSignalRTT,s=>{s(this._gateway.getSignalRTT())}),this._p2pChannel.on(z0.RequestRestartICE,async()=>{const s=await this._p2pChannel.restartICE(),a=await s.next();if(a.done)return;const h=a.value;let g;try{g=await this._gateway.restartICE({iceParameters:h})}catch(_e){return void s.throw(_e)}const{iceParameters:j}=function(_e){const _n=_e.iceParameters;return{iceParameters:{iceUfrag:_n.iceUfrag,icePwd:_n.icePwd}}}(g);await s.next({remoteIceParameters:j})}),this._p2pChannel.on(z0.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(z0.RequestReconnectPC,async()=>{var s;const{iceParameters:a,dtlsParameters:h,rtpCapabilities:g}=await this._p2pChannel.startP2PConnection({turnServer:(s=this._joinInfo)===null||s===void 0?void 0:s.turnServer}),{gatewayEstablishParams:j,gatewayAddress:_e}=await this._gateway.reconnectPC({iceParameters:a,dtlsParameters:h,rtpCapabilities:g}),{dtlsParameters:_n,iceParameters:_o,candidates:_a,rtpCapabilities:_r,setup:ba,cname:xa}=NQ(j,_e);await this._p2pChannel.connect(_o,_n,_a,_r,ba,xa),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(z0.RequestUnpublishForReconnectPC,async(s,a,h)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(s,this._uid),a()):h()}),this._p2pChannel.on(z0.P2PLost,()=>{this.emit(F0.P2P_LOST,this.store.uid)}),this._p2pChannel.on(z0.UpdateVideoEncoder,s=>{s._encoderConfig&&this._gateway.setVideoProfile(s._encoderConfig)}),this._p2pChannel.on(z0.ConnectionTypeChange,s=>{this.emit(F0.IS_USING_CLOUD_PROXY,s)}),this._p2pChannel.on(z0.RequestLowStreamParameter,s=>{s(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(z0.QueryClientConnectionState,s=>{s(this.connectionState)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(s){if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new Ql(Hl.INVALID_OPERATION,"[".concat(this._clientId,"] Client did not join channel"));if(this._inspect)throw new Ql(Hl.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));if(!s)throw new Ql(Hl.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig is necessary"));if(!s.inspectType||!Array.isArray(s.inspectType))throw new Ql(Hl.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.inspectType is necessary and is an instance of Array."));{const a=[...new Set(s.inspectType)];a.forEach(h=>{if(!["supervise","moderation"].includes(h))throw new Ql(Hl.INVALID_PARAMS,"[".concat(this._clientId,"] ").concat(h," is not a valid inspect type."))}),s.inspectType=a}if(s&&s.extraInfo&&s.extraInfo.length>1024)throw new Ql(Hl.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.extraInfo length cannot exceed 1024 bytes"));try{const a=new sU(s);this._inspect=a,this.handleVideoInspectEvents(this._inspect),await a.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},t1)}catch(a){throw Array.isArray(a)?a[0]:a}}async disableContentInspect(){if(!this._inspect)throw new Ql(Hl.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(s){throw Array.isArray(s)?s[0]:s}}handleVideoInspectEvents(s){s.on(Q_.CONNECTION_STATE_CHANGE,(a,h)=>{switch(this.emit(F0.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,a,h),h){case Ny.CONNECTED:if(this.connectionState!=="CONNECTED")return void this.emit(F0.CONTENT_INSPECT_ERROR,new Ql(Hl.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));s.inspectImage()}}),s.on(Q_.INSPECT_RESULT,(a,h)=>{var g;if((h==null?void 0:h.code)===Hl.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return Ll.debug("Stop inspect content because that has left channel"),this==null||(g=this._inspect)===null||g===void 0||g.close(),void(this._inspect=void 0);this.emit(F0.CONTENT_INSPECT_RESULT,a,h)}),s.on(Q_.CLIENT_LOCAL_VIDEO_TRACK,a=>{a(this.localTracks.filter(h=>h.trackMediaType==="video")[0])})}getJoinChannelServiceRecords(){return Ll.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(s){SP(s,"enabled"),m_("ENABLE_PUBLISH_AUDIO_FILTER",s),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(s)}_handleResetAddStream(s,a){switch(a){case"audio":s._audio_added_=!1,s._trust_audio_stream_added_state_=!0;break;case"video":s._video_added_=!1,s._trust_video_stream_added_state_=!0}}}).prototype,"leave",[O$],Object.getOwnPropertyDescriptor(e0.prototype,"leave"),e0.prototype),Wp(e0.prototype,"publish",[C$],Object.getOwnPropertyDescriptor(e0.prototype,"publish"),e0.prototype),Wp(e0.prototype,"unpublish",[A$],Object.getOwnPropertyDescriptor(e0.prototype,"unpublish"),e0.prototype),Wp(e0.prototype,"subscribe",[N$],Object.getOwnPropertyDescriptor(e0.prototype,"subscribe"),e0.prototype),Wp(e0.prototype,"massSubscribe",[k$],Object.getOwnPropertyDescriptor(e0.prototype,"massSubscribe"),e0.prototype),Wp(e0.prototype,"unsubscribe",[L$],Object.getOwnPropertyDescriptor(e0.prototype,"unsubscribe"),e0.prototype),Wp(e0.prototype,"massUnsubscribe",[P$],Object.getOwnPropertyDescriptor(e0.prototype,"massUnsubscribe"),e0.prototype),Wp(e0.prototype,"setLowStreamParameter",[D$],Object.getOwnPropertyDescriptor(e0.prototype,"setLowStreamParameter"),e0.prototype),Wp(e0.prototype,"enableDualStream",[x$],Object.getOwnPropertyDescriptor(e0.prototype,"enableDualStream"),e0.prototype),Wp(e0.prototype,"disableDualStream",[M$],Object.getOwnPropertyDescriptor(e0.prototype,"disableDualStream"),e0.prototype),Wp(e0.prototype,"setClientRole",[U$],Object.getOwnPropertyDescriptor(e0.prototype,"setClientRole"),e0.prototype),Wp(e0.prototype,"setProxyServer",[j$],Object.getOwnPropertyDescriptor(e0.prototype,"setProxyServer"),e0.prototype),Wp(e0.prototype,"setTurnServer",[F$],Object.getOwnPropertyDescriptor(e0.prototype,"setTurnServer"),e0.prototype),Wp(e0.prototype,"setLicense",[V$],Object.getOwnPropertyDescriptor(e0.prototype,"setLicense"),e0.prototype),Wp(e0.prototype,"startProxyServer",[B$],Object.getOwnPropertyDescriptor(e0.prototype,"startProxyServer"),e0.prototype),Wp(e0.prototype,"stopProxyServer",[G$],Object.getOwnPropertyDescriptor(e0.prototype,"stopProxyServer"),e0.prototype),Wp(e0.prototype,"setLocalAccessPointsV2",[q$],Object.getOwnPropertyDescriptor(e0.prototype,"setLocalAccessPointsV2"),e0.prototype),Wp(e0.prototype,"setLocalAccessPoints",[W$],Object.getOwnPropertyDescriptor(e0.prototype,"setLocalAccessPoints"),e0.prototype),Wp(e0.prototype,"setRemoteDefaultVideoStreamType",[H$],Object.getOwnPropertyDescriptor(e0.prototype,"setRemoteDefaultVideoStreamType"),e0.prototype),Wp(e0.prototype,"setRemoteVideoStreamType",[K$],Object.getOwnPropertyDescriptor(e0.prototype,"setRemoteVideoStreamType"),e0.prototype),Wp(e0.prototype,"setStreamFallbackOption",[z$],Object.getOwnPropertyDescriptor(e0.prototype,"setStreamFallbackOption"),e0.prototype),Wp(e0.prototype,"setEncryptionConfig",[Y$],Object.getOwnPropertyDescriptor(e0.prototype,"setEncryptionConfig"),e0.prototype),Wp(e0.prototype,"renewToken",[J$],Object.getOwnPropertyDescriptor(e0.prototype,"renewToken"),e0.prototype),Wp(e0.prototype,"enableAudioVolumeIndicator",[X$],Object.getOwnPropertyDescriptor(e0.prototype,"enableAudioVolumeIndicator"),e0.prototype),Wp(e0.prototype,"startLiveStreaming",[Q$],Object.getOwnPropertyDescriptor(e0.prototype,"startLiveStreaming"),e0.prototype),Wp(e0.prototype,"setLiveTranscoding",[$$],Object.getOwnPropertyDescriptor(e0.prototype,"setLiveTranscoding"),e0.prototype),Wp(e0.prototype,"stopLiveStreaming",[Z$],Object.getOwnPropertyDescriptor(e0.prototype,"stopLiveStreaming"),e0.prototype),Wp(e0.prototype,"addInjectStreamUrl",[tZ],Object.getOwnPropertyDescriptor(e0.prototype,"addInjectStreamUrl"),e0.prototype),Wp(e0.prototype,"removeInjectStreamUrl",[eZ],Object.getOwnPropertyDescriptor(e0.prototype,"removeInjectStreamUrl"),e0.prototype),Wp(e0.prototype,"startChannelMediaRelay",[nZ],Object.getOwnPropertyDescriptor(e0.prototype,"startChannelMediaRelay"),e0.prototype),Wp(e0.prototype,"updateChannelMediaRelay",[rZ],Object.getOwnPropertyDescriptor(e0.prototype,"updateChannelMediaRelay"),e0.prototype),Wp(e0.prototype,"stopChannelMediaRelay",[iZ],Object.getOwnPropertyDescriptor(e0.prototype,"stopChannelMediaRelay"),e0.prototype),Wp(e0.prototype,"sendCustomReportMessage",[oZ],Object.getOwnPropertyDescriptor(e0.prototype,"sendCustomReportMessage"),e0.prototype),Wp(e0.prototype,"pickSVCLayer",[sZ],Object.getOwnPropertyDescriptor(e0.prototype,"pickSVCLayer"),e0.prototype),Wp(e0.prototype,"enableContentInspect",[aZ],Object.getOwnPropertyDescriptor(e0.prototype,"enableContentInspect"),e0.prototype),Wp(e0.prototype,"disableContentInspect",[cZ],Object.getOwnPropertyDescriptor(e0.prototype,"disableContentInspect"),e0.prototype),Wp(e0.prototype,"getJoinChannelServiceRecords",[uZ],Object.getOwnPropertyDescriptor(e0.prototype,"getJoinChannelServiceRecords"),e0.prototype),Wp(e0.prototype,"setPublishAudioFilterEnabled",[lZ],Object.getOwnPropertyDescriptor(e0.prototype,"setPublishAudioFilterEnabled"),e0.prototype),e0);class Dat extends _W{set currentState(a){a!==this._currentState&&(this._currentState=a,this.emit(ay.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(a){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Rl(this,"audioBuffer",void 0),Rl(this,"sourceNode",void 0),Rl(this,"startPlayTime",0),Rl(this,"startPlayOffset",0),Rl(this,"pausePlayTime",0),Rl(this,"options",void 0),Rl(this,"currentLoopCount",0),Rl(this,"_currentState","stopped"),this.audioBuffer=a,this.options=h,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer.duration}get currentTime(){return this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:(this.context.currentTime-this.startPlayTime+this.startPlayOffset)%this.audioBuffer.duration}updateOptions(a){this.currentState==="stopped"?(this.options=a,this.startPlayOffset=this.options.startPlayTime||0):Ll.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(a){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=a,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=a))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const a=this.context.createBufferSource();return a.buffer=this.audioBuffer,a.loop=!!this.options.loop,a.connect(this.outputNode),a}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const hZ=new Map;async function xat(s,a){let h=null;if(typeof s=="string"){const j=hZ.get(s);if(j)return Ll.debug("use cached audio resource: ",s),j;try{h=(await QS(()=>hS.get(s,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(_e){throw new Ql(Hl.FETCH_AUDIO_FILE_FAILED,_e.toString())}}else h=await new s0((_e,_n)=>{const _o=new FileReader;_o.onload=_a=>{_a.target?_e(_a.target.result):_n(new Ql(Hl.READ_LOCAL_AUDIO_FILE_ERROR))},_o.onerror=()=>{_n(new Ql(Hl.READ_LOCAL_AUDIO_FILE_ERROR))},_o.readAsArrayBuffer(s)});const g=await function(j){const _e=z2();return new s0((_n,_o)=>{_e.decodeAudioData(j,_a=>{_n(_a)},_a=>{_o(new Ql(Hl.DECODE_AUDIO_FILE_FAILED,_a.toString()))})})}(h);return typeof s=="string"&&a&&hZ.set(s,g),g}function pZ(s,a){var h=Object.keys(s);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(s);a&&(g=g.filter(function(j){return Object.getOwnPropertyDescriptor(s,j).enumerable})),h.push.apply(h,g)}return h}function aU(s){for(var a=1;a<arguments.length;a++){var h=arguments[a]!=null?arguments[a]:{};a%2?pZ(Object(h),!0).forEach(function(g){Rl(s,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(h)):pZ(Object(h)).forEach(function(g){Object.defineProperty(s,g,Object.getOwnPropertyDescriptor(h,g))})}return s}function V9(s,a,h,g){h.optimizationMode&&(g&&g.width&&g.height?(h.encoderConfig=aU(aU({},g),{},{bitrateMin:g.bitrateMin,bitrateMax:g.bitrateMax}),h.optimizationMode!=="motion"&&h.optimizationMode!=="detail"||(a.contentHint=h.optimizationMode,a.contentHint===h.optimizationMode?Ll.debug("[".concat(s,"] set content hint to"),h.optimizationMode):Ll.debug("[".concat(s,"] set content hint failed")))):Ll.warning("[".concat(s,"] can not apply optimization mode bitrate config, no encoderConfig")))}const Mat=p_().name;function Uat(s,a,h,g){let j,_e=0,_n=null;return new s0((_o,_a)=>{setTimeout(()=>{j&&(j(),_o(_e))},a),j=u8(()=>{(function(){_e>g&&j&&(j(),_o(_e));const _r=h.getContext("2d");if(!_r){const El=new Ql(Hl.UNEXPECTED_ERROR,"can not get canvas 2d context.");return Ll.error(El.toString()),void _a(El)}_r.drawImage(s,0,0,160,120);const ba=_r.getImageData(0,0,h.width,h.height),xa=Math.floor(ba.data.length/3);if(_n){for(let El=0;El<xa;El+=3)if(ba.data[El]!==_n[El])return _e+=1,void(_n=ba.data);_n=ba.data}else _n=ba.data})()},30)})}class u3{constructor(a,h){Rl(this,"id",0),Rl(this,"element",void 0),Rl(this,"peerPair",void 0),Rl(this,"context",void 0),Rl(this,"audioPlayerElement",void 0),Rl(this,"audioTrack",void 0),u3.count+=1,this.id=u3.count,this.element=a,this.context=h}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=a=>{const h=document.createElement("audio");h.srcObject=new MediaStream([a.track]),h.play(),this.audioPlayerElement=h}}async switchSdp(){if(!this.peerPair)return;const a=async(g,j)=>{const _e=j==="offer"?await g.createOffer():await g.createAnswer();return await g.setLocalDescription(_e),g.iceGatheringState==="complete"?g.localDescription:new s0(_n=>{g.onicegatheringstatechange=()=>{g.iceGatheringState==="complete"&&_n(g.localDescription)}})},h=async(g,j)=>await g.setRemoteDescription(j);try{const g=await a(this.peerPair[0],"offer");await h(this.peerPair[1],g);const j=await a(this.peerPair[1],"answer");await h(this.peerPair[0],j)}catch(g){throw new Ql(Hl.LOCAL_AEC_ERROR,g.toString()).print()}}async getTracksFromMediaElement(a){if(this.audioTrack)return this.audioTrack;let h;try{a instanceof HTMLVideoElement&&(a.captureStream?a.captureStream():a.mozCaptureStream()),h=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(a).connect(h)}catch(j){throw new Ql(Hl.LOCAL_AEC_ERROR,j.toString()).print()}if(!h)throw new Ql(Hl.LOCAL_AEC_ERROR,"no dest node when local aec").print();const g=h.stream.getAudioTracks()[0];return this.audioTrack=g,g}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const a=this.element,h=await this.getTracksFromMediaElement(a);this.peerPair&&this.peerPair[0].addTrack(h),await this.switchSdp()}close(){Ll.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(a=>{a.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var fZ,cU;Rl(u3,"count",0);const jat=window.AudioContext||window.webkitAudioContext,Fat=new(fZ=b0({report:d0}),Wp((cU=class{constructor(){Rl(this,"units",[]),Rl(this,"context",void 0)}processExternalMediaAEC(s){if(!this._doesEnvironmentNeedAEC())return Ll.debug("the system does not need to process local aec"),-1;this.context||(this.context=new jat);let a=this.units.find(h=>h&&h.getElement()===s);return a||(a=new u3(s,this.context),this.units.push(a)),a.startEchoCancellation(),Ll.debug("start processing local audio echo cancellation, id is",a.id),a.id}_doesEnvironmentNeedAEC(){return p_().name!==u_.SAFARI}}).prototype,"processExternalMediaAEC",[fZ],Object.getOwnPropertyDescriptor(cU.prototype,"processExternalMediaAEC"),cU.prototype),cU);m_("PROCESS_ID","process-".concat(N_(8,""),"-").concat(N_(4,""),"-").concat(N_(4,""),"-").concat(N_(4,""),"-").concat(N_(12,""))),function(){const s=p_();Y1.getDisplayMedia=function(a){return!!(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)}(),Y1.getStreamFromExtension=s.name===u_.CHROME&&Number(s.version)>34,Y1.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const a=new RTCPeerConnection;let h=!1;try{a.addTransceiver("audio"),h=!0}catch{}return a.close(),h}(),Y1.supportMinBitrate=s.name===u_.CHROME||s.name===u_.EDGE,Y1.supportSetRtpSenderParameters=function(){const a=p_();return!window.RTCRtpSender||!window.RTCRtpSender.prototype.setParameters||!window.RTCRtpSender.prototype.getParameters?!1:!!_I()||!(!iy()&&!r4())||a.name===u_.FIREFOX&&Number(a.version)>=64}(),s.name===u_.SAFARI&&(Number(s.version)>=14?Y1.supportDualStream=!0:Y1.supportDualStream=!1),Y1.webAudioMediaStreamDest=function(){const a=p_();return!(a.name===u_.SAFARI&&Number(a.version)<12)}(),Y1.supportReplaceTrack=function(){return window.RTCRtpSender?typeof RTCRtpSender.prototype.replaceTrack=="function":!1}(),Y1.supportWebGL=typeof WebGLRenderingContext<"u",Y1.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,_I()||(Y1.webAudioWithAEC=!0),Y1.supportShareAudio=function(){const a=p_();return(a.os===_1.WIN_10||a.os===_1.WIN_81||a.os===_1.WIN_7||a.os===_1.LINUX||a.os===_1.MAC_OS)&&a.name===u_.CHROME&&Number(a.version)>=74}(),Y1.supportDualStreamEncoding=function(){const a=p_();return wp("DISABLE_WEBAUDIO")?!0:a.name==="Safari"&&Number(a.version)>=14||!!(a.name==="Chrome"&&/Windows/i.test(a.os||"")&&Number(a.version)>=100&&wp("CHROME_DUAL_STREAM_USE_ENCODING"))}(),Y1.supportDataChannel=function(){return!!(function(a){const h=p_();return!(h.name!==u_.CHROME||!h.osVersion)&&Number(h.version)>=a}(76)||function(a){const h=p_();return!(h.name!==u_.FIREFOX||!h.osVersion)&&Number(h.version)>=a}(68)||function(a){const h=p_();return!(h.name!==u_.SAFARI||!h.osVersion)&&Number(h.version)>=a}(14))}(),Ll.info("browser compatibility",JSON.stringify(Y1),JSON.stringify(s))}(),function(){let s;try{s=window.localStorage.getItem("websdk_ng_global_parameter")}catch(a){return void Ll.error("Error loading sdk config",a.message)}if(s)try{const a=JSON.parse(window.atob(s)),h=Date.now();Ll.debug("Loading global parameters from cache",a),Object.keys(a).forEach(g=>{if(Object.prototype.hasOwnProperty.call(oy,g)){const{value:j,expires:_e}=a[g];if(_e&&_e<=h)return;x6[g]=j,oy[g]=j}})}catch(a){Ll.error("Error loading mutableParamsCache: ".concat(s),a.message)}}();const X1={__CLIENT_LIST__:G2,__TRACK_LIST__:_P,VERSION:Ky,BUILD:L6,setParameter:(s,a,h)=>{Ll.debug("setParameter key:".concat(s,", value:").concat(JSON.stringify(a))),m_(s,a,h)},getParameter:wp,getSupportedCodec:async function(){let s={audio:[],video:[]};try{let a=new RTCPeerConnection;a.addTransceiver("video",{direction:"recvonly"}),a.addTransceiver("audio",{direction:"recvonly"});const h=(await a.createOffer()).sdp;if(!h)return s;a.close(),a=null,s=function(g){const j={video:[],audio:[]};return g.match(/ VP8/i)&&j.video.push("VP8"),g.match(/ VP9/i)&&j.video.push("VP9"),g.match(/ AV1/i)&&j.video.push("AV1"),g.match(/ H264/i)&&j.video.push("H264"),g.match(/ opus/i)&&j.audio.push("OPUS"),g.match(/ PCMU/i)&&j.audio.push("PCMU"),g.match(/ PCMA/i)&&j.audio.push("PCMA"),g.match(/ G722/i)&&j.audio.push("G722"),j}(h)}catch(a){throw new Ql(Hl.CREATE_OFFER_FAILED,a.toString&&a.toString()).print()}return s},checkSystemRequirements:function(){const s=d0.reportApiInvoke(null,{name:Y_.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:A_.TRACER});let a=!1;try{const _e=window.RTCPeerConnection,_n=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,_o=window.WebSocket;a=!!(_e&&_n&&_o)}catch(_e){return Ll.error("check system requirement failed: ",_e),!1}let h=!1;const g=p_();g.name===u_.CHROME&&Number(g.version)>=58&&(!oet()||iet())&&(h=!0),g.name===u_.FIREFOX&&Number(g.version)>=56&&(h=!0),g.name===u_.OPERA&&Number(g.version)>=45&&(h=!0),g.name===u_.SAFARI&&Number(g.version)>=11&&(h=!0),(EV()||p_().name===u_.QQ)&&(h=!0),Ll.debug("checkSystemRequirements, api:",a,"browser",h);const j=a&&h;return s.onSuccess(j),j},getDevices:function(s){return vy.enumerateDevices(!0,!0,s)},getMicrophones:function(s){return vy.getRecordingDevices(s)},getCameras:function(s){return vy.getCamerasDevices(s)},getElectronScreenSources:SW,getPlaybackDevices:function(s){return vy.getSpeakers(s)},createClient:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const a=d0.reportApiInvoke(null,{name:Y_.CREATE_CLIENT,options:[s],tag:A_.TRACER});try{xnt(s)}catch(h){throw a.onError(h),h}return s.audioCodec===void 0&&(s.audioCodec="opus"),a.onSuccess(),new Pat(c3(c3({forceWaitGatewayResponse:!0},s),{},{role:s.mode==="rtc"?"host":s.role}))},createCameraVideoTrack:async function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{encoderConfig:"480p_1"};const a=d0.reportApiInvoke(null,{tag:A_.TRACER,name:Y_.CREATE_CAM_VIDEO_TRACK,options:[aU({},s)]}),h=Z8(s),g=N_(8,"track-cam-");let j=null;Ll.info("start create camera video track with config",JSON.stringify(s),"trackId",g);try{j=(await gS({video:h},g)).getVideoTracks()[0]||null}catch(_n){throw a.onError(_n),_n}if(!j){const _n=new Ql(Hl.UNEXPECTED_ERROR,"can not find track in media stream");return a.onError(_n),_n.throw()}s.optimizationMode&&V9(g,j,s,s.encoderConfig&&V2(s.encoderConfig));const _e=new YX(j,s,h,s.scalabiltyMode?f4(s.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},s.optimizationMode,g);return a.onSuccess(_e.getTrackId()),Ll.info("create camera video success, trackId:",g),_e},createCustomVideoTrack:function(s){const a=d0.reportApiInvoke(null,{tag:A_.TRACER,name:Y_.CREATE_CUSTOM_VIDEO_TRACK,options:[s]}),h=new H_(s.mediaStreamTrack,{bitrateMax:s.bitrateMax,bitrateMin:s.bitrateMin},s.scalabiltyMode?f4(s.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},s.optimizationMode);return a.onSuccess(h.getTrackId()),Ll.info("create custom video track success with config",s,"trackId",h.getTrackId()),h},createScreenVideoTrack:async function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const h=d0.reportApiInvoke(null,{tag:A_.TRACER,name:Y_.CREATE_SCREEN_VIDEO_TRACK,options:[aU({},s),a]});s.encoderConfig?typeof s.encoderConfig=="string"||s.encoderConfig.width&&s.encoderConfig.height||(s.encoderConfig.width={max:1920},s.encoderConfig.height={max:1080}):s.encoderConfig="1080p_2";const g=Est(s),j=N_(8,"track-scr");let _e=null,_n=null;const _o=O1();if(!_o.supportShareAudio&&a==="enable"){const ba=new Ql(Hl.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return h.onError(ba),ba.throw()}Ll.info("start create screen video track with config",s,"withAudio",a,"trackId",j);try{const ba=await gS({screen:g,screenAudio:a==="auto"?_o.supportShareAudio:a==="enable"},j);_e=ba.getVideoTracks()[0]||null,_n=ba.getAudioTracks()[0]||null}catch(ba){throw h.onError(ba),ba}if(!_e){const ba=new Ql(Hl.UNEXPECTED_ERROR,"can not find track in media stream");return h.onError(ba),ba.throw()}if(!_n&&a==="enable"){_e&&_e.stop();const ba=new Ql(Hl.SHARE_AUDIO_NOT_ALLOWED);return h.onError(ba),ba.throw()}s.optimizationMode||(s.optimizationMode="detail"),s.optimizationMode&&(V9(j,_e,s,s.encoderConfig&&D6(s.encoderConfig)),s.encoderConfig&&typeof s.encoderConfig!="string"&&(s.encoderConfig.bitrateMin=s.encoderConfig.bitrateMax));const _a=new H_(_e,s.encoderConfig?D6(s.encoderConfig):{},s.scalabiltyMode?f4(s.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},s.optimizationMode,j,[c1.SCREEN_TRACK]);if(!_n)return h.onSuccess(_a.getTrackId()),Ll.info("create screen video track success","video:",_a.getTrackId()),_a;const _r=new C1(_n);return h.onSuccess([_a.getTrackId(),_r.getTrackId()]),Ll.info("create screen video track success","video:",_a.getTrackId(),"audio:",_r.getTrackId()),[_a,_r]},createMicrophoneAndCameraTracks:async function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{encoderConfig:"480p_1"};const h=d0.reportApiInvoke(null,{tag:A_.TRACER,name:Y_.CREATE_MIC_AND_CAM_TRACKS,options:[s,a]}),g=Z8(a),j=mX(s),_e=N_(8,"track-mic-"),_n=N_(8,"track-cam-");let _o=null,_a=null;Ll.info("start create camera video track(".concat(_n,") and microphone audio track(").concat(_e,") with config, audio: ").concat(JSON.stringify(s),", video: ").concat(JSON.stringify(a)));try{const xa=await gS({audio:j,video:g},"".concat(_e,"-").concat(_n));_o=xa.getAudioTracks()[0],_a=xa.getVideoTracks()[0]}catch(xa){throw h.onError(xa),xa}if(!_o||!_a){const xa=new Ql(Hl.UNEXPECTED_ERROR,"can not find tracks in media stream");return h.onError(xa),xa.throw()}a.optimizationMode&&V9(_n,_a,a,a.encoderConfig&&V2(a.encoderConfig));const _r=new T4(_o,s,j,_e),ba=new YX(_a,a,g,a.scalabiltyMode?f4(a.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},a.optimizationMode,_n);return h.onSuccess([_r.getTrackId(),ba.getTrackId()]),Ll.info("create camera video track(".concat(_n,") and microphone audio track(").concat(_e,") success")),[_r,ba]},createMicrophoneAudioTrack:async function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a=d0.reportApiInvoke(null,{tag:A_.TRACER,name:Y_.CREATE_MIC_AUDIO_TRACK,options:[s]}),h=mX(s),g=N_(8,"track-mic-");let j=null;Ll.info("start create microphone audio track with config",JSON.stringify(s),"trackId",g);try{j=(await gS({audio:h},g)).getAudioTracks()[0]||null}catch(_n){throw a.onError(_n),_n}if(!j){const _n=new Ql(Hl.UNEXPECTED_ERROR,"can not find track in media stream");return a.onError(_n),_n.throw()}const _e=new T4(j,s,h,g);return a.onSuccess(_e.getTrackId()),Ll.info("create microphone audio track success, trackId:",g),_e},createCustomAudioTrack:function(s){const a=d0.reportApiInvoke(null,{tag:A_.TRACER,name:Y_.CREATE_CUSTOM_AUDIO_TRACK,options:[s]}),h=new C1(s.mediaStreamTrack,s.encoderConfig?g4(s.encoderConfig):{});return Ll.info("create custom audio track success with config",s,"trackId",h.getTrackId()),a.onSuccess(h.getTrackId()),h},createBufferSourceAudioTrack:async function(s){const a=d0.reportApiInvoke(null,{tag:A_.TRACER,name:Y_.CREATE_BUFFER_AUDIO_TRACK,options:[s]});if(wp("DISABLE_WEBAUDIO"))throw new Ql(Hl.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const h=N_(8,"track-buf-");Ll.info("start create buffer source audio track with config",JSON.stringify(s),"trackId",h);const g=s.source;if(!(s.source instanceof AudioBuffer))try{s.source=await xat(s.source,s.cacheOnlineFile)}catch(_n){return a.onError(_n),_n.throw()}const j=new Dat(s.source),_e=new nit(g,j,s.encoderConfig?g4(s.encoderConfig):{},h);return Ll.info("create buffer source audio track success, trackId:",h),a.onSuccess(_e.getTrackId()),_e},setAppType:function(s){if(Ll.debug("setAppType: ".concat(s)),!(Number.isInteger(s)&&s>=0))throw Ll.debug("Invalid appType"),new Ql(Hl.INVALID_PARAMS,"invalid app type",s);m_("APP_TYPE",Math.floor(s))},setLogLevel:function(s){Ll.setLogLevel(s)},enableLogUpload:function(){wp("USE_NEW_LOG")?m_("UPLOAD_LOG",!0):Ll.enableLogUpload()},disableLogUpload:function(){wp("USE_NEW_LOG")?m_("UPLOAD_LOG",!1):Ll.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new iX},checkAudioTrackIsActive:async function(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const h=d0.reportApiInvoke(null,{tag:A_.TRACER,name:Y_.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[a]});if(!(s instanceof C1||s instanceof nU)){const _a=new Ql(Hl.INVALID_TRACK,"the parameter is not a audio track");return h.onError(_a),_a.throw()}a&&a<1e3&&(a=1e3);const g=s instanceof C1?s.getTrackLabel():"remote_track",j=s.getVolumeLevel();let _e=j,_n=j;const _o=Date.now();return new s0(_a=>{const _r=setInterval(()=>{const ba=s.getVolumeLevel();_e=ba>_e?ba:_e,_n=ba<_n?ba:_n;const xa=_e-_n>1e-4,El=Date.now()-_o;if(xa||El>a){clearInterval(_r);const yl=xa,Ol={duration:El,deviceLabel:g,maxVolumeLevel:_e,result:yl};Ll.info("[track-".concat(s.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(Ol))),h.onSuccess(Ol),_a(yl)}},200)})},checkVideoTrackIsActive:async function(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const h=d0.reportApiInvoke(null,{tag:A_.TRACER,name:Y_.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[a]});if(!(s instanceof H_||s instanceof eU)){const El=new Ql(Hl.INVALID_TRACK,"the parameter is not a video track");return h.onError(El),El.throw()}const g=4;a&&a<1e3&&(a=1e3);const j=s instanceof H_?s.getTrackLabel():"remote_track",_e=s.getMediaStreamTrack(!0),_n=document.createElement("video");_n.style.width="1px",_n.style.height="1px",_n.setAttribute("muted",""),_n.muted=!0,_n.setAttribute("playsinline",""),_n.controls=!1,(iy()||r4())&&(_n.style.opacity="0.01",_n.style.position="fixed",_n.style.left="0",_n.style.top="0",document.body.appendChild(_n)),_n.srcObject=new MediaStream([_e]),_n.play();const _o=document.createElement("canvas");_o.width=160,_o.height=120;let _a=0,_r=0;try{const El=Date.now();_a=await Uat(_n,a,_o,g),_r=Date.now()-El}catch(El){throw h.onError(El),El}Mat===u_.SAFARI&&(_n.pause(),_n.remove()),_n.srcObject=null;const ba=_a>g,xa={duration:_r,changedPicNum:_a,deviceLabel:j,result:ba};return Ll.info("[track-".concat(s.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(xa))),h.onSuccess(xa),ba},setArea:function(s){const a=d0.reportApiInvoke(null,{name:Y_.SET_AREA,options:s,tag:A_.TRACER});try{let h=[];if(typeof s=="string"&&(h=[s]),Array.isArray(s)&&(s.forEach(j=>{if(!Vnt.includes(j))throw new Ql(Hl.INVALID_PARAMS,"invalid area code")}),h=s),Object.prototype.toString.call(s)==="[object Object]"){const{areaCode:j,excludedArea:_e}=s;if(!j)throw new Ql(Hl.INVALID_PARAMS,"area code is needed");let _n=j;typeof j=="string"&&(_n=[j]),h=_e?Kot(_n,_e):_n}m_("AREAS",h);const g=(j=>{const _e={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return j.map(_n=>{const _o=_j[_n],_a=Object.keys(_o);_a&&_a.map(_r=>{_r!=="CODE"&&(_e[_r]=_e[_r].concat(_o[_r]))})}),_e})(h);Object.keys(g).map(j=>{j==="LOG_UPLOAD_SERVER"||j==="EVENT_REPORT_DOMAIN"||j==="EVENT_REPORT_BACKUP_DOMAIN"||j==="PROXY_SERVER_TYPE3"?m_(j,g[j][0]):m_(j,g[j])}),Ll.debug("set area success:",h.join(","))}catch(h){throw a.onError(h),h}a.onSuccess()},audioElementPlayCenter:Ey,processExternalMediaAEC:function(s){Fat.processExternalMediaAEC(s)},registerExtensions:function(s){s.forEach(a=>{const h=a;h.__registered__=!0,h.logger.hookLog=Ll.extLog,h.reporter.hookApiInvoke=d0.extApiInvoke,h.parameters&&Object.keys(h.parameters).forEach(g=>{h.parameters[g]=wp(g)})})},ChannelMediaRelayError:vR,ChannelMediaRelayEvent:DS,ChannelMediaRelayState:z1,RemoteStreamFallbackType:Z6,RemoteStreamType:$6,ConnectionDisconnectedReason:i_,AudienceLatencyLevelType:z6,AREAS:Z0},B9=window||document;return Object.defineProperties(X1,{onAudioAutoplayFailed:{get:()=>Ly.onAudioAutoplayFailed,set:s=>{Ly.onAudioAutoplayFailed=s}},onAutoplayFailed:{get:()=>Ly.onAutoplayFailed,set:s=>{Ly.onAutoplayFailed=s}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>X1._onSecurityPolicyViolation,set(s){if(X1._onSecurityPolicyViolation=s,!B9)return;const a=g=>{if(!(g&&g.blockedURI&&X1.onSecurityPolicyViolation))return;const j=g.blockedURI;wp("CSP_DETECTED_HOSTNAME_LIST").some(_e=>j.includes(_e))&&X1.onSecurityPolicyViolation&&typeof X1.onSecurityPolicyViolation=="function"&&X1.onSecurityPolicyViolation(g)},h=X1._cspEventHandlerPointer;h&&B9.removeEventListener("securitypolicyviolation",h),s&&typeof s=="function"&&B9.addEventListener("securitypolicyviolation",a),X1._cspEventHandlerPointer=a}}}),vy.on(LT.CAMERA_DEVICE_CHANGED,s=>{Ll.info("camera device changed",JSON.stringify(s)),X1.onCameraChanged&&X1.onCameraChanged(s)}),vy.on(LT.RECORDING_DEVICE_CHANGED,s=>{Ll.info("microphone device changed",JSON.stringify(s)),X1.onMicrophoneChanged&&X1.onMicrophoneChanged(s)}),vy.on(LT.PLAYOUT_DEVICE_CHANGED,s=>{Ll.debug("playout device changed",JSON.stringify(s)),X1.onPlaybackDeviceChanged&&X1.onPlaybackDeviceChanged(s)}),Ey.onAutoplayFailed=()=>{Ll.info("detect audio element autoplay failed"),Ly.onAudioAutoplayFailed&&Ly.onAudioAutoplayFailed()},G0.on("autoplay-failed",()=>{Ll.info("detect webaudio autoplay failed"),Ly.onAudioAutoplayFailed&&Ly.onAudioAutoplayFailed()}),window&&(window.__ARTC__=X1),X1})})(AgoraRTC_NProduction);const AgoraRTC__default=getDefaultExportFromCjs(AgoraRTC_NProductionExports);var AgoraRTCErrorCode;(function(i){i.UNEXPECTED_ERROR="UNEXPECTED_ERROR",i.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",i.TIMEOUT="TIMEOUT",i.INVALID_PARAMS="INVALID_PARAMS",i.NOT_SUPPORTED="NOT_SUPPORTED",i.INVALID_OPERATION="INVALID_OPERATION",i.OPERATION_ABORTED="OPERATION_ABORTED",i.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",i.NETWORK_ERROR="NETWORK_ERROR",i.NETWORK_TIMEOUT="NETWORK_TIMEOUT",i.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",i.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",i.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",i.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",i.ELECTRON_IS_NULL="ELECTRON_IS_NULL",i.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",i.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",i.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",i.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",i.PERMISSION_DENIED="PERMISSION_DENIED",i.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",i.TRACK_IS_DISABLED="TRACK_IS_DISABLED",i.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",i.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",i.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",i.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",i.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",i.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",i.UID_CONFLICT="UID_CONFLICT",i.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",i.INVALID_TRACK="INVALID_TRACK",i.SENDER_NOT_FOUND="SENDER_NOT_FOUND",i.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",i.SET_ANSWER_FAILED="SET_ANSWER_FAILED",i.ICE_FAILED="ICE_FAILED",i.PC_CLOSED="PC_CLOSED",i.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",i.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",i.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",i.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",i.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",i.INVALID_REMOTE_USER="INVALID_REMOTE_USER",i.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",i.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",i.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",i.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",i.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",i.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",i.WS_ABORT="WS_ABORT",i.WS_DISCONNECT="WS_DISCONNECT",i.WS_ERR="WS_ERR",i.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",i.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",i.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",i.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",i.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",i.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",i.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",i.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",i.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",i.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",i.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",i.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",i.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",i.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",i.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",i.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",i.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",i.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE"})(AgoraRTCErrorCode||(AgoraRTCErrorCode={}));let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const byteToHex=[];for(let i=0;i<256;++i)byteToHex.push((i+256).toString(16).slice(1));function unsafeStringify(i,e=0){return(byteToHex[i[e+0]]+byteToHex[i[e+1]]+byteToHex[i[e+2]]+byteToHex[i[e+3]]+"-"+byteToHex[i[e+4]]+byteToHex[i[e+5]]+"-"+byteToHex[i[e+6]]+byteToHex[i[e+7]]+"-"+byteToHex[i[e+8]]+byteToHex[i[e+9]]+"-"+byteToHex[i[e+10]]+byteToHex[i[e+11]]+byteToHex[i[e+12]]+byteToHex[i[e+13]]+byteToHex[i[e+14]]+byteToHex[i[e+15]]).toLowerCase()}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4(i,e,o){if(native.randomUUID&&!e&&!i)return native.randomUUID();i=i||{};const c=i.random||(i.rng||rng)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,e){o=o||0;for(let _=0;_<16;++_)e[o+_]=c[_];return e}return unsafeStringify(c)}const useDidMount=i=>{const e=reactExports.useRef(!1);reactExports.useEffect(()=>{i&&!e.current&&(e.current=!0,i())})},useStateWithCallback=i=>{const e=reactExports.useRef(null),[o,c]=reactExports.useState(i);return reactExports.useEffect(()=>{typeof e.current=="function"&&(e.current(),e.current=null)},[o]),[o,($,_t)=>{e.current=_t,c($)}]},index$1="",STREAM_HEIGHT_WIDTH={height:"300px",width:"300px"},STREAM_HEIGHT_WIDTH_WHEN_USER_IN_DISPLAY_FRAME={height:"100px",width:"100px"},APP_ID="38e11099b0834c46adea082add8a95b5",token=null;let uid=sessionStorage.getItem("uid")||"";uid||(uid=v4(),sessionStorage.setItem("uid",uid));const rtmClient=AgoraRTM.createInstance(APP_ID),client=AgoraRTC__default.createClient({mode:"rtc",codec:"vp8"});let localTracks,localScreenTrack;const remoteUsers={},Room=()=>{const i=useNavigate(),{roomId:e}=useParams();e||i("/");const o=sessionStorage.getItem("displayName")||"";o||i("/");const c=reactExports.useRef(rtmClient.createChannel(e)),_=reactExports.useRef(null),$=reactExports.useRef(null),_t=reactExports.useRef(null),[ga,_s]=reactExports.useState([]),[_c,_l]=reactExports.useState(""),[Tl,Cl]=reactExports.useState([]),[Pl,Dl]=reactExports.useState(!1),[Jl,zl]=useStateWithCallback([]),[Bl,Vl]=reactExports.useState(""),[_d,Sp]=reactExports.useState(!1);useDidMount(async()=>{await rtmClient.login({uid}),await rtmClient.addOrUpdateLocalUserAttributes({name:o}),await c.current.join(),await client.join(APP_ID,e,token),c.current.on("MemberJoined",Hp),c.current.on("MemberLeft",_m),c.current.on("ChannelMessage",Qp),Jp(`Welcome to the room ${o}! `),await Np(),Dp(),client.on("user-published",Up),client.on("user-left",Kp)}),reactExports.useLayoutEffect(()=>{window.addEventListener("beforeunload",Bp),$.current.scrollTop=$.current.scrollHeight,_t.current.style.display="block",_.current.style.display="block"},[]),reactExports.useLayoutEffect(()=>{const o0=document.querySelector("#messages .message__wrapper:last-child");o0&&o0.scrollIntoView()},[Tl]);const Up=async(o0,H0)=>{var z_,VS;remoteUsers[o0.uid]=o0,await client.subscribe(o0,H0),Cp(o0.uid),H0==="video"&&((z_=o0.videoTrack)==null||z_.play(`user-${o0.uid}`)),H0==="audio"&&((VS=o0.audioTrack)==null||VS.play())},Kp=o0=>{i0(o0.uid)},Hp=async o0=>{console.log("A new member has joined the room:",o0);const{name:H0}=await rtmClient.getUserAttributesByKeys(o0,["name"]);_s(z_=>[...z_,{id:o0,name:H0}]),Jp(`Welcome to the room ${H0}! `)},_m=async o0=>{Zp(o0)},I0=async o0=>{const{name:H0}=await rtmClient.getUserAttributesByKeys(o0,["name"]);_s(z_=>[...z_,{id:o0,name:H0}])},Cp=(o0,H0)=>{const z_=Bl?STREAM_HEIGHT_WIDTH_WHEN_USER_IN_DISPLAY_FRAME:STREAM_HEIGHT_WIDTH;zl(VS=>VS.find(gO=>gO.uid===o0)?VS:[...VS,{uid:o0,...z_}],H0)},Jp=o0=>{Cl(H0=>[...H0,{author:"",isBotMessage:!0,message:o0}])},Zp=o0=>{_s(H0=>H0.filter(z_=>z_.id===o0?(Jp(`${z_.name} has left the room.`),!1):!0))},i0=o0=>{zl(H0=>H0.filter(z_=>z_.uid!==o0)),Bl===o0&&Vl("")},Np=async()=>{const o0=await c.current.getMembers();for(const H0 of o0)I0(H0)},Dp=()=>{for(const o0 of client.remoteUsers)Cp(o0.uid,async()=>{var H0,z_;remoteUsers[o0.uid]=o0,o0.hasAudio&&(await client.subscribe(o0,"audio"),(H0=o0.audioTrack)==null||H0.play()),o0.hasVideo&&(await client.subscribe(o0,"video"),(z_=o0.videoTrack)==null||z_.play(`user-${o0.uid}`))})},Qp=async o0=>{console.log("A new message was received");const H0=JSON.parse(o0.text);H0.type==="chat"&&Cl(z_=>[...z_,{author:H0.displayName,message:H0.message}])},n0=async o0=>{o0.preventDefault(),c.current.sendMessage({text:JSON.stringify({type:"chat",message:_c,displayName:o})}),Cl(H0=>[...H0,{author:o,message:_c}]),_l("")},Bp=async()=>{await c.current.leave(),await rtmClient.logout()},c0=async()=>{Dl(!0),localTracks=await AgoraRTC__default.createMicrophoneAndCameraTracks({},{encoderConfig:{width:{min:640,ideal:1920,max:1920},height:{min:480,ideal:1080,max:1080}}}),Cp(uid,()=>{localTracks[1].play(`user-${uid}`)}),client.connectionState==="DISCONNECTED"&&await client.join(APP_ID,e,token),await client.publish([localTracks[0],localTracks[1]])},_f=async o0=>{o0.preventDefault(),Dl(!1),i0(uid),localTracks[0].stop(),localTracks[0].close(),localTracks[1].stop(),localTracks[1].close(),await client.leave(),Bl===uid&&Vl("")},O0=async o0=>{let H0=o0.currentTarget;localTracks[0].muted?(await localTracks[0].setMuted(!1),H0.classList.add("active")):(await localTracks[0].setMuted(!0),H0.classList.remove("active"))},_0=async o0=>{let H0=o0.currentTarget;localTracks[1].muted?(await localTracks[1].setMuted(!1),H0.classList.add("active")):(await localTracks[1].setMuted(!0),H0.classList.remove("active"))},__=async()=>{Vl(""),Sp(!1),await client.unpublish(localScreenTrack),localScreenTrack.stop(),localScreenTrack.close(),localTracks[1].play(`user-${uid}`),await client.publish([localTracks[1]])},yp=async()=>{_d?__():await AgoraRTC__default.createScreenVideoTrack({},"disable").then(async o0=>{o0.on("track-ended",__),Vl(uid),Sp(!0),localTracks[1].stop(),await client.unpublish([localTracks[1]]),localScreenTrack=o0,localScreenTrack.play(`user-${uid}`),await client.publish(localScreenTrack)}).catch(()=>{Vl("")})},dy=()=>{zl(o0=>o0.map(H0=>({uid:H0.uid,...STREAM_HEIGHT_WIDTH})),()=>{var o0;Bl===uid?localTracks[1].play(`user-${uid}`):remoteUsers[Bl]&&((o0=remoteUsers[Bl].videoTrack)==null||o0.play(`user-${Bl}`))}),Vl("")},L1=o0=>{zl(H0=>H0.map(z_=>z_.uid!==o0?{uid:z_.uid,...STREAM_HEIGHT_WIDTH_WHEN_USER_IN_DISPLAY_FRAME}:z_),()=>{var H0;o0===uid?localTracks[1].play(`user-${uid}`):remoteUsers[o0]&&((H0=remoteUsers[o0].videoTrack)==null||H0.play(`user-${o0}`))}),Vl(o0)};return jsx("main",{className:"container",children:jsxs("div",{id:"room__container",children:[jsxs("section",{id:"members__container",ref:_t,children:[jsxs("div",{id:"members__header",children:[jsx("p",{children:"Participants"}),jsx("strong",{id:"members__count",children:ga.length})]}),jsx("div",{id:"member__list",children:ga.map(o0=>jsxs("div",{className:"member__wrapper",id:`member__${o0.id}__wrapper`,children:[jsx("span",{className:"green__icon"}),jsx("p",{className:"member_name",children:o0.name})]}))})]}),jsxs("section",{id:"stream__container",children:[jsx("div",{id:"stream__box",style:{display:Bl?"block":"none"},onClick:dy,children:Jl.map(o0=>o0.uid===Bl&&jsx("div",{className:"video__container",id:`user-container-${o0.uid}`,style:{height:o0.height,width:o0.width},children:jsx("div",{className:"video-player",id:`user-${o0.uid}`})}))}),jsx("div",{id:"streams__container",children:Jl.map(o0=>o0.uid!==Bl&&jsx("div",{className:"video__container",id:`user-container-${o0.uid}`,style:{height:o0.height,width:o0.width},onClick:()=>L1(o0.uid),children:jsx("div",{className:"video-player",id:`user-${o0.uid}`})}))}),jsxs("div",{className:"stream__actions",style:{display:Pl?"flex":"none"},children:[jsx("button",{id:"camera-btn",className:_d?"":"active",style:{display:_d?"none":"block"},onClick:_0,children:jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:jsx("path",{d:"M5 4h-3v-1h3v1zm10.93 0l.812 1.219c.743 1.115 1.987 1.781 3.328 1.781h1.93v13h-20v-13h3.93c1.341 0 2.585-.666 3.328-1.781l.812-1.219h5.86zm1.07-2h-8l-1.406 2.109c-.371.557-.995.891-1.664.891h-5.93v17h24v-17h-3.93c-.669 0-1.293-.334-1.664-.891l-1.406-2.109zm-11 8c0-.552-.447-1-1-1s-1 .448-1 1 .447 1 1 1 1-.448 1-1zm7 0c1.654 0 3 1.346 3 3s-1.346 3-3 3-3-1.346-3-3 1.346-3 3-3zm0-2c-2.761 0-5 2.239-5 5s2.239 5 5 5 5-2.239 5-5-2.239-5-5-5z"})})}),jsx("button",{id:"mic-btn",className:"active",onClick:O0,children:jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:jsx("path",{d:"M12 2c1.103 0 2 .897 2 2v7c0 1.103-.897 2-2 2s-2-.897-2-2v-7c0-1.103.897-2 2-2zm0-2c-2.209 0-4 1.791-4 4v7c0 2.209 1.791 4 4 4s4-1.791 4-4v-7c0-2.209-1.791-4-4-4zm8 9v2c0 4.418-3.582 8-8 8s-8-3.582-8-8v-2h2v2c0 3.309 2.691 6 6 6s6-2.691 6-6v-2h2zm-7 13v-2h-2v2h-4v2h10v-2h-4z"})})}),jsx("button",{id:"screen-btn",className:_d?"active":"",onClick:yp,children:jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:jsx("path",{d:"M0 1v17h24v-17h-24zm22 15h-20v-13h20v13zm-6.599 4l2.599 3h-12l2.599-3h6.802z"})})}),jsx("button",{id:"leave-btn",style:{backgroundColor:"#FF5050"},onClick:_f,children:jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:jsx("path",{d:"M16 10v-5l8 7-8 7v-5h-8v-4h8zm-16-8v20h14v-2h-12v-16h12v-2h-14z"})})})]}),jsx("button",{id:"join-btn",onClick:c0,style:{display:Pl?"none":"block"},children:"Join Stream"})]}),jsxs("section",{id:"messages__container",ref:_,children:[jsx("div",{id:"messages",ref:$,children:Tl.map(o0=>jsx("div",{className:"message__wrapper",children:jsxs("div",{className:`message__body${o0.isBotMessage?"__bot":""}`,children:[jsx("strong",{className:`message__author${o0.isBotMessage?"__bot":""}`,children:o0.author}),jsx("p",{className:`message__text${o0.isBotMessage?"__bot":""}`,children:o0.message})]})}))}),jsx("form",{id:"message__form",onSubmit:n0,children:jsx("input",{type:"text",name:"message",placeholder:"Send a message....",value:_c,onChange:o0=>_l(o0.target.value)})})]})]})})},index="";function App(){return jsxs(HashRouter,{children:[jsx(Header,{}),jsxs(Routes,{children:[jsx(Route,{path:"/",element:jsx(Lobby,{})}),jsx(Route,{path:"/:roomId",element:jsx(Room,{})}),jsx(Route,{path:"*",element:jsx(Navigate,{to:"/"})})]})]})}client$1.createRoot(document.getElementById("root")).render(jsx(React.StrictMode,{children:jsx(App,{})}));
